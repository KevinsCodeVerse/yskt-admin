(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7c4dbd09"],{"0554":function(e,t,s){},"4ffd":function(e,t,s){e.exports=s.p+"static/img/logo.82b9c7a5.png"},"68b9":function(e,t,s){"use strict";s("0554")},a55b3:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"login"}},[e.$store.state.isPhone?e._e():t("div",{staticClass:"back_img"},[t("div",{staticClass:"shade"},[t("div",{staticClass:"title",staticStyle:{display:"flex","align-items":"center","justify-content":"center"}},[t("el-image",{staticStyle:{width:"55px",height:"55px"},attrs:{src:s("e723")}}),t("span",{staticStyle:{"margin-left":"10px"}},[e._v("优师课堂智能后台")])],1)])]),t("div",{staticClass:"form"},[t("el-form",{ref:"login",attrs:{model:e.params,"status-icon":"",rules:e.rules,"hide-required-asterisk":!0},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitForm()}}},[t("div",{staticClass:"form_title"},[e._v("登 录")]),t("el-form-item",{attrs:{prop:"account"}},[t("el-input",{attrs:{placeholder:"账号","prefix-icon":"el-icon-user"},model:{value:e.params.account,callback:function(t){e.$set(e.params,"account",t)},expression:"params.account"}})],1),t("el-form-item",{attrs:{prop:"password"}},[t("el-input",{attrs:{placeholder:"密码",type:"password","prefix-icon":"el-icon-lock","show-password":""},model:{value:e.params.password,callback:function(t){e.$set(e.params,"password",t)},expression:"params.password"}})],1),t("el-checkbox",{on:{change:e.rememberChange},model:{value:e.remember,callback:function(t){e.remember=t},expression:"remember"}},[e._v("记住密码")]),t("el-button",{staticClass:"form_btn",attrs:{type:"primary",loading:e.loading},on:{click:e.submitForm}},[e._v("登录")])],1)],1)])},i=[],a=(s("5948"),s("97ba"),s("c0eb")),o=s("5258"),n=s("1f46"),c={components:{ImgCode:a["a"]},data(){return{remember:!1,logo:s("4ffd"),redirect:void 0,otherQuery:{},params:{account:"",password:"",code:"",verifySign:""},rules:{account:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"}]},verifyCode:{codeUrl:"",sign:"",code:""},loading:!1}},mounted(){sessionStorage.removeItem("adminToken"),sessionStorage.removeItem("menuList");var e=localStorage.getItem("pfaccount"),t=localStorage.getItem("pfpwd"),s=localStorage.getItem("pfremeber");this.$common.checkNull(e,t)&&(this.params.account=e,this.params.password=t,s&&(this.remember=!0))},methods:{rememberChange(){this.remember||(localStorage.removeItem("pfaccount"),localStorage.removeItem("pfpwd"))},submitForm(){this.$refs["login"].validate(e=>{if(!e)return!1;this.loading=!0,this.$request.post({url:"admin/adInfo/public/login",params:{account:o["a"].encryptByPublicKey(this.params.account),password:o["a"].encryptByPublicKey(this.params.password),verifyCode:this.params.code,verifySign:this.params.verifySign},success:e=>{this.remember&&(localStorage.setItem("pfaccount",this.params.account),localStorage.setItem("pfpwd",this.params.password)),localStorage.setItem("pfremeber",this.remember),sessionStorage.setItem("adminToken",e.token),sessionStorage.setItem("userName",e.name),sessionStorage.setItem("id",e.id),sessionStorage.setItem("roleId",e.roleId),sessionStorage.setItem("interfaceList",JSON.stringify(e.interfaceList));const t=e.menuList;if(sessionStorage.setItem("menuList",JSON.stringify(t)),sessionStorage.setItem("roleName",e.roleName),n["a"].init(),1===e.id)this.$router.push({path:this.redirect||"/orderManage/index",query:this.otherQuery});else{const e=t.findIndex(e=>"系统设置"===e.menuName);if(-1!==e)this.$router.push({path:this.redirect||"/orderManage/index",query:this.otherQuery});else{const e=t.filter(e=>2===e.flag);e&&e.length>0&&this.$router.push({path:this.redirect||e[0].requestUrl,query:this.otherQuery})}}localStorage.setItem("perList",JSON.stringify(e.preList)),this.$message.success("登录成功")},allError:e=>{this.$refs.imgCode.getImgCode()},finally:()=>{this.loading=!1}})})},resetForm(){this.$refs["login"].resetFields()},getMenus(){this.loading=!0,this.$request.post({url:"admin/roleMenu/getMenuUrl",success:e=>{sessionStorage.setItem("menuList",e);let t=decodeURIComponent(this.$route.query.redirect||"/");-1==t.indexOf("/")&&-1==t.indexOf("login")||(t="/manage/welcome"),localStorage.setItem("account",this.admin.account),this.$router.replace(t)},finally:()=>{this.loading=!1}})},getOtherQuery(e){return Object.keys(e).reduce((t,s)=>("redirect"!==s&&(t[s]=e[s]),t))}},watch:{$route:{handler:function(e){const t=e.query;t&&(this.redirect=t.redirect,this.otherQuery=this.getOtherQuery(t))},immediate:!0}}},l=c,m=(s("68b9"),s("1805")),u=Object(m["a"])(l,r,i,!1,null,"10b95ddc",null);t["default"]=u.exports},e723:function(e,t,s){e.exports=s.p+"static/img/yskt.40c285c0.png"}}]);