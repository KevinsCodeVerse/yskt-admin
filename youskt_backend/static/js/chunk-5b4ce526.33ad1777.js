(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5b4ce526","chunk-7c4dbd09","chunk-22098cef"],{"013b":function(e,t,n){},"02f0":function(e,t,n){"use strict";n("926b")},"03ad":function(e,t,n){"use strict";n("b4e4")},"0418":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}),t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange}})],1)},i=[],o=n("7591"),a=n("b775"),s={name:"messagePage",components:{BasicTable:o["a"]},data(){return{loading:!1,categoryOptions:[],filterOptions:{column:[{type:"input",label:"接收人手机号",value:"phone"}]},filterData:{phone:""},table:{columns:[{id:1,prop:"phone",label:"发送号码"},{id:2,prop:"sendName",label:"发送人"},{id:3,prop:"createTime",label:"发送时间",type:"date"},{id:4,prop:"sendContent",label:"发送内容",width:"400px"},{id:5,prop:"sendBeforeCount",label:"发送前条数",width:"60px"},{id:6,prop:"sendAfterCount",label:"发送后条数",width:"60px"},{id:7,prop:"remark",label:"发送备注"}],pageSize:20,currentPage:1,data:[],total:0},operates:[],headerOperates:[]}},created(){this.getList()},methods:{searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0,a["a"].post({url:"/system/sysSmsRecord/list",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,...this.filterData},success:e=>{this.table.data=e.list,this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1}})},handleSuccess(){this.getList()},clearFilter(){this.filterData={phone:""},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()}}},l=s,u=n("1805"),c=Object(u["a"])(l,r,i,!1,null,"cdb74c7e",null);t["default"]=c.exports},"0554":function(e,t,n){},"05de":function(e,t,n){"use strict";n("be47")},"06d3":function(e,t,n){"use strict";n("5831")},"0758":function(e,t,n){},"0796":function(module,exports,__webpack_require__){"use strict";(function(module){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__;
/*!
* Mui Player Javascript Library v1.8.1 @Professional edition
* Date：2023-01-28
* Released under GPL-3.0 license
* https://muiplayer.js.org/
*/function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _createForOfIteratorHelper(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;t=function(){};return{s:t,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw i}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,t){"object"==_typeof(exports)&&"object"==_typeof(module)?module.exports=t():_typeof(__webpack_require__("51d4"))?(__WEBPACK_AMD_DEFINE_FACTORY__=t,__WEBPACK_AMD_DEFINE_RESULT__="function"===typeof __WEBPACK_AMD_DEFINE_FACTORY__?__WEBPACK_AMD_DEFINE_FACTORY__.call(exports,__webpack_require__,exports,module):__WEBPACK_AMD_DEFINE_FACTORY__,void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)):e.MuiPlayer=t()}(window,(function(){var MuiPlayer=function MuiPlayer(config){var _this=this;_this._global_={};var webpagePlugin="",mobilePlugin="",hls=null,flv=null,option=config||{},plugins=option.plugins||[];this._event_={};var con="string"==typeof option.container?document.querySelector(option.container):option.container,$CONSTANT,$habit,$node,$global,element,$el,variable,$data,$method;con&&($CONSTANT={unitLengthReg:/^(auto|inherit|initial|\d+(\.\d+)?(\%|px|cm|mm|em|rem|vw|vh|)?)$/i,encodeKey:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"},$habit={themeColor:"#1e98d4"},$node={video:'\x3c!-- HTML5 Video --\x3e<div class="video-wrapper"><video width="100%" height="100%"></video></div>',mplayerPoster:'<div class="mplayer-poster" id="mplayer-poster"></div>',mplayerCover:'\x3c!-- 媒体播放遮罩层 --\x3e<div class="mplayer-cover" id="mplayer-cover"></div>',mplayerLoading:'\x3c!-- Mplayer加载Loading --\x3e<div class="mplayer-loading"id="mplayer-loading"control><svg viewBox="25 25 50 50"class="mplayer-loading__circular"><circle cx="50"cy="50"r="20"fill="none"></circle></svg></div>',mplayerError:'\x3c!-- 视频加载错误显示 --\x3e<div class="mplayer-error"id="mplayer-error"control><div class="errop-tip">视频加载失败，点击刷新</div><svg t="1575125481608"class="icon"viewBox="0 0 1024 1024"version="1.1"xmlns="http://www.w3.org/2000/svg"p-id="5893"width="28"height="28"><path d="M513.34 831.74C337.03 831.74 193.6 688.31 193.6 512c0-71.09 23.31-138.85 65.53-194.03v51.61c0 17.67 14.33 32 32 32s32-14.33 32-32V239.45c0-5.87-1.59-11.36-4.34-16.09-0.06-0.1-0.11-0.2-0.17-0.3-0.16-0.28-0.34-0.55-0.51-0.82-0.13-0.2-0.26-0.41-0.39-0.61-0.08-0.13-0.17-0.25-0.26-0.37a35.5 35.5 0 0 0-1.58-2.13c-6.81-8.35-16.96-12.35-26.95-11.69h-130c-17.67 0-32 14.33-32 32s14.33 32 32 32h55.35C159.8 339 129.6 423.35 129.6 512c0 51.79 10.15 102.05 30.17 149.38 19.33 45.7 46.99 86.74 82.23 121.97 35.23 35.23 76.27 62.9 121.97 82.23 47.33 20.02 97.59 30.17 149.38 30.17 17.67 0 32-14.33 32-32s-14.34-32.01-32.01-32.01zM855.38 762.3h-51.23c19.81-23 36.93-48.3 50.75-75.22 27.6-53.74 42.18-114.28 42.18-175.08 0-51.79-10.15-102.05-30.17-149.38-19.33-45.7-46.99-86.73-82.23-121.97-35.23-35.23-76.27-62.9-121.97-82.23-47.33-20.02-97.59-30.17-149.38-30.17-17.67 0-32 14.33-32 32s14.33 32 32 32c176.31 0 319.74 143.44 319.74 319.74 0 78.31-27.68 151.61-77.6 209.05l0.24-56.04c0.08-17.67-14.19-32.06-31.86-32.14h-0.14c-17.61 0-31.92 14.24-32 31.86l-0.55 129.43a31.988 31.988 0 0 0 9.32 22.71 31.68 31.68 0 0 0 5.33 4.3c0.02 0.01 0.04 0.02 0.06 0.04 0.48 0.31 0.97 0.61 1.47 0.89l0.15 0.09c0.5 0.28 1 0.54 1.51 0.8 0.03 0.01 0.05 0.03 0.08 0.04 1.64 0.8 3.34 1.46 5.1 1.98 0.01 0 0.02 0.01 0.03 0.01 0.55 0.16 1.1 0.3 1.66 0.43 0.07 0.02 0.15 0.03 0.22 0.05 0.5 0.11 1 0.21 1.5 0.3 0.1 0.02 0.2 0.04 0.3 0.05 0.48 0.08 0.96 0.15 1.44 0.21 0.11 0.01 0.23 0.03 0.34 0.04 0.48 0.05 0.95 0.09 1.43 0.12l0.34 0.03c0.53 0.03 1.07 0.04 1.61 0.05h132.31c17.67 0 32-14.33 32-32s-14.31-31.99-31.98-31.99z"p-id="5894"fill="#ffffff"></path></svg></div>',mplayerHeader:'\x3c!-- Mplayer 顶部导航 --\x3e<div class="mplayer-header"id="mplayer-header"><div class="title-groupt"id="title-groupt"><button class="player-btn header-control back-button keyboard-input"id="back-button"control><svg id="back-icon-svg"t="1573891955387"viewBox="0 0 1024 1024"version="1.1"xmlns="http://www.w3.org/2000/svg"p-id="4550"width="18"height="18"><path d="M305.519192 557.640404c-11.636364 0-23.40202-4.39596-32.323232-13.317172-17.842424-17.842424-17.842424-46.674747 0-64.517171L683.830303 69.30101c17.842424-17.842424 46.674747-17.842424 64.517172 0 17.842424 17.842424 17.842424 46.674747 0 64.517172L337.713131 544.323232c-8.921212 8.921212-20.557576 13.317172-32.193939 13.317172z m0 0"fill="#ffffff"p-id="4551"></path><path d="M715.894949 968.145455c-11.636364 0-23.40202-4.39596-32.323232-13.317172L273.19596 544.323232c-17.842424-17.842424-17.842424-46.674747 0-64.517171 17.842424-17.842424 46.674747-17.842424 64.517171 0l410.505051 410.50505c17.842424 17.842424 17.842424 46.674747 0 64.517172-8.921212 8.921212-20.557576 13.317172-32.323233 13.317172z m0 0"fill="#ffffff"p-id="4552"></path></svg><div class="title-name"id="title-name"></div></button></div><div class="buttom-group"id="buttom-group"></div></div>',mplayerFooter:'\x3c!-- Mplayer 底部操作控件 --\x3e<div class="mplayer-footer"id="mplayer-footer"><div class="progress"id="progress"><div class="left-part"id="left-part"><button class="player-btn keyboard-input play-switch footer-control"id="play-switch"control>\x3c!--play button--\x3e<div class="_play"><svg t="1574051894346"viewBox="0 0 1024 1024"version="1.1"xmlns="http://www.w3.org/2000/svg"p-id="1212"><path d="M324.085 95.787l500.422 300.664c82.373 50.453 79.284 136.946-1.030 186.37v0l-506.6 304.784c-41.187 23.683-87.522 37.068-131.798 9.267-36.037-22.653-46.335-58.691-46.335-97.819v-616.774c0-39.127 13.386-75.166 48.395-97.819 45.305-27.801 94.731-14.416 136.946 11.327v0z"p-id="1213"fill="#ffffff"></path></svg></div>\x3c!--pause button--\x3e<div class="_pause"style="display: none;"><svg t="1574051952939"viewBox="0 0 1024 1024"version="1.1"xmlns="http://www.w3.org/2000/svg"p-id="1434"><path d="M248.26311111 515.072c0-110.592-0.22755555-221.184 0.11377778-331.776 0.11377778-35.84 18.20444445-60.87111111 49.26577778-70.99733333 27.53422222-8.87466667 56.88888889 0.34133333 75.32088888 23.77955555 10.58133333 13.42577778 15.13244445 28.89955555 15.01866667 45.96622223-0.11377778 223.11822222 0.11377778 446.23644445-0.22755555 669.35466666-0.11377778 42.55288889-31.06133333 73.27288889-70.54222222 72.81777778-39.25333333-0.45511111-68.72177778-31.51644445-68.94933334-74.52444444-0.34133333-111.50222222 0-223.11822222 0-334.62044445zM638.52088889 516.66488889V193.64977778c0-52.45155555 27.42044445-85.21955555 70.54222222-84.65066667 42.43911111 0.56888889 69.17688889 32.42666667 69.17688889 83.05777778 0.11377778 218.22577778 0.11377778 436.56533333 0 654.79111111 0 38.34311111-17.29422222 63.60177778-49.152 73.95555555-27.648 8.98844445-56.54755555 0-75.43466667-23.552-12.17422222-15.13244445-15.36-32.768-15.24622222-51.76888888 0.22755555-109.568 0.11377778-219.136 0.11377778-328.81777778z"p-id="1435"fill="#ffffff"></path></svg></div></button>\x3c!--直播模式--\x3e<button class="player-btn live-mode footer-control"id="live-mode"control><div class="spot"></div><div class="mode-text">直播</div></button></div>\x3c!--底部进度容器--\x3e<div class="progress-container"id="progress-container">\x3c!--安全进度时长--\x3e<div class="progress-begin"id="progress-begin">开始</div>\x3c!--拖动有效的作用域--\x3e<div class="touch-effective"id="touch-effective">\x3c!--加载进度条总长--\x3e<div class="progress-total"id="progress-total"></div>\x3c!--资源缓存进度--\x3e<div class="progress-buffered"id="progress-buffered"></div>\x3c!--播放进度--\x3e<div class="progress-play"id="progress-play"></div>\x3c!--拖动进度球--\x3e<div class="ball-container"><div class="progress-drag"id="progress-ball"><div class="progress-ball"></div></div></div></div>\x3c!--总时长--\x3e<div class="progress-long"id="progress-long">结束</div></div><div class="right-part"id="right-part">\x3c!--全屏开关--\x3e<button class="player-btn keyboard-input full-switch footer-control"id="full-switch"tooltip="全屏"control><div class="_full"><svg t="1607611836872"class="icon"viewBox="0 0 1024 1024"version="1.1"xmlns="http://www.w3.org/2000/svg"p-id="2384"><path d="M842 797.08l-226.07999999-226.08a30 30 0 0 0-42.42000001 42.42000001L799.58 839.5 692 839.5a30 30 0 0 0 0 60L872 899.5a29.91 29.91 0 0 0 30-29.99999999l0-180a30 30 0 0 0-60 0l0 107.57999999zM130.79 128.29A29.91 29.91 0 0 1 152 119.5l180 0a30 30 0 0 1 0 60l-107.58 0 226.08 226.08a30 30 0 0 1-42.42000001 42.42L182 221.92 182 329.50000001a30 30 0 0 1-60 0L122 149.50000001a29.91 29.91 0 0 1 8.79-21.21000001z"fill="#ffffff"p-id="2385"></path></svg></div><div class="_unfull"style="display: none;"><svg t="1607611848290"class="icon"viewBox="0 0 1024 1024"version="1.1"xmlns="http://www.w3.org/2000/svg"p-id="2546"><path d="M416.00000001 370.752L174.848 129.59999999a32 32 0 0 0-45.24800001 45.24800001L370.752 416.00000001 256 416a32 32 0 0 0 0 64l192 0a31.904 31.904 0 0 0 32-32L480 256a32 32 0 0 0-64 0l1e-8 114.752z m137.37599999 182.624A31.904 31.904 0 0 1 576 544L768 544a32 32 0 0 1 0 64l-114.752-1e-8 241.15200001 241.15200001a32 32 0 1 1-45.24800001 45.24800001L607.99999999 653.248 608 768a32 32 0 0 1-64 0l0-192a31.904 31.904 0 0 1 9.376-22.624z"fill="#ffffff"p-id="2547"></path></svg></div></button></div></div></div>',miniProgress:'\x3c!-- Mplayer 底部播放迷你进度条 --\x3e<div class="mini-progress"id="mini-progress">\x3c!--加载进度条总长--\x3e<div class="mini-total"id="mini-total"></div>\x3c!--资源缓存进度--\x3e<div class="mini-buffered"id="mini-buffered"></div>\x3c!--播放进度--\x3e<div class="mini-play"id="mini-play"></div></div>'},$global=function(){return{first_authplay:!1,isReady:!1,webpagePlugin:{},mobilePlugin:{},cssAutoprefixer:["webkit","ms","moz","o"]}},element=function(){return{mPlayer:con,videoObject:con.querySelector("video"),mplayerCover:con.querySelector("#mplayer-cover"),mplayerPoster:con.querySelector("#mplayer-poster"),mplayerHeader:con.querySelector("#mplayer-header"),headerMenu:con.querySelector("#buttom-group"),backButton:con.querySelector("#back-button"),mplayerFooter:con.querySelector("#mplayer-footer"),progressContainer:con.querySelector("#progress-container"),playSwitch:con.querySelector("#play-switch"),fullSwitch:con.querySelector("#full-switch"),progressBall:con.querySelector("#progress-ball"),progressBegin:con.querySelector("#progress-begin"),progressLong:con.querySelector("#progress-long"),touchEffective:con.querySelector("#touch-effective"),progressBuffered:con.querySelector("#progress-buffered"),progressPlay:con.querySelector("#progress-play"),miniProgress:con.querySelector("#mini-progress"),miniBuffered:con.querySelector("#mini-buffered"),miniPlay:con.querySelector("#mini-play"),mplayerLoading:con.querySelector("#mplayer-loading"),mplayerError:con.querySelector("#mplayer-error")}},$el=new element,variable=function(){return{mediaPlayDirectives:0,isFullScreen:!1,showScreenControls:!1,ball_move_status:!1,isPlay:!1,mediaStatus:!1,duration:0,percentage:0,currentTime:0,playError:0,isDestroy:!1,isShowRightSidebar:!1,startX:null,startY:null,moveX:null,moveY:null,_defaultPlayProgressPro:null,isTouchMove:!1,isControlsTimer:!0}},$data=new variable,$method={getLanguageText:function(){return{"zh-cn":{srcNull:"视频地址为空",begin:"开始",end:"结束",live:"直播",settings:"设置",coveredPlay:"铺满播放",loopPlay:"循环播放",playbackSpeed:"播放速度",share:"分享",pictureInPicture:"画中画",exitPictureInPicture:"退出画中画",pageScreen:"网页全屏",exitPageScreen:"退出网页全屏",fullScreen:"全屏",exitFullScreen:"退出全屏",normal:"正常",open:"打开",subtitles:"字幕",selectLangage:"选择语言",dsps:"切换到默认倍速度播放",tsps:"切换到?倍速度播放",errorTip:"视频加载失败，点击刷新",shortcuts:"快捷键",shortcutsPanel:{title:"快捷功能",space:"空格",spaceAction:"播放/暂停",esc:"退出全屏",up:"音量增加5%",down:"音量减少5%",right:"快进5秒",left:"快退5秒"},advertise:"广告"},en:{srcNull:"Video address is empty",begin:"Begin",end:"End",live:"Live",settings:"Settings",coveredPlay:"Covered play",loopPlay:"Loop play",playbackSpeed:"Playback speed",share:"Share",pictureInPicture:"Picture in picture",exitPictureInPicture:"Exit picture in picture",pageScreen:"Page screen",exitPageScreen:"Exit page screen",fullScreen:"Full screen",exitFullScreen:"Exit full screen",normal:"Normal",open:"Open",subtitles:"Subtitles",selectLangage:"Select langage",dsps:"to default speed playback",tsps:"to ?x speed playback",errorTip:"Video failed to load, click refresh",shortcuts:"Shortcuts",shortcutsPanel:{title:"Shortcuts function",space:"Space",spaceAction:"play/pause",esc:"exit full screen",up:"voice increase 5%",down:"voice reduce 5%",right:"fast forward 5 seconds",left:"fast backward 5 seconds"},advertise:"Advertise"},"zh-tw":{srcNull:"視頻地址為空",begin:"開始",end:"結束",live:"直播",settings:"設置",coveredPlay:"鋪滿播放",loopPlay:"循環播放",playbackSpeed:"播放速度",share:"分享",pictureInPicture:"畫中畫",exitPictureInPicture:"退出畫中畫",pageScreen:"網頁全屏",exitPageScreen:"退出網頁全屏",fullScreen:"全屏",exitFullScreen:"退出全屏",normal:"正常",open:"打開",subtitles:"字幕",selectLangage:"選擇語言",dsps:"切換到默認倍速度播放",tsps:"切換到?倍速度播放",errorTip:"視頻加載失敗，點擊刷新",shortcuts:"快捷鍵",shortcutsPanel:{title:"快捷功能",space:"空格",spaceAction:"播放/暫停",esc:"退出全屏",up:"音量增加5%",down:"音量减少5%",right:"快進5秒",left:"快退5秒"},advertise:"廣告"}}},getLangObject:function(){var e=option.lang||navigator.language||navigator.browserLanguage||"zh-cn";return-1!=["zh-cn","en","zh-tw"].indexOf(e.toLowerCase())?$method.getLanguageText()[e.toLowerCase()]:$method.getLanguageText()["zh-cn"]},initCreateMplayer:function(e){for(var t=$node.video+$node.mplayerPoster+$node.mplayerCover+$node.mplayerLoading+$node.mplayerError+$node.mplayerHeader+$node.mplayerFooter+$node.miniProgress,n=(t=$node.logWrite?t+$node.logWrite:t,0);n<plugins.length;n++)if(plugins[n]instanceof Object){if("MuiPlayerDesktopPlugin"==plugins[n].name&&"window"==$method.returnSys()){webpagePlugin=plugins[n];break}if("MuiPlayerMobilePlugin"==plugins[n].name&&("androd"==$method.returnSys()||"ios"==$method.returnSys()||!0===plugins[n].webpage)){mobilePlugin=plugins[n];break}}t=t.toString().replace(/<!--.*?-->/g,""),t=$method.createRangeIsDocFragment(t),t=$method.initConifgAttribute(t,e),t=$method.initConfigControl(t),t=$method.initConfigCustom(t),t=$method.initConfigTheme(t),e={option:option,_this:_this,$el:element,$data:$data,$method:$method,$habit:$habit,$CONSTANT:$CONSTANT},mobilePlugin&&(t=mobilePlugin.appendTemplate(t,e)),webpagePlugin&&(t=webpagePlugin.appendTemplate(t,e)),e=con.querySelector("#mplayer-media-wrapper"),e&&$method.removeNode(con,"#mplayer-media-wrapper"),(e=document.createElement("div")).setAttribute("id","mplayer-media-wrapper"),e.setAttribute("class","player-wrapper"),e.appendChild(t),$el.mPlayer.appendChild(e),option.src?($method.playerReady(),setTimeout((function(){_this._global_.isReady=!0,_this.emit("ready"),setTimeout((function(){$method.onScreenResize({type:"showControls"}),$method.removeOriginControls()}),10)}),100)):$method.showToast($method.getLangObject().srcNull)},onAction:function(){},removeOriginControls:function(){$el.videoObject.removeAttribute("controls")},playerReady:function(){$method.resetVariable(),!0===option.autoplay&&($data.mediaPlayDirectives=1,$method.onPlay()),$method.toggleEventListenerGlobal("add","playerReady"),$method.toggleEventListenerCustom("add"),$method.nodesObserver()},overloadingEl:function(){$el=new element;for(var e=0,t=Object.keys($el);e<t.length;e++){var n=t[e];"mPlayer"!=n&&($el[n]||($el[n]={style:{},classList:{add:function(){},contains:function(){},remove:function(){}},addEventListener:function(){},removeEventListener:function(){}}),$el[n].querySelector=function(e){return e=this.querySelectorAll?this.querySelectorAll(e):[],e[0]||{exist:!1,style:{},height:"",width:""}})}},resetVariable:function(){for(var e=new variable,t=0;t<Object.keys(e).length;t++){var n=Object.keys(e)[t];$data[n]=e[n]}$method.overloadingEl(),_this._global_=new $global},plusRuntimeHandle:function(e){"resume"==(e=e||{}).type&&(_this._global_._beferPlayState&&$el.videoObject.play(),$data.isFullScreen&&plus.navigator.hideSystemNavigation()),"pause"==e.type&&(_this._global_._beferPlayState=$data.isPlay,$el.videoObject.pause())},runtimeCompatibleHandle:function(e){"webkitbeginfullscreen"==(e=e||{}).type&&$method.createTimerCloseControl({type:"cancel"}),"webkitendfullscreen"==e.type&&$method.createTimerCloseControl()},assginConfig:function(){option.themeColor&&($habit.themeColor=option.themeColor)},parseCamel:function(e){return e.replace(/\B([A-Z])/g,"-$1").toLowerCase()},randomText:function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:5,t="",n=0;n<e;n++)t+=String.fromCharCode(Math.floor(26*Math.random())+"a".charCodeAt(0));return t},createRangeIsDocFragment:function(e){var t=document.createRange();return t.selectNode($el.mPlayer),t.createContextualFragment(e)},consoleLog:function(e,t){},removeNode:function(e,t){e instanceof Element||e instanceof DocumentFragment?(e=e.querySelector(t))instanceof Element?e.parentNode.removeChild(e):console.warn("the body element not query the selector node......"):(t=document.querySelector(t))?t.parentNode.removeChild(t):console.warn("from document not query the selector node......")},getKeyCode:function(e){return e.keyCode||e.which||""},focusToggle:function(e){$el.mPlayer.classList["ON"==e?"add":"remove"]("mp-keyboard-focus")},setElementStyle:function(e,t){var n=Object.keys(t);if(0<n.length){var r,i=_createForOfIteratorHelper(n);try{for(i.s();!(r=i.n()).done;){var o=r.value;e.style[$method.parseCamel(o)]=t[o]}}catch(e){i.e(e)}finally{i.f()}e.setAttribute("stylesheet",JSON.stringify(t))}},initConfigTheme:function(e){return $method.assginConfig(),e.querySelector("#progress-play")&&(e.querySelector("#progress-play").style.background=$habit.themeColor),e.querySelector("#mplayer-loading")&&(e.querySelector("#mplayer-loading").style.color=$habit.themeColor),e.querySelector("#mini-play")&&(e.querySelector("#mini-play").style.background=$habit.themeColor),e.querySelector("#live-mode")&&(e.querySelector("#live-mode .spot").style.background=$habit.themeColor),e},initConfigCustom:function(e){for(var t=option.custom||{},n=t.headControls||[],r=0;r<n.length&&!(5<=r);r++)n[r]instanceof Object&&n[r].slot&&(o=n[r].slot,(a=$el.mPlayer.querySelector("[slot="+o+"]"))&&(s="TEMPLATE"==a.tagName?a.content.cloneNode(!0):$method.createRangeIsDocFragment(a.innerHTML),(l=document.createElement("button")).setAttribute("class","player-btn header-control"),l.setAttribute("slot",o),l.setAttribute("control",""),n[r].click instanceof Function&&l.classList.add("keyboard-input"),n[r].style&&n[r].style instanceof Object&&$method.setElementStyle(l,n[r].style),l.appendChild(s),e.querySelector("#buttom-group").insertBefore(l,e.querySelector("#buttom-group .header-control")),a.style.display="none"));var i=t.footerControls||[];for(r=0;r<i.length&&!(5<=r);r++)i[r]instanceof Object&&i[r].slot&&(o=i[r].slot,(a=$el.mPlayer.querySelector("[slot="+o+"]"))&&(s="TEMPLATE"==a.tagName?a.content.cloneNode(!0):$method.createRangeIsDocFragment(a.innerHTML),(l=document.createElement("button")).setAttribute("class","player-btn footer-control"),l.setAttribute("slot",o),l.setAttribute("control",""),i[r].tooltip&&l.setAttribute("tooltip",i[r].tooltip),i[r].click instanceof Function&&l.classList.add("keyboard-input"),i[r].style&&i[r].style instanceof Object&&$method.setElementStyle(l,i[r].style),l.appendChild(s),"left"==i[r].position?e.querySelector("#mplayer-footer #left-part").appendChild(l):e.querySelector("#mplayer-footer #right-part").insertBefore(l,e.querySelector("#mplayer-footer #right-part").childNodes[0]),a.style.display="none"));var o,a,s,l,u,c=t.rightSidebar||[];for(r=0;r<c.length&&!(5<=r);r++)c[r]instanceof Object&&c[r].slot&&(o=c[r].slot,(a=$el.mPlayer.querySelector("[slot="+o+"]"))&&(s="TEMPLATE"==a.tagName?a.content.cloneNode(!0):$method.createRangeIsDocFragment(a.innerHTML),(l=document.createElement("div")).appendChild(s),l.setAttribute("slot",o),l.setAttribute("class","mplayer-sidebar"),u=c[r].width||"",$CONSTANT.unitLengthReg.test(u)&&(l.style.width=isNaN(Number(u))?u:u+"px"),e.appendChild(l),a.style.display="none"));return e},initConfigControl:function(e){!1!==option.showMiniProgress&&!0!==option.live||$method.removeNode(e,"#mini-progress"),!0===option.live?(e.querySelector("#live-mode .mode-text").innerText=$method.getLangObject().live,$method.removeNode(e,"#progress-container")):$method.removeNode(e,"#live-mode"),!1===option.pageHead&&(e.querySelector("#mplayer-header").style.opacity=0);var t=option.subtitle||{},n=t.tracks,r=t.styles;if("[object Array]"===Object.prototype.toString.call(n)&&0<n.length){for(var i=document.createDocumentFragment(),o=0;o<n.length;o++){var a,s=n[o];"object"==_typeof(s)&&/.\.vtt$/.test(s.src)&&((a=document.createElement("track")).setAttribute("src",s.src),a.setAttribute("kind",s.kind||"subtitles"),a.setAttribute("label",s.label||"字幕"+(o+1)),s.srclang&&a.setAttribute("srclang",s.srclang),!0===s.default&&a.setAttribute("default",!0),i.appendChild(a))}e.querySelector("video").appendChild(i)}if("[object Object]"==Object.prototype.toString.call(r)&&0<Object.keys(r).length){var l=document.createElement("style");l.setAttribute("id","pseudo-classes-cue"),l.setAttribute("type","text/css");for(var u="",c=0,d=Object.keys(r);c<d.length;c++){var f=d[c];u+=$method.parseCamel(f)+":"+r[f]+"!important;"}t=document.createTextNode(".m-player video::cue {"+u+"}"),l.appendChild(t),document.getElementsByTagName("head").item(0).appendChild(l)}return e},initConifgAttribute:function(e,t){var n=$el.mPlayer.getBoundingClientRect(),r=n.width,i=n.height;$el.mPlayer.classList.add("m-player"),$el.mPlayer.setAttribute("tabindex","0");var o;n=option.width||"auto";!$CONSTANT.unitLengthReg.test(n)&&!0!==t||$data.isFullScreen||(o=isNaN(Number(n))?n:n+"px",$el.mPlayer.style.width=!0===t?r+"px":o,!0===t&&setTimeout((function(){$el.mPlayer.style.width=o}),800));var a;r=option.height||"225px";function s(t,n){var r=e.querySelector("video");if("src"==t){var i=option.parse||{},o=i.type,a=i.loader,s=i.config||{};if(i.customKernel&&i.customKernel instanceof Function)return console.info("custom kernel..."),i.customKernel(r,n),0;if(r.setAttribute(t,n),"hls"==o){if("function"!=typeof a)return;1==a.isSupported()?$method.hlsDecodeAction(r,n,{loader:a,config:s}):console.error("browser does not support hls js. to check whether your browser is supporting MediaSource Extensions.")}"flv"==o&&"object"==_typeof(a)&&(1==a.isSupported()?$method.flvDecodeAction(r,n,{loader:a,config:s}):console.error("browser does not support flv js. to check whether your browser is supporting MediaSource Extensions."))}else r.setAttribute(t,n)}!$CONSTANT.unitLengthReg.test(r)&&!0!==t||$data.isFullScreen||(a=isNaN(Number(r))?r:r+"px",$el.mPlayer.style.height=!0===t?i+"px":a,!0===t&&!1===option.autoFit&&setTimeout((function(){$el.mPlayer.style.height=a}),800)),0<=option.volume&&option.volume<=1&&(e.querySelector("video").volume=option.volume),!0===option.muted&&(e.querySelector("video").muted=!0),option.src&&s("src",option.src),!0===option.autoplay&&s("autoplay","autoplay"),1==option.autoplay||option.preload&&s("preload",option.preload),option.loop&&s("loop","loop");var l=option.videoAttribute||[];if(0<l.length)for(var u=0;u<l.length;u++)s(l[u].attrKey,l[u].attrValue);return option.poster?((t=document.createElement("img")).setAttribute("src",option.poster),t.setAttribute("style","width: 100%;height: 100%;object-fit: cover;"),e.querySelector("#mplayer-poster").appendChild(t)):$method.removeNode(e,"#mplayer-poster"),option.title&&(e.querySelector("#title-name").innerHTML=option.title),!0===option.initFullFixed&&$el.mPlayer.classList.add("page-fullscreen"),"square"==option.dragSpotShape&&(e.querySelector("#progress-ball .progress-ball").style.borderRadius="3px",e.querySelector("#progress-ball .progress-ball").style.width="9px",e.querySelector("#progress-ball .progress-ball").style.height="14px"),"cover"==option.objectFit&&e.querySelector("video").classList.add("covered"),e.querySelector("#mplayer-footer #full-switch").setAttribute("tooltip",$method.getLangObject().fullScreen),e.querySelector("#mplayer-error .errop-tip").innerText=$method.getLangObject().errorTip,e.querySelector("#progress-begin").innerText=$method.getLangObject().begin,e.querySelector("#progress-long").innerText=$method.getLangObject().end,e},hlsDecodeAction:function(e,t,n){console.info("hls create...");var r=Object.assign({autoStartLoad:!0===option.autoplay||"none"!=option.preload},n.config);(hls=new n.loader(r)).attachMedia(e),hls.on(n.loader.Events.MEDIA_ATTACHED,(function(){hls.loadSource(t)})),hls.on(n.loader.Events.ERROR,$method.onError)},flvDecodeAction:function(e,t,n){console.info("flv create..."),t=Object.assign({type:"flv",url:t},n.config),(flv=n.loader.createPlayer(t)).attachMediaElement(e),!0!==option.autoplay&&"none"==option.preload||flv.load(),flv.on(n.loader.Events.ERROR,$method.onError)},hasNotchInScreen:function(){return!!window.plus&&plus.navigator.hasNotchInScreen()},applicationFullHandle:function(e){window.plus&&(this._landscape_lock=function(){plus.navigator.setFullscreen(!0),plus.screen.lockOrientation("landscape"),setTimeout((function(){plus.navigator.hideSystemNavigation()}),200),setTimeout((function(){var e=plus.navigator.getStatusbarHeight();e=$method.hasNotchInScreen()?e+10:10;$el.mplayerHeader.style.paddingLeft=e+"px",$el.mplayerHeader.style.paddingRight=e+"px",$el.mplayerFooter.style.paddingLeft=e+"px",$el.mplayerFooter.style.paddingRight=e+"px",$el.progressContainer.style.left=e+"px",$el.progressContainer.style.right=e+"px"}),100)},this._portrait_lock=function(){plus.navigator.setFullscreen(!1),plus.screen.lockOrientation("portrait"),setTimeout((function(){$el.mplayerHeader.style.paddingLeft="10px",$el.mplayerHeader.style.paddingRight="10px",$el.mplayerFooter.style.paddingLeft="10px",$el.mplayerFooter.style.paddingRight="10px"}),100)})},setTooltipText:function(e,t){e.setAttribute&&e.setAttribute("tooltip",t),$el.mplayerFooter.querySelector(".mp-tooltip").innerText=t},fullToggle:function(e){(e=e||{type:""}).stopPropagation&&e.stopPropagation(),_this._global_.generate_fullscreen_listener||(_this._global_.generate_fullscreen_listener=!0,$el.mPlayer.requestFullscreen?document.addEventListener("fullscreenchange",(function(){document.fullscreenElement?$method.fullScreenChangeAction("Y"):$method.fullScreenChangeAction("N")})):$el.mPlayer.webkitRequestFullscreen?document.addEventListener("webkitfullscreenchange",(function(){document.webkitFullscreenElement?$method.fullScreenChangeAction("Y"):$method.fullScreenChangeAction("N")})):$el.mPlayer.mozRequestFullScreen?document.addEventListener("mozfullscreenchange",(function(){document.mozFullScreenElement?$method.fullScreenChangeAction("Y"):$method.fullScreenChangeAction("N")})):$el.mPlayer.msRequestFullscreen&&document.addEventListener("msfullscreenchange",(function(){document.msFullscreenElement?$method.fullScreenChangeAction("Y"):$method.fullScreenChangeAction("N")}))),$data.isFullScreen?$method.closeFullScreen():$method.openFullScreen()},fullScreenChangeAction:function(e){"Y"==e?($data.isFullScreen=!0,$el.fullSwitch.querySelector("._full").style.display="none",$el.fullSwitch.querySelector("._unfull").style.display="block",$method.setTooltipText($el.fullSwitch,$method.getLangObject().exitFullScreen)):"N"==e&&($data.isFullScreen=!1,$el.fullSwitch.querySelector("._full").style.display="block",$el.fullSwitch.querySelector("._unfull").style.display="none",$method.setTooltipText($el.fullSwitch,$method.getLangObject().fullScreen),$el.mPlayer.classList.contains("browser-fullscreen")&&$method.closeFullScreen("completed")),window.plus&&($data.isPlay?plus.device.setWakelock(!0):plus.device.setWakelock(!1))},closeFullScreen:function(e){function t(){$data.isFullScreen=!1,$method.createTimerCloseControl(),$el.mPlayer.classList.remove("browser-fullscreen"),"completed"!=e&&(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen())}0!=option.autoOrientaion&&window.plus&&"ios"!=$method.returnSys()?((new $method.applicationFullHandle)._portrait_lock(),setTimeout((function(){t(),!1===option.pageHead&&($el.mplayerHeader.style.opacity=0)}),100)):(t(),!1===option.pageHead&&($el.mplayerHeader.style.opacity=0))},openFullScreen:function(){var e;"ios"!=$method.returnSys()?(e=function(){$el.mPlayer.requestFullscreen?$el.mPlayer.requestFullscreen():$el.mPlayer.webkitRequestFullscreen?$el.mPlayer.webkitRequestFullscreen():$el.mPlayer.mozRequestFullScreen?$el.mPlayer.mozRequestFullScreen():$el.mPlayer.msRequestFullscreen&&$el.mPlayer.msRequestFullscreen(),$data.isFullScreen=!0,$method.createTimerCloseControl(),$el.mPlayer.classList.add("browser-fullscreen")},0!=option.autoOrientaion&&window.plus?((new $method.applicationFullHandle)._landscape_lock(),setTimeout((function(){e(),!1===option.pageHead&&($el.mplayerHeader.style.opacity=1)}),100)):(e(),!1===option.pageHead&&($el.mplayerHeader.style.opacity=1))):$el.videoObject.webkitEnterFullscreen()},onPlayTap:function(e){(e=e||{type:""}).stopPropagation&&e.stopPropagation();var t=$el.playSwitch.querySelector("._play").style.display;if($el.playSwitch.querySelector("._pause").style.display,$data.isPlay||"none"==t)$el.videoObject.pause();else if(!$data.isPlay){if(!option.src)return void $method.showToast($method.getLangObject().srcNull);!hls&&!flv||$data.mediaStatus?($data.mediaPlayDirectives=0,$el.videoObject.play()):($data.mediaPlayDirectives=1,hls&&hls.startLoad(),flv&&flv.load()),_this._global_.mp_timeout_4||(_this._global_.mp_timeout_4=setTimeout((function(){_this._global_.mp_timeout_4=null,$data.isPlay||$method.showLoading()}),500))}$method.createTimerCloseControl(e)},onContrainerTap:function(e){var t;(e=e||{}).stopPropagation&&e.stopPropagation(),$data.isTouchMove||(t=function(t){_this._global_.triggerDblclickEvent||(mobilePlugin?new mobilePlugin.interface(e)._onAgentMpTap("dbclick"):webpagePlugin?new webpagePlugin.interface(e)._onAgentMpTap("dbclick"):$method.onPlayTap({type:"dblscreen"}),_this._global_.triggerDblclickEvent=!0,setTimeout((function(){_this._global_.triggerDblclickEvent=!1}),310))},_this._global_.clickCount=_this._global_.clickCount||0,_this._global_.clickCount++,2==_this._global_.clickCount?(t(),_this._global_.clickCount=0):(_this._global_.mp_timeout_2&&clearTimeout(_this._global_.mp_timeout_2),_this._global_.mp_timeout_2=setTimeout((function(){1==_this._global_.clickCount&&(_this._global_.triggerDblclickEvent||(mobilePlugin?new mobilePlugin.interface(e)._onAgentMpTap("click"):webpagePlugin?new webpagePlugin.interface(e)._onAgentMpTap("click"):$method.toggleControlsDisplay(e))),_this._global_.clickCount=0}),300)),"dblclick"==e.type&&(t(),_this._global_.clickCount=0))},changeLogoAxis:function(){var e,t,n=$el.mPlayer.querySelector("#mplayer-media-wrapper").querySelector("#mp-logot-box");n&&(t=(e=$method.mediaWindowSize()).videoWidth,e=e.videoHeight,n.style.height=e+"px",n.style.width=t+"px",t/=window.screen.availHeight,n.querySelector(".mp-logot").style.transform="scale("+t+")")},mediaWindowSize:function(){var e=$el.videoObject,t=$el.mPlayer.getBoundingClientRect(),n=t.width,r=t.height,i=e.videoHeight/e.videoWidth,o=r/n,a={videoWidth:0,videoHeight:0};e=$el.mPlayer.classList;return!e.contains("browser-fullscreen")&&!e.contains("page-fullscreen")&&0!=option.autoFit||o.toFixed(2)>i.toFixed(2)?(a.videoWidth=n.toFixed(),a.videoHeight=(n*i).toFixed()):(o.toFixed(2)<i.toFixed(2)?a.videoWidth=(r/i).toFixed():a.videoWidth=n.toFixed(),a.videoHeight=r.toFixed()),a},changeVideoSize:function(e){e=e||{},$method.changeLogoAxis();var t=$el.videoObject;e=(option.subtitle||{}).tracks;"[object Array]"===Object.prototype.toString.call(e)&&0<e.length&&t.videoHeight&&t.videoWidth&&"window"==$method.returnSys()&&(e=$method.mediaWindowSize(),t.style.height=e.videoHeight+"px",t.style.width=e.videoWidth+"px")},onPause:function(e){$data.isPlay=!1,setTimeout((function(){$method.hideLoading()}),500),$el.playSwitch.querySelector("._play").style.display="block",$el.playSwitch.querySelector("._pause").style.display="none",window.plus&&plus.device.setWakelock(!1)},onPlay:function(e){setTimeout((function(){$method.computeLoadingStatus((function(e){e||$data.playError||$method.showLoading()}))}),500)},onPlaying:function(){$method.computeLoadingStatus((function(e){e&&($method.hideLoading(),$method.hideCover(),option.live||$method.onTimeupdate())})),$method.removeOriginControls(),window.plus&&plus.device.setWakelock(!0),$data.isPlay=!0,1<$data.duration&&1!=$el.videoObject.style.opacity&&setTimeout((function(){$el.videoObject.style.opacity=1}),500),$el.playSwitch.querySelector("._play").style.display="none",$el.playSwitch.querySelector("._pause").style.display="block","none"!=$el.mplayerError.style.display&&($el.mplayerError.style.display="none"),option.poster&&"none"!=$el.mplayerPoster.style.display&&($el.mplayerPoster.style.display="none"),0!=option.autoFit&&1<$data.duration&&"auto"!=$el.mPlayer.style.height&&!$data.isFullScreen&&!$el.mPlayer.hasAttribute("miniplayer")&&($el.mPlayer.style.height="auto")},computeLoadingStatus:function(e){var t=0;(function n(){var r=$el.videoObject.duration||0,i=$el.videoObject.currentTime||0;1<r||0<i?e(!0):1e3<=t?e(!1):setTimeout((function(){t+=200,n()}),200)})()},onBack:function(e){e.stopPropagation(),$data.isFullScreen?$method.fullToggle():_this.emit("back"),$method.createTimerCloseControl()},onCanplaythrough:function(e){$method.hideCover(),$method.hideLoading()},onDurationChange:function(e){var t,n;$el.videoObject.duration,1<(n=$el.videoObject.duration)&&($data.mediaStatus=!0,$data.duration=n,_this.emit("duration-change",{duration:n}),1!=$data.mediaPlayDirectives||_this._global_.first_authplay||(_this._global_.first_authplay=!0,$el.videoObject.play(),$method.hideLoading()),n!=1/0&&(t=$method.formatCurrentTime($data.duration),$el.progressLong.innerHTML=t,$el.progressBegin.innerHTML=3600<=n?"00:00:00":"00:00"),1!=$el.videoObject.style.opacity&&setTimeout((function(){$el.videoObject.style.opacity=1}),500),0==option.autoFit||"auto"==$el.mPlayer.style.height||$el.mPlayer.hasAttribute("miniplayer")||($el.mPlayer.style.height="auto"),$method.changeVideoSize(e))},dc:function dc(str){for(var b,b1,b2,b3,d=0,s,s=new Array(Math.floor(str.length/3)),b=s.length,i=0;i<b;i++)b1=$CONSTANT.encodeKey.indexOf(str.charAt(d)),d++,b2=$CONSTANT.encodeKey.indexOf(str.charAt(d)),d++,b3=$CONSTANT.encodeKey.indexOf(str.charAt(d)),d++,s[i]=36*b1*36+36*b2+b3;return b=eval("String.fromCharCode("+s.join(",")+")"),b},formatCurrentTime:function(e){var t=parseInt(e/3600),n=(t=3600<=$data.duration||0<t?"0"+t.toString()+":":"",0<=(n=parseInt(e%3600/60))&&1==n.toString().length?"0"+n.toString()+":":n+":");e=0<=(e=parseInt(e%60))&&1==e.toString().length?"0"+e.toString():e;return t.toString()+n.toString()+e.toString()},updateProgressBar:function(e){$data.percentage=e,$el.progressBall.style.left=$data.percentage+"%",$el.progressPlay.style.width=$data.percentage+"%",$method.computePlayTime($data.percentage,$data.duration,(function(e){$el.progressBegin.innerHTML=e})),_this.emit("seek-progress",{percentage:e})},progressControlHandle:function(e,t,n,r){$method.computeProgress(e,t,(function(e){e=Number.parseFloat($data._defaultPlayProgressPro||0)+e*(n||1),100<=e?e=100:e<=0&&(e=0),$method.updateProgressBar(e),r&&r()}))},computeProgress:function(e,t,n){n(e/t.getBoundingClientRect().width*100)},computePlayTime:function(e,t,n){100<=e?e=100:e<=0&&(e=0),$data.currentTime=e/100*t,n($method.formatCurrentTime($data.currentTime))},onTimeupdate:function(e){var t,n;$data.duration<=1||$data.duration==1/0||(t=$el.videoObject.currentTime||0)<.1||(n=t/$data.duration*100,$el.miniPlay.style.width=(n=100<=n?100:n)+"%",$data.ball_move_status||function(){$el.progressBall.style.left=n+"%",$el.progressPlay.style.width=n+"%";var e=$method.formatCurrentTime(t);$el.progressBegin.innerHTML!=e&&($el.progressBegin.innerHTML=e)}(),option.live||(_this._global_.playingState=!1,_this._global_.mp_timeout_5&&clearTimeout(_this._global_.mp_timeout_5),_this._global_.mp_timeout_5=setTimeout((function(){!_this._global_.playingState&&$data.isPlay&&$method.showLoading()}),700),$data.isPlay&&(_this._global_.beginTimeDot?(_this._global_.endTimeDot=new Date,_this._global_.endTimeDot.getTime()-_this._global_.beginTimeDot.getTime()<=700&&(_this._global_.playingState=!0,$method.hideLoading(),clearTimeout(_this._global_.mp_timeout_5)),_this._global_.nextTimeUpdateState=!1,_this._global_.mp_timeout_6&&clearTimeout(_this._global_.mp_timeout_6),_this._global_.mp_timeout_6=setTimeout((function(){!_this._global_.nextTimeUpdateState&&$data.isPlay&&$method.showLoading()}),700),_this._global_.beginTimeDot=null):(_this._global_.beginTimeDot=new Date,_this._global_.nextTimeUpdateState=!0))),$data.mediaStatus||$method.onDurationChange(e))},progressBarSeeking:function(e){if((e=e||{}).stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),$data.mediaStatus&&$data.duration!=1/0&&"NaN"!=$data.duration){var t=function(){$data.ball_move_status=!0,$method.createTimerCloseControl({type:"cancel"}),$data.startX=("touchstart"==e.type?e.touches[0]:e).clientX,$data._defaultPlayProgressPro=0;var t=$el.touchEffective.getClientRects()[0];t=$data.startX-t.left;$method.progressControlHandle(t,$el.touchEffective),$data._defaultPlayProgressPro=$el.progressPlay.style.width.substr(0,$el.progressPlay.style.width.length-1)||0,"touchstart"==e.type?($el.touchEffective.addEventListener("touchmove",$method.progressBarSeeking),$el.touchEffective.addEventListener("touchend",$method.progressBarSeeking),$el.touchEffective.addEventListener("touchcancel",$method.progressBarSeeking)):(document.addEventListener("mousemove",$method.progressBarSeeking),document.addEventListener("mouseup",$method.progressBarSeeking))},n=function(){$data.moveX=("touchmove"==e.type?e.touches[0]:e).clientX,$data.isTouchMove||($data.isTouchMove=!0,$el.progressBall.querySelector(".progress-ball").style.boxShadow="0 0 20px 3px "+$habit.themeColor,mobilePlugin&&(new mobilePlugin.interface)._onAgentEventAction("touchmove-footerbar")),$data.startX||($data.startX=$data.moveX);var t=$data.moveX-$data.startX;$method.progressControlHandle(t,$el.touchEffective)},r=function(){"touchend"==e.type?($el.touchEffective.removeEventListener("touchmove",$method.progressBarSeeking),$el.touchEffective.removeEventListener("touchend",$method.progressBarSeeking),$el.touchEffective.removeEventListener("touchcancel",$method.progressBarSeeking)):(document.removeEventListener("mousemove",$method.progressBarSeeking),document.removeEventListener("mouseup",$method.progressBarSeeking)),$data.isTouchMove&&($el.progressBall.querySelector(".progress-ball").style.boxShadow="0 1px 10px #cccccc",mobilePlugin&&(new mobilePlugin.interface)._onAgentEventAction("touchend-footerbar")),$el.videoObject.currentTime=$data.currentTime,$data.ball_move_status=!1,$method.resetTouchVariable(),$method.createTimerCloseControl()};switch(e.type){case"mousedown":t();break;case"mousemove":n();break;case"mouseup":r();break;case"touchstart":t();break;case"touchmove":n();break;case"touchend":r();break;case"touchcancel":$el.touchEffective.removeEventListener("touchmove",$method.progressBarSeeking),$el.touchEffective.removeEventListener("touchend",$method.progressBarSeeking),$el.touchEffective.removeEventListener("touchcancel",$method.progressBarSeeking),$data.ball_move_status=!1,$method.resetTouchVariable(),$method.createTimerCloseControl(),mobilePlugin&&(new mobilePlugin.interface)._onAgentEventAction("touchend-footerbar");break;default:e.type}}},resetTouchVariable:function(){$data.startX=null,$data.startY=null,$data.moveX=null,$data.moveY=null,setTimeout((function(){$data.isTouchMove=!1}),50)},createTimerCloseControl:function(e){var t;e=e||{},0!=$data.isControlsTimer&&("cancel"!=e.type?(t=function(){_this._global_.mp_timeout_3=setTimeout((function(){$method.toggleControlsDisplay({type:e.type||"timer"})}),option.closeControlsTimer||3500)},_this._global_.mp_timeout_3&&clearTimeout(_this._global_.mp_timeout_3),t()):_this._global_.mp_timeout_3&&clearTimeout(_this._global_.mp_timeout_3))},closeMpSidebar:function(){for(var e=!1,t=$el.mPlayer.querySelectorAll(".mplayer-sidebar"),n=0;n<t.length;n++)t[n].classList.contains("open")&&(t[n].classList.remove("open"),e=!($data.isShowRightSidebar=!1),"object"==_typeof(_this._global_.webpagePlugin)&&"removeEventListener"==_this._global_.webpagePlugin.eventStatus&&(new webpagePlugin.interface)._addEvent());return e},toggleControlsDisplay:function(e){(e=e||{type:""}).stopPropagation&&e.stopPropagation();var t=$method.closeMpSidebar();if(!t&&"DOMContentLoaded"!=e.type&&"resize"!=e.type&&"orientationchange"!=e.type){var n=["webkitTransform","transform","msTransform"],r=function(){$el.mplayerHeader.classList.toggle("show",!0)},i=function(){$el.mplayerHeader.classList.toggle("show",!1);for(var e=$el.mplayerHeader.getBoundingClientRect().height,t=0;t<n.length;t++)$el.mplayerHeader.style[n[t]]="translateY("+-e+"px)"},o=function(){$el.mplayerFooter.classList.toggle("show",!0),$el.miniProgress.style.opacity=0};t=function(){$el.mplayerFooter.classList.toggle("show",!1);for(var e=$el.mplayerFooter.getBoundingClientRect().height,t=$el.progressContainer.classList.contains("upper-position")?Number.parseInt($el.progressContainer.getBoundingClientRect().height/2)+1:0,r=0;r<n.length;r++)$el.mplayerFooter.style[n[r]]="translateY("+(e+t)+"px)";$el.miniProgress.style.opacity=1};return"showControls"==e.type?(o(),r(),$data.showScreenControls=!0,$method.createTimerCloseControl(),void _this.emit("controls-toggle",{show:!0})):"hideControls"==e.type?(t(),i(),$data.showScreenControls=!1,$method.createTimerCloseControl({type:"cancel"}),void _this.emit("controls-toggle",{show:!1})):void(("timer"!=e.type&&"dblscreen"!=e.type||0!=$data.showScreenControls)&&($data.showScreenControls?(t(),i(),$data.showScreenControls=!1,_this.emit("controls-toggle",{show:!1})):(o(),r(),$data.showScreenControls=!0,$method.createTimerCloseControl(),_this.emit("controls-toggle",{show:!0}),window.plus&&$data.isFullScreen&&plus.navigator.hideSystemNavigation())))}},onWaiting:function(){$data.isPlay=!1,_this._global_.mp_timeout_1||(_this._global_.mp_timeout_1=setTimeout((function(){$data.isPlay||$method.showLoading(),_this._global_.mp_timeout_1=null}),500))},onError:function(e){console.error(e);var t=arguments;$data.isDestroy&&1<=$data.playError||setTimeout((function(){(0===($el.videoObject.readyState||0)||$el.videoObject.duration<=1)&&($data.playError++,hls&&hls.media&&(hls.destroy(),hls=""),flv&&(flv.destroy(),flv=""),$el.mplayerError.style.display="block",$el.videoObject.style.opacity=0,$method.showCover(),$method.hideLoading(),$method.toggleControlsDisplay({type:"hideControls"}),$method.toggleEventListenerGlobal("remove"),$method.toggleEventListenerCustom("remove"),$el.mplayerError.addEventListener("click",(function(e){e.stopPropagation(),$method.reloadUrl()}),{once:!0}),_this.emit("error",_toConsumableArray(t)))}),3e3)},reloadUrl:function(e){$method.destroy(),$method.createTimerCloseControl({type:"cancel"}),e&&(option.src=e),$data.isFullScreen&&setTimeout((function(){$method.openFullScreen(),$method.fullScreenChangeAction("Y")}),50),$method.initCreateMplayer(!0)},destroy:function(){var e,t,n,r;$el.mPlayer.querySelector("#mplayer-media-wrapper video")&&($data.isDestroy=!0,$method.toggleEventListenerGlobal("remove"),$method.toggleEventListenerCustom("remove"),$el.mPlayer.classList.remove("fullscreen-scaling"),hls&&hls.media&&(hls.destroy(),hls=""),flv&&(flv.destroy(),flv=""),t=(e=$el.mPlayer.querySelector("#mplayer-media-wrapper")).querySelector("video"),n=(r=e.getBoundingClientRect()).height,r=r.width,document.pictureInPictureElement==t&&document.exitPictureInPicture(),e.style.height=n+"px",e.style.width=r+"px",t.pause(),t.removeAttribute("src"),e.innerHTML="",_this.emit("destroy"))},onProgress:function(){var e=$el.videoObject.buffered;if(0<e.length&&0<$data.duration){if(e.end(0)==$data.duration)return $el.miniBuffered.style.width="100%",$el.progressBuffered.style.width="100%",void($el.progressBuffered.style.borderRadius="5px");for(var t=0;t<e.length;t++){e.start(t);var n=e.end(t);if(n>$data.currentTime){n=n/$data.duration*100,$el.progressBuffered.style.width=n+"%",$el.miniBuffered.style.width=n+"%";break}}}},showLoading:function(){"inline-block"!=$el.mplayerLoading.style.display&&($el.mplayerLoading.style.display="inline-block")},hideLoading:function(){"none"!=$el.mplayerLoading.style.display&&($el.mplayerLoading.style.display="none")},showCover:function(){$el.mplayerCover.style.opacity<=0&&($el.mplayerCover.style.zIndex=8,$el.mplayerCover.style.opacity=.2)},hideCover:function(){"0"!=$el.mplayerCover.style.opacity&&($el.mplayerCover.style.opacity=0,$el.mplayerCover.style.zIndex=-1)},showToast:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t={message:"",duration:1500,style:{}};"string"==typeof e&&(t.message=e),"object"==_typeof(e)&&Object.keys(t).forEach((function(n){e[n]&&(t[n]=e[n])}));var n,r=0<("number"==typeof t.duration&&t.duration)?t.duration:1500,i=$el.mPlayer.querySelector("#mplayer-media-wrapper");i.querySelector("#mplayer-toast")&&$method.removeNode(i,"#mplayer-toast"),(n=document.createElement("div")).setAttribute("class","mplayer-toast toast-scaling"),n.setAttribute("id","mplayer-toast"),n.innerHTML=t.message,"[object Object]"==Object.prototype.toString.call(t.style)&&Object.keys(t.style).forEach((function(e){n.style[e]=t.style[e]})),i.appendChild(n),n.addEventListener("click",(function(e){e.stopPropagation()})),n.addEventListener("touchstart",(function(e){e.stopPropagation()})),_this._global_.handleIconTimer_2&&window.clearTimeout(_this._global_.handleIconTimer_2),_this._global_.handleIconTimer_2=setTimeout((function(){$method.removeNode(i,"#mplayer-toast")}),r)},toggleControlsStyle:function(e){for(var t,n=(option.custom||{}).footerControls||[],r=0;r<n.length;r++)!0!==n[r].oftenShow&&(t=n[r].slot,(t=$el.mplayerFooter.querySelector("[slot="+t+"]"))&&("portrait"==e&&(t.style.display="none"),"landscape"==e&&(t.style.display="block")))},onDocVisibilitychange:function(e){!1!==$data.showScreenControls&&$method.createTimerCloseControl({type:"visible"==document.visibilityState?"":"cancel"})},onScreenResize:function(e){function t(){$method.toggleControlsDisplay(e),$el.progressContainer.classList.remove("upper-position"),$method.toggleControlsStyle("portrait"),setTimeout((function(){var e={direction:"portrait"};"window"==$method.returnSys()&&(e.fullscreen=$data.isFullScreen),_this.emit("fullscreen-change",e)}),10),window.plus&&setTimeout((function(){plus.navigator.showSystemNavigation()}),200)}function n(){$method.toggleControlsDisplay(e),$el.progressContainer.classList.add("upper-position"),$method.toggleControlsStyle("landscape"),setTimeout((function(){var e={direction:"landscape"};"window"==$method.returnSys()&&(e.fullscreen=$data.isFullScreen),_this.emit("fullscreen-change",e)}),10),window.plus&&$data.isFullScreen&&setTimeout((function(){plus.navigator.hideSystemNavigation()}),200)}(e=e||{type:""}).stopPropagation&&e.stopPropagation(),$method.createTimerCloseControl(),$method.changeVideoSize(e),window.orientation||0==window.orientation?(0==window.orientation||180==window.orientation?t:n)():setTimeout((function(){(500<=$el.mPlayer.getBoundingClientRect().width?n:t)()}),0),0==$data.showScreenControls&&$method.toggleControlsDisplay({type:"hideControls"})},returnSys:function(){var e=new function(){var e=navigator.userAgent;return navigator.appVersion,{ios:!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:-1<e.indexOf("Android")||-1<e.indexOf("Linux"),iPhone:-1<e.indexOf("iPhone"),iPad:-1<e.indexOf("iPad")}};return e.iPhone||e.iPad||e.ios?"ios":e.android?"androd":"window"},nodesObserver:function(){var e=new MutationObserver((function(e,t){var n,r=_createForOfIteratorHelper(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;if("childList"===i.type){var o,a=_createForOfIteratorHelper(i.removedNodes);try{for(a.s();!(o=a.n()).done;){var s=o.value;if(s instanceof HTMLVideoElement){hls&&hls.media&&(hls.destroy(),hls=""),flv&&(flv.destroy(),flv=""),document.pictureInPictureElement==s&&document.exitPictureInPicture(),s.pause(),s.removeAttribute("src"),t.disconnect();break}}}catch(e){a.e(e)}finally{a.f()}}}}catch(e){r.e(e)}finally{r.f()}})),t=$el.mPlayer.querySelector(".video-wrapper");e.observe(t,{childList:!0})},toggleEventListenerCustom:function(e){var t=option.custom||{},n="add"==e?"addEventListener":"removeEventListener",r=t.headControls||[];if(0<r.length)for(var i=0;i<r.length;i++)!r[i].click instanceof Function||(a=r[i].slot,(s=$el.headerMenu.querySelector("[slot="+a+"]"))instanceof Element&&s[n]("click",r[i].click));var o=t.footerControls||[];if(0<o.length){var a,s;for(i=0;i<o.length;i++)!o[i].click instanceof Function||(a=o[i].slot,(s=$el.mplayerFooter.querySelector("[slot="+a+"]"))instanceof Element&&s[n]("click",o[i].click))}},toggleEventListenerGlobal:function(e,t){var n,r="add"==e?"addEventListener":"removeEventListener";n="onorientationchange"in window?"orientationchange":"resize",window[r](n,$method.onScreenResize),$el.backButton[r]("click",$method.onBack),$el.fullSwitch[r]("click",$method.fullToggle),$el.playSwitch[r]("click",$method.onPlayTap),$el.mPlayer[r]("click",$method.onContrainerTap),$el.mPlayer[r]("dblclick",$method.onContrainerTap),$el.touchEffective instanceof Element&&$el.touchEffective[r]("touchstart",$method.progressBarSeeking),$el.touchEffective instanceof Element&&$el.touchEffective[r]("mousedown",$method.progressBarSeeking),$el.videoObject[r]("webkitbeginfullscreen",$method.runtimeCompatibleHandle),$el.videoObject[r]("webkitendfullscreen",$method.runtimeCompatibleHandle),document[r]("resume",$method.plusRuntimeHandle),document[r]("pause",$method.plusRuntimeHandle),document[r]("visibilitychange",$method.onDocVisibilitychange),"playerReady"==t&&function(){$el.mplayerCover.addEventListener("touchstart",(function(e){e.stopPropagation()})),$el.mplayerCover.addEventListener("touchmove",(function(e){e.stopPropagation()})),$el.mplayerHeader.addEventListener("touchmove",(function(e){e.stopPropagation()})),$el.mplayerHeader.addEventListener("click",(function(e){e.stopPropagation()})),$el.mplayerHeader.addEventListener("dblclick",(function(e){e.stopPropagation()})),$el.mplayerFooter.addEventListener("touchmove",(function(e){e.stopPropagation()})),$el.mplayerFooter.addEventListener("click",(function(e){e.stopPropagation()})),$el.mplayerFooter.addEventListener("dblclick",(function(e){e.stopPropagation()})),$el.mplayerError.addEventListener("touchstart",(function(e){e.stopPropagation()})),$el.mplayerError.addEventListener("touchmove",(function(e){e.stopPropagation()})),$el.videoObject.addEventListener("canplaythrough",$method.onCanplaythrough),$el.videoObject.addEventListener("durationchange",$method.onDurationChange),option.live||$el.videoObject.addEventListener("timeupdate",$method.onTimeupdate),$el.videoObject.addEventListener("play",$method.onPlay),$el.videoObject.addEventListener("playing",$method.onPlaying),$el.videoObject.addEventListener("pause",$method.onPause),$el.videoObject.addEventListener("waiting",$method.onWaiting),$el.videoObject.addEventListener("error",$method.onError),option.live||$el.videoObject.addEventListener("progress",$method.onProgress);for(var e=$el.mPlayer.querySelectorAll(".mplayer-sidebar"),t=0;t<e.length;t++)e[t].addEventListener("touchstart",(function(e){e.stopPropagation()})),e[t].addEventListener("touchmove",(function(e){e.stopPropagation()})),e[t].addEventListener("touchend",(function(e){e.stopPropagation()})),e[t].addEventListener("click",(function(e){e.stopPropagation()})),e[t].addEventListener("dblclick",(function(e){e.stopPropagation()}))}()}},this.showRightSidebar=function(e){e=$el.mPlayer.querySelector("#mplayer-media-wrapper [slot="+e+"]"),e&&e.classList.contains("mplayer-sidebar")&&($method.createTimerCloseControl({type:"cancel"}),$method.toggleControlsDisplay({type:"sidebarRight"}),e.classList.add("open"),$data.isShowRightSidebar=!0,webpagePlugin&&(new webpagePlugin.interface)._removeEvent())},this.toggleControls=function(e){return!0===e?0==$data.showScreenControls?$method.toggleControlsDisplay({type:"showControls"}):$method.createTimerCloseControl():!1===e?1==$data.showScreenControls&&$method.toggleControlsDisplay({type:"hideControls"}):$method.toggleControlsDisplay(),e=new Object,e.closeTimer=function(){_this._global_.mp_timeout_3&&clearTimeout(_this._global_.mp_timeout_3),$data.isControlsTimer=!1},e.openTimer=function(){$data.isControlsTimer=!0},e},this.showToast=function(e){$method.showToast(e)},this.showLoading=function(){$method.showLoading()},this.hideLoading=function(){$method.hideLoading()},this.video=function(){return $el.videoObject},this.reloadUrl=function(e){$method.reloadUrl(e)},this.destroy=function(){$method.destroy()},this.openFullScreen=function(){$method.openFullScreen()},this.closeFullScreen=function(){$method.closeFullScreen()},this.sendError=function(e){$method.onError(e)},this.getControls=function(){return setTimeout((function(){$method.overloadingEl()}),10),$el.mPlayer.querySelectorAll("[control]")},"interactive"==document.readyState||"complete"==document.readyState?$method.initCreateMplayer():document.addEventListener("readystatechange",(function(){"interactive"==document.readyState&&$method.initCreateMplayer()})))};return MuiPlayer.prototype.on=function(e,t,n){this._event_[e]||(this._event_[e]=[]),this._event_[e]["MASTER"==n?"unshift":"push"](t)},MuiPlayer.prototype.off=function(e,t){this._event_[e]&&(t?0<=(t=this._event_[e].indexOf(t))&&this._event_[e].splice(t,1):this._event_[e]=void 0)},MuiPlayer.prototype.emit=function(e,t){if(this._event_[e])for(var n=0;n<this._event_[e].length;n++){var r=this._event_[e][n];t instanceof Array?r.apply(this,t):r(t)}},MuiPlayer.prototype.once=function(e,t){var n=this;this.on(e,(function r(){t.apply(this,Array.prototype.slice.call(arguments)),setTimeout((function(){n.off(e,r)}),200)}))},MuiPlayer}))}).call(this,__webpack_require__("92c4")(module))},"0838":function(e,t,n){},"0841":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}),t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,operates:e.operates,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange}}),t("add-dialog",{ref:"addDialog",on:{success:e.handleSuccess}})],1)},i=[],o=n("7591"),a=n("b775"),s=n("08a4"),l={name:"RolePage",components:{BasicTable:o["a"],addDialog:s["default"]},data(){return{loading:!1,filterOptions:{column:[{type:"input",label:"角色名称",value:"name"}]},filterData:{name:""},table:{columns:[{id:1,prop:"roleName",label:"角色名称"},{id:2,prop:"createTime",label:"创建时间",type:"date"}],pageSize:20,currentPage:1,data:[],total:0},operates:[{key:"edit",title:"编辑",btnStyle:"yellow",permission:"admin/adRole/edit",action:(e,t)=>{this.$refs.addDialog.edit(t.id)}},{key:"delete",title:"删除",permission:"admin/adRole/remove",btnStyle:"red",action:(e,t)=>{this.handleDelete(t)}}],headerOperates:[{key:"el-icon-plus",name:"添加角色",permission:"admin/adRole/add",action:()=>{this.$refs.addDialog.open()}}]}},created(){this.getList()},methods:{searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0,a["a"].post({url:"/admin/adRole/list",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,...this.filterData},success:e=>{this.table.data=e.list,this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1}})},showData(e){console.log(e)},handleSuccess(){this.getList()},handleDelete(e){this.$confirm("此操作将会删除该角色, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/admin/adRole/remove",params:{id:e.id},success:e=>{this.$message.success(e),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},clearFilter(){this.filterData={name:""},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()}}},u=l,c=(n("65b5"),n("1805")),d=Object(c["a"])(u,r,i,!1,null,"6f613474",null);t["default"]=d.exports},"0845":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}),t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,operates:e.operates,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange},scopedSlots:e._u([{key:"noticeDate",fn:function(n){return t("div",{},[t("span",[e._v(e._s(e.getDate(n.row.stratTime,"yyyy-MM-dd"))+" 至 "+e._s(e.getDate(n.row.endTime,"yyyy-MM-dd")))])])}}])}),t("add-dialog",{ref:"addDialog",on:{success:e.handleSuccess}})],1)},i=[],o=n("7591"),a=n("b775"),s=n("9f30"),l=n("b893"),u={name:"noticePage",components:{BasicTable:o["a"],addDialog:s["default"]},data(){return{loading:!1,getDate:l["b"],categoryOptions:[],filterOptions:{column:[{type:"input",label:"公告名称",value:"name"}]},filterData:{name:""},table:{columns:[{id:1,prop:"name",label:"公告名称"},{id:2,prop:"noticeDate",label:"公告时间",renderName:"noticeDate"},{id:4,prop:"sort",label:"排序"},{id:6,prop:"createTime",label:"创建时间",type:"date"}],pageSize:20,currentPage:1,data:[],total:0},operates:[{key:"edit",title:"编辑",btnStyle:"yellow",permission:"system/sysNotice/edit",action:(e,t)=>{this.$refs.addDialog.edit(t)}},{key:"delete",title:"删除",btnStyle:"red",permission:"system/sysNotice/remove",action:(e,t)=>{this.handleDelete(t)}}],headerOperates:[{key:"el-icon-plus",permission:"system/sysNotice/add",name:"添加公告",action:()=>{this.$refs.addDialog.open()}}]}},created(){this.getList()},methods:{searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0,a["a"].post({url:"/system/sysNotice/list",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,...this.filterData},success:e=>{this.table.data=e.list,this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1}})},handleSuccess(){this.getList()},handleDelete(e){this.$confirm("此操作将会删除该公告, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/system/sysNotice/remove",params:{id:e.id},success:e=>{this.$message.success(e),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},clearFilter(){this.filterData={name:""},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()}}},c=u,d=(n("4234"),n("1805")),f=Object(d["a"])(c,r,i,!1,null,"9a9d2bde",null);t["default"]=f.exports},"0889":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.addModifyVisible,width:"40%"},on:{"update:visible":function(t){e.addModifyVisible=t},close:e.close}},[t("el-form",{ref:"categoryRef",attrs:{model:e.addData,rules:e.categoryRule,"label-position":"left","label-width":"90px"}},[t("el-form-item",{attrs:{label:"分类名称:",prop:"name"}},[t("jat-input",{attrs:{placeholder:"请输入分类名称"},model:{value:e.addData.name,callback:function(t){e.$set(e.addData,"name",t)},expression:"addData.name"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)],1)},i=[],o=n("b775"),a={data(){return{addModifyVisible:!1,addInterfaceVisible:!1,dialogTitle:"",addData:{name:"",id:""},categoryRule:{name:[{required:!0,message:"请输入分类名称",trigger:"blur"}]}}},mounted(){},methods:{open(){this.dialogTitle="添加分类",this.addData.name="",this.addModifyVisible=!0},edit({id:e,name:t}){this.dialogTitle="编辑分类",this.addModifyVisible=!0,this.addData={id:e,name:t}},close(){this.$refs.categoryRef&&this.$refs.categoryRef.clearValidate(),this.addModifyVisible=!1},handleSubmit(){this.$refs.categoryRef.validate(e=>{e&&(this.addData.id?o["a"].post({url:"/system/sysAdvertiseCategory/edit",params:{...this.addData},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}):o["a"].post({url:"/system/sysAdvertiseCategory/add",params:{name:this.addData.name},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}))})}}},s=a,l=n("1805"),u=Object(l["a"])(s,r,i,!1,null,"b671020e",null);t["default"]=u.exports},"08a4":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.dialogTile,"close-on-click-modal":!1,visible:e.addModifyVisible,width:"60%"},on:{"update:visible":function(t){e.addModifyVisible=t},close:e.close}},[t("el-form",{ref:"roleRef",attrs:{model:e.addData,rules:e.roleRule,"label-position":"left","label-width":"90px"}},[t("el-form-item",{attrs:{label:"角色名称:",prop:"roleName"}},[t("jat-input",{attrs:{placeholder:"请输入您要添加的角色名称"},model:{value:e.addData.roleName,callback:function(t){e.$set(e.addData,"roleName",t)},expression:"addData.roleName"}})],1)],1),t("div",{staticClass:"dialog_content"},[t("el-tree",{ref:"tree",staticClass:"tree_box",attrs:{data:e.menuList,"show-checkbox":"","node-key":"id","default-expand-all":"",props:e.defaultProps},on:{"node-expand":e.handleExpand},scopedSlots:e._u([{key:"default",fn:function({node:n}){return t("p",{staticClass:"custom-tree-node",class:{foo:3==n.level}},[t("span",[e._v(e._s(n.label))]),2==n.level?t("span",{staticClass:"add_box",on:{click:function(t){return t.stopPropagation(),e.handleAddInterface(n)}}},[t("i",{staticClass:"el-icon-circle-plus-outline"})]):e._e()])}}])})],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmitRoles}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"添加接口","close-on-click-modal":!1,visible:e.addInterfaceVisible,width:"30%"},on:{"update:visible":function(t){e.addInterfaceVisible=t},close:e.closeInterface}},[t("el-form",{ref:"intefaceRef",attrs:{"label-position":"right","label-width":"100px",rules:e.interfaceRules,model:e.interfaceData}},[t("el-form-item",{attrs:{label:"接口名称:",prop:"menuName"}},[t("jat-input",{model:{value:e.interfaceData.menuName,callback:function(t){e.$set(e.interfaceData,"menuName",t)},expression:"interfaceData.menuName"}})],1),t("el-form-item",{attrs:{label:"接口路径:",prop:"requestUrl"}},[t("jat-input",{model:{value:e.interfaceData.requestUrl,callback:function(t){e.$set(e.interfaceData,"requestUrl",t)},expression:"interfaceData.requestUrl"}})],1),t("el-form-item",{attrs:{label:"接口状态:"}},[t("jat-input",{model:{value:e.interfaceData.status,callback:function(t){e.$set(e.interfaceData,"status",t)},expression:"interfaceData.status"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.closeInterface}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmitInterface}},[e._v("确 定")])],1)],1)],1)},i=[],o=n("b775"),a={data(){return{addModifyVisible:!1,addInterfaceVisible:!1,dialogTile:"",addData:{roleName:"",id:""},roleRule:{roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"}]},interfaceRules:{menuName:[{required:!0,message:"请输入接口名称",trigger:"blur"}],requestUrl:[{required:!0,message:"请输入接口路径",trigger:"blur"}]},defaultProps:{children:"children",label:"label",disabled:(e,t)=>!(3!==t.level||!e.status)&&-1==e.status},menuList:[],interfaceData:{parentId:"",menuName:"",requestUrl:"",status:0}}},mounted(){},methods:{open(){this.addData.roleName="",this.addModifyVisible=!0,this.dialogTile="添加角色",this.getRoleTree()},edit(e){this.dialogTile="编辑角色",this.getRoleTree(),this.addModifyVisible=!0,this.getRoleInfo(e)},close(){this.$refs.tree&&this.$refs.tree.setCheckedKeys([]),this.$refs.roleRef&&this.$refs.roleRef.clearValidate(),this.addModifyVisible=!1,this.addData={roleName:"",id:""}},closeInterface(){this.interfaceData={parentId:"",menuName:"",requestUrl:this.interfaceData.requestUrl,status:0},this.$refs.intefaceRef&&this.$refs.intefaceRef.clearValidate(),this.addInterfaceVisible=!1},getRoleTree(){o["a"].post({url:"/admin/adInfoRole/getAllMenuPre",params:{},success:e=>{this.menuList=e,this.handleExpand()}})},getRoleInfo(e){this.addData.id=e,o["a"].post({url:"/admin/adRole/detail",params:{id:e},success:e=>{this.$refs.tree.setCheckedKeys(e.adRoleMenuList),this.addData.roleName=e.role.roleName}})},handleExpand(){setTimeout(()=>{this.changeCss()},10)},changeCss(){for(var e=document.querySelectorAll(".foo"),t=0;t<e.length;t++)e[t].parentNode.style.cssFloat="left",e[t].parentNode.style.styleFloat="left",e[t].parentNode.onmouseover=function(){this.style.backgroundColor="#fff"}},handleAddInterface(e){console.log(e),this.addInterfaceVisible=!0,this.interfaceData.parentId=e.data.id},handleSubmitInterface(){this.$refs.intefaceRef.validate(e=>{e&&o["a"].post({url:"/admin/adMenu/public/addInterface",params:this.interfaceData,success:e=>{this.$message.success(e),this.closeInterface(),this.getRoleTree()}})})},handleSubmitRoles(){this.$refs.roleRef.validate(e=>{if(e){const e=this.$refs.tree.getCheckedKeys(),t=this.$refs.tree.getHalfCheckedKeys(),n=JSON.stringify([...e,...t]);this.addData.id?o["a"].post({url:"/admin/adRole/roleChangeMenuPre",params:{menuIds:n,id:this.addData.id},success:e=>{this.handleEditRoles(n)}}):this.handleAddRoles(n)}})},handleAddRoles(e){o["a"].post({url:"/admin/adRole/add",params:{menuIds:e,name:this.addData.roleName},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}})},handleEditRoles(){o["a"].post({url:"/admin/adRole/edit",params:{id:this.addData.id,name:this.addData.roleName},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}})}}},s=a,l=(n("ed2b"),n("adf1"),n("1805")),u=Object(l["a"])(s,r,i,!1,null,"904fc410",null);t["default"]=u.exports},"0b9a":function(e,t,n){},"0cf9":function(e,t,n){"use strict";n("0758")},"0e19":function(e,t,n){"use strict";n("8f1b")},"0ec1":function(e,t,n){"use strict";n("12eb")},"101b":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.addChaptersVisible,"append-to-body":!0,width:"50%"},on:{"update:visible":function(t){e.addChaptersVisible=t},close:e.close}},[t("el-form",{ref:"addChapterRef",attrs:{model:e.addData,rules:e.addChapterRule,"label-position":"left","label-width":"100px"}},[t("el-form-item",{attrs:{label:"父章节名称:",prop:"name"}},[e._v(" "+e._s(e.parentInfo.name)+" ")]),t("el-form-item",{attrs:{label:"章节名称:",prop:"name"}},[t("jat-input",{attrs:{placeholder:"请输入名称"},model:{value:e.addData.name,callback:function(t){e.$set(e.addData,"name",t)},expression:"addData.name"}})],1),t("el-form-item",{attrs:{label:"视频封面:",prop:"image"}},[t("upload-image",{model:{value:e.addData.image,callback:function(t){e.$set(e.addData,"image",t)},expression:"addData.image"}})],1),t("el-form-item",{attrs:{label:"视频链接:",prop:"url"}},[t("jat-input",{attrs:{placeholder:"请输入视频链接或者点击上传"},model:{value:e.addData.url,callback:function(t){e.$set(e.addData,"url",t)},expression:"addData.url"}}),t("upload-file",{attrs:{accept:".mp4",valueType:"string",tip:"上传期间请不要关闭或者刷新浏览器"},model:{value:e.addData.url,callback:function(t){e.$set(e.addData,"url",t)},expression:"addData.url"}})],1),t("el-form-item",{attrs:{label:"视频时长:",prop:"lengthTime"}},[t("jat-input",{attrs:{disabled:"",placeholder:"请输入视频时长"},model:{value:e.addData.lengthTime,callback:function(t){e.$set(e.addData,"lengthTime",t)},expression:"addData.lengthTime"}})],1),t("el-form-item",{attrs:{label:"排序:",prop:"sort"}},[t("jat-input",{directives:[{name:"input",rawName:"v-input.int",modifiers:{int:!0}}],attrs:{placeholder:"请输入排序"},model:{value:e.addData.sort,callback:function(t){e.$set(e.addData,"sort",t)},expression:"addData.sort"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)},i=[],o=n("cbc3"),a=n("b775"),s=n("c46c"),l={components:{uploadImage:o["a"],uploadFile:s["a"]},data(){return{addChaptersVisible:!1,dialogTitle:"",parentInfo:{},addData:{courseId:"",name:"",image:"",url:"",lengthTime:void 0,sort:255,id:""},categoryOptions:[],addChapterRule:{name:[{required:!0,message:"请输入章节名称",trigger:"blur"}]}}},mounted(){},methods:{open(e,t){this.dialogTitle="添加章节",this.parentInfo=e,this.addData.courseId=t,this.addChaptersVisible=!0},edit({name:e,image:t,url:n,lengthTime:r,id:i,parentInfo:o,sort:a},s){this.dialogTitle="编辑章节",this.addChaptersVisible=!0,this.parentInfo=o,this.addData={name:e,image:t,url:n,sort:a,lengthTime:r,id:i,courseId:s}},geVideoTime(e){const t=new Audio(e);let n=0,r=this;t.addEventListener("loadedmetadata",(function(e){n=t.duration,r.addData.lengthTime=r.formatSeconds(n)}))},close(){this.$refs.addChapterRef&&this.$refs.addChapterRef.clearValidate(),this.addData={courseId:"",name:"",image:"",url:"",sort:255,lengthTime:void 0,id:""},this.addChaptersVisible=!1},handleBlurVideo(){this.addData.url&&this.geVideoTime(this.addData.url)},formatSeconds(e){var t=parseInt(e),n=0,r=0;t>60&&(n=parseInt(t/60),t=parseInt(t%60),n>60&&(r=parseInt(n/60),n=parseInt(n%60)));var i=""+parseInt(t);return n>0&&(i=parseInt(n)+":"+i),r>0&&(i=parseInt(r)+":"+i),i},handleSubmit(){this.$refs.addChapterRef.validate(e=>{if(e){const{id:e,...t}=this.addData;e?a["a"].post({url:"/admin/adCourseChapters/uploadCourseEdit",params:{id:e,parentId:this.parentInfo.id,...t},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}):a["a"].post({url:"/admin/adCourseChapters/uploadCourseAdd",params:{parentId:this.parentInfo.id,...t},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}})}})}},watch:{"addData.url":{handler(e){e&&this.handleBlurVideo()}}}},u=l,c=n("1805"),d=Object(c["a"])(u,r,i,!1,null,"3e7a8240",null);t["default"]=d.exports},"12eb":function(e,t,n){},1356:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.addModifyVisible,width:"50%"},on:{"update:visible":function(t){e.addModifyVisible=t},close:e.close}},[t("el-form",{ref:"advertRef",attrs:{model:e.addData,rules:e.advertRule,"label-position":"left","label-width":"90px"}},[t("el-form-item",{attrs:{label:"广告位置:",prop:"categoryId"}},[t("jat-select",{attrs:{placeholder:"请选择广告位置",clearable:""},model:{value:e.addData.categoryId,callback:function(t){e.$set(e.addData,"categoryId",t)},expression:"addData.categoryId"}},e._l(e.categoryOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"广告名称:",prop:"name"}},[t("jat-input",{attrs:{placeholder:"请输入名称"},model:{value:e.addData.name,callback:function(t){e.$set(e.addData,"name",t)},expression:"addData.name"}})],1),t("el-form-item",{attrs:{label:"广告图片:",prop:"image"}},[t("upload-image",{model:{value:e.addData.image,callback:function(t){e.$set(e.addData,"image",t)},expression:"addData.image"}})],1),t("el-form-item",{attrs:{label:"广告链接:",prop:"href"}},[t("jat-input",{attrs:{placeholder:"请输入广告链接"},model:{value:e.addData.href,callback:function(t){e.$set(e.addData,"href",t)},expression:"addData.href"}})],1),t("el-form-item",{attrs:{label:"广告内容:",prop:"content"}},[t("tinymce-edit",{model:{value:e.addData.content,callback:function(t){e.$set(e.addData,"content",t)},expression:"addData.content"}})],1),t("el-form-item",{attrs:{label:"广告排序:",prop:"sort"}},[t("jat-input",{attrs:{placeholder:"请输入广告排序"},model:{value:e.addData.sort,callback:function(t){e.$set(e.addData,"sort",e._n(t))},expression:"addData.sort"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)],1)},i=[],o=n("cbc3"),a=n("b775"),s=n("9adf"),l={components:{uploadImage:o["a"],tinymceEdit:s["a"]},data(){return{addModifyVisible:!1,dialogTitle:"",addData:{categoryId:"",name:"",image:"",href:"",content:"",sort:void 0,id:""},categoryOptions:[],advertRule:{categoryId:[{required:!0,message:"请选择广告位置",trigger:"blur"}],name:[{required:!0,message:"请输入广告名称",trigger:"blur"}],sort:[{required:!0,message:"请输入广告排序",trigger:"blur"},{type:"number",message:"请输入整数"}]}}},mounted(){this.getCategoryList()},methods:{open(){this.dialogTitle="添加广告",this.addData.name="",this.addModifyVisible=!0},edit({id:e,name:t,advertiseCategoryId:n,herf:r,image:i,sort:o,content:a}){this.dialogTitle="编辑广告",this.addModifyVisible=!0,this.addData={id:e,name:t,categoryId:n,href:r,image:i,sort:o,content:a}},close(){this.$refs.advertRef&&this.$refs.advertRef.clearValidate(),this.addData={categoryId:"",name:"",image:"",href:"",content:"",sort:"",id:""},this.addModifyVisible=!1},getCategoryList(){a["a"].post({url:"/system/sysAdvertise/getAllAdvertisingSpace",params:{},success:e=>{this.categoryOptions=e}})},handleSubmit(){this.$refs.advertRef.validate(e=>{e&&(this.addData.id?a["a"].post({url:"/system/sysAdvertise/edit",params:{...this.addData},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}):a["a"].post({url:"/system/sysAdvertise/add",params:this.addData,success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}))})}}},u=l,c=n("1805"),d=Object(c["a"])(u,r,i,!1,null,"3bb3965a",null);t["default"]=d.exports},"16f2":function(e,t,n){"use strict";n("b611")},"18f5":function(e,t,n){},"1ac1":function(e,t){(function(){"use strict";var e=function(e){var t=e,n=function(){return t},r=function(e){t=e};return{get:n,set:r}},t=tinymce.util.Tools.resolve("tinymce.PluginManager"),n=function(e){return!!e.hasPlugin("powerpaste",!0)&&("undefined"!==typeof window.console&&window.console.log&&window.console.log("PowerPaste is incompatible with Paste plugin! Remove 'paste' from the 'plugins' option."),!0)},r=function(e){return{clipboard:e}},i=function(e){var t=typeof e;return null===e?"null":"object"===t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t},o=function(e){return function(t){return i(t)===e}},a=function(e){return function(t){return typeof t===e}},s=o("array"),l=function(e){return null===e||void 0===e},u=function(e){return!l(e)},c=a("function"),d=function(){},f=function(e){return function(){return e}},h=function(e){return e},m=f(!1),p=f(!0),g=function(){return v},v=function(){var e=function(e){return e()},t=h,n={fold:function(e,t){return e()},isSome:m,isNone:p,getOr:t,getOrThunk:e,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:f(null),getOrUndefined:f(void 0),or:t,orThunk:e,map:g,each:d,bind:g,exists:m,forall:p,filter:function(){return g()},toArray:function(){return[]},toString:f("none()")};return n}(),b=function(e){var t=f(e),n=function(){return i},r=function(t){return t(e)},i={fold:function(t,n){return n(e)},isSome:p,isNone:m,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return b(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?i:v},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return i},y=function(e){return null===e||void 0===e?v:b(e)},w={some:b,none:g,from:y},S=Array.prototype.slice,x=Array.prototype.push,C=function(e,t){for(var n=0,r=e.length;n<r;n++){var i=e[n];if(t(i,n))return!0}return!1},T=function(e,t){for(var n=e.length,r=new Array(n),i=0;i<n;i++){var o=e[i];r[i]=t(o,i)}return r},D=function(e,t){for(var n=0,r=e.length;n<r;n++){var i=e[n];t(i,n)}},k=function(e,t){for(var n=[],r=0,i=e.length;r<i;r++){var o=e[r];t(o,r)&&n.push(o)}return n},E=function(e,t,n){return D(e,(function(e,r){n=t(n,e,r)})),n},_=function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!s(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);x.apply(t,e[n])}return t},A=function(e,t){return _(T(e,t))},L=c(Array.from)?Array.from:function(e){return S.call(e)},O=function(){return O=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},O.apply(this,arguments)},R=function(t){var n=e(w.none()),r=function(){return n.get().each(t)},i=function(){r(),n.set(w.none())},o=function(){return n.get().isSome()},a=function(){return n.get()},s=function(e){r(),n.set(w.some(e))};return{clear:i,isSet:o,get:a,set:s}},I=function(){var e=R(d),t=function(t){return e.get().each(t)};return O(O({},e),{on:t})},P=function(e,t,n){return""===t||e.length>=t.length&&e.substr(n,n+t.length)===t},M=function(e,t){return P(e,t,0)},N=function(e,t){return P(e,t,e.length-t.length)},F=function(e,t){return t<=0?"":new Array(t+1).join(e)},B=tinymce.util.Tools.resolve("tinymce.Env"),$=tinymce.util.Tools.resolve("tinymce.util.Delay"),z=tinymce.util.Tools.resolve("tinymce.util.Promise"),U=tinymce.util.Tools.resolve("tinymce.util.VK"),V=function(e,t,n,r){return e.fire("PastePreProcess",{content:t,internal:n,wordContent:r})},H=function(e,t,n,r){return e.fire("PastePostProcess",{node:t,internal:n,wordContent:r})},j=function(e,t){return e.fire("PastePlainTextToggle",{state:t})},q=function(e,t){return e.fire("paste",{ieFake:t})},G=tinymce.util.Tools.resolve("tinymce.util.Tools"),W=function(e){return e.getParam("paste_block_drop",!1)},K=function(e){return e.getParam("paste_data_images",!1)},Y=function(e){return e.getParam("paste_filter_drop",!0)},X=function(e){return e.getParam("paste_preprocess")},J=function(e){return e.getParam("paste_postprocess")},Q=function(e){return e.getParam("paste_webkit_styles")},Z=function(e){return e.getParam("paste_remove_styles_if_webkit",!0)},ee=function(e){return e.getParam("paste_merge_formats",!0)},te=function(e){return e.getParam("smart_paste",!0)},ne=function(e){return e.getParam("paste_as_text",!1)},re=function(e){return e.getParam("paste_retain_style_properties")},ie=function(e){var t="-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody";return e.getParam("paste_word_valid_elements",t)},oe=function(e){return e.getParam("paste_convert_word_fake_lists",!0)},ae=function(e){return e.getParam("paste_enable_default_filters",!0)},se=function(e){return e.getParam("validate")},le=function(e){return e.getParam("allow_html_data_urls",!1,"boolean")},ue=function(e){return e.getParam("paste_data_images",!1,"boolean")},ce=function(e){return e.getParam("images_dataimg_filter")},de=function(e){return e.getParam("images_reuse_filename")},fe=function(e){return e.getParam("forced_root_block")},he=function(e){return e.getParam("forced_root_block_attrs")},me=function(e){return e.getParam("paste_tab_spaces",4,"number")},pe=function(e){var t="jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp";return G.explode(e.getParam("images_file_types",t,"string"))},ge="x-tinymce/html",ve="\x3c!-- "+ge+" --\x3e",be=function(e){return ve+e},ye=function(e){return e.replace(ve,"")},we=function(e){return-1!==e.indexOf(ve)},Se=f(ge),xe=Object.hasOwnProperty,Ce=function(e,t){return xe.call(e,t)},Te=tinymce.util.Tools.resolve("tinymce.html.Entities"),De=function(e){return!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(e)},ke=function(e){return e.replace(/\r?\n/g,"<br>")},Ee=function(e,t){var n=[],r="<"+e;if("object"===typeof t){for(var i in t)Ce(t,i)&&n.push(i+'="'+Te.encodeAllRaw(t[i])+'"');n.length&&(r+=" "+n.join(" "))}return r+">"},_e=function(e,t,n){var r=e.split(/\n\n/),i=Ee(t,n),o="</"+t+">",a=G.map(r,(function(e){return e.split(/\n/).join("<br />")})),s=function(e){return i+e+o};return 1===a.length?a[0]:G.map(a,s).join("")},Ae=function(e,t,n){return t?_e(e,!0===t?"p":t,n):ke(e)},Le=tinymce.util.Tools.resolve("tinymce.html.DomParser"),Oe=tinymce.util.Tools.resolve("tinymce.html.Serializer"),Re=" ",Ie=tinymce.util.Tools.resolve("tinymce.html.Node"),Pe=tinymce.util.Tools.resolve("tinymce.html.Schema"),Me=function(e){return e.constructor===RegExp},Ne=function(e,t){return G.each(t,(function(t){e=Me(t)?e.replace(t,""):e.replace(t[0],t[1])})),e},Fe=function(e){var t=Pe(),n=Le({},t),r="",i=t.getShortEndedElements(),o=G.makeMap("script noscript style textarea video audio iframe object"," "),a=t.getBlockElements(),s=function(e){var t=e.name,n=e;if("br"!==t){if("wbr"!==t)if(i[t]&&(r+=" "),o[t])r+=" ";else{if(3===e.type&&(r+=e.value),!e.shortEnded&&(e=e.firstChild))do{s(e)}while(e=e.next);a[t]&&n.next&&(r+="\n","p"===t&&(r+="\n"))}}else r+="\n"};return e=Ne(e,[/<!\[[^\]]+\]>/g]),s(n.parse(e)),r},Be=function(e){var t=function(e,t,n){return t||n?Re:" "};return e=Ne(e,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/gi,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,t],/<br class="Apple-interchange-newline">/g,/<br>$/i]),e},$e=function(e){var t=0;return function(){return e+t++}},ze=function(e){var t=e.toLowerCase(),n={jpg:"jpeg",jpe:"jpeg",jfi:"jpeg",jif:"jpeg",jfif:"jpeg",pjpeg:"jpeg",pjp:"jpeg",svg:"svg+xml"};return G.hasOwn(n,t)?"image/"+n[t]:"image/"+t},Ue=function(e){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^']*\bmso-|w:WordDocument/i.test(e)||/class="OutlineElement/.test(e)||/id="?docs\-internal\-guid\-/.test(e)},Ve=function(e){var t=!1,n=[/^[IVXLMCD]+\.[ \u00a0]/,/^[ivxlmcd]+\.[ \u00a0]/,/^[a-z]{1,2}[\.\)][ \u00a0]/,/^[A-Z]{1,2}[\.\)][ \u00a0]/,/^[0-9]+\.[ \u00a0]/,/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/];return e=e.replace(/^[\u00a0 ]+/,""),G.each(n,(function(n){if(n.test(e))return t=!0,!1})),t},He=function(e){return/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(e)},je=function(e){var t,n,r=1,i=function(e){var t="";if(3===e.type)return e.value;if(e=e.firstChild)do{t+=i(e)}while(e=e.next);return t},o=function(e,t){if(3===e.type&&t.test(e.value))return e.value=e.value.replace(t,""),!1;if(e=e.firstChild)do{if(!o(e,t))return!1}while(e=e.next);return!0},a=function(e){if(e._listIgnore)e.remove();else if(e=e.firstChild)do{a(e)}while(e=e.next)},s=function(e,i,s){var l=e._listLevel||r;l!==r&&(l<r?t&&(t=t.parent.parent):(n=t,t=null)),t&&t.name===i?t.append(e):(n=n||t,t=new Ie(i,1),s>1&&t.attr("start",""+s),e.wrap(t)),e.name="li",l>r&&n&&n.lastChild.append(t),r=l,a(e),o(e,/^\u00a0+/),o(e,/^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/),o(e,/^\u00a0+/)},l=[],u=e.firstChild;while("undefined"!==typeof u&&null!==u)if(l.push(u),u=u.walk(),null!==u)while("undefined"!==typeof u&&u.parent!==e)u=u.walk();for(var c=0;c<l.length;c++)if(e=l[c],"p"===e.name&&e.firstChild){var d=i(e);if(He(d)){s(e,"ul");continue}if(Ve(d)){var f=/([0-9]+)\./.exec(d),h=1;f&&(h=parseInt(f[1],10)),s(e,"ol",h);continue}if(e._listLevel){s(e,"ul",1);continue}t=null}else n=t,t=null},qe=function(e,t,n,r){var i={},o=e.dom.parseStyle(r);G.each(o,(function(o,a){switch(a){case"mso-list":var s=/\w+ \w+([0-9]+)/i.exec(r);s&&(n._listLevel=parseInt(s[1],10)),/Ignore/i.test(o)&&n.firstChild&&(n._listIgnore=!0,n.firstChild._listIgnore=!0);break;case"horiz-align":a="text-align";break;case"vert-align":a="vertical-align";break;case"font-color":case"mso-foreground":a="color";break;case"mso-background":case"mso-highlight":a="background";break;case"font-weight":case"font-style":return void("normal"!==o&&(i[a]=o));case"mso-element":if(/^(comment|comment-list)$/i.test(o))return void n.remove();break}0!==a.indexOf("mso-comment")?0!==a.indexOf("mso-")&&("all"===re(e)||t&&t[a])&&(i[a]=o):n.remove()})),/(bold)/i.test(i["font-weight"])&&(delete i["font-weight"],n.wrap(new Ie("b",1))),/(italic)/i.test(i["font-style"])&&(delete i["font-style"],n.wrap(new Ie("i",1)));var a=e.dom.serializeStyle(i,n.name);return a||null},Ge=function(e,t){var n,r=re(e);r&&(n=G.makeMap(r.split(/[, ]/))),t=Ne(t,[/<br class="?Apple-interchange-newline"?>/gi,/<b[^>]+id="?docs-internal-[^>]*>/gi,/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi,Re],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(e,t){return t.length>0?t.replace(/./," ").slice(Math.floor(t.length/2)).split("").join(Re):""}]]);var i=ie(e),o=Pe({valid_elements:i,valid_children:"-li[p]"});G.each(o.elements,(function(e){e.attributes.class||(e.attributes.class={},e.attributesOrder.push("class")),e.attributes.style||(e.attributes.style={},e.attributesOrder.push("style"))}));var a=Le({},o);a.addAttributeFilter("style",(function(t){var r,i=t.length;while(i--)r=t[i],r.attr("style",qe(e,n,r,r.attr("style"))),"span"===r.name&&r.parent&&!r.attributes.length&&r.unwrap()})),a.addAttributeFilter("class",(function(e){var t,n,r=e.length;while(r--)t=e[r],n=t.attr("class"),/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(n)&&t.remove(),t.attr("class",null)})),a.addNodeFilter("del",(function(e){var t=e.length;while(t--)e[t].remove()})),a.addNodeFilter("a",(function(e){var t,n,r,i=e.length;while(i--)if(t=e[i],n=t.attr("href"),r=t.attr("name"),n&&-1!==n.indexOf("#_msocom_"))t.remove();else if(n&&0===n.indexOf("file://")&&(n=n.split("#")[1],n&&(n="#"+n)),n||r){if(r&&!/^_?(?:toc|edn|ftn)/i.test(r)){t.unwrap();continue}t.attr({href:n,name:r})}else t.unwrap()}));var s=a.parse(t);return oe(e)&&je(s),t=Oe({validate:se(e)},o).serialize(s),t},We=function(e,t){return ae(e)?Ge(e,t):t},Ke=function(e,t){var n=Le({},e.schema);n.addNodeFilter("meta",(function(e){G.each(e,(function(e){e.remove()}))}));var r=n.parse(t,{forced_root_block:!1,isRootContent:!0});return Oe({validate:se(e)},e.schema).serialize(r)},Ye=function(e,t){return{content:e,cancelled:t}},Xe=function(e,t,n,r){var i=e.dom.create("div",{style:"display:none"},t),o=H(e,i,n,r);return Ye(o.node.innerHTML,o.isDefaultPrevented())},Je=function(e,t,n,r){var i=V(e,t,n,r),o=Ke(e,i.content);return e.hasEventListeners("PastePostProcess")&&!i.isDefaultPrevented()?Xe(e,o,n,r):Ye(o,i.isDefaultPrevented())},Qe=function(e,t,n){var r=Ue(t),i=r?We(e,t):t;return Je(e,i,n,r)},Ze=function(e,t){return e.insertContent(t,{merge:ee(e),paste:!0}),!0},et=function(e){return/^https?:\/\/[\w\-\/+=.,!;:&%@^~(){}?#]+$/i.test(e)},tt=function(e,t){return et(t)&&C(pe(e),(function(e){return N(t.toLowerCase(),"."+e.toLowerCase())}))},nt=function(e,t,n){return e.undoManager.extra((function(){n(e,t)}),(function(){e.insertContent('<img src="'+t+'">')})),!0},rt=function(e,t,n){return e.undoManager.extra((function(){n(e,t)}),(function(){e.execCommand("mceInsertLink",!1,t)})),!0},it=function(e,t,n){return!(!1!==e.selection.isCollapsed()||!et(t))&&rt(e,t,n)},ot=function(e,t,n){return!!tt(e,t)&&nt(e,t,n)},at=function(e,t){G.each([it,ot,Ze],(function(n){return!0!==n(e,t,Ze)}))},st=function(e,t,n){n||!1===te(e)?Ze(e,t):at(e,t)},lt=function(e){return-1!==" \f\t\v".indexOf(e)},ut=function(e){return"\n"===e||"\r"===e},ct=function(e,t){return t<e.length&&t>=0&&ut(e[t])},dt=function(e,t){var n=F(" ",me(e)),r=t.replace(/\t/g,n),i=E(r,(function(e,t){return lt(t)||t===Re?e.pcIsSpace||""===e.str||e.str.length===r.length-1||ct(r,e.str.length+1)?{pcIsSpace:!1,str:e.str+Re}:{pcIsSpace:!0,str:e.str+" "}:{pcIsSpace:ut(t),str:e.str+t}}),{pcIsSpace:!1,str:""});return i.str},ft=function(e,t,n,r){var i=Qe(e,t,n);!1===i.cancelled&&st(e,i.content,r)},ht=function(e,t,n){var r=n||we(t);ft(e,ye(t),r,!1)},mt=function(e,t){var n=e.dom.encode(t).replace(/\r\n/g,"\n"),r=dt(e,n),i=Ae(r,fe(e),he(e));ft(e,i,!1,!0)},pt=function(e){var t={},n="data:text/mce-internal,";if(e){if(e.getData){var r=e.getData("Text");r&&r.length>0&&-1===r.indexOf(n)&&(t["text/plain"]=r)}if(e.types)for(var i=0;i<e.types.length;i++){var o=e.types[i];try{t[o]=e.getData(o)}catch(a){t[o]=""}}}return t},gt=function(e,t){return pt(t.clipboardData||e.getDoc().dataTransfer)},vt=function(e,t){return t in e&&e[t].length>0},bt=function(e){return vt(e,"text/html")||vt(e,"text/plain")},yt=function(e){var t=/data:([^;]+);base64,([a-z0-9\+\/=]+)/i.exec(e);return t?{type:t[1],data:decodeURIComponent(t[2])}:{type:null,data:null}},wt=function(e,t){var n=ce(e);return!n||n(t)},St=function(e,t){var n=t.match(/([\s\S]+?)(?:\.[a-z0-9.]+)$/i);return u(n)?e.dom.encode(n[1]):null},xt=$e("mceclip"),Ct=function(e,t){var n=yt(t.uri),r=n.data,i=n.type,o=xt(),a=t.blob,s=new Image;if(s.src=t.uri,wt(e,s)){var l=e.editorUpload.blobCache,c=void 0,d=l.getByData(r,i);if(d)c=d;else{var f=de(e)&&u(a.name),h=f?St(e,a.name):o,m=f?a.name:void 0;c=l.create(o,a,r,h,m),l.add(c)}ht(e,'<img src="'+c.blobUri()+'">',!1)}else ht(e,'<img src="'+t.uri+'">',!1)},Tt=function(e){return"paste"===e.type},Dt=function(e){return u(e.getAsFile)},kt=function(e){return z.all(T(e,(function(e){return new z((function(t){var n=Dt(e)?e.getAsFile():e,r=new window.FileReader;r.onload=function(){t({blob:n,uri:r.result})},r.readAsDataURL(n)}))})))},Et=function(e){var t=pe(e);return function(e){return M(e.type,"image/")&&C(t,(function(t){return ze(t)===e.type}))}},_t=function(e,t){var n=t.items?A(L(t.items),(function(e){return"file"===e.kind?[e.getAsFile()]:[]})):[],r=t.files?L(t.files):[];return k(n.length>0?n:r,Et(e))},At=function(e,t,n){var r=Tt(t)?t.clipboardData:t.dataTransfer;if(ue(e)&&r){var i=_t(e,r);if(i.length>0)return t.preventDefault(),kt(i).then((function(t){n&&e.selection.setRng(n),D(t,(function(t){Ct(e,t)}))})),!0}return!1},Lt=function(e){var t=e.clipboardData;return-1!==navigator.userAgent.indexOf("Android")&&t&&t.items&&0===t.items.length},Ot=function(e){return U.metaKeyPressed(e)&&86===e.keyCode||e.shiftKey&&45===e.keyCode},Rt=function(e,t,n){var r,i=I(),o=I();e.on("keyup",o.clear),e.on("keydown",(function(n){var a=function(e){Ot(e)&&!e.isDefaultPrevented()&&t.remove()};if(Ot(n)&&!n.isDefaultPrevented()){if(r=n.shiftKey&&86===n.keyCode,r&&B.webkit&&-1!==navigator.userAgent.indexOf("Version/"))return;if(n.stopImmediatePropagation(),i.set(n),o.set(!0),B.ie&&r)return n.preventDefault(),void q(e,!0);t.remove(),t.create(),e.once("keyup",a),e.once("paste",(function(){e.off("keyup",a)}))}}));var a=function(e,n,r,i,o){var a;vt(n,"text/html")?a=n["text/html"]:(a=t.getHtml(),o=o||we(a),t.isDefaultContent(a)&&(i=!0)),a=Be(a),t.remove();var s=!1===o&&De(a),l=et(a);(!a.length||s&&!l)&&(i=!0),(i||l)&&(a=vt(n,"text/plain")&&s?n["text/plain"]:Fe(a)),t.isDefaultContent(a)?r||e.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents."):i?mt(e,a):ht(e,a,o)},s=function(){return t.getLastRng()||e.selection.getRng()};e.on("paste",(function(l){var u=i.isSet()||o.isSet();u&&i.clear();var c=gt(e,l),d="text"===n.get()||r,f=vt(c,Se());r=!1,l.isDefaultPrevented()||Lt(l)?t.remove():bt(c)||!At(e,l,s())?(u||l.preventDefault(),!B.ie||u&&!l.ieFake||vt(c,"text/html")||(t.create(),e.dom.bind(t.getEl(),"paste",(function(e){e.stopPropagation()})),e.getDoc().execCommand("Paste",!1,null),c["text/html"]=t.getHtml()),vt(c,"text/html")?(l.preventDefault(),f||(f=we(c["text/html"])),a(e,c,u,d,f)):$.setEditorTimeout(e,(function(){a(e,c,u,d,f)}),0)):t.remove()}))},It=function(e,t,n){var r;Rt(e,t,n),e.parser.addNodeFilter("img",(function(t,n,i){var o=function(e){return e.data&&!0===e.data.paste},a=function(e){e.attr("data-mce-object")||r===B.transparentSrc||e.remove()},s=function(e){return 0===e.indexOf("webkit-fake-url")},l=function(e){return 0===e.indexOf("data:")};if(!ue(e)&&o(i)){var u=t.length;while(u--)r=t[u].attr("src"),r&&(s(r)||!le(e)&&l(r))&&a(t[u])}}))},Pt=function(e){return B.ie&&e.inline?document.body:e.getBody()},Mt=function(e){return Pt(e)!==e.getBody()},Nt=function(e,t,n){Mt(e)&&e.dom.bind(t,"paste keyup",(function(t){Ht(e,n)||e.fire("paste")}))},Ft=function(e,t,n){var r=e.dom,i=e.getBody();t.set(e.selection.getRng());var o=e.dom.add(Pt(e),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},n);(B.ie||B.gecko)&&r.setStyle(o,"left","rtl"===r.getStyle(i,"direction",!0)?65535:-65535),r.bind(o,"beforedeactivate focusin focusout",(function(e){e.stopPropagation()})),Nt(e,o,n),o.focus(),e.selection.select(o,!0)},Bt=function(e,t){if($t(e)){var n=void 0,r=t.get();while(n=e.dom.get("mcepastebin"))e.dom.remove(n),e.dom.unbind(n);r&&e.selection.setRng(r)}t.set(null)},$t=function(e){return e.dom.get("mcepastebin")},zt=function(e){var t=function(t,n){t.appendChild(n),e.dom.remove(n,!0)},n=G.grep(Pt(e).childNodes,(function(e){return"mcepastebin"===e.id})),r=n.shift();G.each(n,(function(e){t(r,e)}));for(var i=e.dom.select("div[id=mcepastebin]",r),o=i.length-1;o>=0;o--){var a=e.dom.create("div");r.insertBefore(a,i[o]),t(a,i[o])}return r?r.innerHTML:""},Ut=function(e,t){return t===e},Vt=function(e){return e&&"mcepastebin"===e.id},Ht=function(e,t){var n=$t(e);return Vt(n)&&Ut(t,n.innerHTML)},jt=function(t){var n=e(null),r="%MCEPASTEBIN%";return{create:function(){return Ft(t,n,r)},remove:function(){return Bt(t,n)},getEl:function(){return $t(t)},getHtml:function(){return zt(t)},getLastRng:n.get,isDefault:function(){return Ht(t,r)},isDefaultContent:function(e){return Ut(r,e)}}},qt=function(e,t){var n=jt(e);return e.on("PreInit",(function(){return It(e,n,t)})),{pasteFormat:t,pasteHtml:function(t,n){return ht(e,t,n)},pasteText:function(t){return mt(e,t)},pasteImageData:function(t,n){return At(e,t,n)},getDataTransferItems:pt,hasHtmlOrText:bt,hasContentType:vt}},Gt=function(e,t){"text"===t.pasteFormat.get()?(t.pasteFormat.set("html"),j(e,!1)):(t.pasteFormat.set("text"),j(e,!0)),e.focus()},Wt=function(e,t){e.addCommand("mceTogglePlainTextPaste",(function(){Gt(e,t)})),e.addCommand("mceInsertClipboardContent",(function(e,n){n.content&&t.pasteHtml(n.content,n.internal),n.text&&t.pasteText(n.text)}))},Kt=function(e){return!1===B.iOS&&"function"===typeof(null===e||void 0===e?void 0:e.setData)},Yt=function(e,t,n){if(!Kt(e))return!1;try{return e.clearData(),e.setData("text/html",t),e.setData("text/plain",n),e.setData(Se(),t),!0}catch(r){return!1}},Xt=function(e,t,n,r){Yt(e.clipboardData,t.html,t.text)?(e.preventDefault(),r()):n(t.html,r)},Jt=function(e){return function(t,n){var r=be(t),i=e.dom.create("div",{contenteditable:"false","data-mce-bogus":"all"}),o=e.dom.create("div",{contenteditable:"true"},r);e.dom.setStyles(i,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),i.appendChild(o),e.dom.add(e.getBody(),i);var a=e.selection.getRng();o.focus();var s=e.dom.createRng();s.selectNodeContents(o),e.selection.setRng(s),$.setTimeout((function(){e.selection.setRng(a),i.parentNode.removeChild(i),n()}),0)}},Qt=function(e){return{html:e.selection.getContent({contextual:!0}),text:e.selection.getContent({format:"text"})}},Zt=function(e){return!!e.dom.getParent(e.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",e.getBody())},en=function(e){return!e.selection.isCollapsed()||Zt(e)},tn=function(e){return function(t){en(e)&&Xt(t,Qt(e),Jt(e),(function(){if(B.browser.isChrome()||B.browser.isFirefox()){var t=e.selection.getRng();$.setEditorTimeout(e,(function(){e.selection.setRng(t),e.execCommand("Delete")}),0)}else e.execCommand("Delete")}))}},nn=function(e){return function(t){en(e)&&Xt(t,Qt(e),Jt(e),d)}},rn=function(e){e.on("cut",tn(e)),e.on("copy",nn(e))},on=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),an=function(e,t){return on.getCaretRangeFromPoint(t.clientX,t.clientY,e.getDoc())},sn=function(e){var t=e["text/plain"];return!!t&&0===t.indexOf("file://")},ln=function(e,t){e.focus(),e.selection.setRng(t)},un=function(e,t,n){W(e)&&e.on("dragend dragover draggesture dragdrop drop drag",(function(e){e.preventDefault(),e.stopPropagation()})),K(e)||e.on("drop",(function(e){var t=e.dataTransfer;t&&t.files&&t.files.length>0&&e.preventDefault()})),e.on("drop",(function(r){var i=an(e,r);if(!r.isDefaultPrevented()&&!n.get()){var o=t.getDataTransferItems(r.dataTransfer),a=t.hasContentType(o,Se());if((t.hasHtmlOrText(o)&&!sn(o)||!t.pasteImageData(r,i))&&i&&Y(e)){var s=o["mce-internal"]||o["text/html"]||o["text/plain"];s&&(r.preventDefault(),$.setEditorTimeout(e,(function(){e.undoManager.transact((function(){o["mce-internal"]&&e.execCommand("Delete"),ln(e,i),s=Be(s),o["text/html"]?t.pasteHtml(s,a):t.pasteText(s)}))})))}}})),e.on("dragstart",(function(e){n.set(!0)})),e.on("dragover dragend",(function(t){K(e)&&!1===n.get()&&(t.preventDefault(),ln(e,an(e,t))),"dragend"===t.type&&n.set(!1)}))},cn=function(e){var t=e.plugins.paste,n=X(e);n&&e.on("PastePreProcess",(function(e){n.call(t,t,e)}));var r=J(e);r&&e.on("PastePostProcess",(function(e){r.call(t,t,e)}))},dn=function(e,t){e.on("PastePreProcess",(function(n){n.content=t(e,n.content,n.internal,n.wordContent)}))},fn=function(e,t){e.on("PastePostProcess",(function(n){t(e,n.node)}))},hn=function(e,t){if(!Ue(t))return t;var n=[];G.each(e.schema.getBlockElements(),(function(e,t){n.push(t)}));var r=new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+n.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g");return t=Ne(t,[[r,"$1"]]),t=Ne(t,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]]),t},mn=function(e,t,n,r){if(r||n)return t;var i,o=Q(e);if(!1===Z(e)||"all"===o)return t;if(o&&(i=o.split(/[, ]/)),i){var a=e.dom,s=e.selection.getNode();t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,(function(e,t,n,r){var o=a.parseStyle(a.decode(n)),l={};if("none"===i)return t+r;for(var u=0;u<i.length;u++){var c=o[i[u]],d=a.getStyle(s,i[u],!0);/color/.test(i[u])&&(c=a.toHex(c),d=a.toHex(d)),d!==c&&(l[i[u]]=c)}var f=a.serializeStyle(l,"span");return f?t+' style="'+f+'"'+r:t+r}))}else t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return t=t.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,(function(e,t,n,r){return t+' style="'+n+'"'+r})),t},pn=function(e,t){e.$("a",t).find("font,u").each((function(t,n){e.dom.remove(n,!0)}))},gn=function(e){B.webkit&&dn(e,mn),B.ie&&(dn(e,hn),fn(e,pn))},vn=function(e,t){return function(n){n.setActive("text"===t.pasteFormat.get());var r=function(e){return n.setActive(e.state)};return e.on("PastePlainTextToggle",r),function(){return e.off("PastePlainTextToggle",r)}}},bn=function(e,t){var n=function(){return e.execCommand("mceTogglePlainTextPaste")};e.ui.registry.addToggleButton("pastetext",{active:!1,icon:"paste-text",tooltip:"Paste as text",onAction:n,onSetup:vn(e,t)}),e.ui.registry.addToggleMenuItem("pastetext",{text:"Paste as text",icon:"paste-text",onAction:n,onSetup:vn(e,t)})};function yn(){t.add("paste",(function(t){if(!1===n(t)){var i=e(!1),o=e(ne(t)?"text":"html"),a=qt(t,o);return gn(t),bn(t,a),Wt(t,a),cn(t),rn(t),un(t,a,i),r(a)}}))}yn()})()},"1af3":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}),t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,operates:e.operates,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange}}),t("bookNow",{ref:"bookNow"})],1)},i=[],o=n("7591"),a=n("b775"),s=n("324f"),l={name:"reservePage",components:{BasicTable:o["a"],bookNow:s["default"]},data(){return{loading:!1,categoryOptions:[],filterOptions:{column:[{type:"input",label:"关键字",value:"keyword"},{type:"select",label:"课程标签",value:"tag",options:[{value:0,label:"套餐课程"},{value:1,label:"单品课程"},{value:2,label:"vip课程"}]}]},categoryOptions:[],filterData:{categoryId:"",name:""},table:{columns:[{id:1,prop:"name",label:"课程名称"},{id:2,prop:"image",label:"封面",type:"image"},{id:3,prop:"categoryId",label:"课程类型",render:e=>{const t=this.categoryOptions.find(t=>t.id==e.categoryId);return t?t.name:""}},{id:4,prop:"price",label:"价格"},{id:5,prop:"teacherName",label:"操作员"}],pageSize:20,currentPage:1,data:[],total:0},operates:[{key:"reserve",title:"立即预订",btnStyle:"yellow",permission:"admin/adCourse/bookingAdd",action:(e,t)=>{this.$refs.bookNow.edit(t)}}],headerOperates:[]}},created(){this.getCategoryList(),this.getList()},methods:{searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0,a["a"].post({url:"/admin/adCourse/listReserve",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,...this.filterData},success:e=>{this.table.data=e.list,this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1}})},getCategoryList(){a["a"].post({url:"system/sysCategory/listNoPage",params:{type:2},success:e=>{this.categoryOptions=e}})},handleDelete(e){this.$confirm("此操作将会删除该新闻, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/system/sysNews/remove",params:{id:e.id},success:e=>{this.$message.success(e),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},clearFilter(){this.filterData={name:""},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()}}},u=l,c=n("1805"),d=Object(c["a"])(u,r,i,!1,null,"153fb01e",null);t["default"]=d.exports},"1b80":function(e,t,n){},"1b83":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}),t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,operates:e.operates,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange},scopedSlots:e._u([{key:"image",fn:function(e){return t("div",{},[e.row.image?t("el-image",{staticStyle:{width:"50px"},attrs:{src:e.row.image,"preview-src-list":[e.row.image]}}):t("span")],1)}}])}),t("add-dialog",{ref:"addDialog",on:{success:e.handleSuccess}})],1)},i=[],o=n("7591"),a=n("b775"),s=n("1356"),l={name:"adverstPage",components:{BasicTable:o["a"],addDialog:s["default"]},data(){return{loading:!1,categoryOptions:[],filterOptions:{column:[{type:"select",label:"广告位置",value:"categoryId",options:[],labelKey:"name",valueKey:"id"},{type:"input",label:"广告名称",value:"name"}]},filterData:{categoryId:"",name:""},table:{columns:[{id:1,prop:"advertiseCategoryId",label:"广告位置",render:e=>this.filterOptions.column[0].options.find(t=>t.id==e.advertiseCategoryId)&&this.filterOptions.column[0].options.find(t=>t.id==e.advertiseCategoryId)["name"]},{id:2,prop:"name",label:"广告名称"},{id:3,prop:"image",label:"广告图片",renderName:"image"},{id:4,prop:"sort",label:"排序"},{id:5,prop:"adName",label:"创建人"},{id:6,prop:"createTime",label:"创建时间",type:"date"}],pageSize:20,currentPage:1,data:[],total:0},operates:[{key:"edit",title:"编辑",permission:"system/sysAdvertise/edit",btnStyle:"yellow",action:(e,t)=>{this.$refs.addDialog.edit(t)}},{key:"delete",title:"删除",permission:"system/sysAdvertise/remove",btnStyle:"red",action:(e,t)=>{this.handleDelete(t)}}],headerOperates:[{key:"el-icon-plus",permission:"system/sysAdvertise/add",name:"添加广告",action:()=>{this.$refs.addDialog.open()}}]}},created(){this.getList(),this.getCategoryList()},methods:{searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0,a["a"].post({url:"/system/sysAdvertise/list",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,...this.filterData},success:e=>{this.table.data=e.list,this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1}})},getCategoryList(){a["a"].post({url:"/system/sysAdvertise/getAllAdvertisingSpace",params:{},success:e=>{this.filterOptions.column[0].options=e}})},handleSuccess(){this.getList()},handleDelete(e){this.$confirm("此操作将会删除该广告, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/system/sysAdvertise/remove",params:{id:e.id},success:e=>{this.$message.success(e),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},clearFilter(){this.filterData={name:""},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()}}},u=l,c=(n("348c"),n("1805")),d=Object(c["a"])(u,r,i,!1,null,"3a3a7d53",null);t["default"]=d.exports},"1bba":function(e,t,n){n("8a44")},"1d0e":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.addModifyVisible,"append-to-body":!0,width:"50%"},on:{"update:visible":function(t){e.addModifyVisible=t},close:e.close}},[t("el-form",{ref:"workRef",attrs:{model:e.addData,rules:e.workRule,"label-position":"left","label-width":"120px"}},[t("el-form-item",{attrs:{label:"作业标题:",prop:"workName"}},[t("jat-input",{attrs:{placeholder:"请输入作业标题"},model:{value:e.addData.workName,callback:function(t){e.$set(e.addData,"workName",t)},expression:"addData.workName"}})],1),t("el-form-item",{attrs:{label:"案例展示图:",prop:"caseUrl"}},[t("upload-image",{model:{value:e.addData.caseUrl,callback:function(t){e.$set(e.addData,"caseUrl",t)},expression:"addData.caseUrl"}})],1),t("el-form-item",{attrs:{label:"提交截止时间:",prop:"cutOffTime"}},[t("jat-date-picker",{attrs:{clearable:"",type:"date",width:"100%",placeholder:"请选择提交截止时间"},model:{value:e.addData.cutOffTime,callback:function(t){e.$set(e.addData,"cutOffTime",t)},expression:"addData.cutOffTime"}})],1),t("el-form-item",{attrs:{label:"附件:",prop:"material"}},[t("uploadFile",{attrs:{limit:1},model:{value:e.addData.material,callback:function(t){e.$set(e.addData,"material",t)},expression:"addData.material"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)],1)},i=[],o=n("cbc3"),a=n("b775"),s=n("9adf"),l=n("b893"),u=n("c46c"),c={name:"addCourseWork",components:{uploadImage:o["a"],tinymceEdit:s["a"],uploadFile:u["a"]},data(){return{addModifyVisible:!1,dialogTitle:"",addData:{id:"",cutOffTime:"",workName:"",caseUrl:"",material:""},workRule:{cutOffTime:[{required:!0,message:"请选择提交截止时间",trigger:"blur"}],workName:[{required:!0,message:"请输入作者名称",trigger:"blur"}]}}},mounted(){},methods:{edit(e){this.dialogTitle="编辑作业";const{id:t,workName:n,material:r,caseUrl:i,cutOffTime:o}=e;this.addData={id:t,workName:n,caseUrl:i,material:r,cutOffTime:Object(l["b"])(o,"yyyy-MM-dd")},this.addData.id=e.workId,this.addModifyVisible=!0},close(){this.$refs.workRef&&this.$refs.workRef.clearValidate(),this.addData={id:"",cutOffTime:"",workName:"",caseUrl:"",material:""},this.addModifyVisible=!1},handleSubmit(){this.$refs.workRef.validate(e=>{const{material:t,...n}=this.addData;console.log(t),e&&a["a"].post({url:"/admin/adCourseWork/edit",params:{...n,material:Array.isArray(t)&&t.length>0?t[0].url:t},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}})})}}},d=c,f=n("1805"),h=Object(f["a"])(d,r,i,!1,null,"af70ba10",null);t["default"]=h.exports},"1e5e":function(e,t,n){},"1e74":function(e,t,n){"use strict";n("50e1")},"1f1d":function(e,t,n){"use strict";n("2480")},"1f28":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.addModifyVisible,width:"50%"},on:{"update:visible":function(t){e.addModifyVisible=t},close:e.close}},[t("el-form",{ref:"adminRef",attrs:{model:e.addData,rules:e.adminRule,"label-position":"right","label-width":"90px"}},[t("el-form-item",{attrs:{label:"用户账号:",prop:"account"}},[e.addData.id?t("jat-input",{attrs:{disabled:"",placeholder:"请输入用户账号"},model:{value:e.addData.account,callback:function(t){e.$set(e.addData,"account",t)},expression:"addData.account"}}):t("span",{staticClass:"warm_box"},[t("i",{staticClass:"el-icon-info"}),e._v("系统将自动生成用户名")])],1),t("el-form-item",{attrs:{label:"角色权限:",prop:"roleIds"}},[t("el-checkbox-group",{model:{value:e.addData.roleIds,callback:function(t){e.$set(e.addData,"roleIds",t)},expression:"addData.roleIds"}},e._l(e.rolesOptions,(function(n){return t("el-checkbox",{key:n.id,attrs:{label:n.id}},[e._v(e._s(n.roleName))])})),1)],1),t("el-form-item",{attrs:{label:"真实姓名:",prop:"name"}},[t("jat-input",{attrs:{placeholder:"请输入真实姓名"},model:{value:e.addData.name,callback:function(t){e.$set(e.addData,"name",t)},expression:"addData.name"}})],1),t("el-form-item",{attrs:{label:"联系电话:",prop:"phone"}},[t("jat-input",{attrs:{placeholder:"请输入联系电话"},model:{value:e.addData.phone,callback:function(t){e.$set(e.addData,"phone",t)},expression:"addData.phone"}})],1),t("el-form-item",{attrs:{label:"QQ:",prop:"qq"}},[t("jat-input",{attrs:{placeholder:"请输入QQ"},model:{value:e.addData.qq,callback:function(t){e.$set(e.addData,"qq",t)},expression:"addData.qq"}})],1),t("el-form-item",{attrs:{label:"微信:",prop:"wechatNum"}},[t("jat-input",{attrs:{placeholder:"请输入微信"},model:{value:e.addData.wechatNum,callback:function(t){e.$set(e.addData,"wechatNum",t)},expression:"addData.wechatNum"}})],1),t("el-form-item",{attrs:{label:"用户密码:",prop:"password"}},[t("jat-input",{attrs:{placeholder:"请输入用户密码，不填系统将会生成随机密码"},model:{value:e.addData.password,callback:function(t){e.$set(e.addData,"password",t)},expression:"addData.password"}})],1),t("el-form-item",{attrs:{label:"性别:",prop:"gender"}},[t("jat-select",{attrs:{placeholder:"请输入性别"},model:{value:e.addData.gender,callback:function(t){e.$set(e.addData,"gender",t)},expression:"addData.gender"}},[t("el-option",{attrs:{label:"男",value:1}}),t("el-option",{attrs:{label:"女",value:2}})],1)],1),t("el-form-item",{attrs:{label:"部门",prop:"departmentId"}},[t("el-cascader",{staticStyle:{width:"100%"},attrs:{size:"small",clearable:"",options:e.departmentOptions,props:{label:"name",value:"id",emitPath:!1}},model:{value:e.addData.departmentId,callback:function(t){e.$set(e.addData,"departmentId",t)},expression:"addData.departmentId"}})],1),t("el-form-item",{attrs:{label:"用户状态:",prop:"status"}},[t("jat-select",{attrs:{placeholder:"请选择用户状态"},model:{value:e.addData.status,callback:function(t){e.$set(e.addData,"status",t)},expression:"addData.status"}},[t("el-option",{attrs:{label:"正常",value:0}}),t("el-option",{attrs:{label:"冻结",value:-1}}),t("el-option",{attrs:{label:"禁用",value:-2}})],1)],1),t("el-form-item",{attrs:{label:"可查看部门:",prop:"canSeeDepartment"}},[t("el-tree",{ref:"departmentRef",attrs:{data:e.canSeeDepartmentList,"node-key":"id","show-checkbox":"","default-expand-all":"","highlight-current":"",props:e.defaultProps}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"账号信息","close-on-click-modal":!1,visible:e.accountVisible,width:"30%"},on:{"update:visible":function(t){e.accountVisible=t},close:e.handleClose}},[t("div",{staticClass:"tipInfo"},[e._v(" 您的账号创建成功了。请保存好，方便后面登录后台系统 ")]),t("div",{staticClass:"account-box"},[t("span",[e._v("账号："+e._s(e.accountInfo.account))]),t("span",[e._v("密码："+e._s(e.accountInfo.password))])])])],1)},i=[],o=(n("7cfc"),n("cbc3")),a=n("b775"),s=n("9adf"),l=n("b893"),u=n("5258"),c=n("61f7"),d={components:{uploadImage:o["a"],tinymceEdit:s["a"]},data(){return{addModifyVisible:!1,dialogTitle:"",addData:{roleIds:[],name:"",phone:"",qq:"",wechatNum:"",password:"",gender:"",departmentId:"",status:"",canSeeDepartment:[],id:""},accountVisible:!1,accountInfo:{account:"",password:""},departmentOptions:[],rolesOptions:[],canSeeDepartmentList:[],defaultProps:{label:"name",value:"id"},adminRule:{gender:[{required:!0,message:"请选择性别",trigger:"blur"}],name:[{required:!0,message:"请输入真实姓名",trigger:"blur"}],phone:[{required:!0,message:"请输入联系电话",trigger:"blur"},{validator:(e,t,n)=>{Object(c["b"])(t)?n():n(new Error("联系电话格式不正确"))},trigger:"blur"}],departmentId:[{required:!0,message:"请选择部门",trigger:"blur"}],status:[{required:!0,message:"请选择用户状态",trigger:"blur"}]}}},mounted(){},methods:{open(){this.dialogTitle="添加管理员",this.addData.name="",this.getcanSeeDepartmentList(),this.getRolesOptions(),this.addModifyVisible=!0},edit({roleIds:e,name:t,phone:n,qq:r,wechat:i,gender:o,departmentId:a,status:s,account:l,canSeeDepartment:u,id:c}){this.dialogTitle="编辑管理员",this.addData={roleIds:e?JSON.parse(e):[],name:t,phone:n,qq:r,wechatNum:i,password:"",gender:o,departmentId:a,status:s,account:l,canSeeDepartment:u?JSON.parse(u):[],id:c},this.getcanSeeDepartmentList(),this.getRolesOptions(),this.addModifyVisible=!0,setTimeout(()=>{this.$refs.departmentRef.setCheckedKeys(this.addData.canSeeDepartment)},100)},handleClose(){this.accountInfo={account:"",password:""}},close(){this.$refs.adminRef&&this.$refs.adminRef.clearValidate(),this.$refs.departmentRef.setCheckedKeys([]),this.addData={roleIds:[],name:"",phone:"",qq:"",wechatNum:"",password:"",gender:"",departmentId:"",status:"",canSeeDepartment:[],id:""},this.addModifyVisible=!1},getcanSeeDepartmentList(){a["a"].post({url:"/admin/adInfo/canChooseCanSeeDepartmentList",params:{id:sessionStorage.getItem("id")},success:e=>{this.canSeeDepartmentList=Object(l["c"])(e),this.departmentOptions=this.canSeeDepartmentList}})},getRolesOptions(){a["a"].post({url:"/admin/adInfo/canChooseRoleList",params:{id:sessionStorage.getItem("id")},success:e=>{this.rolesOptions=e}})},handleSubmit(){this.$refs.adminRef.validate(e=>{const{roleIds:t,password:n,...r}=this.addData,i=this.$refs.departmentRef.getCheckedKeys();e&&(this.addData.id?a["a"].post({url:"/admin/adInfo/editAdmin",params:{...r,password:n?u["a"].encryptByPublicKey(n):"",canSeeDepartment:i?JSON.stringify(i):void 0,roleIds:JSON.stringify(t)},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}):a["a"].post({url:"/admin/adInfo/addAdmin",params:{...r,canSeeDepartment:i?JSON.stringify(i):void 0,password:n?u["a"].encryptByPublicKey(n):"",roleIds:JSON.stringify(t)},success:e=>{this.accountInfo=e,this.accountVisible=!0,this.$message.success("操作成功"),this.close(),this.$emit("success")}}))})},onCopy(){this.$message.success("复制成功")}}},f=d,h=(n("971c"),n("1805")),m=Object(h["a"])(f,r,i,!1,null,"37620c38",null);t["default"]=m.exports},2101:function(e,t,n){"use strict";var r=n("223f").f;e.exports=function(e,t,n){n in e||r(e,n,{configurable:!0,get:function(){return t[n]},set:function(e){t[n]=e}})}},2480:function(e,t,n){},2607:function(e,t,n){},"262c":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"middle-container"},[t("div",{staticClass:"header-box"},[e.headerTab.length>0?t("div",{staticClass:"BasicInfo_title"},e._l(e.headerTab,(function(n){return t("div",{directives:[{name:"permission",rawName:"v-permission",value:n.permission,expression:"tab.permission"}],key:n.id,staticClass:"item",class:{is_active:n.isChecked},on:{click:function(t){return e.handleTabSelect(n)}}},[t("span",{class:"tab_"+n.id},[e._v(e._s(n.name))])])})),0):e._e()]),t(e.currentComponet,{tag:"component"})],1)},i=[],o=n("cf21"),a=n("dd75"),s=n("aa1c"),l=n("34aa"),u={name:"receivablesManagerPage",components:{payoutDetail:l["default"],OutstandingCharges:a["default"],Canceled:o["default"],receivable:s["default"]},data(){return{currentComponet:s["default"],headerTab:[{id:1,name:"应收款",component:s["default"],isChecked:!0,permission:"system/sysCourseOrderBills/receivablesList"},{id:2,name:"收款明细",component:l["default"],isChecked:!1,permission:"system/sysCourseOrderBills/collectionDetailList"},{id:3,name:"未结清收款",component:a["default"],isChecked:!1,permission:"system/sysCourseOrderBills/outstandingAccountsList"},{id:4,name:"已取消订单",component:o["default"],permission:"system/sysCourseOrderBills/cancelBillsList",isChecked:!1}]}},mounted(){this.init()},methods:{handleTabSelect(e,t){e.id==this.$route.query.type&&e.isChecked||(this.headerTab.forEach(t=>{t.isChecked=t.id==e.id}),t||this.$router.replace({path:this.$router.path,query:{type:e.id}}),this.currentComponet=e.component)},init(){const e=this.$route.query.type;if(e){const t=document.querySelector(".tab_"+e);if(!t){const e=this.headerTab.find(e=>e.isChecked);return void this.$router.replace({path:this.$router.path,query:{type:e.id}})}const n=this.headerTab.find(t=>t.id==e);n&&this.handleTabSelect(n,!0)}else this.$router.replace({path:this.$router.path,query:{type:1}})}},watch:{"$route.query.orderNum":function(e){e&&this.init()},"$route.query.type":function(e){e&&this.init()}}},c=u,d=(n("06d3"),n("1805")),f=Object(d["a"])(c,r,i,!1,null,"b7cffe52",null);t["default"]=f.exports},2694:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"章节列表",width:"80%",visible:e.chaptersVisible},on:{"update:visible":function(t){e.chaptersVisible=t}}},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"max-height":"500px"}},[t("BasicTable",{attrs:{columns:e.table.columns,height:"1000px",operates:e.isWrite?e.operates:void 0,operateWidth:"180px",hasCard:!1,data:e.table.data,hasPage:!1,hasSort:!1,"row-key":"id","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"},headerOperates:e.isWrite?e.headerOperates:void 0}}),t("addChapters",{ref:"addChatptersDialog",on:{success:e.handleSuccess}}),t("addParentChapter",{ref:"addParentChatpterDialog",on:{success:e.handleSuccess}})],1)])},i=[],o=n("7591"),a=n("b775"),s=(n("d17b"),n("7d95")),l=n("101b"),u=n("920b"),c={props:{isWrite:{type:Boolean,default:!0}},name:"chaptersPage",components:{BasicTable:o["a"],addChapters:l["default"],uploadVideo:s["default"],addParentChapter:u["default"]},data(){return{loading:!1,chaptersVisible:!1,remoteLoading:!1,openLiveVisible:!1,openLiveData:{},supervisorAdOptions:[],categoryOptions:[],filterOptions:{column:[]},remoteLoading:!1,teacherOptions:[],filterData:{id:""},table:{columns:[{id:1,prop:"name",label:"章节名称",align:"left"},{id:2,type:"image",prop:"image",label:"封面"},{id:3,prop:"url",type:"video",label:"视频"},{id:4,prop:"lengthTime",label:"视频时长"},{id:5,prop:"sort",label:"排序"}],pageSize:20,currentPage:1,data:[],total:0},operates:[{key:"edit",title:"编辑",permission:"admin/adCourseChapters/uploadCourseEdit",btnStyle:"yellow",action:(e,t)=>{-1===t.parentId?this.$refs.addParentChatpterDialog.edit(t,this.filterData.id):this.$refs.addChatptersDialog.edit(t,this.filterData.id)}},{key:"el-icon-plus",title:"添加章节",btnStyle:"blue",permission:"admin/adCourseChapters/uploadCourseAdd",action:(e,t)=>{this.$refs.addChatptersDialog.open(t,this.filterData.id)},show:e=>-1==e.parentId},{key:"delete",title:"删除",permission:"admin/adCourseChapters/remove",btnStyle:"red",action:(e,t)=>{this.handleDelete(t)}}],headerOperates:[{key:"el-icon-plus",name:"添加父章节",permission:"admin/adCourseChapters/uploadCourseAdd",action:()=>{this.$refs.addParentChatpterDialog.open(this.filterData.id)}}]}},computed:{hasLiveOptions(){return this.$refs.addDialog?this.$refs.addDialog.hasLiveOptions:[]}},mounted(){},created(){},methods:{open(e){this.chaptersVisible=!0,this.filterData.id=e.id,this.getList()},searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0,a["a"].post({url:this.isWrite?"/admin/adCourseChapters/courseList":"/admin/adCourseChapters/list",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,...this.filterData},success:e=>{this.table.data=e.map(e=>({...e.parent,children:e.sonList.map(t=>({...t,parentInfo:e.parent}))})),this.loading=!1},catch:()=>{this.loading=!1}})},handleSuccess(){this.getList()},onCopy(){this.$message.success("复制成功")},handleClose(){this.openLiveData={}},clearFilter(){this.filterData={id:""},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()},handleDelete(e){let t="";t=-1===e.parentId?"此操作将会删除该父章节和父章节下的所有子章节, 是否继续?":"此操作将会删除该章节, 是否继续?",this.$confirm(t,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/admin/adCourseChapters/remove",params:{id:e.id},success:e=>{this.$message.success(e),this.getList()}})}).catch(()=>{this.$message.info("已取消删除")})}}},d=c,f=(n("bbad"),n("1805")),h=Object(f["a"])(d,r,i,!1,null,"64c7e580",null);t["default"]=h.exports},"26ab":function(e,t,n){"use strict";n("6c77")},2754:function(e,t,n){"use strict";n.r(t);var r=n("fb79"),i=n("8b20");for(var o in i)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(o);n("1e74");var a=n("1805"),s=Object(a["a"])(i["default"],r["a"],r["b"],!1,null,null,null);t["default"]=s.exports},"295d":function(e,t,n){(function(t){(function(){"use strict";var n=function(e){if(null===e)return"null";if(void 0===e)return"undefined";var t=typeof e;return"object"===t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t},r=function(e){return-1!==["undefined","boolean","number","string","function","xml","null"].indexOf(e)},i=function(e,t){var n=Array.prototype.slice.call(e);return n.sort(t)},o=function(e,t){return a((function(n,r){return e.eq(t(n),t(r))}))},a=function(e){return{eq:e}},s=a((function(e,t){return e===t})),l=s,u=function(e){return a((function(t,n){if(t.length!==n.length)return!1;for(var r=t.length,i=0;i<r;i++)if(!e.eq(t[i],n[i]))return!1;return!0}))},c=function(e,t){return o(u(e),(function(e){return i(e,t)}))},d=function(e){return a((function(t,n){var r=Object.keys(t),i=Object.keys(n);if(!c(l).eq(r,i))return!1;for(var o=r.length,a=0;a<o;a++){var s=r[a];if(!e.eq(t[s],n[s]))return!1}return!0}))},f=a((function(e,t){if(e===t)return!0;var i=n(e),o=n(t);return i===o&&(r(i)?e===t:"array"===i?u(f).eq(e,t):"object"===i&&d(f).eq(e,t))})),h=function(e){var t=typeof e;return null===e?"null":"object"===t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t},m=function(e){return function(t){return h(t)===e}},p=function(e){return function(t){return typeof t===e}},g=function(e){return function(t){return e===t}},v=m("string"),b=m("object"),y=m("array"),w=g(null),S=p("boolean"),x=g(void 0),C=function(e){return null===e||void 0===e},T=function(e){return!C(e)},D=p("function"),k=p("number"),E=function(){},_=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e(t.apply(null,n))}},A=function(e,t){return function(n){return e(t(n))}},L=function(e){return function(){return e}},O=function(e){return e},R=function(e,t){return e===t};function I(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=t.concat(n);return e.apply(null,i)}}var P=function(e){return function(t){return!e(t)}},M=function(e){return function(){throw new Error(e)}},N=function(e){return e()},F=function(e){e()},B=L(!1),$=L(!0),z=function(){return U},U=function(){var e=function(e){return e()},t=O,n={fold:function(e,t){return e()},isSome:B,isNone:$,getOr:t,getOrThunk:e,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:L(null),getOrUndefined:L(void 0),or:t,orThunk:e,map:z,each:E,bind:z,exists:B,forall:$,filter:function(){return z()},toArray:function(){return[]},toString:L("none()")};return n}(),V=function(e){var t=L(e),n=function(){return i},r=function(t){return t(e)},i={fold:function(t,n){return n(e)},isSome:$,isNone:B,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return V(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?i:U},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return i},H=function(e){return null===e||void 0===e?U:V(e)},j={some:V,none:z,from:H},q=Array.prototype.slice,G=Array.prototype.indexOf,W=Array.prototype.push,K=function(e,t){return G.call(e,t)},Y=function(e,t){var n=K(e,t);return-1===n?j.none():j.some(n)},X=function(e,t){return K(e,t)>-1},J=function(e,t){for(var n=0,r=e.length;n<r;n++){var i=e[n];if(t(i,n))return!0}return!1},Q=function(e,t){for(var n=e.length,r=new Array(n),i=0;i<n;i++){var o=e[i];r[i]=t(o,i)}return r},Z=function(e,t){for(var n=0,r=e.length;n<r;n++){var i=e[n];t(i,n)}},ee=function(e,t){for(var n=e.length-1;n>=0;n--){var r=e[n];t(r,n)}},te=function(e,t){for(var n=[],r=[],i=0,o=e.length;i<o;i++){var a=e[i],s=t(a,i)?n:r;s.push(a)}return{pass:n,fail:r}},ne=function(e,t){for(var n=[],r=0,i=e.length;r<i;r++){var o=e[r];t(o,r)&&n.push(o)}return n},re=function(e,t,n){return ee(e,(function(e,r){n=t(n,e,r)})),n},ie=function(e,t,n){return Z(e,(function(e,r){n=t(n,e,r)})),n},oe=function(e,t,n){for(var r=0,i=e.length;r<i;r++){var o=e[r];if(t(o,r))return j.some(o);if(n(o,r))break}return j.none()},ae=function(e,t){return oe(e,t,B)},se=function(e,t){for(var n=0,r=e.length;n<r;n++){var i=e[n];if(t(i,n))return j.some(n)}return j.none()},le=function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!y(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);W.apply(t,e[n])}return t},ue=function(e,t){return le(Q(e,t))},ce=function(e,t){for(var n=0,r=e.length;n<r;++n){var i=e[n];if(!0!==t(i,n))return!1}return!0},de=function(e){var t=q.call(e,0);return t.reverse(),t},fe=function(e,t){return ne(e,(function(e){return!X(t,e)}))},he=function(e,t){for(var n={},r=0,i=e.length;r<i;r++){var o=e[r];n[String(o)]=t(o,r)}return n},me=function(e,t){var n=q.call(e,0);return n.sort(t),n},pe=function(e,t){return t>=0&&t<e.length?j.some(e[t]):j.none()},ge=function(e){return pe(e,0)},ve=function(e){return pe(e,e.length-1)},be=D(Array.from)?Array.from:function(e){return q.call(e)},ye=function(e,t){for(var n=0;n<e.length;n++){var r=t(e[n],n);if(r.isSome())return r}return j.none()},we=Object.keys,Se=Object.hasOwnProperty,xe=function(e,t){for(var n=we(e),r=0,i=n.length;r<i;r++){var o=n[r],a=e[o];t(a,o)}},Ce=function(e,t){return Te(e,(function(e,n){return{k:n,v:t(e,n)}}))},Te=function(e,t){var n={};return xe(e,(function(e,r){var i=t(e,r);n[i.k]=i.v})),n},De=function(e){return function(t,n){e[n]=t}},ke=function(e,t,n,r){var i={};return xe(e,(function(e,i){(t(e,i)?n:r)(e,i)})),i},Ee=function(e,t){var n={},r={};return ke(e,t,De(n),De(r)),{t:n,f:r}},_e=function(e,t){var n={};return ke(e,t,De(n),E),n},Ae=function(e,t){var n=[];return xe(e,(function(e,r){n.push(t(e,r))})),n},Le=function(e){return Ae(e,O)},Oe=function(e,t){return Re(e,t)?j.from(e[t]):j.none()},Re=function(e,t){return Se.call(e,t)},Ie=function(e,t){return Re(e,t)&&void 0!==e[t]&&null!==e[t]},Pe=function(e,t,n){return void 0===n&&(n=f),d(n).eq(e,t)},Me=Array.isArray,Ne=function(e){if(Me(e))return e;for(var t=[],n=0,r=e.length;n<r;n++)t[n]=e[n];return t},Fe=function(e,t,n){var r,i;if(!e)return!1;if(n=n||e,void 0!==e.length){for(r=0,i=e.length;r<i;r++)if(!1===t.call(n,e[r],r,e))return!1}else for(r in e)if(Re(e,r)&&!1===t.call(n,e[r],r,e))return!1;return!0},Be=function(e,t){var n=[];return Fe(e,(function(r,i){n.push(t(r,i,e))})),n},$e=function(e,t){var n=[];return Fe(e,(function(r,i){t&&!t(r,i,e)||n.push(r)})),n},ze=function(e,t){if(e)for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},Ue=function(e,t,n,r){for(var i=x(n)?e[0]:n,o=0;o<e.length;o++)i=t.call(r,i,e[o],o);return i},Ve=function(e,t,n){var r,i;for(r=0,i=e.length;r<i;r++)if(t.call(n,e[r],r,e))return r;return-1},He=function(e){return e[e.length-1]},je=function(){return je=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},je.apply(this,arguments)};function qe(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function Ge(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var We=function(e){var t,n=!1;return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return n||(n=!0,t=e.apply(null,r)),t}},Ke=function(e,t,n,r){var i=e.isiOS()&&!0===/ipad/i.test(n),o=e.isiOS()&&!i,a=e.isiOS()||e.isAndroid(),s=a||r("(pointer:coarse)"),l=i||!o&&a&&r("(min-device-width:768px)"),u=o||a&&!l,c=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(n),d=!u&&!l&&!c;return{isiPad:L(i),isiPhone:L(o),isTablet:L(l),isPhone:L(u),isTouch:L(s),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:L(c),isDesktop:L(d)}},Ye=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}},Xe=function(e,t){var n=Ye(e,t);if(!n)return{major:0,minor:0};var r=function(e){return Number(t.replace(n,"$"+e))};return Ze(r(1),r(2))},Je=function(e,t){var n=String(t).toLowerCase();return 0===e.length?Qe():Xe(e,n)},Qe=function(){return Ze(0,0)},Ze=function(e,t){return{major:e,minor:t}},et={nu:Ze,detect:Je,unknown:Qe},tt=function(e,t){return ye(t.brands,(function(t){var n=t.brand.toLowerCase();return ae(e,(function(e){var t;return n===(null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())})).map((function(e){return{current:e.name,version:et.nu(parseInt(t.version,10),0)}}))}))},nt=function(e,t){var n=String(t).toLowerCase();return ae(e,(function(e){return e.search(n)}))},rt=function(e,t){return nt(e,t).map((function(e){var n=et.detect(e.versionRegexes,t);return{current:e.name,version:n}}))},it=function(e,t){return nt(e,t).map((function(e){var n=et.detect(e.versionRegexes,t);return{current:e.name,version:n}}))},ot=function(e,t){return e.substring(t)},at=function(e,t,n){return""===t||e.length>=t.length&&e.substr(n,n+t.length)===t},st=function(e,t){return ut(e,t)?ot(e,t.length):e},lt=function(e,t){return-1!==e.indexOf(t)},ut=function(e,t){return at(e,t,0)},ct=function(e){return function(t){return t.replace(e,"")}},dt=ct(/^\s+|\s+$/g),ft=ct(/^\s+/g),ht=ct(/\s+$/g),mt=function(e){return e.length>0},pt=function(e){return!mt(e)},gt=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,vt=function(e){return function(t){return lt(t,e)}},bt=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return lt(e,"edge/")&&lt(e,"chrome")&&lt(e,"safari")&&lt(e,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,gt],search:function(e){return lt(e,"chrome")&&!lt(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return lt(e,"msie")||lt(e,"trident")}},{name:"Opera",versionRegexes:[gt,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:vt("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:vt("firefox")},{name:"Safari",versionRegexes:[gt,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(lt(e,"safari")||lt(e,"mobile/"))&&lt(e,"applewebkit")}}],yt=[{name:"Windows",search:vt("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return lt(e,"iphone")||lt(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:vt("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:vt("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:vt("linux"),versionRegexes:[]},{name:"Solaris",search:vt("sunos"),versionRegexes:[]},{name:"FreeBSD",search:vt("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:vt("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],wt={browsers:L(bt),oses:L(yt)},St="Edge",xt="Chrome",Ct="IE",Tt="Opera",Dt="Firefox",kt="Safari",Et=function(){return _t({current:void 0,version:et.unknown()})},_t=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isEdge:r(St),isChrome:r(xt),isIE:r(Ct),isOpera:r(Tt),isFirefox:r(Dt),isSafari:r(kt)}},At={unknown:Et,nu:_t,edge:L(St),chrome:L(xt),ie:L(Ct),opera:L(Tt),firefox:L(Dt),safari:L(kt)},Lt="Windows",Ot="iOS",Rt="Android",It="Linux",Pt="OSX",Mt="Solaris",Nt="FreeBSD",Ft="ChromeOS",Bt=function(){return $t({current:void 0,version:et.unknown()})},$t=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isWindows:r(Lt),isiOS:r(Ot),isAndroid:r(Rt),isOSX:r(Pt),isLinux:r(It),isSolaris:r(Mt),isFreeBSD:r(Nt),isChromeOS:r(Ft)}},zt={unknown:Bt,nu:$t,windows:L(Lt),ios:L(Ot),android:L(Rt),linux:L(It),osx:L(Pt),solaris:L(Mt),freebsd:L(Nt),chromeos:L(Ft)},Ut=function(e,t,n){var r=wt.browsers(),i=wt.oses(),o=t.bind((function(e){return tt(r,e)})).orThunk((function(){return rt(r,e)})).fold(At.unknown,At.nu),a=it(i,e).fold(zt.unknown,zt.nu),s=Ke(a,o,e,n);return{browser:o,os:a,deviceType:s}},Vt={detect:Ut},Ht=function(e){return window.matchMedia(e).matches},jt=We((function(){return Vt.detect(navigator.userAgent,j.from(navigator.userAgentData),Ht)})),qt=function(){return jt()},Gt=navigator.userAgent,Wt=qt(),Kt=Wt.browser,Yt=Wt.os,Xt=Wt.deviceType,Jt=/WebKit/.test(Gt)&&!Kt.isEdge(),Qt="FormData"in window&&"FileReader"in window&&"URL"in window&&!!URL.createObjectURL,Zt=-1!==Gt.indexOf("Windows Phone"),en={opera:Kt.isOpera(),webkit:Jt,ie:!(!Kt.isIE()&&!Kt.isEdge())&&Kt.version.major,gecko:Kt.isFirefox(),mac:Yt.isOSX()||Yt.isiOS(),iOS:Xt.isiPad()||Xt.isiPhone(),android:Yt.isAndroid(),contentEditable:!0,transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",caretAfter:!0,range:window.getSelection&&"Range"in window,documentMode:Kt.isIE()?document.documentMode||7:10,fileApi:Qt,ceFalse:!0,cacheSuffix:null,container:null,experimentalShadowDom:!1,canHaveCSP:!Kt.isIE(),desktop:Xt.isDesktop(),windowsPhone:Zt,browser:{current:Kt.current,version:Kt.version,isChrome:Kt.isChrome,isEdge:Kt.isEdge,isFirefox:Kt.isFirefox,isIE:Kt.isIE,isOpera:Kt.isOpera,isSafari:Kt.isSafari},os:{current:Yt.current,version:Yt.version,isAndroid:Yt.isAndroid,isChromeOS:Yt.isChromeOS,isFreeBSD:Yt.isFreeBSD,isiOS:Yt.isiOS,isLinux:Yt.isLinux,isOSX:Yt.isOSX,isSolaris:Yt.isSolaris,isWindows:Yt.isWindows},deviceType:{isDesktop:Xt.isDesktop,isiPad:Xt.isiPad,isiPhone:Xt.isiPhone,isPhone:Xt.isPhone,isTablet:Xt.isTablet,isTouch:Xt.isTouch,isWebView:Xt.isWebView}},tn=/^\s*|\s*$/g,nn=function(e){return null===e||void 0===e?"":(""+e).replace(tn,"")},rn=function(e,t){return t?!("array"!==t||!Me(e))||typeof e===t:void 0!==e},on=function(e,t,n){var r;e=e||[],t=t||",","string"===typeof e&&(e=e.split(t)),n=n||{},r=e.length;while(r--)n[e[r]]={};return n},an=Re,sn=function(e,t,n){var r,i,o,a=this,s=0;e=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(e);var l=e[3].match(/(^|\.)(\w+)$/i)[2],u=a.createNS(e[3].replace(/\.\w+$/,""),n);if(!u[l]){if("static"===e[2])return u[l]=t,void(this.onCreate&&this.onCreate(e[2],e[3],u[l]));t[l]||(t[l]=function(){},s=1),u[l]=t[l],a.extend(u[l].prototype,t),e[5]&&(r=a.resolve(e[5]).prototype,i=e[5].match(/\.(\w+)$/i)[1],o=u[l],u[l]=s?function(){return r[i].apply(this,arguments)}:function(){return this.parent=r[i],o.apply(this,arguments)},u[l].prototype[l]=u[l],a.each(r,(function(e,t){u[l].prototype[t]=r[t]})),a.each(t,(function(e,t){r[t]?u[l].prototype[t]=function(){return this.parent=r[t],e.apply(this,arguments)}:t!==l&&(u[l].prototype[t]=e)}))),a.each(t.static,(function(e,t){u[l][t]=e}))}},ln=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r++){var i=t[r];for(var o in i)if(Re(i,o)){var a=i[o];void 0!==a&&(e[o]=a)}}return e},un=function(e,t,n,r){r=r||this,e&&(n&&(e=e[n]),Fe(e,(function(e,i){if(!1===t.call(r,e,i,n))return!1;un(e,t,n,r)})))},cn=function(e,t){var n,r;for(t=t||window,e=e.split("."),n=0;n<e.length;n++)r=e[n],t[r]||(t[r]={}),t=t[r];return t},dn=function(e,t){var n,r;for(t=t||window,e=e.split("."),n=0,r=e.length;n<r;n++)if(t=t[e[n]],!t)break;return t},fn=function(e,t){return!e||rn(e,"array")?e:Be(e.split(t||","),nn)},hn=function(e){var t=en.cacheSuffix;return t&&(e+=(-1===e.indexOf("?")?"?":"&")+t),e},mn={trim:nn,isArray:Me,is:rn,toArray:Ne,makeMap:on,each:Fe,map:Be,grep:$e,inArray:ze,hasOwn:an,extend:ln,create:sn,walk:un,createNS:cn,resolve:dn,explode:fn,_addCacheSuffix:hn},pn=function(e,t){var n=t||document,r=n.createElement("div");if(r.innerHTML=e,!r.hasChildNodes()||r.childNodes.length>1)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return bn(r.childNodes[0])},gn=function(e,t){var n=t||document,r=n.createElement(e);return bn(r)},vn=function(e,t){var n=t||document,r=n.createTextNode(e);return bn(r)},bn=function(e){if(null===e||void 0===e)throw new Error("Node cannot be null or undefined");return{dom:e}},yn=function(e,t,n){return j.from(e.dom.elementFromPoint(t,n)).map(bn)},wn={fromHtml:pn,fromTag:gn,fromText:vn,fromDom:bn,fromPoint:yn},Sn=function(e,t){var n=[],r=function(e){return n.push(e),t(e)},i=t(e);do{i=i.bind(r)}while(i.isSome());return n},xn=function(e,t,n){return 0!==(e.compareDocumentPosition(t)&n)},Cn=function(e,t){return xn(e,t,Node.DOCUMENT_POSITION_CONTAINED_BY)},Tn=8,Dn=9,kn=11,En=1,_n=3,An=function(e,t){var n=e.dom;if(n.nodeType!==En)return!1;var r=n;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},Ln=function(e){return e.nodeType!==En&&e.nodeType!==Dn&&e.nodeType!==kn||0===e.childElementCount},On=function(e,t){var n=void 0===t?document:t.dom;return Ln(n)?[]:Q(n.querySelectorAll(e),wn.fromDom)},Rn=function(e,t){var n=void 0===t?document:t.dom;return Ln(n)?j.none():j.from(n.querySelector(e)).map(wn.fromDom)},In=function(e,t){return e.dom===t.dom},Pn=function(e,t){var n=e.dom,r=t.dom;return n!==r&&n.contains(r)},Mn=function(e,t){return Cn(e.dom,t.dom)},Nn=function(e,t){return qt().browser.isIE()?Mn(e,t):Pn(e,t)};"undefined"!==typeof window?window:Function("return this;")();var Fn=function(e){var t=e.dom.nodeName;return t.toLowerCase()},Bn=function(e){return e.dom.nodeType},$n=function(e){return function(t){return Bn(t)===e}},zn=function(e){return Bn(e)===Tn||"#comment"===Fn(e)},Un=$n(En),Vn=$n(_n),Hn=$n(Dn),jn=$n(kn),qn=function(e){return function(t){return Un(t)&&Fn(t)===e}},Gn=function(e){return wn.fromDom(e.dom.ownerDocument)},Wn=function(e){return Hn(e)?e:Gn(e)},Kn=function(e){return wn.fromDom(Wn(e).dom.documentElement)},Yn=function(e){return wn.fromDom(Wn(e).dom.defaultView)},Xn=function(e){return j.from(e.dom.parentNode).map(wn.fromDom)},Jn=function(e,t){var n=D(t)?t:B,r=e.dom,i=[];while(null!==r.parentNode&&void 0!==r.parentNode){var o=r.parentNode,a=wn.fromDom(o);if(i.push(a),!0===n(a))break;r=o}return i},Qn=function(e){var t=function(t){return ne(t,(function(t){return!In(e,t)}))};return Xn(e).map(rr).map(t).getOr([])},Zn=function(e){return j.from(e.dom.previousSibling).map(wn.fromDom)},er=function(e){return j.from(e.dom.nextSibling).map(wn.fromDom)},tr=function(e){return de(Sn(e,Zn))},nr=function(e){return Sn(e,er)},rr=function(e){return Q(e.dom.childNodes,wn.fromDom)},ir=function(e,t){var n=e.dom.childNodes;return j.from(n[t]).map(wn.fromDom)},or=function(e){return ir(e,0)},ar=function(e){return ir(e,e.dom.childNodes.length-1)},sr=function(e){return e.dom.childNodes.length},lr=function(e){var t=e.dom.head;if(null===t||void 0===t)throw new Error("Head is not available yet");return wn.fromDom(t)},ur=function(e){return jn(e)&&T(e.dom.host)},cr=D(Element.prototype.attachShadow)&&D(Node.prototype.getRootNode),dr=L(cr),fr=cr?function(e){return wn.fromDom(e.dom.getRootNode())}:Wn,hr=function(e){return ur(e)?e:lr(Wn(e))},mr=function(e){var t=fr(e);return ur(t)?j.some(t):j.none()},pr=function(e){return wn.fromDom(e.dom.host)},gr=function(e){if(dr()&&T(e.target)){var t=wn.fromDom(e.target);if(Un(t)&&vr(t)&&e.composed&&e.composedPath){var n=e.composedPath();if(n)return ge(n)}}return j.from(e.target)},vr=function(e){return T(e.dom.shadowRoot)},br=function(e,t){var n=Xn(e);n.each((function(n){n.dom.insertBefore(t.dom,e.dom)}))},yr=function(e,t){var n=er(e);n.fold((function(){var n=Xn(e);n.each((function(e){Sr(e,t)}))}),(function(e){br(e,t)}))},wr=function(e,t){var n=or(e);n.fold((function(){Sr(e,t)}),(function(n){e.dom.insertBefore(t.dom,n.dom)}))},Sr=function(e,t){e.dom.appendChild(t.dom)},xr=function(e,t){br(e,t),Sr(t,e)},Cr=function(e,t){Z(t,(function(t){br(e,t)}))},Tr=function(e,t){Z(t,(function(t){Sr(e,t)}))},Dr=function(e){e.dom.textContent="",Z(rr(e),(function(e){kr(e)}))},kr=function(e){var t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},Er=function(e){var t=rr(e);t.length>0&&Cr(e,t),kr(e)},_r=function(e){var t=Vn(e)?e.dom.parentNode:e.dom;if(void 0===t||null===t||null===t.ownerDocument)return!1;var n=t.ownerDocument;return mr(wn.fromDom(t)).fold((function(){return n.body.contains(t)}),A(_r,pr))},Ar=function(e,t){var n=function(n,r){return Ar(e+n,t+r)};return{left:e,top:t,translate:n}},Lr=Ar,Or=function(e){var t=e.getBoundingClientRect();return Lr(t.left,t.top)},Rr=function(e,t){return void 0!==e?e:void 0!==t?t:0},Ir=function(e){var t=e.dom.ownerDocument,n=t.body,r=t.defaultView,i=t.documentElement;if(n===e.dom)return Lr(n.offsetLeft,n.offsetTop);var o=Rr(null===r||void 0===r?void 0:r.pageYOffset,i.scrollTop),a=Rr(null===r||void 0===r?void 0:r.pageXOffset,i.scrollLeft),s=Rr(i.clientTop,n.clientTop),l=Rr(i.clientLeft,n.clientLeft);return Pr(e).translate(a-l,o-s)},Pr=function(e){var t=e.dom,n=t.ownerDocument,r=n.body;return r===t?Lr(r.offsetLeft,r.offsetTop):_r(e)?Or(t):Lr(0,0)},Mr=function(e){var t=void 0!==e?e.dom:document,n=t.body.scrollLeft||t.documentElement.scrollLeft,r=t.body.scrollTop||t.documentElement.scrollTop;return Lr(n,r)},Nr=function(e,t,n){var r=void 0!==n?n.dom:document,i=r.defaultView;i&&i.scrollTo(e,t)},Fr=function(e,t){var n=qt().browser.isSafari();n&&D(e.dom.scrollIntoViewIfNeeded)?e.dom.scrollIntoViewIfNeeded(!1):e.dom.scrollIntoView(t)},Br=function(e){var t=void 0===e?window:e;return qt().browser.isFirefox()?j.none():j.from(t["visualViewport"])},$r=function(e,t,n,r){return{x:e,y:t,width:n,height:r,right:e+n,bottom:t+r}},zr=function(e){var t=void 0===e?window:e,n=t.document,r=Mr(wn.fromDom(n));return Br(t).fold((function(){var e=t.document.documentElement,n=e.clientWidth,i=e.clientHeight;return $r(r.left,r.top,n,i)}),(function(e){return $r(Math.max(e.pageLeft,r.left),Math.max(e.pageTop,r.top),e.width,e.height)}))},Ur=function(e){return function(t){return!!t&&t.nodeType===e}},Vr=function(e){return!!e&&!Object.getPrototypeOf(e)},Hr=Ur(1),jr=function(e){var t=e.map((function(e){return e.toLowerCase()}));return function(e){if(e&&e.nodeName){var n=e.nodeName.toLowerCase();return X(t,n)}return!1}},qr=function(e,t){var n=t.toLowerCase().split(" ");return function(t){if(Hr(t))for(var r=0;r<n.length;r++){var i=t.ownerDocument.defaultView.getComputedStyle(t,null),o=i?i.getPropertyValue(e):null;if(o===n[r])return!0}return!1}},Gr=function(e){return function(t){return Hr(t)&&t.hasAttribute(e)}},Wr=function(e,t){return function(n){return Hr(n)&&n.getAttribute(e)===t}},Kr=function(e){return Hr(e)&&e.hasAttribute("data-mce-bogus")},Yr=function(e){return Hr(e)&&"all"===e.getAttribute("data-mce-bogus")},Xr=function(e){return Hr(e)&&"TABLE"===e.tagName},Jr=function(e){return function(t){if(Hr(t)){if(t.contentEditable===e)return!0;if(t.getAttribute("data-mce-contenteditable")===e)return!0}return!1}},Qr=jr(["textarea","input"]),Zr=Ur(3),ei=Ur(8),ti=Ur(9),ni=Ur(11),ri=jr(["br"]),ii=jr(["img"]),oi=Jr("true"),ai=Jr("false"),si=jr(["td","th"]),li=jr(["video","audio","object","embed"]),ui=function(e,t,n){return void 0===n&&(n=R),e.exists((function(e){return n(e,t)}))},ci=function(e){for(var t=[],n=function(e){t.push(e)},r=0;r<e.length;r++)e[r].each(n);return t},di=function(e,t,n){return e.isSome()&&t.isSome()?j.some(n(e.getOrDie(),t.getOrDie())):j.none()},fi=function(e,t,n,r){return e.isSome()&&t.isSome()&&n.isSome()?j.some(r(e.getOrDie(),t.getOrDie(),n.getOrDie())):j.none()},hi=function(e,t){return e?j.some(t):j.none()},mi=function(e){return void 0!==e.style&&D(e.style.getPropertyValue)},pi=function(e,t,n){if(!(v(n)||S(n)||k(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},gi=function(e,t,n){pi(e.dom,t,n)},vi=function(e,t){var n=e.dom;xe(t,(function(e,t){pi(n,t,e)}))},bi=function(e,t){var n=e.dom.getAttribute(t);return null===n?void 0:n},yi=function(e,t){return j.from(bi(e,t))},wi=function(e,t){var n=e.dom;return!(!n||!n.hasAttribute)&&n.hasAttribute(t)},Si=function(e,t){e.dom.removeAttribute(t)},xi=function(e){return ie(e.dom.attributes,(function(e,t){return e[t.name]=t.value,e}),{})},Ci=function(e,t,n){if(!v(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);mi(e)&&e.style.setProperty(t,n)},Ti=function(e,t){var n=e.dom;xe(t,(function(e,t){Ci(n,t,e)}))},Di=function(e,t){var n=e.dom,r=window.getComputedStyle(n),i=r.getPropertyValue(t);return""!==i||_r(e)?i:ki(n,t)},ki=function(e,t){return mi(e)?e.style.getPropertyValue(t):""},Ei=function(e,t){var n=e.dom,r=ki(n,t);return j.from(r).filter((function(e){return e.length>0}))},_i=function(e){var t={},n=e.dom;if(mi(n))for(var r=0;r<n.style.length;r++){var i=n.style.item(r);t[i]=n.style[i]}return t},Ai=function(e){return e.dom.offsetWidth},Li=qt().browser,Oi=function(e){return ae(e,Un)},Ri=function(e){return Li.isFirefox()&&"table"===Fn(e)?Oi(rr(e)).filter((function(e){return"caption"===Fn(e)})).bind((function(e){return Oi(nr(e)).map((function(t){var n=t.dom.offsetTop,r=e.dom.offsetTop,i=e.dom.offsetHeight;return n<=r?-i:0}))})).getOr(0):0},Ii=function(e,t){return e.children&&X(e.children,t)},Pi=function(e,t,n){var r=0,i=0,o=e.ownerDocument;if(n=n||e,t){if(n===e&&t.getBoundingClientRect&&"static"===Di(wn.fromDom(e),"position")){var a=t.getBoundingClientRect();return r=a.left+(o.documentElement.scrollLeft||e.scrollLeft)-o.documentElement.clientLeft,i=a.top+(o.documentElement.scrollTop||e.scrollTop)-o.documentElement.clientTop,{x:r,y:i}}var s=t;while(s&&s!==n&&s.nodeType&&!Ii(s,n)){var l=s;r+=l.offsetLeft||0,i+=l.offsetTop||0,s=l.offsetParent}s=t.parentNode;while(s&&s!==n&&s.nodeType&&!Ii(s,n))r-=s.scrollLeft||0,i-=s.scrollTop||0,s=s.parentNode;i+=Ri(wn.fromDom(t))}return{x:r,y:i}},Mi={},Ni={exports:Mi};(function(e,n,r,i){(function(t,i){"object"===typeof n&&"undefined"!==typeof r?r.exports=i():"function"===typeof e&&e.amd?e(i):(t="undefined"!==typeof globalThis?globalThis:t||self,t.EphoxContactWrapper=i())})(this,(function(){var e="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof t?t:"undefined"!==typeof self?self:{},n={exports:{}};(function(t){(function(e){var n=setTimeout;function r(){}function i(e,t){return function(){e.apply(t,arguments)}}function o(e){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],d(e,this)}function a(e,t){while(3===e._state)e=e._value;0!==e._state?(e._handled=!0,o._immediateFn((function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var r;try{r=n(e._value)}catch(i){return void l(t.promise,i)}s(t.promise,r)}else(1===e._state?s:l)(t.promise,e._value)}))):e._deferreds.push(t)}function s(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"===typeof t||"function"===typeof t)){var n=t.then;if(t instanceof o)return e._state=3,e._value=t,void u(e);if("function"===typeof n)return void d(i(n,t),e)}e._state=1,e._value=t,u(e)}catch(r){l(e,r)}}function l(e,t){e._state=2,e._value=t,u(e)}function u(e){2===e._state&&0===e._deferreds.length&&o._immediateFn((function(){e._handled||o._unhandledRejectionFn(e._value)}));for(var t=0,n=e._deferreds.length;t<n;t++)a(e,e._deferreds[t]);e._deferreds=null}function c(e,t,n){this.onFulfilled="function"===typeof e?e:null,this.onRejected="function"===typeof t?t:null,this.promise=n}function d(e,t){var n=!1;try{e((function(e){n||(n=!0,s(t,e))}),(function(e){n||(n=!0,l(t,e))}))}catch(r){if(n)return;n=!0,l(t,r)}}o.prototype["catch"]=function(e){return this.then(null,e)},o.prototype.then=function(e,t){var n=new this.constructor(r);return a(this,new c(e,t,n)),n},o.all=function(e){var t=Array.prototype.slice.call(e);return new o((function(e,n){if(0===t.length)return e([]);var r=t.length;function i(o,a){try{if(a&&("object"===typeof a||"function"===typeof a)){var s=a.then;if("function"===typeof s)return void s.call(a,(function(e){i(o,e)}),n)}t[o]=a,0===--r&&e(t)}catch(l){n(l)}}for(var o=0;o<t.length;o++)i(o,t[o])}))},o.resolve=function(e){return e&&"object"===typeof e&&e.constructor===o?e:new o((function(t){t(e)}))},o.reject=function(e){return new o((function(t,n){n(e)}))},o.race=function(e){return new o((function(t,n){for(var r=0,i=e.length;r<i;r++)e[r].then(t,n)}))},o._immediateFn="function"===typeof setImmediate?function(e){setImmediate(e)}:function(e){n(e,0)},o._unhandledRejectionFn=function(e){"undefined"!==typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},o._setImmediateFn=function(e){o._immediateFn=e},o._setUnhandledRejectionFn=function(e){o._unhandledRejectionFn=e},t.exports?t.exports=o:e.Promise||(e.Promise=o)})(e)})(n);var r=n.exports,i=function(){return"undefined"!==typeof window?window:Function("return this;")()}(),o={boltExport:i.Promise||r};return o}))})(void 0,Mi,Ni);var Fi=Ni.exports.boltExport,Bi=function(e){var t=j.none(),n=[],r=function(e){return Bi((function(t){i((function(n){t(e(n))}))}))},i=function(e){a()?l(e):n.push(e)},o=function(e){a()||(t=j.some(e),s(n),n=[])},a=function(){return t.isSome()},s=function(e){Z(e,l)},l=function(e){t.each((function(t){setTimeout((function(){e(t)}),0)}))};return e(o),{get:i,map:r,isReady:a}},$i=function(e){return Bi((function(t){t(e)}))},zi={nu:Bi,pure:$i},Ui=function(e){setTimeout((function(){throw e}),0)},Vi=function(e){var t=function(t){e().then(t,Ui)},n=function(t){return Vi((function(){return e().then(t)}))},r=function(t){return Vi((function(){return e().then((function(e){return t(e).toPromise()}))}))},i=function(t){return Vi((function(){return e().then((function(){return t.toPromise()}))}))},o=function(){return zi.nu(t)},a=function(){var t=null;return Vi((function(){return null===t&&(t=e()),t}))},s=e;return{map:n,bind:r,anonBind:i,toLazy:o,toCached:a,toPromise:s,get:t}},Hi=function(e){return Vi((function(){return new Fi(e)}))},ji=function(e){return Vi((function(){return Fi.resolve(e)}))},qi={nu:Hi,pure:ji},Gi=function(e,t){return t((function(t){var n=[],r=0,i=function(i){return function(o){n[i]=o,r++,r>=e.length&&t(n)}};0===e.length?t([]):Z(e,(function(e,t){e.get(i(t))}))}))},Wi=function(e){return Gi(e,qi.nu)},Ki=function(e){var t=function(t){return Ki(e)},n=function(t){return Ki(e)},r=function(t){return Ki(t(e))},i=function(t){return Ki(e)},o=function(t){t(e)},a=function(t){return t(e)},s=function(t,n){return n(e)},l=function(t){return t(e)},u=function(t){return t(e)},c=function(){return j.some(e)};return{isValue:$,isError:B,getOr:L(e),getOrThunk:L(e),getOrDie:L(e),or:t,orThunk:n,fold:s,map:r,mapError:i,each:o,bind:a,exists:l,forall:u,toOptional:c}},Yi=function(e){var t=function(e){return e()},n=function(){return M(String(e))()},r=O,i=function(e){return e()},o=function(t){return Yi(e)},a=function(t){return Yi(t(e))},s=function(t){return Yi(e)},l=function(t,n){return t(e)};return{isValue:B,isError:$,getOr:O,getOrThunk:t,getOrDie:n,or:r,orThunk:i,fold:l,map:o,mapError:a,each:E,bind:s,exists:B,forall:$,toOptional:j.none}},Xi=function(e,t){return e.fold((function(){return Yi(t)}),Ki)},Ji={value:Ki,error:Yi,fromOption:Xi},Qi=function(e){if(!y(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var t=[],n={};return Z(e,(function(r,i){var o=we(r);if(1!==o.length)throw new Error("one and only one name per case");var a=o[0],s=r[a];if(void 0!==n[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!y(s))throw new Error("case arguments must be an array");t.push(a),n[a]=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=n.length;if(o!==s.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+s.length+" ("+s+"), got "+o);var l=function(e){var r=we(e);if(t.length!==r.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+r.join(","));var i=ce(t,(function(e){return X(r,e)}));if(!i)throw new Error("Not all branches were specified when using match. Specified: "+r.join(", ")+"\nRequired: "+t.join(", "));return e[a].apply(null,n)};return{fold:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(t.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);var o=t[i];return o.apply(null,n)},match:l,log:function(e){console.log(e,{constructors:t,constructor:a,params:n})}}}})),n},Zi={generate:Qi};Zi.generate([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);var eo=function(e){return e.fold(O,O)};function to(e,t,n,r,i){return e(n,r)?j.some(n):D(i)&&i(n)?j.none():t(n,r,i)}var no,ro,io,oo,ao,so,lo,uo,co,fo,ho,mo,po,go,vo,bo,yo,wo,So,xo=function(e,t,n){var r=e.dom,i=D(n)?n:B;while(r.parentNode){r=r.parentNode;var o=wn.fromDom(r);if(t(o))return j.some(o);if(i(o))break}return j.none()},Co=function(e,t,n){var r=function(e,t){return t(e)};return to(r,xo,e,t,n)},To=function(e,t){var n=e.dom;return n.parentNode?Do(wn.fromDom(n.parentNode),(function(n){return!In(e,n)&&t(n)})):j.none()},Do=function(e,t){var n=function(e){return t(wn.fromDom(e))},r=ae(e.dom.childNodes,n);return r.map(wn.fromDom)},ko=function(e,t,n){return xo(e,(function(e){return An(e,t)}),n)},Eo=function(e,t){return Rn(t,e)},_o=function(e,t,n){var r=function(e,t){return An(e,t)};return to(r,ko,e,t,n)},Ao=window.Promise?window.Promise:Fi,Lo=function(e,t){for(var n=window.requestAnimationFrame,r=["ms","moz","webkit"],i=function(e){window.setTimeout(e,0)},o=0;o<r.length&&!n;o++)n=window[r[o]+"RequestAnimationFrame"];n||(n=i),n(e,t)},Oo=function(e,t){return"number"!==typeof t&&(t=0),setTimeout(e,t)},Ro=function(e,t){return"number"!==typeof t&&(t=1),setInterval(e,t)},Io=function(e){return clearTimeout(e)},Po=function(e){return clearInterval(e)},Mo=function(e,t){var n,r=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];clearTimeout(n),n=Oo((function(){e.apply(this,r)}),t)};return r.stop=function(){clearTimeout(n)},r},No={requestAnimationFrame:function(e,t){no?no.then(e):no=new Ao((function(e){t||(t=document.body),Lo(e,t)})).then(e)},setTimeout:Oo,setInterval:Ro,setEditorTimeout:function(e,t,n){return Oo((function(){e.removed||t()}),n)},setEditorInterval:function(e,t,n){var r=Ro((function(){e.removed?clearInterval(r):t()}),n);return r},debounce:Mo,throttle:Mo,clearInterval:Po,clearTimeout:Io},Fo=function(e,t){void 0===t&&(t={});var n=0,r={},i=wn.fromDom(e),o=Wn(i),a=t.maxLoadTime||5e3,s=function(e){t.referrerPolicy=e},l=function(e){Sr(hr(i),e)},u=function(e){var t=hr(i);Eo(t,"#"+e).each(kr)},c=function(e){return Oe(r,e).getOrThunk((function(){return{id:"mce-u"+n++,passed:[],failed:[],count:0}}))},d=function(n,i,s){var u,d=mn._addCacheSuffix(n),f=c(d);r[d]=f,f.count++;var h=function(e,t){var n=e.length;while(n--)e[n]();f.status=t,f.passed=[],f.failed=[],u&&(u.onload=null,u.onerror=null,u=null)},m=function(){return h(f.passed,2)},p=function(){return h(f.failed,3)},g=function(e,t){e()||(Date.now()-y<a?No.setTimeout(t):p())},v=function(){g((function(){var t=e.styleSheets,n=t.length;while(n--){var r=t[n],i=r.ownerNode;if(i&&i.id===u.id)return m(),!0}return!1}),v)};if(i&&f.passed.push(i),s&&f.failed.push(s),1!==f.status)if(2!==f.status)if(3!==f.status){f.status=1;var b=wn.fromTag("link",o.dom);vi(b,{rel:"stylesheet",type:"text/css",id:f.id});var y=Date.now();t.contentCssCors&&gi(b,"crossOrigin","anonymous"),t.referrerPolicy&&gi(b,"referrerpolicy",t.referrerPolicy),u=b.dom,u.onload=v,u.onerror=p,l(b),gi(b,"href",d)}else p();else m()},f=function(e){return qi.nu((function(t){d(e,_(t,L(Ji.value(e))),_(t,L(Ji.error(e))))}))},h=function(e,t,n){Wi(Q(e,f)).get((function(e){var r=te(e,(function(e){return e.isValue()}));r.fail.length>0?n(r.fail.map(eo)):t(r.pass.map(eo))}))},m=function(e){var t=mn._addCacheSuffix(e);Oe(r,t).each((function(e){var n=--e.count;0===n&&(delete r[t],u(e.id))}))},p=function(e){Z(e,(function(e){m(e)}))};return{load:d,loadAll:h,unload:m,unloadAll:p,_setReferrerPolicy:s}},Bo=function(){var e=new WeakMap,t=function(t,n){var r=fr(t),i=r.dom;return j.from(e.get(i)).getOrThunk((function(){var t=Fo(i,n);return e.set(i,t),t}))};return{forElement:t}},$o=Bo(),zo=function(){function e(e,t){this.node=e,this.rootNode=t,this.current=this.current.bind(this),this.next=this.next.bind(this),this.prev=this.prev.bind(this),this.prev2=this.prev2.bind(this)}return e.prototype.current=function(){return this.node},e.prototype.next=function(e){return this.node=this.findSibling(this.node,"firstChild","nextSibling",e),this.node},e.prototype.prev=function(e){return this.node=this.findSibling(this.node,"lastChild","previousSibling",e),this.node},e.prototype.prev2=function(e){return this.node=this.findPreviousNode(this.node,"lastChild","previousSibling",e),this.node},e.prototype.findSibling=function(e,t,n,r){var i,o;if(e){if(!r&&e[t])return e[t];if(e!==this.rootNode){if(i=e[n],i)return i;for(o=e.parentNode;o&&o!==this.rootNode;o=o.parentNode)if(i=o[n],i)return i}}},e.prototype.findPreviousNode=function(e,t,n,r){var i,o,a;if(e){if(i=e[n],this.rootNode&&i===this.rootNode)return;if(i){if(!r)for(a=i[t];a;a=a[t])if(!a[t])return a;return i}if(o=e.parentNode,o&&o!==this.rootNode)return o}},e}(),Uo=["article","aside","details","div","dt","figcaption","footer","form","fieldset","header","hgroup","html","main","nav","section","summary","body","p","dl","multicol","dd","figure","address","center","blockquote","h1","h2","h3","h4","h5","h6","listing","xmp","pre","plaintext","menu","dir","ul","ol","li","hr","table","tbody","thead","tfoot","th","tr","td","caption"],Vo=["td","th"],Ho=["thead","tbody","tfoot"],jo=["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"],qo=["h1","h2","h3","h4","h5","h6"],Go=["li","dd","dt"],Wo=["ul","ol","dl"],Ko=["pre","script","textarea","style"],Yo=function(e){var t;return function(n){return t=t||he(e,$),Re(t,Fn(n))}},Xo=Yo(qo),Jo=Yo(Uo),Qo=function(e){return"table"===Fn(e)},Zo=function(e){return Un(e)&&!Jo(e)},ea=function(e){return Un(e)&&"br"===Fn(e)},ta=Yo(jo),na=Yo(Wo),ra=Yo(Go),ia=Yo(Ho),oa=Yo(Vo),aa=Yo(Ko),sa=function(e,t,n){return ko(e,t,n).isSome()},la="\ufeff",ua=" ",ca=function(e){return e===la},da=function(e){return e.replace(/\uFEFF/g,"")},fa=la,ha=ca,ma=da,pa=Hr,ga=Zr,va=function(e){return ga(e)&&(e=e.parentNode),pa(e)&&e.hasAttribute("data-mce-caret")},ba=function(e){return ga(e)&&ha(e.data)},ya=function(e){return va(e)||ba(e)},wa=function(e){return e.firstChild!==e.lastChild||!ri(e.firstChild)},Sa=function(e,t){var n=e.ownerDocument,r=n.createTextNode(fa),i=e.parentNode;if(t){o=e.previousSibling;if(ga(o)){if(ya(o))return o;if(Ea(o))return o.splitText(o.data.length-1)}i.insertBefore(r,e)}else{var o=e.nextSibling;if(ga(o)){if(ya(o))return o;if(ka(o))return o.splitText(1),o}e.nextSibling?i.insertBefore(r,e.nextSibling):i.appendChild(r)}return r},xa=function(e){var t=e.container();return!!Zr(t)&&(t.data.charAt(e.offset())===fa||e.isAtStart()&&ba(t.previousSibling))},Ca=function(e){var t=e.container();return!!Zr(t)&&(t.data.charAt(e.offset()-1)===fa||e.isAtEnd()&&ba(t.nextSibling))},Ta=function(){var e=document.createElement("br");return e.setAttribute("data-mce-bogus","1"),e},Da=function(e,t,n){var r=t.ownerDocument,i=r.createElement(e);i.setAttribute("data-mce-caret",n?"before":"after"),i.setAttribute("data-mce-bogus","all"),i.appendChild(Ta());var o=t.parentNode;return n?o.insertBefore(i,t):t.nextSibling?o.insertBefore(i,t.nextSibling):o.appendChild(i),i},ka=function(e){return ga(e)&&e.data[0]===fa},Ea=function(e){return ga(e)&&e.data[e.data.length-1]===fa},_a=function(e){var t=e.getElementsByTagName("br"),n=t[t.length-1];Kr(n)&&n.parentNode.removeChild(n)},Aa=function(e){return e&&e.hasAttribute("data-mce-caret")?(_a(e),e.removeAttribute("data-mce-caret"),e.removeAttribute("data-mce-bogus"),e.removeAttribute("style"),e.removeAttribute("_moz_abspos"),e):null},La=function(e){return va(e.startContainer)},Oa=oi,Ra=ai,Ia=ri,Pa=Zr,Ma=jr(["script","style","textarea"]),Na=jr(["img","input","textarea","hr","iframe","video","audio","object","embed"]),Fa=jr(["table"]),Ba=ya,$a=function(e){return!Ba(e)&&(Pa(e)?!Ma(e.parentNode):Na(e)||Ia(e)||Fa(e)||Ua(e))},za=function(e){return Hr(e)&&"true"===e.getAttribute("unselectable")},Ua=function(e){return!1===za(e)&&Ra(e)},Va=function(e,t){for(e=e.parentNode;e&&e!==t;e=e.parentNode){if(Ua(e))return!1;if(Oa(e))return!0}return!0},Ha=function(e){return!!Ua(e)&&!0!==ie(be(e.getElementsByTagName("*")),(function(e,t){return e||Oa(t)}),!1)},ja=function(e){return Na(e)||Ha(e)},qa=function(e,t){return $a(e)&&Va(e,t)},Ga=/^[ \t\r\n]*$/,Wa=function(e){return Ga.test(e)},Ka=function(e,t){var n=wn.fromDom(t),r=wn.fromDom(e);return sa(r,"pre,code",I(In,n))},Ya=function(e,t){return Zr(e)&&Wa(e.data)&&!1===Ka(e,t)},Xa=function(e){return Hr(e)&&"A"===e.nodeName&&!e.hasAttribute("href")&&(e.hasAttribute("name")||e.hasAttribute("id"))},Ja=function(e,t){return $a(e)&&!1===Ya(e,t)||Xa(e)||Qa(e)},Qa=Gr("data-mce-bookmark"),Za=Gr("data-mce-bogus"),es=Wr("data-mce-bogus","all"),ts=function(e,t){var n=0;if(Ja(e,e))return!1;var r=e.firstChild;if(!r)return!0;var i=new zo(r,e);do{if(t){if(es(r)){r=i.next(!0);continue}if(Za(r)){r=i.next();continue}}if(ri(r))n++,r=i.next();else{if(Ja(r,e))return!1;r=i.next()}}while(r);return n<=1},ns=function(e,t){return void 0===t&&(t=!0),ts(e.dom,t)},rs=function(e){return"span"===e.nodeName.toLowerCase()},is=function(e,t){return T(e)&&(Ja(e,t)||Zo(wn.fromDom(e)))},os=function(e,t){var n=new zo(e,t).prev(!1),r=new zo(e,t).next(!1),i=x(n)||is(n,t),o=x(r)||is(r,t);return i&&o},as=function(e){return rs(e)&&"bookmark"===e.getAttribute("data-mce-type")},ss=function(e,t){return Zr(e)&&e.data.length>0&&os(e,t)},ls=function(e){return!!Hr(e)&&e.childNodes.length>0},us=function(e){return ni(e)||ti(e)},cs=function(e,t,n){var r=n||t;if(Hr(t)&&as(t))return t;for(var i=t.childNodes,o=i.length-1;o>=0;o--)cs(e,i[o],r);if(Hr(t)){var a=t.childNodes;1===a.length&&as(a[0])&&t.parentNode.insertBefore(a[0],t)}return us(t)||Ja(t,r)||ls(t)||ss(t,r)||e.remove(t),t},ds=mn.makeMap,fs=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,hs=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,ms=/[<>&\"\']/g,ps=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,gs={128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"},vs={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},bs={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"},ys=function(e){var t=wn.fromTag("div").dom;return t.innerHTML=e,t.textContent||t.innerText||e},ws=function(e,t){var n,r,i,o={};if(e){for(e=e.split(","),t=t||10,n=0;n<e.length;n+=2)r=String.fromCharCode(parseInt(e[n],t)),vs[r]||(i="&"+e[n+1]+";",o[r]=i,o[i]=r);return o}},Ss=ws("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),xs=function(e,t){return e.replace(t?fs:hs,(function(e){return vs[e]||e}))},Cs=function(e){return(""+e).replace(ms,(function(e){return vs[e]||e}))},Ts=function(e,t){return e.replace(t?fs:hs,(function(e){return e.length>1?"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";":vs[e]||"&#"+e.charCodeAt(0)+";"}))},Ds=function(e,t,n){return n=n||Ss,e.replace(t?fs:hs,(function(e){return vs[e]||n[e]||e}))},ks=function(e,t){var n=ws(t)||Ss,r=function(e,t){return e.replace(t?fs:hs,(function(e){return void 0!==vs[e]?vs[e]:void 0!==n[e]?n[e]:e.length>1?"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";":"&#"+e.charCodeAt(0)+";"}))},i=function(e,t){return Ds(e,t,n)},o=ds(e.replace(/\+/g,","));return o.named&&o.numeric?r:o.named?t?i:Ds:o.numeric?Ts:xs},Es=function(e){return e.replace(ps,(function(e,t){return t?(t="x"===t.charAt(0).toLowerCase()?parseInt(t.substr(1),16):parseInt(t,10),t>65535?(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t))):gs[t]||String.fromCharCode(t)):bs[e]||Ss[e]||ys(e)}))},_s={encodeRaw:xs,encodeAllRaw:Cs,encodeNumeric:Ts,encodeNamed:Ds,getEncodeFunc:ks,decode:Es},As={},Ls={},Os=mn.makeMap,Rs=mn.each,Is=mn.extend,Ps=mn.explode,Ms=mn.inArray,Ns=function(e,t){return e=mn.trim(e),e?e.split(t||" "):[]},Fs=function(e,t){var n=Os(e," ",Os(e.toUpperCase()," "));return Is(n,t)},Bs=function(e){return Fs("td th li dt dd figcaption caption details summary",e.getTextBlockElements())},$s=function(e){var t,n,r,i,o,a,s={},l=function(e,n,r){var i,o,a,l=function(e,t){var n,r,i={};for(n=0,r=e.length;n<r;n++)i[e[n]]=t||{};return i};r=r||[],n=n||"","string"===typeof r&&(r=Ns(r));var u=Ns(e);i=u.length;while(i--)o=Ns([t,n].join(" ")),a={attributes:l(o),attributesOrder:o,children:l(r,Ls)},s[u[i]]=a},u=function(e,t){var n,r,i,o,a=Ns(e);n=a.length;var l=Ns(t);while(n--)for(r=s[a[n]],i=0,o=l.length;i<o;i++)r.attributes[l[i]]={},r.attributesOrder.push(l[i])};return As[e]?As[e]:(t="id accesskey class dir lang style tabindex title role",n="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",r="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment","html4"!==e&&(t+=" contenteditable contextmenu draggable dropzone hidden spellcheck translate",n+=" article aside details dialog figure main header footer hgroup section nav",r+=" audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen"),"html5-strict"!==e&&(t+=" xml:lang",a="acronym applet basefont big font strike tt",r=[r,a].join(" "),Rs(Ns(a),(function(e){l(e,"",r)})),o="center dir isindex noframes",n=[n,o].join(" "),i=[n,r].join(" "),Rs(Ns(o),(function(e){l(e,"",i)}))),i=i||[n,r].join(" "),l("html","manifest","head body"),l("head","","base command link meta noscript script style title"),l("title hr noscript br"),l("base","href target"),l("link","href rel media hreflang type sizes hreflang"),l("meta","name http-equiv content charset"),l("style","media type scoped"),l("script","src async defer type charset"),l("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",i),l("address dt dd div caption","",i),l("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",r),l("blockquote","cite",i),l("ol","reversed start type","li"),l("ul","","li"),l("li","value",i),l("dl","","dt dd"),l("a","href target rel media hreflang type",r),l("q","cite",r),l("ins del","cite datetime",i),l("img","src sizes srcset alt usemap ismap width height"),l("iframe","src name width height",i),l("embed","src type width height"),l("object","data type typemustmatch name usemap form width height",[i,"param"].join(" ")),l("param","name value"),l("map","name",[i,"area"].join(" ")),l("area","alt coords shape href target rel media hreflang type"),l("table","border","caption colgroup thead tfoot tbody tr"+("html4"===e?" col":"")),l("colgroup","span","col"),l("col","span"),l("tbody thead tfoot","","tr"),l("tr","","td th"),l("td","colspan rowspan headers",i),l("th","colspan rowspan headers scope abbr",i),l("form","accept-charset action autocomplete enctype method name novalidate target",i),l("fieldset","disabled form name",[i,"legend"].join(" ")),l("label","form for",r),l("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),l("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value","html4"===e?i:r),l("select","disabled form multiple name required size","option optgroup"),l("optgroup","disabled label","option"),l("option","disabled label selected value"),l("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),l("menu","type label",[i,"li"].join(" ")),l("noscript","",i),"html4"!==e&&(l("wbr"),l("ruby","",[r,"rt rp"].join(" ")),l("figcaption","",i),l("mark rt rp summary bdi","",r),l("canvas","width height",i),l("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[i,"track source"].join(" ")),l("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[i,"track source"].join(" ")),l("picture","","img source"),l("source","src srcset type media sizes"),l("track","kind src srclang label default"),l("datalist","",[r,"option"].join(" ")),l("article section nav aside main header footer","",i),l("hgroup","","h1 h2 h3 h4 h5 h6"),l("figure","",[i,"figcaption"].join(" ")),l("time","datetime",r),l("dialog","open",i),l("command","type label icon disabled checked radiogroup command"),l("output","for form name",r),l("progress","value max",r),l("meter","value min max low high optimum",r),l("details","open",[i,"summary"].join(" ")),l("keygen","autofocus challenge disabled form keytype name")),"html5-strict"!==e&&(u("script","language xml:space"),u("style","xml:space"),u("object","declare classid code codebase codetype archive standby align border hspace vspace"),u("embed","align name hspace vspace"),u("param","valuetype type"),u("a","charset name rev shape coords"),u("br","clear"),u("applet","codebase archive code object alt name width height align hspace vspace"),u("img","name longdesc align border hspace vspace"),u("iframe","longdesc frameborder marginwidth marginheight scrolling align"),u("font basefont","size color face"),u("input","usemap align"),u("select"),u("textarea"),u("h1 h2 h3 h4 h5 h6 div p legend caption","align"),u("ul","type compact"),u("li","type"),u("ol dl menu dir","compact"),u("pre","width xml:space"),u("hr","align noshade size width"),u("isindex","prompt"),u("table","summary width frame rules cellspacing cellpadding align bgcolor"),u("col","width align char charoff valign"),u("colgroup","width align char charoff valign"),u("thead","align char charoff valign"),u("tr","align char charoff valign bgcolor"),u("th","axis align char charoff valign nowrap bgcolor width height"),u("form","accept"),u("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),u("tfoot","align char charoff valign"),u("tbody","align char charoff valign"),u("area","nohref"),u("body","background bgcolor text link vlink alink")),"html4"!==e&&(u("input button select textarea","autofocus"),u("input textarea","placeholder"),u("a","download"),u("link script img","crossorigin"),u("img","loading"),u("iframe","sandbox seamless allowfullscreen loading")),Rs(Ns("a form meter progress dfn"),(function(e){s[e]&&delete s[e].children[e]})),delete s.caption.children.table,delete s.script,As[e]=s,s)},zs=function(e,t){var n;return e&&(n={},"string"===typeof e&&(e={"*":e}),Rs(e,(function(e,r){n[r]=n[r.toUpperCase()]="map"===t?Os(e,/[, ]/):Ps(e,/[, ]/)}))),n},Us=function(e){var t={},n={},r=[],i={},o={},a=function(t,n,r){var i=e[t];return i?i=Os(i,/[, ]/,Os(i.toUpperCase(),/[, ]/)):(i=As[t],i||(i=Fs(n,r),As[t]=i)),i};e=e||{};var s=$s(e.schema);!1===e.verify_html&&(e.valid_elements="*[*]");var l=zs(e.valid_styles),u=zs(e.invalid_styles,"map"),c=zs(e.valid_classes,"map"),d=a("whitespace_elements","pre script noscript style textarea video audio iframe object code"),f=a("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),h=a("short_ended_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),m=a("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls"),p="td th iframe video audio object script code",g=a("non_empty_elements",p+" pre",h),v=a("move_caret_before_on_enter_elements",p+" table",h),b=a("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside main nav figure"),y=a("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary",b),w=a("text_inline_elements","span strong b em i font s strike u var cite dfn code mark q sup sub samp");Rs((e.special||"script noscript iframe noframes noembed title style textarea xmp").split(" "),(function(e){o[e]=new RegExp("</"+e+"[^>]*>","gi")}));var S=function(e){return new RegExp("^"+e.replace(/([?+*])/g,".$1")+"$")},x=function(e){var n,i,o,a,s,l,u,c,d,f,h,m,p,g,v,b,y,w,x=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)])?$/,C=/^([!\-])?(\w+[\\:]:\w+|[^=:<]+)?(?:([=:<])(.*))?$/,T=/[*?+]/;if(e){var D=Ns(e,",");for(t["@"]&&(b=t["@"].attributes,y=t["@"].attributesOrder),n=0,i=D.length;n<i;n++)if(s=x.exec(D[n]),s){if(g=s[1],d=s[2],v=s[3],c=s[5],m={},p=[],l={attributes:m,attributesOrder:p},"#"===g&&(l.paddEmpty=!0),"-"===g&&(l.removeEmpty=!0),"!"===s[4]&&(l.removeEmptyAttrs=!0),b&&(xe(b,(function(e,t){m[t]=e})),p.push.apply(p,y)),c)for(c=Ns(c,"|"),o=0,a=c.length;o<a;o++)if(s=C.exec(c[o]),s){if(u={},h=s[1],f=s[2].replace(/[\\:]:/g,":"),g=s[3],w=s[4],"!"===h&&(l.attributesRequired=l.attributesRequired||[],l.attributesRequired.push(f),u.required=!0),"-"===h){delete m[f],p.splice(Ms(p,f),1);continue}g&&("="===g&&(l.attributesDefault=l.attributesDefault||[],l.attributesDefault.push({name:f,value:w}),u.defaultValue=w),":"===g&&(l.attributesForced=l.attributesForced||[],l.attributesForced.push({name:f,value:w}),u.forcedValue=w),"<"===g&&(u.validValues=Os(w,"?"))),T.test(f)?(l.attributePatterns=l.attributePatterns||[],u.pattern=S(f),l.attributePatterns.push(u)):(m[f]||p.push(f),m[f]=u)}b||"@"!==d||(b=m,y=p),v&&(l.outputName=d,t[v]=l),T.test(d)?(l.pattern=S(d),r.push(l)):t[d]=l}}},C=function(e){t={},r=[],x(e),Rs(s,(function(e,t){n[t]=e.children}))},T=function(e){var r=/^(~)?(.+)$/;e&&(As.text_block_elements=As.block_elements=null,Rs(Ns(e,","),(function(e){var o=r.exec(e),a="~"===o[1],s=a?"span":"div",l=o[2];if(n[l]=n[s],i[l]=s,a||(y[l.toUpperCase()]={},y[l]={}),!t[l]){var u=t[s];u=Is({},u),delete u.removeEmptyAttrs,delete u.removeEmpty,t[l]=u}Rs(n,(function(e,t){e[s]&&(n[t]=e=Is({},n[t]),e[l]=e[s])}))})))},D=function(t){var r=/^([+\-]?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)\[([^\]]+)]$/;As[e.schema]=null,t&&Rs(Ns(t,","),(function(e){var t,i,o=r.exec(e);o&&(i=o[1],t=i?n[o[2]]:n[o[2]]={"#comment":{}},t=n[o[2]],Rs(Ns(o[3],"|"),(function(e){"-"===i?delete t[e]:t[e]={}})))}))},k=function(e){var n,i=t[e];if(i)return i;n=r.length;while(n--)if(i=r[n],i.pattern.test(e))return i};e.valid_elements?C(e.valid_elements):(Rs(s,(function(e,r){t[r]={attributes:e.attributes,attributesOrder:e.attributesOrder},n[r]=e.children})),"html5"!==e.schema&&Rs(Ns("strong/b em/i"),(function(e){var n=Ns(e,"/");t[n[1]].outputName=n[0]})),Rs(w,(function(n,r){t[r]&&(e.padd_empty_block_inline_children&&(t[r].paddInEmptyBlock=!0),t[r].removeEmpty=!0)})),Rs(Ns("ol ul blockquote a table tbody"),(function(e){t[e]&&(t[e].removeEmpty=!0)})),Rs(Ns("p h1 h2 h3 h4 h5 h6 th td pre div address caption li"),(function(e){t[e].paddEmpty=!0})),Rs(Ns("span"),(function(e){t[e].removeEmptyAttrs=!0}))),T(e.custom_elements),D(e.valid_children),x(e.extended_valid_elements),D("+ol[ul|ol],+ul[ul|ol]"),Rs({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},(function(e,n){t[n]&&(t[n].parentsRequired=Ns(e))})),e.invalid_elements&&Rs(Ps(e.invalid_elements),(function(e){t[e]&&delete t[e]})),k("span")||x("span[!data-mce-type|*]");var E=L(l),_=L(u),A=L(c),O=L(m),R=L(y),I=L(b),P=L(w),M=L(h),N=L(f),F=L(g),B=L(v),$=L(d),z=L(o),U=function(e,t){var r=n[e.toLowerCase()];return!(!r||!r[t.toLowerCase()])},V=function(e,t){var n,r,i=k(e);if(i){if(!t)return!0;if(i.attributes[t])return!0;if(n=i.attributePatterns,n){r=n.length;while(r--)if(n[r].pattern.test(e))return!0}}return!1},H=L(i);return{children:n,elements:t,getValidStyles:E,getValidClasses:A,getBlockElements:R,getInvalidStyles:_,getShortEndedElements:M,getTextBlockElements:I,getTextInlineElements:P,getBoolAttrs:O,getElementRule:k,getSelfClosingElements:N,getNonEmptyElements:F,getMoveCaretBeforeOnEnterElements:B,getWhiteSpaceElements:$,getSpecialElements:z,isValidChild:U,isValid:V,getCustomElements:H,addValidElements:x,setValidElements:C,addCustomElements:T,addValidChildren:D}},Vs=function(e,t,n,r){var i=function(e){return e=parseInt(e,10).toString(16),e.length>1?e:"0"+e};return"#"+i(t)+i(n)+i(r)},Hs=function(e,t){var n,r,i,o=this,a=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,s=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,l=/\s*([^:]+):\s*([^;]+);?/g,u=/\s+$/,c={},d=la;e=e||{},t&&(r=t.getValidStyles(),i=t.getInvalidStyles());var f=("\\\" \\' \\; \\: ; : "+d).split(" ");for(n=0;n<f.length;n++)c[f[n]]=d+n,c[d+n]=f[n];return{toHex:function(e){return e.replace(a,Vs)},parse:function(t){var r,i,f,h,m={},p=e.url_converter,g=e.url_converter_scope||o,v=function(e,t,r){var i=m[e+"-top"+t];if(i){var o=m[e+"-right"+t];if(o){var a=m[e+"-bottom"+t];if(a){var s=m[e+"-left"+t];if(s){var l=[i,o,a,s];n=l.length-1;while(n--)if(l[n]!==l[n+1])break;n>-1&&r||(m[e+t]=-1===n?l[0]:l.join(" "),delete m[e+"-top"+t],delete m[e+"-right"+t],delete m[e+"-bottom"+t],delete m[e+"-left"+t])}}}}},b=function(e){var t,n=m[e];if(n){n=n.split(" "),t=n.length;while(t--)if(n[t]!==n[0])return!1;return m[e]=n[0],!0}},y=function(e,t,n,r){b(t)&&b(n)&&b(r)&&(m[e]=m[t]+" "+m[n]+" "+m[r],delete m[t],delete m[n],delete m[r])},w=function(e){return h=!0,c[e]},S=function(e,t){return h&&(e=e.replace(/\uFEFF[0-9]/g,(function(e){return c[e]}))),t||(e=e.replace(/\\([\'\";:])/g,"$1")),e},x=function(e){return String.fromCharCode(parseInt(e.slice(1),16))},C=function(e){return e.replace(/\\[0-9a-f]+/gi,x)},T=function(t,n,r,i,o,a){if(o=o||a,o)return o=S(o),"'"+o.replace(/\'/g,"\\'")+"'";if(n=S(n||r||i),!e.allow_script_urls){var s=n.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(s))return"";if(!e.allow_svg_data_urls&&/^data:image\/svg/i.test(s))return""}return p&&(n=p.call(g,n,"style")),"url('"+n.replace(/\'/g,"\\'")+"')"};if(t){t=t.replace(/[\u0000-\u001F]/g,""),t=t.replace(/\\[\"\';:\uFEFF]/g,w).replace(/\"[^\"]+\"|\'[^\']+\'/g,(function(e){return e.replace(/[;:]/g,w)}));while(r=l.exec(t))if(l.lastIndex=r.index+r[0].length,i=r[1].replace(u,"").toLowerCase(),f=r[2].replace(u,""),i&&f){if(i=C(i),f=C(f),-1!==i.indexOf(d)||-1!==i.indexOf('"'))continue;if(!e.allow_script_urls&&("behavior"===i||/expression\s*\(|\/\*|\*\//.test(f)))continue;"font-weight"===i&&"700"===f?f="bold":"color"!==i&&"background-color"!==i||(f=f.toLowerCase()),f=f.replace(a,Vs),f=f.replace(s,T),m[i]=h?S(f,!0):f}v("border","",!0),v("border","-width"),v("border","-color"),v("border","-style"),v("padding",""),v("margin",""),y("border","border-width","border-style","border-color"),"medium none"===m.border&&delete m.border,"none"===m["border-image"]&&delete m["border-image"]}return m},serialize:function(e,t){var n="",o=function(t){var i,o=r[t];if(o)for(var a=0,s=o.length;a<s;a++)t=o[a],i=e[t],i&&(n+=(n.length>0?" ":"")+t+": "+i+";")},a=function(e,t){var n=i["*"];return(!n||!n[e])&&(n=i[t],!(n&&n[e]))};return t&&r?(o("*"),o(t)):xe(e,(function(e,r){!e||i&&!a(r,t)||(n+=(n.length>0?" ":"")+r+": "+e+";")})),n}}},js={keyLocation:!0,layerX:!0,layerY:!0,returnValue:!0,webkitMovementX:!0,webkitMovementY:!0,keyIdentifier:!0,mozPressure:!0},qs=function(e){return e instanceof Event||D(e.initEvent)},Gs=function(e){return e.isDefaultPrevented===$||e.isDefaultPrevented===B},Ws=function(e){return C(e.preventDefault)||qs(e)},Ks=function(e,t){var n=null!==t&&void 0!==t?t:{};for(var r in e)Re(js,r)||(n[r]=e[r]);return T(n.composedPath)&&(n.composedPath=function(){return e.composedPath()}),n},Ys=function(e,t,n,r){var i,o=Ks(t,r);return o.type=e,C(o.target)&&(o.target=null!==(i=o.srcElement)&&void 0!==i?i:n),Ws(t)&&(o.preventDefault=function(){o.defaultPrevented=!0,o.isDefaultPrevented=$,D(t.preventDefault)?t.preventDefault():qs(t)&&(t.returnValue=!1)},o.stopPropagation=function(){o.cancelBubble=!0,o.isPropagationStopped=$,D(t.stopPropagation)?t.stopPropagation():qs(t)&&(t.cancelBubble=!0)},o.stopImmediatePropagation=function(){o.isImmediatePropagationStopped=$,o.stopPropagation()},Gs(o)||(o.isDefaultPrevented=!0===o.defaultPrevented?$:B,o.isPropagationStopped=!0===o.cancelBubble?$:B,o.isImmediatePropagationStopped=B)),o},Xs="mce-data-",Js=/^(?:mouse|contextmenu)|click/,Qs=function(e,t,n,r){e.addEventListener?e.addEventListener(t,n,r||!1):e.attachEvent&&e.attachEvent("on"+t,n)},Zs=function(e,t,n,r){e.removeEventListener?e.removeEventListener(t,n,r||!1):e.detachEvent&&e.detachEvent("on"+t,n)},el=function(e){return T(e)&&Js.test(e.type)},tl=function(e,t){var n=Ys(e.type,e,document,t);if(el(e)&&x(e.pageX)&&!x(e.clientX)){var r=n.target.ownerDocument||document,i=r.documentElement,o=r.body,a=n;a.pageX=e.clientX+(i&&i.scrollLeft||o&&o.scrollLeft||0)-(i&&i.clientLeft||o&&o.clientLeft||0),a.pageY=e.clientY+(i&&i.scrollTop||o&&o.scrollTop||0)-(i&&i.clientTop||o&&o.clientTop||0)}return x(n.metaKey)&&(n.metaKey=!1),n},nl=function(e,t,n){var r=e.document,i={type:"ready"};if(n.domLoaded)t(i);else{var o=function(){return"complete"===r.readyState||"interactive"===r.readyState&&r.body},a=function(){Zs(e,"DOMContentLoaded",a),Zs(e,"load",a),n.domLoaded||(n.domLoaded=!0,t(i)),e=null};o()?a():Qs(e,"DOMContentLoaded",a),n.domLoaded||Qs(e,"load",a)}},rl=function(){function e(){this.domLoaded=!1,this.events={},this.count=1,this.expando=Xs+(+new Date).toString(32),this.hasMouseEnterLeave="onmouseenter"in document.documentElement,this.hasFocusIn="onfocusin"in document.documentElement,this.count=1}return e.prototype.bind=function(e,t,n,r){var i,o,a,s,l,u,c,d=this,f=window,h=function(e){d.executeHandlers(tl(e||f.event),i)};if(e&&3!==e.nodeType&&8!==e.nodeType){e[d.expando]?i=e[d.expando]:(i=d.count++,e[d.expando]=i,d.events[i]={}),r=r||e;var m=t.split(" ");a=m.length;while(a--)s=m[a],u=h,l=c=!1,"DOMContentLoaded"===s&&(s="ready"),d.domLoaded&&"ready"===s&&"complete"===e.readyState?n.call(r,tl({type:s})):(d.hasMouseEnterLeave||(l=d.mouseEnterLeave[s],l&&(u=function(e){var t=e.currentTarget,n=e.relatedTarget;if(n&&t.contains)n=t.contains(n);else while(n&&n!==t)n=n.parentNode;n||(e=tl(e||f.event),e.type="mouseout"===e.type?"mouseleave":"mouseenter",e.target=t,d.executeHandlers(e,i))})),d.hasFocusIn||"focusin"!==s&&"focusout"!==s||(c=!0,l="focusin"===s?"focus":"blur",u=function(e){e=tl(e||f.event),e.type="focus"===e.type?"focusin":"focusout",d.executeHandlers(e,i)}),o=d.events[i][s],o?"ready"===s&&d.domLoaded?n(tl({type:s})):o.push({func:n,scope:r}):(d.events[i][s]=o=[{func:n,scope:r}],o.fakeName=l,o.capture=c,o.nativeHandler=u,"ready"===s?nl(e,u,d):Qs(e,l||s,u,c)));return e=o=null,n}},e.prototype.unbind=function(e,t,n){var r,i,o,a,s;if(!e||3===e.nodeType||8===e.nodeType)return this;var l=e[this.expando];if(l){if(s=this.events[l],t){var u=t.split(" ");i=u.length;while(i--)if(a=u[i],r=s[a],r){if(n){o=r.length;while(o--)if(r[o].func===n){var c=r.nativeHandler,d=r.fakeName,f=r.capture;r=r.slice(0,o).concat(r.slice(o+1)),r.nativeHandler=c,r.fakeName=d,r.capture=f,s[a]=r}}n&&0!==r.length||(delete s[a],Zs(e,r.fakeName||a,r.nativeHandler,r.capture))}}else xe(s,(function(t,n){Zs(e,t.fakeName||n,t.nativeHandler,t.capture)})),s={};for(a in s)if(Re(s,a))return this;delete this.events[l];try{delete e[this.expando]}catch(h){e[this.expando]=null}}return this},e.prototype.fire=function(e,t,n){var r;if(!e||3===e.nodeType||8===e.nodeType)return this;var i=tl({type:t,target:e},n);do{r=e[this.expando],r&&this.executeHandlers(i,r),e=e.parentNode||e.ownerDocument||e.defaultView||e.parentWindow}while(e&&!i.isPropagationStopped());return this},e.prototype.clean=function(e){var t,n;if(!e||3===e.nodeType||8===e.nodeType)return this;if(e[this.expando]&&this.unbind(e),e.getElementsByTagName||(e=e.document),e&&e.getElementsByTagName){this.unbind(e),n=e.getElementsByTagName("*"),t=n.length;while(t--)e=n[t],e[this.expando]&&this.unbind(e)}return this},e.prototype.destroy=function(){this.events={}},e.prototype.cancel=function(e){return e&&(e.preventDefault(),e.stopImmediatePropagation()),!1},e.prototype.executeHandlers=function(e,t){var n=this.events[t],r=n&&n[e.type];if(r)for(var i=0,o=r.length;i<o;i++){var a=r[i];if(a&&!1===a.func.call(a.scope,e)&&e.preventDefault(),e.isImmediatePropagationStopped())return}},e.Event=new e,e}(),il="sizzle"+-new Date,ol=window.document,al=0,sl=0,ll=Vl(),ul=Vl(),cl=Vl(),dl=function(e,t){return e===t&&(ho=!0),0},fl="undefined",hl=1<<31,ml={}.hasOwnProperty,pl=[],gl=pl.pop,vl=pl.push,bl=pl.push,yl=pl.slice,wl=pl.indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(this[t]===e)return t;return-1},Sl="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",xl="[\\x20\\t\\r\\n\\f]",Cl="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",Tl="\\["+xl+"*("+Cl+")(?:"+xl+"*([*^$|!~]?=)"+xl+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+Cl+"))|)"+xl+"*\\]",Dl=":("+Cl+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+Tl+")*)|.*)\\)|)",kl=new RegExp("^"+xl+"+|((?:^|[^\\\\])(?:\\\\.)*)"+xl+"+$","g"),El=new RegExp("^"+xl+"*,"+xl+"*"),_l=new RegExp("^"+xl+"*([>+~]|"+xl+")"+xl+"*"),Al=new RegExp("="+xl+"*([^\\]'\"]*?)"+xl+"*\\]","g"),Ll=new RegExp(Dl),Ol=new RegExp("^"+Cl+"$"),Rl={ID:new RegExp("^#("+Cl+")"),CLASS:new RegExp("^\\.("+Cl+")"),TAG:new RegExp("^("+Cl+"|[*])"),ATTR:new RegExp("^"+Tl),PSEUDO:new RegExp("^"+Dl),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+xl+"*(even|odd|(([+-]|)(\\d*)n|)"+xl+"*(?:([+-]|)"+xl+"*(\\d+)|))"+xl+"*\\)|)","i"),bool:new RegExp("^(?:"+Sl+")$","i"),needsContext:new RegExp("^"+xl+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+xl+"*((?:-\\d)?\\d*)"+xl+"*\\)|)(?=[^-]|$)","i")},Il=/^(?:input|select|textarea|button)$/i,Pl=/^h\d$/i,Ml=/^[^{]+\{\s*\[native \w/,Nl=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Fl=/[+~]/,Bl=/'|\\/g,$l=new RegExp("\\\\([\\da-f]{1,6}"+xl+"?|("+xl+")|.)","ig"),zl=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)};try{bl.apply(pl=yl.call(ol.childNodes),ol.childNodes),pl[ol.childNodes.length].nodeType}catch(LU){bl={apply:pl.length?function(e,t){vl.apply(e,yl.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}var Ul=function(e,t,n,r){var i,o,a,s,l,u,c,d,f,h;if((t?t.ownerDocument||t:ol)!==po&&mo(t),t=t||po,n=n||[],!e||"string"!==typeof e)return n;if(1!==(s=t.nodeType)&&9!==s)return[];if(vo&&!r){if(i=Nl.exec(e))if(a=i[1]){if(9===s){if(o=t.getElementById(a),!o||!o.parentNode)return n;if(o.id===a)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(a))&&So(t,o)&&o.id===a)return n.push(o),n}else{if(i[2])return bl.apply(n,t.getElementsByTagName(e)),n;if((a=i[3])&&ro.getElementsByClassName)return bl.apply(n,t.getElementsByClassName(a)),n}if(ro.qsa&&(!bo||!bo.test(e))){if(d=c=il,f=t,h=9===s&&e,1===s&&"object"!==t.nodeName.toLowerCase()){u=so(e),(c=t.getAttribute("id"))?d=c.replace(Bl,"\\$&"):t.setAttribute("id",d),d="[id='"+d+"'] ",l=u.length;while(l--)u[l]=d+Xl(u[l]);f=Fl.test(e)&&Kl(t.parentNode)||t,h=u.join(",")}if(h)try{return bl.apply(n,f.querySelectorAll(h)),n}catch(m){}finally{c||t.removeAttribute("id")}}}return uo(e.replace(kl,"$1"),t,n,r)};function Vl(){var e=[];function t(n,r){return e.push(n+" ")>io.cacheLength&&delete t[e.shift()],t[n+" "]=r}return t}function Hl(e){return e[il]=!0,e}function jl(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||hl)-(~e.sourceIndex||hl);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function ql(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function Gl(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function Wl(e){return Hl((function(t){return t=+t,Hl((function(n,r){var i,o=e([],n.length,t),a=o.length;while(a--)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))}))}))}function Kl(e){return e&&typeof e.getElementsByTagName!==fl&&e}function Yl(){}function Xl(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function Jl(e,t,n){var r=t.dir,i=n&&"parentNode"===r,o=sl++;return t.first?function(t,n,o){while(t=t[r])if(1===t.nodeType||i)return e(t,n,o)}:function(t,n,a){var s,l,u=[al,o];if(a){while(t=t[r])if((1===t.nodeType||i)&&e(t,n,a))return!0}else while(t=t[r])if(1===t.nodeType||i){if(l=t[il]||(t[il]={}),(s=l[r])&&s[0]===al&&s[1]===o)return u[2]=s[2];if(l[r]=u,u[2]=e(t,n,a))return!0}}}function Ql(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function Zl(e,t,n){for(var r=0,i=t.length;r<i;r++)Ul(e,t[r],n);return n}function eu(e,t,n,r,i){for(var o,a=[],s=0,l=e.length,u=null!=t;s<l;s++)(o=e[s])&&(n&&!n(o,r,i)||(a.push(o),u&&t.push(s)));return a}function tu(e,t,n,r,i,o){return r&&!r[il]&&(r=tu(r)),i&&!i[il]&&(i=tu(i,o)),Hl((function(o,a,s,l){var u,c,d,f=[],h=[],m=a.length,p=o||Zl(t||"*",s.nodeType?[s]:s,[]),g=!e||!o&&t?p:eu(p,f,e,s,l),v=n?i||(o?e:m||r)?[]:a:g;if(n&&n(g,v,s,l),r){u=eu(v,h),r(u,[],s,l),c=u.length;while(c--)(d=u[c])&&(v[h[c]]=!(g[h[c]]=d))}if(o){if(i||e){if(i){u=[],c=v.length;while(c--)(d=v[c])&&u.push(g[c]=d);i(null,v=[],u,l)}c=v.length;while(c--)(d=v[c])&&(u=i?wl.call(o,d):f[c])>-1&&(o[u]=!(a[u]=d))}}else v=eu(v===a?v.splice(m,v.length):v),i?i(null,a,v,l):bl.apply(a,v)}))}function nu(e){for(var t,n,r,i=e.length,o=io.relative[e[0].type],a=o||io.relative[" "],s=o?1:0,l=Jl((function(e){return e===t}),a,!0),u=Jl((function(e){return wl.call(t,e)>-1}),a,!0),c=[function(e,n,r){var i=!o&&(r||n!==co)||((t=n).nodeType?l(e,n,r):u(e,n,r));return t=null,i}];s<i;s++)if(n=io.relative[e[s].type])c=[Jl(Ql(c),n)];else{if(n=io.filter[e[s].type].apply(null,e[s].matches),n[il]){for(r=++s;r<i;r++)if(io.relative[e[r].type])break;return tu(s>1&&Ql(c),s>1&&Xl(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(kl,"$1"),n,s<r&&nu(e.slice(s,r)),r<i&&nu(e=e.slice(r)),r<i&&Xl(e))}c.push(n)}return Ql(c)}function ru(e,t){var n=t.length>0,r=e.length>0,i=function(i,o,a,s,l){var u,c,d,f=0,h="0",m=i&&[],p=[],g=co,v=i||r&&io.find.TAG("*",l),b=al+=null==g?1:Math.random()||.1,y=v.length;for(l&&(co=o!==po&&o);h!==y&&null!=(u=v[h]);h++){if(r&&u){c=0;while(d=e[c++])if(d(u,o,a)){s.push(u);break}l&&(al=b)}n&&((u=!d&&u)&&f--,i&&m.push(u))}if(f+=h,n&&h!==f){c=0;while(d=t[c++])d(m,p,o,a);if(i){if(f>0)while(h--)m[h]||p[h]||(p[h]=gl.call(s));p=eu(p)}bl.apply(s,p),l&&!i&&p.length>0&&f+t.length>1&&Ul.uniqueSort(s)}return l&&(al=b,co=g),m};return n?Hl(i):i}ro=Ul.support={},ao=Ul.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},mo=Ul.setDocument=function(e){var t,n=e?e.ownerDocument||e:ol,r=n.defaultView;function i(e){try{return e.top}catch(t){}return null}return n!==po&&9===n.nodeType&&n.documentElement?(po=n,go=n.documentElement,vo=!ao(n),r&&r!==i(r)&&(r.addEventListener?r.addEventListener("unload",(function(){mo()}),!1):r.attachEvent&&r.attachEvent("onunload",(function(){mo()}))),ro.attributes=!0,ro.getElementsByTagName=!0,ro.getElementsByClassName=Ml.test(n.getElementsByClassName),ro.getById=!0,io.find.ID=function(e,t){if(typeof t.getElementById!==fl&&vo){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},io.filter.ID=function(e){var t=e.replace($l,zl);return function(e){return e.getAttribute("id")===t}},io.find.TAG=ro.getElementsByTagName?function(e,t){if(typeof t.getElementsByTagName!==fl)return t.getElementsByTagName(e)}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){while(n=o[i++])1===n.nodeType&&r.push(n);return r}return o},io.find.CLASS=ro.getElementsByClassName&&function(e,t){if(vo)return t.getElementsByClassName(e)},yo=[],bo=[],ro.disconnectedMatch=!0,bo=bo.length&&new RegExp(bo.join("|")),yo=yo.length&&new RegExp(yo.join("|")),t=Ml.test(go.compareDocumentPosition),So=t||Ml.test(go.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},dl=t?function(e,t){if(e===t)return ho=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r||(r=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&r||!ro.sortDetached&&t.compareDocumentPosition(e)===r?e===n||e.ownerDocument===ol&&So(ol,e)?-1:t===n||t.ownerDocument===ol&&So(ol,t)?1:fo?wl.call(fo,e)-wl.call(fo,t):0:4&r?-1:1)}:function(e,t){if(e===t)return ho=!0,0;var r,i=0,o=e.parentNode,a=t.parentNode,s=[e],l=[t];if(!o||!a)return e===n?-1:t===n?1:o?-1:a?1:fo?wl.call(fo,e)-wl.call(fo,t):0;if(o===a)return jl(e,t);r=e;while(r=r.parentNode)s.unshift(r);r=t;while(r=r.parentNode)l.unshift(r);while(s[i]===l[i])i++;return i?jl(s[i],l[i]):s[i]===ol?-1:l[i]===ol?1:0},n):po},Ul.matches=function(e,t){return Ul(e,null,null,t)},Ul.matchesSelector=function(e,t){if((e.ownerDocument||e)!==po&&mo(e),t=t.replace(Al,"='$1']"),ro.matchesSelector&&vo&&(!yo||!yo.test(t))&&(!bo||!bo.test(t)))try{var n=wo.call(e,t);if(n||ro.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(LU){}return Ul(t,po,null,[e]).length>0},Ul.contains=function(e,t){return(e.ownerDocument||e)!==po&&mo(e),So(e,t)},Ul.attr=function(e,t){(e.ownerDocument||e)!==po&&mo(e);var n=io.attrHandle[t.toLowerCase()],r=n&&ml.call(io.attrHandle,t.toLowerCase())?n(e,t,!vo):void 0;return void 0!==r?r:ro.attributes||!vo?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},Ul.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},Ul.uniqueSort=function(e){var t,n=[],r=0,i=0;if(ho=!ro.detectDuplicates,fo=!ro.sortStable&&e.slice(0),e.sort(dl),ho){while(t=e[i++])t===e[i]&&(r=n.push(i));while(r--)e.splice(n[r],1)}return fo=null,e},oo=Ul.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"===typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=oo(e)}else if(3===i||4===i)return e.nodeValue}else while(t=e[r++])n+=oo(t);return n},io=Ul.selectors={cacheLength:50,createPseudo:Hl,match:Rl,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace($l,zl),e[3]=(e[3]||e[4]||e[5]||"").replace($l,zl),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||Ul.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&Ul.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return Rl.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&Ll.test(n)&&(t=so(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace($l,zl).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=ll[e+" "];return t||(t=new RegExp("(^|"+xl+")"+e+"("+xl+"|$)"))&&ll(e,(function(e){return t.test("string"===typeof e.className&&e.className||typeof e.getAttribute!==fl&&e.getAttribute("class")||"")}))},ATTR:function(e,t,n){return function(r){var i=Ul.attr(r,e);return null==i?"!="===t:!t||(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,l){var u,c,d,f,h,m,p=o!==a?"nextSibling":"previousSibling",g=t.parentNode,v=s&&t.nodeName.toLowerCase(),b=!l&&!s;if(g){if(o){while(p){d=t;while(d=d[p])if(s?d.nodeName.toLowerCase()===v:1===d.nodeType)return!1;m=p="only"===e&&!m&&"nextSibling"}return!0}if(m=[a?g.firstChild:g.lastChild],a&&b){c=g[il]||(g[il]={}),u=c[e]||[],h=u[0]===al&&u[1],f=u[0]===al&&u[2],d=h&&g.childNodes[h];while(d=++h&&d&&d[p]||(f=h=0)||m.pop())if(1===d.nodeType&&++f&&d===t){c[e]=[al,h,f];break}}else if(b&&(u=(t[il]||(t[il]={}))[e])&&u[0]===al)f=u[1];else while(d=++h&&d&&d[p]||(f=h=0)||m.pop())if((s?d.nodeName.toLowerCase()===v:1===d.nodeType)&&++f&&(b&&((d[il]||(d[il]={}))[e]=[al,f]),d===t))break;return f-=i,f===r||f%r===0&&f/r>=0}}},PSEUDO:function(e,t){var n,r=io.pseudos[e]||io.setFilters[e.toLowerCase()]||Ul.error("unsupported pseudo: "+e);return r[il]?r(t):r.length>1?(n=[e,e,"",t],io.setFilters.hasOwnProperty(e.toLowerCase())?Hl((function(e,n){var i,o=r(e,t),a=o.length;while(a--)i=wl.call(e,o[a]),e[i]=!(n[i]=o[a])})):function(e){return r(e,0,n)}):r}},pseudos:{not:Hl((function(e){var t=[],n=[],r=lo(e.replace(kl,"$1"));return r[il]?Hl((function(e,t,n,i){var o,a=r(e,null,i,[]),s=e.length;while(s--)(o=a[s])&&(e[s]=!(t[s]=o))})):function(e,i,o){return t[0]=e,r(t,null,o,n),t[0]=null,!n.pop()}})),has:Hl((function(e){return function(t){return Ul(e,t).length>0}})),contains:Hl((function(e){return e=e.replace($l,zl),function(t){return(t.textContent||t.innerText||oo(t)).indexOf(e)>-1}})),lang:Hl((function(e){return Ol.test(e||"")||Ul.error("unsupported lang: "+e),e=e.replace($l,zl).toLowerCase(),function(t){var n;do{if(n=vo?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(e){var t=window.location&&window.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===go},focus:function(e){return e===po.activeElement&&(!po.hasFocus||po.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!io.pseudos.empty(e)},header:function(e){return Pl.test(e.nodeName)},input:function(e){return Il.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:Wl((function(){return[0]})),last:Wl((function(e,t){return[t-1]})),eq:Wl((function(e,t,n){return[n<0?n+t:n]})),even:Wl((function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e})),odd:Wl((function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e})),lt:Wl((function(e,t,n){for(var r=n<0?n+t:n;--r>=0;)e.push(r);return e})),gt:Wl((function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e}))}},io.pseudos.nth=io.pseudos.eq,Z(["radio","checkbox","file","password","image"],(function(e){io.pseudos[e]=ql(e)})),Z(["submit","reset"],(function(e){io.pseudos[e]=Gl(e)})),Yl.prototype=io.filters=io.pseudos,io.setFilters=new Yl,so=Ul.tokenize=function(e,t){var n,r,i,o,a,s,l,u=ul[e+" "];if(u)return t?0:u.slice(0);a=e,s=[],l=io.preFilter;while(a){for(o in n&&!(r=El.exec(a))||(r&&(a=a.slice(r[0].length)||a),s.push(i=[])),n=!1,(r=_l.exec(a))&&(n=r.shift(),i.push({value:n,type:r[0].replace(kl," ")}),a=a.slice(n.length)),io.filter)io.filter.hasOwnProperty(o)&&(!(r=Rl[o].exec(a))||l[o]&&!(r=l[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),a=a.slice(n.length)));if(!n)break}return t?a.length:a?Ul.error(e):ul(e,s).slice(0)},lo=Ul.compile=function(e,t){var n,r=[],i=[],o=cl[e+" "];if(!o){t||(t=so(e)),n=t.length;while(n--)o=nu(t[n]),o[il]?r.push(o):i.push(o);o=cl(e,ru(i,r)),o.selector=e}return o},uo=Ul.select=function(e,t,n,r){var i,o,a,s,l,u="function"===typeof e&&e,c=!r&&so(e=u.selector||e);if(n=n||[],1===c.length){if(o=c[0]=c[0].slice(0),o.length>2&&"ID"===(a=o[0]).type&&ro.getById&&9===t.nodeType&&vo&&io.relative[o[1].type]){if(t=(io.find.ID(a.matches[0].replace($l,zl),t)||[])[0],!t)return n;u&&(t=t.parentNode),e=e.slice(o.shift().value.length)}i=Rl.needsContext.test(e)?0:o.length;while(i--){if(a=o[i],io.relative[s=a.type])break;if((l=io.find[s])&&(r=l(a.matches[0].replace($l,zl),Fl.test(o[0].type)&&Kl(t.parentNode)||t))){if(o.splice(i,1),e=r.length&&Xl(o),!e)return bl.apply(n,r),n;break}}}return(u||lo(e,c))(r,t,!vo,n,Fl.test(e)&&Kl(t.parentNode)||t),n},ro.sortStable=il.split("").sort(dl).join("")===il,ro.detectDuplicates=!!ho,mo(),ro.sortDetached=!0;var iu=document,ou=Array.prototype.push,au=Array.prototype.slice,su=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,lu=rl.Event,uu=mn.makeMap("children,contents,next,prev"),cu=function(e){return"undefined"!==typeof e},du=function(e){return"string"===typeof e},fu=function(e){return e&&e===e.window},hu=function(e,t){t=t||iu;var n,r=t.createElement("div"),i=t.createDocumentFragment();r.innerHTML=e;while(n=r.firstChild)i.appendChild(n);return i},mu=function(e,t,n,r){var i;if(du(t))t=hu(t,Au(e[0]));else if(t.length&&!t.nodeType){if(t=Iu.makeArray(t),r)for(i=t.length-1;i>=0;i--)mu(e,t[i],n,r);else for(i=0;i<t.length;i++)mu(e,t[i],n,r);return e}if(t.nodeType){i=e.length;while(i--)n.call(e[i],t)}return e},pu=function(e,t){return e&&t&&-1!==(" "+e.className+" ").indexOf(" "+t+" ")},gu=function(e,t,n){var r,i;return t=Iu(t)[0],e.each((function(){var e=this;n&&r===e.parentNode||(r=e.parentNode,i=t.cloneNode(!1),e.parentNode.insertBefore(i,e)),i.appendChild(e)})),e},vu=mn.makeMap("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom"," "),bu=mn.makeMap("checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected"," "),yu={for:"htmlFor",class:"className",readonly:"readOnly"},wu={float:"cssFloat"},Su={},xu={},Cu=function(e,t){return new Iu.fn.init(e,t)},Tu=function(e,t){var n;if(t.indexOf)return t.indexOf(e);n=t.length;while(n--)if(t[n]===e)return n;return-1},Du=/^\s*|\s*$/g,ku=function(e){return null===e||void 0===e?"":(""+e).replace(Du,"")},Eu=function(e,t){var n,r,i,o;if(e)if(n=e.length,void 0===n){for(r in e)if(e.hasOwnProperty(r)&&(o=e[r],!1===t.call(o,r,o)))break}else for(i=0;i<n;i++)if(o=e[i],!1===t.call(o,i,o))break;return e},_u=function(e,t){var n=[];return Eu(e,(function(e,r){t(r,e)&&n.push(r)})),n},Au=function(e){return e?9===e.nodeType?e:e.ownerDocument:iu};Cu.fn=Cu.prototype={constructor:Cu,selector:"",context:null,length:0,init:function(e,t){var n,r,i=this;if(!e)return i;if(e.nodeType)return i.context=i[0]=e,i.length=1,i;if(t&&t.nodeType)i.context=t;else{if(t)return Iu(e).attr(t);i.context=t=document}if(du(e)){if(i.selector=e,n="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:su.exec(e),!n)return Iu(t).find(e);if(n[1]){r=hu(e,Au(t)).firstChild;while(r)ou.call(i,r),r=r.nextSibling}else{if(r=Au(t).getElementById(n[2]),!r)return i;if(r.id!==n[2])return i.find(e);i.length=1,i[0]=r}}else this.add(e,!1);return i},toArray:function(){return mn.toArray(this)},add:function(e,t){var n,r,i=this;if(du(e))return i.add(Iu(e));if(!1!==t)for(n=Iu.unique(i.toArray().concat(Iu.makeArray(e))),i.length=n.length,r=0;r<n.length;r++)i[r]=n[r];else ou.apply(i,Iu.makeArray(e));return i},attr:function(e,t){var n,r=this;if("object"===typeof e)Eu(e,(function(e,t){r.attr(e,t)}));else{if(!cu(t)){if(r[0]&&1===r[0].nodeType){if(n=Su[e],n&&n.get)return n.get(r[0],e);if(bu[e])return r.prop(e)?e:void 0;t=r[0].getAttribute(e,2),null===t&&(t=void 0)}return t}this.each((function(){var n;if(1===this.nodeType){if(n=Su[e],n&&n.set)return void n.set(this,t);null===t?this.removeAttribute(e,2):this.setAttribute(e,t,2)}}))}return r},removeAttr:function(e){return this.attr(e,null)},prop:function(e,t){var n=this;if(e=yu[e]||e,"object"===typeof e)Eu(e,(function(e,t){n.prop(e,t)}));else{if(!cu(t))return n[0]&&n[0].nodeType&&e in n[0]?n[0][e]:t;this.each((function(){1===this.nodeType&&(this[e]=t)}))}return n},css:function(e,t){var n,r,i=this,o=function(e){return e.replace(/-(\D)/g,(function(e,t){return t.toUpperCase()}))},a=function(e){return e.replace(/[A-Z]/g,(function(e){return"-"+e}))};if("object"===typeof e)Eu(e,(function(e,t){i.css(e,t)}));else if(cu(t))e=o(e),"number"!==typeof t||vu[e]||(t=t.toString()+"px"),i.each((function(){var n=this.style;if(r=xu[e],r&&r.set)r.set(this,t);else{try{this.style[wu[e]||e]=t}catch(i){}null!==t&&""!==t||(n.removeProperty?n.removeProperty(a(e)):n.removeAttribute(e))}}));else{if(n=i[0],r=xu[e],r&&r.get)return r.get(n);if(!n.ownerDocument.defaultView)return n.currentStyle?n.currentStyle[o(e)]:"";try{return n.ownerDocument.defaultView.getComputedStyle(n,null).getPropertyValue(a(e))}catch(s){return}}return i},remove:function(){var e,t=this,n=this.length;while(n--)e=t[n],lu.clean(e),e.parentNode&&e.parentNode.removeChild(e);return this},empty:function(){var e,t=this,n=this.length;while(n--){e=t[n];while(e.firstChild)e.removeChild(e.firstChild)}return this},html:function(e){var t,n=this;if(cu(e)){t=n.length;try{while(t--)n[t].innerHTML=e}catch(r){Iu(n[t]).empty().append(e)}return n}return n[0]?n[0].innerHTML:""},text:function(e){var t,n=this;if(cu(e)){t=n.length;while(t--)"innerText"in n[t]?n[t].innerText=e:n[0].textContent=e;return n}return n[0]?n[0].innerText||n[0].textContent:""},append:function(){return mu(this,arguments,(function(e){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.appendChild(e)}))},prepend:function(){return mu(this,arguments,(function(e){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.insertBefore(e,this.firstChild)}),!0)},before:function(){var e=this;return e[0]&&e[0].parentNode?mu(e,arguments,(function(e){this.parentNode.insertBefore(e,this)})):e},after:function(){var e=this;return e[0]&&e[0].parentNode?mu(e,arguments,(function(e){this.parentNode.insertBefore(e,this.nextSibling)}),!0):e},appendTo:function(e){return Iu(e).append(this),this},prependTo:function(e){return Iu(e).prepend(this),this},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){return gu(this,e)},wrapAll:function(e){return gu(this,e,!0)},wrapInner:function(e){return this.each((function(){Iu(this).contents().wrapAll(e)})),this},unwrap:function(){return this.parent().each((function(){Iu(this).replaceWith(this.childNodes)}))},clone:function(){var e=[];return this.each((function(){e.push(this.cloneNode(!0))})),Iu(e)},addClass:function(e){return this.toggleClass(e,!0)},removeClass:function(e){return this.toggleClass(e,!1)},toggleClass:function(e,t){var n=this;return"string"!==typeof e||(-1!==e.indexOf(" ")?Eu(e.split(" "),(function(){n.toggleClass(this,t)})):n.each((function(n,r){var i=pu(r,e);if(i!==t){var o=r.className;i?r.className=ku((" "+o+" ").replace(" "+e+" "," ")):r.className+=o?" "+e:e}}))),n},hasClass:function(e){return pu(this[0],e)},each:function(e){return Eu(this,e)},on:function(e,t){return this.each((function(){lu.bind(this,e,t)}))},off:function(e,t){return this.each((function(){lu.unbind(this,e,t)}))},trigger:function(e){return this.each((function(){"object"===typeof e?lu.fire(this,e.type,e):lu.fire(this,e)}))},show:function(){return this.css("display","")},hide:function(){return this.css("display","none")},slice:function(){return Iu(au.apply(this,arguments))},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},find:function(e){var t,n,r=[];for(t=0,n=this.length;t<n;t++)Iu.find(e,this[t],r);return Iu(r)},filter:function(e){return Iu("function"===typeof e?_u(this.toArray(),(function(t,n){return e(n,t)})):Iu.filter(e,this.toArray()))},closest:function(e){var t=[];return e instanceof Iu&&(e=e[0]),this.each((function(n,r){while(r){if("string"===typeof e&&Iu(r).is(e)){t.push(r);break}if(r===e){t.push(r);break}r=r.parentNode}})),Iu(t)},offset:function(e){var t,n,r,i,o=0,a=0;return e?this.css(e):(t=this[0],t&&(n=t.ownerDocument,r=n.documentElement,t.getBoundingClientRect&&(i=t.getBoundingClientRect(),o=i.left+(r.scrollLeft||n.body.scrollLeft)-r.clientLeft,a=i.top+(r.scrollTop||n.body.scrollTop)-r.clientTop)),{left:o,top:a})},push:ou,sort:Array.prototype.sort,splice:Array.prototype.splice},mn.extend(Cu,{extend:mn.extend,makeArray:function(e){return fu(e)||e.nodeType?[e]:mn.toArray(e)},inArray:Tu,isArray:mn.isArray,each:Eu,trim:ku,grep:_u,find:Ul,expr:Ul.selectors,unique:Ul.uniqueSort,text:Ul.getText,contains:Ul.contains,filter:function(e,t,n){var r=t.length;n&&(e=":not("+e+")");while(r--)1!==t[r].nodeType&&t.splice(r,1);return t=1===t.length?Iu.find.matchesSelector(t[0],e)?[t[0]]:[]:Iu.find.matches(e,t),t}});var Lu=function(e,t,n){var r=[],i=e[t];"string"!==typeof n&&n instanceof Iu&&(n=n[0]);while(i&&9!==i.nodeType){if(void 0!==n){if(i===n)break;if("string"===typeof n&&Iu(i).is(n))break}1===i.nodeType&&r.push(i),i=i[t]}return r},Ou=function(e,t,n,r){var i=[];for(r instanceof Iu&&(r=r[0]);e;e=e[t])if(!n||e.nodeType===n){if(void 0!==r){if(e===r)break;if("string"===typeof r&&Iu(e).is(r))break}i.push(e)}return i},Ru=function(e,t,n){for(e=e[t];e;e=e[t])if(e.nodeType===n)return e;return null};Eu({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return Lu(e,"parentNode")},next:function(e){return Ru(e,"nextSibling",1)},prev:function(e){return Ru(e,"previousSibling",1)},children:function(e){return Ou(e.firstChild,"nextSibling",1)},contents:function(e){return mn.toArray(("iframe"===e.nodeName?e.contentDocument||e.contentWindow.document:e).childNodes)}},(function(e,t){Cu.fn[e]=function(n){var r=this,i=[];r.each((function(){var e=t.call(i,this,n,i);e&&(Iu.isArray(e)?i.push.apply(i,e):i.push(e))})),this.length>1&&(uu[e]||(i=Iu.unique(i)),0===e.indexOf("parents")&&(i=i.reverse()));var o=Iu(i);return n?o.filter(n):o}})),Eu({parentsUntil:function(e,t){return Lu(e,"parentNode",t)},nextUntil:function(e,t){return Ou(e,"nextSibling",1,t).slice(1)},prevUntil:function(e,t){return Ou(e,"previousSibling",1,t).slice(1)}},(function(e,t){Cu.fn[e]=function(n,r){var i=this,o=[];i.each((function(){var e=t.call(o,this,n,o);e&&(Iu.isArray(e)?o.push.apply(o,e):o.push(e))})),this.length>1&&(o=Iu.unique(o),0!==e.indexOf("parents")&&"prevUntil"!==e||(o=o.reverse()));var a=Iu(o);return r?a.filter(r):a}})),Cu.fn.is=function(e){return!!e&&this.filter(e).length>0},Cu.fn.init.prototype=Cu.fn,Cu.overrideDefaults=function(e){var t,n=function(r,i){return t=t||e(),0===arguments.length&&(r=t.element),i||(i=t.context),new n.fn.init(r,i)};return Iu.extend(n,this),n},Cu.attrHooks=Su,Cu.cssHooks=xu;var Iu=Cu,Pu=mn.each,Mu=mn.grep,Nu=en.ie,Fu=/^([a-z0-9],?)+$/i,Bu=function(e,t,n){var r=t.keep_values,i={set:function(e,r,i){t.url_converter&&null!==r&&(r=t.url_converter.call(t.url_converter_scope||n(),r,i,e[0])),e.attr("data-mce-"+i,r).attr(i,r)},get:function(e,t){return e.attr("data-mce-"+t)||e.attr(t)}},o={style:{set:function(t,n){null===n||"object"!==typeof n?(r&&t.attr("data-mce-style",n),null!==n&&"string"===typeof n?(t.removeAttr("style"),t.css(e.parse(n))):t.attr("style",n)):t.css(n)},get:function(t){var n=t.attr("data-mce-style")||t.attr("style");return n=e.serialize(e.parse(n),t[0].nodeName),n}}};return r&&(o.href=o.src=i),o},$u=function(e,t){var n=t.attr("style"),r=e.serialize(e.parse(n),t[0].nodeName);r||(r=null),t.attr("data-mce-style",r)},zu=function(e,t){var n,r,i=0;if(e)for(n=e.nodeType,e=e.previousSibling;e;e=e.previousSibling)r=e.nodeType,(!t||3!==r||r!==n&&e.nodeValue.length)&&(i++,n=r);return i},Uu=function(e,t){void 0===t&&(t={});var n={},r=window,i={},o=0,a=!0,s=!0,l=$o.forElement(wn.fromDom(e),{contentCssCors:t.contentCssCors,referrerPolicy:t.referrerPolicy}),u=[],c=t.schema?t.schema:Us({}),d=Hs({url_converter:t.url_converter,url_converter_scope:t.url_converter_scope},t.schema),f=t.ownEvents?new rl:rl.Event,h=c.getBlockElements(),m=Iu.overrideDefaults((function(){return{context:e,element:Oe.getRoot()}})),p=function(e){if("string"===typeof e)return!!h[e];if(e){var t=e.nodeType;if(t)return!(1!==t||!h[e.nodeName])}return!1},g=function(t){return t&&e&&v(t)?e.getElementById(t):t},b=function(e){return m("string"===typeof e?g(e):e)},y=function(e,t,n){var r,i,o=b(e);return o.length&&(r=Re[t],i=r&&r.get?r.get(o,t):o.attr(t)),"undefined"===typeof i&&(i=n||""),i},w=function(e){var t=g(e);return t?t.attributes:[]},S=function(e,n,r){""===r&&(r=null);var i=b(e),o=i.attr(n);if(i.length){var a=Re[n];a&&a.set?a.set(i,r,n):i.attr(n,r),o!==r&&t.onSetAttrib&&t.onSetAttrib({attrElm:i,attrName:n,attrValue:r})}},x=function(t,n){if(!Nu||1!==t.nodeType||n)return t.cloneNode(n);var r=e.createElement(t.nodeName);return Pu(w(t),(function(e){S(r,e.nodeName,y(t,e.nodeName))})),r},T=function(){return t.root_element||e.body},D=function(e){var t=zr(e);return{x:t.x,y:t.y,w:t.width,h:t.height}},k=function(t,n){return Pi(e.body,g(t),n)},_=function(e,n,r){var i=v(n)?b(e).css(n,r):b(e).css(n);t.update_styles&&$u(d,i)},A=function(e,n){var r=b(e).css(n);t.update_styles&&$u(d,r)},O=function(e,t,n){var r=b(e);return n?r.css(t):(t=t.replace(/-(\D)/g,(function(e,t){return t.toUpperCase()})),"float"===t&&(t=en.browser.isIE()?"styleFloat":"cssFloat"),r[0]&&r[0].style?r[0].style[t]:void 0)},R=function(e){var t,n;return e=g(e),t=O(e,"width"),n=O(e,"height"),-1===t.indexOf("px")&&(t=0),-1===n.indexOf("px")&&(n=0),{w:parseInt(t,10)||e.offsetWidth||e.clientWidth,h:parseInt(n,10)||e.offsetHeight||e.clientHeight}},I=function(e){e=g(e);var t=k(e),n=R(e);return{x:t.x,y:t.y,w:n.w,h:n.h}},P=function(e,t){var n;if(!e)return!1;if(!Array.isArray(e)){if("*"===t)return 1===e.nodeType;if(Fu.test(t)){var r=t.toLowerCase().split(/,/),i=e.nodeName.toLowerCase();for(n=r.length-1;n>=0;n--)if(r[n]===i)return!0;return!1}if(e.nodeType&&1!==e.nodeType)return!1}var o=Array.isArray(e)?e:[e];return Ul(t,o[0].ownerDocument||o[0],null,o).length>0},M=function(e,t,n,r){var i,o=[],a=g(e);r=void 0===r,n=n||("BODY"!==T().nodeName?T().parentNode:null),mn.is(t,"string")&&(i=t,t="*"===t?function(e){return 1===e.nodeType}:function(e){return P(e,i)});while(a){if(a===n||C(a.nodeType)||ti(a)||ni(a))break;if(!t||"function"===typeof t&&t(a)){if(!r)return[a];o.push(a)}a=a.parentNode}return r?o:null},N=function(e,t,n){var r=M(e,t,n,!1);return r&&r.length>0?r[0]:null},F=function(e,t,n){var r=t;if(e)for("string"===typeof t&&(r=function(e){return P(e,t)}),e=e[n];e;e=e[n])if("function"===typeof r&&r(e))return e;return null},B=function(e,t){return F(e,t,"nextSibling")},$=function(e,t){return F(e,t,"previousSibling")},z=function(n,r){return Ul(n,g(r)||t.root_element||e,[])},U=function(e,t,n){var r,i="string"===typeof e?g(e):e;if(!i)return!1;if(mn.isArray(i)&&(i.length||0===i.length))return r=[],Pu(i,(function(e,i){e&&r.push(t.call(n,"string"===typeof e?g(e):e,i))})),r;var o=n||this;return t.call(o,i)},V=function(e,t){b(e).each((function(e,n){Pu(t,(function(e,t){S(n,t,e)}))}))},H=function(e,t){var n=b(e);Nu?n.each((function(e,n){if(!1!==n.canHaveHTML){while(n.firstChild)n.removeChild(n.firstChild);try{n.innerHTML="<br>"+t,n.removeChild(n.firstChild)}catch(r){Iu("<div></div>").html("<br>"+t).contents().slice(1).appendTo(n)}return t}})):n.html(t)},j=function(t,n,r,i,o){return U(t,(function(t){var a="string"===typeof n?e.createElement(n):n;return V(a,r),i&&("string"!==typeof i&&i.nodeType?a.appendChild(i):"string"===typeof i&&H(a,i)),o?a:t.appendChild(a)}))},q=function(t,n,r){return j(e.createElement(t),t,n,r,!0)},G=_s.decode,W=_s.encodeAllRaw,K=function(e,t,n){var r,i="";for(r in i+="<"+e,t)Ie(t,r)&&(i+=" "+r+'="'+W(t[r])+'"');return"undefined"!==typeof n?i+">"+n+"</"+e+">":i+" />"},Y=function(t){var n,r=e.createElement("div"),i=e.createDocumentFragment();i.appendChild(r),t&&(r.innerHTML=t);while(n=r.firstChild)i.appendChild(n);return i.removeChild(r),i},X=function(e,t){var n=b(e);return t?n.each((function(){var e;while(e=this.firstChild)3===e.nodeType&&0===e.data.length?this.removeChild(e):this.parentNode.insertBefore(e,this)})).remove():n.remove(),n.length>1?n.toArray():n[0]},J=function(e){return U(e,(function(e){var t,n=e.attributes;for(t=n.length-1;t>=0;t--)e.removeAttributeNode(n.item(t))}))},Q=function(e){return d.parse(e)},ee=function(e,t){return d.serialize(e,t)},te=function(t){var r,i;if(Oe!==Uu.DOM&&e===document){if(n[t])return;n[t]=!0}i=e.getElementById("mceDefaultStyles"),i||(i=e.createElement("style"),i.id="mceDefaultStyles",i.type="text/css",r=e.getElementsByTagName("head")[0],r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i)),i.styleSheet?i.styleSheet.cssText+=t:i.appendChild(e.createTextNode(t))},ne=function(e){e||(e=""),Z(e.split(","),(function(e){i[e]=!0,l.load(e,E)}))},re=function(e,t,n){b(e).toggleClass(t,n).each((function(){""===this.className&&Iu(this).attr("class",null)}))},ie=function(e,t){b(e).addClass(t)},oe=function(e,t){re(e,t,!1)},ae=function(e,t){return b(e).hasClass(t)},se=function(e){b(e).show()},le=function(e){b(e).hide()},ue=function(e){return"none"===b(e).css("display")},ce=function(e){return(e||"mce_")+o++},de=function(e){var t="string"===typeof e?g(e):e;return Hr(t)?t.outerHTML:Iu("<div></div>").append(Iu(t).clone()).html()},fe=function(e,t){b(e).each((function(){try{if("outerHTML"in this)return void(this.outerHTML=t)}catch(e){}X(Iu(this).html(t),!0)}))},he=function(e,t){var n=g(t);return U(e,(function(e){var t=n.parentNode,r=n.nextSibling;return r?t.insertBefore(e,r):t.appendChild(e),e}))},me=function(e,t,n){return U(t,(function(t){return mn.is(t,"array")&&(e=e.cloneNode(!0)),n&&Pu(Mu(t.childNodes),(function(t){e.appendChild(t)})),t.parentNode.replaceChild(e,t)}))},pe=function(e,t){var n;return e.nodeName!==t.toUpperCase()&&(n=q(t),Pu(w(e),(function(t){S(n,t.nodeName,y(e,t.nodeName))})),me(n,e,!0)),n||e},ge=function(e,t){var n,r=e;while(r){n=t;while(n&&r!==n)n=n.parentNode;if(r===n)break;r=r.parentNode}return!r&&e.ownerDocument?e.ownerDocument.documentElement:r},ve=function(e){return d.toHex(mn.trim(e))},be=function(e){if(Hr(e)){var t="a"===e.nodeName.toLowerCase()&&!y(e,"href")&&y(e,"id");if(y(e,"name")||y(e,"data-mce-bookmark")||t)return!0}return!1},ye=function(e,t){var n,r,i=0;if(be(e))return!1;if(e=e.firstChild,e){var o=new zo(e,e.parentNode),a=c?c.getWhiteSpaceElements():{};t=t||(c?c.getNonEmptyElements():null);do{if(n=e.nodeType,Hr(e)){var s=e.getAttribute("data-mce-bogus");if(s){e=o.next("all"===s);continue}if(r=e.nodeName.toLowerCase(),t&&t[r]){if("br"===r){i++,e=o.next();continue}return!1}if(be(e))return!1}if(8===n)return!1;if(3===n&&!Wa(e.nodeValue))return!1;if(3===n&&e.parentNode&&a[e.parentNode.nodeName]&&Wa(e.nodeValue))return!1;e=o.next()}while(e)}return i<=1},we=function(){return e.createRange()},Se=function(e,t,n){var r,i,o,a=we();if(e&&t)return a.setStart(e.parentNode,zu(e)),a.setEnd(t.parentNode,zu(t)),r=a.extractContents(),a=we(),a.setStart(t.parentNode,zu(t)+1),a.setEnd(e.parentNode,zu(e)+1),i=a.extractContents(),o=e.parentNode,o.insertBefore(cs(Oe,r),e),n?o.insertBefore(n,e):o.insertBefore(t,e),o.insertBefore(cs(Oe,i),e),X(e),n||t},Ce=function(n,i,o,a){if(mn.isArray(n)){var s=n.length,l=[];while(s--)l[s]=Ce(n[s],i,o,a);return l}!t.collect||n!==e&&n!==r||u.push([n,i,o,a]);var c=f.bind(n,i,o,a||Oe);return c},Te=function(t,n,i){if(mn.isArray(t)){var o=t.length,a=[];while(o--)a[o]=Te(t[o],n,i);return a}if(u.length>0&&(t===e||t===r)){o=u.length;while(o--){var s=u[o];t!==s[0]||n&&n!==s[1]||i&&i!==s[2]||f.unbind(s[0],s[1],s[2])}}return f.unbind(t,n,i)},De=function(e,t,n){return f.fire(e,t,n)},ke=function(e){if(e&&Hr(e)){var t=e.getAttribute("data-mce-contenteditable");return t&&"inherit"!==t?t:"inherit"!==e.contentEditable?e.contentEditable:null}return null},Ee=function(e){for(var t=T(),n=null;e&&e!==t;e=e.parentNode)if(n=ke(e),null!==n)break;return n},_e=function(){if(u.length>0){var e=u.length;while(e--){var t=u[e];f.unbind(t[0],t[1],t[2])}}xe(i,(function(e,t){l.unload(t),delete i[t]})),Ul.setDocument&&Ul.setDocument()},Ae=function(e,t){if(Nu){while(e){if(t===e)return!0;e=e.parentNode}return!1}return e===t||t.contains(e)},Le=function(e){return"startContainer: "+e.startContainer.nodeName+", startOffset: "+e.startOffset+", endContainer: "+e.endContainer.nodeName+", endOffset: "+e.endOffset},Oe={doc:e,settings:t,win:r,files:i,stdMode:a,boxModel:s,styleSheetLoader:l,boundEvents:u,styles:d,schema:c,events:f,isBlock:p,$:m,$$:b,root:null,clone:x,getRoot:T,getViewPort:D,getRect:I,getSize:R,getParent:N,getParents:M,get:g,getNext:B,getPrev:$,select:z,is:P,add:j,create:q,createHTML:K,createFragment:Y,remove:X,setStyle:_,getStyle:O,setStyles:A,removeAllAttribs:J,setAttrib:S,setAttribs:V,getAttrib:y,getPos:k,parseStyle:Q,serializeStyle:ee,addStyle:te,loadCSS:ne,addClass:ie,removeClass:oe,hasClass:ae,toggleClass:re,show:se,hide:le,isHidden:ue,uniqueId:ce,setHTML:H,getOuterHTML:de,setOuterHTML:fe,decode:G,encode:W,insertAfter:he,replace:me,rename:pe,findCommonAncestor:ge,toHex:ve,run:U,getAttribs:w,isEmpty:ye,createRng:we,nodeIndex:zu,split:Se,bind:Ce,unbind:Te,fire:De,getContentEditable:ke,getContentEditableParent:Ee,destroy:_e,isChildOf:Ae,dumpRng:Le},Re=Bu(d,t,L(Oe));return Oe};Uu.DOM=Uu(document),Uu.nodeIndex=zu;var Vu=Uu.DOM,Hu=mn.each,ju=mn.grep,qu=0,Gu=1,Wu=2,Ku=3,Yu=function(){function e(e){void 0===e&&(e={}),this.states={},this.queue=[],this.scriptLoadedCallbacks={},this.queueLoadedCallbacks=[],this.loading=0,this.settings=e}return e.prototype._setReferrerPolicy=function(e){this.settings.referrerPolicy=e},e.prototype.loadScript=function(e,t,n){var r,i=Vu,o=function(){i.remove(l),r&&(r.onerror=r.onload=r=null)},a=function(){o(),t()},s=function(){o(),D(n)?n():"undefined"!==typeof console&&console.log&&console.log("Failed to load script: "+e)},l=i.uniqueId();r=document.createElement("script"),r.id=l,r.type="text/javascript",r.src=mn._addCacheSuffix(e),this.settings.referrerPolicy&&i.setAttrib(r,"referrerpolicy",this.settings.referrerPolicy),r.onload=a,r.onerror=s,(document.getElementsByTagName("head")[0]||document.body).appendChild(r)},e.prototype.isDone=function(e){return this.states[e]===Wu},e.prototype.markDone=function(e){this.states[e]=Wu},e.prototype.add=function(e,t,n,r){var i=this.states[e];this.queue.push(e),void 0===i&&(this.states[e]=qu),t&&(this.scriptLoadedCallbacks[e]||(this.scriptLoadedCallbacks[e]=[]),this.scriptLoadedCallbacks[e].push({success:t,failure:r,scope:n||this}))},e.prototype.load=function(e,t,n,r){return this.add(e,t,n,r)},e.prototype.remove=function(e){delete this.states[e],delete this.scriptLoadedCallbacks[e]},e.prototype.loadQueue=function(e,t,n){this.loadScripts(this.queue,e,t,n)},e.prototype.loadScripts=function(e,t,n,r){var i=this,o=[],a=function(e,t){Hu(i.scriptLoadedCallbacks[t],(function(t){D(t[e])&&t[e].call(t.scope)})),i.scriptLoadedCallbacks[t]=void 0};i.queueLoadedCallbacks.push({success:t,failure:r,scope:n||this});var s=function(){var t=ju(e);if(e.length=0,Hu(t,(function(e){i.states[e]!==Wu?i.states[e]!==Ku?i.states[e]!==Gu&&(i.states[e]=Gu,i.loading++,i.loadScript(e,(function(){i.states[e]=Wu,i.loading--,a("success",e),s()}),(function(){i.states[e]=Ku,i.loading--,o.push(e),a("failure",e),s()}))):a("failure",e):a("success",e)})),!i.loading){var n=i.queueLoadedCallbacks.slice(0);i.queueLoadedCallbacks.length=0,Hu(n,(function(e){0===o.length?D(e.success)&&e.success.call(e.scope):D(e.failure)&&e.failure.call(e.scope,o)}))}};s()},e.ScriptLoader=new e,e}(),Xu=function(e){var t=e,n=function(){return t},r=function(e){t=e};return{get:n,set:r}},Ju=function(e){return b(e)&&Re(e,"raw")},Qu=function(e){return y(e)&&e.length>1},Zu={},ec=Xu("en"),tc=function(){return Oe(Zu,ec.get())},nc=function(){return Ce(Zu,(function(e){return je({},e)}))},rc=function(e){e&&ec.set(e)},ic=function(){return ec.get()},oc=function(e,t){var n=Zu[e];n||(Zu[e]=n={}),xe(t,(function(e,t){n[t.toLowerCase()]=e}))},ac=function(e){var t=tc().getOr({}),n=function(e){return D(e)?Object.prototype.toString.call(e):r(e)?"":""+e},r=function(e){return""===e||null===e||void 0===e},i=function(e){var r=n(e);return Oe(t,r.toLowerCase()).map(n).getOr(r)},o=function(e){return e.replace(/{context:\w+}$/,"")};if(r(e))return"";if(Ju(e))return n(e.raw);if(Qu(e)){var a=e.slice(1),s=i(e[0]).replace(/\{([0-9]+)\}/g,(function(e,t){return Re(a,t)?n(a[t]):e}));return o(s)}return o(i(e))},sc=function(){return tc().bind((function(e){return Oe(e,"_dir")})).exists((function(e){return"rtl"===e}))},lc=function(e){return Re(Zu,e)},uc={getData:nc,setCode:rc,getCode:ic,add:oc,translate:ac,isRtl:sc,hasCode:lc},cc=function(){var e=[],t={},n={},r=[],i=function(e,t){var n=ne(r,(function(n){return n.name===e&&n.state===t}));Z(n,(function(e){return e.callback()}))},o=function(e){if(n[e])return n[e].instance},a=function(e){var t;return n[e]&&(t=n[e].dependencies),t||[]},s=function(e,n){!1!==cc.languageLoad&&m(e,(function(){var r=uc.getCode(),i=","+(n||"")+",";!r||n&&-1===i.indexOf(","+r+",")||Yu.ScriptLoader.add(t[e]+"/langs/"+r+".js")}),"loaded")},l=function(t,r,o){var a=r;return e.push(a),n[t]={instance:a,dependencies:o},i(t,"added"),a},u=function(e){delete t[e],delete n[e]},c=function(e,t){return"object"===typeof t?t:"string"===typeof e?{prefix:"",resource:t,suffix:""}:{prefix:e.prefix,resource:t,suffix:e.suffix}},d=function(e,n){var r=t[e];Z(n,(function(e){Yu.ScriptLoader.add(r+"/"+e)}))},f=function(e,t,n,r){var i=a(e);Z(i,(function(e){var n=c(t,e);h(n.resource,n,void 0,void 0)})),n&&(r?n.call(r):n.call(Yu))},h=function(e,r,o,a,s){if(!t[e]){var l="string"===typeof r?r:r.prefix+r.resource+r.suffix;0!==l.indexOf("/")&&-1===l.indexOf("://")&&(l=cc.baseURL+"/"+l),t[e]=l.substring(0,l.lastIndexOf("/"));var u=function(){i(e,"loaded"),f(e,r,o,a)};n[e]?u():Yu.ScriptLoader.add(l,u,a,s)}},m=function(e,i,o){void 0===o&&(o="added"),Re(n,e)&&"added"===o||Re(t,e)&&"loaded"===o?i():r.push({name:e,state:o,callback:i})};return{items:e,urls:t,lookup:n,_listeners:r,get:o,dependencies:a,requireLangPack:s,add:l,remove:u,createUrl:c,addComponents:d,load:h,waitFor:m}};cc.languageLoad=!0,cc.baseURL="",cc.PluginManager=cc(),cc.ThemeManager=cc();var dc=function(e){var t=Xu(j.none()),n=function(){return t.get().each(e)},r=function(){n(),t.set(j.none())},i=function(){return t.get().isSome()},o=function(){return t.get()},a=function(e){n(),t.set(j.some(e))};return{clear:r,isSet:i,get:o,set:a}},fc=function(){var e=dc(E),t=function(t){return e.get().each(t)};return je(je({},e),{on:t})},hc=function(e,t){var n=null,r=function(){w(n)||(clearTimeout(n),n=null)},i=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];w(n)&&(n=setTimeout((function(){n=null,e.apply(null,r)}),t))};return{cancel:r,throttle:i}},mc=function(e,t){var n=null,r=function(){w(n)||(clearTimeout(n),n=null)},i=function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];r(),n=setTimeout((function(){n=null,e.apply(null,i)}),t)};return{cancel:r,throttle:i}},pc=function(e,t){var n=bi(e,t);return void 0===n||""===n?[]:n.split(" ")},gc=function(e,t,n){var r=pc(e,t),i=r.concat([n]);return gi(e,t,i.join(" ")),!0},vc=function(e,t,n){var r=ne(pc(e,t),(function(e){return e!==n}));return r.length>0?gi(e,t,r.join(" ")):Si(e,t),!1},bc=function(e){return void 0!==e.dom.classList},yc=function(e){return pc(e,"class")},wc=function(e,t){return gc(e,"class",t)},Sc=function(e,t){return vc(e,"class",t)},xc=function(e,t){bc(e)?e.dom.classList.add(t):wc(e,t)},Cc=function(e){var t=bc(e)?e.dom.classList:yc(e);0===t.length&&Si(e,"class")},Tc=function(e,t){if(bc(e)){var n=e.dom.classList;n.remove(t)}else Sc(e,t);Cc(e)},Dc=function(e,t){return bc(e)&&e.dom.classList.contains(t)},kc=function(e,t){var n=[];return Z(rr(e),(function(e){t(e)&&(n=n.concat([e])),n=n.concat(kc(e,t))})),n},Ec=function(e,t){return On(t,e)},_c=L("mce-annotation"),Ac=L("data-mce-annotation"),Lc=L("data-mce-annotation-uid"),Oc=function(e,t){var n=e.selection.getRng(),r=wn.fromDom(n.startContainer),i=wn.fromDom(e.getBody()),o=t.fold((function(){return"."+_c()}),(function(e){return"["+Ac()+'="'+e+'"]'})),a=ir(r,n.startOffset).getOr(r),s=_o(a,o,(function(e){return In(e,i)})),l=function(e,t){return wi(e,t)?j.some(bi(e,t)):j.none()};return s.bind((function(t){return l(t,""+Lc()).bind((function(n){return l(t,""+Ac()).map((function(t){var r=Ic(e,n);return{uid:n,name:t,elements:r}}))}))}))},Rc=function(e){return Un(e)&&Dc(e,_c())},Ic=function(e,t){var n=wn.fromDom(e.getBody());return Ec(n,"["+Lc()+'="'+t+'"]')},Pc=function(e,t){var n=wn.fromDom(e.getBody()),r=Ec(n,"["+Ac()+'="'+t+'"]'),i={};return Z(r,(function(e){var t=bi(e,Lc()),n=Oe(i,t).getOr([]);i[t]=n.concat([e])})),i},Mc=function(e,t){var n=Xu({}),r=function(){return{listeners:[],previous:fc()}},i=function(e,t){o(e,(function(e){return t(e),e}))},o=function(e,t){var i=n.get(),o=Oe(i,e).getOrThunk(r),a=t(o);i[e]=a,n.set(i)},a=function(e,t,n){i(e,(function(r){Z(r.listeners,(function(r){return r(!0,e,{uid:t,nodes:Q(n,(function(e){return e.dom}))})}))}))},s=function(e){i(e,(function(t){Z(t.listeners,(function(t){return t(!1,e)}))}))},l=mc((function(){var t=n.get(),r=me(we(t));Z(r,(function(t){o(t,(function(n){var r=n.previous.get();return Oc(e,j.some(t)).fold((function(){r.isSome()&&(s(t),n.previous.clear())}),(function(e){var t=e.uid,i=e.name,o=e.elements;ui(r,t)||(a(i,t,o),n.previous.set(t))})),{previous:n.previous,listeners:n.listeners}}))}))}),30);e.on("remove",(function(){l.cancel()})),e.on("NodeChange",(function(){l.throttle()}));var u=function(e,t){o(e,(function(e){return{previous:e.previous,listeners:e.listeners.concat([t])}}))};return{addListener:u}},Nc=function(e,t){var n=function(e){return j.from(e.attr(Ac())).bind(t.lookup)};e.on("init",(function(){e.serializer.addNodeFilter("span",(function(e){Z(e,(function(e){n(e).each((function(t){!1===t.persistent&&e.unwrap()}))}))}))}))},Fc=function(){var e={},t=function(t,n){e[t]={name:t,settings:n}},n=function(t){return Oe(e,t).map((function(e){return e.settings}))};return{register:t,lookup:n}},Bc=0,$c=function(e){var t=new Date,n=t.getTime(),r=Math.floor(1e9*Math.random());return Bc++,e+"_"+r+Bc+String(n)},zc=function(e,t){Z(t,(function(t){xc(e,t)}))},Uc=function(e,t){var n=t||document,r=n.createElement("div");return r.innerHTML=e,rr(wn.fromDom(r))},Vc=function(e){return Q(e,wn.fromDom)},Hc=function(e){return e.dom.innerHTML},jc=function(e,t){var n=Gn(e),r=n.dom,i=wn.fromDom(r.createDocumentFragment()),o=Uc(t,r);Tr(i,o),Dr(e),Sr(e,i)},qc=function(e,t){return wn.fromDom(e.dom.cloneNode(t))},Gc=function(e){return qc(e,!1)},Wc=function(e){return qc(e,!0)},Kc=function(e,t,n){void 0===n&&(n=B);var r=new zo(e,t),i=function(e){var t;do{t=r[e]()}while(t&&!Zr(t)&&!n(t));return j.from(t).filter(Zr)};return{current:function(){return j.from(r.current()).filter(Zr)},next:function(){return i("next")},prev:function(){return i("prev")},prev2:function(){return i("prev2")}}},Yc=function(e,t){var n=t||function(t){return e.isBlock(t)||ri(t)||ai(t)},r=function(e,t,n,i){if(Zr(e)){var o=i(e,t,e.data);if(-1!==o)return j.some({container:e,offset:o})}return n().bind((function(e){return r(e.container,e.offset,n,i)}))},i=function(e,t,i,o){var a=Kc(e,o,n);return r(e,t,(function(){return a.prev().map((function(e){return{container:e,offset:e.length}}))}),i).getOrNull()},o=function(e,t,i,o){var a=Kc(e,o,n);return r(e,t,(function(){return a.next().map((function(e){return{container:e,offset:0}}))}),i).getOrNull()};return{backwards:i,forwards:o}},Xc=Math.round,Jc=function(e){return e?{left:Xc(e.left),top:Xc(e.top),bottom:Xc(e.bottom),right:Xc(e.right),width:Xc(e.width),height:Xc(e.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0}},Qc=function(e,t){return e=Jc(e),t||(e.left=e.left+e.width),e.right=e.left,e.width=0,e},Zc=function(e,t){return e.left===t.left&&e.top===t.top&&e.bottom===t.bottom&&e.right===t.right},ed=function(e,t,n){return e>=0&&e<=Math.min(t.height,n.height)/2},td=function(e,t){var n=Math.min(t.height/2,e.height/2);return e.bottom-n<t.top||!(e.top>t.bottom)&&ed(t.top-e.bottom,e,t)},nd=function(e,t){return e.top>t.bottom||!(e.bottom<t.top)&&ed(t.bottom-e.top,e,t)},rd=function(e,t,n){return t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom},id=function(e,t,n){return Math.min(Math.max(e,t),n)},od=function(e){var t=e.startContainer,n=e.startOffset;return t.hasChildNodes()&&e.endOffset===n+1?t.childNodes[n]:null},ad=function(e,t){if(Hr(e)&&e.hasChildNodes()){var n=e.childNodes,r=id(t,0,n.length-1);return n[r]}return e},sd=function(e,t){return t<0&&Hr(e)&&e.hasChildNodes()?void 0:ad(e,t)},ld=new RegExp("[̀-ͯ҃-҇҈-҉֑-ֽֿׁ-ׂׄ-ׇׅؐ-ًؚ-ٰٟۖ-ۜ۟-ۤۧ-۪ۨ-ܑۭܰ-݊ަ-ް߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࣣ-ंऺ़ु-ै्॑-ॗॢ-ॣঁ়াু-ৄ্ৗৢ-ৣਁ-ਂ਼ੁ-ੂੇ-ੈੋ-੍ੑੰ-ੱੵઁ-ં઼ુ-ૅે-ૈ્ૢ-ૣଁ଼ାିୁ-ୄ୍ୖୗୢ-ୣஂாீ்ௗఀా-ీె-ైొ-్ౕ-ౖౢ-ౣಁ಼ಿೂೆೌ-್ೕ-ೖೢ-ೣഁാു-ൄ്ൗൢ-ൣ්ාි-ුූෟัิ-ฺ็-๎ັິ-ູົ-ຼ່-ໍ༘-ཱ༹༙༵༷-ཾྀ-྄྆-྇ྍ-ྗྙ-ྼ࿆ိ-ူဲ-့္-်ွ-ှၘ-ၙၞ-ၠၱ-ၴႂႅ-ႆႍႝ፝-፟ᜒ-᜔ᜲ-᜴ᝒ-ᝓᝲ-ᝳ឴-឵ិ-ួំ៉-៓៝᠋-᠍ᢩᤠ-ᤢᤧ-ᤨᤲ᤹-᤻ᨗ-ᨘᨛᩖᩘ-ᩞ᩠ᩢᩥ-ᩬᩳ-᩿᩼᪰-᪽᪾ᬀ-ᬃ᬴ᬶ-ᬺᬼᭂ᭫-᭳ᮀ-ᮁᮢ-ᮥᮨ-ᮩ᮫-ᮭ᯦ᯨ-ᯩᯭᯯ-ᯱᰬ-ᰳᰶ-᰷᳐-᳔᳒-᳢᳠-᳨᳭᳴᳸-᳹᷀-᷵᷼-᷿‌-‍⃐-⃜⃝-⃠⃡⃢-⃤⃥-⃰⳯-⵿⳱ⷠ-〪ⷿ-〭〮-゙〯-゚꙯꙰-꙲ꙴ-꙽ꚞ-ꚟ꛰-꛱ꠂ꠆ꠋꠥ-ꠦ꣄꣠-꣱ꤦ-꤭ꥇ-ꥑꦀ-ꦂ꦳ꦶ-ꦹꦼꧥꨩ-ꨮꨱ-ꨲꨵ-ꨶꩃꩌꩼꪰꪲ-ꪴꪷ-ꪸꪾ-꪿꫁ꫬ-ꫭ꫶ꯥꯨ꯭ﬞ︀-️︠-︯ﾞ-ﾟ]"),ud=function(e){return"string"===typeof e&&e.charCodeAt(0)>=768&&ld.test(e)},cd=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){for(var n=0;n<e.length;n++)if(e[n](t))return!0;return!1}},dd=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){for(var n=0;n<e.length;n++)if(!e[n](t))return!1;return!0}},fd=Hr,hd=$a,md=qr("display","block table"),pd=qr("float","left right"),gd=dd(fd,hd,P(pd)),vd=P(qr("white-space","pre pre-line pre-wrap")),bd=Zr,yd=ri,wd=Uu.nodeIndex,Sd=sd,xd=function(e){return"createRange"in e?e.createRange():Uu.DOM.createRng()},Cd=function(e){return e&&/[\r\n\t ]/.test(e)},Td=function(e){return!!e.setStart&&!!e.setEnd},Dd=function(e){var t=e.startContainer,n=e.startOffset;if(Cd(e.toString())&&vd(t.parentNode)&&Zr(t)){var r=t.data;if(Cd(r[n-1])||Cd(r[n+1]))return!0}return!1},kd=function(e){var t=e.ownerDocument,n=xd(t),r=t.createTextNode(ua),i=e.parentNode;i.insertBefore(r,e),n.setStart(r,0),n.setEnd(r,1);var o=Jc(n.getBoundingClientRect());return i.removeChild(r),o},Ed=function(e){var t=e.startContainer,n=e.endContainer,r=e.startOffset,i=e.endOffset;if(t===n&&Zr(n)&&0===r&&1===i){var o=e.cloneRange();return o.setEndAfter(n),Ad(o)}return null},_d=function(e){return 0===e.left&&0===e.right&&0===e.top&&0===e.bottom},Ad=function(e){var t,n=e.getClientRects();return t=n.length>0?Jc(n[0]):Jc(e.getBoundingClientRect()),!Td(e)&&yd(e)&&_d(t)?kd(e):_d(t)&&Td(e)?Ed(e):t},Ld=function(e,t){var n=Qc(e,t);return n.width=1,n.right=n.left+1,n},Od=function(e){var t=[],n=function(e){0!==e.height&&(t.length>0&&Zc(e,t[t.length-1])||t.push(e))},r=function(e,r){var i=xd(e.ownerDocument);if(r<e.data.length){if(ud(e.data[r]))return t;if(ud(e.data[r-1])&&(i.setStart(e,r),i.setEnd(e,r+1),!Dd(i)))return n(Ld(Ad(i),!1)),t}r>0&&(i.setStart(e,r-1),i.setEnd(e,r),Dd(i)||n(Ld(Ad(i),!1))),r<e.data.length&&(i.setStart(e,r),i.setEnd(e,r+1),Dd(i)||n(Ld(Ad(i),!0)))},i=e.container(),o=e.offset();if(bd(i))return r(i,o),t;if(fd(i))if(e.isAtEnd()){var a=Sd(i,o);bd(a)&&r(a,a.data.length),gd(a)&&!yd(a)&&n(Ld(Ad(a),!1))}else{a=Sd(i,o);if(bd(a)&&r(a,0),gd(a)&&e.isAtEnd())return n(Ld(Ad(a),!1)),t;var s=Sd(e.container(),e.offset()-1);gd(s)&&!yd(s)&&(md(s)||md(a)||!gd(a))&&n(Ld(Ad(s),!1)),gd(a)&&n(Ld(Ad(a),!0))}return t},Rd=function(e,t,n){var r=function(){return bd(e),0===t},i=function(){return bd(e)?t>=e.data.length:t>=e.childNodes.length},o=function(){var n=xd(e.ownerDocument);return n.setStart(e,t),n.setEnd(e,t),n},a=function(){return n||(n=Od(Rd(e,t))),n},s=function(){return a().length>0},l=function(n){return n&&e===n.container()&&t===n.offset()},u=function(n){return Sd(e,n?t-1:t)};return{container:L(e),offset:L(t),toRange:o,getClientRects:a,isVisible:s,isAtStart:r,isAtEnd:i,isEqual:l,getNode:u}};Rd.fromRangeStart=function(e){return Rd(e.startContainer,e.startOffset)},Rd.fromRangeEnd=function(e){return Rd(e.endContainer,e.endOffset)},Rd.after=function(e){return Rd(e.parentNode,wd(e)+1)},Rd.before=function(e){return Rd(e.parentNode,wd(e))},Rd.isAbove=function(e,t){return di(ge(t.getClientRects()),ve(e.getClientRects()),td).getOr(!1)},Rd.isBelow=function(e,t){return di(ve(t.getClientRects()),ge(e.getClientRects()),nd).getOr(!1)},Rd.isAtStart=function(e){return!!e&&e.isAtStart()},Rd.isAtEnd=function(e){return!!e&&e.isAtEnd()},Rd.isTextPosition=function(e){return!!e&&Zr(e.container())},Rd.isElementPosition=function(e){return!1===Rd.isTextPosition(e)};var Id,Pd=function(e,t){Zr(t)&&0===t.data.length&&e.remove(t)},Md=function(e,t,n){t.insertNode(n),Pd(e,n.previousSibling),Pd(e,n.nextSibling)},Nd=function(e,t,n){var r=j.from(n.firstChild),i=j.from(n.lastChild);t.insertNode(n),r.each((function(t){return Pd(e,t.previousSibling)})),i.each((function(t){return Pd(e,t.nextSibling)}))},Fd=function(e,t,n){ni(n)?Nd(e,t,n):Md(e,t,n)},Bd=Zr,$d=Kr,zd=Uu.nodeIndex,Ud=function(e){var t=e.parentNode;return $d(t)?Ud(t):t},Vd=function(e){return e?Ue(e.childNodes,(function(e,t){return $d(t)&&"BR"!==t.nodeName?e=e.concat(Vd(t)):e.push(t),e}),[]):[]},Hd=function(e,t){while(e=e.previousSibling){if(!Bd(e))break;t+=e.data.length}return t},jd=function(e){return function(t){return e===t}},qd=function(e){var t,n;t=Vd(Ud(e)),n=Ve(t,jd(e),e),t=t.slice(0,n+1);var r=Ue(t,(function(e,n,r){return Bd(n)&&Bd(t[r-1])&&e++,e}),0);return t=$e(t,jr([e.nodeName])),n=Ve(t,jd(e),e),n-r},Gd=function(e){var t;return t=Bd(e)?"text()":e.nodeName.toLowerCase(),t+"["+qd(e)+"]"},Wd=function(e,t,n){var r=[];for(t=t.parentNode;t!==e;t=t.parentNode){if(n&&n(t))break;r.push(t)}return r},Kd=function(e,t){var n,r,i,o,a,s=[];return n=t.container(),r=t.offset(),Bd(n)?i=Hd(n,r):(o=n.childNodes,r>=o.length?(i="after",r=o.length-1):i="before",n=o[r]),s.push(Gd(n)),a=Wd(e,n),a=$e(a,P(Kr)),s=s.concat(Be(a,(function(e){return Gd(e)}))),s.reverse().join("/")+","+i},Yd=function(e,t,n){var r=Vd(e);return r=$e(r,(function(e,t){return!Bd(e)||!Bd(r[t-1])})),r=$e(r,jr([t])),r[n]},Xd=function(e,t){var n,r=e,i=0;while(Bd(r)){if(n=r.data.length,t>=i&&t<=i+n){e=r,t-=i;break}if(!Bd(r.nextSibling)){e=r,t=n;break}i+=n,r=r.nextSibling}return Bd(e)&&t>e.data.length&&(t=e.data.length),Rd(e,t)},Jd=function(e,t){var n;if(!t)return null;var r=t.split(","),i=r[0].split("/");n=r.length>1?r[1]:"before";var o=Ue(i,(function(e,t){var n=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(t);return n?("text()"===n[1]&&(n[1]="#text"),Yd(e,n[1],parseInt(n[2],10))):null}),e);return o?Bd(o)?Xd(o,parseInt(n,10)):(n="after"===n?zd(o)+1:zd(o),Rd(o.parentNode,n)):null},Qd=ai,Zd=function(e,t,n){var r,i;for(i=e(t.data.slice(0,n)).length,r=t.previousSibling;r&&Zr(r);r=r.previousSibling)i+=e(r.data).length;return i},ef=function(e,t,n,r,i){var o,a=r[i?"startContainer":"endContainer"],s=r[i?"startOffset":"endOffset"],l=[],u=0,c=e.getRoot();for(Zr(a)?l.push(n?Zd(t,a,s):s):(o=a.childNodes,s>=o.length&&o.length&&(u=1,s=Math.max(0,o.length-1)),l.push(e.nodeIndex(o[s],n)+u));a&&a!==c;a=a.parentNode)l.push(e.nodeIndex(a,n));return l},tf=function(e,t,n,r){var i=t.dom,o={};return o.start=ef(i,e,n,r,!0),t.isCollapsed()||(o.end=ef(i,e,n,r,!1)),La(r)&&(o.isFakeCaret=!0),o},nf=function(e,t,n){var r=0;return mn.each(e.select(t),(function(e){if("all"!==e.getAttribute("data-mce-bogus"))return e!==n&&void r++})),r},rf=function(e,t){var n,r,i,o=t?"start":"end";n=e[o+"Container"],r=e[o+"Offset"],Hr(n)&&"TR"===n.nodeName&&(i=n.childNodes,n=i[Math.min(t?r:r-1,i.length-1)],n&&(r=t?0:n.childNodes.length,e["set"+(t?"Start":"End")](n,r)))},of=function(e){return rf(e,!0),rf(e,!1),e},af=function(e,t){var n;if(Hr(e)&&(e=ad(e,t),Qd(e)))return e;if(ya(e)){if(Zr(e)&&va(e)&&(e=e.parentNode),n=e.previousSibling,Qd(n))return n;if(n=e.nextSibling,Qd(n))return n}},sf=function(e){return af(e.startContainer,e.startOffset)||af(e.endContainer,e.endOffset)},lf=function(e,t,n){var r=n.getNode(),i=r?r.nodeName:null,o=n.getRng();if(Qd(r)||"IMG"===i)return{name:i,index:nf(n.dom,i,r)};var a=sf(o);return a?(i=a.tagName,{name:i,index:nf(n.dom,i,a)}):tf(e,n,t,o)},uf=function(e){var t=e.getRng();return{start:Kd(e.dom.getRoot(),Rd.fromRangeStart(t)),end:Kd(e.dom.getRoot(),Rd.fromRangeEnd(t))}},cf=function(e){return{rng:e.getRng()}},df=function(e,t,n){var r={"data-mce-type":"bookmark",id:t,style:"overflow:hidden;line-height:0px"};return n?e.create("span",r,"&#xFEFF;"):e.create("span",r)},ff=function(e,t){var n=e.dom,r=e.getRng(),i=n.uniqueId(),o=e.isCollapsed(),a=e.getNode(),s=a.nodeName;if("IMG"===s)return{name:s,index:nf(n,s,a)};var l=of(r.cloneRange());if(!o){l.collapse(!1);var u=df(n,i+"_end",t);Fd(n,l,u)}r=of(r),r.collapse(!0);var c=df(n,i+"_start",t);return Fd(n,r,c),e.moveToBookmark({id:i,keep:!0}),{id:i}},hf=function(e,t,n){return 2===t?lf(ma,n,e):3===t?uf(e):t?cf(e):ff(e,!1)},mf=I(lf,O,!0),pf=Uu.DOM,gf="font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow",vf=function(e,t,n){var r=e.getParam(t,n);if(-1!==r.indexOf("=")){var i=e.getParam(t,"","hash");return Oe(i,e.id).getOr(n)}return r},bf=function(e){return e.getParam("iframe_attrs",{})},yf=function(e){return e.getParam("doctype","<!DOCTYPE html>")},wf=function(e){return e.getParam("document_base_url","")},Sf=function(e){return vf(e,"body_id","tinymce")},xf=function(e){return vf(e,"body_class","")},Cf=function(e){return e.getParam("content_security_policy","")},Tf=function(e){return e.getParam("br_in_pre",!0)},Df=function(e){if(e.getParam("force_p_newlines",!1))return"p";var t=e.getParam("forced_root_block","p");return!1===t?"":!0===t?"p":t},kf=function(e){return e.getParam("forced_root_block_attrs",{})},Ef=function(e){return e.getParam("br_newline_selector",".mce-toc h2,figcaption,caption")},_f=function(e){return e.getParam("no_newline_selector","")},Af=function(e){return e.getParam("keep_styles",!0)},Lf=function(e){return e.getParam("end_container_on_empty_block",!1)},Of=function(e){return mn.explode(e.getParam("font_size_style_values","xx-small,x-small,small,medium,large,x-large,xx-large"))},Rf=function(e){return mn.explode(e.getParam("font_size_classes",""))},If=function(e){return e.getParam("images_dataimg_filter",$,"function")},Pf=function(e){return e.getParam("automatic_uploads",!0,"boolean")},Mf=function(e){return e.getParam("images_reuse_filename",!1,"boolean")},Nf=function(e){return e.getParam("images_replace_blob_uris",!0,"boolean")},Ff=function(e){return e.getParam("icons","","string")},Bf=function(e){return e.getParam("icons_url","","string")},$f=function(e){return e.getParam("images_upload_url","","string")},zf=function(e){return e.getParam("images_upload_base_path","","string")},Uf=function(e){return e.getParam("images_upload_credentials",!1,"boolean")},Vf=function(e){return e.getParam("images_upload_handler",null,"function")},Hf=function(e){return e.getParam("content_css_cors",!1,"boolean")},jf=function(e){return e.getParam("referrer_policy","","string")},qf=function(e){return e.getParam("language","en","string")},Gf=function(e){return e.getParam("language_url","","string")},Wf=function(e){return e.getParam("indent_use_margin",!1)},Kf=function(e){return e.getParam("indentation","40px","string")},Yf=function(e){var t=e.getParam("content_css");return v(t)?Q(t.split(","),dt):y(t)?t:!1===t||e.inline?[]:["default"]},Xf=function(e){var t=e.getParam("font_css",[]);return y(t)?t:Q(t.split(","),dt)},Jf=function(e){return e.getParam("directionality",uc.isRtl()?"rtl":void 0)},Qf=function(e){return e.getParam("inline_boundaries_selector","a[href],code,.mce-annotation","string")},Zf=function(e){var t=e.getParam("object_resizing");return!1!==t&&!en.iOS&&(v(t)?t:"table,img,figure.image,div,video,iframe")},eh=function(e){return e.getParam("resize_img_proportional",!0,"boolean")},th=function(e){return e.getParam("placeholder",pf.getAttrib(e.getElement(),"placeholder"),"string")},nh=function(e){return e.getParam("event_root")},rh=function(e){return e.getParam("service_message")},ih=function(e){return e.getParam("theme")},oh=function(e){return e.getParam("validate")},ah=function(e){return!1!==e.getParam("inline_boundaries")},sh=function(e){return e.getParam("formats")},lh=function(e){var t=e.getParam("preview_styles",gf);return v(t)?t:""},uh=function(e){return e.getParam("format_empty_lines",!1,"boolean")},ch=function(e){return e.getParam("custom_ui_selector","","string")},dh=function(e){return e.getParam("theme_url")},fh=function(e){return e.getParam("inline")},hh=function(e){return e.getParam("hidden_input")},mh=function(e){return e.getParam("submit_patch")},ph=function(e){return"xml"===e.getParam("encoding")},gh=function(e){return e.getParam("add_form_submit_trigger")},vh=function(e){return e.getParam("add_unload_trigger")},bh=function(e){return""!==Df(e)},yh=function(e){return e.getParam("custom_undo_redo_levels",0,"number")},wh=function(e){return e.getParam("disable_nodechange")},Sh=function(e){return e.getParam("readonly")},xh=function(e){return e.getParam("content_css_cors")},Ch=function(e){return e.getParam("plugins","","string")},Th=function(e){return e.getParam("external_plugins")},Dh=function(e){return e.getParam("block_unsupported_drop",!0,"boolean")},kh=function(e){return e.getParam("visual",!0,"boolean")},Eh=function(e){return e.getParam("visual_table_class","mce-item-table","string")},_h=function(e){return e.getParam("visual_anchor_class","mce-item-anchor","string")},Ah=function(e){return e.getParam("iframe_aria_text","Rich Text Area. Press ALT-0 for help.","string")},Lh=Hr,Oh=Zr,Rh=function(e){var t=e.parentNode;t&&t.removeChild(e)},Ih=function(e){var t=ma(e);return{count:e.length-t.length,text:t}},Ph=function(e){var t;while(-1!==(t=e.data.lastIndexOf(fa)))e.deleteData(t,1)},Mh=function(e,t){return Uh(e),t},Nh=function(e,t){var n=Ih(e.data.substr(0,t.offset())),r=Ih(e.data.substr(t.offset())),i=n.text+r.text;return i.length>0?(Ph(e),Rd(e,t.offset()-n.count)):t},Fh=function(e,t){var n=t.container(),r=Y(be(n.childNodes),e).map((function(e){return e<t.offset()?Rd(n,t.offset()-1):t})).getOr(t);return Uh(e),r},Bh=function(e,t){return Oh(e)&&t.container()===e?Nh(e,t):Mh(e,t)},$h=function(e,t){return t.container()===e.parentNode?Fh(e,t):Mh(e,t)},zh=function(e,t){return Rd.isTextPosition(t)?Bh(e,t):$h(e,t)},Uh=function(e){Lh(e)&&ya(e)&&(wa(e)?e.removeAttribute("data-mce-caret"):Rh(e)),Oh(e)&&(Ph(e),0===e.data.length&&Rh(e))},Vh=qt().browser,Hh=ai,jh=li,qh=si,Gh="*[contentEditable=false],video,audio,embed,object",Wh=function(e,t,n){var r,i,o=Qc(t.getBoundingClientRect(),n);if("BODY"===e.tagName){var a=e.ownerDocument.documentElement;r=e.scrollLeft||a.scrollLeft,i=e.scrollTop||a.scrollTop}else{var s=e.getBoundingClientRect();r=e.scrollLeft-s.left,i=e.scrollTop-s.top}o.left+=r,o.right+=r,o.top+=i,o.bottom+=i,o.width=1;var l=t.offsetWidth-t.clientWidth;return l>0&&(n&&(l*=-1),o.left+=l,o.right+=l),o},Kh=function(e){for(var t=Ec(wn.fromDom(e),Gh),n=0;n<t.length;n++){var r=t[n].dom,i=r.previousSibling;if(Ea(i)){var o=i.data;1===o.length?i.parentNode.removeChild(i):i.deleteData(o.length-1,1)}if(i=r.nextSibling,ka(i)){o=i.data;1===o.length?i.parentNode.removeChild(i):i.deleteData(0,1)}}},Yh=function(e,t,n,r){var i,o,a=fc(),s=Df(e),l=s.length>0?s:"p",u=function(e,r){var i;if(c(),qh(r))return null;if(!n(r))return o=Sa(r,e),i=r.ownerDocument.createRange(),Jh(o.nextSibling)?(i.setStart(o,0),i.setEnd(o,0)):(i.setStart(o,1),i.setEnd(o,1)),i;o=Da(l,r,e);var s=Wh(t,r,e);Iu(o).css("top",s.top);var u=Iu('<div class="mce-visual-caret" data-mce-bogus="all"></div>').css(je({},s)).appendTo(t)[0];return a.set({caret:u,element:r,before:e}),e&&Iu(u).addClass("mce-visual-caret-before"),d(),i=r.ownerDocument.createRange(),i.setStart(o,0),i.setEnd(o,0),i},c=function(){Kh(t),o&&(Uh(o),o=null),a.on((function(e){Iu(e.caret).remove(),a.clear()})),i&&(No.clearInterval(i),i=void 0)},d=function(){i=No.setInterval((function(){r()?Iu("div.mce-visual-caret",t).toggleClass("mce-visual-caret-hidden"):Iu("div.mce-visual-caret",t).addClass("mce-visual-caret-hidden")}),500)},f=function(){a.on((function(e){var n=Wh(t,e.element,e.before);Iu(e.caret).css(je({},n))}))},h=function(){return No.clearInterval(i)},m=function(){return".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}"};return{show:u,hide:c,getCss:m,reposition:f,destroy:h}},Xh=function(){return Vh.isIE()||Vh.isEdge()||Vh.isFirefox()},Jh=function(e){return Hh(e)||jh(e)},Qh=function(e){return Jh(e)||Xr(e)&&Xh()},Zh=ai,em=li,tm=qr("display","block table table-cell table-caption list-item"),nm=ya,rm=va,im=Hr,om=$a,am=function(e){return e>0},sm=function(e){return e<0},lm=function(e,t){var n;while(n=e(t))if(!rm(n))return n;return null},um=function(e,t,n,r,i){var o=new zo(e,r),a=Zh(e)||rm(e);if(sm(t)){if(a&&(e=lm(o.prev.bind(o),!0),n(e)))return e;while(e=lm(o.prev.bind(o),i))if(n(e))return e}if(am(t)){if(a&&(e=lm(o.next.bind(o),!0),n(e)))return e;while(e=lm(o.next.bind(o),i))if(n(e))return e}return null},cm=function(e,t){while(e&&e!==t){if(tm(e))return e;e=e.parentNode}return null},dm=function(e,t,n){return cm(e.container(),n)===cm(t.container(),n)},fm=function(e,t){if(!t)return null;var n=t.container(),r=t.offset();return im(n)?n.childNodes[r+e]:null},hm=function(e,t){var n=t.ownerDocument.createRange();return e?(n.setStartBefore(t),n.setEndBefore(t)):(n.setStartAfter(t),n.setEndAfter(t)),n},mm=function(e,t,n){return cm(t,e)===cm(n,e)},pm=function(e,t,n){var r=e?"previousSibling":"nextSibling";while(n&&n!==t){var i=n[r];if(nm(i)&&(i=i[r]),Zh(i)||em(i)){if(mm(t,i,n))return i;break}if(om(i))break;n=n.parentNode}return null},gm=I(hm,!0),vm=I(hm,!1),bm=function(e,t,n){var r,i=I(pm,!0,t),o=I(pm,!1,t),a=n.startContainer,s=n.startOffset;if(va(a)){im(a)||(a=a.parentNode);var l=a.getAttribute("data-mce-caret");if("before"===l&&(r=a.nextSibling,Qh(r)))return gm(r);if("after"===l&&(r=a.previousSibling,Qh(r)))return vm(r)}if(!n.collapsed)return n;if(Zr(a)){if(nm(a)){if(1===e){if(r=o(a),r)return gm(r);if(r=i(a),r)return vm(r)}if(-1===e){if(r=i(a),r)return vm(r);if(r=o(a),r)return gm(r)}return n}if(Ea(a)&&s>=a.data.length-1)return 1===e&&(r=o(a),r)?gm(r):n;if(ka(a)&&s<=1)return-1===e&&(r=i(a),r)?vm(r):n;if(s===a.data.length)return r=o(a),r?gm(r):n;if(0===s)return r=i(a),r?vm(r):n}return n},ym=function(e,t){return j.from(fm(e?0:-1,t)).filter(Zh)},wm=function(e,t,n){var r=bm(e,t,n);return-1===e?Rd.fromRangeStart(r):Rd.fromRangeEnd(r)},Sm=function(e){return j.from(e.getNode()).map(wn.fromDom)},xm=function(e){return j.from(e.getNode(!0)).map(wn.fromDom)},Cm=function(e,t){while(t=e(t))if(t.isVisible())return t;return t},Tm=function(e,t){var n=dm(e,t);return!(n||!ri(e.getNode()))||n};(function(e){e[e["Backwards"]=-1]="Backwards",e[e["Forwards"]=1]="Forwards"})(Id||(Id={}));var Dm=ai,km=Zr,Em=Hr,_m=ri,Am=$a,Lm=ja,Om=qa,Rm=function(e,t){var n=[];while(e&&e!==t)n.push(e),e=e.parentNode;return n},Im=function(e,t){return e.hasChildNodes()&&t<e.childNodes.length?e.childNodes[t]:null},Pm=function(e,t){if(am(e)){if(Am(t.previousSibling)&&!km(t.previousSibling))return Rd.before(t);if(km(t))return Rd(t,0)}if(sm(e)){if(Am(t.nextSibling)&&!km(t.nextSibling))return Rd.after(t);if(km(t))return Rd(t,t.data.length)}return sm(e)?_m(t)?Rd.before(t):Rd.after(t):Rd.before(t)},Mm=function(e,t){var n=t.nextSibling;return n&&Am(n)?km(n)?Rd(n,0):Rd.before(n):Nm(Id.Forwards,Rd.after(t),e)},Nm=function(e,t,n){var r,i,o,a;if(!Em(n)||!t)return null;if(t.isEqual(Rd.after(n))&&n.lastChild){if(a=Rd.after(n.lastChild),sm(e)&&Am(n.lastChild)&&Em(n.lastChild))return _m(n.lastChild)?Rd.before(n.lastChild):a}else a=t;var s=a.container(),l=a.offset();if(km(s)){if(sm(e)&&l>0)return Rd(s,--l);if(am(e)&&l<s.length)return Rd(s,++l);r=s}else{if(sm(e)&&l>0&&(i=Im(s,l-1),Am(i)))return!Lm(i)&&(o=um(i,e,Om,i),o)?km(o)?Rd(o,o.data.length):Rd.after(o):km(i)?Rd(i,i.data.length):Rd.before(i);if(am(e)&&l<s.childNodes.length&&(i=Im(s,l),Am(i)))return _m(i)?Mm(n,i):!Lm(i)&&(o=um(i,e,Om,i),o)?km(o)?Rd(o,0):Rd.before(o):km(i)?Rd(i,0):Rd.after(i);r=i||a.getNode()}if((am(e)&&a.isAtEnd()||sm(e)&&a.isAtStart())&&(r=um(r,e,$,n,!0),Om(r,n)))return Pm(e,r);i=um(r,e,Om,n);var u=He(ne(Rm(s,n),Dm));return!u||i&&u.contains(i)?i?Pm(e,i):null:(a=am(e)?Rd.after(u):Rd.before(u),a)},Fm=function(e){return{next:function(t){return Nm(Id.Forwards,t,e)},prev:function(t){return Nm(Id.Backwards,t,e)}}},Bm=function(e,t,n){var r=e?Rd.before(n):Rd.after(n);return qm(e,t,r)},$m=function(e){return ri(e)?Rd.before(e):Rd.after(e)},zm=function(e){return Rd.isTextPosition(e)?0===e.offset():$a(e.getNode())},Um=function(e){if(Rd.isTextPosition(e)){var t=e.container();return e.offset()===t.data.length}return $a(e.getNode(!0))},Vm=function(e,t){return!Rd.isTextPosition(e)&&!Rd.isTextPosition(t)&&e.getNode()===t.getNode(!0)},Hm=function(e){return!Rd.isTextPosition(e)&&ri(e.getNode())},jm=function(e,t,n){return e?!Vm(t,n)&&!Hm(t)&&Um(t)&&zm(n):!Vm(n,t)&&zm(t)&&Um(n)},qm=function(e,t,n){var r=Fm(t);return j.from(e?r.next(n):r.prev(n))},Gm=function(e,t,n){return qm(e,t,n).bind((function(r){return dm(n,r,t)&&jm(e,n,r)?qm(e,t,r):j.some(r)}))},Wm=function(e,t,n,r){return Gm(e,t,n).bind((function(n){return r(n)?Wm(e,t,n,r):j.some(n)}))},Km=function(e,t){var n=e?t.firstChild:t.lastChild;return Zr(n)?j.some(Rd(n,e?0:n.data.length)):n?$a(n)?j.some(e?Rd.before(n):$m(n)):Bm(e,t,n):j.none()},Ym=I(qm,!0),Xm=I(qm,!1),Jm=I(Km,!0),Qm=I(Km,!1),Zm="_mce_caret",ep=function(e){return Hr(e)&&e.id===Zm},tp=function(e,t){while(t&&t!==e){if(t.id===Zm)return t;t=t.parentNode}return null},np=function(e){return v(e.start)},rp=function(e){return Re(e,"rng")},ip=function(e){return Re(e,"id")},op=function(e){return Re(e,"name")},ap=function(e){return mn.isArray(e.start)},sp=function(e,t){return Hr(t)&&e.isBlock(t)&&!t.innerHTML&&!en.ie&&(t.innerHTML='<br data-mce-bogus="1" />'),t},lp=function(e,t){var n,r=e.createRng();return n=Jd(e.getRoot(),t.start),r.setStart(n.container(),n.offset()),n=Jd(e.getRoot(),t.end),r.setEnd(n.container(),n.offset()),r},up=function(e,t){var n=e.ownerDocument.createTextNode(fa);e.appendChild(n),t.setStart(n,0),t.setEnd(n,0)},cp=function(e){return!1===e.hasChildNodes()},dp=function(e,t){return Qm(e).fold(B,(function(e){return t.setStart(e.container(),e.offset()),t.setEnd(e.container(),e.offset()),!0}))},fp=function(e,t,n){return!(!cp(t)||!tp(e,t))&&(up(t,n),!0)},hp=function(e,t,n,r){var i,o,a,s,l=n[t?"start":"end"],u=e.getRoot();if(l){for(a=l[0],o=u,i=l.length-1;i>=1;i--){if(s=o.childNodes,fp(u,o,r))return!0;if(l[i]>s.length-1)return!!fp(u,o,r)||dp(o,r);o=s[l[i]]}3===o.nodeType&&(a=Math.min(l[0],o.nodeValue.length)),1===o.nodeType&&(a=Math.min(l[0],o.childNodes.length)),t?r.setStart(o,a):r.setEnd(o,a)}return!0},mp=function(e){return Zr(e)&&e.data.length>0},pp=function(e,t,n){var r,i,o,a,s,l,u=e.get(n.id+"_"+t),c=n.keep;if(u){if(r=u.parentNode,"start"===t?(c?u.hasChildNodes()?(r=u.firstChild,i=1):mp(u.nextSibling)?(r=u.nextSibling,i=0):mp(u.previousSibling)?(r=u.previousSibling,i=u.previousSibling.data.length):(r=u.parentNode,i=e.nodeIndex(u)+1):i=e.nodeIndex(u),s=r,l=i):(c?u.hasChildNodes()?(r=u.firstChild,i=1):mp(u.previousSibling)?(r=u.previousSibling,i=u.previousSibling.data.length):(r=u.parentNode,i=e.nodeIndex(u)):i=e.nodeIndex(u),s=r,l=i),!c){a=u.previousSibling,o=u.nextSibling,mn.each(mn.grep(u.childNodes),(function(e){Zr(e)&&(e.nodeValue=e.nodeValue.replace(/\uFEFF/g,""))}));while(u=e.get(n.id+"_"+t))e.remove(u,!0);a&&o&&a.nodeType===o.nodeType&&Zr(a)&&!en.opera&&(i=a.nodeValue.length,a.appendData(o.nodeValue),e.remove(o),s=a,l=i)}return j.some(Rd(s,l))}return j.none()},gp=function(e,t){var n=e.createRng();return hp(e,!0,t,n)&&hp(e,!1,t,n)?j.some(n):j.none()},vp=function(e,t){var n=pp(e,"start",t),r=pp(e,"end",t);return di(n,r.or(n),(function(t,n){var r=e.createRng();return r.setStart(sp(e,t.container()),t.offset()),r.setEnd(sp(e,n.container()),n.offset()),r}))},bp=function(e,t){return j.from(e.select(t.name)[t.index]).map((function(t){var n=e.createRng();return n.selectNode(t),n}))},yp=function(e,t){var n=e.dom;if(t){if(ap(t))return gp(n,t);if(np(t))return j.some(lp(n,t));if(ip(t))return vp(n,t);if(op(t))return bp(n,t);if(rp(t))return j.some(t.rng)}return j.none()},wp=function(e,t,n){return hf(e,t,n)},Sp=function(e,t){yp(e,t).each((function(t){e.setRng(t)}))},xp=function(e){return Hr(e)&&"SPAN"===e.tagName&&"bookmark"===e.getAttribute("data-mce-type")},Cp=function(e){return function(t){return e===t}},Tp=Cp(ua),Dp=function(e){return""!==e&&-1!==" \f\n\r\t\v".indexOf(e)},kp=function(e){return!Dp(e)&&!Tp(e)},Ep=function(e){return!!e.nodeType},_p=function(e){return e&&/^(IMG)$/.test(e.nodeName)},Ap=function(e,t,n){var r=n.startOffset,i=n.startContainer;if((i!==n.endContainer||!_p(i.childNodes[r]))&&Hr(i)){var o=i.childNodes,a=void 0;r<o.length?(i=o[r],a=new zo(i,e.getParent(i,e.isBlock))):(i=o[o.length-1],a=new zo(i,e.getParent(i,e.isBlock)),a.next(!0));for(var s=a.current();s;s=a.next())if(Zr(s)&&!Ip(s))return n.setStart(s,0),void t.setRng(n)}},Lp=function(e,t,n){if(e){var r=t?"nextSibling":"previousSibling";for(e=n?e:e[r];e;e=e[r])if(Hr(e)||!Ip(e))return e}},Op=function(e,t){return Ep(t)&&(t=t.nodeName),!!e.schema.getTextBlockElements()[t.toLowerCase()]},Rp=function(e,t,n){return e.schema.isValidChild(t,n)},Ip=function(e,t){if(void 0===t&&(t=!1),T(e)&&Zr(e)){var n=t?e.data.replace(/ /g," "):e.data;return Wa(n)}return!1},Pp=function(e){return T(e)&&Zr(e)&&0===e.length},Mp=function(e,t){return D(e)?e=e(t):T(t)&&(e=e.replace(/%(\w+)/g,(function(e,n){return t[n]||e}))),e},Np=function(e,t){return e=e||"",t=t||"",e=""+(e.nodeName||e),t=""+(t.nodeName||t),e.toLowerCase()===t.toLowerCase()},Fp=function(e,t,n){return"color"!==n&&"backgroundColor"!==n||(t=e.toHex(t)),"fontWeight"===n&&700===t&&(t="bold"),"fontFamily"===n&&(t=t.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),""+t},Bp=function(e,t,n){return Fp(e,e.getStyle(t,n),n)},$p=function(e,t){var n;return e.getParent(t,(function(t){return n=e.getStyle(t,"text-decoration"),n&&"none"!==n})),n},zp=function(e,t,n){return e.getParents(t,n,e.getRoot())},Up=function(e,t){var n=function(e){var t=function(e){return e.length>1&&"%"===e.charAt(0)};return J(["styles","attributes"],(function(n){return Oe(e,n).exists((function(e){var n=y(e)?e:Le(e);return J(n,t)}))}))};return J(e.formatter.get(t),n)},Vp=function(e,t,n){var r=["inline","block","selector","attributes","styles","classes"],i=function(e){return _e(e,(function(e,t){return J(r,(function(e){return e===t}))}))};return J(e.formatter.get(t),(function(t){var r=i(t);return J(e.formatter.get(n),(function(e){var t=i(e);return Pe(r,t)}))}))},Hp=function(e){return Ie(e,"block")},jp=function(e){return Ie(e,"selector")},qp=function(e){return Ie(e,"inline")},Gp=function(e){return jp(e)&&qp(e)&&ui(Oe(e,"mixed"),!0)},Wp=function(e){return jp(e)&&!1!==e.expand&&!qp(e)},Kp=xp,Yp=zp,Xp=Ip,Jp=Op,Qp=function(e){return ri(e)&&e.getAttribute("data-mce-bogus")&&!e.nextSibling},Zp=function(e,t){var n=t;while(n){if(Hr(n)&&e.getContentEditable(n))return"false"===e.getContentEditable(n)?n:t;n=n.parentNode}return t},eg=function(e,t,n,r){for(var i=t.data,o=n;e?o>=0:o<i.length;e?o--:o++)if(r(i.charAt(o)))return e?o+1:o;return-1},tg=function(e,t,n){return eg(e,t,n,(function(e){return Tp(e)||Dp(e)}))},ng=function(e,t,n){return eg(e,t,n,kp)},rg=function(e,t,n,r,i,o){var a,s=e.getParent(n,e.isBlock)||t,l=function(t,n,r){var o=Yc(e),l=i?o.backwards:o.forwards;return j.from(l(t,n,(function(e,t){return Kp(e.parentNode)?-1:(a=e,r(i,e,t))}),s))},u=l(n,r,tg);return u.bind((function(e){return o?l(e.container,e.offset+(i?-1:0),ng):j.some(e)})).orThunk((function(){return a?j.some({container:a,offset:i?0:a.length}):j.none()}))},ig=function(e,t,n,r,i){Zr(r)&&pt(r.data)&&r[i]&&(r=r[i]);for(var o=Yp(e,r),a=0;a<o.length;a++)for(var s=0;s<t.length;s++){var l=t[s];if((!T(l.collapsed)||l.collapsed===n.collapsed)&&(jp(l)&&e.is(o[a],l.selector)))return o[a]}return r},og=function(e,t,n,r){var i=n,o=e.dom,a=o.getRoot(),s=t[0];if(Hp(s)&&(i=s.wrapper?null:o.getParent(n,s.block,a)),!i){var l=o.getParent(n,"LI,TD,TH");i=o.getParent(Zr(n)?n.parentNode:n,(function(t){return t!==a&&Jp(e,t)}),l)}if(i&&Hp(s)&&s.wrapper&&(i=Yp(o,i,"ul,ol").reverse()[0]||i),!i){i=n;while(i[r]&&!o.isBlock(i[r]))if(i=i[r],Np(i,"br"))break}return i||n},ag=function(e,t,n,r){var i=n.parentNode;return!T(n[r])&&(!(i!==t&&!C(i)&&!e.isBlock(i))||ag(e,t,i,r))},sg=function(e,t,n,r,i){var o=n,a=i?"previousSibling":"nextSibling",s=e.getRoot();if(Zr(n)&&!Xp(n)&&(i?r>0:r<n.data.length))return n;while(1){if(!t[0].block_expand&&e.isBlock(o))return o;for(var l=o[a];l;l=l[a]){var u=Zr(l)&&!ag(e,s,l,a);if(!Kp(l)&&!Qp(l)&&!Xp(l,u))return o}if(o===s||o.parentNode===s){n=o;break}o=o.parentNode}return n},lg=function(e){return Kp(e.parentNode)||Kp(e)},ug=function(e,t,n,r){void 0===r&&(r=!1);var i=t.startContainer,o=t.startOffset,a=t.endContainer,s=t.endOffset,l=e.dom,u=n[0];if(Hr(i)&&i.hasChildNodes()&&(i=ad(i,o),Zr(i)&&(o=0)),Hr(a)&&a.hasChildNodes()&&(a=ad(a,t.collapsed?s:s-1),Zr(a)&&(s=a.nodeValue.length)),i=Zp(l,i),a=Zp(l,a),lg(i)&&(i=Kp(i)?i:i.parentNode,i=t.collapsed?i.previousSibling||i:i.nextSibling||i,Zr(i)&&(o=t.collapsed?i.length:0)),lg(a)&&(a=Kp(a)?a:a.parentNode,a=t.collapsed?a.nextSibling||a:a.previousSibling||a,Zr(a)&&(s=t.collapsed?0:a.length)),t.collapsed){var c=rg(l,e.getBody(),i,o,!0,r);c.each((function(e){var t=e.container,n=e.offset;i=t,o=n}));var d=rg(l,e.getBody(),a,s,!1,r);d.each((function(e){var t=e.container,n=e.offset;a=t,s=n}))}return(qp(u)||u.block_expand)&&(qp(u)&&Zr(i)&&0!==o||(i=sg(l,n,i,o,!0)),qp(u)&&Zr(a)&&s!==a.nodeValue.length||(a=sg(l,n,a,s,!1))),Wp(u)&&(i=ig(l,n,t,i,"previousSibling"),a=ig(l,n,t,a,"nextSibling")),(Hp(u)||jp(u))&&(i=og(e,n,i,"previousSibling"),a=og(e,n,a,"nextSibling"),Hp(u)&&(l.isBlock(i)||(i=sg(l,n,i,o,!0)),l.isBlock(a)||(a=sg(l,n,a,s,!1)))),Hr(i)&&(o=l.nodeIndex(i),i=i.parentNode),Hr(a)&&(s=l.nodeIndex(a)+1,a=a.parentNode),{startContainer:i,startOffset:o,endContainer:a,endOffset:s}},cg=function(e,t,n){var r=t.startOffset,i=ad(t.startContainer,r),o=t.endOffset,a=ad(t.endContainer,o-1),s=function(e){var t=e[0];Zr(t)&&t===i&&r>=t.data.length&&e.splice(0,1);var n=e[e.length-1];return 0===o&&e.length>0&&n===a&&Zr(n)&&e.splice(e.length-1,1),e},l=function(e,t,n){for(var r=[];e&&e!==n;e=e[t])r.push(e);return r},u=function(t,n){return e.getParent(t,(function(e){return e.parentNode===n}),n)},c=function(e,t,r){for(var i=r?"nextSibling":"previousSibling",o=e,a=o.parentNode;o&&o!==t;o=a){a=o.parentNode;var u=l(o===e?o:o[i],i);u.length&&(r||u.reverse(),n(s(u)))}};if(i===a)return n(s([i]));var d=e.findCommonAncestor(i,a);if(e.isChildOf(i,a))return c(i,d,!0);if(e.isChildOf(a,i))return c(a,d);var f=u(i,d)||i,h=u(a,d)||a;c(i,f,!0);var m=l(f===i?f:f.nextSibling,"nextSibling",h===a?h.nextSibling:h);m.length&&n(s(m)),c(a,h)},dg=function(e){var t=[];if(e)for(var n=0;n<e.rangeCount;n++)t.push(e.getRangeAt(n));return t},fg=function(e){return ue(e,(function(e){var t=od(e);return t?[wn.fromDom(t)]:[]}))},hg=function(e){return dg(e).length>1},mg=function(e){return ne(fg(e),oa)},pg=function(e){return Ec(e,"td[data-mce-selected],th[data-mce-selected]")},gg=function(e,t){var n=pg(t);return n.length>0?n:mg(e)},vg=function(e){return gg(dg(e.selection.getSel()),wn.fromDom(e.getBody()))},bg=function(e,t){return ko(e,"table",t)},yg=function(e){var t=e.startContainer,n=e.startOffset;return Zr(t)?0===n?j.some(wn.fromDom(t)):j.none():j.from(t.childNodes[n]).map(wn.fromDom)},wg=function(e){var t=e.endContainer,n=e.endOffset;return Zr(t)?n===t.data.length?j.some(wn.fromDom(t)):j.none():j.from(t.childNodes[n-1]).map(wn.fromDom)},Sg=function(e){return or(e).fold(L([e]),(function(t){return[e].concat(Sg(t))}))},xg=function(e){return ar(e).fold(L([e]),(function(t){return"br"===Fn(t)?Zn(t).map((function(t){return[e].concat(xg(t))})).getOr([]):[e].concat(xg(t))}))},Cg=function(e,t){return di(yg(t),wg(t),(function(t,n){var r=ae(Sg(e),I(In,t)),i=ae(xg(e),I(In,n));return r.isSome()&&i.isSome()})).getOr(!1)},Tg=function(e,t,n,r){var i=n,o=new zo(n,i),a=_e(e.schema.getMoveCaretBeforeOnEnterElements(),(function(e,t){return!X(["td","th","table"],t.toLowerCase())}));do{if(Zr(n)&&0!==mn.trim(n.nodeValue).length)return void(r?t.setStart(n,0):t.setEnd(n,n.nodeValue.length));if(a[n.nodeName])return void(r?t.setStartBefore(n):"BR"===n.nodeName?t.setEndBefore(n):t.setEndAfter(n))}while(n=r?o.next():o.prev());"BODY"===i.nodeName&&(r?t.setStart(i,0):t.setEnd(i,i.childNodes.length))},Dg=function(e){var t=e.selection.getSel();return t&&t.rangeCount>0},kg=function(e,t){var n=vg(e);n.length>0?Z(n,(function(n){var r=n.dom,i=e.dom.createRng();i.setStartBefore(r),i.setEndAfter(r),t(i,!0)})):t(e.selection.getRng(),!1)},Eg=function(e,t,n){var r=ff(e,t);n(r),e.moveToBookmark(r)},_g=function(e,t){var n=function(n){if(!e(n))throw new Error("Can only get "+t+" value of a "+t+" node");return r(n).getOr("")},r=function(t){return e(t)?j.from(t.dom.nodeValue):j.none()},i=function(n,r){if(!e(n))throw new Error("Can only set raw "+t+" value of a "+t+" node");n.dom.nodeValue=r};return{get:n,getOption:r,set:i}},Ag=_g(Vn,"text"),Lg=function(e){return Ag.get(e)},Og=function(e){return Vn(e)&&Lg(e)===fa},Rg=function(e,t,n,r){return Xn(t).fold((function(){return"skipping"}),(function(i){return"br"===r||Og(t)?"valid":Rc(t)?"existing":ep(t.dom)?"caret":Rp(e,n,r)&&Rp(e,Fn(i),n)?"valid":"invalid-child"}))},Ig=function(e,t){var n=ug(e,t,[{inline:"span"}]);t.setStart(n.startContainer,n.startOffset),t.setEnd(n.endContainer,n.endOffset),e.selection.setRng(t)},Pg=function(e,t,n,r){var i=t.uid,o=void 0===i?$c("mce-annotation"):i,a=qe(t,["uid"]),s=wn.fromTag("span",e);xc(s,_c()),gi(s,""+Lc(),o),gi(s,""+Ac(),n);var l=r(o,a),u=l.attributes,c=void 0===u?{}:u,d=l.classes,f=void 0===d?[]:d;return vi(s,c),zc(s,f),s},Mg=function(e,t,n,r,i){var o=[],a=Pg(e.getDoc(),i,n,r),s=fc(),l=function(){s.clear()},u=function(){return s.get().getOrThunk((function(){var e=Gc(a);return o.push(e),s.set(e),e}))},c=function(e){Z(e,d)},d=function(t){var n=Rg(e,t,"span",Fn(t));switch(n){case"invalid-child":l();var r=rr(t);c(r),l();break;case"valid":var i=u();xr(t,i);break}},f=function(e){var t=Q(e,wn.fromDom);c(t)};return cg(e.dom,t,(function(e){l(),f(e)})),o},Ng=function(e,t,n,r){e.undoManager.transact((function(){var i=e.selection,o=i.getRng(),a=vg(e).length>0;if(o.collapsed&&!a&&Ig(e,o),i.getRng().collapsed&&!a){var s=Pg(e.getDoc(),r,t,n.decorate);jc(s,ua),i.getRng().insertNode(s.dom),i.select(s.dom)}else Eg(i,!1,(function(){kg(e,(function(i){Mg(e,i,t,n.decorate,r)}))}))}))},Fg=function(e){var t=Fc();Nc(e,t);var n=Mc(e);return{register:function(e,n){t.register(e,n)},annotate:function(n,r){t.lookup(n).each((function(t){Ng(e,n,t,r)}))},annotationChanged:function(e,t){n.addListener(e,t)},remove:function(t){Oc(e,j.some(t)).each((function(e){var t=e.elements;Z(t,Er)}))},getAll:function(t){var n=Pc(e,t);return Ce(n,(function(e){return Q(e,(function(e){return e.dom}))}))}}},Bg=function(e){return{getBookmark:I(wp,e),moveToBookmark:I(Sp,e)}};Bg.isBookmarkNode=xp;var $g=function(e,t){while(t&&t!==e){if(oi(t)||ai(t))return t;t=t.parentNode}return null},zg=function(e,t,n){if(n.collapsed)return!1;if(en.browser.isIE()&&n.startOffset===n.endOffset-1&&n.startContainer===n.endContainer){var r=n.startContainer.childNodes[n.startOffset];if(Hr(r))return J(r.getClientRects(),(function(n){return rd(n,e,t)}))}return J(n.getClientRects(),(function(n){return rd(n,e,t)}))},Ug=function(e,t){return e.fire("PreProcess",t)},Vg=function(e,t){return e.fire("PostProcess",t)},Hg=function(e){return e.fire("remove")},jg=function(e){return e.fire("detach")},qg=function(e,t){return e.fire("SwitchMode",{mode:t})},Gg=function(e,t,n,r,i){e.fire("ObjectResizeStart",{target:t,width:n,height:r,origin:i})},Wg=function(e,t,n,r,i){e.fire("ObjectResized",{target:t,width:n,height:r,origin:i})},Kg=function(e){return e.fire("PreInit")},Yg=function(e){return e.fire("PostRender")},Xg=function(e){return e.fire("Init")},Jg=function(e,t){return e.fire("PlaceholderToggle",{state:t})},Qg=function(e,t,n){return e.fire(t,n)},Zg=function(e,t,n,r){return e.fire("FormatApply",{format:t,node:n,vars:r})},ev=function(e,t,n,r){return e.fire("FormatRemove",{format:t,node:n,vars:r})},tv={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,ESC:27,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,modifierPressed:function(e){return e.shiftKey||e.ctrlKey||e.altKey||tv.metaKeyPressed(e)},metaKeyPressed:function(e){return en.mac?e.metaKey:e.ctrlKey&&!e.altKey}},nv=ai,rv=function(e,t){var n,r,i,o,a,s,l,u,c,d,f,h,m,p,g,v,b,y="data-mce-selected",w=t.dom,S=mn.each,x=t.getDoc(),C=document,D=Math.abs,k=Math.round,E=t.getBody(),_={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]},A=function(e){return e&&("IMG"===e.nodeName||t.dom.is(e,"figure.image"))},L=function(e){return li(e)||w.hasClass(e,"mce-preview-object")},O=function(e,t){if("longpress"===e.type||0===e.type.indexOf("touch")){var n=e.touches[0];return A(e.target)&&!zg(n.clientX,n.clientY,t)}return A(e.target)&&!zg(e.clientX,e.clientY,t)},R=function(e){var n=e.target;O(e,t.selection.getRng())&&!e.isDefaultPrevented()&&t.selection.select(n)},I=function(e){return w.is(e,"figure.image")?[e.querySelector("img")]:w.hasClass(e,"mce-preview-object")&&T(e.firstElementChild)?[e,e.firstElementChild]:[e]},P=function(e){var n=Zf(t);return!!n&&("false"!==e.getAttribute("data-mce-resize")&&(e!==t.getBody()&&(w.hasClass(e,"mce-preview-object")?An(wn.fromDom(e.firstElementChild),n):An(wn.fromDom(e),n))))},M=function(e){return L(e)?w.create("img",{src:en.transparentSrc}):e.cloneNode(!0)},N=function(e,n,r){if(T(r)){var i=I(e);Z(i,(function(e){e.style[n]||!t.schema.isValid(e.nodeName.toLowerCase(),n)?w.setStyle(e,n,r):w.setAttrib(e,n,""+r)}))}},F=function(e,t,n){N(e,"width",t),N(e,"height",n)},B=function(e){var a,y,S,x,C;a=e.screenX-s,y=e.screenY-l,p=a*o[2]+d,g=y*o[3]+f,p=p<5?5:p,g=g<5?5:g,S=(A(n)||L(n))&&!1!==eh(t)?!tv.modifierPressed(e):tv.modifierPressed(e),S&&(D(a)>D(y)?(g=k(p*h),p=k(g/h)):(p=k(g/h),g=k(p*h))),F(r,p,g),x=o.startPos.x+a,C=o.startPos.y+y,x=x>0?x:0,C=C>0?C:0,w.setStyles(i,{left:x,top:C,display:"block"}),i.innerHTML=p+" &times; "+g,o[2]<0&&r.clientWidth<=p&&w.setStyle(r,"left",u+(d-p)),o[3]<0&&r.clientHeight<=g&&w.setStyle(r,"top",c+(f-g)),a=E.scrollWidth-v,y=E.scrollHeight-b,a+y!==0&&w.setStyles(i,{left:x-a,top:C-y}),m||(Gg(t,n,d,f,"corner-"+o.name),m=!0)},$=function(){var e=m;m=!1,e&&(N(n,"width",p),N(n,"height",g)),w.unbind(x,"mousemove",B),w.unbind(x,"mouseup",$),C!==x&&(w.unbind(C,"mousemove",B),w.unbind(C,"mouseup",$)),w.remove(r),w.remove(i),w.remove(a),z(n),e&&(Wg(t,n,p,g,"corner-"+o.name),w.setAttrib(n,"style",w.getAttrib(n,"style"))),t.nodeChanged()},z=function(e){j();var u=w.getPos(e,E),c=u.x,m=u.y,T=e.getBoundingClientRect(),D=T.width||T.right-T.left,k=T.height||T.bottom-T.top;n!==e&&(U(),n=e,p=g=0);var A=t.fire("ObjectSelected",{target:e}),L=w.getAttrib(n,y,"1");P(e)&&!A.isDefaultPrevented()?S(_,(function(e,t){var u,p=function(u){var p=I(n)[0];s=u.screenX,l=u.screenY,d=p.clientWidth,f=p.clientHeight,h=f/d,o=e,o.name=t,o.startPos={x:D*e[0]+c,y:k*e[1]+m},v=E.scrollWidth,b=E.scrollHeight,a=w.add(E,"div",{class:"mce-resize-backdrop","data-mce-bogus":"all"}),w.setStyles(a,{position:"fixed",left:"0",top:"0",width:"100%",height:"100%"}),r=M(n),w.addClass(r,"mce-clonedresizable"),w.setAttrib(r,"data-mce-bogus","all"),r.contentEditable="false",w.setStyles(r,{left:c,top:m,margin:0}),F(r,D,k),r.removeAttribute(y),E.appendChild(r),w.bind(x,"mousemove",B),w.bind(x,"mouseup",$),C!==x&&(w.bind(C,"mousemove",B),w.bind(C,"mouseup",$)),i=w.add(E,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},d+" &times; "+f)};u=w.get("mceResizeHandle"+t),u&&w.remove(u),u=w.add(E,"div",{id:"mceResizeHandle"+t,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:!0,style:"cursor:"+t+"-resize; margin:0; padding:0"}),11===en.ie&&(u.contentEditable=!1),w.bind(u,"mousedown",(function(e){e.stopImmediatePropagation(),e.preventDefault(),p(e)})),e.elm=u,w.setStyles(u,{left:D*e[0]+c-u.offsetWidth/2,top:k*e[1]+m-u.offsetHeight/2})})):U(),w.getAttrib(n,y)||n.setAttribute(y,L)},U=function(){j(),n&&n.removeAttribute(y),xe(_,(function(e,t){var n=w.get("mceResizeHandle"+t);n&&(w.unbind(n),w.remove(n))}))},V=function(n){var r,i,o=function(e,t){if(e)do{if(e===t)return!0}while(e=e.parentNode)};m||t.removed||(S(w.select("img[data-mce-selected],hr[data-mce-selected]"),(function(e){e.removeAttribute(y)})),i="mousedown"===n.type?n.target:e.getNode(),i=w.$(i).closest("table,img,figure.image,hr,video,span.mce-preview-object")[0],o(i,E)&&(q(),r=e.getStart(!0),o(r,i)&&o(e.getEnd(!0),i))?z(i):U())},H=function(e){return nv($g(t.getBody(),e))},j=function(){xe(_,(function(e){e.elm&&(w.unbind(e.elm),delete e.elm)}))},q=function(){try{t.getDoc().execCommand("enableObjectResizing",!1,"false")}catch(e){}};t.on("init",(function(){if(q(),en.browser.isIE()||en.browser.isEdge()){t.on("mousedown click",(function(e){var n=e.target,r=n.nodeName;m||!/^(TABLE|IMG|HR)$/.test(r)||H(n)||(2!==e.button&&t.selection.select(n,"TABLE"===r),"mousedown"===e.type&&t.nodeChanged())}));var e=function(e){var n=function(e){No.setEditorTimeout(t,(function(){return t.selection.select(e)}))};if(H(e.target)||li(e.target))return e.preventDefault(),void n(e.target);/^(TABLE|IMG|HR)$/.test(e.target.nodeName)&&(e.preventDefault(),"IMG"===e.target.tagName&&n(e.target))};w.bind(E,"mscontrolselect",e),t.on("remove",(function(){return w.unbind(E,"mscontrolselect",e)}))}var r=No.throttle((function(e){t.composing||V(e)}));t.on("NodeChange ResizeEditor ResizeWindow ResizeContent drop",r),t.on("keyup compositionend",(function(e){n&&"TABLE"===n.nodeName&&r(e)})),t.on("hide blur",U),t.on("contextmenu longpress",R,!0)})),t.on("remove",j);var G=function(){n=r=a=null};return{isResizable:P,showResizeRect:z,hideResizeRect:U,updateResizeRect:V,destroy:G}},iv=function(e){return oi(e)||ai(e)},ov=function(e,t,n){while(e&&e!==t){if(n(e))return e;e=e.parentNode}return null},av=function(e,t,n){var r,i=n.elementFromPoint(e,t),o=n.body.createTextRange();if(i&&"HTML"!==i.tagName||(i=n.body),o.moveToElementText(i),r=mn.toArray(o.getClientRects()),r=r.sort((function(e,n){return e=Math.abs(Math.max(e.top-t,e.bottom-t)),n=Math.abs(Math.max(n.top-t,n.bottom-t)),e-n})),r.length>0){t=(r[0].bottom+r[0].top)/2;try{return o.moveToPoint(e,t),o.collapse(!0),o}catch(a){}}return null},sv=function(e,t){var n=e&&e.parentElement?e.parentElement():null;return ai(ov(n,t,iv))?null:e},lv=function(e,t,n){var r,i,o=n;if(o.caretPositionFromPoint)i=o.caretPositionFromPoint(e,t),i&&(r=n.createRange(),r.setStart(i.offsetNode,i.offset),r.collapse(!0));else if(o.caretRangeFromPoint)r=o.caretRangeFromPoint(e,t);else if(o.body.createTextRange){r=o.body.createTextRange();try{r.moveToPoint(e,t),r.collapse(!0)}catch(a){r=av(e,t,n)}return sv(r,n.body)}return r},uv=function(e,t){return e&&t&&e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset},cv=function(e,t,n){while(e&&e!==t){if(n(e))return e;e=e.parentNode}return null},dv=function(e,t,n){return null!==cv(e,t,n)},fv=function(e,t,n){return dv(e,t,(function(e){return e.nodeName===n}))},hv=function(e){return e&&"TABLE"===e.nodeName},mv=function(e){return e&&/^(TD|TH|CAPTION)$/.test(e.nodeName)},pv=function(e,t){return ya(e)&&!1===dv(e,t,ep)},gv=function(e,t,n){var r=new zo(t,e.getParent(t.parentNode,e.isBlock)||e.getRoot());while(t=r[n?"prev":"next"]())if(ri(t))return!0},vv=function(e,t){return e.previousSibling&&e.previousSibling.nodeName===t},bv=function(e,t){while(t&&t!==e){if(ai(t))return!0;t=t.parentNode}return!1},yv=function(e,t,n,r,i){var o,a,s=e.getRoot(),l=e.schema.getNonEmptyElements(),u=e.getParent(i.parentNode,e.isBlock)||s;if(r&&ri(i)&&t&&e.isEmpty(u))return j.some(Rd(i.parentNode,e.nodeIndex(i)));var c=new zo(i,u);while(a=c[r?"prev":"next"]()){if("false"===e.getContentEditableParent(a)||pv(a,s))return j.none();if(Zr(a)&&a.nodeValue.length>0)return!1===fv(a,s,"A")?j.some(Rd(a,r?a.nodeValue.length:0)):j.none();if(e.isBlock(a)||l[a.nodeName.toLowerCase()])return j.none();o=a}return n&&o?j.some(Rd(o,0)):j.none()},wv=function(e,t,n,r){var i,o,a,s,l=e.getRoot(),u=!1;i=r[(n?"start":"end")+"Container"],o=r[(n?"start":"end")+"Offset"];var c=Hr(i)&&o===i.childNodes.length,d=e.schema.getNonEmptyElements();if(s=n,ya(i))return j.none();if(Hr(i)&&o>i.childNodes.length-1&&(s=!1),ti(i)&&(i=l,o=0),i===l){if(s&&(a=i.childNodes[o>0?o-1:0],a)){if(ya(a))return j.none();if(d[a.nodeName]||hv(a))return j.none()}if(i.hasChildNodes()){if(o=Math.min(!s&&o>0?o-1:o,i.childNodes.length-1),i=i.childNodes[o],o=Zr(i)&&c?i.data.length:0,!t&&i===l.lastChild&&hv(i))return j.none();if(bv(l,i)||ya(i))return j.none();if(i.hasChildNodes()&&!1===hv(i)){a=i;var f=new zo(i,l);do{if(ai(a)||ya(a)){u=!1;break}if(Zr(a)&&a.nodeValue.length>0){o=s?0:a.nodeValue.length,i=a,u=!0;break}if(d[a.nodeName.toLowerCase()]&&!mv(a)){o=e.nodeIndex(a),i=a.parentNode,s||o++,u=!0;break}}while(a=s?f.next():f.prev())}}}return t&&(Zr(i)&&0===o&&yv(e,c,t,!0,i).each((function(e){i=e.container(),o=e.offset(),u=!0})),Hr(i)&&(a=i.childNodes[o],a||(a=i.childNodes[o-1]),!a||!ri(a)||vv(a,"A")||gv(e,a,!1)||gv(e,a,!0)||yv(e,c,t,!0,a).each((function(e){i=e.container(),o=e.offset(),u=!0})))),s&&!t&&Zr(i)&&o===i.nodeValue.length&&yv(e,c,t,!1,i).each((function(e){i=e.container(),o=e.offset(),u=!0})),u?j.some(Rd(i,o)):j.none()},Sv=function(e,t){var n=t.collapsed,r=t.cloneRange(),i=Rd.fromRangeStart(t);return wv(e,n,!0,r).each((function(e){n&&Rd.isAbove(i,e)||r.setStart(e.container(),e.offset())})),n||wv(e,n,!1,r).each((function(e){r.setEnd(e.container(),e.offset())})),n&&r.collapse(!0),uv(t,r)?j.none():j.some(r)},xv=function(e,t){return e.splitText(t)},Cv=function(e){var t=e.startContainer,n=e.startOffset,r=e.endContainer,i=e.endOffset;return t===r&&Zr(t)?n>0&&n<t.nodeValue.length&&(r=xv(t,n),t=r.previousSibling,i>n?(i-=n,t=r=xv(r,i).previousSibling,i=r.nodeValue.length,n=0):i=0):(Zr(t)&&n>0&&n<t.nodeValue.length&&(t=xv(t,n),n=0),Zr(r)&&i>0&&i<r.nodeValue.length&&(r=xv(r,i).previousSibling,i=r.nodeValue.length)),{startContainer:t,startOffset:n,endContainer:r,endOffset:i}},Tv=function(e){var t=function(t,n){return cg(e,t,n)},n=Cv,r=function(t){return Sv(e,t).fold(B,(function(e){return t.setStart(e.startContainer,e.startOffset),t.setEnd(e.endContainer,e.endOffset),!0}))};return{walk:t,split:n,normalize:r}};Tv.compareRanges=uv,Tv.getCaretRangeFromPoint=lv,Tv.getSelectedNode=od,Tv.getNode=ad;var Dv,kv=function(e,t){var n=function(t,n){if(!k(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);var r=t.dom;mi(r)&&(r.style[e]=n+"px")},r=function(n){var r=t(n);if(r<=0||null===r){var i=Di(n,e);return parseFloat(i)||0}return r},i=r,o=function(e,t){return ie(t,(function(t,n){var r=Di(e,n),i=void 0===r?0:parseInt(r,10);return isNaN(i)?t:t+i}),0)},a=function(e,t,n){var r=o(e,n),i=t>r?t-r:0;return i};return{set:n,get:r,getOuter:i,aggregate:o,max:a}},Ev=kv("height",(function(e){var t=e.dom;return _r(e)?t.getBoundingClientRect().height:t.offsetHeight})),_v=function(e){return Ev.get(e)},Av=function(e,t){var n=e.view(t);return n.fold(L([]),(function(t){var n=e.owner(t),r=Av(e,n);return[t].concat(r)}))},Lv=function(e,t){var n=t.owner(e);return Av(t,n)},Ov=function(e){var t,n=e.dom===document?j.none():j.from(null===(t=e.dom.defaultView)||void 0===t?void 0:t.frameElement);return n.map(wn.fromDom)},Rv=function(e){return Wn(e)},Iv=Object.freeze({__proto__:null,view:Ov,owner:Rv}),Pv=function(e){var t=wn.fromDom(document),n=Mr(t),r=Lv(e,Iv),i=Pr(e),o=re(r,(function(e,t){var n=Pr(t);return{left:e.left+n.left,top:e.top+n.top}}),{left:0,top:0});return Lr(o.left+i.left+n.left,o.top+i.top+n.top)},Mv=function(e){return"textarea"===Fn(e)},Nv=function(e,t){var n=e.fire("ScrollIntoView",t);return n.isDefaultPrevented()},Fv=function(e,t){e.fire("AfterScrollIntoView",t)},Bv=function(e,t){var n=rr(e);if(0===n.length||Mv(e))return{element:e,offset:t};if(t<n.length&&!Mv(n[t]))return{element:n[t],offset:0};var r=n[n.length-1];return Mv(r)?{element:e,offset:t}:"img"===Fn(r)?{element:r,offset:1}:Vn(r)?{element:r,offset:Lg(r).length}:{element:r,offset:rr(r).length}},$v=function(e,t){var n=Ir(e),r=_v(e);return{element:e,bottom:n.top+r,height:r,pos:n,cleanup:t}},zv=function(e,t){var n=Bv(e,t),r=wn.fromHtml('<span data-mce-bogus="all" style="display: inline-block;">'+fa+"</span>");return br(n.element,r),$v(r,(function(){return kr(r)}))},Uv=function(e){return $v(wn.fromDom(e),E)},Vv=function(e,t,n,r){Gv(e,(function(i,o){return jv(e,t,n,r)}),n)},Hv=function(e,t,n,r,i){var o={elm:r.element.dom,alignToTop:i};if(!Nv(e,o)){var a=Mr(t).top;n(t,a,r,i),Fv(e,o)}},jv=function(e,t,n,r){var i=wn.fromDom(e.getBody()),o=wn.fromDom(e.getDoc());Ai(i);var a=zv(wn.fromDom(n.startContainer),n.startOffset);Hv(e,o,t,a,r),a.cleanup()},qv=function(e,t,n,r){var i=wn.fromDom(e.getDoc());Hv(e,i,n,Uv(t),r)},Gv=function(e,t,n){var r=n.startContainer,i=n.startOffset,o=n.endContainer,a=n.endOffset;t(wn.fromDom(r),wn.fromDom(o));var s=e.dom.createRng();s.setStart(r,i),s.setEnd(o,a),e.selection.setRng(n)},Wv=function(e,t,n,r){var i=e.pos;if(n)Nr(i.left,i.top,r);else{var o=i.top-t+e.height;Nr(i.left,o,r)}},Kv=function(e,t,n,r,i){var o=n+t,a=r.pos.top,s=r.bottom,l=s-a>=n;if(a<t)Wv(r,n,!1!==i,e);else if(a>o){var u=l?!1!==i:!0===i;Wv(r,n,u,e)}else s>o&&!l&&Wv(r,n,!0===i,e)},Yv=function(e,t,n,r){var i=e.dom.defaultView.innerHeight;Kv(e,t,i,n,r)},Xv=function(e,t,n,r){var i=e.dom.defaultView.innerHeight;Kv(e,t,i,n,r);var o=Pv(n.element),a=zr(window);o.top<a.y?Fr(n.element,!1!==r):o.top>a.bottom&&Fr(n.element,!0===r)},Jv=function(e,t,n){return Vv(e,Yv,t,n)},Qv=function(e,t,n){return qv(e,t,Yv,n)},Zv=function(e,t,n){return Vv(e,Xv,t,n)},eb=function(e,t,n){return qv(e,t,Xv,n)},tb=function(e,t,n){var r=e.inline?Qv:eb;r(e,t,n)},nb=function(e,t,n){var r=e.inline?Jv:Zv;r(e,t,n)},rb=function(){return wn.fromDom(document)},ib=function(e){return e.dom.focus()},ob=function(e){var t=fr(e).dom;return e.dom===t.activeElement},ab=function(e){return void 0===e&&(e=rb()),j.from(e.dom.activeElement).map(wn.fromDom)},sb=function(e){return ab(fr(e)).filter((function(t){return e.dom.contains(t.dom)}))},lb=function(e,t,n,r){return{start:e,soffset:t,finish:n,foffset:r}},ub={create:lb},cb=Zi.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),db=function(e,t,n,r){return e.fold(t,n,r)},fb=function(e){return e.fold(O,O,O)},hb=cb.before,mb=cb.on,pb=cb.after,gb={before:hb,on:mb,after:pb,cata:db,getStart:fb},vb=Zi.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),bb=function(e){return vb.exact(e.start,e.soffset,e.finish,e.foffset)},yb=function(e){return e.match({domRange:function(e){return wn.fromDom(e.startContainer)},relative:function(e,t){return gb.getStart(e)},exact:function(e,t,n,r){return e}})},wb=vb.domRange,Sb=vb.relative,xb=vb.exact,Cb=function(e){var t=yb(e);return Yn(t)},Tb=ub.create,Db={domRange:wb,relative:Sb,exact:xb,exactFromRange:bb,getWin:Cb,range:Tb},kb=qt().browser,Eb=function(e,t){var n=Vn(t)?Lg(t).length:rr(t).length+1;return e>n?n:e<0?0:e},_b=function(e){return Db.range(e.start,Eb(e.soffset,e.start),e.finish,Eb(e.foffset,e.finish))},Ab=function(e,t){return!Vr(t.dom)&&(Nn(e,t)||In(e,t))},Lb=function(e){return function(t){return Ab(e,t.start)&&Ab(e,t.finish)}},Ob=function(e){return!0===e.inline||kb.isIE()},Rb=function(e){return Db.range(wn.fromDom(e.startContainer),e.startOffset,wn.fromDom(e.endContainer),e.endOffset)},Ib=function(e){var t=e.getSelection(),n=t&&0!==t.rangeCount?j.from(t.getRangeAt(0)):j.none();return n.map(Rb)},Pb=function(e){var t=Yn(e);return Ib(t.dom).filter(Lb(e))},Mb=function(e,t){return j.from(t).filter(Lb(e)).map(_b)},Nb=function(e){var t=document.createRange();try{return t.setStart(e.start.dom,e.soffset),t.setEnd(e.finish.dom,e.foffset),j.some(t)}catch(n){return j.none()}},Fb=function(e){var t=Ob(e)?Pb(wn.fromDom(e.getBody())):j.none();e.bookmark=t.isSome()?t:e.bookmark},Bb=function(e,t){var n=wn.fromDom(e.getBody()),r=Ob(e)?j.from(t):j.none(),i=r.map(Rb).filter(Lb(n));e.bookmark=i.isSome()?i:e.bookmark},$b=function(e){var t=e.bookmark?e.bookmark:j.none();return t.bind((function(t){return Mb(wn.fromDom(e.getBody()),t)})).bind(Nb)},zb=function(e){$b(e).each((function(t){return e.selection.setRng(t)}))},Ub=function(e){var t=e.className.toString();return-1!==t.indexOf("tox-")||-1!==t.indexOf("mce-")},Vb={isEditorUIElement:Ub},Hb=function(e){return"nodechange"===e.type&&e.selectionChange},jb=function(e,t){var n=function(){t.throttle()};Uu.DOM.bind(document,"mouseup",n),e.on("remove",(function(){Uu.DOM.unbind(document,"mouseup",n)}))},qb=function(e){e.on("focusout",(function(){Fb(e)}))},Gb=function(e,t){e.on("mouseup touchend",(function(e){t.throttle()}))},Wb=function(e,t){var n=qt().browser;n.isIE()?qb(e):Gb(e,t),e.on("keyup NodeChange",(function(t){Hb(t)||Fb(e)}))},Kb=function(e){var t=hc((function(){Fb(e)}),0);e.on("init",(function(){e.inline&&jb(e,t),Wb(e,t)})),e.on("remove",(function(){t.cancel()}))},Yb=Uu.DOM,Xb=function(e){return Vb.isEditorUIElement(e)},Jb=function(e){var t=e.classList;return void 0!==t&&(t.contains("tox-edit-area")||t.contains("tox-edit-area__iframe")||t.contains("mce-content-body"))},Qb=function(e,t){var n=ch(e),r=Yb.getParent(t,(function(t){return Xb(t)||!!n&&e.dom.is(t,n)}));return null!==r},Zb=function(e){try{var t=fr(wn.fromDom(e.getElement()));return ab(t).fold((function(){return document.body}),(function(e){return e.dom}))}catch(n){return document.body}},ey=function(e,t){var n=t.editor;Kb(n),n.on("focusin",(function(){var t=e.focusedEditor;t!==n&&(t&&t.fire("blur",{focusedEditor:n}),e.setActive(n),e.focusedEditor=n,n.fire("focus",{blurredEditor:t}),n.focus(!0))})),n.on("focusout",(function(){No.setEditorTimeout(n,(function(){var t=e.focusedEditor;Qb(n,Zb(n))||t!==n||(n.fire("blur",{focusedEditor:null}),e.focusedEditor=null)}))})),Dv||(Dv=function(t){var n=e.activeEditor;n&&gr(t).each((function(t){t.ownerDocument===document&&(t===document.body||Qb(n,t)||e.focusedEditor!==n||(n.fire("blur",{focusedEditor:null}),e.focusedEditor=null))}))},Yb.bind(document,"focusin",Dv))},ty=function(e,t){e.focusedEditor===t.editor&&(e.focusedEditor=null),e.activeEditor||(Yb.unbind(document,"focusin",Dv),Dv=null)},ny=function(e){e.on("AddEditor",I(ey,e)),e.on("RemoveEditor",I(ty,e))},ry=function(e,t){return e.dom.getParent(t,(function(t){return"true"===e.dom.getContentEditable(t)}))},iy=function(e){return e.collapsed?j.from(ad(e.startContainer,e.startOffset)).map(wn.fromDom):j.none()},oy=function(e,t){return iy(t).bind((function(t){return ia(t)?j.some(t):!1===Nn(e,t)?j.some(e):j.none()}))},ay=function(e,t){oy(wn.fromDom(e.getBody()),t).bind((function(e){return Jm(e.dom)})).fold((function(){e.selection.normalize()}),(function(t){return e.selection.setRng(t.toRange())}))},sy=function(e){if(e.setActive)try{e.setActive()}catch(t){e.focus()}else e.focus()},ly=function(e){return ob(e)||sb(e).isSome()},uy=function(e){return e.iframeElement&&ob(wn.fromDom(e.iframeElement))},cy=function(e){var t=e.getBody();return t&&ly(wn.fromDom(t))},dy=function(e){var t=fr(wn.fromDom(e.getElement()));return ab(t).filter((function(t){return!Jb(t.dom)&&Qb(e,t.dom)})).isSome()},fy=function(e){return e.inline?cy(e):uy(e)},hy=function(e){return fy(e)||dy(e)},my=function(e){var t=e.selection,n=e.getBody(),r=t.getRng();e.quirks.refreshContentEditable(),void 0!==e.bookmark&&!1===fy(e)&&$b(e).each((function(t){e.selection.setRng(t),r=t}));var i=ry(e,t.getNode());if(e.$.contains(n,i))return sy(i),ay(e,r),void py(e);e.inline||(en.opera||sy(n),e.getWin().focus()),(en.gecko||e.inline)&&(sy(n),ay(e,r)),py(e)},py=function(e){return e.editorManager.setActive(e)},gy=function(e,t){e.removed||(t?py(e):my(e))},vy=function(e,t,n,r,i){var o=n?t.startContainer:t.endContainer,a=n?t.startOffset:t.endOffset;return j.from(o).map(wn.fromDom).map((function(e){return r&&t.collapsed?e:ir(e,i(e,a)).getOr(e)})).bind((function(e){return Un(e)?j.some(e):Xn(e).filter(Un)})).map((function(e){return e.dom})).getOr(e)},by=function(e,t,n){return vy(e,t,!0,n,(function(e,t){return Math.min(sr(e),t)}))},yy=function(e,t,n){return vy(e,t,!1,n,(function(e,t){return t>0?t-1:t}))},wy=function(e,t){var n=e;while(e&&Zr(e)&&0===e.length)e=t?e.nextSibling:e.previousSibling;return e||n},Sy=function(e,t){var n,r,i;if(!t)return e;r=t.startContainer,i=t.endContainer;var o=t.startOffset,a=t.endOffset;return n=t.commonAncestorContainer,!t.collapsed&&(r===i&&a-o<2&&r.hasChildNodes()&&(n=r.childNodes[o]),3===r.nodeType&&3===i.nodeType&&(r=r.length===o?wy(r.nextSibling,!0):r.parentNode,i=0===a?wy(i.previousSibling,!1):i.parentNode,r&&r===i))?r:n&&3===n.nodeType?n.parentNode:n},xy=function(e,t,n,r){var i,o=[],a=e.getRoot();if(n=e.getParent(n||by(a,t,t.collapsed),e.isBlock),r=e.getParent(r||yy(a,t,t.collapsed),e.isBlock),n&&n!==a&&o.push(n),n&&r&&n!==r){i=n;var s=new zo(n,a);while((i=s.next())&&i!==r)e.isBlock(i)&&o.push(i)}return r&&n!==r&&r!==a&&o.push(r),o},Cy=function(e,t,n){return j.from(t).map((function(t){var r=e.nodeIndex(t),i=e.createRng();return i.setStart(t.parentNode,r),i.setEnd(t.parentNode,r+1),n&&(Tg(e,i,t,!0),Tg(e,i,t,!1)),i}))},Ty=function(e,t){return Q(t,(function(t){var n=e.fire("GetSelectionRange",{range:t});return n.range!==t?n.range:t}))},Dy={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},ky=function(e,t,n){var r=n?"lastChild":"firstChild",i=n?"prev":"next";if(e[r])return e[r];if(e!==t){var o=e[i];if(o)return o;for(var a=e.parent;a&&a!==t;a=a.parent)if(o=a[i],o)return o}},Ey=function(e){if(!Wa(e.value))return!1;var t=e.parent;return!t||"span"===t.name&&!t.attr("style")||!/^[ ]+$/.test(e.value)},_y=function(e){var t="a"===e.name&&!e.attr("href")&&e.attr("id");return e.attr("name")||e.attr("id")&&!e.firstChild||e.attr("data-mce-bookmark")||t},Ay=function(){function e(e,t){this.name=e,this.type=t,1===t&&(this.attributes=[],this.attributes.map={})}return e.create=function(t,n){var r=new e(t,Dy[t]||1);return n&&xe(n,(function(e,t){r.attr(t,e)})),r},e.prototype.replace=function(e){var t=this;return e.parent&&e.remove(),t.insert(e,t),t.remove(),t},e.prototype.attr=function(e,t){var n,r=this;if("string"!==typeof e)return void 0!==e&&null!==e&&xe(e,(function(e,t){r.attr(t,e)})),r;if(n=r.attributes){if(void 0!==t){if(null===t){if(e in n.map){delete n.map[e];var i=n.length;while(i--)if(n[i].name===e)return n.splice(i,1),r}return r}if(e in n.map){i=n.length;while(i--)if(n[i].name===e){n[i].value=t;break}}else n.push({name:e,value:t});return n.map[e]=t,r}return n.map[e]}},e.prototype.clone=function(){var t,n=this,r=new e(n.name,n.type);if(t=n.attributes){var i=[];i.map={};for(var o=0,a=t.length;o<a;o++){var s=t[o];"id"!==s.name&&(i[i.length]={name:s.name,value:s.value},i.map[s.name]=s.value)}r.attributes=i}return r.value=n.value,r.shortEnded=n.shortEnded,r},e.prototype.wrap=function(e){var t=this;return t.parent.insert(e,t),e.append(t),t},e.prototype.unwrap=function(){for(var e=this,t=e.firstChild;t;){var n=t.next;e.insert(t,e,!0),t=n}e.remove()},e.prototype.remove=function(){var e=this,t=e.parent,n=e.next,r=e.prev;return t&&(t.firstChild===e?(t.firstChild=n,n&&(n.prev=null)):r.next=n,t.lastChild===e?(t.lastChild=r,r&&(r.next=null)):n.prev=r,e.parent=e.next=e.prev=null),e},e.prototype.append=function(e){var t=this;e.parent&&e.remove();var n=t.lastChild;return n?(n.next=e,e.prev=n,t.lastChild=e):t.lastChild=t.firstChild=e,e.parent=t,e},e.prototype.insert=function(e,t,n){e.parent&&e.remove();var r=t.parent||this;return n?(t===r.firstChild?r.firstChild=e:t.prev.next=e,e.prev=t.prev,e.next=t,t.prev=e):(t===r.lastChild?r.lastChild=e:t.next.prev=e,e.next=t.next,e.prev=t,t.next=e),e.parent=r,e},e.prototype.getAll=function(e){for(var t=this,n=[],r=t.firstChild;r;r=ky(r,t))r.name===e&&n.push(r);return n},e.prototype.children=function(){for(var e=this,t=[],n=e.firstChild;n;n=n.next)t.push(n);return t},e.prototype.empty=function(){var e=this;if(e.firstChild){for(var t=[],n=e.firstChild;n;n=ky(n,e))t.push(n);var r=t.length;while(r--){n=t[r];n.parent=n.firstChild=n.lastChild=n.next=n.prev=null}}return e.firstChild=e.lastChild=null,e},e.prototype.isEmpty=function(e,t,n){void 0===t&&(t={});var r=this,i=r.firstChild;if(_y(r))return!1;if(i)do{if(1===i.type){if(i.attr("data-mce-bogus"))continue;if(e[i.name])return!1;if(_y(i))return!1}if(8===i.type)return!1;if(3===i.type&&!Ey(i))return!1;if(3===i.type&&i.parent&&t[i.parent.name]&&Wa(i.value))return!1;if(n&&n(i))return!1}while(i=ky(i,r));return!0},e.prototype.walk=function(e){return ky(this,null,e)},e}(),Ly=mn.makeMap("NOSCRIPT STYLE SCRIPT XMP IFRAME NOEMBED NOFRAMES PLAINTEXT"," "),Oy=function(e){return v(e.nodeValue)&&lt(e.nodeValue,fa)},Ry=function(e){return(0===e.length?"":Q(e,(function(e){return"["+e+"]"})).join(",")+",")+'[data-mce-bogus="all"]'},Iy=function(e,t){return t.querySelectorAll(Ry(e))},Py=function(e,t,n){return document.createTreeWalker(e,t,n,!1)},My=function(e){return Py(e,NodeFilter.SHOW_COMMENT,(function(e){return Oy(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}))},Ny=function(e){return Py(e,NodeFilter.SHOW_TEXT,(function(e){if(Oy(e)){var t=e.parentNode;return t&&Re(Ly,t.nodeName)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}return NodeFilter.FILTER_SKIP}))},Fy=function(e){return null!==My(e).nextNode()},By=function(e){return null!==Ny(e).nextNode()},$y=function(e,t){return null!==t.querySelector(Ry(e))},zy=function(e,t){Z(Iy(e,t),(function(t){var n=wn.fromDom(t);"all"===bi(n,"data-mce-bogus")?kr(n):Z(e,(function(e){wi(n,e)&&Si(n,e)}))}))},Uy=function(e){var t=e.nextNode();while(null!==t)t.nodeValue=null,t=e.nextNode()},Vy=_(Uy,My),Hy=_(Uy,Ny),jy=function(e,t){var n=[{condition:I($y,t),action:I(zy,t)},{condition:Fy,action:Vy},{condition:By,action:Hy}],r=e,i=!1;return Z(n,(function(t){var n=t.condition,o=t.action;n(r)&&(i||(r=e.cloneNode(!0),i=!0),o(r))})),r},qy=function(e,t){var n=Df(e),r=new RegExp("^(<"+n+"[^>]*>(&nbsp;|&#160;|\\s| |<br \\/>|)<\\/"+n+">[\r\n]*|<br \\/>[\r\n]*)$");return t.replace(r,"")},Gy=function(e,t){return je(je({},e),{format:t,get:!0,getInner:!0})},Wy=function(e,t,n,r){var i,o=Gy(t,n),a=t.no_events?o:e.fire("BeforeGetContent",o);return i="raw"===a.format?mn.trim(ma(jy(r,e.serializer.getTempAttrs()).innerHTML)):"text"===a.format?e.dom.isEmpty(r)?"":ma(r.innerText||r.textContent):"tree"===a.format?e.serializer.serialize(r,a):qy(e,e.serializer.serialize(r,a)),X(["text","tree"],a.format)||aa(wn.fromDom(r))?a.content=i:a.content=mn.trim(i),a.no_events?a.content:e.fire("GetContent",a).content},Ky=function(e,t,n){return j.from(e.getBody()).fold(L("tree"===t.format?new Ay("body",11):""),(function(r){return Wy(e,t,n,r)}))},Yy=mn.each,Xy=function(e){var t=function(t,n){if(t.nodeName!==n.nodeName)return!1;var r=function(t){var n={};return Yy(e.getAttribs(t),(function(r){var i=r.nodeName.toLowerCase();0!==i.indexOf("_")&&"style"!==i&&0!==i.indexOf("data-")&&(n[i]=e.getAttrib(t,i))})),n},i=function(e,t){var n,r;for(r in e)if(Re(e,r)){if(n=t[r],"undefined"===typeof n)return!1;if(e[r]!==n)return!1;delete t[r]}for(r in t)if(Re(t,r))return!1;return!0};return!!i(r(t),r(n))&&(!!i(e.parseStyle(e.getAttrib(t,"style")),e.parseStyle(e.getAttrib(n,"style")))&&(!xp(t)&&!xp(n)))};return{compare:t}},Jy=mn.makeMap,Qy=function(e){var t=[];e=e||{};var n=e.indent,r=Jy(e.indent_before||""),i=Jy(e.indent_after||""),o=_s.getEncodeFunc(e.entity_encoding||"raw",e.entities),a="html"===e.element_format;return{start:function(e,s,l){var u,c,d,f;if(n&&r[e]&&t.length>0&&(f=t[t.length-1],f.length>0&&"\n"!==f&&t.push("\n")),t.push("<",e),s)for(u=0,c=s.length;u<c;u++)d=s[u],t.push(" ",d.name,'="',o(d.value,!0),'"');t[t.length]=!l||a?">":" />",l&&n&&i[e]&&t.length>0&&(f=t[t.length-1],f.length>0&&"\n"!==f&&t.push("\n"))},end:function(e){var r;t.push("</",e,">"),n&&i[e]&&t.length>0&&(r=t[t.length-1],r.length>0&&"\n"!==r&&t.push("\n"))},text:function(e,n){e.length>0&&(t[t.length]=n?e:o(e))},cdata:function(e){t.push("<![CDATA[",e,"]]>")},comment:function(e){t.push("\x3c!--",e,"--\x3e")},pi:function(e,r){r?t.push("<?",e," ",o(r),"?>"):t.push("<?",e,"?>"),n&&t.push("\n")},doctype:function(e){t.push("<!DOCTYPE",e,">",n?"\n":"")},reset:function(){t.length=0},getContent:function(){return t.join("").replace(/\n$/,"")}}},Zy=function(e,t){void 0===t&&(t=Us());var n=Qy(e);e=e||{},e.validate=!("validate"in e)||e.validate;var r=function(r){var i=e.validate,o={3:function(e){n.text(e.value,e.raw)},8:function(e){n.comment(e.value)},7:function(e){n.pi(e.name,e.value)},10:function(e){n.doctype(e.value)},4:function(e){n.cdata(e.value)},11:function(e){if(e=e.firstChild)do{a(e)}while(e=e.next)}};n.reset();var a=function(e){var r=o[e.type];if(r)r(e);else{var s=e.name,l=e.shortEnded,u=e.attributes;if(i&&u&&u.length>1){var c=[];c.map={};var d=t.getElementRule(e.name);if(d){for(var f=0,h=d.attributesOrder.length;f<h;f++){var m=d.attributesOrder[f];if(m in u.map){var p=u.map[m];c.map[m]=p,c.push({name:m,value:p})}}for(f=0,h=u.length;f<h;f++){m=u[f].name;if(!(m in c.map)){p=u.map[m];c.map[m]=p,c.push({name:m,value:p})}}u=c}}if(n.start(e.name,u,l),!l){if(e=e.firstChild)do{a(e)}while(e=e.next);n.end(s)}}};return 1!==r.type||e.inner?o[11](r):a(r),n.getContent()};return{serialize:r}},ew=new Set;(function(){var e=["margin","margin-left","margin-right","margin-top","margin-bottom","padding","padding-left","padding-right","padding-top","padding-bottom","border","border-width","border-style","border-color","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","float","position","left","right","top","bottom","z-index","display","transform","width","max-width","min-width","height","max-height","min-height","overflow","overflow-x","overflow-y","text-overflow","vertical-align","transition","transition-delay","transition-duration","transition-property","transition-timing-function"];Z(e,(function(e){ew.add(e)}))})();var tw=["font","text-decoration","text-emphasis"],nw=function(e,t){return we(e.parseStyle(e.getAttrib(t,"style")))},rw=function(e){return ew.has(e)},iw=function(e,t){return ce(nw(e,t),(function(e){return!rw(e)}))},ow=function(e){return ne(e,(function(e){return J(tw,(function(t){return ut(e,t)}))}))},aw=function(e,t,n){var r=nw(e,t),i=nw(e,n),o=function(r){var i=e.getStyle(t,r),o=e.getStyle(n,r);return mt(i)&&mt(o)&&i!==o};return J(r,(function(e){var t=function(t){return J(t,(function(t){return t===e}))};if(!t(i)&&t(tw)){var n=ow(i);return J(n,o)}return o(e)}))},sw=function(e,t,n){return j.from(n.container()).filter(Zr).exists((function(r){var i=e?0:-1;return t(r.data.charAt(n.offset()+i))}))},lw=I(sw,!0,Dp),uw=I(sw,!1,Dp),cw=function(e){var t=e.container();return Zr(t)&&(0===t.data.length||ha(t.data)&&Bg.isBookmarkNode(t.parentNode))},dw=function(e,t){return function(n){return j.from(fm(e?0:-1,n)).filter(t).isSome()}},fw=function(e){return ii(e)&&"block"===Di(wn.fromDom(e),"display")},hw=function(e){return ai(e)&&!Yr(e)},mw=dw(!0,fw),pw=dw(!1,fw),gw=dw(!0,li),vw=dw(!1,li),bw=dw(!0,Xr),yw=dw(!1,Xr),ww=dw(!0,hw),Sw=dw(!1,hw),xw=function(e){var t=[],n=e.dom;while(n)t.push(wn.fromDom(n)),n=n.lastChild;return t},Cw=function(e){var t=Ec(e,"br"),n=ne(xw(e).slice(-1),ea);t.length===n.length&&Z(n,kr)},Tw=function(e){Dr(e),Sr(e,wn.fromHtml('<br data-mce-bogus="1">'))},Dw=function(e){ar(e).each((function(t){Zn(t).each((function(n){Jo(e)&&ea(t)&&Jo(n)&&kr(t)}))}))},kw=function(e){return e.slice(0,-1)},Ew=function(e,t,n){return Nn(t,e)?kw(Jn(e,(function(e){return n(e)||In(e,t)}))):[]},_w=function(e,t){return Ew(e,t,B)},Aw=function(e,t){return[e].concat(_w(e,t))},Lw=function(e,t,n){return Wm(e,t,n,cw)},Ow=function(e,t){return ae(Aw(wn.fromDom(t.container()),e),Jo)},Rw=function(e,t,n){return Lw(e,t.dom,n).forall((function(e){return Ow(t,n).fold((function(){return!1===dm(e,n,t.dom)}),(function(r){return!1===dm(e,n,t.dom)&&Nn(r,wn.fromDom(e.container()))}))}))},Iw=function(e,t,n){return Ow(t,n).fold((function(){return Lw(e,t.dom,n).forall((function(e){return!1===dm(e,n,t.dom)}))}),(function(t){return Lw(e,t.dom,n).isNone()}))},Pw=I(Iw,!1),Mw=I(Iw,!0),Nw=I(Rw,!1),Fw=I(Rw,!0),Bw=function(e){return Sm(e).exists(ea)},$w=function(e,t,n){var r=ne(Aw(wn.fromDom(n.container()),t),Jo),i=ge(r).getOr(t);return qm(e,i.dom,n).filter(Bw)},zw=function(e,t){return Sm(t).exists(ea)||$w(!0,e,t).isSome()},Uw=function(e,t){return xm(t).exists(ea)||$w(!1,e,t).isSome()},Vw=I($w,!1),Hw=I($w,!0),jw=function(e){return Rd.isTextPosition(e)&&!e.isAtStart()&&!e.isAtEnd()},qw=function(e,t){var n=ne(Aw(wn.fromDom(t.container()),e),Jo);return ge(n).getOr(e)},Gw=function(e,t){return jw(t)?uw(t):uw(t)||Xm(qw(e,t).dom,t).exists(uw)},Ww=function(e,t){return jw(t)?lw(t):lw(t)||Ym(qw(e,t).dom,t).exists(lw)},Kw=function(e){return X(["pre","pre-wrap"],e)},Yw=function(e){return Sm(e).bind((function(e){return Co(e,Un)})).exists((function(e){return Kw(Di(e,"white-space"))}))},Xw=function(e,t){return Xm(e.dom,t).isNone()},Jw=function(e,t){return Ym(e.dom,t).isNone()},Qw=function(e,t){return Xw(e,t)||Jw(e,t)||Pw(e,t)||Mw(e,t)||Uw(e,t)||zw(e,t)},Zw=function(e,t){return!Yw(t)&&(Qw(e,t)||Gw(e,t)||Ww(e,t))},eS=function(e,t){return!Yw(t)&&(Pw(e,t)||Nw(e,t)||Uw(e,t)||Gw(e,t))},tS=function(e){var t=e.container(),n=e.offset();return Zr(t)&&n<t.data.length?Rd(t,n+1):e},nS=function(e,t){return!Yw(t)&&(Mw(e,t)||Fw(e,t)||zw(e,t)||Ww(e,t))},rS=function(e,t){return eS(e,t)||nS(e,tS(t))},iS=function(e,t){return Tp(e.charAt(t))},oS=function(e){var t=e.container();return Zr(t)&&lt(t.data,ua)},aS=function(e){var t=e.split("");return Q(t,(function(e,n){return Tp(e)&&n>0&&n<t.length-1&&kp(t[n-1])&&kp(t[n+1])?" ":e})).join("")},sS=function(e,t){var n=t.data,r=Rd(t,0);return!(!iS(n,0)||rS(e,r))&&(t.data=" "+n.slice(1),!0)},lS=function(e){var t=e.data,n=aS(t);return n!==t&&(e.data=n,!0)},uS=function(e,t){var n=t.data,r=Rd(t,n.length-1);return!(!iS(n,n.length-1)||rS(e,r))&&(t.data=n.slice(0,-1)+" ",!0)},cS=function(e,t){return j.some(t).filter(oS).bind((function(t){var n=t.container(),r=sS(e,n)||lS(n)||uS(e,n);return r?j.some(t):j.none()}))},dS=function(e){var t=wn.fromDom(e.getBody());e.selection.isCollapsed()&&cS(t,Rd.fromRangeStart(e.selection.getRng())).each((function(t){e.selection.setRng(t.toRange())}))},fS=function(e,t,n){var r=ie(e,(function(r,i){return Dp(i)||Tp(i)?r.previousCharIsSpace||""===r.str&&t||r.str.length===e.length-1&&n?{previousCharIsSpace:!1,str:r.str+ua}:{previousCharIsSpace:!0,str:r.str+" "}:{previousCharIsSpace:!1,str:r.str+i}}),{previousCharIsSpace:!1,str:""});return r.str},hS=function(e,t,n){if(0!==n){var r=wn.fromDom(e),i=xo(r,Jo).getOr(r),o=e.data.slice(t,t+n),a=t+n>=e.data.length&&nS(i,Rd(e,e.data.length)),s=0===t&&eS(i,Rd(e,0));e.replaceData(t,n,fS(o,s,a))}},mS=function(e,t){var n=e.data.slice(t),r=n.length-ft(n).length;hS(e,t,r)},pS=function(e,t){var n=e.data.slice(0,t),r=n.length-ht(n).length;hS(e,t-r,r)},gS=function(e,t,n,r){void 0===r&&(r=!0);var i=ht(e.data).length,o=r?e:t,a=r?t:e;return r?o.appendData(a.data):o.insertData(0,a.data),kr(wn.fromDom(a)),n&&mS(o,i),o},vS=function(e,t){var n=e.container(),r=e.offset();return!1===Rd.isTextPosition(e)&&n===t.parentNode&&r>Rd.before(t).offset()},bS=function(e,t){return vS(t,e)?Rd(t.container(),t.offset()-1):t},yS=function(e){return Zr(e)?Rd(e,0):Rd.before(e)},wS=function(e){return Zr(e)?Rd(e,e.data.length):Rd.after(e)},SS=function(e){return $a(e.previousSibling)?j.some(wS(e.previousSibling)):e.previousSibling?Qm(e.previousSibling):j.none()},xS=function(e){return $a(e.nextSibling)?j.some(yS(e.nextSibling)):e.nextSibling?Jm(e.nextSibling):j.none()},CS=function(e,t){var n=Rd.before(t.previousSibling?t.previousSibling:t.parentNode);return Xm(e,n).fold((function(){return Ym(e,Rd.after(t))}),j.some)},TS=function(e,t){return Ym(e,Rd.after(t)).fold((function(){return Xm(e,Rd.before(t))}),j.some)},DS=function(e,t){return SS(t).orThunk((function(){return xS(t)})).orThunk((function(){return CS(e,t)}))},kS=function(e,t){return xS(t).orThunk((function(){return SS(t)})).orThunk((function(){return TS(e,t)}))},ES=function(e,t,n){return e?kS(t,n):DS(t,n)},_S=function(e,t,n){return ES(e,t,n).map(I(bS,n))},AS=function(e,t,n){n.fold((function(){e.focus()}),(function(n){e.selection.setRng(n.toRange(),t)}))},LS=function(e){return function(t){return t.dom===e}},OS=function(e,t){return t&&Re(e.schema.getBlockElements(),Fn(t))},RS=function(e){if(ns(e)){var t=wn.fromHtml('<br data-mce-bogus="1">');return Dr(e),Sr(e,t),j.some(Rd.before(t.dom))}return j.none()},IS=function(e,t,n){var r=Zn(e).filter(Vn),i=er(e).filter(Vn);return kr(e),fi(r,i,t,(function(e,t,r){var i=e.dom,o=t.dom,a=i.data.length;return gS(i,o,n),r.container()===o?Rd(i,a):r})).orThunk((function(){return n&&(r.each((function(e){return pS(e.dom,e.dom.length)})),i.each((function(e){return mS(e.dom,0)}))),t}))},PS=function(e,t){return Re(e.schema.getTextInlineElements(),Fn(t))},MS=function(e,t,n,r){void 0===r&&(r=!0);var i=_S(t,e.getBody(),n.dom),o=xo(n,I(OS,e),LS(e.getBody())),a=IS(n,i,PS(e,n));e.dom.isEmpty(e.getBody())?(e.setContent(""),e.selection.setCursorLocation()):o.bind(RS).fold((function(){r&&AS(e,t,a)}),(function(n){r&&AS(e,t,j.some(n))}))},NS=function(e){return function(t){return In(e,t)}},FS=function(e){return Ec(e,"td,th")},BS=function(e,t){var n=function(e){return bg(wn.fromDom(e),t)},r=n(e.startContainer),i=n(e.endContainer),o=r.isSome(),a=i.isSome(),s=di(r,i,In).getOr(!1),l=!s&&o&&a;return{startTable:r,endTable:i,isStartInTable:o,isEndInTable:a,isSameTable:s,isMultiTable:l}},$S=function(e,t){return{start:e,end:t}},zS=function(e,t,n){return{rng:e,table:t,cells:n}},US=Zi.generate([{singleCellTable:["rng","cell"]},{fullTable:["table"]},{partialTable:["cells","outsideDetails"]},{multiTable:["startTableCells","endTableCells","betweenRng"]}]),VS=function(e,t){return _o(wn.fromDom(e),"td,th",t)},HS=function(e){return!In(e.start,e.end)},jS=function(e,t){return bg(e.start,t).bind((function(n){return bg(e.end,t).bind((function(e){return hi(In(n,e),n)}))}))},qS=function(e,t){return!HS(e)&&jS(e,t).exists((function(e){var t=e.dom.rows;return 1===t.length&&1===t[0].cells.length}))},GS=function(e,t){var n=VS(e.startContainer,t),r=VS(e.endContainer,t);return di(n,r,$S)},WS=function(e){return function(t){return bg(t,e).bind((function(e){return ve(FS(e)).map((function(e){return $S(t,e)}))}))}},KS=function(e){return function(t){return bg(t,e).bind((function(e){return ge(FS(e)).map((function(e){return $S(e,t)}))}))}},YS=function(e){return function(t){return jS(t,e).map((function(e){return zS(t,e,FS(e))}))}},XS=function(e,t,n,r){if(n.collapsed||!e.forall(HS))return j.none();if(t.isSameTable){var i=e.bind(YS(r));return j.some({start:i,end:i})}var o=VS(n.startContainer,r),a=VS(n.endContainer,r),s=o.bind(WS(r)).bind(YS(r)),l=a.bind(KS(r)).bind(YS(r));return j.some({start:s,end:l})},JS=function(e,t){return se(e,(function(e){return In(e,t)}))},QS=function(e){return di(JS(e.cells,e.rng.start),JS(e.cells,e.rng.end),(function(t,n){return e.cells.slice(t,n+1)}))},ZS=function(e,t,n){return e.exists((function(e){return qS(e,n)&&Cg(e.start,t)}))},ex=function(e,t){var n=t.startTable,r=t.endTable,i=e.cloneRange();return n.each((function(e){return i.setStartAfter(e.dom)})),r.each((function(e){return i.setEndBefore(e.dom)})),i},tx=function(e,t,n,r){return XS(e,t,n,r).bind((function(e){var t=e.start,n=e.end;return t.or(n)})).bind((function(e){var r=t.isSameTable,i=QS(e).getOr([]);if(r&&e.cells.length===i.length)return j.some(US.fullTable(e.table));if(i.length>0){if(r)return j.some(US.partialTable(i,j.none()));var o=ex(n,t);return j.some(US.partialTable(i,j.some(je(je({},t),{rng:o}))))}return j.none()}))},nx=function(e,t,n,r){return XS(e,t,n,r).bind((function(e){var r=e.start,i=e.end,o=r.bind(QS).getOr([]),a=i.bind(QS).getOr([]);if(o.length>0&&a.length>0){var s=ex(n,t);return j.some(US.multiTable(o,a,s))}return j.none()}))},rx=function(e,t){var n=NS(e),r=GS(t,n),i=BS(t,n);return ZS(r,t,n)?r.map((function(e){return US.singleCellTable(t,e.start)})):i.isMultiTable?nx(r,i,t,n):tx(r,i,t,n)},ix=function(e){var t=zn(e)?Zn(e):ar(e);return t.bind(ix).orThunk((function(){return j.some(e)}))},ox=function(e){return Z(e,(function(e){Si(e,"contenteditable"),Tw(e)}))},ax=function(e,t){return j.from(e.dom.getParent(t,e.dom.isBlock)).map(wn.fromDom)},sx=function(e,t,n){n.each((function(n){t?kr(n):(Tw(n),e.selection.setCursorLocation(n.dom,0))}))},lx=function(e,t,n,r){var i=n.cloneRange();r?(i.setStart(n.startContainer,n.startOffset),i.setEndAfter(t.dom.lastChild)):(i.setStartBefore(t.dom.firstChild),i.setEnd(n.endContainer,n.endOffset)),fx(e,i,t,!1)},ux=function(e){var t=vg(e),n=wn.fromDom(e.selection.getNode());si(n.dom)&&ns(n)?e.selection.setCursorLocation(n.dom,0):e.selection.collapse(!0),t.length>1&&J(t,(function(e){return In(e,n)}))&&gi(n,"data-mce-selected","1")},cx=function(e,t,n){var r=e.selection.getRng(),i=n.bind((function(n){var i=n.rng,o=n.isStartInTable,a=ax(e,o?i.endContainer:i.startContainer);i.deleteContents(),sx(e,o,a.filter(ns));var s=o?t[0]:t[t.length-1];return lx(e,s,r,o),ns(s)?j.none():j.some(o?t.slice(1):t.slice(0,-1))})).getOr(t);return ox(i),ux(e),!0},dx=function(e,t,n,r){var i=e.selection.getRng(),o=t[0],a=n[n.length-1];lx(e,o,i,!0),lx(e,a,i,!1);var s=ns(o)?t:t.slice(1),l=ns(a)?n:n.slice(0,-1);return ox(s.concat(l)),r.deleteContents(),ux(e),!0},fx=function(e,t,n,r){void 0===r&&(r=!0),t.deleteContents();var i=ix(n).getOr(n),o=wn.fromDom(e.dom.getParent(i.dom,e.dom.isBlock));if(ns(o)&&(Tw(o),r&&e.selection.setCursorLocation(o.dom,0)),!In(n,o)){var a=ui(Xn(o),n)?[]:Qn(o);Z(a.concat(rr(n)),(function(e){In(e,o)||Nn(e,o)||!ns(e)||kr(e)}))}return!0},hx=function(e,t){return MS(e,!1,t),!0},mx=function(e,t,n){return rx(t,n).map((function(t){return t.fold(I(fx,e),I(hx,e),I(cx,e),I(dx,e))}))},px=function(e,t){return Sx(e,t)},gx=function(e,t,n,r){return yx(t,r).fold((function(){return mx(e,t,n)}),(function(t){return px(e,t)})).getOr(!1)},vx=function(e,t,n){var r=wn.fromDom(e.getBody()),i=e.selection.getRng();return 0!==n.length?cx(e,n,j.none()):gx(e,r,i,t)},bx=function(e,t){return ae(Aw(t,e),oa)},yx=function(e,t){return ae(Aw(t,e),qn("caption"))},wx=function(e,t,n,r,i){return Gm(n,e.getBody(),i).bind((function(e){return bx(t,wn.fromDom(e.getNode())).map((function(e){return!1===In(e,r)}))}))},Sx=function(e,t){return Tw(t),e.selection.setCursorLocation(t.dom,0),j.some(!0)},xx=function(e,t,n,r){return Jm(e.dom).bind((function(i){return Qm(e.dom).map((function(e){return t?n.isEqual(i)&&r.isEqual(e):n.isEqual(e)&&r.isEqual(i)}))})).getOr(!0)},Cx=function(e,t){return Sx(e,t)},Tx=function(e,t,n){return yx(e,wn.fromDom(n.getNode())).map((function(e){return!1===In(e,t)}))},Dx=function(e,t,n,r,i){return Gm(n,e.getBody(),i).bind((function(o){return xx(r,n,i,o)?Cx(e,r):Tx(t,r,o)})).or(j.some(!0))},kx=function(e,t,n,r){var i=Rd.fromRangeStart(e.selection.getRng());return bx(n,r).bind((function(r){return ns(r)?Sx(e,r):wx(e,n,t,r,i)})).getOr(!1)},Ex=function(e,t,n,r){var i=Rd.fromRangeStart(e.selection.getRng());return ns(r)?Sx(e,r):Dx(e,n,t,r,i)},_x=function(e,t){return e?bw(t):yw(t)},Ax=function(e,t){var n=Rd.fromRangeStart(e.selection.getRng());return _x(t,n)||qm(t,e.getBody(),n).exists((function(e){return _x(t,e)}))},Lx=function(e,t,n){var r=wn.fromDom(e.getBody());return yx(r,n).fold((function(){return kx(e,t,r,n)||Ax(e,t)}),(function(n){return Ex(e,t,r,n).getOr(!1)}))},Ox=function(e,t){var n=wn.fromDom(e.selection.getStart(!0)),r=vg(e);return e.selection.isCollapsed()&&0===r.length?Lx(e,t,n):vx(e,n,r)},Rx=function(e,t,n,r){var i=document.createRange();return i.setStart(e,t),i.setEnd(n,r),i},Ix=function(e){var t=Rd.fromRangeStart(e),n=Rd.fromRangeEnd(e),r=e.commonAncestorContainer;return qm(!1,r,n).map((function(i){return!dm(t,n,r)&&dm(t,i,r)?Rx(t.container(),t.offset(),i.container(),i.offset()):e})).getOr(e)},Px=function(e){return e.collapsed?e:Ix(e)},Mx=function(e){return e.firstChild&&e.firstChild===e.lastChild},Nx=function(e){return"br"===e.name||e.value===ua},Fx=function(e,t){var n=e.getBlockElements();return n[t.name]&&Mx(t)&&Nx(t.firstChild)},Bx=function(e,t){var n=e.getNonEmptyElements();return t&&(t.isEmpty(n)||Fx(e,t))},$x=function(e,t){var n=t.firstChild,r=t.lastChild;return n&&"meta"===n.name&&(n=n.next),r&&"mce_marker"===r.attr("id")&&(r=r.prev),Bx(e,r)&&(r=r.prev),!(!n||n!==r)&&("ul"===n.name||"ol"===n.name)},zx=function(e){var t=e.firstChild,n=e.lastChild;return t&&"META"===t.nodeName&&t.parentNode.removeChild(t),n&&"mce_marker"===n.id&&n.parentNode.removeChild(n),e},Ux=function(e,t,n){var r=t.serialize(n),i=e.createFragment(r);return zx(i)},Vx=function(e){return ne(e.childNodes,(function(e){return"LI"===e.nodeName}))},Hx=function(e){return e.data===ua||ri(e)},jx=function(e){return e&&e.firstChild&&e.firstChild===e.lastChild&&Hx(e.firstChild)},qx=function(e){return!e.firstChild||jx(e)},Gx=function(e){return e.length>0&&qx(e[e.length-1])?e.slice(0,-1):e},Wx=function(e,t){var n=e.getParent(t,e.isBlock);return n&&"LI"===n.nodeName?n:null},Kx=function(e,t){return!!Wx(e,t)},Yx=function(e,t){var n=t.cloneRange(),r=t.cloneRange();return n.setStartBefore(e),r.setEndAfter(e),[n.cloneContents(),r.cloneContents()]},Xx=function(e,t){var n=Rd.before(e),r=Fm(t),i=r.next(n);return i?i.toRange():null},Jx=function(e,t){var n=Rd.after(e),r=Fm(t),i=r.prev(n);return i?i.toRange():null},Qx=function(e,t,n,r){var i=Yx(e,r),o=e.parentNode;return o.insertBefore(i[0],e),mn.each(t,(function(t){o.insertBefore(t,e)})),o.insertBefore(i[1],e),o.removeChild(e),Jx(t[t.length-1],n)},Zx=function(e,t,n){var r=e.parentNode;return mn.each(t,(function(t){r.insertBefore(t,e)})),Xx(e,n)},eC=function(e,t,n,r){return r.insertAfter(t.reverse(),e),Jx(t[0],n)},tC=function(e,t,n,r){var i=Ux(t,e,r),o=Wx(t,n.startContainer),a=Gx(Vx(i.firstChild)),s=1,l=2,u=t.getRoot(),c=function(e){var r=Rd.fromRangeStart(n),i=Fm(t.getRoot()),a=e===s?i.prev(r):i.next(r);return!a||Wx(t,a.getNode())!==o};return c(s)?Zx(o,a,u):c(l)?eC(o,a,u,t):Qx(o,a,u,n)},nC=function(e,t,n){var r=wn.fromDom(e.getRoot());return n=eS(r,Rd.fromRangeStart(t))?n.replace(/^ /,"&nbsp;"):n.replace(/^&nbsp;/," "),n=nS(r,Rd.fromRangeEnd(t))?n.replace(/(&nbsp;| )(<br( \/)>)?$/,"&nbsp;"):n.replace(/&nbsp;(<br( \/)?>)?$/," "),n},rC=si,iC=function(e,t,n){if(null!==n){var r=e.getParent(t.endContainer,rC);return n===r&&Cg(wn.fromDom(n),t)}return!1},oC=function(e,t,n){if("all"===n.getAttribute("data-mce-bogus"))n.parentNode.insertBefore(e.dom.createFragment(t),n);else{var r=n.firstChild,i=n.lastChild;!r||r===i&&"BR"===r.nodeName?e.dom.setHTML(n,t):e.selection.setContent(t)}},aC=function(e,t){j.from(e.getParent(t,"td,th")).map(wn.fromDom).each(Dw)},sC=function(e,t){var n=e.schema.getTextInlineElements(),r=e.dom;if(t){var i=e.getBody(),o=Xy(r);mn.each(r.select("*[data-mce-fragment]"),(function(e){var t=T(n[e.nodeName.toLowerCase()]);if(t&&iw(r,e))for(var a=e.parentNode;T(a)&&a!==i;a=a.parentNode){var s=aw(r,e,a);if(s)break;if(o.compare(a,e)){r.remove(e,!0);break}}}))}},lC=function(e){var t=e;while(t=t.walk())1===t.type&&t.attr("data-mce-fragment","1")},uC=function(e){mn.each(e.getElementsByTagName("*"),(function(e){e.removeAttribute("data-mce-fragment")}))},cC=function(e){return!!e.getAttribute("data-mce-fragment")},dC=function(e,t){return t&&!e.schema.getShortEndedElements()[t.nodeName]},fC=function(e,t){var n,r=e.dom,i=e.selection;if(t){i.scrollIntoView(t);var o=$g(e.getBody(),t);if("false"===r.getContentEditable(o))return r.remove(t),void i.select(o);var a=r.createRng(),s=t.previousSibling;if(Zr(s)){if(a.setStart(s,s.nodeValue.length),!en.ie){var l=t.nextSibling;Zr(l)&&(s.appendData(l.data),l.parentNode.removeChild(l))}}else a.setStartBefore(t),a.setEndBefore(t);var u=function(t){var n=Rd.fromRangeStart(t),r=Fm(e.getBody());if(n=r.next(n),n)return n.toRange()},c=r.getParent(t,r.isBlock);r.remove(t),c&&r.isEmpty(c)&&(e.$(c).empty(),a.setStart(c,0),a.setEnd(c,0),rC(c)||cC(c)||!(n=u(a))?r.add(c,r.create("br",{"data-mce-bogus":"1"})):(a=n,r.remove(c))),i.setRng(a)}},hC=function(e){var t=e.dom,n=Px(e.selection.getRng());e.selection.setRng(n);var r=t.getParent(n.startContainer,rC);iC(t,n,r)?fx(e,n,wn.fromDom(r)):e.getDoc().execCommand("Delete",!1,null)},mC=function(e,t,n){var r,i,o,a=e.selection,s=e.dom;/^ | $/.test(t)&&(t=nC(s,a.getRng(),t));var l=e.parser,u=n.merge,c=Zy({validate:oh(e)},e.schema),d='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;</span>',f=e.fire("BeforeSetContent",{content:t,format:"html",selection:!0,paste:n.paste});if(f.isDefaultPrevented())e.fire("SetContent",{content:f.content,format:"html",selection:!0,paste:n.paste});else{t=f.content,n.preserve_zwsp||(t=ma(t)),-1===t.indexOf("{$caret}")&&(t+="{$caret}"),t=t.replace(/\{\$caret\}/,d),i=a.getRng();var h=i.startContainer||(i.parentElement?i.parentElement():null),m=e.getBody();h===m&&a.isCollapsed()&&s.isBlock(m.firstChild)&&dC(e,m.firstChild)&&s.isEmpty(m.firstChild)&&(i=s.createRng(),i.setStart(m.firstChild,0),i.setEnd(m.firstChild,0),a.setRng(i)),a.isCollapsed()||hC(e),r=a.getNode();var p={context:r.nodeName.toLowerCase(),data:n.data,insert:!0},g=l.parse(t,p);if(!0===n.paste&&$x(e.schema,g)&&Kx(s,r))return i=tC(c,s,a.getRng(),g),a.setRng(i),void e.fire("SetContent",f);if(lC(g),o=g.lastChild,"mce_marker"===o.attr("id")){var v=o;for(o=o.prev;o;o=o.walk(!0))if(3===o.type||!s.isBlock(o.name)){e.schema.isValidChild(o.parent.name,"span")&&o.parent.insert(v,o,"br"===o.name);break}}if(e._selectionOverrides.showBlockCaretContainer(r),p.invalid){e.selection.setContent(d),r=a.getNode();var b=e.getBody();9===r.nodeType?r=o=b:o=r;while(o!==b)r=o,o=o.parentNode;t=r===b?b.innerHTML:s.getOuterHTML(r),t=c.serialize(l.parse(t.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,(function(){return c.serialize(g)})))),r===b?s.setHTML(b,t):s.setOuterHTML(r,t)}else t=c.serialize(g),oC(e,t,r);sC(e,u),fC(e,s.get("mce_marker")),uC(e.getBody()),aC(s,a.getStart()),e.fire("SetContent",f),e.addVisual()}},pC=function(e,t){t(e),e.firstChild&&pC(e.firstChild,t),e.next&&pC(e.next,t)},gC=function(e,t,n){var r={},i={},o=[];for(var a in n.firstChild&&pC(n.firstChild,(function(n){Z(e,(function(e){e.name===n.name&&(r[e.name]?r[e.name].nodes.push(n):r[e.name]={filter:e,nodes:[n]})})),Z(t,(function(e){"string"===typeof n.attr(e.name)&&(i[e.name]?i[e.name].nodes.push(n):i[e.name]={filter:e,nodes:[n]})}))})),r)Re(r,a)&&o.push(r[a]);for(var s in i)Re(i,s)&&o.push(i[s]);return o},vC=function(e,t,n){var r=gC(e,t,n);Z(r,(function(e){Z(e.filter.callbacks,(function(t){t(e.nodes,e.filter.name,{})}))}))},bC="html",yC=function(e){return e instanceof Ay},wC=function(e){fy(e)&&Jm(e.getBody()).each((function(t){var n=t.getNode(),r=Xr(n)?Jm(n).getOr(t):t;e.selection.setRng(r.toRange())}))},SC=function(e,t,n){e.dom.setHTML(e.getBody(),t),!0!==n&&wC(e)},xC=function(e,t,n,r){if(n=ma(n),0===n.length||/^\s+$/.test(n)){var i='<br data-mce-bogus="1">';"TABLE"===t.nodeName?n="<tr><td>"+i+"</td></tr>":/^(UL|OL)$/.test(t.nodeName)&&(n="<li>"+i+"</li>");var o=Df(e);o&&e.schema.isValidChild(t.nodeName.toLowerCase(),o.toLowerCase())?(n=i,n=e.dom.createHTML(o,kf(e),n)):n||(n='<br data-mce-bogus="1">'),SC(e,n,r.no_selection),e.fire("SetContent",r)}else"raw"!==r.format&&(n=Zy({validate:e.validate},e.schema).serialize(e.parser.parse(n,{isRootContent:!0,insert:!0}))),r.content=aa(wn.fromDom(t))?n:mn.trim(n),SC(e,r.content,r.no_selection),r.no_events||e.fire("SetContent",r);return r.content},CC=function(e,t,n,r){vC(e.parser.getNodeFilters(),e.parser.getAttributeFilters(),n);var i=Zy({validate:e.validate},e.schema).serialize(n);return r.content=ma(aa(wn.fromDom(t))?i:mn.trim(i)),SC(e,r.content,r.no_selection),r.no_events||e.fire("SetContent",r),n},TC=function(e,t){return je(je({format:bC},e),{set:!0,content:yC(t)?"":t})},DC=function(e,t,n){var r=TC(n,t),i=n.no_events?r:e.fire("BeforeSetContent",r);return yC(t)||(t=i.content),j.from(e.getBody()).fold(L(t),(function(n){return yC(t)?CC(e,n,t,i):xC(e,n,t,i)}))},kC=function(e,t){return To(e,t).isSome()},EC=function(e){return D(e)?e:B},_C=function(e,t,n){var r=e.dom,i=EC(n);while(r.parentNode){r=r.parentNode;var o=wn.fromDom(r),a=t(o);if(a.isSome())return a;if(i(o))break}return j.none()},AC=function(e,t,n){var r=t(e),i=EC(n);return r.orThunk((function(){return i(e)?j.none():_C(e,t,i)}))},LC=Np,OC=function(e,t,n){var r=e.formatter.get(n);if(r)for(var i=0;i<r.length;i++){var o=r[i];if(jp(o)&&!1===o.inherit&&e.dom.is(t,o.selector))return!0}return!1},RC=function(e,t,n,r,i){var o=e.dom.getRoot();return t!==o&&(t=e.dom.getParent(t,(function(t){return!!OC(e,t,n)||(t.parentNode===o||!!MC(e,t,n,r,!0))})),!!MC(e,t,n,r,i))},IC=function(e,t,n){return!!LC(t,n.inline)||(!!LC(t,n.block)||(n.selector?1===t.nodeType&&e.is(t,n.selector):void 0))},PC=function(e,t,n,r,i,o){var a=n[r];if(D(n.onmatch))return n.onmatch(t,n,r);if(a)if(x(a.length)){for(var s in a)if(Re(a,s)){var l="attributes"===r?e.getAttrib(t,s):Bp(e,t,s),u=Mp(a[s],o),c=C(l)||pt(l);if(c&&C(u))continue;if(i&&c&&!n.exact)return!1;if((!i||n.exact)&&!LC(l,Fp(e,u,s)))return!1}}else for(var d=0;d<a.length;d++)if("attributes"===r?e.getAttrib(t,a[d]):Bp(e,t,a[d]))return!0;return!0},MC=function(e,t,n,r,i){var o=e.formatter.get(n),a=e.dom;if(o&&t)for(var s=0;s<o.length;s++){var l=o[s];if(IC(e.dom,t,l)&&PC(a,t,l,"attributes",i,r)&&PC(a,t,l,"styles",i,r)){var u=l.classes;if(u)for(var c=0;c<u.length;c++)if(!e.dom.hasClass(t,Mp(u[c],r)))return;return l}}},NC=function(e,t,n,r,i){if(r)return RC(e,r,t,n,i);if(r=e.selection.getNode(),RC(e,r,t,n,i))return!0;var o=e.selection.getStart();return!(o===r||!RC(e,o,t,n,i))},FC=function(e,t,n){var r=[],i={},o=e.selection.getStart();return e.dom.getParent(o,(function(o){for(var a=0;a<t.length;a++){var s=t[a];!i[s]&&MC(e,o,s,n)&&(i[s]=!0,r.push(s))}}),e.dom.getRoot()),r},BC=function(e,t){var n=function(t){return In(t,wn.fromDom(e.getBody()))},r=function(t,n){return MC(e,t.dom,n)?j.some(n):j.none()};return j.from(e.selection.getStart(!0)).bind((function(e){return AC(wn.fromDom(e),(function(e){return ye(t,(function(t){return r(e,t)}))}),n)})).getOrNull()},$C=function(e,t){var n=e.formatter.get(t),r=e.dom;if(n)for(var i=e.selection.getStart(),o=zp(r,i),a=n.length-1;a>=0;a--){var s=n[a];if(!jp(s)||T(s.defaultBlock))return!0;for(var l=o.length-1;l>=0;l--)if(r.is(o[l],s.selector))return!0}return!1},zC=function(e,t,n){return ie(n,(function(n,r){var i=Up(e,r);return e.formatter.matchNode(t,r,{},i)?n.concat([r]):n}),[])},UC=fa,VC="_mce_caret",HC=function(e,t){return e.importNode(t,!0)},jC=function(e){var t=[];while(e){if(3===e.nodeType&&e.nodeValue!==UC||e.childNodes.length>1)return[];1===e.nodeType&&t.push(e),e=e.firstChild}return t},qC=function(e){return jC(e).length>0},GC=function(e){if(e){var t=new zo(e,e);for(e=t.current();e;e=t.next())if(Zr(e))return e}return null},WC=function(e){var t=wn.fromTag("span");return vi(t,{id:VC,"data-mce-bogus":"1","data-mce-type":"format-caret"}),e&&Sr(t,wn.fromText(UC)),t},KC=function(e){var t=GC(e);return t&&t.nodeValue.charAt(0)===UC&&t.deleteData(0,1),t},YC=function(e,t,n){void 0===n&&(n=!0);var r=e.dom,i=e.selection;if(qC(t))MS(e,!1,wn.fromDom(t),n);else{var o=i.getRng(),a=r.getParent(t,r.isBlock),s=o.startContainer,l=o.startOffset,u=o.endContainer,c=o.endOffset,d=KC(t);r.remove(t,!0),s===d&&l>0&&o.setStart(d,l-1),u===d&&c>0&&o.setEnd(d,c-1),a&&r.isEmpty(a)&&Tw(wn.fromDom(a)),i.setRng(o)}},XC=function(e,t,n){void 0===n&&(n=!0);var r=e.dom,i=e.selection;if(t)YC(e,t,n);else if(t=tp(e.getBody(),i.getStart()),!t)while(t=r.get(VC))YC(e,t,!1)},JC=function(e,t,n){var r=e.dom,i=r.getParent(n,I(Op,e));i&&r.isEmpty(i)?n.parentNode.replaceChild(t,n):(Cw(wn.fromDom(n)),r.isEmpty(n)?n.parentNode.replaceChild(t,n):r.insertAfter(t,n))},QC=function(e,t){return e.appendChild(t),t},ZC=function(e,t){var n=re(e,(function(e,t){return QC(e,t.cloneNode(!1))}),t);return QC(n,n.ownerDocument.createTextNode(UC))},eT=function(e,t,n,r,i,o){var a=e.formatter,s=e.dom,l=ne(we(a.get()),(function(e){return e!==r&&!lt(e,"removeformat")})),u=zC(e,n,l),c=ne(u,(function(t){return!Vp(e,t,r)}));if(c.length>0){var d=n.cloneNode(!1);return s.add(t,d),a.remove(r,i,d,o),s.remove(d),j.some(d)}return j.none()},tT=function(e,t,n){var r,i,o=e.selection,a=o.getRng(),s=a.startOffset,l=a.startContainer,u=l.nodeValue;r=tp(e.getBody(),o.getStart()),r&&(i=GC(r));var c=/[^\s\u00a0\u00ad\u200b\ufeff]/;if(u&&s>0&&s<u.length&&c.test(u.charAt(s))&&c.test(u.charAt(s-1))){var d=o.getBookmark();a.collapse(!0);var f=ug(e,a,e.formatter.get(t));f=Cv(f),e.formatter.apply(t,n,f),o.moveToBookmark(d)}else r&&i.nodeValue===UC||(r=HC(e.getDoc(),WC(!0).dom),i=r.firstChild,a.insertNode(r),s=1),e.formatter.apply(t,n,r),o.setCursorLocation(i,s)},nT=function(e,t,n,r){var i,o,a,s=e.dom,l=e.selection,u=[],c=l.getRng(),d=c.startContainer,f=c.startOffset;o=d,3===d.nodeType&&(f!==d.nodeValue.length&&(i=!0),o=o.parentNode);while(o){if(MC(e,o,t,n,r)){a=o;break}o.nextSibling&&(i=!0),u.push(o),o=o.parentNode}if(a)if(i){var h=l.getBookmark();c.collapse(!0);var m=ug(e,c,e.formatter.get(t),!0);m=Cv(m),e.formatter.remove(t,n,m,r),l.moveToBookmark(h)}else{var p=tp(e.getBody(),a),g=WC(!1).dom;JC(e,g,null!==p?p:a);var v=eT(e,g,a,t,n,r),b=ZC(u.concat(v.toArray()),g);YC(e,p,!1),l.setCursorLocation(b,1),s.isEmpty(a)&&s.remove(a)}},rT=function(e,t){var n=e.selection,r=e.getBody();XC(e,null,!1),8!==t&&46!==t||!n.isCollapsed()||n.getStart().innerHTML!==UC||XC(e,tp(r,n.getStart())),37!==t&&39!==t||XC(e,tp(r,n.getStart()))},iT=function(e){e.on("mouseup keydown",(function(t){rT(e,t.keyCode)}))},oT=function(e,t){var n=WC(!1),r=ZC(t,n.dom);return br(wn.fromDom(e),n),kr(wn.fromDom(e)),Rd(r,0)},aT=function(e,t){var n=e.schema.getTextInlineElements();return Re(n,Fn(t))&&!ep(t.dom)&&!Kr(t.dom)},sT=function(e){return ep(e.dom)&&qC(e.dom)},lT={},uT=$e,cT=Fe,dT=function(e,t){var n=lT[e];n||(lT[e]=[]),lT[e].push(t)},fT=function(e,t){cT(lT[e],(function(e){e(t)}))};dT("pre",(function(e){var t,n=e.selection.getRng(),r=function(e){return o(e.previousSibling)&&-1!==ze(t,e.previousSibling)},i=function(e,t){Iu(t).remove(),Iu(e).append("<br><br>").append(t.childNodes)},o=jr(["pre"]);n.collapsed||(t=e.selection.getSelectedBlocks(),cT(uT(uT(t,o),r),(function(e){i(e.previousSibling,e)})))}));var hT=mn.each,mT=function(e){return Hr(e)&&!xp(e)&&!ep(e)&&!Kr(e)},pT=function(e,t){for(var n=e;n;n=n[t]){if(Zr(n)&&mt(n.data))return e;if(Hr(n)&&!xp(n))return n}return e},gT=function(e,t,n){var r=Xy(e);if(t&&n&&(t=pT(t,"previousSibling"),n=pT(n,"nextSibling"),r.compare(t,n))){for(var i=t.nextSibling;i&&i!==n;){var o=i;i=i.nextSibling,t.appendChild(o)}return e.remove(n),mn.each(mn.grep(n.childNodes),(function(e){t.appendChild(e)})),t}return n},vT=function(e,t,n,r){if(r&&!1!==t.merge_siblings){var i=gT(e,Lp(r),r);gT(e,i,Lp(i,!0))}},bT=function(e,t,n){if(t.clear_child_styles){var r=t.links?"*:not(a)":"*";hT(e.select(r,n),(function(n){mT(n)&&hT(t.styles,(function(t,r){e.setStyle(n,r,"")}))}))}},yT=function(e,t,n){hT(e.childNodes,(function(e){mT(e)&&(t(e)&&n(e),e.hasChildNodes()&&yT(e,t,n))}))},wT=function(e,t){"SPAN"===t.nodeName&&0===e.getAttribs(t).length&&e.remove(t,!0)},ST=function(e,t){return function(n){return!(!n||!Bp(e,n,t))}},xT=function(e,t,n){return function(r){e.setStyle(r,t,n),""===r.getAttribute("style")&&r.removeAttribute("style"),wT(e,r)}},CT=Zi.generate([{keep:[]},{rename:["name"]},{removed:[]}]),TT=/^(src|href|style)$/,DT=mn.each,kT=Np,ET=function(e){return/^(TR|TH|TD)$/.test(e.nodeName)},_T=function(e,t,n){return e.isChildOf(t,n)&&t!==n&&!e.isBlock(n)},AT=function(e,t,n){var r=t[n?"startContainer":"endContainer"],i=t[n?"startOffset":"endOffset"];if(Hr(r)){var o=r.childNodes.length-1;!n&&i&&i--,r=r.childNodes[i>o?o:i]}return Zr(r)&&n&&i>=r.nodeValue.length&&(r=new zo(r,e.getBody()).next()||r),Zr(r)&&!n&&0===i&&(r=new zo(r,e.getBody()).prev()||r),r},LT=function(e,t){var n=t?"firstChild":"lastChild";if(ET(e)&&e[n]){var r=e[n];return"TR"===e.nodeName&&r[n]||r}return e},OT=function(e,t,n,r){var i=e.create(n,r);return t.parentNode.insertBefore(i,t),i.appendChild(t),i},RT=function(e,t,n,r,i){var o=wn.fromDom(t),a=wn.fromDom(e.create(r,i)),s=n?nr(o):tr(o);return Tr(a,s),n?(br(o,a),wr(a,o)):(yr(o,a),Sr(a,o)),a.dom},IT=function(e,t,n){return!(!qp(n)||!kT(t,n.inline))||(!(!Hp(n)||!kT(t,n.block))||(jp(n)?Hr(t)&&e.is(t,n.selector):void 0))},PT=function(e,t){return t.links&&"A"===e.nodeName},MT=function(e,t,n,r){var i=Lp(t,n,r);return C(i)||"BR"===i.nodeName||e.isBlock(i)},NT=function(e,t,n){var r,i=t.parentNode,o=e.dom,a=Df(e);Hp(n)&&(a?i===o.getRoot()&&(n.list_block&&kT(t,n.list_block)||Z(be(t.childNodes),(function(t){Rp(e,a,t.nodeName.toLowerCase())?r?r.appendChild(t):(r=OT(o,t,a),o.setAttribs(r,e.settings.forced_root_block_attrs)):r=null}))):o.isBlock(t)&&!o.isBlock(i)&&(MT(o,t,!1)||MT(o,t.firstChild,!0,!0)||t.insertBefore(o.create("br"),t.firstChild),MT(o,t,!0)||MT(o,t.lastChild,!1,!0)||t.appendChild(o.create("br")))),Gp(n)&&!kT(n.inline,t)||o.remove(t,!0)},FT=function(e,t,n,r,i){var o,a=e.dom;if(!IT(a,r,t)&&!PT(r,t))return CT.keep();var s=r;if(qp(t)&&"all"===t.remove&&y(t.preserve_attributes)){var l=ne(a.getAttribs(s),(function(e){return X(t.preserve_attributes,e.name.toLowerCase())}));if(a.removeAllAttribs(s),Z(l,(function(e){return a.setAttrib(s,e.name,e.value)})),l.length>0)return CT.rename("span")}if("all"!==t.remove){DT(t.styles,(function(e,r){e=Fp(a,Mp(e,n),r+""),k(r)&&(r=e,i=null),(t.remove_similar||!i||kT(Bp(a,i,r),e))&&a.setStyle(s,r,""),o=!0})),o&&""===a.getAttrib(s,"style")&&(s.removeAttribute("style"),s.removeAttribute("data-mce-style")),DT(t.attributes,(function(e,r){var o;if(e=Mp(e,n),k(r)&&(r=e,i=null),t.remove_similar||!i||kT(a.getAttrib(i,r),e)){if("class"===r&&(e=a.getAttrib(s,r),e&&(o="",Z(e.split(/\s+/),(function(e){/mce\-\w+/.test(e)&&(o+=(o?" ":"")+e)})),o)))return void a.setAttrib(s,r,o);if(TT.test(r)&&s.removeAttribute("data-mce-"+r),"style"===r&&jr(["li"])(s)&&"none"===a.getStyle(s,"list-style-type"))return s.removeAttribute(r),void a.setStyle(s,"list-style-type","none");"class"===r&&s.removeAttribute("className"),s.removeAttribute(r)}})),DT(t.classes,(function(e){e=Mp(e,n),i&&!a.hasClass(i,e)||a.removeClass(s,e)}));for(var u=a.getAttribs(s),c=0;c<u.length;c++){var d=u[c].nodeName;if(0!==d.indexOf("_")&&0!==d.indexOf("data-"))return CT.keep()}}return"none"!==t.remove?(NT(e,s,t),CT.removed()):CT.keep()},BT=function(e,t,n,r,i){return FT(e,t,n,r,i).fold(B,(function(t){return e.dom.rename(r,t),!0}),$)},$T=function(e,t,n,r,i){var o;return Z(zp(e.dom,t.parentNode).reverse(),(function(t){if(!o&&"_start"!==t.id&&"_end"!==t.id){var a=MC(e,t,n,r,i);a&&!1!==a.split&&(o=t)}})),o},zT=function(e,t,n,r){return FT(e,t,n,r,r).fold(L(r),(function(t){var n=e.dom.createFragment();return n.appendChild(r),e.dom.rename(r,t)}),L(null))},UT=function(e,t,n,r,i,o,a,s){var l,u,c,d=e.dom;if(n){for(var f=n.parentNode,h=r.parentNode;h&&h!==f;h=h.parentNode){l=d.clone(h,!1);for(var m=0;m<t.length;m++)if(l=zT(e,t[m],s,l),null===l)break;l&&(u&&l.appendChild(u),c||(c=l),u=l)}!o||a.mixed&&d.isBlock(n)||(r=d.split(n,r)),u&&(i.parentNode.insertBefore(u,i),c.appendChild(i),qp(a)&&vT(d,a,s,u))}return r},VT=function(e,t,n,r,i){var o=e.formatter.get(t),a=o[0],s=!0,l=e.dom,u=e.selection,c=function(r){var s=$T(e,r,t,n,i);return UT(e,o,s,r,r,!0,a,n)},d=function(e){return xp(e)&&Hr(e)&&("_start"===e.id||"_end"===e.id)},f=function(t){return J(o,(function(r){return BT(e,r,n,t,t)}))},h=function(t){var n=!0,r=!1;Hr(t)&&l.getContentEditable(t)&&(n=s,s="true"===l.getContentEditable(t),r=!0);var i=be(t.childNodes);if(s&&!r){var u=f(t),c=u||J(o,(function(e){return IC(l,t,e)})),d=t.parentNode;!c&&T(d)&&Wp(a)&&f(d)}if(a.deep&&i.length){for(var m=0;m<i.length;m++)h(i[m]);r&&(s=n)}var p=["underline","line-through","overline"];Z(p,(function(n){Hr(t)&&e.dom.getStyle(t,"text-decoration")===n&&t.parentNode&&$p(l,t.parentNode)===n&&BT(e,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:n}},null,t)}))},m=function(e){var t=l.get(e?"_start":"_end"),n=t[e?"firstChild":"lastChild"];return d(n)&&(n=n[e?"firstChild":"lastChild"]),Zr(n)&&0===n.data.length&&(n=e?t.previousSibling||t.nextSibling:t.nextSibling||t.previousSibling),l.remove(t,!0),n},p=function(t){var n,r,i=ug(e,t,o,t.collapsed);if(a.split){if(i=Cv(i),n=AT(e,i,!0),r=AT(e,i),n!==r){if(n=LT(n,!0),r=LT(r,!1),_T(l,n,r)){var s=j.from(n.firstChild).getOr(n);return c(RT(l,s,!0,"span",{id:"_start","data-mce-type":"bookmark"})),void m(!0)}if(_T(l,r,n)){s=j.from(r.lastChild).getOr(r);return c(RT(l,s,!1,"span",{id:"_end","data-mce-type":"bookmark"})),void m(!1)}n=OT(l,n,"span",{id:"_start","data-mce-type":"bookmark"}),r=OT(l,r,"span",{id:"_end","data-mce-type":"bookmark"});var u=l.createRng();u.setStartAfter(n),u.setEndBefore(r),cg(l,u,(function(e){Z(e,(function(e){xp(e)||xp(e.parentNode)||c(e)}))})),c(n),c(r),n=m(!0),r=m()}else n=r=c(n);i.startContainer=n.parentNode?n.parentNode:n,i.startOffset=l.nodeIndex(n),i.endContainer=r.parentNode?r.parentNode:r,i.endOffset=l.nodeIndex(r)+1}cg(l,i,(function(e){Z(e,h)}))};if(r){if(Ep(r)){var g=l.createRng();g.setStartBefore(r),g.setEndAfter(r),p(g)}else p(r);ev(e,t,r,n)}else if("false"!==l.getContentEditable(u.getNode()))u.isCollapsed()&&qp(a)&&!vg(e).length?nT(e,t,n,i):(Eg(u,!0,(function(){kg(e,p)})),qp(a)&&NC(e,t,n,u.getStart())&&Ap(l,u,u.getRng()),e.nodeChanged()),ev(e,t,r,n);else{r=u.getNode();for(var v=0;v<o.length;v++)if(o[v].ceFalseOverride&&BT(e,o[v],n,r,r))break;ev(e,t,r,n)}},HT=mn.each,jT=function(e,t,n,r){var i=function(t){if(1===t.nodeType&&t.parentNode&&1===t.parentNode.nodeType){var n=$p(e,t.parentNode);e.getStyle(t,"color")&&n?e.setStyle(t,"text-decoration",n):e.getStyle(t,"text-decoration")===n&&e.setStyle(t,"text-decoration",null)}};t.styles&&(t.styles.color||t.styles.textDecoration)&&(mn.walk(r,i,"childNodes"),i(r))},qT=function(e,t,n,r){t.styles&&t.styles.backgroundColor&&yT(r,ST(e,"fontSize"),xT(e,"backgroundColor",Mp(t.styles.backgroundColor,n)))},GT=function(e,t,n,r){!qp(t)||"sub"!==t.inline&&"sup"!==t.inline||(yT(r,ST(e,"fontSize"),xT(e,"fontSize","")),e.remove(e.select("sup"===t.inline?"sub":"sup",r),!0))},WT=function(e,t,n,r){HT(t,(function(t){qp(t)&&HT(e.dom.select(t.inline,r),(function(r){mT(r)&&BT(e,t,n,r,t.exact?r:null)})),bT(e.dom,t,r)}))},KT=function(e,t,n,r,i){MC(e,i.parentNode,n,r)&&BT(e,t,r,i)||t.merge_with_parents&&e.dom.getParent(i.parentNode,(function(o){if(MC(e,o,n,r))return BT(e,t,r,i),!0}))},YT=mn.each,XT=function(e){return Hr(e)&&!xp(e)&&!ep(e)&&!Kr(e)},JT=function(e,t,n,r){if(uh(e)&&qp(t)){var i=Bs(e.schema),o=kC(wn.fromDom(n),(function(e){return ep(e.dom)}));return Ie(i,r)&&ns(wn.fromDom(n.parentNode),!1)&&!o}return!1},QT=function(e,t,n,r){var i=e.formatter.get(t),o=i[0],a=!r&&e.selection.isCollapsed(),s=e.dom,l=e.selection,u=function(e,t){if(void 0===t&&(t=o),D(t.onformat)&&t.onformat(e,t,n,r),YT(t.styles,(function(t,r){s.setStyle(e,r,Mp(t,n))})),t.styles){var i=s.getAttrib(e,"style");i&&s.setAttrib(e,"data-mce-style",i)}YT(t.attributes,(function(t,r){s.setAttrib(e,r,Mp(t,n))})),YT(t.classes,(function(t){t=Mp(t,n),s.hasClass(e,t)||s.addClass(e,t)}))},c=function(e,t){var n=!1;return YT(e,(function(e){return!!jp(e)&&(T(e.collapsed)&&e.collapsed!==a?void 0:s.is(t,e.selector)&&!ep(t)?(u(t,e),n=!0,!1):void 0)})),n},d=function(e){if(v(e)){var t=s.create(e);return u(t),t}return null},f=function(r,a,s){var l=[],f=!0,h=o.inline||o.block,m=d(h);cg(r,a,(function(a){var d,p=function(a){var g=!1,v=f,b=a.nodeName.toLowerCase(),y=a.parentNode,w=y.nodeName.toLowerCase();if(Hr(a)&&r.getContentEditable(a)&&(v=f,f="true"===r.getContentEditable(a),g=!0),ri(a)&&!JT(e,o,a,w))return d=null,void(Hp(o)&&r.remove(a));if(Hp(o)&&o.wrapper&&MC(e,a,t,n))d=null;else{if(f&&!g&&Hp(o)&&!o.wrapper&&Op(e,b)&&Rp(e,w,h)){var S=r.rename(a,h);return u(S),l.push(S),void(d=null)}if(jp(o)){var x=c(i,a);if(!x&&T(y)&&Wp(o)&&(x=c(i,y)),!qp(o)||x)return void(d=null)}!f||g||!Rp(e,h,b)||!Rp(e,w,h)||!s&&Zr(a)&&ha(a.data)||ep(a)||qp(o)&&r.isBlock(a)?(d=null,Z(be(a.childNodes),p),g&&(f=v),d=null):(d||(d=r.clone(m,!1),a.parentNode.insertBefore(d,a),l.push(d)),d.appendChild(a))}};Z(a,p)})),!0===o.links&&Z(l,(function(e){var t=function(e){"A"===e.nodeName&&u(e,o),Z(be(e.childNodes),t)};t(e)})),Z(l,(function(a){var s=function(e){var t=0;return Z(e.childNodes,(function(e){Pp(e)||xp(e)||t++})),t},c=function(e){var t=ae(e.childNodes,XT).filter((function(e){return IC(r,e,o)}));return t.map((function(t){var n=r.clone(t,!1);return u(n),r.replace(n,e,!0),r.remove(t,!0),n})).getOr(e)},d=s(a);!(l.length>1)&&r.isBlock(a)||0!==d?(qp(o)||Hp(o)&&o.wrapper)&&(o.exact||1!==d||(a=c(a)),WT(e,i,n,a),KT(e,o,t,n,a),qT(r,o,n,a),jT(r,o,n,a),GT(r,o,n,a),vT(r,o,n,a)):r.remove(a,!0)}))};if("false"!==s.getContentEditable(l.getNode())){if(o){if(r)if(Ep(r)){if(!c(i,r)){var h=s.createRng();h.setStartBefore(r),h.setEndAfter(r),f(s,ug(e,h,i),!0)}}else f(s,r,!0);else if(a&&qp(o)&&!vg(e).length)tT(e,t,n);else{var m=l.getNode(),p=i[0];e.settings.forced_root_block||!p.defaultBlock||s.getParent(m,s.isBlock)||QT(e,p.defaultBlock),l.setRng(Px(l.getRng())),Eg(l,!0,(function(){kg(e,(function(t,n){var r=n?t:ug(e,t,i);f(s,r,!1)}))})),Ap(s,l,l.getRng()),e.nodeChanged()}fT(t,e)}Zg(e,t,r,n)}else{r=l.getNode();for(var g=0,b=i.length;g<b;g++){var y=i[g];if(y.ceFalseOverride&&jp(y)&&s.is(r,y.selector)){u(r,y);break}}Zg(e,t,r,n)}},ZT=function(e){return Re(e,"vars")},eD=function(e,t){e.set({}),t.on("NodeChange",(function(n){iD(t,n.element,e.get())})),t.on("FormatApply FormatRemove",(function(n){var r=j.from(n.node).map((function(e){return Ep(e)?e:e.startContainer})).bind((function(e){return Hr(e)?j.some(e):j.from(e.parentElement)})).getOrThunk((function(){return tD(t)}));iD(t,r,e.get())}))},tD=function(e){return e.selection.getStart()},nD=function(e,t,n,r,i){var o=function(t){var o=e.formatter.matchNode(t,n,null!==i&&void 0!==i?i:{},r);return!x(o)},a=function(t){return!!OC(e,t,n)||!r&&T(e.formatter.matchNode(t,n,i,!0))};return oe(t,o,a)},rD=function(e,t){var n=null!==t&&void 0!==t?t:tD(e);return ne(zp(e.dom,n),(function(e){return Hr(e)&&!Kr(e)}))},iD=function(e,t,n){var r=rD(e,t);xe(n,(function(n,i){var o=function(n){var o=nD(e,r,i,n.similar,ZT(n)?n.vars:void 0),a=o.isSome();if(n.state.get()!==a){n.state.set(a);var s=o.getOr(t);ZT(n)?n.callback(a,{node:s,format:i,parents:r}):Z(n.callbacks,(function(e){return e(a,{node:s,format:i,parents:r})}))}};Z([n.withSimilar,n.withoutSimilar],o),Z(n.withVars,o)}))},oD=function(e,t,n,r,i,o){var a=t.get();Z(n.split(","),(function(t){var n=Oe(a,t).getOrThunk((function(){var e={withSimilar:{state:Xu(!1),similar:!0,callbacks:[]},withoutSimilar:{state:Xu(!1),similar:!1,callbacks:[]},withVars:[]};return a[t]=e,e})),s=function(){var n=rD(e);return nD(e,n,t,i,o).isSome()};if(x(o)){var l=i?n.withSimilar:n.withoutSimilar;l.callbacks.push(r),1===l.callbacks.length&&l.state.set(s())}else n.withVars.push({state:Xu(s()),similar:i,vars:o,callback:r})})),t.set(a)},aD=function(e,t,n){var r=e.get();Z(t.split(","),(function(e){return Oe(r,e).each((function(t){r[e]={withSimilar:je(je({},t.withSimilar),{callbacks:ne(t.withSimilar.callbacks,(function(e){return e!==n}))}),withoutSimilar:je(je({},t.withoutSimilar),{callbacks:ne(t.withoutSimilar.callbacks,(function(e){return e!==n}))}),withVars:ne(t.withVars,(function(e){return e.callback!==n}))}}))})),e.set(r)},sD=function(e,t,n,r,i,o){return null===t.get()&&eD(t,e),oD(e,t,n,r,i,o),{unbind:function(){return aD(t,n,r)}}},lD=function(e,t,n,r){var i=e.formatter.get(t);!NC(e,t,n,r)||"toggle"in i[0]&&!i[0].toggle?QT(e,t,n,r):VT(e,t,n,r)},uD=function(e,t){var n=t||document,r=n.createDocumentFragment();return Z(e,(function(e){r.appendChild(e.dom)})),wn.fromDom(r)},cD=function(e,t,n){return{element:e,width:t,rows:n}},dD=function(e,t){return{element:e,cells:t}},fD=function(e,t){return{x:e,y:t}},hD=function(e,t){var n=parseInt(bi(e,t),10);return isNaN(n)?1:n},mD=function(e,t,n,r,i){for(var o=hD(i,"rowspan"),a=hD(i,"colspan"),s=e.rows,l=n;l<n+o;l++){s[l]||(s[l]=dD(Wc(r),[]));for(var u=t;u<t+a;u++){var c=s[l].cells;c[u]=l===n&&u===t?i:Gc(i)}}},pD=function(e,t,n){var r=e.rows,i=r[n]?r[n].cells:[];return!!i[t]},gD=function(e,t,n){while(pD(e,t,n))t++;return t},vD=function(e){return ie(e,(function(e,t){return t.cells.length>e?t.cells.length:e}),0)},bD=function(e,t){for(var n=e.rows,r=0;r<n.length;r++)for(var i=n[r].cells,o=0;o<i.length;o++)if(In(i[o],t))return j.some(fD(o,r));return j.none()},yD=function(e,t,n,r,i){for(var o=[],a=e.rows,s=n;s<=i;s++){var l=a[s].cells,u=t<r?l.slice(t,r+1):l.slice(r,t+1);o.push(dD(a[s].element,u))}return o},wD=function(e,t,n){var r=t.x,i=t.y,o=n.x,a=n.y,s=i<a?yD(e,r,i,o,a):yD(e,r,a,o,i);return cD(e.element,vD(s),s)},SD=function(e,t){var n=Gc(e.element),r=wn.fromTag("tbody");return Tr(r,t),Sr(n,r),n},xD=function(e){return Q(e.rows,(function(e){var t=Q(e.cells,(function(e){var t=Wc(e);return Si(t,"colspan"),Si(t,"rowspan"),t})),n=Gc(e.element);return Tr(n,t),n}))},CD=function(e){var t=cD(Gc(e),0,[]);return Z(Ec(e,"tr"),(function(e,n){Z(Ec(e,"td,th"),(function(r,i){mD(t,gD(t,i,n),n,e,r)}))})),cD(t.element,vD(t.rows),t.rows)},TD=function(e){return SD(e,xD(e))},DD=function(e,t,n){return bD(e,t).bind((function(t){return bD(e,n).map((function(n){return wD(e,t,n)}))}))},kD=function(e){return ae(e,(function(e){return"ul"===Fn(e)||"ol"===Fn(e)}))},ED=function(e,t){return ae(e,(function(e){return"li"===Fn(e)&&Cg(e,t)})).fold(L([]),(function(t){return kD(e).map((function(e){var t=wn.fromTag(Fn(e)),n=_e(_i(e),(function(e,t){return ut(t,"list-style")}));return Ti(t,n),[wn.fromTag("li"),t]})).getOr([])}))},_D=function(e,t){var n=ie(t,(function(e,t){return Sr(t,e),t}),e);return t.length>0?uD([n]):n},AD=function(e){return ra(e)?Xn(e).filter(na).fold(L([]),(function(t){return[e,t]})):na(e)?[e]:[]},LD=function(e,t){var n=wn.fromDom(t.commonAncestorContainer),r=Aw(n,e),i=ne(r,(function(e){return Zo(e)||Xo(e)})),o=ED(r,t),a=i.concat(o.length?o:AD(n));return Q(a,Gc)},OD=function(){return uD([])},RD=function(e,t){return _D(wn.fromDom(t.cloneContents()),LD(e,t))},ID=function(e,t){return ko(t,"table",I(In,e))},PD=function(e,t){return ID(e,t[0]).bind((function(e){var n=t[0],r=t[t.length-1],i=CD(e);return DD(i,n,r).map((function(e){return uD([TD(e)])}))})).getOrThunk(OD)},MD=function(e,t){return t.length>0&&t[0].collapsed?OD():RD(e,t[0])},ND=function(e,t){var n=gg(t,e);return n.length>0?PD(e,n):MD(e,t)},FD=function(e){return e.replace(/^[ \f\n\r\t\v]+/,"")},BD=function(e,t){return t>=0&&t<e.length&&Dp(e.charAt(t))},$D=function(e,t){var n=ma(e.innerText);return t?FD(n):n},zD=function(e){return e.map((function(e){return e.nodeName})).getOr("div").toLowerCase()},UD=function(e){return j.from(e.selection.getRng()).map((function(t){var n=j.from(e.dom.getParent(t.commonAncestorContainer,e.dom.isBlock)),r=e.getBody(),i=zD(n),o=en.browser.isIE()&&"pre"!==i,a=e.dom.add(r,i,{"data-mce-bogus":"all",style:"overflow: hidden; opacity: 0;"},t.cloneContents()),s=$D(a,o),l=ma(a.textContent);if(e.dom.remove(a),BD(l,0)||BD(l,l.length-1)){var u=n.getOr(r),c=$D(u,o),d=c.indexOf(s);if(-1===d)return s;var f=BD(c,d-1),h=BD(c,d+s.length);return(f?" ":"")+s+(h?" ":"")}return s})).getOr("")},VD=function(e,t){var n=e.selection.getRng(),r=e.dom.create("body"),i=e.selection.getSel(),o=Ty(e,dg(i)),a=t.contextual?ND(wn.fromDom(e.getBody()),o).dom:n.cloneContents();return a&&r.appendChild(a),e.selection.serializer.serialize(r,t)},HD=function(e,t){return je(je({},e),{format:t,get:!0,selection:!0})},jD=function(e,t,n){void 0===n&&(n={});var r=HD(n,t),i=e.fire("BeforeGetContent",r);if(i.isDefaultPrevented())return e.fire("GetContent",i),i.content;if("text"===i.format)return UD(e);i.getInner=!0;var o=VD(e,i);return"tree"===i.format?o:(i.content=e.selection.isCollapsed()?"":o,e.fire("GetContent",i),i.content)},qD=0,GD=1,WD=2,KD=function(e,t){var n=e.length+t.length+2,r=new Array(n),i=new Array(n),o=function(e,t,n){return{start:e,end:t,diag:n}},a=function(n,r,i,o,s){var u=l(n,r,i,o);if(null===u||u.start===r&&u.diag===r-o||u.end===n&&u.diag===n-i){var c=n,d=i;while(c<r||d<o)c<r&&d<o&&e[c]===t[d]?(s.push([qD,e[c]]),++c,++d):r-n>o-i?(s.push([WD,e[c]]),++c):(s.push([GD,t[d]]),++d)}else{a(n,u.start,i,u.start-u.diag,s);for(var f=u.start;f<u.end;++f)s.push([qD,e[f]]);a(u.end,r,u.end-u.diag,o,s)}},s=function(n,r,i,a){var s=n;while(s-r<a&&s<i&&e[s]===t[s-r])++s;return o(n,s,r)},l=function(n,o,a,l){var u=o-n,c=l-a;if(0===u||0===c)return null;var d,f,h,m,p,g=u-c,v=c+u,b=(v%2===0?v:v+1)/2;for(r[1+b]=n,i[1+b]=o+1,d=0;d<=b;++d){for(f=-d;f<=d;f+=2){h=f+b,f===-d||f!==d&&r[h-1]<r[h+1]?r[h]=r[h+1]:r[h]=r[h-1]+1,m=r[h],p=m-n+a-f;while(m<o&&p<l&&e[m]===t[p])r[h]=++m,++p;if(g%2!==0&&g-d<=f&&f<=g+d&&i[h-g]<=r[h])return s(i[h-g],f+n-a,o,l)}for(f=g-d;f<=g+d;f+=2){h=f+b-g,f===g-d||f!==g+d&&i[h+1]<=i[h-1]?i[h]=i[h+1]-1:i[h]=i[h-1],m=i[h]-1,p=m-n+a-f;while(m>=n&&p>=a&&e[m]===t[p])i[h]=m--,p--;if(g%2===0&&-d<=f&&f<=d&&i[h]<=r[h+g])return s(i[h],f+n-a,o,l)}}},u=[];return a(0,e.length,0,t.length,u),u},YD=function(e){return Hr(e)?e.outerHTML:Zr(e)?_s.encodeRaw(e.data,!1):ei(e)?"\x3c!--"+e.data+"--\x3e":""},XD=function(e){var t,n=document.createElement("div"),r=document.createDocumentFragment();e&&(n.innerHTML=e);while(t=n.firstChild)r.appendChild(t);return r},JD=function(e,t,n){var r=XD(t);if(e.hasChildNodes()&&n<e.childNodes.length){var i=e.childNodes[n];i.parentNode.insertBefore(r,i)}else e.appendChild(r)},QD=function(e,t){if(e.hasChildNodes()&&t<e.childNodes.length){var n=e.childNodes[t];n.parentNode.removeChild(n)}},ZD=function(e,t){var n=0;Z(e,(function(e){e[0]===qD?n++:e[0]===GD?(JD(t,e[1],n),n++):e[0]===WD&&QD(t,n)}))},ek=function(e,t){return ne(Q(be(e.childNodes),t?_(ma,YD):YD),(function(e){return e.length>0}))},tk=function(e,t){var n=Q(be(t.childNodes),YD);return ZD(KD(n,e),t),t},nk=We((function(){return document.implementation.createHTMLDocument("undo")})),rk=function(e){return null!==e.querySelector("iframe")},ik=function(e){return{type:"fragmented",fragments:e,content:"",bookmark:null,beforeBookmark:null}},ok=function(e){return{type:"complete",fragments:null,content:e,bookmark:null,beforeBookmark:null}},ak=function(e){var t=e.serializer.getTempAttrs(),n=jy(e.getBody(),t);return rk(n)?ik(ek(n,!0)):ok(ma(n.innerHTML))},sk=function(e,t,n){var r=n?t.beforeBookmark:t.bookmark;"fragmented"===t.type?tk(t.fragments,e.getBody()):e.setContent(t.content,{format:"raw",no_selection:!T(r)||!ap(r)||!r.isFakeCaret}),e.selection.moveToBookmark(r)},lk=function(e){return"fragmented"===e.type?e.fragments.join(""):e.content},uk=function(e){var t=wn.fromTag("body",nk());return jc(t,lk(e)),Z(Ec(t,"*[data-mce-bogus]"),Er),Hc(t)},ck=function(e,t){return lk(e)===lk(t)},dk=function(e,t){return uk(e)===uk(t)},fk=function(e,t){return!(!e||!t)&&(!!ck(e,t)||dk(e,t))},hk=function(e){return 0===e.get()},mk=function(e,t,n){hk(n)&&(e.typing=t)},pk=function(e,t){e.typing&&(mk(e,!1,t),e.add())},gk=function(e){e.typing&&(e.typing=!1,e.add())},vk=function(e,t,n){hk(t)&&n.set(mf(e.selection))},bk=function(e,t,n,r,i,o,a){var s=ak(e);if(o=o||{},o=mn.extend(o,s),!1===hk(r)||e.removed)return null;var l=t.data[n.get()];if(e.fire("BeforeAddUndo",{level:o,lastLevel:l,originalEvent:a}).isDefaultPrevented())return null;if(l&&fk(l,o))return null;t.data[n.get()]&&i.get().each((function(e){t.data[n.get()].beforeBookmark=e}));var u=yh(e);if(u&&t.data.length>u){for(var c=0;c<t.data.length-1;c++)t.data[c]=t.data[c+1];t.data.length--,n.set(t.data.length)}o.bookmark=mf(e.selection),n.get()<t.data.length-1&&(t.data.length=n.get()+1),t.data.push(o),n.set(t.data.length-1);var d={level:o,lastLevel:l,originalEvent:a};return n.get()>0?(e.setDirty(!0),e.fire("AddUndo",d),e.fire("change",d)):e.fire("AddUndo",d),o},yk=function(e,t,n){t.data=[],n.set(0),t.typing=!1,e.fire("ClearUndos")},wk=function(e,t,n,r,i){if(t.transact(r)){var o=t.data[n.get()].bookmark,a=t.data[n.get()-1];sk(e,a,!0),t.transact(i)&&(t.data[n.get()-1].beforeBookmark=o)}},Sk=function(e,t,n){var r;return t.get()<n.length-1&&(t.set(t.get()+1),r=n[t.get()],sk(e,r,!1),e.setDirty(!0),e.fire("Redo",{level:r})),r},xk=function(e,t,n,r){var i;return t.typing&&(t.add(),t.typing=!1,mk(t,!1,n)),r.get()>0&&(r.set(r.get()-1),i=t.data[r.get()],sk(e,i,!0),e.setDirty(!0),e.fire("Undo",{level:i})),i},Ck=function(e){e.clear(),e.add()},Tk=function(e,t,n){return n.get()>0||t.typing&&t.data[0]&&!fk(ak(e),t.data[0])},Dk=function(e,t){return t.get()<e.data.length-1&&!e.typing},kk=function(e,t,n){return pk(e,t),e.beforeChange(),e.ignore(n),e.add()},Ek=function(e,t){try{e.set(e.get()+1),t()}finally{e.set(e.get()-1)}},_k=function(e,t){var n=e.dom,r=T(t)?t:e.getBody();x(e.hasVisual)&&(e.hasVisual=kh(e)),Z(n.select("table,a",r),(function(t){switch(t.nodeName){case"TABLE":var r=Eh(e),i=n.getAttrib(t,"border");i&&"0"!==i||!e.hasVisual?n.removeClass(t,r):n.addClass(t,r);break;case"A":if(!n.getAttrib(t,"href")){var o=n.getAttrib(t,"name")||t.id,a=_h(e);o&&e.hasVisual?n.addClass(t,a):n.removeClass(t,a)}break}})),e.fire("VisualAid",{element:t,hasVisual:e.hasVisual})},Ak=function(e){return{undoManager:{beforeChange:function(t,n){return vk(e,t,n)},add:function(t,n,r,i,o,a){return bk(e,t,n,r,i,o,a)},undo:function(t,n,r){return xk(e,t,n,r)},redo:function(t,n){return Sk(e,t,n)},clear:function(t,n){return yk(e,t,n)},reset:function(e){return Ck(e)},hasUndo:function(t,n){return Tk(e,t,n)},hasRedo:function(e,t){return Dk(e,t)},transact:function(e,t,n){return kk(e,t,n)},ignore:function(e,t){return Ek(e,t)},extra:function(t,n,r,i){return wk(e,t,n,r,i)}},formatter:{match:function(t,n,r,i){return NC(e,t,n,r,i)},matchAll:function(t,n){return FC(e,t,n)},matchNode:function(t,n,r,i){return MC(e,t,n,r,i)},canApply:function(t){return $C(e,t)},closest:function(t){return BC(e,t)},apply:function(t,n,r){return QT(e,t,n,r)},remove:function(t,n,r,i){return VT(e,t,n,r,i)},toggle:function(t,n,r){return lD(e,t,n,r)},formatChanged:function(t,n,r,i,o){return sD(e,t,n,r,i,o)}},editor:{getContent:function(t,n){return Ky(e,t,n)},setContent:function(t,n){return DC(e,t,n)},insertContent:function(t,n){return mC(e,t,n)},addVisual:function(t){return _k(e,t)}},selection:{getContent:function(t,n){return jD(e,t,n)}},raw:{getModel:function(){return j.none()}}}},Lk=function(e){var t=function(e){return b(e)?e:{}},n=e.undoManager,r=e.formatter,i=e.editor,o=e.selection,a=e.raw;return{undoManager:{beforeChange:n.beforeChange,add:n.add,undo:n.undo,redo:n.redo,clear:n.clear,reset:n.reset,hasUndo:n.hasUndo,hasRedo:n.hasRedo,transact:function(e,t,r){return n.transact(r)},ignore:function(e,t){return n.ignore(t)},extra:function(e,t,r,i){return n.extra(r,i)}},formatter:{match:function(e,n,i,o){return r.match(e,t(n),o)},matchAll:r.matchAll,matchNode:r.matchNode,canApply:function(e){return r.canApply(e)},closest:function(e){return r.closest(e)},apply:function(e,n,i){return r.apply(e,t(n))},remove:function(e,n,i,o){return r.remove(e,t(n))},toggle:function(e,n,i){return r.toggle(e,t(n))},formatChanged:function(e,t,n,i,o){return r.formatChanged(t,n,i,o)}},editor:{getContent:function(e,t){return i.getContent(e)},setContent:function(e,t){return i.setContent(e,t)},insertContent:function(e,t){return i.insertContent(e)},addVisual:i.addVisual},selection:{getContent:function(e,t){return o.getContent(t)}},raw:{getModel:function(){return j.some(a.getRawModel())}}}},Ok=function(){var e=L(null),t=L("");return{undoManager:{beforeChange:E,add:e,undo:e,redo:e,clear:E,reset:E,hasUndo:B,hasRedo:B,transact:e,ignore:E,extra:E},formatter:{match:B,matchAll:L([]),matchNode:L(void 0),canApply:B,closest:t,apply:E,remove:E,toggle:E,formatChanged:L({unbind:E})},editor:{getContent:t,setContent:t,insertContent:E,addVisual:E},selection:{getContent:t},raw:{getModel:L(j.none())}}},Rk=function(e){return Re(e.plugins,"rtc")},Ik=function(e){return Oe(e.plugins,"rtc").bind((function(e){return j.from(e.setup)}))},Pk=function(e){var t=e;return Ik(e).fold((function(){return t.rtcInstance=Ak(e),j.none()}),(function(e){return t.rtcInstance=Ok(),j.some((function(){return e().then((function(e){return t.rtcInstance=Lk(e),e.rtc.isRemote}))}))}))},Mk=function(e){return e.rtcInstance?e.rtcInstance:Ak(e)},Nk=function(e){var t=e.rtcInstance;if(t)return t;throw new Error("Failed to get RTC instance not yet initialized.")},Fk=function(e,t,n){Nk(e).undoManager.beforeChange(t,n)},Bk=function(e,t,n,r,i,o,a){return Nk(e).undoManager.add(t,n,r,i,o,a)},$k=function(e,t,n,r){return Nk(e).undoManager.undo(t,n,r)},zk=function(e,t,n){return Nk(e).undoManager.redo(t,n)},Uk=function(e,t,n){Nk(e).undoManager.clear(t,n)},Vk=function(e,t){Nk(e).undoManager.reset(t)},Hk=function(e,t,n){return Nk(e).undoManager.hasUndo(t,n)},jk=function(e,t,n){return Nk(e).undoManager.hasRedo(t,n)},qk=function(e,t,n,r){return Nk(e).undoManager.transact(t,n,r)},Gk=function(e,t,n){Nk(e).undoManager.ignore(t,n)},Wk=function(e,t,n,r,i){Nk(e).undoManager.extra(t,n,r,i)},Kk=function(e,t,n,r,i){return Nk(e).formatter.match(t,n,r,i)},Yk=function(e,t,n){return Nk(e).formatter.matchAll(t,n)},Xk=function(e,t,n,r,i){return Nk(e).formatter.matchNode(t,n,r,i)},Jk=function(e,t){return Nk(e).formatter.canApply(t)},Qk=function(e,t){return Nk(e).formatter.closest(t)},Zk=function(e,t,n,r){Nk(e).formatter.apply(t,n,r)},eE=function(e,t,n,r,i){Nk(e).formatter.remove(t,n,r,i)},tE=function(e,t,n,r){Nk(e).formatter.toggle(t,n,r)},nE=function(e,t,n,r,i,o){return Nk(e).formatter.formatChanged(t,n,r,i,o)},rE=function(e,t,n){return Mk(e).editor.getContent(t,n)},iE=function(e,t,n){return Mk(e).editor.setContent(t,n)},oE=function(e,t,n){return Mk(e).editor.insertContent(t,n)},aE=function(e,t,n){return Nk(e).selection.getContent(t,n)},sE=function(e,t){return Nk(e).editor.addVisual(t)},lE=function(e,t){void 0===t&&(t={});var n=t.format?t.format:"html";return aE(e,n,t)},uE=function(e){return 0===e.dom.length?(kr(e),j.none()):j.some(e)},cE=function(e,t){return e.filter((function(e){return Bg.isBookmarkNode(e.dom)})).bind(t?er:Zn)},dE=function(e,t,n,r){var i=e.dom,o=t.dom,a=r?i.length:o.length;r?(gS(i,o,!1,!r),n.setStart(o,a)):(gS(o,i,!1,!r),n.setEnd(o,a))},fE=function(e,t){Xn(e).each((function(n){var r=e.dom;t&&eS(n,Rd(r,0))?mS(r,0):!t&&nS(n,Rd(r,r.length))&&pS(r,r.length)}))},hE=function(e,t,n,r){e.bind((function(e){var i=r?pS:mS;return i(e.dom,r?e.dom.length:0),t.filter(Vn).map((function(t){return dE(e,t,n,r)}))})).orThunk((function(){var e=cE(t,r).or(t).filter(Vn);return e.map((function(e){return fE(e,r)}))}))},mE=function(e,t){var n=j.from(t.firstChild).map(wn.fromDom),r=j.from(t.lastChild).map(wn.fromDom);e.deleteContents(),e.insertNode(t);var i=n.bind(Zn).filter(Vn).bind(uE),o=r.bind(er).filter(Vn).bind(uE);hE(i,n,e,!0),hE(o,r,e,!1),e.collapse(!1)},pE=function(e,t){return je(je({format:"html"},e),{set:!0,selection:!0,content:t})},gE=function(e,t){if("raw"!==t.format){var n=e.selection.getRng(),r=e.dom.getParent(n.commonAncestorContainer,e.dom.isBlock),i=r?{context:r.nodeName.toLowerCase()}:{},o=e.parser.parse(t.content,je(je({isRootContent:!0,forced_root_block:!1},i),t));return Zy({validate:e.validate},e.schema).serialize(o)}return t.content},vE=function(e,t,n){void 0===n&&(n={});var r=pE(n,t),i=r;if(!r.no_events){var o=e.fire("BeforeSetContent",r);if(o.isDefaultPrevented())return void e.fire("SetContent",o);i=o}i.content=gE(e,i);var a=e.selection.getRng();mE(a,a.createContextualFragment(i.content)),e.selection.setRng(a),nb(e,a),i.no_events||e.fire("SetContent",i)},bE=function(e,t,n){if(e&&Re(e,t)){var r=ne(e[t],(function(e){return e!==n}));0===r.length?delete e[t]:e[t]=r}};function yE(e,t){var n,r,i=function(t,n){return ae(n,(function(n){return e.is(n,t)}))},o=function(t){return e.getParents(t,null,e.getRoot())};return{selectorChangedWithUnbind:function(e,a){return n||(n={},r={},t.on("NodeChange",(function(e){var t=e.element,a=o(t),s={};mn.each(n,(function(e,t){i(t,a).each((function(n){r[t]||(Z(e,(function(e){e(!0,{node:n,selector:t,parents:a})})),r[t]=e),s[t]=e}))})),mn.each(r,(function(e,n){s[n]||(delete r[n],mn.each(e,(function(e){e(!1,{node:t,selector:n,parents:a})})))}))}))),n[e]||(n[e]=[]),n[e].push(a),i(e,o(t.selection.getStart())).each((function(){r[e]=n[e]})),{unbind:function(){bE(n,e,a),bE(r,e,a)}}}}}var wE=function(e){return!!e.select},SE=function(e){return!(!e||!e.ownerDocument)&&Nn(wn.fromDom(e.ownerDocument),wn.fromDom(e))},xE=function(e){return!!e&&(!!wE(e)||SE(e.startContainer)&&SE(e.endContainer))},CE=function(e,t,n,r){var i,o,a=yE(e,r).selectorChangedWithUnbind,s=function(t,n){var i=e.createRng();T(t)&&T(n)?(i.setStart(t,n),i.setEnd(t,n),y(i),g(!1)):(Tg(e,i,r.getBody(),!0),y(i))},l=function(e){return lE(r,e)},u=function(e,t){return vE(r,e,t)},c=function(e){return by(r.getBody(),b(),e)},d=function(e){return yy(r.getBody(),b(),e)},f=function(e,t){return I.getBookmark(e,t)},h=function(e){return I.moveToBookmark(e)},m=function(t,n){return Cy(e,t,n).each(y),t},p=function(){var e=b(),t=v();return!(!e||e.item)&&(e.compareEndPoints?0===e.compareEndPoints("StartToEnd",e):!t||e.collapsed)},g=function(e){var t=b();t.collapse(!!e),y(t)},v=function(){return t.getSelection?t.getSelection():t.document.selection},b=function(){var n,a,s,l=function(e,t,n){try{return t.compareBoundaryPoints(e,n)}catch(r){return-1}},u=t.document;if(void 0!==r.bookmark&&!1===fy(r)){var c=$b(r);if(c.isSome())return c.map((function(e){return Ty(r,[e])[0]})).getOr(u.createRange())}try{(n=v())&&!Vr(n.anchorNode)&&(a=n.rangeCount>0?n.getRangeAt(0):n.createRange?n.createRange():u.createRange(),a=Ty(r,[a])[0])}catch(d){}return a||(a=u.createRange?u.createRange():u.body.createTextRange()),a.setStart&&9===a.startContainer.nodeType&&a.collapsed&&(s=e.getRoot(),a.setStart(s,0),a.setEnd(s,0)),i&&o&&(0===l(a.START_TO_START,a,i)&&0===l(a.END_TO_END,a,i)?a=o:(i=null,o=null)),a},y=function(e,t){var n;if(xE(e)){var a=wE(e)?e:null;if(a){o=null;try{a.select()}catch(u){}}else{var s=v(),l=r.fire("SetSelectionRange",{range:e,forward:t});if(e=l.range,s){o=e;try{s.removeAllRanges(),s.addRange(e)}catch(u){}!1===t&&s.extend&&(s.collapse(e.endContainer,e.endOffset),s.extend(e.startContainer,e.startOffset)),i=s.rangeCount>0?s.getRangeAt(0):null}e.collapsed||e.startContainer!==e.endContainer||!s.setBaseAndExtent||en.ie||e.endOffset-e.startOffset<2&&e.startContainer.hasChildNodes()&&(n=e.startContainer.childNodes[e.startOffset],n&&"IMG"===n.tagName&&(s.setBaseAndExtent(e.startContainer,e.startOffset,e.endContainer,e.endOffset),s.anchorNode===e.startContainer&&s.focusNode===e.endContainer||s.setBaseAndExtent(n,0,n,1))),r.fire("AfterSetSelectionRange",{range:e,forward:t})}}},w=function(t){return u(e.getOuterHTML(t)),t},S=function(){return Sy(r.getBody(),b())},x=function(t,n){return xy(e,b(),t,n)},C=function(){var t=v(),n=null===t||void 0===t?void 0:t.anchorNode,r=null===t||void 0===t?void 0:t.focusNode;if(!t||!n||!r||Vr(n)||Vr(r))return!0;var i=e.createRng();i.setStart(n,t.anchorOffset),i.collapse(!0);var o=e.createRng();return o.setStart(r,t.focusOffset),o.collapse(!0),i.compareBoundaryPoints(i.START_TO_START,o)<=0},D=function(){var t=b(),n=v();if(!hg(n)&&Dg(r)){var i=Sv(e,t);return i.each((function(e){y(e,C())})),i.getOr(t)}return t},k=function(e,t){return a(e,t),R},E=function(){var t,n=e.getRoot();while(n&&"BODY"!==n.nodeName){if(n.scrollHeight>n.clientHeight){t=n;break}n=n.parentNode}return t},_=function(e,t){T(e)?tb(r,e,t):nb(r,b(),t)},A=function(e,t){return y(lv(e,t,r.getDoc()))},L=function(){var e=b();return e.collapsed?Rd.fromRangeStart(e).getClientRects()[0]:e.getBoundingClientRect()},O=function(){t=i=o=null,P.destroy()},R={bookmarkManager:null,controlSelection:null,dom:e,win:t,serializer:n,editor:r,collapse:g,setCursorLocation:s,getContent:l,setContent:u,getBookmark:f,moveToBookmark:h,select:m,isCollapsed:p,isForward:C,setNode:w,getNode:S,getSel:v,setRng:y,getRng:b,getStart:c,getEnd:d,getSelectedBlocks:x,normalize:D,selectorChanged:k,selectorChangedWithUnbind:a,getScrollContainer:E,scrollIntoView:_,placeCaretAt:A,getBoundingClientRect:L,destroy:O},I=Bg(R),P=rv(R,r);return R.bookmarkManager=I,R.controlSelection=P,R},TE=function(e,t){Z(t,(function(t){e.attr(t,null)}))},DE=function(e,t,n){e.addNodeFilter("font",(function(e){Z(e,(function(e){var r=t.parse(e.attr("style")),i=e.attr("color"),o=e.attr("face"),a=e.attr("size");i&&(r.color=i),o&&(r["font-family"]=o),a&&(r["font-size"]=n[parseInt(e.attr("size"),10)-1]),e.name="span",e.attr("style",t.serialize(r)),TE(e,["color","face","size"])}))}))},kE=function(e,t){e.addNodeFilter("strike",(function(e){Z(e,(function(e){var n=t.parse(e.attr("style"));n["text-decoration"]="line-through",e.name="span",e.attr("style",t.serialize(n))}))}))},EE=function(e,t){var n=Hs();t.convert_fonts_to_spans&&DE(e,n,mn.explode(t.font_size_legacy_values)),kE(e,n)},_E=function(e,t){t.inline_styles&&EE(e,t)},AE=function(e){return new Ao((function(t,n){var r=function(){n("Cannot convert "+e+" to Blob. Resource might not exist or is inaccessible.")};try{var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="blob",i.onload=function(){200===i.status?t(i.response):r()},i.onerror=r,i.send()}catch(o){r()}}))},LE=function(e){var t,n=decodeURIComponent(e).split(","),r=/data:([^;]+)/.exec(n[0]);return r&&(t=r[1]),{type:t,data:n[1]}},OE=function(e,t){var n;try{n=atob(t)}catch(LU){return j.none()}for(var r=new Uint8Array(n.length),i=0;i<r.length;i++)r[i]=n.charCodeAt(i);return j.some(new Blob([r],{type:e}))},RE=function(e){return new Ao((function(t){var n=LE(e),r=n.type,i=n.data;OE(r,i).fold((function(){return t(new Blob([]))}),t)}))},IE=function(e){return 0===e.indexOf("blob:")?AE(e):0===e.indexOf("data:")?RE(e):null},PE=function(e){return new Ao((function(t){var n=new FileReader;n.onloadend=function(){t(n.result)},n.readAsDataURL(e)}))},ME=0,NE=function(e){return(e||"blobid")+ME++},FE=function(e,t,n,r){var i,o;if(0===t.src.indexOf("blob:"))return o=e.getByUri(t.src),void(o?n({image:t,blobInfo:o}):IE(t.src).then((function(r){PE(r).then((function(a){i=LE(a).data,o=e.create(NE(),r,i),e.add(o),n({image:t,blobInfo:o})}))}),(function(e){r(e)})));var a=LE(t.src),s=a.data,l=a.type;i=s,o=e.getByData(i,l),o?n({image:t,blobInfo:o}):IE(t.src).then((function(r){o=e.create(NE(),r,i),e.add(o),n({image:t,blobInfo:o})}),(function(e){r(e)}))},BE=function(e){return e?be(e.getElementsByTagName("img")):[]},$E=function(e,t){var n={},r=function(r,i){i||(i=$);var o=ne(BE(r),(function(t){var n=t.src;return!!en.fileApi&&(!t.hasAttribute("data-mce-bogus")&&(!t.hasAttribute("data-mce-placeholder")&&(!(!n||n===en.transparentSrc)&&(0===n.indexOf("blob:")?!e.isUploaded(n)&&i(t):0===n.indexOf("data:")&&i(t)))))})),a=Q(o,(function(e){if(void 0!==n[e.src])return new Ao((function(t){n[e.src].then((function(n){if("string"===typeof n)return n;t({image:e,blobInfo:n.blobInfo})}))}));var r=new Ao((function(n,r){FE(t,e,n,r)})).then((function(e){return delete n[e.image.src],e})).catch((function(t){return delete n[e.src],t}));return n[e.src]=r,r}));return Ao.all(a)};return{findAll:r}},zE=function(e){var t,n=/data:[^;<"'\s]+;base64,([a-z0-9\+\/=\s]+)/gi,r=[],i={},o=$c("img"),a=0,s=0;while(t=n.exec(e)){var l=t[0],u=o+"_"+s++;i[u]=l,a<t.index&&r.push(e.substr(a,t.index-a)),r.push(u),a=t.index+l.length}var c=new RegExp(o+"_[0-9]+","g");return 0===a?{prefix:o,uris:i,html:e,re:c}:(a<e.length&&r.push(e.substr(a)),{prefix:o,uris:i,html:r.join(""),re:c})},UE=function(e,t){return e.replace(t.re,(function(e){return Oe(t.uris,e).getOr(e)}))},VE=function(e){var t=/data:([^;]+);base64,([a-z0-9\+\/=\s]+)/i.exec(e);return t?j.some({type:t[1],data:decodeURIComponent(t[2])}):j.none()},HE=function(e,t,n,r){var i=e.padd_empty_with_br||t.insert;i&&n[r.name]?r.empty().append(new Ay("br",1)).shortEnded=!0:r.empty().append(new Ay("#text",3)).value=ua},jE=function(e){return qE(e,"#text")&&e.firstChild.value===ua},qE=function(e,t){return e&&e.firstChild&&e.firstChild===e.lastChild&&e.firstChild.name===t},GE=function(e,t){var n=e.getElementRule(t.name);return n&&n.paddEmpty},WE=function(e,t,n,r){return r.isEmpty(t,n,(function(t){return GE(e,t)}))},KE=function(e,t){return e&&(Re(t,e.name)||"br"===e.name)},YE=function(e){return T(e.attr("data-mce-bogus"))},XE=function(e){return e.attr("src")===en.transparentSrc||T(e.attr("data-mce-placeholder"))},JE=function(e,t){if(t.images_dataimg_filter){var n=new Image;return n.src=e.attr("src"),xe(e.attributes.map,(function(e,t){n.setAttribute(t,e)})),t.images_dataimg_filter(n)}return!0},QE=function(e,t){var n=t.blob_cache,r=function(e){var r=e.attr("src");XE(e)||YE(e)||VE(r).filter((function(){return JE(e,t)})).bind((function(e){var t=e.type,r=e.data;return j.from(n.getByData(r,t)).orThunk((function(){return OE(t,r).map((function(e){var t=n.create(NE(),e,r);return n.add(t),t}))}))})).each((function(t){e.attr("src",t.blobUri())}))};n&&e.addAttributeFilter("src",(function(e){return Z(e,r)}))},ZE=function(e,t){var n=e.schema;t.remove_trailing_brs&&e.addNodeFilter("br",(function(e,r,i){var o,a,s,l,u,c,d,f,h=e.length,m=mn.extend({},n.getBlockElements()),p=n.getNonEmptyElements(),g=n.getWhiteSpaceElements();for(m.body=1,o=0;o<h;o++)if(a=e[o],s=a.parent,m[a.parent.name]&&a===s.lastChild){u=a.prev;while(u){if(c=u.name,"span"!==c||"bookmark"!==u.attr("data-mce-type")){"br"===c&&(a=null);break}u=u.prev}a&&(a.remove(),WE(n,p,g,s)&&(d=n.getElementRule(s.name),d&&(d.removeEmpty?s.remove():d.paddEmpty&&HE(t,i,m,s))))}else{l=a;while(s&&s.firstChild===l&&s.lastChild===l){if(l=s,m[s.name])break;s=s.parent}l===s&&!0!==t.padd_empty_with_br&&(f=new Ay("#text",3),f.value=ua,a.replace(f))}})),e.addAttributeFilter("href",(function(e){var n=e.length,r=function(e){var t=e.split(" ").filter((function(e){return e.length>0}));return t.concat(["noopener"]).sort().join(" ")},i=function(e){var t=e?mn.trim(e):"";return/\b(noopener)\b/g.test(t)?t:r(t)};if(!t.allow_unsafe_link_target)while(n--){var o=e[n];"a"===o.name&&"_blank"===o.attr("target")&&o.attr("rel",i(o.attr("rel")))}})),t.allow_html_in_named_anchor||e.addAttributeFilter("id,name",(function(e){var t,n,r,i,o=e.length;while(o--)if(i=e[o],"a"===i.name&&i.firstChild&&!i.attr("href")){r=i.parent,t=i.lastChild;do{n=t.prev,r.insert(t,i),t=n}while(t)}})),t.fix_list_elements&&e.addNodeFilter("ul,ol",(function(e){var t,n,r=e.length;while(r--)if(t=e[r],n=t.parent,"ul"===n.name||"ol"===n.name)if(t.prev&&"li"===t.prev.name)t.prev.append(t);else{var i=new Ay("li",1);i.attr("style","list-style-type: none"),t.wrap(i)}})),t.validate&&n.getValidClasses()&&e.addAttributeFilter("class",(function(e){var t=n.getValidClasses(),r=e.length;while(r--){for(var i=e[r],o=i.attr("class").split(" "),a="",s=0;s<o.length;s++){var l=o[s],u=!1,c=t["*"];c&&c[l]&&(u=!0),c=t[i.name],!u&&c&&c[l]&&(u=!0),u&&(a&&(a+=" "),a+=l)}a.length||(a=null),i.attr("class",a)}})),QE(e,t)},e_=mn.each,t_=mn.trim,n_="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),r_={ftp:21,http:80,https:443,mailto:25},i_=["img","video"],o_=function(e,t){return T(e)?!e:!T(t)||!X(i_,t)},a_=function(e,t,n){return!e.allow_html_data_urls&&(/^data:image\//i.test(t)?o_(e.allow_svg_data_urls,n)&&/^data:image\/svg\+xml/i.test(t):/^data:/i.test(t))},s_=function(){function e(t,n){t=t_(t),this.settings=n||{};var r=this.settings.base_uri,i=this;if(/^([\w\-]+):([^\/]{2})/i.test(t)||/^\s*#/.test(t))i.source=t;else{var o=0===t.indexOf("//");if(0!==t.indexOf("/")||o||(t=(r&&r.protocol||"http")+"://mce_host"+t),!/^[\w\-]*:?\/\//.test(t)){var a=this.settings.base_uri?this.settings.base_uri.path:new e(document.location.href).directory;if(this.settings.base_uri&&""==this.settings.base_uri.protocol)t="//mce_host"+i.toAbsPath(a,t);else{var s=/([^#?]*)([#?]?.*)/.exec(t);t=(r&&r.protocol||"http")+"://mce_host"+i.toAbsPath(a,s[1])+s[2]}}t=t.replace(/@@/g,"(mce_at)");var l=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?(\[[a-zA-Z0-9:.%]+\]|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(t);e_(n_,(function(e,t){var n=l[t];n&&(n=n.replace(/\(mce_at\)/g,"@@")),i[e]=n})),r&&(i.protocol||(i.protocol=r.protocol),i.userInfo||(i.userInfo=r.userInfo),i.port||"mce_host"!==i.host||(i.port=r.port),i.host&&"mce_host"!==i.host||(i.host=r.host),i.source=""),o&&(i.protocol="")}}return e.parseDataUri=function(e){var t,n=decodeURIComponent(e).split(","),r=/data:([^;]+)/.exec(n[0]);return r&&(t=r[1]),{type:t,data:n[1]}},e.isDomSafe=function(e,t,n){if(void 0===n&&(n={}),n.allow_script_urls)return!0;var r=_s.decode(e).replace(/[\s\u0000-\u001F]+/g,"");try{r=decodeURIComponent(r)}catch(i){r=unescape(r)}return!/((java|vb)script|mhtml):/i.test(r)&&!a_(n,r,t)},e.getDocumentBaseUrl=function(e){var t;return t=0!==e.protocol.indexOf("http")&&"file:"!==e.protocol?e.href:e.protocol+"//"+e.host+e.pathname,/^[^:]+:\/\/\/?[^\/]+\//.test(t)&&(t=t.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(t)||(t+="/")),t},e.prototype.setPath=function(e){var t=/^(.*?)\/?(\w+)?$/.exec(e);this.path=t[0],this.directory=t[1],this.file=t[2],this.source="",this.getURI()},e.prototype.toRelative=function(t){var n;if("./"===t)return t;var r=new e(t,{base_uri:this});if("mce_host"!==r.host&&this.host!==r.host&&r.host||this.port!==r.port||this.protocol!==r.protocol&&""!==r.protocol)return r.getURI();var i=this.getURI(),o=r.getURI();return i===o||"/"===i.charAt(i.length-1)&&i.substr(0,i.length-1)===o?i:(n=this.toRelPath(this.path,r.path),r.query&&(n+="?"+r.query),r.anchor&&(n+="#"+r.anchor),n)},e.prototype.toAbsolute=function(t,n){var r=new e(t,{base_uri:this});return r.getURI(n&&this.isSameOrigin(r))},e.prototype.isSameOrigin=function(e){if(this.host==e.host&&this.protocol==e.protocol){if(this.port==e.port)return!0;var t=r_[this.protocol];if(t&&(this.port||t)==(e.port||t))return!0}return!1},e.prototype.toRelPath=function(e,t){var n,r,i=0,o="",a=e.substring(0,e.lastIndexOf("/")).split("/"),s=t.split("/");if(a.length>=s.length)for(n=0,r=a.length;n<r;n++)if(n>=s.length||a[n]!==s[n]){i=n+1;break}if(a.length<s.length)for(n=0,r=s.length;n<r;n++)if(n>=a.length||a[n]!==s[n]){i=n+1;break}if(1===i)return t;for(n=0,r=a.length-(i-1);n<r;n++)o+="../";for(n=i-1,r=s.length;n<r;n++)o+=n!==i-1?"/"+s[n]:s[n];return o},e.prototype.toAbsPath=function(e,t){var n,r,i=0,o=[],a=/\/$/.test(t)?"/":"",s=e.split("/"),l=t.split("/");for(e_(s,(function(e){e&&o.push(e)})),s=o,n=l.length-1,o=[];n>=0;n--)0!==l[n].length&&"."!==l[n]&&(".."!==l[n]?i>0?i--:o.push(l[n]):i++);return n=s.length-i,r=n<=0?de(o).join("/"):s.slice(0,n).join("/")+"/"+de(o).join("/"),0!==r.indexOf("/")&&(r="/"+r),a&&r.lastIndexOf("/")!==r.length-1&&(r+=a),r},e.prototype.getURI=function(e){var t;return void 0===e&&(e=!1),this.source&&!e||(t="",e||(this.protocol?t+=this.protocol+"://":t+="//",this.userInfo&&(t+=this.userInfo+"@"),this.host&&(t+=this.host),this.port&&(t+=":"+this.port)),this.path&&(t+=this.path),this.query&&(t+="?"+this.query),this.anchor&&(t+="#"+this.anchor),this.source=t),this.source},e}(),l_=mn.makeMap("button,fieldset,form,iframe,img,image,input,object,output,select,textarea"),u_=function(e){return 0===e.indexOf("data-")||0===e.indexOf("aria-")},c_=We((function(){return document.implementation.createHTMLDocument("parser")})),d_=function(e,t,n){var r=/<([!?\/])?([A-Za-z0-9\-_:.]+)/g,i=/(?:\s(?:[^'">]+(?:"[^"]*"|'[^']*'))*[^"'>]*(?:"[^">]*|'[^'>]*)?|\s*|\/)>/g,o=e.getShortEndedElements(),a=1,s=n;while(0!==a){r.lastIndex=s;while(1){var l=r.exec(t);if(null===l)return s;if("!"===l[1]){s=ut(l[2],"--")?h_(t,!1,l.index+"!--".length):h_(t,!0,l.index+1);break}i.lastIndex=r.lastIndex;var u=i.exec(t);if(!w(u)&&u.index===r.lastIndex){"/"===l[1]?a-=1:Re(o,l[2])||(a+=1),s=r.lastIndex+u[0].length;break}}}return s},f_=function(e,t){return/^\s*\[if [\w\W]+\]>.*<!\[endif\](--!?)?>/.test(e.substr(t))},h_=function(e,t,n){void 0===n&&(n=0);var r=e.toLowerCase();if(-1!==r.indexOf("[if ",n)&&f_(r,n)){var i=r.indexOf("[endif]",n);return r.indexOf(">",i)}if(t){var o=r.indexOf(">",n);return-1!==o?o:r.length}var a=/--!?>/g;a.lastIndex=n;var s=a.exec(e);return s?s.index+s[0].length:r.length},m_=function(e,t){var n=e.exec(t);if(n){var r=n[1],i=n[2];return"string"===typeof r&&"data-mce-bogus"===r.toLowerCase()?i:null}return null},p_=function(e,t){void 0===t&&(t=Us()),e=e||{};var n=c_(),r=n.createElement("form");!1!==e.fix_self_closing&&(e.fix_self_closing=!0);var i=e.comment?e.comment:E,o=e.cdata?e.cdata:E,a=e.text?e.text:E,s=e.start?e.start:E,l=e.end?e.end:E,u=e.pi?e.pi:E,c=e.doctype?e.doctype:E,d=function(d,f){void 0===f&&(f="html");var h,m,p,g,v,b,y,w,S,x,C,T,D,k,E,_,A,L,O,R,I=d.html,P=0,M=[],N=0,F=_s.decode,B=mn.makeMap("src,href,data,background,action,formaction,poster,xlink:href"),$="html"===f?0:1,z=function(e){var t,n;t=M.length;while(t--)if(M[t].name===e)break;if(t>=0){for(n=M.length-1;n>=t;n--)e=M[n],e.valid&&l(e.name);M.length=t}},U=function(e,t){return a(UE(e,d),t)},V=function(t){""!==t&&(">"===t.charAt(0)&&(t=" "+t),e.allow_conditional_comments||"[if"!==t.substr(0,3).toLowerCase()||(t=" "+t),i(UE(t,d)))},H=function(e){return UE(e,d)},j=function(e,t){var n=e||"",r=!ut(n,"--"),i=h_(I,r,t);return e=I.substr(t,i-t),V(r?n+e:e),i+1},q=function(t,i,o,a,s){if(i=i.toLowerCase(),o=H(i in X?i:F(o||a||s||"")),J&&!w&&!1===u_(i)){var l=k[i];if(!l&&E){var u=E.length;while(u--)if(l=E[u],l.pattern.test(i))break;-1===u&&(l=null)}if(!l)return;if(l.validValues&&!(o in l.validValues))return}var c="name"===i||"id"===i;c&&t in l_&&(o in n||o in r)||B[i]&&!s_.isDomSafe(o,t,e)||w&&(i in B||0===i.indexOf("on"))||(g.map[i]=o,g.push({name:i,value:o}))},G=new RegExp("<(?:(?:!--([\\w\\W]*?)--!?>)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:![Dd][Oo][Cc][Tt][Yy][Pp][Ee]([\\w\\W]*?)>)|(?:!(--)?)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)>)|(?:([A-Za-z][A-Za-z0-9\\-_:.]*)(\\s(?:[^'\">]+(?:\"[^\"]*\"|'[^']*'))*[^\"'>]*(?:\"[^\">]*|'[^'>]*)?|\\s*|\\/)>))","g"),W=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:[^\"])*)\")|(?:\'((?:[^\'])*)\')|([^>\s]+)))?/g,K=t.getShortEndedElements(),Y=e.self_closing_elements||t.getSelfClosingElements(),X=t.getBoolAttrs(),J=e.validate,Q=e.remove_internals,Z=e.fix_self_closing,ee=t.getSpecialElements(),te=I+">";while(h=G.exec(te)){var ne=h[0];if(P<h.index&&U(F(I.substr(P,h.index-P))),m=h[7])m=m.toLowerCase(),":"===m.charAt(0)&&(m=m.substr(1)),z(m);else if(m=h[8]){if(h.index+ne.length>I.length){U(F(I.substr(h.index))),P=h.index+ne.length;continue}m=m.toLowerCase(),":"===m.charAt(0)&&(m=m.substr(1)),S=m in K,Z&&Y[m]&&M.length>0&&M[M.length-1].name===m&&z(m);var re=m_(W,h[9]);if(null!==re){if("all"===re){P=d_(t,I,G.lastIndex),G.lastIndex=P;continue}C=!1}if(!J||(x=t.getElementRule(m))){if(C=!0,J&&(k=x.attributes,E=x.attributePatterns),(D=h[9])?(w=-1!==D.indexOf("data-mce-type"),w&&Q&&(C=!1),g=[],g.map={},D.replace(W,(function(e,t,n,r,i){return q(m,t,n,r,i),""}))):(g=[],g.map={}),J&&!w){if(_=x.attributesRequired,A=x.attributesDefault,L=x.attributesForced,O=x.removeEmptyAttrs,O&&!g.length&&(C=!1),L){v=L.length;while(v--)T=L[v],y=T.name,R=T.value,"{$uid}"===R&&(R="mce_"+N++),g.map[y]=R,g.push({name:y,value:R})}if(A){v=A.length;while(v--)T=A[v],y=T.name,y in g.map||(R=T.value,"{$uid}"===R&&(R="mce_"+N++),g.map[y]=R,g.push({name:y,value:R}))}if(_){v=_.length;while(v--)if(_[v]in g.map)break;-1===v&&(C=!1)}if(T=g.map["data-mce-bogus"]){if("all"===T){P=d_(t,I,G.lastIndex),G.lastIndex=P;continue}C=!1}}C&&s(m,g,S)}else C=!1;if(p=ee[m]){p.lastIndex=P=h.index+ne.length,(h=p.exec(I))?(C&&(b=I.substr(P,h.index-P)),P=h.index+h[0].length):(b=I.substr(P),P=I.length),C&&(b.length>0&&U(b,!0),l(m)),G.lastIndex=P;continue}S||(D&&D.indexOf("/")===D.length-1?C&&l(m):M.push({name:m,valid:C}))}else if(m=h[1])V(m);else if(m=h[2]){var ie=1===$||e.preserve_cdata||M.length>0&&t.isValidChild(M[M.length-1].name,"#cdata");if(!ie){P=j("",h.index+2),G.lastIndex=P;continue}o(m)}else if(m=h[3])c(m);else{if((m=h[4])||"<!"===ne){P=j(m,h.index+ne.length),G.lastIndex=P;continue}if(m=h[5]){if(1!==$){P=j("?",h.index+2),G.lastIndex=P;continue}u(m,h[6])}}P=h.index+ne.length}for(P<I.length&&U(F(I.substr(P))),v=M.length-1;v>=0;v--)m=M[v],m.valid&&l(m.name)},f=function(e,t){void 0===t&&(t="html"),d(zE(e),t)};return{parse:f}};p_.findEndTag=d_;var g_=mn.makeMap,v_=mn.each,b_=mn.explode,y_=mn.extend,w_=function(e,t){void 0===t&&(t=Us());var n={},r=[],i={},o={};e=e||{},e.validate=!("validate"in e)||e.validate,e.root_name=e.root_name||"body";var a=function(e){for(var n=g_("tr,td,th,tbody,thead,tfoot,table"),r=t.getNonEmptyElements(),i=t.getWhiteSpaceElements(),o=t.getTextBlockElements(),a=t.getSpecialElements(),l=function(e,n){if(void 0===n&&(n=e.parent),a[e.name])e.empty().remove();else{for(var r=e.children(),i=0,o=r;i<o.length;i++){var s=o[i];t.isValidChild(n.name,s.name)||l(s,n)}e.unwrap()}},u=0;u<e.length;u++){var c=e[u],d=void 0,f=void 0,h=void 0;if(c.parent&&!c.fixed)if(o[c.name]&&"li"===c.parent.name){var m=c.next;while(m){if(!o[m.name])break;m.name="li",m.fixed=!0,c.parent.insert(m,c.parent),m=m.next}c.unwrap()}else{var p=[c];for(d=c.parent;d&&!t.isValidChild(d.name,c.name)&&!n[d.name];d=d.parent)p.push(d);if(d&&p.length>1)if(t.isValidChild(d.name,c.name)){p.reverse(),f=s(p[0].clone());for(var g=f,v=0;v<p.length-1;v++){t.isValidChild(g.name,p[v].name)?(h=s(p[v].clone()),g.append(h)):h=g;for(var b=p[v].firstChild;b&&b!==p[v+1];){var y=b.next;h.append(b),b=y}g=h}WE(t,r,i,f)?d.insert(c,p[0],!0):(d.insert(f,p[0],!0),d.insert(c,f)),d=p[0],(WE(t,r,i,d)||qE(d,"br"))&&d.empty().remove()}else l(c);else if(c.parent){if("li"===c.name){m=c.prev;if(m&&("ul"===m.name||"ol"===m.name)){m.append(c);continue}if(m=c.next,m&&("ul"===m.name||"ol"===m.name)){m.insert(c,m.firstChild,!0);continue}c.wrap(s(new Ay("ul",1)));continue}t.isValidChild(c.parent.name,"div")&&t.isValidChild("div",c.name)?c.wrap(s(new Ay("div",1))):l(c)}}}},s=function(e){var t=e.name;if(t in n){var a=i[t];a?a.push(e):i[t]=[e]}var s=r.length;while(s--){var l=r[s].name;if(l in e.attributes.map){a=o[l];a?a.push(e):o[l]=[e]}}return e},l=function(e,t){v_(b_(e),(function(e){var r=n[e];r||(n[e]=r=[]),r.push(t)}))},u=function(){var e=[];for(var t in n)Re(n,t)&&e.push({name:t,callbacks:n[t]});return e},c=function(e,t){v_(b_(e),(function(e){var n;for(n=0;n<r.length;n++)if(r[n].name===e)return void r[n].callbacks.push(t);r.push({name:e,callbacks:[t]})}))},d=function(){return[].concat(r)},f=function(s,l){var u,c,d,f,h,m,p,g,v=[],b=function(e){return!1===e?"":!0===e?"p":e};l=l||{},i={},o={};var y=y_(g_("script,style,head,html,body,title,meta,param"),t.getBlockElements()),w=Bs(t),S=t.getNonEmptyElements(),x=t.children,C=e.validate,D="forced_root_block"in l?l.forced_root_block:e.forced_root_block,k=b(D),E=t.getWhiteSpaceElements(),_=/^[ \t\r\n]+/,A=/[ \t\r\n]+$/,L=/[ \t\r\n]+/g,O=/^[ \t\r\n]+$/,R=Re(E,l.context)||Re(E,e.root_name),I=function(){var n=$.firstChild,r=null,i=function(e){e&&(n=e.firstChild,n&&3===n.type&&(n.value=n.value.replace(_,"")),n=e.lastChild,n&&3===n.type&&(n.value=n.value.replace(A,"")))};if(t.isValidChild($.name,k.toLowerCase())){while(n){var o=n.next;3===n.type||1===n.type&&"p"!==n.name&&!y[n.name]&&!n.attr("data-mce-type")?(r||(r=P(k,1),r.attr(e.forced_root_block_attrs),$.insert(r,n)),r.append(n)):(i(r),r=null),n=o}i(r)}},P=function(e,t){var r,o=new Ay(e,t);return e in n&&(r=i[e],r?r.push(o):i[e]=[o]),o},M=function(e){for(var n=t.getBlockElements(),r=e.prev;r&&3===r.type;){var i=r.value.replace(A,"");if(i.length>0)return void(r.value=i);var o=r.next;if(o){if(3===o.type&&o.value.length){r=r.prev;continue}if(!n[o.name]&&"script"!==o.name&&"style"!==o.name){r=r.prev;continue}}var a=r.prev;r.remove(),r=a}},N=function(e){var t={};for(var n in e)"li"!==n&&"p"!==n&&(t[n]=e[n]);return t},F=function(e){var n=e;while(T(n)){if(n.name in w)return WE(t,S,E,n);n=n.parent}return!1},B=p_({validate:C,document:e.document,allow_html_data_urls:e.allow_html_data_urls,allow_svg_data_urls:e.allow_svg_data_urls,allow_script_urls:e.allow_script_urls,allow_conditional_comments:e.allow_conditional_comments,preserve_cdata:e.preserve_cdata,self_closing_elements:N(t.getSelfClosingElements()),cdata:function(e){g.append(P("#cdata",4)).value=e},text:function(e,t){var n;R||(e=e.replace(L," "),KE(g.lastChild,y)&&(e=e.replace(_,""))),0!==e.length&&(n=P("#text",3),n.raw=!!t,g.append(n).value=e)},comment:function(e){g.append(P("#comment",8)).value=e},pi:function(e,t){g.append(P(e,7)).value=t,M(g)},doctype:function(e){var t=g.append(P("#doctype",10));t.value=e,M(g)},start:function(e,n,i){var a=C?t.getElementRule(e):{};if(a){var s=P(a.outputName||e,1);s.attributes=n,s.shortEnded=i,g.append(s);var l=x[g.name];l&&x[s.name]&&!l[s.name]&&v.push(s);var u=r.length;while(u--){var c=r[u].name;c in n.map&&(m=o[c],m?m.push(s):o[c]=[s])}y[e]&&M(s),i||(g=s),!R&&E[e]&&(R=!0)}},end:function(n){var r,i,o,a=C?t.getElementRule(n):{};if(a){if(y[n]&&!R){if(r=g.firstChild,r&&3===r.type)if(i=r.value.replace(_,""),i.length>0)r.value=i,r=r.next;else{o=r.next,r.remove(),r=o;while(r&&3===r.type)i=r.value,o=r.next,(0===i.length||O.test(i))&&(r.remove(),r=o),r=o}if(r=g.lastChild,r&&3===r.type)if(i=r.value.replace(A,""),i.length>0)r.value=i,r=r.prev;else{o=r.prev,r.remove(),r=o;while(r&&3===r.type)i=r.value,o=r.prev,(0===i.length||O.test(i))&&(r.remove(),r=o),r=o}}R&&E[n]&&(R=!1);var s=WE(t,S,E,g),u=g.parent;a.paddInEmptyBlock&&s&&F(g)?HE(e,l,y,g):a.removeEmpty&&s?y[g.name]?g.empty().remove():g.unwrap():a.paddEmpty&&(jE(g)||s)&&HE(e,l,y,g),g=u}}},t),$=g=new Ay(l.context||e.root_name,11);if(B.parse(s,l.format),C&&v.length&&(l.context?l.invalid=!0:a(v)),k&&("body"===$.name||l.isRootContent)&&I(),!l.invalid){for(p in i)if(Re(i,p)){m=n[p],u=i[p],f=u.length;while(f--)u[f].parent||u.splice(f,1);for(c=0,d=m.length;c<d;c++)m[c](u,p,l)}for(c=0,d=r.length;c<d;c++)if(m=r[c],m.name in o){u=o[m.name],f=u.length;while(f--)u[f].parent||u.splice(f,1);for(f=0,h=m.callbacks.length;f<h;f++)m.callbacks[f](u,m.name,l)}}return $},h={schema:t,addAttributeFilter:c,getAttributeFilters:d,addNodeFilter:l,getNodeFilters:u,filterNode:s,parse:f};return ZE(h,e),_E(h,e),h},S_=function(e,t,n){e.addAttributeFilter("data-mce-tabindex",(function(e,t){var n=e.length;while(n--){var r=e[n];r.attr("tabindex",r.attr("data-mce-tabindex")),r.attr(t,null)}})),e.addAttributeFilter("src,href,style",(function(e,r){var i="data-mce-"+r,o=t.url_converter,a=t.url_converter_scope,s=e.length;while(s--){var l=e[s],u=l.attr(i);void 0!==u?(l.attr(r,u.length>0?u:null),l.attr(i,null)):(u=l.attr(r),"style"===r?u=n.serializeStyle(n.parseStyle(u),l.name):o&&(u=o.call(a,u,r,l.name)),l.attr(r,u.length>0?u:null))}})),e.addAttributeFilter("class",(function(e){var t=e.length;while(t--){var n=e[t],r=n.attr("class");r&&(r=n.attr("class").replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),n.attr("class",r.length>0?r:null))}})),e.addAttributeFilter("data-mce-type",(function(e,t,n){var r=e.length;while(r--){var i=e[r];if("bookmark"===i.attr("data-mce-type")&&!n.cleanup){var o=j.from(i.firstChild).exists((function(e){return!ha(e.value)}));o?i.unwrap():i.remove()}}})),e.addNodeFilter("noscript",(function(e){var t=e.length;while(t--){var n=e[t].firstChild;n&&(n.value=_s.decode(n.value))}})),e.addNodeFilter("script,style",(function(e,n){var r=function(e){return e.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"")},i=e.length;while(i--){var o=e[i],a=o.firstChild?o.firstChild.value:"";if("script"===n){var s=o.attr("type");s&&o.attr("type","mce-no/type"===s?null:s.replace(/^mce\-/,"")),"xhtml"===t.element_format&&a.length>0&&(o.firstChild.value="// <![CDATA[\n"+r(a)+"\n// ]]>")}else"xhtml"===t.element_format&&a.length>0&&(o.firstChild.value="\x3c!--\n"+r(a)+"\n--\x3e")}})),e.addNodeFilter("#comment",(function(e){var r=e.length;while(r--){var i=e[r];t.preserve_cdata&&0===i.value.indexOf("[CDATA[")?(i.name="#cdata",i.type=4,i.value=n.decode(i.value.replace(/^\[CDATA\[|\]\]$/g,""))):0===i.value.indexOf("mce:protected ")&&(i.name="#text",i.type=3,i.raw=!0,i.value=unescape(i.value).substr(14))}})),e.addNodeFilter("xml:namespace,input",(function(e,t){var n=e.length;while(n--){var r=e[n];7===r.type?r.remove():1===r.type&&("input"!==t||r.attr("type")||r.attr("type","text"))}})),e.addAttributeFilter("data-mce-type",(function(t){Z(t,(function(t){"format-caret"===t.attr("data-mce-type")&&(t.isEmpty(e.schema.getNonEmptyElements())?t.remove():t.unwrap())}))})),e.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-type,data-mce-resize,data-mce-placeholder",(function(e,t){var n=e.length;while(n--)e[n].attr(t,null)}))},x_=function(e){var t=function(e){return e&&"br"===e.name},n=e.lastChild;if(t(n)){var r=n.prev;t(r)&&(n.remove(),r.remove())}},C_=function(e,t,n){var r,i=e.dom,o=t.cloneNode(!0),a=document.implementation;if(a.createHTMLDocument){var s=a.createHTMLDocument("");mn.each("BODY"===o.nodeName?o.childNodes:[o],(function(e){s.body.appendChild(s.importNode(e,!0))})),o="BODY"!==o.nodeName?s.body.firstChild:s.body,r=i.doc,i.doc=s}return Ug(e,je(je({},n),{node:o})),r&&(i.doc=r),o},T_=function(e,t){return e&&e.hasEventListeners("PreProcess")&&!t.no_events},D_=function(e,t,n){return T_(e,n)?C_(e,t,n):t},k_=function(e,t,n){-1===mn.inArray(t,n)&&(e.addAttributeFilter(n,(function(e,t){var n=e.length;while(n--)e[n].attr(t,null)})),t.push(n))},E_=function(e,t,n){if(!t.no_events&&e){var r=Vg(e,je(je({},t),{content:n}));return r.content}return n},__=function(e,t,n){var r=ma(n.getInner?t.innerHTML:e.getOuterHTML(t));return n.selection||aa(wn.fromDom(t))?r:mn.trim(r)},A_=function(e,t,n){var r=n.selection?je({forced_root_block:!1},n):n,i=e.parse(t,r);return x_(i),i},L_=function(e,t,n){var r=Zy(e,t);return r.serialize(n)},O_=function(e,t,n,r,i){var o=L_(t,n,r);return E_(e,i,o)},R_=function(e,t){var n=["data-mce-selected"],r=t&&t.dom?t.dom:Uu.DOM,i=t&&t.schema?t.schema:Us(e);e.entity_encoding=e.entity_encoding||"named",e.remove_trailing_brs=!("remove_trailing_brs"in e)||e.remove_trailing_brs;var o=w_(e,i);S_(o,e,r);var a=function(n,a){void 0===a&&(a={});var s=je({format:"html"},a),l=D_(t,n,s),u=__(r,l,s),c=A_(o,u,s);return"tree"===s.format?c:O_(t,e,i,c,s)};return{schema:i,addNodeFilter:o.addNodeFilter,addAttributeFilter:o.addAttributeFilter,serialize:a,addRules:i.addValidElements,setRules:i.setValidElements,addTempAttr:I(k_,o,n),getTempAttrs:L(n),getNodeFilters:o.getNodeFilters,getAttributeFilters:o.getAttributeFilters}},I_=function(e,t){var n=R_(e,t);return{schema:n.schema,addNodeFilter:n.addNodeFilter,addAttributeFilter:n.addAttributeFilter,serialize:n.serialize,addRules:n.addRules,setRules:n.setRules,addTempAttr:n.addTempAttr,getTempAttrs:n.getTempAttrs,getNodeFilters:n.getNodeFilters,getAttributeFilters:n.getAttributeFilters}},P_="html",M_=function(e,t){void 0===t&&(t={});var n=t.format?t.format:P_;return rE(e,t,n)},N_=function(e,t,n){return void 0===n&&(n={}),iE(e,t,n)},F_=Uu.DOM,B_=function(e){F_.setStyle(e.id,"display",e.orgDisplay)},$_=function(e){return j.from(e).each((function(e){return e.destroy()}))},z_=function(e){e.contentAreaContainer=e.formElement=e.container=e.editorContainer=null,e.bodyElement=e.contentDocument=e.contentWindow=null,e.iframeElement=e.targetElm=null,e.selection&&(e.selection=e.selection.win=e.selection.dom=e.selection.dom.doc=null)},U_=function(e){var t=e.formElement;t&&(t._mceOldSubmit&&(t.submit=t._mceOldSubmit,t._mceOldSubmit=null),F_.unbind(t,"submit reset",e.formEventDelegate))},V_=function(e){if(!e.removed){var t=e._selectionOverrides,n=e.editorUpload,r=e.getBody(),i=e.getElement();r&&e.save({is_removing:!0}),e.removed=!0,e.unbindAllNativeEvents(),e.hasHiddenInput&&i&&F_.remove(i.nextSibling),Hg(e),e.editorManager.remove(e),!e.inline&&r&&B_(e),jg(e),F_.remove(e.getContainer()),$_(t),$_(n),e.destroy()}},H_=function(e,t){var n=e.selection,r=e.dom;e.destroyed||(t||e.removed?(t||(e.editorManager.off("beforeunload",e._beforeUnload),e.theme&&e.theme.destroy&&e.theme.destroy(),$_(n),$_(r)),U_(e),z_(e),e.destroyed=!0):e.remove())},j_=function(e,t){var n=b(e)&&b(t);return n?G_(e,t):t},q_=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Can't merge zero objects");for(var r={},i=0;i<t.length;i++){var o=t[i];for(var a in o)Re(o,a)&&(r[a]=e(r[a],o[a]))}return r}},G_=q_(j_),W_="autoresize_on_init,content_editable_state,convert_fonts_to_spans,inline_styles,padd_empty_with_br,block_elements,boolean_attributes,editor_deselector,editor_selector,elements,file_browser_callback_types,filepicker_validator_handler,force_hex_style_colors,force_p_newlines,gecko_spellcheck,images_dataimg_filter,media_scripts,mode,move_caret_before_on_enter_elements,non_empty_elements,self_closing_elements,short_ended_elements,special,spellchecker_select_languages,spellchecker_whitelist,tab_focus,table_responsive_width,text_block_elements,text_inline_elements,toolbar_drawer,types,validate,whitespace_elements,paste_word_valid_elements,paste_retain_style_properties,paste_convert_word_fake_lists".split(","),K_="bbcode,colorpicker,contextmenu,fullpage,legacyoutput,spellchecker,textcolor".split(","),Y_="imagetools,toc".split(","),X_=function(e){var t=ne(W_,(function(t){return Re(e,t)})),n=e.forced_root_block;return!1!==n&&""!==n||t.push("forced_root_block (false only)"),me(t)},J_=function(e){var t=mn.makeMap(e.plugins," "),n=function(e){return Re(t,e)},r=Ge(Ge([],ne(K_,n),!0),ue(Y_,(function(e){return n(e)?[e+" (moving to premium)"]:[]})),!0);return me(r)},Q_=function(e,t){var n=X_(e),r=J_(t),i=r.length>0,o=n.length>0,a="mobile"===t.theme;if(i||o||a){var s="\n- ",l=a?"\n\nThemes:"+s+"mobile":"",u=i?"\n\nPlugins:"+s+r.join(s):"",c=o?"\n\nSettings:"+s+n.join(s):"";console.warn("The following deprecated features are currently enabled, these will be removed in TinyMCE 6.0. See https://www.tiny.cloud/docs/release-notes/6.0-upcoming-changes/ for more information."+l+u+c)}},Z_=function(e,t){return{sections:L(e),settings:L(t)}},eA=qt().deviceType,tA=eA.isTouch(),nA=eA.isPhone(),rA=eA.isTablet(),iA=["lists","autolink","autosave"],oA={table_grid:!1,object_resizing:!1,resize:!1},aA=function(e){var t=y(e)?e.join(" "):e,n=Q(v(t)?t.split(" "):[],dt);return ne(n,(function(e){return e.length>0}))},sA=function(e){return ne(e,I(X,iA))},lA=function(e,t){var n=Ee(t,(function(t,n){return X(e,n)}));return Z_(n.t,n.f)},uA=function(e,t,n){void 0===n&&(n={});var r=e.sections(),i=Oe(r,t).getOr({});return mn.extend({},n,i)},cA=function(e,t){return Re(e.sections(),t)},dA=function(e,t,n){var r=e.sections();return cA(e,t)&&r[t].theme===n},fA=function(e,t){return cA(e,t)?e.sections()[t]:{}},hA=function(e,t){return Oe(e,"toolbar_mode").orThunk((function(){return Oe(e,"toolbar_drawer").map((function(e){return!1===e?"wrap":e}))})).getOr(t)},mA=function(e,t,n,r,i){var o={id:t,theme:"silver",toolbar_mode:hA(e,"floating"),plugins:"",document_base_url:n,add_form_submit_trigger:!0,submit_patch:!0,add_unload_trigger:!0,convert_urls:!0,relative_urls:!0,remove_script_host:!0,object_resizing:!0,doctype:"<!DOCTYPE html>",visual:!0,font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",forced_root_block:"p",hidden_input:!0,inline_styles:!0,convert_fonts_to_spans:!0,indent:!0,indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",entity_encoding:"named",url_converter:i.convertURL,url_converter_scope:i};return je(je({},o),r?oA:{})},pA=function(e,t){var n={resize:!1,toolbar_mode:hA(e,"scrolling"),toolbar_sticky:!1},r={menubar:!1};return je(je(je({},oA),n),t?r:{})},gA=function(e,t){var n=t.external_plugins?t.external_plugins:{};return e&&e.external_plugins?mn.extend({},e.external_plugins,n):n},vA=function(e,t){return[].concat(aA(e)).concat(aA(t))},bA=function(e,t,n,r){return e&&dA(t,"mobile","mobile")?sA(r):e&&cA(t,"mobile")?r:n},yA=function(e,t,n,r){var i=aA(n.forced_plugins),o=aA(r.plugins),a=fA(t,"mobile"),s=a.plugins?aA(a.plugins):o,l=bA(e,t,o,s),u=vA(i,l);if(en.browser.isIE()&&X(u,"rtc"))throw new Error("RTC plugin is not supported on IE 11.");return mn.extend(r,{plugins:u.join(" ")})},wA=function(e,t){return e&&cA(t,"mobile")},SA=function(e,t,n,r,i){var o=e?{mobile:pA(i.mobile||{},t)}:{},a=lA(["mobile"],G_(o,i)),s=mn.extend(n,r,a.settings(),wA(e,a)?uA(a,"mobile"):{},{validate:!0,external_plugins:gA(r,a.settings())});return yA(e,a,r,s)},xA=function(e,t,n,r,i){var o=mA(i,t,n,tA,e),a=SA(nA||rA,nA,o,r,i);return!1!==a.deprecation_warnings&&Q_(i,a),a},CA=function(e,t,n){return j.from(t.settings[n]).filter(e)},TA=function(e){var t={};return"string"===typeof e?Z(e.indexOf("=")>0?e.split(/[;,](?![^=;,]*(?:[;,]|$))/):e.split(","),(function(e){var n=e.split("=");n.length>1?t[mn.trim(n[0])]=mn.trim(n[1]):t[mn.trim(n[0])]=mn.trim(n[0])})):t=e,t},DA=function(e){return function(t){return y(t)&&ce(t,e)}},kA=function(e,t,n,r){var i=t in e.settings?e.settings[t]:n;return"hash"===r?TA(i):"string"===r?CA(v,e,t).getOr(n):"number"===r?CA(k,e,t).getOr(n):"boolean"===r?CA(S,e,t).getOr(n):"object"===r?CA(b,e,t).getOr(n):"array"===r?CA(y,e,t).getOr(n):"string[]"===r?CA(DA(v),e,t).getOr(n):"function"===r?CA(D,e,t).getOr(n):i},EA=function(){var e={},t=function(t,n){e[t]=n},n=function(t){return e[t]?e[t]:{icons:{}}},r=function(t){return Re(e,t)};return{add:t,get:n,has:r}},_A=EA(),AA=function(e,t){var n=t.dom;return n[e]},LA=function(e,t){return parseInt(Di(t,e),10)},OA=I(AA,"clientWidth"),RA=I(AA,"clientHeight"),IA=I(LA,"margin-top"),PA=I(LA,"margin-left"),MA=function(e){return e.dom.getBoundingClientRect()},NA=function(e,t,n){var r=OA(e),i=RA(e);return t>=0&&n>=0&&t<=r&&n<=i},FA=function(e,t,n,r){var i=MA(t),o=e?i.left+t.dom.clientLeft+PA(t):0,a=e?i.top+t.dom.clientTop+IA(t):0,s=n-o,l=r-a;return{x:s,y:l}},BA=function(e,t,n){var r=wn.fromDom(e.getBody()),i=e.inline?r:Kn(r),o=FA(e.inline,i,t,n);return NA(i,o.x,o.y)},$A=function(e){return j.from(e).map(wn.fromDom)},zA=function(e){var t=e.inline?e.getBody():e.getContentAreaContainer();return $A(t).map(_r).getOr(!1)},UA=function(){var e=function(){throw new Error("Theme did not provide a NotificationManager implementation.")};return{open:e,close:e,reposition:e,getArgs:e}},VA=function(e){var t=[],n=function(){var t=e.theme;return t&&t.getNotificationManagerImpl?t.getNotificationManagerImpl():UA()},r=function(){return j.from(t[0])},i=function(e,t){return e.type===t.type&&e.text===t.text&&!e.progressBar&&!e.timeout&&!t.progressBar&&!t.timeout},o=function(){t.length>0&&n().reposition(t)},a=function(e){t.push(e)},s=function(e){se(t,(function(t){return t===e})).each((function(e){t.splice(e,1)}))},l=function(l,u){if(void 0===u&&(u=!0),!e.removed&&zA(e))return u&&e.fire("BeforeOpenNotification",{notification:l}),ae(t,(function(e){return i(n().getArgs(e),l)})).getOrThunk((function(){e.editorManager.setActive(e);var t=n().open(l,(function(){s(t),o(),r().fold((function(){return e.focus()}),(function(e){return ib(wn.fromDom(e.getEl()))}))}));return a(t),o(),e.fire("OpenNotification",{notification:je({},t)}),t}))},u=function(){r().each((function(e){n().close(e),s(e),o()}))},c=L(t),d=function(e){e.on("SkinLoaded",(function(){var t=rh(e);t&&l({text:t,type:"warning",timeout:0},!1),o()})),e.on("show ResizeEditor ResizeWindow NodeChange",(function(){No.requestAnimationFrame(o)})),e.on("remove",(function(){Z(t.slice(),(function(e){n().close(e)}))}))};return d(e),{open:l,close:u,getNotifications:c}},HA=cc.PluginManager,jA=cc.ThemeManager;function qA(){var e=function(){throw new Error("Theme did not provide a WindowManager implementation.")};return{open:e,openUrl:e,alert:e,confirm:e,close:e,getParams:e,setParams:e}}var GA=function(e){var t=[],n=function(){var t=e.theme;return t&&t.getWindowManagerImpl?t.getWindowManagerImpl():qA()},r=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t?t.apply(e,n):void 0}},i=function(t){e.fire("OpenWindow",{dialog:t})},o=function(t){e.fire("CloseWindow",{dialog:t})},a=function(e){t.push(e),i(e)},s=function(n){o(n),t=ne(t,(function(e){return e!==n})),0===t.length&&e.focus()},l=function(){return j.from(t[t.length-1])},u=function(t){e.editorManager.setActive(e),Fb(e);var n=t();return a(n),n},c=function(e,t){return u((function(){return n().open(e,t,s)}))},d=function(e){return u((function(){return n().openUrl(e,s)}))},f=function(e,t,i){var o=n();o.alert(e,r(i||o,t))},h=function(e,t,i){var o=n();o.confirm(e,r(i||o,t))},m=function(){l().each((function(e){n().close(e),s(e)}))};return e.on("remove",(function(){Z(t,(function(e){n().close(e)}))})),{open:c,openUrl:d,alert:f,confirm:h,close:m}},WA=function(e,t){e.notificationManager.open({type:"error",text:t})},KA=function(e,t){e._skinLoaded?WA(e,t):e.on("SkinLoaded",(function(){WA(e,t)}))},YA=function(e,t){KA(e,uc.translate(["Failed to upload image: {0}",t]))},XA=function(e,t,n){Qg(e,t,{message:n}),console.error(n)},JA=function(e,t,n){return n?"Failed to load "+e+": "+n+" from url "+t:"Failed to load "+e+" url: "+t},QA=function(e,t,n){XA(e,"PluginLoadError",JA("plugin",t,n))},ZA=function(e,t,n){XA(e,"IconsLoadError",JA("icons",t,n))},eL=function(e,t,n){XA(e,"LanguageLoadError",JA("language",t,n))},tL=function(e,t,n){var r=uc.translate(["Failed to initialize plugin: {0}",t]);Qg(e,"PluginLoadError",{message:r}),nL(r,n),KA(e,r)},nL=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=window.console;r&&(r.error?r.error.apply(r,Ge([e],t,!1)):r.log.apply(r,Ge([e],t,!1)))},rL=function(e){return/^[a-z0-9\-]+$/i.test(e)},iL=function(e){return aL(e,Yf(e))},oL=function(e){return aL(e,Xf(e))},aL=function(e,t){var n=e.editorManager.baseURL+"/skins/content",r=e.editorManager.suffix,i="content"+r+".css",o=!0===e.inline;return Q(t,(function(t){return rL(t)&&!o?n+"/"+t+"/"+i:e.documentBaseURI.toAbsolute(t)}))},sL=function(e){e.contentCSS=e.contentCSS.concat(iL(e),oL(e))},lL=function(){var e=1,t=2,n={},r=function(e,t){return{status:e,resultUri:t}},i=function(e){return e in n},o=function(e){var t=n[e];return t?t.resultUri:null},a=function(t){return!!i(t)&&n[t].status===e},s=function(e){return!!i(e)&&n[e].status===t},l=function(t){n[t]=r(e,null)},u=function(e,i){n[e]=r(t,i)},c=function(e){delete n[e]},d=function(){n={}};return{hasBlobUri:i,getResultUri:o,isPending:a,isUploaded:s,markPending:l,markUploaded:u,removeFailed:c,destroy:d}},uL=0,cL=function(){var e=function(){return Math.round(4294967295*Math.random()).toString(36)},t=(new Date).getTime();return"s"+t.toString(36)+e()+e()+e()},dL=function(e){return e+uL+++cL()},fL=function(){var e=[],t=function(e){var t={"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png","image/apng":"apng","image/avif":"avif","image/svg+xml":"svg","image/webp":"webp","image/bmp":"bmp","image/tiff":"tiff"};return t[e.toLowerCase()]||"dat"},n=function(e,t,n,i,o){if(v(e)){var a=e;return r({id:a,name:i,filename:o,blob:t,base64:n})}if(b(e))return r(e);throw new Error("Unknown input type")},r=function(e){if(!e.blob||!e.base64)throw new Error("blob and base64 representations of the image are required for BlobInfo to be created");var n=e.id||dL("blobid"),r=e.name||n,i=e.blob;return{id:L(n),name:L(r),filename:L(e.filename||r+"."+t(i.type)),blob:L(i),base64:L(e.base64),blobUri:L(e.blobUri||URL.createObjectURL(i)),uri:L(e.uri)}},i=function(t){a(t.id())||e.push(t)},o=function(t){return ae(e,t).getOrUndefined()},a=function(e){return o((function(t){return t.id()===e}))},s=function(e){return o((function(t){return t.blobUri()===e}))},l=function(e,t){return o((function(n){return n.base64()===e&&n.blob().type===t}))},u=function(t){e=ne(e,(function(e){return e.blobUri()!==t||(URL.revokeObjectURL(e.blobUri()),!1)}))},c=function(){Z(e,(function(e){URL.revokeObjectURL(e.blobUri())})),e=[]};return{create:n,add:i,get:a,getByUri:s,getByData:l,findFirst:o,removeByUri:u,destroy:c}},hL=function(e,t){var n={},r=function(e,t){return e?e.replace(/\/$/,"")+"/"+t.replace(/^\//,""):t},i=function(e,n,i,o){var a=new XMLHttpRequest;a.open("POST",t.url),a.withCredentials=t.credentials,a.upload.onprogress=function(e){o(e.loaded/e.total*100)},a.onerror=function(){i("Image upload failed due to a XHR Transport error. Code: "+a.status)},a.onload=function(){if(a.status<200||a.status>=300)i("HTTP Error: "+a.status);else{var e=JSON.parse(a.responseText);e&&"string"===typeof e.location?n(r(t.basePath,e.location)):i("Invalid JSON: "+a.responseText)}};var s=new FormData;s.append("file",e.blob(),e.filename()),a.send(s)},o=function(){return new Ao((function(e){e([])}))},a=function(e,t){return{url:t,blobInfo:e,status:!0}},s=function(e,t,n){return{url:"",blobInfo:e,status:!1,error:{message:t,options:n}}},l=function(e,t){mn.each(n[e],(function(e){e(t)})),delete n[e]},u=function(t,n,r){return e.markPending(t.blobUri()),new Ao((function(i){var o,u;try{var c=function(){o&&(o.close(),u=E)},d=function(n){c(),e.markUploaded(t.blobUri(),n),l(t.blobUri(),a(t,n)),i(a(t,n))},f=function(n,r){var o=r||{};c(),e.removeFailed(t.blobUri()),l(t.blobUri(),s(t,n,o)),i(s(t,n,o))};u=function(e){e<0||e>100||j.from(o).orThunk((function(){return j.from(r).map(N)})).each((function(t){o=t,t.progressBar.value(e)}))},n(t,d,f,u)}catch(h){i(s(t,h.message,{}))}}))},c=function(e){return e===i},d=function(e){var t=e.blobUri();return new Ao((function(e){n[t]=n[t]||[],n[t].push(e)}))},f=function(n,r){return n=mn.grep(n,(function(t){return!e.isUploaded(t.blobUri())})),Ao.all(mn.map(n,(function(n){return e.isPending(n.blobUri())?d(n):u(n,t.handler,r)})))},h=function(e,n){return!t.url&&c(t.handler)?o():f(e,n)};return!1===D(t.handler)&&(t.handler=i),{upload:h}},mL=function(e){return function(){return e.notificationManager.open({text:e.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0})}},pL=function(e,t){return hL(t,{url:$f(e),basePath:zf(e),credentials:Uf(e),handler:Vf(e)})},gL=function(e){var t=lL(),n=pL(e,t);return{upload:function(t,r){return void 0===r&&(r=!0),n.upload(t,r?mL(e):void 0)}}},vL=function(e){var t=Xu(null);e.on("change AddUndo",(function(e){t.set(je({},e.level))}));var n=function(){var n=e.undoManager.data;ve(n).filter((function(e){return!fk(t.get(),e)})).each((function(t){e.setDirty(!0),e.fire("change",{level:t,lastLevel:pe(n,n.length-2).getOrNull()})}))};return{fireIfChanged:n}},bL=function(e){var t,n,r=fL(),i=lL(),o=[],a=vL(e),s=function(t){return function(n){return e.selection?t(n):[]}},l=function(e){return e+(-1===e.indexOf("?")?"?":"&")+(new Date).getTime()},u=function(e,t,n){var r=0;do{r=e.indexOf(t,r),-1!==r&&(e=e.substring(0,r)+n+e.substr(r+t.length),r+=n.length-t.length+1)}while(-1!==r);return e},c=function(e,t,n){var r='src="'+n+'"'+(n===en.transparentSrc?' data-mce-placeholder="1"':"");return e=u(e,'src="'+t+'"',r),e=u(e,'data-mce-src="'+t+'"','data-mce-src="'+n+'"'),e},d=function(t,n){Z(e.undoManager.data,(function(e){"fragmented"===e.type?e.fragments=Q(e.fragments,(function(e){return c(e,t,n)})):e.content=c(e.content,t,n)}))},f=function(t,n){var r=e.convertURL(n,"src");d(t.src,n),e.$(t).attr({src:Mf(e)?l(n):n,"data-mce-src":r})},h=function(n){return t||(t=pL(e,i)),v().then(s((function(i){var o=Q(i,(function(e){return e.blobInfo}));return t.upload(o,mL(e)).then(s((function(t){var o=[],s=Q(t,(function(t,n){var a=i[n].blobInfo,s=i[n].image;return t.status&&Nf(e)?(r.removeByUri(s.src),Rk(e)||f(s,t.url)):t.error&&(t.error.options.remove&&(d(s.getAttribute("src"),en.transparentSrc),o.push(s)),YA(e,t.error.message)),{element:s,status:t.status,uploadUri:t.url,blobInfo:a}}));return s.length>0&&a.fireIfChanged(),o.length>0&&(Rk(e)?console.error("Removing images on failed uploads is currently unsupported for RTC"):e.undoManager.transact((function(){Z(o,(function(t){e.dom.remove(t),r.removeByUri(t.src)}))}))),n&&n(s),s})))})))},m=function(t){if(Pf(e))return h(t)},p=function(t){if(!1===ce(o,(function(e){return e(t)})))return!1;if(0===t.getAttribute("src").indexOf("data:")){var n=If(e);return n(t)}return!0},g=function(e){o.push(e)},v=function(){return n||(n=$E(i,r)),n.findAll(e.getBody(),p).then(s((function(t){return t=ne(t,(function(t){return"string"!==typeof t||(KA(e,t),!1)})),Rk(e)||Z(t,(function(e){d(e.image.src,e.blobInfo.blobUri()),e.image.src=e.blobInfo.blobUri(),e.image.removeAttribute("data-mce-src")})),t})))},b=function(){r.destroy(),i.destroy(),n=t=null},y=function(t){return t.replace(/src="(blob:[^"]+)"/g,(function(t,n){var o=i.getResultUri(n);if(o)return'src="'+o+'"';var a=r.getByUri(n);if(a||(a=ie(e.editorManager.get(),(function(e,t){return e||t.editorUpload&&t.editorUpload.blobCache.getByUri(n)}),null)),a){var s=a.blob();return'src="data:'+s.type+";base64,"+a.base64()+'"'}return t}))};return e.on("SetContent",(function(){Pf(e)?m():v()})),e.on("RawSaveContent",(function(e){e.content=y(e.content)})),e.on("GetContent",(function(e){e.source_view||"raw"===e.format||"tree"===e.format||(e.content=y(e.content))})),e.on("PostRender",(function(){e.parser.addNodeFilter("img",(function(e){Z(e,(function(e){var t=e.attr("src");if(!r.getByUri(t)){var n=i.getResultUri(t);n&&e.attr("src",n)}}))}))})),{blobCache:r,addFilter:g,uploadImages:h,uploadImagesAuto:m,scanForImages:v,destroy:b}},yL=function(e){var t={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"left"},inherit:!1,preview:!1,defaultBlock:"div"},{selector:"img,table,audio,video",collapsed:!1,styles:{float:"left"},preview:"font-family font-size"}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"img,table,audio,video",collapsed:!1,styles:{float:"right"},preview:"font-family font-size"}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"justify"},inherit:!1,defaultBlock:"div",preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all",preserve_attributes:["class","style"]}],italic:[{inline:"em",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all",preserve_attributes:["class","style"]}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all",preserve_attributes:["class","style"]}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:!0},{inline:"strike",remove:"all",preserve_attributes:["class","style"]},{inline:"s",remove:"all",preserve_attributes:["class","style"]}],forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},lineheight:{selector:"h1,h2,h3,h4,h5,h6,p,li,td,th,div",defaultBlock:"p",styles:{lineHeight:"%value"}},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:!0,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:function(e,t,n){return Hr(e)&&e.hasAttribute("href")},onformat:function(t,n,r){mn.each(r,(function(n,r){e.setAttrib(t,r,n)}))}},lang:{inline:"span",clear_child_styles:!0,remove_similar:!0,attributes:{lang:"%value","data-mce-lang":function(e){var t;return null!==(t=null===e||void 0===e?void 0:e.customValue)&&void 0!==t?t:null}}},removeformat:[{selector:"b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins,small",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]};return mn.each("p h1 h2 h3 h4 h5 h6 div address pre dt dd samp".split(/\s/),(function(e){t[e]={block:e,remove:"all"}})),t},wL=function(e){var t={},n=function(e){return T(e)?t[e]:t},r=function(e){return Re(t,e)},i=function(e,n){e&&(v(e)?(y(n)||(n=[n]),Z(n,(function(e){x(e.deep)&&(e.deep=!jp(e)),x(e.split)&&(e.split=!jp(e)||qp(e)),x(e.remove)&&jp(e)&&!qp(e)&&(e.remove="none"),jp(e)&&qp(e)&&(e.mixed=!0,e.block_expand=!0),v(e.classes)&&(e.classes=e.classes.split(/\s+/))})),t[e]=n):xe(e,(function(e,t){i(t,e)})))},o=function(e){return e&&t[e]&&delete t[e],t};return i(yL(e.dom)),i(sh(e)),{get:n,has:r,register:i,unregister:o}},SL=mn.each,xL=Uu.DOM,CL=function(e,t){var n,r,i,o=t&&t.schema||Us({}),a=function(e,t){t.classes.length&&xL.addClass(e,t.classes.join(" ")),xL.setAttribs(e,t.attrs)},s=function(e){r="string"===typeof e?{name:e,classes:[],attrs:{}}:e;var t=xL.create(r.name);return a(t,r),t},l=function(e,t){var n="string"!==typeof e?e.nodeName.toLowerCase():e,r=o.getElementRule(n),i=r&&r.parentsRequired;return!(!i||!i.length)&&(t&&-1!==mn.inArray(i,t)?t:i[0])},u=function(e,t,n){var r,i,o=t.length>0&&t[0],a=o&&o.name,c=l(e,a);if(c)a===c?(i=t[0],t=t.slice(1)):i=c;else if(o)i=t[0],t=t.slice(1);else if(!n)return e;return i&&(r=s(i),r.appendChild(e)),n&&(r||(r=xL.create("div"),r.appendChild(e)),mn.each(n,(function(t){var n=s(t);r.insertBefore(n,e)}))),u(r,t,i&&i.siblings)};return e&&e.length?(r=e[0],n=s(r),i=xL.create("div"),i.appendChild(u(n,e.slice(1),r.siblings)),i):""},TL=function(e){var t,n={classes:[],attrs:{}};return e=n.selector=mn.trim(e),"*"!==e&&(t=e.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,(function(e,t,r,i,o){switch(t){case"#":n.attrs.id=r;break;case".":n.classes.push(r);break;case":":-1!==mn.inArray("checked disabled enabled read-only required".split(" "),r)&&(n.attrs[r]=r);break}if("["===i){var a=o.match(/([\w\-]+)(?:\=\"([^\"]+))?/);a&&(n.attrs[a[1]]=a[2])}return""}))),n.name=t||"div",n},DL=function(e){return e&&"string"===typeof e?(e=e.split(/\s*,\s*/)[0],e=e.replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),mn.map(e.split(/(?:>|\s+(?![^\[\]]+\]))/),(function(e){var t=mn.map(e.split(/(?:~\+|~|\+)/),TL),n=t.pop();return t.length&&(n.siblings=t),n})).reverse()):[]},kL=function(e,t){var n,r,i,o="",a=lh(e);if(""===a)return"";var s=function(e){return e.replace(/%(\w+)/g,"")};if("string"===typeof t){if(t=e.formatter.get(t),!t)return;t=t[0]}if("preview"in t){var l=Oe(t,"preview");if(ui(l,!1))return"";a=l.getOr(a)}n=t.block||t.inline||"span";var u=DL(t.selector);u.length?(u[0].name||(u[0].name=n),n=t.selector,r=CL(u,e)):r=CL([n],e);var c=xL.select(n,r)[0]||r.firstChild;return SL(t.styles,(function(e,t){var n=s(e);n&&xL.setStyle(c,t,n)})),SL(t.attributes,(function(e,t){var n=s(e);n&&xL.setAttrib(c,t,n)})),SL(t.classes,(function(e){var t=s(e);xL.hasClass(c,t)||xL.addClass(c,t)})),e.fire("PreviewFormats"),xL.setStyles(r,{position:"absolute",left:-65535}),e.getBody().appendChild(r),i=xL.getStyle(e.getBody(),"fontSize",!0),i=/px$/.test(i)?parseInt(i,10):0,SL(a.split(" "),(function(t){var n=xL.getStyle(c,t,!0);if(("background-color"!==t||!/transparent|rgba\s*\([^)]+,\s*0\)/.test(n)||(n=xL.getStyle(e.getBody(),t,!0),"#ffffff"!==xL.toHex(n).toLowerCase()))&&("color"!==t||"#000000"!==xL.toHex(n).toLowerCase())){if("font-size"===t&&/em|%$/.test(n)){if(0===i)return;var r=parseFloat(n)/(/%$/.test(n)?100:1);n=r*i+"px"}"border"===t&&n&&(o+="padding:0 2px;"),o+=t+":"+n+";"}})),e.fire("AfterPreviewFormats"),xL.remove(r),o},EL=function(e){e.addShortcut("meta+b","","Bold"),e.addShortcut("meta+i","","Italic"),e.addShortcut("meta+u","","Underline");for(var t=1;t<=6;t++)e.addShortcut("access+"+t,"",["FormatBlock",!1,"h"+t]);e.addShortcut("access+7","",["FormatBlock",!1,"p"]),e.addShortcut("access+8","",["FormatBlock",!1,"div"]),e.addShortcut("access+9","",["FormatBlock",!1,"address"])},_L=function(e){var t=wL(e),n=Xu(null);return EL(e),iT(e),{get:t.get,has:t.has,register:t.register,unregister:t.unregister,apply:function(t,n,r){Zk(e,t,n,r)},remove:function(t,n,r,i){eE(e,t,n,r,i)},toggle:function(t,n,r){tE(e,t,n,r)},match:function(t,n,r,i){return Kk(e,t,n,r,i)},closest:function(t){return Qk(e,t)},matchAll:function(t,n){return Yk(e,t,n)},matchNode:function(t,n,r,i){return Xk(e,t,n,r,i)},canApply:function(t){return Jk(e,t)},formatChanged:function(t,r,i,o){return nE(e,n,t,r,i,o)},getCssText:I(kL,e)}},AL=function(e){switch(e.toLowerCase()){case"undo":case"redo":case"mcerepaint":case"mcefocus":return!0;default:return!1}},LL=function(e,t,n){var r=Xu(!1),i=function(e){mk(t,!1,n),t.add({},e)};e.on("init",(function(){t.add()})),e.on("BeforeExecCommand",(function(e){var r=e.command;AL(r)||(pk(t,n),t.beforeChange())})),e.on("ExecCommand",(function(e){var t=e.command;AL(t)||i(e)})),e.on("ObjectResizeStart cut",(function(){t.beforeChange()})),e.on("SaveContent ObjectResized blur",i),e.on("dragend",i),e.on("keyup",(function(n){var o=n.keyCode;n.isDefaultPrevented()||((o>=33&&o<=36||o>=37&&o<=40||45===o||n.ctrlKey)&&(i(),e.nodeChanged()),46!==o&&8!==o||e.nodeChanged(),r.get()&&t.typing&&!1===fk(ak(e),t.data[0])&&(!1===e.isDirty()&&(e.setDirty(!0),e.fire("change",{level:t.data[0],lastLevel:null})),e.fire("TypingUndo"),r.set(!1),e.nodeChanged()))})),e.on("keydown",(function(e){var o=e.keyCode;if(!e.isDefaultPrevented())if(o>=33&&o<=36||o>=37&&o<=40||45===o)t.typing&&i(e);else{var a=e.ctrlKey&&!e.altKey||e.metaKey;!(o<16||o>20)||224===o||91===o||t.typing||a||(t.beforeChange(),mk(t,!0,n),t.add({},e),r.set(!0))}})),e.on("mousedown",(function(e){t.typing&&i(e)}));var o=function(e){return"insertReplacementText"===e.inputType},a=function(e){return"insertText"===e.inputType&&null===e.data},s=function(e){return"insertFromPaste"===e.inputType||"insertFromDrop"===e.inputType};e.on("input",(function(e){e.inputType&&(o(e)||a(e)||s(e))&&i(e)})),e.on("AddUndo Undo Redo ClearUndos",(function(t){t.isDefaultPrevented()||e.nodeChanged()}))},OL=function(e){e.addShortcut("meta+z","","Undo"),e.addShortcut("meta+y,meta+shift+z","","Redo")},RL=function(e){var t=fc(),n=Xu(0),r=Xu(0),i={data:[],typing:!1,beforeChange:function(){Fk(e,n,t)},add:function(o,a){return Bk(e,i,r,n,t,o,a)},undo:function(){return $k(e,i,n,r)},redo:function(){return zk(e,r,i.data)},clear:function(){Uk(e,i,r)},reset:function(){Vk(e,i)},hasUndo:function(){return Hk(e,i,r)},hasRedo:function(){return jk(e,i,r)},transact:function(t){return qk(e,i,n,t)},ignore:function(t){Gk(e,n,t)},extra:function(t,n){Wk(e,i,r,t,n)}};return Rk(e)||LL(e,i,n),OL(e),i},IL=[9,27,tv.HOME,tv.END,19,20,44,144,145,33,34,45,16,17,18,91,92,93,tv.DOWN,tv.UP,tv.LEFT,tv.RIGHT].concat(en.browser.isFirefox()?[224]:[]),PL="data-mce-placeholder",ML=function(e){return"keydown"===e.type||"keyup"===e.type},NL=function(e){var t=e.keyCode;return t===tv.BACKSPACE||t===tv.DELETE},FL=function(e){if(ML(e)){var t=e.keyCode;return!NL(e)&&(tv.metaKeyPressed(e)||e.altKey||t>=112&&t<=123||X(IL,t))}return!1},BL=function(e){return ML(e)&&!(NL(e)||"keyup"===e.type&&229===e.keyCode)},$L=function(e,t,n){if(ns(wn.fromDom(t),!1)){var r=""===n,i=t.firstElementChild;return!i||!e.getStyle(t.firstElementChild,"padding-left")&&!e.getStyle(t.firstElementChild,"padding-right")&&(r?!e.isBlock(i):n===i.nodeName.toLowerCase())}return!1},zL=function(e){var t=e.dom,n=Df(e),r=th(e),i=function(o,a){if(!FL(o)){var s=e.getBody(),l=!BL(o)&&$L(t,s,n),u=""!==t.getAttrib(s,PL);(u!==l||a)&&(t.setAttrib(s,PL,l?r:null),t.setAttrib(s,"aria-placeholder",l?r:null),Jg(e,l),e.on(l?"keydown":"keyup",i),e.off(l?"keyup":"keydown",i))}};r&&e.on("init",(function(t){i(t,!0),e.on("change SetContent ExecCommand",i),e.on("paste",(function(t){return No.setEditorTimeout(e,(function(){return i(t)}))}))}))},UL=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,VL=function(e){return UL.test(e)},HL=function(e,t){return An(wn.fromDom(t),Qf(e))},jL=function(e){return"rtl"===Uu.DOM.getStyle(e,"direction",!0)||VL(e.textContent)},qL=function(e,t,n){return ne(Uu.DOM.getParents(n.container(),"*",t),e)},GL=function(e,t,n){var r=qL(e,t,n);return j.from(r[r.length-1])},WL=function(e,t,n){var r=cm(t,e),i=cm(n,e);return r&&r===i},KL=function(e){return xa(e)||Ca(e)},YL=function(e,t){if(!t)return t;var n=t.container(),r=t.offset();return e?ba(n)?Zr(n.nextSibling)?Rd(n.nextSibling,0):Rd.after(n):xa(t)?Rd(n,r+1):t:ba(n)?Zr(n.previousSibling)?Rd(n.previousSibling,n.previousSibling.data.length):Rd.before(n):Ca(t)?Rd(n,r-1):t},XL=I(YL,!0),JL=I(YL,!1),QL=function(e){return function(t){return In(e,wn.fromDom(t.dom.parentNode))}},ZL=function(e){return ta(e)||ra(e)},eO=function(e,t){return Nn(e,t)?Co(t,ZL,QL(e)):j.none()},tO=function(e){var t=e.getBody(),n=t.firstChild&&e.dom.isBlock(t.firstChild)?t.firstChild:t;e.selection.setCursorLocation(n,0)},nO=function(e){e.dom.isEmpty(e.getBody())&&(e.setContent(""),tO(e))},rO=function(e,t,n){return di(Jm(n),Qm(n),(function(r,i){var o=YL(!0,r),a=YL(!1,i),s=YL(!1,t);return e?Ym(n,s).exists((function(e){return e.isEqual(a)&&t.isEqual(o)})):Xm(n,s).exists((function(e){return e.isEqual(o)&&t.isEqual(a)}))})).getOr(!0)},iO=function(e,t){return{block:e,position:t}},oO=function(e,t){return{from:e,to:t}},aO=function(e,t){var n=wn.fromDom(e),r=wn.fromDom(t.container());return eO(n,r).map((function(e){return iO(e,t)}))},sO=function(e){return!1===In(e.from.block,e.to.block)},lO=function(e){return Xn(e.from.block).bind((function(t){return Xn(e.to.block).filter((function(e){return In(t,e)}))})).isSome()},uO=function(e){return!1===ai(e.from.block.dom)&&!1===ai(e.to.block.dom)},cO=function(e,t,n){return ri(n.position.getNode())&&!1===ns(n.block)?Km(!1,n.block.dom).bind((function(r){return r.isEqual(n.position)?qm(t,e,r).bind((function(t){return aO(e,t)})):j.some(n)})).getOr(n):n},dO=function(e,t,n){var r=aO(e,Rd.fromRangeStart(n)),i=r.bind((function(n){return qm(t,e,n.position).bind((function(n){return aO(e,n).map((function(n){return cO(e,t,n)}))}))}));return di(r,i,oO).filter((function(e){return sO(e)&&lO(e)&&uO(e)}))},fO=function(e,t,n){return n.collapsed?dO(e,t,n):j.none()},hO=function(e){var t=rr(e);return se(t,Jo).fold(L(t),(function(e){return t.slice(0,e)}))},mO=function(e){var t=hO(e);return Z(t,kr),t},pO=function(e,t){var n=Aw(t,e);return ae(n.reverse(),(function(e){return ns(e)})).each(kr)},gO=function(e){return 0===ne(tr(e),(function(e){return!ns(e)})).length},vO=function(e,t,n,r){if(ns(n))return Tw(n),Jm(n.dom);gO(r)&&ns(t)&&br(r,wn.fromTag("br"));var i=Xm(n.dom,Rd.before(r.dom));return Z(mO(t),(function(e){br(r,e)})),pO(e,t),i},bO=function(e,t,n){if(ns(n))return kr(n),ns(t)&&Tw(t),Jm(t.dom);var r=Qm(n.dom);return Z(mO(t),(function(e){Sr(n,e)})),pO(e,t),r},yO=function(e,t){var n=Aw(t,e);return j.from(n[n.length-1])},wO=function(e,t){return Nn(t,e)?yO(t,e):j.none()},SO=function(e,t){Km(e,t.dom).map((function(e){return e.getNode()})).map(wn.fromDom).filter(ea).each(kr)},xO=function(e,t,n){return SO(!0,t),SO(!1,n),wO(t,n).fold(I(bO,e,t,n),I(vO,e,t,n))},CO=function(e,t,n,r){return t?xO(e,r,n):xO(e,n,r)},TO=function(e,t){var n=wn.fromDom(e.getBody()),r=fO(n.dom,t,e.selection.getRng()).bind((function(e){return CO(n,t,e.from.block,e.to.block)}));return r.each((function(t){e.selection.setRng(t.toRange())})),r.isSome()},DO=function(e,t){var n=t.getRng();return di(eO(e,wn.fromDom(n.startContainer)),eO(e,wn.fromDom(n.endContainer)),(function(r,i){return!1===In(r,i)&&(n.deleteContents(),CO(e,!0,r,i).each((function(e){t.setRng(e.toRange())})),!0)})).getOr(!1)},kO=function(e,t){var n=wn.fromDom(t),r=I(In,e);return xo(n,oa,r).isSome()},EO=function(e,t){return kO(e,t.startContainer)||kO(e,t.endContainer)},_O=function(e,t){var n=Xm(e.dom,Rd.fromRangeStart(t)).isNone(),r=Ym(e.dom,Rd.fromRangeEnd(t)).isNone();return!EO(e,t)&&n&&r},AO=function(e){return e.setContent(""),e.selection.setCursorLocation(),!0},LO=function(e){var t=wn.fromDom(e.getBody()),n=e.selection.getRng();return _O(t,n)?AO(e):DO(t,e.selection)},OO=function(e,t){return!e.selection.isCollapsed()&&LO(e)},RO=oi,IO=ai,PO=function(e,t,n,r,i){return j.from(t._selectionOverrides.showCaret(e,n,r,i))},MO=function(e){var t=e.ownerDocument.createRange();return t.selectNode(e),t},NO=function(e,t){var n=e.fire("BeforeObjectSelected",{target:t});return n.isDefaultPrevented()?j.none():j.some(MO(t))},FO=function(e,t,n){var r=bm(1,e.getBody(),t),i=Rd.fromRangeStart(r),o=i.getNode();if(Jh(o))return PO(1,e,o,!i.isAtEnd(),!1);var a=i.getNode(!0);if(Jh(a))return PO(1,e,a,!1,!1);var s=e.dom.getParent(i.getNode(),(function(e){return IO(e)||RO(e)}));return Jh(s)?PO(1,e,s,!1,n):j.none()},BO=function(e,t,n){return t.collapsed?FO(e,t,n).getOr(t):t},$O=function(e){return ww(e)||gw(e)},zO=function(e){return Sw(e)||vw(e)},UO=function(e,t){Zr(t)&&0===t.data.length&&e.remove(t)},VO=function(e,t,n,r,i,o){return PO(r,e,o.getNode(!i),i,!0).each((function(n){if(t.collapsed){var r=t.cloneRange();i?r.setEnd(n.startContainer,n.startOffset):r.setStart(n.endContainer,n.endOffset),r.deleteContents()}else t.deleteContents();e.selection.setRng(n)})),UO(e.dom,n),!0},HO=function(e,t){var n=e.selection.getRng();if(!Zr(n.commonAncestorContainer))return!1;var r=t?Id.Forwards:Id.Backwards,i=Fm(e.getBody()),o=I(Cm,t?i.next:i.prev),a=t?$O:zO,s=wm(r,e.getBody(),n),l=YL(t,o(s));if(!l||!Tm(s,l))return!1;if(a(l))return VO(e,n,s.getNode(),r,t,l);var u=o(l);return!!(u&&a(u)&&Tm(l,u))&&VO(e,n,s.getNode(),r,t,u)},jO=function(e,t){return HO(e,t)},qO=function(e){return oa(wn.fromDom(e))||ra(wn.fromDom(e))},GO=Zi.generate([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),WO=function(e,t){var n=t.getNode(!1===e),r=e?"after":"before";return Hr(n)&&n.getAttribute("data-mce-caret")===r},KO=function(e,t,n,r){var i=function(t){return Zo(wn.fromDom(t))&&!dm(n,r,e)};return ym(!t,n).fold((function(){return ym(t,r).fold(B,i)}),i)},YO=function(e,t,n,r){var i=r.getNode(!1===t);return eO(wn.fromDom(e),wn.fromDom(n.getNode())).map((function(e){return ns(e)?GO.remove(e.dom):GO.moveToElement(i)})).orThunk((function(){return j.some(GO.moveToElement(i))}))},XO=function(e,t,n){return qm(t,e,n).bind((function(r){return qO(r.getNode())||KO(e,t,n,r)?j.none():t&&ai(r.getNode())||!1===t&&ai(r.getNode(!0))?YO(e,t,n,r):t&&Sw(n)||!1===t&&ww(n)?j.some(GO.moveToPosition(r)):j.none()}))},JO=function(e,t){return e&&ai(t.nextSibling)?j.some(GO.moveToElement(t.nextSibling)):!1===e&&ai(t.previousSibling)?j.some(GO.moveToElement(t.previousSibling)):j.none()},QO=function(e,t,n){return n.fold((function(e){return j.some(GO.remove(e))}),(function(e){return j.some(GO.moveToElement(e))}),(function(n){return dm(t,n,e)?j.none():j.some(GO.moveToPosition(n))}))},ZO=function(e,t,n){return WO(t,n)?JO(t,n.getNode(!1===t)).fold((function(){return XO(e,t,n)}),j.some):XO(e,t,n).bind((function(t){return QO(e,n,t)}))},eR=function(e,t,n){var r=bm(t?1:-1,e,n),i=Rd.fromRangeStart(r),o=wn.fromDom(e);return!1===t&&Sw(i)?j.some(GO.remove(i.getNode(!0))):t&&ww(i)?j.some(GO.remove(i.getNode())):!1===t&&ww(i)&&Uw(o,i)?Vw(o,i).map((function(e){return GO.remove(e.getNode())})):t&&Sw(i)&&zw(o,i)?Hw(o,i).map((function(e){return GO.remove(e.getNode())})):ZO(e,t,i)},tR=function(e,t){return function(n){return e._selectionOverrides.hideFakeCaret(),MS(e,t,wn.fromDom(n)),!0}},nR=function(e,t){return function(n){var r=t?Rd.before(n):Rd.after(n);return e.selection.setRng(r.toRange()),!0}},rR=function(e){return function(t){return e.selection.setRng(t.toRange()),!0}},iR=function(e,t){return j.from($g(e.getBody(),t))},oR=function(e,t){var n=e.selection.getNode();return iR(e,n).filter(ai).fold((function(){return eR(e.getBody(),t,e.selection.getRng()).exists((function(n){return n.fold(tR(e,t),nR(e,t),rR(e))}))}),$)},aR=function(e){Z(Ec(e,".mce-offscreen-selection"),kr)},sR=function(e,t){var n=e.selection.getNode();if(ai(n)&&!si(n)){var r=iR(e,n.parentNode).filter(ai);return r.fold((function(){return aR(wn.fromDom(e.getBody())),MS(e,t,wn.fromDom(e.selection.getNode())),nO(e),!0}),$)}return!1},lR=function(e){var t=e.dom,n=e.selection,r=$g(e.getBody(),n.getNode());if(oi(r)&&t.isBlock(r)&&t.isEmpty(r)){var i=t.create("br",{"data-mce-bogus":"1"});t.setHTML(r,""),r.appendChild(i),n.setRng(Rd.before(i).toRange())}return!0},uR=function(e,t){return e.selection.isCollapsed()?oR(e,t):sR(e,t)},cR=function(e,t){var n=Rd.fromRangeStart(e.selection.getRng());return qm(t,e.getBody(),n).filter((function(e){return t?mw(e):pw(e)})).bind((function(e){return j.from(fm(t?0:-1,e))})).exists((function(t){return e.selection.select(t),!0}))},dR=function(e,t){return!!e.selection.isCollapsed()&&cR(e,t)},fR=Zr,hR=function(e){return fR(e)&&e.data[0]===fa},mR=function(e){return fR(e)&&e.data[e.data.length-1]===fa},pR=function(e){return e.ownerDocument.createTextNode(fa)},gR=function(e){if(fR(e.previousSibling))return mR(e.previousSibling)||e.previousSibling.appendData(fa),e.previousSibling;if(fR(e))return hR(e)||e.insertData(0,fa),e;var t=pR(e);return e.parentNode.insertBefore(t,e),t},vR=function(e){if(fR(e.nextSibling))return hR(e.nextSibling)||e.nextSibling.insertData(0,fa),e.nextSibling;if(fR(e))return mR(e)||e.appendData(fa),e;var t=pR(e);return e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t),t},bR=function(e,t){return e?gR(t):vR(t)},yR=I(bR,!0),wR=I(bR,!1),SR=function(e,t){return Zr(e.container())?bR(t,e.container()):bR(t,e.getNode())},xR=function(e,t){var n=t.get();return n&&e.container()===n&&ba(n)},CR=function(e,t){return t.fold((function(t){Uh(e.get());var n=yR(t);return e.set(n),j.some(Rd(n,n.length-1))}),(function(t){return Jm(t).map((function(t){if(xR(t,e))return Rd(e.get(),1);Uh(e.get());var n=SR(t,!0);return e.set(n),Rd(n,1)}))}),(function(t){return Qm(t).map((function(t){if(xR(t,e))return Rd(e.get(),e.get().length-1);Uh(e.get());var n=SR(t,!1);return e.set(n),Rd(n,n.length-1)}))}),(function(t){Uh(e.get());var n=wR(t);return e.set(n),j.some(Rd(n,1))}))},TR=function(e,t){for(var n=0;n<e.length;n++){var r=e[n].apply(null,t);if(r.isSome())return r}return j.none()},DR=Zi.generate([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),kR=function(e,t){var n=cm(t,e);return n||e},ER=function(e,t,n){var r=XL(n),i=kR(t,r.container());return GL(e,i,r).fold((function(){return Ym(i,r).bind(I(GL,e,i)).map((function(e){return DR.before(e)}))}),j.none)},_R=function(e,t){return null===tp(e,t)},AR=function(e,t,n){return GL(e,t,n).filter(I(_R,t))},LR=function(e,t,n){var r=JL(n);return AR(e,t,r).bind((function(e){var t=Xm(e,r);return t.isNone()?j.some(DR.start(e)):j.none()}))},OR=function(e,t,n){var r=XL(n);return AR(e,t,r).bind((function(e){var t=Ym(e,r);return t.isNone()?j.some(DR.end(e)):j.none()}))},RR=function(e,t,n){var r=JL(n),i=kR(t,r.container());return GL(e,i,r).fold((function(){return Xm(i,r).bind(I(GL,e,i)).map((function(e){return DR.after(e)}))}),j.none)},IR=function(e){return!1===jL(MR(e))},PR=function(e,t,n){var r=TR([ER,LR,OR,RR],[e,t,n]);return r.filter(IR)},MR=function(e){return e.fold(O,O,O,O)},NR=function(e){return e.fold(L("before"),L("start"),L("end"),L("after"))},FR=function(e){return e.fold(DR.before,DR.before,DR.after,DR.after)},BR=function(e){return e.fold(DR.start,DR.start,DR.end,DR.end)},$R=function(e,t){return NR(e)===NR(t)&&MR(e)===MR(t)},zR=function(e,t,n,r,i,o){return di(GL(t,n,r),GL(t,n,i),(function(t,r){return t!==r&&WL(n,t,r)?DR.after(e?t:r):o})).getOr(o)},UR=function(e,t){return e.fold($,(function(e){return!$R(e,t)}))},VR=function(e,t,n,r,i){var o=YL(e,i),a=qm(e,n,o).map(I(YL,e)),s=a.fold((function(){return r.map(FR)}),(function(i){return PR(t,n,i).map(I(zR,e,t,n,o,i)).filter(I(UR,r))}));return s.filter(IR)},HR=function(e,t){return e?t.fold(_(j.some,DR.start),j.none,_(j.some,DR.after),j.none):t.fold(j.none,_(j.some,DR.before),j.none,_(j.some,DR.end))},jR=function(e,t,n,r){var i=YL(e,r),o=PR(t,n,i);return PR(t,n,i).bind(I(HR,e)).orThunk((function(){return VR(e,t,n,o,r)}))};I(jR,!1),I(jR,!0);var qR,GR=function(e){return D(e.selection.getSel().modify)},WR=function(e,t,n){var r=e?1:-1;return t.setRng(Rd(n.container(),n.offset()+r).toRange()),t.getSel().modify("move",e?"forward":"backward","word"),!0},KR=function(e,t){var n=t.selection.getRng(),r=e?Rd.fromRangeEnd(n):Rd.fromRangeStart(n);return!!GR(t)&&(e&&xa(r)?WR(!0,t.selection,r):!(e||!Ca(r))&&WR(!1,t.selection,r))};(function(e){e[e["Br"]=0]="Br",e[e["Block"]=1]="Block",e[e["Wrap"]=2]="Wrap",e[e["Eol"]=3]="Eol"})(qR||(qR={}));var YR,XR=function(e,t){return e===Id.Backwards?de(t):t},JR=function(e,t,n){return e===Id.Forwards?t.next(n):t.prev(n)},QR=function(e,t,n,r){return ri(r.getNode(t===Id.Forwards))?qR.Br:!1===dm(n,r)?qR.Block:qR.Wrap},ZR=function(e,t,n,r){var i=Fm(n),o=r,a=[];while(o){var s=JR(t,i,o);if(!s)break;if(ri(s.getNode(!1)))return t===Id.Forwards?{positions:XR(t,a).concat([s]),breakType:qR.Br,breakAt:j.some(s)}:{positions:XR(t,a),breakType:qR.Br,breakAt:j.some(s)};if(s.isVisible()){if(e(o,s)){var l=QR(n,t,o,s);return{positions:XR(t,a),breakType:l,breakAt:j.some(s)}}a.push(s),o=s}else o=s}return{positions:XR(t,a),breakType:qR.Eol,breakAt:j.none()}},eI=function(e,t,n,r){return t(n,r).breakAt.map((function(r){var i=t(n,r).positions;return e===Id.Backwards?i.concat(r):[r].concat(i)})).getOr([])},tI=function(e,t){return ie(e,(function(e,n){return e.fold((function(){return j.some(n)}),(function(r){return di(ge(r.getClientRects()),ge(n.getClientRects()),(function(e,i){var o=Math.abs(t-e.left),a=Math.abs(t-i.left);return a<=o?n:r})).or(e)}))}),j.none())},nI=function(e,t){return ge(t.getClientRects()).bind((function(t){return tI(e,t.left)}))},rI=I(ZR,Rd.isAbove,-1),iI=I(ZR,Rd.isBelow,1),oI=I(eI,-1,rI),aI=I(eI,1,iI),sI=function(e,t){return rI(e,t).breakAt.isNone()},lI=function(e,t){return iI(e,t).breakAt.isNone()},uI=function(e){return Jm(e).map((function(t){return[t].concat(iI(e,t).positions)})).getOr([])},cI=function(e){return Qm(e).map((function(t){return rI(e,t).positions.concat(t)})).getOr([])},dI=function(e){var t=function(t){return Q(t,(function(t){var n=Jc(t);return n.node=e,n}))};if(Hr(e))return t(e.getClientRects());if(Zr(e)){var n=e.ownerDocument.createRange();return n.setStart(e,0),n.setEnd(e,e.data.length),t(n.getClientRects())}},fI=function(e){return ue(e,dI)};(function(e){e[e["Up"]=-1]="Up",e[e["Down"]=1]="Down"})(YR||(YR={}));var hI,mI,pI=function(e,t,n,r){while(r=um(r,e,qa,t))if(n(r))return},gI=function(e,t,n,r,i,o){var a=0,s=[],l=function(r){var o=fI([r]);-1===e&&(o=o.reverse());for(var l=0;l<o.length;l++){var c=o[l];if(!n(c,u)){if(s.length>0&&t(c,He(s))&&a++,c.line=a,i(c))return!0;s.push(c)}}},u=He(o.getClientRects());if(!u)return s;var c=o.getNode();return l(c),pI(e,r,l,c),s},vI=function(e,t){return t.line>e},bI=function(e,t){return t.line===e},yI=I(gI,YR.Up,td,nd),wI=I(gI,YR.Down,nd,td),SI=function(e,t,n,r){var i,o,a,s,l=Fm(t),u=[],c=0,d=function(e){return He(e.getClientRects())};1===e?(i=l.next,o=nd,a=td,s=Rd.after(r)):(i=l.prev,o=td,a=nd,s=Rd.before(r));var f=d(s);do{if(s.isVisible()){var h=d(s);if(!a(h,f)){u.length>0&&o(h,He(u))&&c++;var m=Jc(h);if(m.position=s,m.line=c,n(m))return u;u.push(m)}}}while(s=i(s));return u},xI=function(e){return function(t){return vI(e,t)}},CI=function(e){return function(t){return bI(e,t)}},TI=ai,DI=um,kI=function(e,t){return Math.abs(e.left-t)},EI=function(e,t){return Math.abs(e.right-t)},_I=function(e,t){return e>=t.left&&e<=t.right},AI=function(e,t){return e>=t.top&&e<=t.bottom},LI=function(e){return Ie(e,"node")},OI=function(e,t,n){return void 0===n&&(n=$),Ue(e,(function(e,r){if(_I(t,r))return n(r)?r:e;if(_I(t,e))return n(e)?e:r;var i=Math.min(kI(e,t),EI(e,t)),o=Math.min(kI(r,t),EI(r,t));return o===i&&LI(r)&&TI(r.node)||o<i?r:e}))},RI=function(e,t,n,r,i){var o=DI(r,e,qa,t,!i);do{if(!o||n(o))return}while(o=DI(o,e,qa,t))},II=function(e,t,n){void 0===n&&(n=!0);var r=[],i=function(e,n){var i=ne(fI([n]),(function(n){return!e(n,t)}));return r=r.concat(i),0===i.length};return r.push(t),RI(YR.Up,e,I(i,td),t.node,n),RI(YR.Down,e,I(i,nd),t.node,n),r},PI=function(e){return ne(be(e.getElementsByTagName("*")),Qh)},MI=function(e,t){return{node:e.node,before:kI(e,t)<EI(e,t)}},NI=function(e,t,n){var r=fI(PI(e)),i=ne(r,I(AI,n)),o=function(e){return!Xr(e.node)&&!li(e.node)},a=OI(i,t,o);if(a){var s=o(a);if(a=OI(II(e,a,s),t,o),a&&Qh(a.node))return MI(a,t)}return null},FI=function(e,t){e.selection.setRng(t),nb(e,e.selection.getRng())},BI=function(e,t,n){return j.some(BO(e,t,n))},$I=function(e,t,n,r,i,o){var a=t===Id.Forwards,s=Fm(e.getBody()),l=I(Cm,a?s.next:s.prev),u=a?r:i;if(!n.collapsed){var c=od(n);if(o(c))return PO(t,e,c,t===Id.Backwards,!1)}var d=wm(t,e.getBody(),n);if(u(d))return NO(e,d.getNode(!a));var f=YL(a,l(d)),h=La(n);if(!f)return h?j.some(n):j.none();if(u(f))return PO(t,e,f.getNode(!a),a,!1);var m=l(f);return m&&u(m)&&Tm(f,m)?PO(t,e,m.getNode(!a),a,!1):h?BI(e,f.toRange(),!1):j.none()},zI=function(e,t,n,r,i,o){var a=wm(t,e.getBody(),n),s=He(a.getClientRects()),l=t===YR.Down;if(!s)return j.none();var u,c=l?wI:yI,d=c(e.getBody(),xI(1),a),f=ne(d,CI(1)),h=s.left,m=OI(f,h);if(m&&o(m.node)){var p=Math.abs(h-m.left),g=Math.abs(h-m.right);return PO(t,e,m.node,p<g,!1)}if(u=r(a)?a.getNode():i(a)?a.getNode(!0):od(n),u){var v=SI(t,e.getBody(),xI(1),u),b=OI(ne(v,CI(1)),h);if(b)return BI(e,b.position.toRange(),!1);if(b=He(ne(v,CI(0))),b)return BI(e,b.position.toRange(),!1)}return 0===f.length?UI(e,l).filter(l?i:r).map((function(t){return BO(e,t.toRange(),!1)})):j.none()},UI=function(e,t){var n=e.selection.getRng(),r=e.getBody();if(t){var i=Rd.fromRangeEnd(n),o=iI(r,i);return ve(o.positions)}i=Rd.fromRangeStart(n),o=rI(r,i);return ge(o.positions)},VI=function(e,t,n){return UI(e,t).filter(n).exists((function(t){return e.selection.setRng(t.toRange()),!0}))},HI=function(e,t){var n=e.dom.createRng();n.setStart(t.container(),t.offset()),n.setEnd(t.container(),t.offset()),e.selection.setRng(n)},jI=function(e,t){e?t.setAttribute("data-mce-selected","inline-boundary"):t.removeAttribute("data-mce-selected")},qI=function(e,t,n){return CR(t,n).map((function(t){return HI(e,t),n}))},GI=function(e,t,n){var r=e.getBody(),i=Rd.fromRangeStart(e.selection.getRng()),o=I(HL,e),a=jR(n,o,r,i);return a.bind((function(n){return qI(e,t,n)}))},WI=function(e,t,n){var r=Q(Ec(wn.fromDom(t.getRoot()),'*[data-mce-selected="inline-boundary"]'),(function(e){return e.dom})),i=ne(r,e),o=ne(n,e);Z(fe(i,o),I(jI,!1)),Z(fe(o,i),I(jI,!0))},KI=function(e,t){if(e.selection.isCollapsed()&&!0!==e.composing&&t.get()){var n=Rd.fromRangeStart(e.selection.getRng());Rd.isTextPosition(n)&&!1===KL(n)&&(HI(e,zh(t.get(),n)),t.set(null))}},YI=function(e,t,n,r){if(t.selection.isCollapsed()){var i=ne(r,e);Z(i,(function(r){var i=Rd.fromRangeStart(t.selection.getRng());PR(e,t.getBody(),i).bind((function(e){return qI(t,n,e)}))}))}},XI=function(e,t,n){return!!ah(e)&&GI(e,t,n).isSome()},JI=function(e,t,n){return!!ah(t)&&KR(e,t)},QI=function(e){var t=Xu(null),n=I(HL,e);return e.on("NodeChange",(function(r){!ah(e)||en.browser.isIE()&&r.initial||(WI(n,e.dom,r.parents),KI(e,t),YI(n,e,t,r.parents))})),t},ZI=I(JI,!0),eP=I(JI,!1),tP=function(e,t,n){if(ah(e)){var r=UI(e,t).getOrThunk((function(){var n=e.selection.getRng();return t?Rd.fromRangeEnd(n):Rd.fromRangeStart(n)}));return PR(I(HL,e),e.getBody(),r).exists((function(t){var r=FR(t);return CR(n,r).exists((function(t){return HI(e,t),!0}))}))}return!1},nP=function(e,t){var n=document.createRange();return n.setStart(e.container(),e.offset()),n.setEnd(t.container(),t.offset()),n},rP=function(e){return di(Jm(e),Qm(e),(function(t,n){var r=YL(!0,t),i=YL(!1,n);return Ym(e,r).forall((function(e){return e.isEqual(i)}))})).getOr(!0)},iP=function(e,t){return function(n){return CR(t,n).exists((function(t){return HI(e,t),!0}))}},oP=function(e,t,n,r){var i=e.getBody(),o=I(HL,e);e.undoManager.ignore((function(){e.selection.setRng(nP(n,r)),e.execCommand("Delete"),PR(o,i,Rd.fromRangeStart(e.selection.getRng())).map(BR).map(iP(e,t))})),e.nodeChanged()},aP=function(e,t){var n=cm(t,e);return n||e},sP=function(e,t,n,r){var i=aP(e.getBody(),r.container()),o=I(HL,e),a=PR(o,i,r);return a.bind((function(e){return n?e.fold(L(j.some(BR(e))),j.none,L(j.some(FR(e))),j.none):e.fold(j.none,L(j.some(FR(e))),j.none,L(j.some(BR(e))))})).map(iP(e,t)).getOrThunk((function(){var s=Gm(n,i,r),l=s.bind((function(e){return PR(o,i,e)}));return di(a,l,(function(){return GL(o,i,r).exists((function(t){return!!rP(t)&&(MS(e,n,wn.fromDom(t)),!0)}))})).orThunk((function(){return l.bind((function(i){return s.map((function(i){return n?oP(e,t,r,i):oP(e,t,i,r),!0}))}))})).getOr(!1)}))},lP=function(e,t,n){if(e.selection.isCollapsed()&&ah(e)){var r=Rd.fromRangeStart(e.selection.getRng());return sP(e,t,n,r)}return!1},uP=function(e,t){var n=Aw(t,e);return se(n,Jo).fold(L(n),(function(e){return n.slice(0,e)}))},cP=function(e){return 1===sr(e)},dP=function(e,t,n,r){var i=I(aT,t),o=Q(ne(r,i),(function(e){return e.dom}));if(0===o.length)MS(t,e,n);else{var a=oT(n.dom,o);t.selection.setRng(a.toRange())}},fP=function(e,t){var n=wn.fromDom(e.getBody()),r=wn.fromDom(e.selection.getStart()),i=ne(uP(n,r),cP);return ve(i).exists((function(n){var r=Rd.fromRangeStart(e.selection.getRng());return!(!rO(t,r,n.dom)||sT(n))&&(dP(t,e,n,i),!0)}))},hP=function(e,t){return!!e.selection.isCollapsed()&&fP(e,t)},mP=function(e,t,n){return e._selectionOverrides.hideFakeCaret(),MS(e,t,wn.fromDom(n)),!0},pP=function(e,t){var n=t?gw:vw,r=t?Id.Forwards:Id.Backwards,i=wm(r,e.getBody(),e.selection.getRng());return n(i)?mP(e,t,i.getNode(!t)):j.from(YL(t,i)).filter((function(e){return n(e)&&Tm(i,e)})).exists((function(n){return mP(e,t,n.getNode(!t))}))},gP=function(e,t){var n=e.selection.getNode();return!!li(n)&&mP(e,t,n)},vP=function(e,t){return e.selection.isCollapsed()?pP(e,t):gP(e,t)},bP=function(e){return Co(e,(function(e){return oi(e.dom)||ai(e.dom)})).exists((function(e){return oi(e.dom)}))},yP=function(e){var t=parseInt(e,10);return isNaN(t)?0:t},wP=function(e,t){var n=e||Qo(t)?"margin":"padding",r="rtl"===Di(t,"direction")?"-right":"-left";return n+r},SP=function(e,t,n,r,i,o){var a=wP(n,wn.fromDom(o));if("outdent"===t){var s=Math.max(0,yP(o.style[a])-r);e.setStyle(o,a,s?s+i:"")}else{s=yP(o.style[a])+r+i;e.setStyle(o,a,s)}},xP=function(e,t){return ce(t,(function(t){var n=wP(Wf(e),t),r=Ei(t,n).map(yP).getOr(0),i=e.dom.getContentEditable(t.dom);return"false"!==i&&r>0}))},CP=function(e){var t=kP(e);return!e.mode.isReadOnly()&&(t.length>1||xP(e,t))},TP=function(e){return na(e)||ra(e)},DP=function(e){return Xn(e).exists(TP)},kP=function(e){return ne(Vc(e.selection.getSelectedBlocks()),(function(e){return!TP(e)&&!DP(e)&&bP(e)}))},EP=function(e,t){var n=e.dom,r=e.selection,i=e.formatter,o=Kf(e),a=/[a-z%]+$/i.exec(o)[0],s=parseInt(o,10),l=Wf(e),u=Df(e);e.queryCommandState("InsertUnorderedList")||e.queryCommandState("InsertOrderedList")||""!==u||n.getParent(r.getNode(),n.isBlock)||i.apply("div"),Z(kP(e),(function(e){SP(n,t,l,s,a,e.dom)}))},_P=function(e,t){if(e.selection.isCollapsed()&&CP(e)){var n=e.dom,r=e.selection.getRng(),i=Rd.fromRangeStart(r),o=n.getParent(r.startContainer,n.isBlock);if(null!==o&&Pw(wn.fromDom(o),i))return EP(e,"outdent"),!0}return!1},AP=function(e,t){e.getDoc().execCommand(t,!1,null)},LP=function(e,t){_P(e)||uR(e,!1)||jO(e,!1)||lP(e,t,!1)||TO(e,!1)||Ox(e)||dR(e,!1)||vP(e,!1)||OO(e)||hP(e,!1)||(AP(e,"Delete"),nO(e))},OP=function(e,t){uR(e,!0)||jO(e,!0)||lP(e,t,!0)||TO(e,!0)||Ox(e)||dR(e,!0)||vP(e,!0)||OO(e)||hP(e,!0)||AP(e,"ForwardDelete")},RP=function(e,t){e.addCommand("delete",(function(){LP(e,t)})),e.addCommand("forwardDelete",(function(){OP(e,t)}))},IP=5,PP=400,MP=function(e){return void 0===e.touches||1!==e.touches.length?j.none():j.some(e.touches[0])},NP=function(e,t){var n=Math.abs(e.clientX-t.x),r=Math.abs(e.clientY-t.y);return n>IP||r>IP},FP=function(e){var t=fc(),n=Xu(!1),r=mc((function(t){e.fire("longpress",je(je({},t),{type:"longpress"})),n.set(!0)}),PP);e.on("touchstart",(function(e){MP(e).each((function(i){r.cancel();var o={x:i.clientX,y:i.clientY,target:e.target};r.throttle(e),n.set(!1),t.set(o)}))}),!0),e.on("touchmove",(function(i){r.cancel(),MP(i).each((function(r){t.on((function(i){NP(r,i)&&(t.clear(),n.set(!1),e.fire("longpresscancel"))}))}))}),!0),e.on("touchend touchcancel",(function(i){r.cancel(),"touchcancel"!==i.type&&t.get().filter((function(e){return e.target.isEqualNode(i.target)})).each((function(){n.get()?i.preventDefault():e.fire("tap",je(je({},i),{type:"tap"}))}))}),!0)},BP=function(e,t){return Re(e,t.nodeName)},$P=function(e,t){return!!Zr(t)||!!Hr(t)&&(!BP(e,t)&&!xp(t))},zP=function(e,t,n){return J(_w(wn.fromDom(n),wn.fromDom(t)),(function(t){return BP(e,t.dom)}))},UP=function(e,t){if(Zr(t)){if(0===t.nodeValue.length)return!0;if(/^\s+$/.test(t.nodeValue)&&(!t.nextSibling||BP(e,t.nextSibling)))return!0}return!1},VP=function(e){var t,n,r,i=e.dom,o=e.selection,a=e.schema,s=a.getBlockElements(),l=o.getStart(),u=e.getBody(),c=Df(e);if(l&&Hr(l)&&c){var d=u.nodeName.toLowerCase();if(a.isValidChild(d,c.toLowerCase())&&!zP(s,u,l)){var f=o.getRng(),h=f.startContainer,m=f.startOffset,p=f.endContainer,g=f.endOffset,v=fy(e);l=u.firstChild;while(l)if($P(s,l)){if(UP(s,l)){n=l,l=l.nextSibling,i.remove(n);continue}t||(t=i.create(c,kf(e)),l.parentNode.insertBefore(t,l),r=!0),n=l,l=l.nextSibling,t.appendChild(n)}else t=null,l=l.nextSibling;r&&v&&(f.setStart(h,m),f.setEnd(p,g),o.setRng(f),e.nodeChanged())}}},HP=function(e){Df(e)&&e.on("NodeChange",I(VP,e))},jP=function(e){return Eo(wn.fromDom(e.getBody()),"*[data-mce-caret]").map((function(e){return e.dom})).getOrNull()},qP=function(e){e.selection.setRng(e.selection.getRng())},GP=function(e,t){t.hasAttribute("data-mce-caret")&&(Aa(t),qP(e),e.selection.scrollIntoView(t))},WP=function(e,t){var n=jP(e);if(n)return"compositionstart"===t.type?(t.preventDefault(),t.stopPropagation(),void GP(e,n)):void(wa(n)&&(GP(e,n),e.undoManager.add()))},KP=function(e){e.on("keyup compositionstart",I(WP,e))},YP=ai,XP=function(e,t,n){return $I(t,e,n,ww,Sw,YP)},JP=function(e,t,n){var r=function(e){return ww(e)||bw(e)},i=function(e){return Sw(e)||yw(e)};return zI(t,e,n,r,i,YP)},QP=function(e){var t=e.dom.create(Df(e));return(!en.ie||en.ie>=11)&&(t.innerHTML='<br data-mce-bogus="1">'),t},ZP=function(e,t,n){var r=Fm(e.getBody()),i=I(Cm,1===t?r.next:r.prev);if(n.collapsed&&bh(e)){var o=e.dom.getParent(n.startContainer,"PRE");if(!o)return;var a=i(Rd.fromRangeStart(n));if(!a){var s=QP(e);1===t?e.$(o).after(s):e.$(o).before(s),e.selection.select(s,!0),e.selection.collapse()}}},eM=function(e,t){var n=t?Id.Forwards:Id.Backwards,r=e.selection.getRng();return XP(n,e,r).orThunk((function(){return ZP(e,n,r),j.none()}))},tM=function(e,t){var n=t?1:-1,r=e.selection.getRng();return JP(n,e,r).orThunk((function(){return ZP(e,n,r),j.none()}))},nM=function(e,t){return eM(e,t).exists((function(t){return FI(e,t),!0}))},rM=function(e,t){return tM(e,t).exists((function(t){return FI(e,t),!0}))},iM=function(e,t){var n=t?Sw:ww;return VI(e,t,n)},oM=function(e){return X(["figcaption"],Fn(e))},aM=function(e){var t=document.createRange();return t.setStartBefore(e.dom),t.setEndBefore(e.dom),t},sM=function(e,t,n){n?Sr(e,t):wr(e,t)},lM=function(e,t){var n=wn.fromTag("br");return sM(e,n,t),aM(n)},uM=function(e,t,n,r){var i=wn.fromTag(n),o=wn.fromTag("br");return vi(i,r),Sr(i,o),sM(e,i,t),aM(o)},cM=function(e,t,n,r){return""===t?lM(e,r):uM(e,r,t,n)},dM=function(e,t){var n=I(In,t);return Co(wn.fromDom(e.container()),Jo,n).filter(oM)},fM=function(e,t,n){return t?lI(e.dom,n):sI(e.dom,n)},hM=function(e,t){var n=wn.fromDom(e.getBody()),r=Rd.fromRangeStart(e.selection.getRng()),i=Df(e),o=kf(e);return dM(r,n).exists((function(){if(fM(n,t,r)){var a=cM(n,i,o,t);return e.selection.setRng(a),!0}return!1}))},mM=function(e,t){return!!e.selection.isCollapsed()&&hM(e,t)},pM=function(e){return Q(e,(function(e){return je({shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0,action:E},e)}))},gM=function(e,t){return t.keyCode===e.keyCode&&t.shiftKey===e.shiftKey&&t.altKey===e.altKey&&t.ctrlKey===e.ctrlKey&&t.metaKey===e.metaKey},vM=function(e,t){return ue(pM(e),(function(e){return gM(e,t)?[e]:[]}))},bM=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){return e.apply(null,t)}},yM=function(e,t){return ae(vM(e,t),(function(e){return e.action()}))},wM=function(e,t){var n=t?Id.Forwards:Id.Backwards,r=e.selection.getRng();return $I(e,n,r,gw,vw,li).exists((function(t){return FI(e,t),!0}))},SM=function(e,t){var n=t?1:-1,r=e.selection.getRng();return zI(e,n,r,gw,vw,li).exists((function(t){return FI(e,t),!0}))},xM=function(e,t){var n=t?vw:gw;return VI(e,t,n)},CM=function(e,t){return{left:e.left-t,top:e.top-t,right:e.right+2*t,bottom:e.bottom+2*t,width:e.width+t,height:e.height+t}},TM=function(e,t){return ue(t,(function(t){var n=CM(Jc(t.getBoundingClientRect()),-1);return[{x:n.left,y:e(n),cell:t},{x:n.right,y:e(n),cell:t}]}))},DM=function(e,t,n){return ie(e,(function(e,r){return e.fold((function(){return j.some(r)}),(function(e){var i=Math.sqrt(Math.abs(e.x-t)+Math.abs(e.y-n)),o=Math.sqrt(Math.abs(r.x-t)+Math.abs(r.y-n));return j.some(o<i?r:e)}))}),j.none())},kM=function(e,t,n,r,i){var o=Ec(wn.fromDom(n),"td,th,caption").map((function(e){return e.dom})),a=ne(TM(e,o),(function(e){return t(e,i)}));return DM(a,r,i).map((function(e){return e.cell}))},EM=function(e){return e.bottom},_M=function(e){return e.top},AM=function(e,t){return e.y<t},LM=function(e,t){return e.y>t},OM=I(kM,EM,AM),RM=I(kM,_M,LM),IM=function(e,t){return ge(t.getClientRects()).bind((function(t){return OM(e,t.left,t.top)})).bind((function(e){return nI(cI(e),t)}))},PM=function(e,t){return ve(t.getClientRects()).bind((function(t){return RM(e,t.left,t.top)})).bind((function(e){return nI(uI(e),t)}))},MM=function(e,t,n){return n.breakAt.exists((function(n){return e(t,n).breakAt.isSome()}))},NM=function(e){return e.breakType===qR.Wrap&&0===e.positions.length},FM=function(e){return e.breakType===qR.Br&&1===e.positions.length},BM=function(e,t,n){var r=e(t,n);return NM(r)||!ri(n.getNode())&&FM(r)?!MM(e,t,r):r.breakAt.isNone()},$M=I(BM,rI),zM=I(BM,iI),UM=function(e,t,n){var r=Rd.fromRangeStart(t);return Km(!e,n).exists((function(e){return e.isEqual(r)}))},VM=function(e,t,n,r){var i=e.selection.getRng(),o=t?1:-1;return!(!Xh()||!UM(t,i,n))&&(PO(o,e,n,!t,!1).each((function(t){FI(e,t)})),!0)},HM=function(e,t,n){return IM(t,n).orThunk((function(){return ge(n.getClientRects()).bind((function(n){return tI(oI(e,Rd.before(t)),n.left)}))})).getOr(Rd.before(t))},jM=function(e,t,n){return PM(t,n).orThunk((function(){return ge(n.getClientRects()).bind((function(n){return tI(aI(e,Rd.after(t)),n.left)}))})).getOr(Rd.after(t))},qM=function(e,t){var n=t.getNode(e);return Hr(n)&&"TABLE"===n.nodeName?j.some(n):j.none()},GM=function(e,t,n,r){var i=Df(t);i?t.undoManager.transact((function(){var r=wn.fromTag(i);vi(r,kf(t)),Sr(r,wn.fromTag("br")),e?yr(wn.fromDom(n),r):br(wn.fromDom(n),r);var o=t.dom.createRng();o.setStart(r.dom,0),o.setEnd(r.dom,0),FI(t,o)})):FI(t,r.toRange())},WM=function(e,t,n){var r=qM(!!t,n),i=!1===t;r.fold((function(){return FI(e,n.toRange())}),(function(r){return Km(i,e.getBody()).filter((function(e){return e.isEqual(n)})).fold((function(){return FI(e,n.toRange())}),(function(i){return GM(t,e,r,n)}))}))},KM=function(e,t,n,r){var i=e.selection.getRng(),o=Rd.fromRangeStart(i),a=e.getBody();if(!t&&$M(r,o)){var s=HM(a,n,o);return WM(e,t,s),!0}if(t&&zM(r,o)){s=jM(a,n,o);return WM(e,t,s),!0}return!1},YM=function(e,t,n){return j.from(e.dom.getParent(e.selection.getNode(),"td,th")).bind((function(r){return j.from(e.dom.getParent(r,"table")).map((function(i){return n(e,t,i,r)}))})).getOr(!1)},XM=function(e,t){return YM(e,t,VM)},JM=function(e,t){return YM(e,t,KM)},QM=function(e,t,n){var r=qt().os;yM([{keyCode:tv.RIGHT,action:bM(nM,e,!0)},{keyCode:tv.LEFT,action:bM(nM,e,!1)},{keyCode:tv.UP,action:bM(rM,e,!1)},{keyCode:tv.DOWN,action:bM(rM,e,!0)},{keyCode:tv.RIGHT,action:bM(XM,e,!0)},{keyCode:tv.LEFT,action:bM(XM,e,!1)},{keyCode:tv.UP,action:bM(JM,e,!1)},{keyCode:tv.DOWN,action:bM(JM,e,!0)},{keyCode:tv.RIGHT,action:bM(wM,e,!0)},{keyCode:tv.LEFT,action:bM(wM,e,!1)},{keyCode:tv.UP,action:bM(SM,e,!1)},{keyCode:tv.DOWN,action:bM(SM,e,!0)},{keyCode:tv.RIGHT,action:bM(XI,e,t,!0)},{keyCode:tv.LEFT,action:bM(XI,e,t,!1)},{keyCode:tv.RIGHT,ctrlKey:!r.isOSX(),altKey:r.isOSX(),action:bM(ZI,e,t)},{keyCode:tv.LEFT,ctrlKey:!r.isOSX(),altKey:r.isOSX(),action:bM(eP,e,t)},{keyCode:tv.UP,action:bM(mM,e,!1)},{keyCode:tv.DOWN,action:bM(mM,e,!0)}],n).each((function(e){n.preventDefault()}))},ZM=function(e,t){e.on("keydown",(function(n){!1===n.isDefaultPrevented()&&QM(e,t,n)}))},eN=function(e,t,n){yM([{keyCode:tv.BACKSPACE,action:bM(_P,e,!1)},{keyCode:tv.BACKSPACE,action:bM(uR,e,!1)},{keyCode:tv.DELETE,action:bM(uR,e,!0)},{keyCode:tv.BACKSPACE,action:bM(jO,e,!1)},{keyCode:tv.DELETE,action:bM(jO,e,!0)},{keyCode:tv.BACKSPACE,action:bM(lP,e,t,!1)},{keyCode:tv.DELETE,action:bM(lP,e,t,!0)},{keyCode:tv.BACKSPACE,action:bM(Ox,e,!1)},{keyCode:tv.DELETE,action:bM(Ox,e,!0)},{keyCode:tv.BACKSPACE,action:bM(dR,e,!1)},{keyCode:tv.DELETE,action:bM(dR,e,!0)},{keyCode:tv.BACKSPACE,action:bM(vP,e,!1)},{keyCode:tv.DELETE,action:bM(vP,e,!0)},{keyCode:tv.BACKSPACE,action:bM(OO,e,!1)},{keyCode:tv.DELETE,action:bM(OO,e,!0)},{keyCode:tv.BACKSPACE,action:bM(TO,e,!1)},{keyCode:tv.DELETE,action:bM(TO,e,!0)},{keyCode:tv.BACKSPACE,action:bM(hP,e,!1)},{keyCode:tv.DELETE,action:bM(hP,e,!0)}],n).each((function(e){n.preventDefault()}))},tN=function(e,t){yM([{keyCode:tv.BACKSPACE,action:bM(lR,e)},{keyCode:tv.DELETE,action:bM(lR,e)}],t)},nN=function(e,t){e.on("keydown",(function(n){!1===n.isDefaultPrevented()&&eN(e,t,n)})),e.on("keyup",(function(t){!1===t.isDefaultPrevented()&&tN(e,t)}))},rN=function(e){while(e){if(1===e.nodeType||3===e.nodeType&&e.data&&/[\r\n\s]/.test(e.data))return e;e=e.nextSibling}},iN=function(e,t){var n,r=t,i=e.dom,o=e.schema.getMoveCaretBeforeOnEnterElements();if(t){if(/^(LI|DT|DD)$/.test(t.nodeName)){var a=rN(t.firstChild);a&&/^(UL|OL|DL)$/.test(a.nodeName)&&t.insertBefore(i.doc.createTextNode(ua),t.firstChild)}var s=i.createRng();if(t.normalize(),t.hasChildNodes()){var l=new zo(t,t);while(n=l.current()){if(Zr(n)){s.setStart(n,0),s.setEnd(n,0);break}if(o[n.nodeName.toLowerCase()]){s.setStartBefore(n),s.setEndBefore(n);break}r=n,n=l.next()}n||(s.setStart(r,0),s.setEnd(r,0))}else ri(t)?t.nextSibling&&i.isBlock(t.nextSibling)?(s.setStartBefore(t),s.setEndBefore(t)):(s.setStartAfter(t),s.setEndAfter(t)):(s.setStart(t,0),s.setEnd(t,0));e.selection.setRng(s),nb(e,s)}},oN=function(e,t){var n,r,i=e.getRoot();n=t;while(n!==i&&"false"!==e.getContentEditable(n))"true"===e.getContentEditable(n)&&(r=n),n=n.parentNode;return n!==i?r:i},aN=function(e){return j.from(e.dom.getParent(e.selection.getStart(!0),e.dom.isBlock))},sN=function(e){return aN(e).fold(L(""),(function(e){return e.nodeName.toUpperCase()}))},lN=function(e){return aN(e).filter((function(e){return ra(wn.fromDom(e))})).isSome()},uN=function(e,t){return e.firstChild&&e.firstChild.nodeName===t},cN=function(e){var t;return(null===(t=e.parentNode)||void 0===t?void 0:t.firstChild)===e},dN=function(e,t){return e&&e.parentNode&&e.parentNode.nodeName===t},fN=function(e){return e&&/^(OL|UL|LI)$/.test(e.nodeName)},hN=function(e){return fN(e)&&fN(e.parentNode)},mN=function(e){var t=e.parentNode;return/^(LI|DT|DD)$/.test(t.nodeName)?t:e},pN=function(e,t,n){var r=e[n?"firstChild":"lastChild"];while(r){if(Hr(r))break;r=r[n?"nextSibling":"previousSibling"]}return r===t},gN=function(e,t,n,r,i){var o=e.dom,a=e.selection.getRng();if(n!==e.getBody()){hN(n)&&(i="LI");var s=i?t(i):o.create("BR");if(pN(n,r,!0)&&pN(n,r,!1))if(dN(n,"LI")){var l=mN(n);o.insertAfter(s,l),cN(n)?o.remove(l):o.remove(n)}else o.replace(s,n);else if(pN(n,r,!0))dN(n,"LI")?(o.insertAfter(s,mN(n)),s.appendChild(o.doc.createTextNode(" ")),s.appendChild(n)):n.parentNode.insertBefore(s,n),o.remove(r);else if(pN(n,r,!1))o.insertAfter(s,mN(n)),o.remove(r);else{n=mN(n);var u=a.cloneRange();u.setStartAfter(r),u.setEndAfter(n);var c=u.extractContents();"LI"===i&&uN(c,"LI")?(s=c.firstChild,o.insertAfter(c,n)):(o.insertAfter(c,n),o.insertAfter(s,n)),o.remove(r)}iN(e,s)}},vN=function(e){Z(kc(wn.fromDom(e),Vn),(function(e){var t=e.dom;t.nodeValue=ma(t.nodeValue)}))},bN=function(e,t){return t&&"A"===t.nodeName&&e.isEmpty(t)},yN=function(e){return e&&/^(TD|TH|CAPTION)$/.test(e.nodeName)},wN=function(e){e.innerHTML='<br data-mce-bogus="1">'},SN=function(e,t){return e.nodeName===t||e.previousSibling&&e.previousSibling.nodeName===t},xN=function(e,t){return t&&e.isBlock(t)&&!/^(TD|TH|CAPTION|FORM)$/.test(t.nodeName)&&!/^(fixed|absolute)/i.test(t.style.position)&&"true"!==e.getContentEditable(t)},CN=function(e,t,n){var r,i=n,o=[];if(i){while(i=i.firstChild){if(e.isBlock(i))return;Hr(i)&&!t[i.nodeName.toLowerCase()]&&o.push(i)}r=o.length;while(r--)i=o[r],(!i.hasChildNodes()||i.firstChild===i.lastChild&&""===i.firstChild.nodeValue||bN(e,i))&&e.remove(i)}},TN=function(e,t,n){return!1===Zr(t)?n:e?1===n&&t.data.charAt(n-1)===fa?0:n:n===t.data.length-1&&t.data.charAt(n)===fa?t.data.length:n},DN=function(e){var t=e.cloneRange();return t.setStart(e.startContainer,TN(!0,e.startContainer,e.startOffset)),t.setEnd(e.endContainer,TN(!1,e.endContainer,e.endOffset)),t},kN=function(e){do{Zr(e)&&(e.nodeValue=e.nodeValue.replace(/^[\r\n]+/,"")),e=e.firstChild}while(e)},EN=function(e,t){var n,r,i=e.getRoot();n=t;while(n!==i&&"false"!==e.getContentEditable(n))"true"===e.getContentEditable(n)&&(r=n),n=n.parentNode;return n!==i?r:i},_N=function(e,t,n){var r=e.dom;j.from(n.style).map(r.parseStyle).each((function(e){var n=_i(wn.fromDom(t)),i=je(je({},n),e);r.setStyles(t,i)}));var i=j.from(n.class).map((function(e){return e.split(/\s+/)})),o=j.from(t.className).map((function(e){return ne(e.split(/\s+/),(function(e){return""!==e}))}));di(i,o,(function(e,n){var i=ne(n,(function(t){return!X(e,t)})),o=Ge(Ge([],e,!0),i,!0);r.setAttrib(t,"class",o.join(" "))}));var a=["style","class"],s=_e(n,(function(e,t){return!X(a,t)}));r.setAttribs(t,s)},AN=function(e,t){var n=Df(e);if(n&&n.toLowerCase()===t.tagName.toLowerCase()){var r=kf(e);_N(e,t,r)}},LN=function(e,t,n,r,i){var o,a,s,l,u,c,d=t||"P",f=e.dom,h=EN(f,r);if(a=f.getParent(r,f.isBlock),!a||!xN(f,a)){if(a=a||h,c=a===e.getBody()||yN(a)?a.nodeName.toLowerCase():a.parentNode.nodeName.toLowerCase(),!a.hasChildNodes())return o=f.create(d),AN(e,o),a.appendChild(o),n.setStart(o,0),n.setEnd(o,0),o;l=r;while(l.parentNode!==a)l=l.parentNode;while(l&&!f.isBlock(l))s=l,l=l.previousSibling;if(s&&e.schema.isValidChild(c,d.toLowerCase())){o=f.create(d),AN(e,o),s.parentNode.insertBefore(o,s),l=s;while(l&&!f.isBlock(l))u=l.nextSibling,o.appendChild(l),l=u;n.setStart(r,i),n.setEnd(r,i)}}return r},ON=function(e,t){t.normalize();var n=t.lastChild;n&&!/^(left|right)$/gi.test(e.getStyle(n,"float",!0))||e.add(t,"br")},RN=function(e,t){var n,r,i,o,a,s,l,u,c,d,f=e.dom,h=e.schema,m=h.getNonEmptyElements(),p=e.selection.getRng(),g=function(t){var n,i,a,s=r,l=h.getTextInlineElements();if(n=t||"TABLE"===u||"HR"===u?f.create(t||c):o.cloneNode(!1),a=n,!1===Af(e))f.setAttrib(n,"style",null),f.setAttrib(n,"class",null);else do{if(l[s.nodeName]){if(ep(s)||xp(s))continue;i=s.cloneNode(!1),f.setAttrib(i,"id",""),n.hasChildNodes()?(i.appendChild(n.firstChild),n.appendChild(i)):(a=i,n.appendChild(i))}}while((s=s.parentNode)&&s!==S);return AN(e,n),wN(a),n},v=function(e){var t,n,a=TN(e,r,i);if(Zr(r)&&(e?a>0:a<r.nodeValue.length))return!1;if(r.parentNode===o&&d&&!e)return!0;if(e&&Hr(r)&&r===o.firstChild)return!0;if(SN(r,"TABLE")||SN(r,"HR"))return d&&!e||!d&&e;var s=new zo(r,o);Zr(r)&&(e&&0===a?s.prev():e||a!==r.nodeValue.length||s.next());while(t=s.current()){if(Hr(t)){if(!t.getAttribute("data-mce-bogus")&&(n=t.nodeName.toLowerCase(),m[n]&&"br"!==n))return!1}else if(Zr(t)&&!Wa(t.nodeValue))return!1;e?s.prev():s.next()}return!0},b=function(){a=/^(H[1-6]|PRE|FIGURE)$/.test(u)&&"HGROUP"!==x?g(c):g(),Lf(e)&&xN(f,l)&&f.isEmpty(o)?a=f.split(l,o):f.insertAfter(a,o),iN(e,a)};Sv(f,p).each((function(e){p.setStart(e.startContainer,e.startOffset),p.setEnd(e.endContainer,e.endOffset)})),r=p.startContainer,i=p.startOffset,c=Df(e);var y=!(!t||!t.shiftKey),w=!(!t||!t.ctrlKey);Hr(r)&&r.hasChildNodes()&&(d=i>r.childNodes.length-1,r=r.childNodes[Math.min(i,r.childNodes.length-1)]||r,i=d&&Zr(r)?r.nodeValue.length:0);var S=EN(f,r);if(S){(c&&!y||!c&&y)&&(r=LN(e,c,p,r,i)),o=f.getParent(r,f.isBlock),l=o?f.getParent(o.parentNode,f.isBlock):null,u=o?o.nodeName.toUpperCase():"";var x=l?l.nodeName.toUpperCase():"";"LI"!==x||w||(o=l,l=l.parentNode,u=x),/^(LI|DT|DD)$/.test(u)&&f.isEmpty(o)?gN(e,g,l,o,c):c&&o===e.getBody()||(c=c||"P",va(o)?(a=Aa(o),f.isEmpty(o)&&wN(o),AN(e,a),iN(e,a)):v()?b():v(!0)?(a=o.parentNode.insertBefore(g(),o),iN(e,SN(o,"HR")?a:o)):(n=DN(p).cloneRange(),n.setEndAfter(o),s=n.extractContents(),vN(s),kN(s),a=s.firstChild,f.insertAfter(s,o),CN(f,m,a),ON(f,o),f.isEmpty(o)&&wN(o),a.normalize(),f.isEmpty(a)?(f.remove(a),b()):(AN(e,a),iN(e,a))),f.setAttrib(a,"id",""),e.fire("NewBlock",{newBlock:a}))}},IN=function(e,t,n){var r,i=new zo(t,n),o=e.getNonEmptyElements();while(r=i.next())if(o[r.nodeName.toLowerCase()]||r.length>0)return!0},PN=function(e,t,n){var r=e.dom.createRng();n?(r.setStartBefore(t),r.setEndBefore(t)):(r.setStartAfter(t),r.setEndAfter(t)),e.selection.setRng(r),nb(e,r)},MN=function(e,t){var n,r,i=e.selection,o=e.dom,a=i.getRng();Sv(o,a).each((function(e){a.setStart(e.startContainer,e.startOffset),a.setEnd(e.endContainer,e.endOffset)}));var s=a.startOffset,l=a.startContainer;if(1===l.nodeType&&l.hasChildNodes()){var u=s>l.childNodes.length-1;l=l.childNodes[Math.min(s,l.childNodes.length-1)]||l,s=u&&3===l.nodeType?l.nodeValue.length:0}var c=o.getParent(l,o.isBlock),d=c?o.getParent(c.parentNode,o.isBlock):null,f=d?d.nodeName.toUpperCase():"",h=!(!t||!t.ctrlKey);"LI"!==f||h||(c=d),l&&3===l.nodeType&&s>=l.nodeValue.length&&(IN(e.schema,l,c)||(n=o.create("br"),a.insertNode(n),a.setStartAfter(n),a.setEndAfter(n),r=!0)),n=o.create("br"),Fd(o,a,n),PN(e,n,r),e.undoManager.add()},NN=function(e,t){var n=wn.fromTag("br");br(wn.fromDom(t),n),e.undoManager.add()},FN=function(e,t){$N(e.getBody(),t)||yr(wn.fromDom(t),wn.fromTag("br"));var n=wn.fromTag("br");yr(wn.fromDom(t),n),PN(e,n.dom,!1),e.undoManager.add()},BN=function(e){return ri(e.getNode())},$N=function(e,t){return!!BN(Rd.after(t))||Ym(e,Rd.after(t)).map((function(e){return ri(e.getNode())})).getOr(!1)},zN=function(e){return e&&"A"===e.nodeName&&"href"in e},UN=function(e){return e.fold(B,zN,zN,B)},VN=function(e){var t=I(HL,e),n=Rd.fromRangeStart(e.selection.getRng());return PR(t,e.getBody(),n).filter(UN)},HN=function(e,t){t.fold(E,I(NN,e),I(FN,e),E)},jN=function(e,t){var n=VN(e);n.isSome()?n.each(I(HN,e)):MN(e,t)},qN=function(e,t){return aN(e).filter((function(e){return t.length>0&&An(wn.fromDom(e),t)})).isSome()},GN=function(e){return qN(e,Ef(e))},WN=function(e){return qN(e,_f(e))},KN=Zi.generate([{br:[]},{block:[]},{none:[]}]),YN=function(e,t){return WN(e)},XN=function(e){return function(t,n){var r=""===Df(t);return r===e}},JN=function(e){return function(t,n){return lN(t)===e}},QN=function(e,t){return function(n,r){var i=sN(n)===e.toUpperCase();return i===t}},ZN=function(e){return QN("pre",e)},eF=function(){return QN("summary",!0)},tF=function(e){return function(t,n){return Tf(t)===e}},nF=function(e,t){return GN(e)},rF=function(e,t){return t},iF=function(e){var t=Df(e),n=oN(e.dom,e.selection.getStart());return n&&e.schema.isValidChild(n.nodeName,t||"P")},oF=function(e,t){return function(n,r){var i=ie(e,(function(e,t){return e&&t(n,r)}),!0);return i?j.some(t):j.none()}},aF=function(e,t){return TR([oF([YN],KN.none()),oF([eF()],KN.br()),oF([ZN(!0),tF(!1),rF],KN.br()),oF([ZN(!0),tF(!1)],KN.block()),oF([ZN(!0),tF(!0),rF],KN.block()),oF([ZN(!0),tF(!0)],KN.br()),oF([JN(!0),rF],KN.br()),oF([JN(!0)],KN.block()),oF([XN(!0),rF,iF],KN.block()),oF([XN(!0)],KN.br()),oF([nF],KN.br()),oF([XN(!1),rF],KN.br()),oF([iF],KN.block())],[e,!(!t||!t.shiftKey)]).getOr(KN.none())},sF=function(e,t){aF(e,t).fold((function(){jN(e,t)}),(function(){RN(e,t)}),E)},lF=function(e,t){t.isDefaultPrevented()||(t.preventDefault(),gk(e.undoManager),e.undoManager.transact((function(){!1===e.selection.isCollapsed()&&e.execCommand("Delete"),sF(e,t)})))},uF=function(e){e.on("keydown",(function(t){t.keyCode===tv.ENTER&&lF(e,t)}))},cF=function(e,t,n){yM([{keyCode:tv.END,action:bM(iM,e,!0)},{keyCode:tv.HOME,action:bM(iM,e,!1)},{keyCode:tv.END,action:bM(xM,e,!0)},{keyCode:tv.HOME,action:bM(xM,e,!1)},{keyCode:tv.END,action:bM(tP,e,!0,t)},{keyCode:tv.HOME,action:bM(tP,e,!1,t)}],n).each((function(e){n.preventDefault()}))},dF=function(e,t){e.on("keydown",(function(n){!1===n.isDefaultPrevented()&&cF(e,t,n)}))},fF=qt().browser,hF=function(e){var t=hc((function(){e.composing||dS(e)}),0);fF.isIE()&&(e.on("keypress",(function(e){t.throttle()})),e.on("remove",(function(e){t.cancel()})))},mF=function(e){hF(e),e.on("input",(function(t){!1===t.isComposing&&dS(e)}))},pF=qt(),gF=function(e,t,n){yM([{keyCode:tv.PAGE_UP,action:bM(tP,e,!1,t)},{keyCode:tv.PAGE_DOWN,action:bM(tP,e,!0,t)}],n)},vF=function(e){return e.stopImmediatePropagation()},bF=function(e){return e.keyCode===tv.PAGE_UP||e.keyCode===tv.PAGE_DOWN},yF=function(e,t,n){n&&!e.get()?t.on("NodeChange",vF,!0):!n&&e.get()&&t.off("NodeChange",vF),e.set(n)},wF=function(e,t){if(!pF.os.isOSX()){var n=Xu(!1);e.on("keydown",(function(t){bF(t)&&yF(n,e,!0)})),e.on("keyup",(function(r){!1===r.isDefaultPrevented()&&gF(e,t,r),bF(r)&&n.get()&&(yF(n,e,!1),e.nodeChanged())}))}},SF=function(e,t){var n=t.container(),r=t.offset();return Zr(n)?(n.insertData(r,e),j.some(Rd(n,r+e.length))):Sm(t).map((function(n){var r=wn.fromText(e);return t.isAtEnd()?yr(n,r):br(n,r),Rd(r.dom,e.length)}))},xF=I(SF,ua),CF=I(SF," "),TF=function(e){return function(t){return t.fold((function(t){return Xm(e.dom,Rd.before(t))}),(function(e){return Jm(e)}),(function(e){return Qm(e)}),(function(t){return Ym(e.dom,Rd.after(t))}))}},DF=function(e,t){return function(n){return Zw(e,n)?xF(t):CF(t)}},kF=function(e){return function(t){return e.selection.setRng(t.toRange()),e.nodeChanged(),!0}},EF=function(e){var t=Rd.fromRangeStart(e.selection.getRng()),n=wn.fromDom(e.getBody());if(e.selection.isCollapsed()){var r=I(HL,e),i=Rd.fromRangeStart(e.selection.getRng());return PR(r,e.getBody(),i).bind(TF(n)).bind(DF(n,t)).exists(kF(e))}return!1},_F=function(e,t){yM([{keyCode:tv.SPACEBAR,action:bM(EF,e)}],t).each((function(e){t.preventDefault()}))},AF=function(e){e.on("keydown",(function(t){!1===t.isDefaultPrevented()&&_F(e,t)}))},LF=function(e){var t=QI(e);return KP(e),ZM(e,t),nN(e,t),uF(e),AF(e),mF(e),dF(e,t),wF(e,t),t},OF=function(e){return Rk(e)?Xu(null):LF(e)},RF=function(){function e(e){var t;this.lastPath=[],this.editor=e;var n=this;"onselectionchange"in e.getDoc()||e.on("NodeChange click mouseup keyup focus",(function(n){var r=e.selection.getRng(),i={startContainer:r.startContainer,startOffset:r.startOffset,endContainer:r.endContainer,endOffset:r.endOffset};"nodechange"!==n.type&&uv(i,t)||e.fire("SelectionChange"),t=i})),e.on("contextmenu",(function(){e.fire("SelectionChange")})),e.on("SelectionChange",(function(){var t=e.selection.getStart(!0);!t||!en.range&&e.selection.isCollapsed()||Dg(e)&&!n.isSameElementPath(t)&&e.dom.isChildOf(t,e.getBody())&&e.nodeChanged({selectionChange:!0})})),e.on("mouseup",(function(t){!t.isDefaultPrevented()&&Dg(e)&&("IMG"===e.selection.getNode().nodeName?No.setEditorTimeout(e,(function(){e.nodeChanged()})):e.nodeChanged())}))}return e.prototype.nodeChanged=function(e){var t,n,r,i=this.editor.selection;this.editor.initialized&&i&&!wh(this.editor)&&!this.editor.mode.isReadOnly()&&(r=this.editor.getBody(),t=i.getStart(!0)||r,t.ownerDocument===this.editor.getDoc()&&this.editor.dom.isChildOf(t,r)||(t=r),n=[],this.editor.dom.getParent(t,(function(e){if(e===r)return!0;n.push(e)})),e=e||{},e.element=t,e.parents=n,this.editor.fire("NodeChange",e))},e.prototype.isSameElementPath=function(e){var t,n=this.editor.$(e).parentsUntil(this.editor.getBody()).add(e);if(n.length===this.lastPath.length){for(t=n.length;t>=0;t--)if(n[t]!==this.lastPath[t])break;if(-1===t)return this.lastPath=n,!0}return this.lastPath=n,!1},e}(),IF=function(e){e.on("click",(function(t){e.dom.getParent(t.target,"details")&&t.preventDefault()}))},PF=function(e){e.parser.addNodeFilter("details",(function(e){Z(e,(function(e){e.attr("data-mce-open",e.attr("open")),e.attr("open","open")}))})),e.serializer.addNodeFilter("details",(function(e){Z(e,(function(e){var t=e.attr("data-mce-open");e.attr("open",v(t)?t:null),e.attr("data-mce-open",null)}))}))},MF=function(e){IF(e),PF(e)},NF=function(e){return Hr(e)&&ta(wn.fromDom(e))},FF=function(e){var t=e.selection.getRng(),n=Rd.fromRangeStart(t),r=Rd.fromRangeEnd(t);if(Rd.isElementPosition(n)){var i=n.container();NF(i)&&Jm(i).each((function(e){return t.setStart(e.container(),e.offset())}))}if(Rd.isElementPosition(r)){i=n.container();NF(i)&&Qm(i).each((function(e){return t.setEnd(e.container(),e.offset())}))}e.selection.setRng(Px(t))},BF=function(e){e.on("click",(function(t){t.detail>=3&&FF(e)}))},$F=function(e){var t=e.getBoundingClientRect(),n=e.ownerDocument,r=n.documentElement,i=n.defaultView;return{top:t.top+i.pageYOffset-r.clientTop,left:t.left+i.pageXOffset-r.clientLeft}},zF=function(e){return e.inline?$F(e.getBody()):{left:0,top:0}},UF=function(e){var t=e.getBody();return e.inline?{left:t.scrollLeft,top:t.scrollTop}:{left:0,top:0}},VF=function(e){var t=e.getBody(),n=e.getDoc().documentElement,r={left:t.scrollLeft,top:t.scrollTop},i={left:t.scrollLeft||n.scrollLeft,top:t.scrollTop||n.scrollTop};return e.inline?r:i},HF=function(e,t){if(t.target.ownerDocument!==e.getDoc()){var n=$F(e.getContentAreaContainer()),r=VF(e);return{left:t.pageX-n.left+r.left,top:t.pageY-n.top+r.top}}return{left:t.pageX,top:t.pageY}},jF=function(e,t,n){return{pageX:n.left-e.left+t.left,pageY:n.top-e.top+t.top}},qF=function(e,t){return jF(zF(e),UF(e),HF(e,t))},GF=ai,WF=oi,KF=function(e,t){return GF(t)&&t!==e},YF=function(e,t,n){return t!==n&&!e.dom.isChildOf(t,n)&&!GF(t)},XF=function(e){var t=e.cloneNode(!0);return t.removeAttribute("data-mce-selected"),t},JF=function(e,t,n,r){var i=e.dom,o=t.cloneNode(!0);i.setStyles(o,{width:n,height:r}),i.setAttrib(o,"data-mce-selected",null);var a=i.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return i.setStyles(a,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:n,height:r}),i.setStyles(o,{margin:0,boxSizing:"border-box"}),a.appendChild(o),a},QF=function(e,t){e.parentNode!==t&&t.appendChild(e)},ZF=function(e,t,n,r,i,o){var a=0,s=0;e.style.left=t.pageX+"px",e.style.top=t.pageY+"px",t.pageX+n>i&&(a=t.pageX+n-i),t.pageY+r>o&&(s=t.pageY+r-o),e.style.width=n-a+"px",e.style.height=r-s+"px"},eB=function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},tB=function(e){return 0===e.button},nB=function(e,t){return{pageX:t.pageX-e.relX,pageY:t.pageY+5}},rB=function(e,t){return function(n){if(tB(n)){var r=ae(t.dom.getParents(n.target),cd(GF,WF)).getOr(null);if(KF(t.getBody(),r)){var i=t.dom.getPos(r),o=t.getBody(),a=t.getDoc().documentElement;e.set({element:r,dragging:!1,screenX:n.screenX,screenY:n.screenY,maxX:(t.inline?o.scrollWidth:a.offsetWidth)-2,maxY:(t.inline?o.scrollHeight:a.offsetHeight)-2,relX:n.pageX-i.x,relY:n.pageY-i.y,width:r.offsetWidth,height:r.offsetHeight,ghost:JF(t,r,r.offsetWidth,r.offsetHeight)})}}}},iB=function(e,t){var n=No.throttle((function(e,n){t._selectionOverrides.hideFakeCaret(),t.selection.placeCaretAt(e,n)}),0);return t.on("remove",n.stop),function(r){return e.on((function(e){var i=Math.max(Math.abs(r.screenX-e.screenX),Math.abs(r.screenY-e.screenY));if(!e.dragging&&i>10){var o=t.fire("dragstart",{target:e.element});if(o.isDefaultPrevented())return;e.dragging=!0,t.focus()}if(e.dragging){var a=nB(e,qF(t,r));QF(e.ghost,t.getBody()),ZF(e.ghost,a,e.width,e.height,e.maxX,e.maxY),n(r.clientX,r.clientY)}}))}},oB=function(e){var t=e.getSel().getRangeAt(0),n=t.startContainer;return 3===n.nodeType?n.parentNode:n},aB=function(e,t){return function(n){e.on((function(e){if(e.dragging){if(YF(t,oB(t.selection),e.element)){var r=XF(e.element),i=t.fire("drop",{clientX:n.clientX,clientY:n.clientY});i.isDefaultPrevented()||t.undoManager.transact((function(){eB(e.element),t.insertContent(t.dom.getOuterHTML(r)),t._selectionOverrides.hideFakeCaret()}))}t.fire("dragend")}})),lB(e)}},sB=function(e,t){return function(){e.on((function(e){e.dragging&&t.fire("dragend")})),lB(e)}},lB=function(e){e.on((function(e){eB(e.ghost)})),e.clear()},uB=function(e){var t=fc(),n=Uu.DOM,r=document,i=rB(t,e),o=iB(t,e),a=aB(t,e),s=sB(t,e);e.on("mousedown",i),e.on("mousemove",o),e.on("mouseup",a),n.bind(r,"mousemove",o),n.bind(r,"mouseup",s),e.on("remove",(function(){n.unbind(r,"mousemove",o),n.unbind(r,"mouseup",s)})),e.on("keydown",(function(e){e.keyCode===tv.ESC&&s()}))},cB=function(e){e.on("drop",(function(t){var n="undefined"!==typeof t.clientX?e.getDoc().elementFromPoint(t.clientX,t.clientY):null;(GF(n)||"false"===e.dom.getContentEditableParent(n))&&t.preventDefault()}))},dB=function(e){var t=function(t){if(!t.isDefaultPrevented()){var n=t.dataTransfer;n&&(X(n.types,"Files")||n.files.length>0)&&(t.preventDefault(),"drop"===t.type&&KA(e,"Dropped file type is not supported"))}},n=function(n){Qb(e,n.target)&&t(n)},r=function(){var r=Uu.DOM,i=e.dom,o=document,a=e.inline?e.getBody():e.getDoc(),s=["drop","dragover"];Z(s,(function(e){r.bind(o,e,n),i.bind(a,e,t)})),e.on("remove",(function(){Z(s,(function(e){r.unbind(o,e,n),i.unbind(a,e,t)}))}))};e.on("init",(function(){No.setEditorTimeout(e,r,0)}))},fB=function(e){uB(e),cB(e),Dh(e)&&dB(e)},hB=function(e){var t=hc((function(){if(!e.removed&&e.getBody().contains(document.activeElement)){var t=e.selection.getRng();if(t.collapsed){var n=BO(e,t,!1);e.selection.setRng(n)}}}),0);e.on("focus",(function(){t.throttle()})),e.on("blur",(function(){t.cancel()}))},mB=function(e){e.on("init",(function(){e.on("focusin",(function(t){var n=t.target;if(li(n)){var r=$g(e.getBody(),n),i=ai(r)?r:n;e.selection.getNode()!==i&&NO(e,i).each((function(t){return e.selection.setRng(t)}))}}))}))},pB=oi,gB=ai,vB=function(e,t){return $g(e.getBody(),t)},bB=function(e){var t,n=e.selection,r=e.dom,i=r.isBlock,o=e.getBody(),a=Yh(e,o,i,(function(){return fy(e)})),s="sel-"+r.uniqueId(),l="data-mce-selected",u=function(e){return r.hasClass(e,"mce-offscreen-selection")},c=function(e){return e!==o&&(gB(e)||li(e))&&r.isChildOf(e,o)},d=function(e){return ww(e)||Sw(e)||gw(e)||vw(e)},f=function(){var e=r.get(s);return e?e.getElementsByTagName("*")[0]:e},h=function(e){e&&n.setRng(e)},m=n.getRng,p=function(t,r,i,o){void 0===o&&(o=!0);var s=e.fire("ShowCaret",{target:r,direction:t,before:i});return s.isDefaultPrevented()?null:(o&&n.scrollIntoView(r,-1===t),a.show(i,r))},g=function(e){e.hasAttribute("data-mce-caret")&&(Aa(e),h(m()),n.scrollIntoView(e))},v=function(){e.on("mouseup",(function(t){var n=m();n.collapsed&&BA(e,t.clientX,t.clientY)&&FO(e,n,!1).each(h)})),e.on("click",(function(t){var i=vB(e,t.target);i&&(gB(i)&&(t.preventDefault(),e.focus()),pB(i)&&r.isChildOf(i,n.getNode())&&D())})),e.on("blur NewBlock",D),e.on("ResizeWindow FullscreenStateChanged",a.reposition);var s=function(e){var t=e.firstChild;if(C(t))return!1;var n=Rd.before(t);if(ri(n.getNode())&&1===e.childNodes.length)return!d(n);var r=Fm(e),i=r.next(n);return i&&!d(i)},l=function(e,t){var n=r.getParent(e,i),o=r.getParent(t,i);return n===o},g=function(t,n){var o=r.getParent(t,i),a=r.getParent(n,i);return!C(o)&&(!(t===a||!r.isChildOf(o,a)||!1!==gB(vB(e,o)))||!r.isChildOf(a,o)&&!l(o,a)&&s(o))};e.on("tap",(function(t){var n=t.target,r=vB(e,n);gB(r)?(t.preventDefault(),NO(e,r).each(T)):c(n)&&NO(e,n).each(T)}),!0),e.on("mousedown",(function(t){var i=t.target;if((i===o||"HTML"===i.nodeName||r.isChildOf(i,o))&&!1!==BA(e,t.clientX,t.clientY)){var a=vB(e,i);if(a)gB(a)?(t.preventDefault(),NO(e,a).each(T)):(D(),pB(a)&&t.shiftKey||zg(t.clientX,t.clientY,n.getRng())||(E(),n.placeCaretAt(t.clientX,t.clientY)));else if(c(i))NO(e,i).each(T);else if(!1===Qh(i)){D(),E();var s=NI(o,t.clientX,t.clientY);if(s&&!g(i,s.node)){t.preventDefault();var l=p(1,s.node,s.before,!1);h(l),e.getBody().focus()}}}})),e.on("keypress",(function(e){tv.modifierPressed(e)||gB(n.getNode())&&e.preventDefault()})),e.on("GetSelectionRange",(function(e){var n=e.range;if(t){if(!t.parentNode)return void(t=null);n=n.cloneRange(),n.selectNode(t),e.range=n}})),e.on("SetSelectionRange",(function(e){e.range=w(e.range);var t=T(e.range,e.forward);t&&(e.range=t)}));var v=function(e){return"mcepastebin"===e.id};e.on("AfterSetSelectionRange",(function(e){var t=e.range,n=t.startContainer.parentNode;y(t)||v(n)||E(),u(n)||D()})),e.on("copy",(function(e){var t=e.clipboardData;if(!e.isDefaultPrevented()&&e.clipboardData&&!en.ie){var n=f();n&&(e.preventDefault(),t.clearData(),t.setData("text/html",n.outerHTML),t.setData("text/plain",n.outerText||n.innerText))}})),fB(e),hB(e),mB(e)},b=function(e){return ya(e)||ka(e)||Ea(e)},y=function(e){return b(e.startContainer)||b(e.endContainer)},w=function(t){var n=e.schema.getShortEndedElements(),i=r.createRng(),o=t.startContainer,a=t.startOffset,s=t.endContainer,l=t.endOffset;return Re(n,o.nodeName.toLowerCase())?0===a?i.setStartBefore(o):i.setStartAfter(o):i.setStart(o,a),Re(n,s.nodeName.toLowerCase())?0===l?i.setEndBefore(s):i.setEndAfter(s):i.setEnd(s,l),i},S=function(t,i,o){var a=e.$,l=Eo(wn.fromDom(e.getBody()),"#"+s).fold((function(){return a([])}),(function(e){return a([e.dom])}));0===l.length&&(l=a('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>').attr("id",s),l.appendTo(e.getBody()));var u=r.createRng();i===o&&en.ie?(l.empty().append('<p style="font-size: 0" data-mce-bogus="all"> </p>').append(i),u.setStartAfter(l[0].firstChild.firstChild),u.setEndAfter(i)):(l.empty().append(ua).append(i).append(ua),u.setStart(l[0].firstChild,1),u.setEnd(l[0].lastChild,0)),l.css({top:r.getPos(t,e.getBody()).y}),l[0].focus();var c=n.getSel();return c.removeAllRanges(),c.addRange(u),u},x=function(n){var i=n.cloneNode(!0),o=e.fire("ObjectSelected",{target:n,targetClone:i});if(o.isDefaultPrevented())return null;var a=S(n,o.targetClone,i),s=wn.fromDom(n);return Z(Ec(wn.fromDom(e.getBody()),"*[data-mce-selected]"),(function(e){In(s,e)||Si(e,l)})),r.getAttrib(n,l)||n.setAttribute(l,"1"),t=n,E(),a},T=function(e,t){if(!e)return null;if(e.collapsed){if(!y(e)){var n=t?1:-1,i=wm(n,o,e),a=i.getNode(!t);if(Qh(a))return p(n,a,!!t&&!i.isAtEnd(),!1);var s=i.getNode(t);if(Qh(s))return p(n,s,!t&&!i.isAtEnd(),!1)}return null}var l=e.startContainer,u=e.startOffset,d=e.endOffset;if(3===l.nodeType&&0===u&&gB(l.parentNode)&&(l=l.parentNode,u=r.nodeIndex(l),l=l.parentNode),1!==l.nodeType)return null;if(d===u+1&&l===e.endContainer){var f=l.childNodes[u];if(c(f))return x(f)}return null},D=function(){t&&t.removeAttribute(l),Eo(wn.fromDom(e.getBody()),"#"+s).each(kr),t=null},k=function(){a.destroy(),t=null},E=function(){a.hide()};return en.ceFalse&&!Rk(e)&&v(),{showCaret:p,showBlockCaretContainer:g,hideFakeCaret:E,destroy:k}},yB=function(e){var t=mn.each,n=tv.BACKSPACE,r=tv.DELETE,i=e.dom,o=e.selection,a=e.parser,s=en.gecko,l=en.ie,u=en.webkit,c="data:text/mce-internal,",d=l?"Text":"URL",f=function(t,n){try{e.getDoc().execCommand(t,!1,n)}catch(r){}},h=function(e){return e.isDefaultPrevented()},m=function(t){var n,r;t.dataTransfer&&(e.selection.isCollapsed()&&"IMG"===t.target.tagName&&o.select(t.target),n=e.selection.getContent(),n.length>0&&(r=c+escape(e.id)+","+escape(n),t.dataTransfer.setData(d,r)))},p=function(e){var t;return e.dataTransfer&&(t=e.dataTransfer.getData(d),t&&t.indexOf(c)>=0)?(t=t.substr(c.length).split(","),{id:unescape(t[0]),html:unescape(t[1])}):null},g=function(t,n){e.queryCommandSupported("mceInsertClipboardContent")?e.execCommand("mceInsertClipboardContent",!1,{content:t,internal:n}):e.execCommand("mceInsertContent",!1,t)},v=function(){var t=function(e){var t=i.create("body"),n=e.cloneContents();return t.appendChild(n),o.serializer.serialize(t,{format:"html"})},a=function(n){var r=t(n),o=i.createRng();o.selectNode(e.getBody());var a=t(o);return r===a};e.on("keydown",(function(t){var o,s,l=t.keyCode;if(!h(t)&&(l===r||l===n)){if(o=e.selection.isCollapsed(),s=e.getBody(),o&&!i.isEmpty(s))return;if(!o&&!a(e.selection.getRng()))return;t.preventDefault(),e.setContent(""),s.firstChild&&i.isBlock(s.firstChild)?e.selection.setCursorLocation(s.firstChild,0):e.selection.setCursorLocation(s,0),e.nodeChanged()}}))},b=function(){e.shortcuts.add("meta+a",null,"SelectAll")},y=function(){e.inline||i.bind(e.getDoc(),"mousedown mouseup",(function(t){var n;if(t.target===e.getDoc().documentElement)if(n=o.getRng(),e.getBody().focus(),"mousedown"===t.type){if(ya(n.startContainer))return;o.placeCaretAt(t.clientX,t.clientY)}else o.setRng(n)}))},w=function(){e.on("keydown",(function(t){if(!h(t)&&t.keyCode===n){if(!e.getBody().getElementsByTagName("hr").length)return;if(o.isCollapsed()&&0===o.getRng().startOffset){var r=o.getNode(),a=r.previousSibling;if("HR"===r.nodeName)return i.remove(r),void t.preventDefault();a&&a.nodeName&&"hr"===a.nodeName.toLowerCase()&&(i.remove(a),t.preventDefault())}}}))},S=function(){Range.prototype.getClientRects||e.on("mousedown",(function(t){if(!h(t)&&"HTML"===t.target.nodeName){var n=e.getBody();n.blur(),No.setEditorTimeout(e,(function(){n.focus()}))}}))},x=function(){e.on("click",(function(t){var n=t.target;/^(IMG|HR)$/.test(n.nodeName)&&"false"!==i.getContentEditableParent(n)&&(t.preventDefault(),e.selection.select(n),e.nodeChanged()),"A"===n.nodeName&&i.hasClass(n,"mce-item-anchor")&&(t.preventDefault(),o.select(n))}))},C=function(){var n=function(){var n=i.getAttribs(o.getStart().cloneNode(!1));return function(){var r=o.getStart();r!==e.getBody()&&(i.setAttrib(r,"style",null),t(n,(function(e){r.setAttributeNode(e.cloneNode(!0))})))}},r=function(){return!o.isCollapsed()&&i.getParent(o.getStart(),i.isBlock)!==i.getParent(o.getEnd(),i.isBlock)};e.on("keypress",(function(t){var i;if(!h(t)&&(8===t.keyCode||46===t.keyCode)&&r())return i=n(),e.getDoc().execCommand("delete",!1,null),i(),t.preventDefault(),!1})),i.bind(e.getDoc(),"cut",(function(t){var i;!h(t)&&r()&&(i=n(),No.setEditorTimeout(e,(function(){i()})))}))},T=function(){e.on("keydown",(function(e){if(!h(e)&&e.keyCode===n&&o.isCollapsed()&&0===o.getRng().startOffset){var t=o.getNode().previousSibling;if(t&&t.nodeName&&"table"===t.nodeName.toLowerCase())return e.preventDefault(),!1}}))},D=function(){e.on("keydown",(function(t){var n,r;if(!h(t)&&t.keyCode===tv.BACKSPACE){n=o.getRng();var a=n.startContainer,s=n.startOffset,l=i.getRoot();if(r=a,n.collapsed&&0===s){while(r&&r.parentNode&&r.parentNode.firstChild===r&&r.parentNode!==l)r=r.parentNode;"BLOCKQUOTE"===r.tagName&&(e.formatter.toggle("blockquote",null,r),n=i.createRng(),n.setStart(a,0),n.setEnd(a,0),o.setRng(n))}}}))},k=function(){var t=function(){f("StyleWithCSS",!1),f("enableInlineTableEditing",!1),Zf(e)||f("enableObjectResizing",!1)};Sh(e)||e.on("BeforeExecCommand mousedown",t)},_=function(){var n=function(){t(i.select("a"),(function(e){var t=e.parentNode,n=i.getRoot();if(t.lastChild===e){while(t&&!i.isBlock(t)){if(t.parentNode.lastChild!==t||t===n)return;t=t.parentNode}i.add(t,"br",{"data-mce-bogus":1})}}))};e.on("SetContent ExecCommand",(function(e){"setcontent"!==e.type&&"mceInsertLink"!==e.command||n()}))},A=function(){Df(e)&&e.on("init",(function(){f("DefaultParagraphSeparator",Df(e))}))},L=function(){e.on("keyup focusin mouseup",(function(e){tv.modifierPressed(e)||o.normalize()}),!0)},O=function(){e.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")},R=function(){e.inline||e.on("keydown",(function(){document.activeElement===document.body&&e.getWin().focus()}))},I=function(){e.inline||(e.contentStyles.push("body {min-height: 150px}"),e.on("click",(function(t){var n;if("HTML"===t.target.nodeName){if(en.ie>11)return void e.getBody().focus();n=e.selection.getRng(),e.getBody().focus(),e.selection.setRng(n),e.selection.normalize(),e.nodeChanged()}})))},P=function(){en.mac&&e.on("keydown",(function(t){if(tv.metaKeyPressed(t)&&!t.shiftKey&&(37===t.keyCode||39===t.keyCode)){t.preventDefault();var n=e.selection.getSel();n.modify("move",37===t.keyCode?"backward":"forward","lineboundary")}}))},M=function(){f("AutoUrlDetect",!1)},N=function(){e.on("click",(function(e){var t=e.target;do{if("A"===t.tagName)return void e.preventDefault()}while(t=t.parentNode)})),e.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")},F=function(){e.on("init",(function(){e.dom.bind(e.getBody(),"submit",(function(e){e.preventDefault()}))}))},B=function(){a.addNodeFilter("br",(function(e){var t=e.length;while(t--)"Apple-interchange-newline"===e[t].attr("class")&&e[t].remove()}))},$=function(){e.on("dragstart",(function(e){m(e)})),e.on("drop",(function(t){if(!h(t)){var n=p(t);if(n&&n.id!==e.id){t.preventDefault();var r=lv(t.x,t.y,e.getDoc());o.setRng(r),g(n.html,!0)}}}))},z=E,U=function(){if(!s||e.removed)return!1;var t=e.selection.getSel();return!t||!t.rangeCount||0===t.rangeCount},V=function(){u&&(y(),x(),F(),b(),en.iOS&&(R(),I(),N())),s&&(S(),k(),O(),P())},H=function(){D(),v(),en.windowsPhone||L(),u&&(y(),x(),A(),F(),T(),B(),en.iOS?(R(),I(),N()):b()),en.ie>=11&&(I(),T()),en.ie&&(b(),M(),$()),s&&(w(),S(),C(),k(),_(),O(),P(),T())};return Rk(e)?V():H(),{refreshContentEditable:z,isHidden:U}},wB=Uu.DOM,SB=function(e,t){var n=wn.fromDom(e.getBody()),r=hr(fr(n)),i=wn.fromTag("style");gi(i,"type","text/css"),Sr(i,wn.fromText(t)),Sr(r,i),e.on("remove",(function(){kr(i)}))},xB=function(e){return e.inline?e.getElement().nodeName.toLowerCase():void 0},CB=function(e){return _e(e,(function(e){return!1===x(e)}))},TB=function(e){var t=e.settings;return CB({block_elements:t.block_elements,boolean_attributes:t.boolean_attributes,custom_elements:t.custom_elements,extended_valid_elements:t.extended_valid_elements,invalid_elements:t.invalid_elements,invalid_styles:t.invalid_styles,move_caret_before_on_enter_elements:t.move_caret_before_on_enter_elements,non_empty_elements:t.non_empty_elements,schema:t.schema,self_closing_elements:t.self_closing_elements,short_ended_elements:t.short_ended_elements,special:t.special,text_block_elements:t.text_block_elements,text_inline_elements:t.text_inline_elements,valid_children:t.valid_children,valid_classes:t.valid_classes,valid_elements:t.valid_elements,valid_styles:t.valid_styles,verify_html:t.verify_html,whitespace_elements:t.whitespace_elements,padd_empty_block_inline_children:t.format_empty_lines})},DB=function(e){var t=e.settings,n=e.editorUpload.blobCache;return CB({allow_conditional_comments:t.allow_conditional_comments,allow_html_data_urls:t.allow_html_data_urls,allow_svg_data_urls:t.allow_svg_data_urls,allow_html_in_named_anchor:t.allow_html_in_named_anchor,allow_script_urls:t.allow_script_urls,allow_unsafe_link_target:t.allow_unsafe_link_target,convert_fonts_to_spans:t.convert_fonts_to_spans,fix_list_elements:t.fix_list_elements,font_size_legacy_values:t.font_size_legacy_values,forced_root_block:t.forced_root_block,forced_root_block_attrs:t.forced_root_block_attrs,padd_empty_with_br:t.padd_empty_with_br,preserve_cdata:t.preserve_cdata,remove_trailing_brs:t.remove_trailing_brs,inline_styles:t.inline_styles,root_name:xB(e),validate:!0,blob_cache:n,document:e.getDoc(),images_dataimg_filter:t.images_dataimg_filter})},kB=function(e){var t=e.settings;return je(je(je({},DB(e)),TB(e)),CB({url_converter:t.url_converter,url_converter_scope:t.url_converter_scope,element_format:t.element_format,entities:t.entities,entity_encoding:t.entity_encoding,indent:t.indent,indent_after:t.indent_after,indent_before:t.indent_before}))},EB=function(e){var t=w_(DB(e),e.schema);return t.addAttributeFilter("src,href,style,tabindex",(function(t,n){var r,i,o=t.length,a=e.dom,s="data-mce-"+n;while(o--)if(r=t[o],i=r.attr(n),i&&!r.attr(s)){if(0===i.indexOf("data:")||0===i.indexOf("blob:"))continue;"style"===n?(i=a.serializeStyle(a.parseStyle(i),r.name),i.length||(i=null),r.attr(s,i),r.attr(n,i)):"tabindex"===n?(r.attr(s,i),r.attr(n,null)):r.attr(s,e.convertURL(i,n,r.name))}})),t.addNodeFilter("script",(function(e){var t=e.length;while(t--){var n=e[t],r=n.attr("type")||"no/type";0!==r.indexOf("mce-")&&n.attr("type","mce-"+r)}})),e.settings.preserve_cdata&&t.addNodeFilter("#cdata",(function(t){var n=t.length;while(n--){var r=t[n];r.type=8,r.name="#comment",r.value="[CDATA["+e.dom.encode(r.value)+"]]"}})),t.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",(function(t){var n=t.length,r=e.schema.getNonEmptyElements();while(n--){var i=t[n];i.isEmpty(r)&&0===i.getAll("br").length&&(i.append(new Ay("br",1)).shortEnded=!0)}})),t},_B=function(e){e.settings.auto_focus&&No.setEditorTimeout(e,(function(){var t;t=!0===e.settings.auto_focus?e:e.editorManager.get(e.settings.auto_focus),t.destroyed||t.focus()}),100)},AB=function(e){var t=e.dom.getRoot();e.inline||Dg(e)&&e.selection.getStart(!0)!==t||Jm(t).each((function(t){var n=t.getNode(),r=Xr(n)?Jm(n).getOr(t):t;en.browser.isIE()?Bb(e,r.toRange()):e.selection.setRng(r.toRange())}))},LB=function(e){e.bindPendingEventDelegates(),e.initialized=!0,Xg(e),e.focus(!0),AB(e),e.nodeChanged({initial:!0}),e.execCallback("init_instance_callback",e),_B(e)},OB=function(e){return e.inline?e.ui.styleSheetLoader:e.dom.styleSheetLoader},RB=function(e,t,n){var r=[new Ao((function(n,r){return OB(e).loadAll(t,n,r)}))];return e.inline?r:r.concat([new Ao((function(t,r){return e.ui.styleSheetLoader.loadAll(n,t,r)}))])},IB=function(e){var t=OB(e),n=Xf(e),r=e.contentCSS,i=function(){t.unloadAll(r),e.inline||e.ui.styleSheetLoader.unloadAll(n)},o=function(){e.removed?i():e.on("remove",i)};if(e.contentStyles.length>0){var a="";mn.each(e.contentStyles,(function(e){a+=e+"\r\n"})),e.dom.addStyle(a)}var s=Ao.all(RB(e,r,n)).then(o).catch(o);return e.settings.content_style&&SB(e,e.settings.content_style),s},PB=function(e){var t=e.settings,n=e.getDoc(),r=e.getBody();Kg(e),t.browser_spellcheck||t.gecko_spellcheck||(n.body.spellcheck=!1,wB.setAttrib(r,"spellcheck","false")),e.quirks=yB(e),Yg(e);var i=Jf(e);void 0!==i&&(r.dir=i),t.protect&&e.on("BeforeSetContent",(function(e){mn.each(t.protect,(function(t){e.content=e.content.replace(t,(function(e){return"\x3c!--mce:protected "+escape(e)+"--\x3e"}))}))})),e.on("SetContent",(function(){e.addVisual(e.getBody())})),e.on("compositionstart compositionend",(function(t){e.composing="compositionstart"===t.type}))},MB=function(e){Rk(e)||e.load({initial:!0,format:"html"}),e.startContent=e.getContent({format:"raw"})},NB=function(e){!0!==e.removed&&(MB(e),LB(e))},FB=function(e,t){var n=e.settings,r=e.getElement(),i=e.getDoc();n.inline||(e.getElement().style.visibility=e.orgVisibility),t||e.inline||(i.open(),i.write(e.iframeHTML),i.close()),e.inline&&(wB.addClass(r,"mce-content-body"),e.contentDocument=i=document,e.contentWindow=window,e.bodyElement=r,e.contentAreaContainer=r);var o=e.getBody();o.disabled=!0,e.readonly=!!n.readonly,e.readonly||(e.inline&&"static"===wB.getStyle(o,"position",!0)&&(o.style.position="relative"),o.contentEditable=e.getParam("content_editable_state",!0)),o.disabled=!1,e.editorUpload=bL(e),e.schema=Us(TB(e)),e.dom=Uu(i,{keep_values:!0,url_converter:e.convertURL,url_converter_scope:e,hex_colors:n.force_hex_style_colors,update_styles:!0,root_element:e.inline?e.getBody():null,collect:function(){return e.inline},schema:e.schema,contentCssCors:Hf(e),referrerPolicy:jf(e),onSetAttrib:function(t){e.fire("SetAttrib",t)}}),e.parser=EB(e),e.serializer=I_(kB(e),e),e.selection=CE(e.dom,e.getWin(),e.serializer,e),e.annotator=Fg(e),e.formatter=_L(e),e.undoManager=RL(e),e._nodeChangeDispatcher=new RF(e),e._selectionOverrides=bB(e),FP(e),MF(e),Rk(e)||BF(e);var a=OF(e);RP(e,a),HP(e),zL(e);var s=Pk(e);PB(e),s.fold((function(){IB(e).then((function(){return NB(e)}))}),(function(t){e.setProgressState(!0),IB(e).then((function(){t().then((function(t){e.setProgressState(!1),NB(e)}),(function(t){e.notificationManager.open({type:"error",text:String(t)}),NB(e)}))}))}))},BB=Uu.DOM,$B=function(e,t){if(document.domain!==window.location.hostname&&en.browser.isIE()){var n=dL("mce");e[n]=function(){FB(e)};var r='javascript:(function(){document.open();document.domain="'+document.domain+'";var ed = window.parent.tinymce.get("'+e.id+'");document.write(ed.iframeHTML);document.close();ed.'+n+"(true);})()";return BB.setAttrib(t,"src",r),!0}return!1},zB=function(e,t,n,r){var i=wn.fromTag("iframe");return vi(i,r),vi(i,{id:e+"_ifr",frameBorder:"0",allowTransparency:"true",title:t}),xc(i,"tox-edit-area__iframe"),i},UB=function(e){var t=yf(e)+"<html><head>";wf(e)!==e.documentBaseUrl&&(t+='<base href="'+e.documentBaseURI.getURI()+'" />'),t+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';var n=Sf(e),r=xf(e),i=e.translate(Ah(e));return Cf(e)&&(t+='<meta http-equiv="Content-Security-Policy" content="'+Cf(e)+'" />'),t+='</head><body id="'+n+'" class="mce-content-body '+r+'" data-id="'+e.id+'" aria-label="'+i+'"><br></body></html>',t},VB=function(e,t){var n=e.translate("Rich Text Area"),r=zB(e.id,n,t.height,bf(e)).dom;r.onload=function(){r.onload=null,e.fire("load")};var i=$B(e,r);return e.contentAreaContainer=t.iframeContainer,e.iframeElement=r,e.iframeHTML=UB(e),BB.add(t.iframeContainer,r),i},HB=function(e,t){var n=VB(e,t);t.editorContainer&&(BB.get(t.editorContainer).style.display=e.orgDisplay,e.hidden=BB.isHidden(t.editorContainer)),e.getElement().style.display="none",BB.setAttrib(e.id,"aria-hidden","true"),n||FB(e)},jB=Uu.DOM,qB=function(e,t,n){var r=HA.get(n),i=HA.urls[n]||e.documentBaseUrl.replace(/\/$/,"");if(n=mn.trim(n),r&&-1===mn.inArray(t,n)){if(mn.each(HA.dependencies(n),(function(n){qB(e,t,n)})),e.plugins[n])return;try{var o=new r(e,i,e.$);e.plugins[n]=o,o.init&&(o.init(e,i),t.push(n))}catch(LU){tL(e,n,LU)}}},GB=function(e){return e.replace(/^\-/,"")},WB=function(e){var t=[];mn.each(Ch(e).split(/[ ,]/),(function(n){qB(e,t,GB(n))}))},KB=function(e){var t=mn.trim(Ff(e)),n=e.ui.registry.getAll().icons,r=je(je({},_A.get("default").icons),_A.get(t).icons);xe(r,(function(t,r){Re(n,r)||e.ui.registry.addIcon(r,t)}))},YB=function(e){var t=ih(e);if(v(t)){e.settings.theme=GB(t);var n=jA.get(t);e.theme=new n(e,jA.urls[t]),e.theme.init&&e.theme.init(e,jA.urls[t]||e.documentBaseUrl.replace(/\/$/,""),e.$)}else e.theme={}},XB=function(e){return e.theme.renderUI()},JB=function(e){var t=e.getElement(),n=ih(e),r=n(e,t);return r.editorContainer.nodeType&&(r.editorContainer.id=r.editorContainer.id||e.id+"_parent"),r.iframeContainer&&r.iframeContainer.nodeType&&(r.iframeContainer.id=r.iframeContainer.id||e.id+"_iframecontainer"),r.height=r.iframeHeight?r.iframeHeight:t.offsetHeight,r},QB=function(e){return{editorContainer:e,iframeContainer:e,api:{}}},ZB=function(e){var t=jB.create("div");return jB.insertAfter(t,e),QB(t)},e$=function(e){var t=e.getElement();return e.inline?QB(null):ZB(t)},t$=function(e){var t=e.getElement();return e.orgDisplay=t.style.display,v(ih(e))?XB(e):D(ih(e))?JB(e):e$(e)},n$=function(e,t){var n={show:j.from(t.show).getOr(E),hide:j.from(t.hide).getOr(E),disable:j.from(t.disable).getOr(E),isDisabled:j.from(t.isDisabled).getOr(B),enable:function(){e.mode.isReadOnly()||j.from(t.enable).map(F)}};e.ui=je(je({},e.ui),n)},r$=function(e){e.fire("ScriptsLoaded"),KB(e),YB(e),WB(e);var t=t$(e);n$(e,j.from(t.api).getOr({}));var n={editorContainer:t.editorContainer,iframeContainer:t.iframeContainer};return e.editorContainer=n.editorContainer?n.editorContainer:null,sL(e),e.inline?FB(e):HB(e,n)},i$=Uu.DOM,o$=function(e){return"-"===e.charAt(0)},a$=function(e,t){var n=qf(t),r=Gf(t);if(!1===uc.hasCode(n)&&"en"!==n){var i=""!==r?r:t.editorManager.baseURL+"/langs/"+n+".js";e.add(i,E,void 0,(function(){eL(t,i,n)}))}},s$=function(e,t,n,r){var i=ih(t);if(v(i)){if(!o$(i)&&!Re(jA.urls,i)){var o=dh(t);o?jA.load(i,t.documentBaseURI.toAbsolute(o)):jA.load(i,"themes/"+i+"/theme"+n+".js")}e.loadQueue((function(){jA.waitFor(i,r)}))}else r()},l$=function(e){return j.from(Bf(e)).filter((function(e){return e.length>0})).map((function(e){return{url:e,name:j.none()}}))},u$=function(e,t,n){return j.from(t).filter((function(e){return e.length>0&&!_A.has(e)})).map((function(t){return{url:e.editorManager.baseURL+"/icons/"+t+"/icons"+n+".js",name:j.some(t)}}))},c$=function(e,t,n){var r=u$(t,"default",n),i=l$(t).orThunk((function(){return u$(t,Ff(t),"")}));Z(ci([r,i]),(function(n){e.add(n.url,E,void 0,(function(){ZA(t,n.url,n.name.getOrUndefined())}))}))},d$=function(e,t){mn.each(Th(e),(function(t,n){HA.load(n,t,E,void 0,(function(){QA(e,t,n)})),e.settings.plugins+=" "+n})),mn.each(Ch(e).split(/[ ,]/),(function(n){if(n=mn.trim(n),n&&!HA.urls[n])if(o$(n)){n=n.substr(1,n.length);var r=HA.dependencies(n);mn.each(r,(function(n){var r={prefix:"plugins/",resource:n,suffix:"/plugin"+t+".js"},i=HA.createUrl(r,n);HA.load(i.resource,i,E,void 0,(function(){QA(e,i.prefix+i.resource+i.suffix,i.resource)}))}))}else{var i={prefix:"plugins/",resource:n,suffix:"/plugin"+t+".js"};HA.load(n,i,E,void 0,(function(){QA(e,i.prefix+i.resource+i.suffix,n)}))}}))},f$=function(e,t){var n=Yu.ScriptLoader;s$(n,e,t,(function(){a$(n,e),c$(n,e,t),d$(e,t),n.loadQueue((function(){e.removed||r$(e)}),e,(function(){e.removed||r$(e)}))}))},h$=function(e,t){return $o.forElement(e,{contentCssCors:xh(t),referrerPolicy:jf(t)})},m$=function(e){var t=e.id;uc.setCode(qf(e));var n=function(){i$.unbind(window,"ready",n),e.render()};if(rl.Event.domLoaded){if(e.getElement()&&en.contentEditable){var r=wn.fromDom(e.getElement()),i=xi(r);e.on("remove",(function(){ee(r.dom.attributes,(function(e){return Si(r,e.name)})),vi(r,i)})),e.ui.styleSheetLoader=h$(r,e),fh(e)?e.inline=!0:(e.orgVisibility=e.getElement().style.visibility,e.getElement().style.visibility="hidden");var o=e.getElement().form||i$.getParent(t,"form");o&&(e.formElement=o,hh(e)&&!Qr(e.getElement())&&(i$.insertAfter(i$.create("input",{type:"hidden",name:t}),t),e.hasHiddenInput=!0),e.formEventDelegate=function(t){e.fire(t.type,t)},i$.bind(o,"submit reset",e.formEventDelegate),e.on("reset",(function(){e.resetContent()})),!mh(e)||o.submit.nodeType||o.submit.length||o._mceOldSubmit||(o._mceOldSubmit=o.submit,o.submit=function(){return e.editorManager.triggerSave(),e.setDirty(!1),o._mceOldSubmit(o)})),e.windowManager=GA(e),e.notificationManager=VA(e),ph(e)&&e.on("GetContent",(function(e){e.save&&(e.content=i$.encode(e.content))})),gh(e)&&e.on("submit",(function(){e.initialized&&e.save()})),vh(e)&&(e._beforeUnload=function(){!e.initialized||e.destroyed||e.isHidden()||e.save({format:"raw",no_events:!0,set_dirty:!1})},e.editorManager.on("BeforeUnload",e._beforeUnload)),e.editorManager.add(e),f$(e,e.suffix)}}else i$.bind(window,"ready",n)},p$=function(e,t){return sE(e,t)},g$={"font-size":"size","font-family":"face"},v$=function(e,t,n){var r=function(t){return Ei(t,e).orThunk((function(){return"font"===Fn(t)?Oe(g$,e).bind((function(e){return yi(t,e)})):j.none()}))},i=function(e){return In(wn.fromDom(t),e)};return AC(wn.fromDom(n),(function(e){return r(e)}),i)},b$=function(e){return e.replace(/[\'\"\\]/g,"").replace(/,\s+/g,",")},y$=function(e,t){return j.from(Uu.DOM.getStyle(t,e,!0))},w$=function(e){return function(t,n){return j.from(n).map(wn.fromDom).filter(Un).bind((function(n){return v$(e,t,n.dom).or(y$(e,n.dom))})).getOr("")}},S$=w$("font-size"),x$=_(b$,w$("font-family")),C$=function(e){return Jm(e.getBody()).map((function(e){var t=e.container();return Zr(t)?t.parentNode:t}))},T$=function(e){return j.from(e.selection.getRng()).bind((function(t){var n=e.getBody(),r=t.startContainer===n&&0===t.startOffset;return r?j.none():j.from(e.selection.getStart(!0))}))},D$=function(e,t){return T$(e).orThunk(I(C$,e)).map(wn.fromDom).filter(Un).bind(t)},k$=function(e,t){return D$(e,A(j.some,t))},E$=function(e,t){if(/^[0-9.]+$/.test(t)){var n=parseInt(t,10);if(n>=1&&n<=7){var r=Of(e),i=Rf(e);return i?i[n-1]||t:r[n-1]||t}return t}return t},_$=function(e){var t=e.split(/\s*,\s*/);return Q(t,(function(e){return-1===e.indexOf(" ")||ut(e,'"')||ut(e,"'")?e:"'"+e+"'"})).join(",")},A$=function(e,t){var n=E$(e,t);e.formatter.toggle("fontname",{value:_$(n)}),e.nodeChanged()},L$=function(e){return k$(e,(function(t){return x$(e.getBody(),t.dom)})).getOr("")},O$=function(e,t){e.formatter.toggle("fontsize",{value:E$(e,t)}),e.nodeChanged()},R$=function(e){return k$(e,(function(t){return S$(e.getBody(),t.dom)})).getOr("")},I$=function(e){return k$(e,(function(t){var n=wn.fromDom(e.getBody()),r=AC(t,(function(e){return Ei(e,"line-height")}),I(In,n)),i=function(){var e=parseFloat(Di(t,"line-height")),n=parseFloat(Di(t,"font-size"));return String(e/n)};return r.getOrThunk(i)})).getOr("")},P$=function(e,t){e.formatter.toggle("lineheight",{value:String(t)}),e.nodeChanged()},M$=function(e){if("string"!==typeof e){var t=mn.extend({paste:e.paste,data:{paste:e.paste}},e);return{content:e.content,details:t}}return{content:e,details:{}}},N$=function(e,t){var n=M$(t);oE(e,n.content,n.details)},F$=mn.each,B$=mn.map,$$=mn.inArray,z$=function(){function e(e){this.commands={state:{},exec:{},value:{}},this.editor=e,this.setupCommands(e)}return e.prototype.execCommand=function(e,t,n,r){var i,o=!1,a=this;if(!a.editor.removed){if("mcefocus"!==e.toLowerCase()&&(/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(e)||r&&r.skip_focus?zb(a.editor):a.editor.focus()),r=a.editor.fire("BeforeExecCommand",{command:e,ui:t,value:n}),r.isDefaultPrevented())return!1;var s=e.toLowerCase();if(i=a.commands.exec[s])return i(s,t,n),a.editor.fire("ExecCommand",{command:e,ui:t,value:n}),!0;if(F$(this.editor.plugins,(function(r){if(r.execCommand&&r.execCommand(e,t,n))return a.editor.fire("ExecCommand",{command:e,ui:t,value:n}),o=!0,!1})),o)return o;if(a.editor.theme&&a.editor.theme.execCommand&&a.editor.theme.execCommand(e,t,n))return a.editor.fire("ExecCommand",{command:e,ui:t,value:n}),!0;try{o=a.editor.getDoc().execCommand(e,t,n)}catch(l){}return!!o&&(a.editor.fire("ExecCommand",{command:e,ui:t,value:n}),!0)}},e.prototype.queryCommandState=function(e){var t;if(!this.editor.quirks.isHidden()&&!this.editor.removed){if(e=e.toLowerCase(),t=this.commands.state[e])return t(e);try{return this.editor.getDoc().queryCommandState(e)}catch(n){}return!1}},e.prototype.queryCommandValue=function(e){var t;if(!this.editor.quirks.isHidden()&&!this.editor.removed){if(e=e.toLowerCase(),t=this.commands.value[e])return t(e);try{return this.editor.getDoc().queryCommandValue(e)}catch(n){}}},e.prototype.addCommands=function(e,t){void 0===t&&(t="exec");var n=this;F$(e,(function(e,r){F$(r.toLowerCase().split(","),(function(r){n.commands[t][r]=e}))}))},e.prototype.addCommand=function(e,t,n){var r=this;e=e.toLowerCase(),this.commands.exec[e]=function(e,i,o,a){return t.call(n||r.editor,i,o,a)}},e.prototype.queryCommandSupported=function(e){if(e=e.toLowerCase(),this.commands.exec[e])return!0;try{return this.editor.getDoc().queryCommandSupported(e)}catch(t){}return!1},e.prototype.addQueryStateHandler=function(e,t,n){var r=this;e=e.toLowerCase(),this.commands.state[e]=function(){return t.call(n||r.editor)}},e.prototype.addQueryValueHandler=function(e,t,n){var r=this;e=e.toLowerCase(),this.commands.value[e]=function(){return t.call(n||r.editor)}},e.prototype.hasCustomCommand=function(e){return e=e.toLowerCase(),!!this.commands.exec[e]},e.prototype.execNativeCommand=function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=null),this.editor.getDoc().execCommand(e,t,n)},e.prototype.isFormatMatch=function(e){return this.editor.formatter.match(e)},e.prototype.toggleFormat=function(e,t){this.editor.formatter.toggle(e,t),this.editor.nodeChanged()},e.prototype.storeSelection=function(e){this.selectionBookmark=this.editor.selection.getBookmark(e)},e.prototype.restoreSelection=function(){this.editor.selection.moveToBookmark(this.selectionBookmark)},e.prototype.setupCommands=function(e){var t=this;this.addCommands({"mceResetDesignMode,mceBeginUndoLevel":E,"mceEndUndoLevel,mceAddUndoLevel":function(){e.undoManager.add()},mceFocus:function(t,n,r){gy(e,r)},"Cut,Copy,Paste":function(n){var r,i=e.getDoc();try{t.execNativeCommand(n)}catch(a){r=!0}if("paste"!==n||i.queryCommandEnabled(n)||(r=!0),r||!i.queryCommandSupported(n)){var o=e.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");en.mac&&(o=o.replace(/Ctrl\+/g,"⌘+")),e.notificationManager.open({text:o,type:"error"})}},unlink:function(){if(e.selection.isCollapsed()){var t=e.dom.getParent(e.selection.getStart(),"a");t&&e.dom.remove(t,!0)}else e.formatter.remove("link")},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone":function(n){var r=n.substring(7);"full"===r&&(r="justify"),F$("left,center,right,justify".split(","),(function(t){r!==t&&e.formatter.remove("align"+t)})),"none"!==r&&t.toggleFormat("align"+r)},"InsertUnorderedList,InsertOrderedList":function(n){var r;t.execNativeCommand(n);var i=e.dom.getParent(e.selection.getNode(),"ol,ul");i&&(r=i.parentNode,/^(H[1-6]|P|ADDRESS|PRE)$/.test(r.nodeName)&&(t.storeSelection(),e.dom.split(r,i),t.restoreSelection()))},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(e){t.toggleFormat(e)},"ForeColor,HiliteColor":function(e,n,r){t.toggleFormat(e,{value:r})},FontName:function(t,n,r){A$(e,r)},FontSize:function(t,n,r){O$(e,r)},LineHeight:function(t,n,r){P$(e,r)},Lang:function(e,n,r){t.toggleFormat(e,{value:r.code,customValue:r.customCode})},RemoveFormat:function(t){e.formatter.remove(t)},mceBlockQuote:function(){t.toggleFormat("blockquote")},FormatBlock:function(e,n,r){return t.toggleFormat(r||"p")},mceCleanup:function(){var t=e.selection.getBookmark();e.setContent(e.getContent()),e.selection.moveToBookmark(t)},mceRemoveNode:function(n,r,i){var o=i||e.selection.getNode();o!==e.getBody()&&(t.storeSelection(),e.dom.remove(o,!0),t.restoreSelection())},mceSelectNodeDepth:function(t,n,r){var i=0;e.dom.getParent(e.selection.getNode(),(function(t){if(1===t.nodeType&&i++===r)return e.selection.select(t),!1}),e.getBody())},mceSelectNode:function(t,n,r){e.selection.select(r)},mceInsertContent:function(t,n,r){N$(e,r)},mceInsertRawHTML:function(t,n,r){e.selection.setContent("tiny_mce_marker");var i=e.getContent();e.setContent(i.replace(/tiny_mce_marker/g,(function(){return r})))},mceInsertNewLine:function(t,n,r){sF(e,r)},mceToggleFormat:function(e,n,r){t.toggleFormat(r)},mceSetContent:function(t,n,r){e.setContent(r)},"Indent,Outdent":function(t){EP(e,t)},mceRepaint:E,InsertHorizontalRule:function(){e.execCommand("mceInsertContent",!1,"<hr />")},mceToggleVisualAid:function(){e.hasVisual=!e.hasVisual,e.addVisual()},mceReplaceContent:function(t,n,r){e.execCommand("mceInsertContent",!1,r.replace(/\{\$selection\}/g,e.selection.getContent({format:"text"})))},mceInsertLink:function(t,n,r){"string"===typeof r&&(r={href:r});var i=e.dom.getParent(e.selection.getNode(),"a");r.href=r.href.replace(/ /g,"%20"),i&&r.href||e.formatter.remove("link"),r.href&&e.formatter.apply("link",r,i)},selectAll:function(){var t=e.dom.getParent(e.selection.getStart(),oi);if(t){var n=e.dom.createRng();n.selectNodeContents(t),e.selection.setRng(n)}},mceNewDocument:function(){e.setContent("")},InsertLineBreak:function(t,n,r){return jN(e,r),!0}});var n=function(t){return function(){var n=e.selection,r=n.isCollapsed()?[e.dom.getParent(n.getNode(),e.dom.isBlock)]:n.getSelectedBlocks(),i=B$(r,(function(n){return!!e.formatter.matchNode(n,t)}));return-1!==$$(i,!0)}};t.addCommands({JustifyLeft:n("alignleft"),JustifyCenter:n("aligncenter"),JustifyRight:n("alignright"),JustifyFull:n("alignjustify"),"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(e){return t.isFormatMatch(e)},mceBlockQuote:function(){return t.isFormatMatch("blockquote")},Outdent:function(){return CP(e)},"InsertUnorderedList,InsertOrderedList":function(t){var n=e.dom.getParent(e.selection.getNode(),"ul,ol");return n&&("insertunorderedlist"===t&&"UL"===n.tagName||"insertorderedlist"===t&&"OL"===n.tagName)}},"state"),t.addCommands({Undo:function(){e.undoManager.undo()},Redo:function(){e.undoManager.redo()}}),t.addQueryValueHandler("FontName",(function(){return L$(e)}),this),t.addQueryValueHandler("FontSize",(function(){return R$(e)}),this),t.addQueryValueHandler("LineHeight",(function(){return I$(e)}),this)},e}(),U$="data-mce-contenteditable",V$=function(e,t,n){Dc(e,t)&&!1===n?Tc(e,t):n&&xc(e,t)},H$=function(e,t,n){try{e.getDoc().execCommand(t,!1,String(n))}catch(r){}},j$=function(e,t){e.dom.contentEditable=t?"true":"false"},q$=function(e){Z(Ec(e,'*[contenteditable="true"]'),(function(e){gi(e,U$,"true"),j$(e,!1)}))},G$=function(e){Z(Ec(e,"*["+U$+'="true"]'),(function(e){Si(e,U$),j$(e,!0)}))},W$=function(e){j.from(e.selection.getNode()).each((function(e){e.removeAttribute("data-mce-selected")}))},K$=function(e){e.selection.setRng(e.selection.getRng())},Y$=function(e,t){var n=wn.fromDom(e.getBody());V$(n,"mce-content-readonly",t),t?(e.selection.controlSelection.hideResizeRect(),e._selectionOverrides.hideFakeCaret(),W$(e),e.readonly=!0,j$(n,!1),q$(n)):(e.readonly=!1,j$(n,!0),G$(n),H$(e,"StyleWithCSS",!1),H$(e,"enableInlineTableEditing",!1),H$(e,"enableObjectResizing",!1),hy(e)&&e.focus(),K$(e),e.nodeChanged())},X$=function(e){return e.readonly},J$=function(e){e.parser.addAttributeFilter("contenteditable",(function(t){X$(e)&&Z(t,(function(e){e.attr(U$,e.attr("contenteditable")),e.attr("contenteditable","false")}))})),e.serializer.addAttributeFilter(U$,(function(t){X$(e)&&Z(t,(function(e){e.attr("contenteditable",e.attr(U$))}))})),e.serializer.addTempAttr(U$)},Q$=function(e){e.serializer?J$(e):e.on("PreInit",(function(){J$(e)}))},Z$=function(e){return"click"===e.type},ez=function(e,t){var n=function(t){return In(t,wn.fromDom(e.getBody()))};return _o(t,"a",n).bind((function(e){return yi(e,"href")}))},tz=function(e,t){if(Z$(t)&&!tv.metaKeyPressed(t)){var n=wn.fromDom(t.target);ez(e,n).each((function(n){if(t.preventDefault(),/^#/.test(n)){var r=e.dom.select(n+',[name="'+st(n,"#")+'"]');r.length&&e.selection.scrollIntoView(r[0],!0)}else window.open(n,"_blank","rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes")}))}},nz=function(e){e.on("ShowCaret",(function(t){X$(e)&&t.preventDefault()})),e.on("ObjectSelected",(function(t){X$(e)&&t.preventDefault()}))},rz=mn.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel"," "),iz=function(){function e(e){this.bindings={},this.settings=e||{},this.scope=this.settings.scope||this,this.toggleEvent=this.settings.toggleEvent||B}return e.isNative=function(e){return!!rz[e.toLowerCase()]},e.prototype.fire=function(e,t){var n=e.toLowerCase(),r=Ys(n,t||{},this.scope);this.settings.beforeFire&&this.settings.beforeFire(r);var i=this.bindings[n];if(i)for(var o=0,a=i.length;o<a;o++){var s=i[o];if(!s.removed){if(s.once&&this.off(n,s.func),r.isImmediatePropagationStopped())return r;if(!1===s.func.call(this.scope,r))return r.preventDefault(),r}}return r},e.prototype.on=function(e,t,n,r){if(!1===t&&(t=B),t){var i={func:t,removed:!1};r&&mn.extend(i,r);var o=e.toLowerCase().split(" "),a=o.length;while(a--){var s=o[a],l=this.bindings[s];l||(l=[],this.toggleEvent(s,!0)),l=n?Ge([i],l,!0):Ge(Ge([],l,!0),[i],!1),this.bindings[s]=l}}return this},e.prototype.off=function(e,t){var n=this;if(e){var r=e.toLowerCase().split(" "),i=r.length;while(i--){var o=r[i],a=this.bindings[o];if(!o)return xe(this.bindings,(function(e,t){n.toggleEvent(t,!1),delete n.bindings[t]})),this;if(a){if(t){var s=te(a,(function(e){return e.func===t}));a=s.fail,this.bindings[o]=a,Z(s.pass,(function(e){e.removed=!0}))}else a.length=0;a.length||(this.toggleEvent(e,!1),delete this.bindings[o])}}}else xe(this.bindings,(function(e,t){n.toggleEvent(t,!1)})),this.bindings={};return this},e.prototype.once=function(e,t,n){return this.on(e,t,n,{once:!0})},e.prototype.has=function(e){return e=e.toLowerCase(),!(!this.bindings[e]||0===this.bindings[e].length)},e}(),oz=function(e){return e._eventDispatcher||(e._eventDispatcher=new iz({scope:e,toggleEvent:function(t,n){iz.isNative(t)&&e.toggleNativeEvent&&e.toggleNativeEvent(t,n)}})),e._eventDispatcher},az={fire:function(e,t,n){var r=this;if(r.removed&&"remove"!==e&&"detach"!==e)return t;var i=oz(r).fire(e,t);if(!1!==n&&r.parent){var o=r.parent();while(o&&!i.isPropagationStopped())o.fire(e,i,!1),o=o.parent()}return i},on:function(e,t,n){return oz(this).on(e,t,n)},off:function(e,t){return oz(this).off(e,t)},once:function(e,t){return oz(this).once(e,t)},hasEventListeners:function(e){return oz(this).has(e)}},sz=Uu.DOM,lz=function(e,t){if("selectionchange"===t)return e.getDoc();if(!e.inline&&/^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(t))return e.getDoc().documentElement;var n=nh(e);return n?(e.eventRoot||(e.eventRoot=sz.select(n)[0]),e.eventRoot):e.getBody()},uz=function(e){return!e.hidden&&!X$(e)},cz=function(e,t,n){uz(e)?e.fire(t,n):X$(e)&&tz(e,n)},dz=function(e,t){var n;if(e.delegates||(e.delegates={}),!e.delegates[t]&&!e.removed){var r=lz(e,t);if(nh(e)){if(hI||(hI={},e.editorManager.on("removeEditor",(function(){e.editorManager.activeEditor||hI&&(xe(hI,(function(t,n){e.dom.unbind(lz(e,n))})),hI=null)}))),hI[t])return;n=function(n){var r=n.target,i=e.editorManager.get(),o=i.length;while(o--){var a=i[o].getBody();(a===r||sz.isChildOf(r,a))&&cz(i[o],t,n)}},hI[t]=n,sz.bind(r,t,n)}else n=function(n){cz(e,t,n)},sz.bind(r,t,n),e.delegates[t]=n}},fz=je(je({},az),{bindPendingEventDelegates:function(){var e=this;mn.each(e._pendingNativeEvents,(function(t){dz(e,t)}))},toggleNativeEvent:function(e,t){var n=this;"focus"!==e&&"blur"!==e&&(n.removed||(t?n.initialized?dz(n,e):n._pendingNativeEvents?n._pendingNativeEvents.push(e):n._pendingNativeEvents=[e]:n.initialized&&(n.dom.unbind(lz(n,e),e,n.delegates[e]),delete n.delegates[e])))},unbindAllNativeEvents:function(){var e=this,t=e.getBody(),n=e.dom;e.delegates&&(xe(e.delegates,(function(t,n){e.dom.unbind(lz(e,n),n,t)})),delete e.delegates),!e.inline&&t&&n&&(t.onload=null,n.unbind(e.getWin()),n.unbind(e.getDoc())),n&&(n.unbind(t),n.unbind(e.getContainer()))}}),hz=["design","readonly"],mz=function(e,t,n,r){var i=n[t.get()],o=n[r];try{o.activate()}catch(LU){return void console.error("problem while activating editor mode "+r+":",LU)}i.deactivate(),i.editorReadOnly!==o.editorReadOnly&&Y$(e,o.editorReadOnly),t.set(r),qg(e,r)},pz=function(e,t,n,r){if(r!==n.get()){if(!Re(t,r))throw new Error("Editor mode '"+r+"' is invalid");e.initialized?mz(e,n,t,r):e.on("init",(function(){return mz(e,n,t,r)}))}},gz=function(e,t,n){var r;if(X(hz,t))throw new Error("Cannot override default mode "+t);return je(je({},e),(r={},r[t]=je(je({},n),{deactivate:function(){try{n.deactivate()}catch(LU){console.error("problem while deactivating editor mode "+t+":",LU)}}}),r))},vz=function(e){var t=Xu("design"),n=Xu({design:{activate:E,deactivate:E,editorReadOnly:!1},readonly:{activate:E,deactivate:E,editorReadOnly:!0}});return Q$(e),nz(e),{isReadOnly:function(){return X$(e)},set:function(r){return pz(e,n.get(),t,r)},get:function(){return t.get()},register:function(e,t){n.set(gz(n.get(),e,t))}}},bz=mn.each,yz=mn.explode,wz={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},Sz=mn.makeMap("alt,ctrl,shift,meta,access"),xz=function(e){var t,n={};bz(yz(e.toLowerCase(),"+"),(function(e){e in Sz?n[e]=!0:/^[0-9]{2,}$/.test(e)?n.keyCode=parseInt(e,10):(n.charCode=e.charCodeAt(0),n.keyCode=wz[e]||e.toUpperCase().charCodeAt(0))}));var r=[n.keyCode];for(t in Sz)n[t]?r.push(t):n[t]=!1;return n.id=r.join(","),n.access&&(n.alt=!0,en.mac?n.ctrl=!0:n.shift=!0),n.meta&&(en.mac?n.meta=!0:(n.ctrl=!0,n.meta=!1)),n},Cz=function(){function e(e){this.shortcuts={},this.pendingPatterns=[],this.editor=e;var t=this;e.on("keyup keypress keydown",(function(e){!t.hasModifier(e)&&!t.isFunctionKey(e)||e.isDefaultPrevented()||(bz(t.shortcuts,(function(n){if(t.matchShortcut(e,n))return t.pendingPatterns=n.subpatterns.slice(0),"keydown"===e.type&&t.executeShortcutAction(n),!0})),t.matchShortcut(e,t.pendingPatterns[0])&&(1===t.pendingPatterns.length&&"keydown"===e.type&&t.executeShortcutAction(t.pendingPatterns[0]),t.pendingPatterns.shift()))}))}return e.prototype.add=function(e,t,n,r){var i=this,o=i.normalizeCommandFunc(n);return bz(yz(mn.trim(e)),(function(e){var n=i.createShortcut(e,t,o,r);i.shortcuts[n.id]=n})),!0},e.prototype.remove=function(e){var t=this.createShortcut(e);return!!this.shortcuts[t.id]&&(delete this.shortcuts[t.id],!0)},e.prototype.normalizeCommandFunc=function(e){var t=this,n=e;return"string"===typeof n?function(){t.editor.execCommand(n,!1,null)}:mn.isArray(n)?function(){t.editor.execCommand(n[0],n[1],n[2])}:n},e.prototype.createShortcut=function(e,t,n,r){var i=mn.map(yz(e,">"),xz);return i[i.length-1]=mn.extend(i[i.length-1],{func:n,scope:r||this.editor}),mn.extend(i[0],{desc:this.editor.translate(t),subpatterns:i.slice(1)})},e.prototype.hasModifier=function(e){return e.altKey||e.ctrlKey||e.metaKey},e.prototype.isFunctionKey=function(e){return"keydown"===e.type&&e.keyCode>=112&&e.keyCode<=123},e.prototype.matchShortcut=function(e,t){return!!t&&(t.ctrl===e.ctrlKey&&t.meta===e.metaKey&&(t.alt===e.altKey&&t.shift===e.shiftKey&&(!!(e.keyCode===t.keyCode||e.charCode&&e.charCode===t.charCode)&&(e.preventDefault(),!0))))},e.prototype.executeShortcutAction=function(e){return e.func?e.func.call(e.scope):null},e}(),Tz=function(){var e={},t={},n={},r={},i={},o={},a={},s=function(e,t){return function(n,r){return e[n.toLowerCase()]=je(je({},r),{type:t})}},l=function(e,t){return r[e.toLowerCase()]=t};return{addButton:s(e,"button"),addGroupToolbarButton:s(e,"grouptoolbarbutton"),addToggleButton:s(e,"togglebutton"),addMenuButton:s(e,"menubutton"),addSplitButton:s(e,"splitbutton"),addMenuItem:s(t,"menuitem"),addNestedMenuItem:s(t,"nestedmenuitem"),addToggleMenuItem:s(t,"togglemenuitem"),addAutocompleter:s(n,"autocompleter"),addContextMenu:s(i,"contextmenu"),addContextToolbar:s(o,"contexttoolbar"),addContextForm:s(o,"contextform"),addSidebar:s(a,"sidebar"),addIcon:l,getAll:function(){return{buttons:e,menuItems:t,icons:r,popups:n,contextMenus:i,contextToolbars:o,sidebars:a}}}},Dz=function(){var e=Tz();return{addAutocompleter:e.addAutocompleter,addButton:e.addButton,addContextForm:e.addContextForm,addContextMenu:e.addContextMenu,addContextToolbar:e.addContextToolbar,addIcon:e.addIcon,addMenuButton:e.addMenuButton,addMenuItem:e.addMenuItem,addNestedMenuItem:e.addNestedMenuItem,addSidebar:e.addSidebar,addSplitButton:e.addSplitButton,addToggleButton:e.addToggleButton,addGroupToolbarButton:e.addGroupToolbarButton,addToggleMenuItem:e.addToggleMenuItem,getAll:e.getAll}},kz=Uu.DOM,Ez=mn.extend,_z=mn.each,Az=mn.resolve,Lz=en.ie,Oz=function(){function e(e,t,n){var r=this;this.plugins={},this.contentCSS=[],this.contentStyles=[],this.loadedCSS={},this.isNotDirty=!1,this.editorManager=n,this.documentBaseUrl=n.documentBaseURL,Ez(this,fz),this.settings=xA(this,e,this.documentBaseUrl,n.defaultSettings,t),this.settings.suffix&&(n.suffix=this.settings.suffix),this.suffix=n.suffix,this.settings.base_url&&n._setBaseUrl(this.settings.base_url),this.baseUri=n.baseURI,this.settings.referrer_policy&&(Yu.ScriptLoader._setReferrerPolicy(this.settings.referrer_policy),Uu.DOM.styleSheetLoader._setReferrerPolicy(this.settings.referrer_policy)),cc.languageLoad=this.settings.language_load,cc.baseURL=n.baseURL,this.id=e,this.setDirty(!1),this.documentBaseURI=new s_(this.settings.document_base_url,{base_uri:this.baseUri}),this.baseURI=this.baseUri,this.inline=!!this.settings.inline,this.shortcuts=new Cz(this),this.editorCommands=new z$(this),this.settings.cache_suffix&&(en.cacheSuffix=this.settings.cache_suffix.replace(/^[\?\&]+/,"")),this.ui={registry:Dz(),styleSheetLoader:void 0,show:E,hide:E,enable:E,disable:E,isDisabled:B};var i=this,o=vz(i);this.mode=o,this.setMode=o.set,n.fire("SetupEditor",{editor:this}),this.execCallback("setup",this),this.$=Iu.overrideDefaults((function(){return{context:r.inline?r.getBody():r.getDoc(),element:r.getBody()}}))}return e.prototype.render=function(){m$(this)},e.prototype.focus=function(e){this.execCommand("mceFocus",!1,e)},e.prototype.hasFocus=function(){return fy(this)},e.prototype.execCallback=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r,i=this,o=i.settings[e];if(o)return i.callbackLookup&&(r=i.callbackLookup[e])&&(o=r.func,r=r.scope),"string"===typeof o&&(r=o.replace(/\.\w+$/,""),r=r?Az(r):0,o=Az(o),i.callbackLookup=i.callbackLookup||{},i.callbackLookup[e]={func:o,scope:r}),o.apply(r||i,t)},e.prototype.translate=function(e){return uc.translate(e)},e.prototype.getParam=function(e,t,n){return kA(this,e,t,n)},e.prototype.hasPlugin=function(e,t){var n=X(Ch(this).split(/[ ,]/),e);return!!n&&(!t||void 0!==HA.get(e))},e.prototype.nodeChanged=function(e){this._nodeChangeDispatcher.nodeChanged(e)},e.prototype.addCommand=function(e,t,n){this.editorCommands.addCommand(e,t,n)},e.prototype.addQueryStateHandler=function(e,t,n){this.editorCommands.addQueryStateHandler(e,t,n)},e.prototype.addQueryValueHandler=function(e,t,n){this.editorCommands.addQueryValueHandler(e,t,n)},e.prototype.addShortcut=function(e,t,n,r){this.shortcuts.add(e,t,n,r)},e.prototype.execCommand=function(e,t,n,r){return this.editorCommands.execCommand(e,t,n,r)},e.prototype.queryCommandState=function(e){return this.editorCommands.queryCommandState(e)},e.prototype.queryCommandValue=function(e){return this.editorCommands.queryCommandValue(e)},e.prototype.queryCommandSupported=function(e){return this.editorCommands.queryCommandSupported(e)},e.prototype.show=function(){var e=this;e.hidden&&(e.hidden=!1,e.inline?e.getBody().contentEditable="true":(kz.show(e.getContainer()),kz.hide(e.id)),e.load(),e.fire("show"))},e.prototype.hide=function(){var e=this,t=e.getDoc();e.hidden||(Lz&&t&&!e.inline&&t.execCommand("SelectAll"),e.save(),e.inline?(e.getBody().contentEditable="false",e===e.editorManager.focusedEditor&&(e.editorManager.focusedEditor=null)):(kz.hide(e.getContainer()),kz.setStyle(e.id,"display",e.orgDisplay)),e.hidden=!0,e.fire("hide"))},e.prototype.isHidden=function(){return!!this.hidden},e.prototype.setProgressState=function(e,t){this.fire("ProgressState",{state:e,time:t})},e.prototype.load=function(e){var t,n=this,r=n.getElement();if(n.removed)return"";if(r){e=e||{},e.load=!0;var i=Qr(r)?r.value:r.innerHTML;return t=n.setContent(i,e),e.element=r,e.no_events||n.fire("LoadContent",e),e.element=r=null,t}},e.prototype.save=function(e){var t,n,r=this,i=r.getElement();if(i&&r.initialized&&!r.removed)return e=e||{},e.save=!0,e.element=i,t=e.content=r.getContent(e),e.no_events||r.fire("SaveContent",e),"raw"===e.format&&r.fire("RawSaveContent",e),t=e.content,Qr(i)?i.value=t:(!e.is_removing&&r.inline||(i.innerHTML=t),(n=kz.getParent(r.id,"form"))&&_z(n.elements,(function(e){if(e.name===r.id)return e.value=t,!1}))),e.element=i=null,!1!==e.set_dirty&&r.setDirty(!1),t},e.prototype.setContent=function(e,t){return N_(this,e,t)},e.prototype.getContent=function(e){return M_(this,e)},e.prototype.insertContent=function(e,t){t&&(e=Ez({content:e},t)),this.execCommand("mceInsertContent",!1,e)},e.prototype.resetContent=function(e){void 0===e?N_(this,this.startContent,{format:"raw"}):N_(this,e),this.undoManager.reset(),this.setDirty(!1),this.nodeChanged()},e.prototype.isDirty=function(){return!this.isNotDirty},e.prototype.setDirty=function(e){var t=!this.isNotDirty;this.isNotDirty=!e,e&&e!==t&&this.fire("dirty")},e.prototype.getContainer=function(){var e=this;return e.container||(e.container=kz.get(e.editorContainer||e.id+"_parent")),e.container},e.prototype.getContentAreaContainer=function(){return this.contentAreaContainer},e.prototype.getElement=function(){return this.targetElm||(this.targetElm=kz.get(this.id)),this.targetElm},e.prototype.getWin=function(){var e,t=this;return t.contentWindow||(e=t.iframeElement,e&&(t.contentWindow=e.contentWindow)),t.contentWindow},e.prototype.getDoc=function(){var e,t=this;return t.contentDocument||(e=t.getWin(),e&&(t.contentDocument=e.document)),t.contentDocument},e.prototype.getBody=function(){var e=this.getDoc();return this.bodyElement||(e?e.body:null)},e.prototype.convertURL=function(e,t,n){var r=this,i=r.settings;return i.urlconverter_callback?r.execCallback("urlconverter_callback",e,n,!0,t):!i.convert_urls||n&&"LINK"===n.nodeName||0===e.indexOf("file:")||0===e.length?e:i.relative_urls?r.documentBaseURI.toRelative(e):(e=r.documentBaseURI.toAbsolute(e,i.remove_script_host),e)},e.prototype.addVisual=function(e){p$(this,e)},e.prototype.remove=function(){V_(this)},e.prototype.destroy=function(e){H_(this,e)},e.prototype.uploadImages=function(e){return this.editorUpload.uploadImages(e)},e.prototype._scanForImages=function(){return this.editorUpload.scanForImages()},e.prototype.addButton=function(){throw new Error("editor.addButton has been removed in tinymce 5x, use editor.ui.registry.addButton or editor.ui.registry.addToggleButton or editor.ui.registry.addSplitButton instead")},e.prototype.addSidebar=function(){throw new Error("editor.addSidebar has been removed in tinymce 5x, use editor.ui.registry.addSidebar instead")},e.prototype.addMenuItem=function(){throw new Error("editor.addMenuItem has been removed in tinymce 5x, use editor.ui.registry.addMenuItem instead")},e.prototype.addContextToolbar=function(){throw new Error("editor.addContextToolbar has been removed in tinymce 5x, use editor.ui.registry.addContextToolbar instead")},e}(),Rz=Uu.DOM,Iz=mn.explode,Pz=mn.each,Mz=mn.extend,Nz=0,Fz=!1,Bz=[],$z=[],zz=function(e){return"length"!==e},Uz=function(e){var t=e.type;Pz(Gz.get(),(function(n){switch(t){case"scroll":n.fire("ScrollWindow",e);break;case"resize":n.fire("ResizeWindow",e);break}}))},Vz=function(e){e!==Fz&&(e?Iu(window).on("resize scroll",Uz):Iu(window).off("resize scroll",Uz),Fz=e)},Hz=function(e){var t=$z;delete Bz[e.id];for(var n=0;n<Bz.length;n++)if(Bz[n]===e){Bz.splice(n,1);break}return $z=ne($z,(function(t){return e!==t})),Gz.activeEditor===e&&(Gz.activeEditor=$z.length>0?$z[0]:null),Gz.focusedEditor===e&&(Gz.focusedEditor=null),t.length!==$z.length},jz=function(e){return e&&e.initialized&&!(e.getContainer()||e.getBody()).parentNode&&(Hz(e),e.unbindAllNativeEvents(),e.destroy(!0),e.removed=!0,e=null),e},qz="CSS1Compat"!==document.compatMode,Gz=je(je({},az),{baseURI:null,baseURL:null,defaultSettings:{},documentBaseURL:null,suffix:null,$:Iu,majorVersion:"5",minorVersion:"10.9",releaseDate:"2023-11-15",editors:Bz,i18n:uc,activeEditor:null,focusedEditor:null,settings:{},setup:function(){var e,t,n=this,r="";t=s_.getDocumentBaseUrl(document.location),/^[^:]+:\/\/\/?[^\/]+\//.test(t)&&(t=t.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(t)||(t+="/"));var i=window.tinymce||window.tinyMCEPreInit;if(i)e=i.base||i.baseURL,r=i.suffix;else{for(var o=document.getElementsByTagName("script"),a=0;a<o.length;a++){var s=o[a].src||"";if(""!==s){var l=s.substring(s.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(s)){-1!==l.indexOf(".min")&&(r=".min"),e=s.substring(0,s.lastIndexOf("/"));break}}}if(!e&&document.currentScript){s=document.currentScript.src;-1!==s.indexOf(".min")&&(r=".min"),e=s.substring(0,s.lastIndexOf("/"))}}n.baseURL=new s_(t).toAbsolute(e),n.documentBaseURL=t,n.baseURI=new s_(n.baseURL),n.suffix=r,ny(n)},overrideDefaults:function(e){var t=e.base_url;t&&this._setBaseUrl(t);var n=e.suffix;e.suffix&&(this.suffix=n),this.defaultSettings=e;var r=e.plugin_base_urls;void 0!==r&&xe(r,(function(e,t){cc.PluginManager.urls[t]=e}))},init:function(e){var t,n=this,r=mn.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu"," "),i=function(e,t){return e.inline&&t.tagName.toLowerCase()in r},o=function(e){var t=e.id;return t||(t=Oe(e,"name").filter((function(e){return!Rz.get(e)})).getOrThunk(Rz.uniqueId),e.setAttribute("id",t)),t},a=function(t){var r=e[t];if(r)return r.apply(n,[])},s=function(e,t){return t.constructor===RegExp?t.test(e.className):Rz.hasClass(e,t)},l=function(e){var t=[];if(en.browser.isIE()&&en.browser.version.major<11)return nL("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tinymce.com/docs/get-started/system-requirements/"),[];if(qz)return nL("Failed to initialize the editor as the document is not in standards mode. TinyMCE requires standards mode."),[];if(e.types)return Pz(e.types,(function(e){t=t.concat(Rz.select(e.selector))})),t;if(e.selector)return Rz.select(e.selector);if(e.target)return[e.target];switch(e.mode){case"exact":var n=e.elements||"";n.length>0&&Pz(Iz(n),(function(e){var n=Rz.get(e);n?t.push(n):Pz(document.forms,(function(n){Pz(n.elements,(function(n){n.name===e&&(e="mce_editor_"+Nz++,Rz.setAttrib(n,"id",e),t.push(n))}))}))}));break;case"textareas":case"specific_textareas":Pz(Rz.select("textarea"),(function(n){e.editor_deselector&&s(n,e.editor_deselector)||e.editor_selector&&!s(n,e.editor_selector)||t.push(n)}));break}return t},u=function(e){t=e},c=function(){var t,r=0,s=[],d=function(e,i,o){var a=new Oz(e,i,n);s.push(a),a.on("init",(function(){++r===t.length&&u(s)})),a.targetElm=a.targetElm||o,a.render()};Rz.unbind(window,"ready",c),a("onpageload"),t=Iu.unique(l(e)),e.types?Pz(e.types,(function(n){mn.each(t,(function(t){return!Rz.is(t,n.selector)||(d(o(t),Mz({},e,n),t),!1)}))})):(mn.each(t,(function(e){jz(n.get(e.id))})),t=mn.grep(t,(function(e){return!n.get(e.id)})),0===t.length?u([]):Pz(t,(function(t){i(e,t)?nL("Could not initialize inline editor on invalid inline target element",t):d(o(t),e,t)})))};return n.settings=e,Rz.bind(window,"ready",c),new Ao((function(e){t?e(t):u=function(t){e(t)}}))},get:function(e){return 0===arguments.length?$z.slice(0):v(e)?ae($z,(function(t){return t.id===e})).getOr(null):k(e)&&$z[e]?$z[e]:null},add:function(e){var t=this,n=Bz[e.id];return n===e||(null===t.get(e.id)&&(zz(e.id)&&(Bz[e.id]=e),Bz.push(e),$z.push(e)),Vz(!0),t.activeEditor=e,t.fire("AddEditor",{editor:e}),mI||(mI=function(e){var n=t.fire("BeforeUnload");if(n.returnValue)return e.preventDefault(),e.returnValue=n.returnValue,n.returnValue},window.addEventListener("beforeunload",mI))),e},createEditor:function(e,t){return this.add(new Oz(e,t,this))},remove:function(e){var t,n,r=this;if(e){if(!v(e))return n=e,w(r.get(n.id))?null:(Hz(n)&&r.fire("RemoveEditor",{editor:n}),0===$z.length&&window.removeEventListener("beforeunload",mI),n.remove(),Vz($z.length>0),n);Pz(Rz.select(e),(function(e){n=r.get(e.id),n&&r.remove(n)}))}else for(t=$z.length-1;t>=0;t--)r.remove($z[t])},execCommand:function(e,t,n){var r=this,i=r.get(n);switch(e){case"mceAddEditor":return r.get(n)||new Oz(n,r.settings,r).render(),!0;case"mceRemoveEditor":return i&&i.remove(),!0;case"mceToggleEditor":return i?(i.isHidden()?i.show():i.hide(),!0):(r.execCommand("mceAddEditor",!1,n),!0)}return!!r.activeEditor&&r.activeEditor.execCommand(e,t,n)},triggerSave:function(){Pz($z,(function(e){e.save()}))},addI18n:function(e,t){uc.add(e,t)},translate:function(e){return uc.translate(e)},setActive:function(e){var t=this.activeEditor;this.activeEditor!==e&&(t&&t.fire("deactivate",{relatedTarget:e}),e.fire("activate",{relatedTarget:t})),this.activeEditor=e},_setBaseUrl:function(e){this.baseURL=new s_(this.documentBaseURL).toAbsolute(e.replace(/\/+$/,"")),this.baseURI=new s_(this.baseURL)}});Gz.setup();var Wz,Kz,Yz=Math.min,Xz=Math.max,Jz=Math.round,Qz=function(e,t,n){var r=t.x,i=t.y,o=e.w,a=e.h,s=t.w,l=t.h,u=(n||"").split("");return"b"===u[0]&&(i+=l),"r"===u[1]&&(r+=s),"c"===u[0]&&(i+=Jz(l/2)),"c"===u[1]&&(r+=Jz(s/2)),"b"===u[3]&&(i-=a),"r"===u[4]&&(r-=o),"c"===u[3]&&(i-=Jz(a/2)),"c"===u[4]&&(r-=Jz(o/2)),rU(r,i,o,a)},Zz=function(e,t,n,r){var i,o;for(o=0;o<r.length;o++)if(i=Qz(e,t,r[o]),i.x>=n.x&&i.x+i.w<=n.w+n.x&&i.y>=n.y&&i.y+i.h<=n.h+n.y)return r[o];return null},eU=function(e,t,n){return rU(e.x-t,e.y-n,e.w+2*t,e.h+2*n)},tU=function(e,t){var n=Xz(e.x,t.x),r=Xz(e.y,t.y),i=Yz(e.x+e.w,t.x+t.w),o=Yz(e.y+e.h,t.y+t.h);return i-n<0||o-r<0?null:rU(n,r,i-n,o-r)},nU=function(e,t,n){var r=e.x,i=e.y,o=e.x+e.w,a=e.y+e.h,s=t.x+t.w,l=t.y+t.h,u=Xz(0,t.x-r),c=Xz(0,t.y-i),d=Xz(0,o-s),f=Xz(0,a-l);return r+=u,i+=c,n&&(o+=u,a+=c,r-=d,i-=f),o-=d,a-=f,rU(r,i,o-r,a-i)},rU=function(e,t,n,r){return{x:e,y:t,w:n,h:r}},iU=function(e){return rU(e.left,e.top,e.width,e.height)},oU={inflate:eU,relativePosition:Qz,findBestRelativePosition:Zz,intersect:tU,clamp:nU,create:rU,fromClientRect:iU},aU=function(e,t,n){void 0===n&&(n=1e3);var r=!1,i=null,o=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];r||(r=!0,null!==i&&(clearTimeout(i),i=null),e.apply(null,t))}},a=o(e),s=o(t),l=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r||null!==i||(i=setTimeout((function(){return s.apply(null,e)}),n))};return{start:l,resolve:a,reject:s}},sU=function(){var e={},t={},n=function(n,r){var i='Script at URL "'+r+'" failed to load',o='Script at URL "'+r+"\" did not call `tinymce.Resource.add('"+n+"', data)` within 1 second";if(void 0!==e[n])return e[n];var a=new Ao((function(e,a){var s=aU(e,a);t[n]=s.resolve,Yu.ScriptLoader.loadScript(r,(function(){return s.start(o)}),(function(){return s.reject(i)}))}));return e[n]=a,a},r=function(n,r){void 0!==t[n]&&(t[n](r),delete t[n]),e[n]=Ao.resolve(r)};return{load:n,add:r}},lU=sU(),uU=mn.each,cU=mn.extend,dU=function(){};dU.extend=Wz=function(e){var t=this,n=t.prototype,r=function(){var e,t,n,r=this;if(!Kz&&(r.init&&r.init.apply(r,arguments),t=r.Mixins,t)){e=t.length;while(e--)n=t[e],n.init&&n.init.apply(r,arguments)}},i=function(){return this},o=function(e,t){return function(){var r=this,i=r._super;r._super=n[e];var o=t.apply(r,arguments);return r._super=i,o}};Kz=!0;var a=new t;return Kz=!1,e.Mixins&&(uU(e.Mixins,(function(t){for(var n in t)"init"!==n&&(e[n]=t[n])})),n.Mixins&&(e.Mixins=n.Mixins.concat(e.Mixins))),e.Methods&&uU(e.Methods.split(","),(function(t){e[t]=i})),e.Properties&&uU(e.Properties.split(","),(function(t){var n="_"+t;e[t]=function(e){var t=this;return void 0!==e?(t[n]=e,t):t[n]}})),e.Statics&&uU(e.Statics,(function(e,t){r[t]=e})),e.Defaults&&n.Defaults&&(e.Defaults=cU({},n.Defaults,e.Defaults)),xe(e,(function(e,t){"function"===typeof e&&n[t]?a[t]=o(t,e):a[t]=e})),r.prototype=a,r.constructor=r,r.extend=Wz,r};var fU,hU=Math.min,mU=Math.max,pU=Math.round,gU=function(e){var t={},n=0,r=0,i=0,o=function(e,t,n){var r,i,o;r=0,i=0,o=0,e/=255,t/=255,n/=255;var a=hU(e,hU(t,n)),s=mU(e,mU(t,n));if(a===s)return o=a,{h:0,s:0,v:100*o};var l=e===a?t-n:n===a?e-t:n-e;return r=e===a?3:n===a?1:5,r=60*(r-l/(s-a)),i=(s-a)/s,o=s,{h:pU(r),s:pU(100*i),v:pU(100*o)}},a=function(e,t,o){if(e=(parseInt(e,10)||0)%360,t=parseInt(t,10)/100,o=parseInt(o,10)/100,t=mU(0,hU(t,1)),o=mU(0,hU(o,1)),0!==t){var a=e/60,s=o*t,l=s*(1-Math.abs(a%2-1)),u=o-s;switch(Math.floor(a)){case 0:n=s,r=l,i=0;break;case 1:n=l,r=s,i=0;break;case 2:n=0,r=s,i=l;break;case 3:n=0,r=l,i=s;break;case 4:n=l,r=0,i=s;break;case 5:n=s,r=0,i=l;break;default:n=r=i=0}n=pU(255*(n+u)),r=pU(255*(r+u)),i=pU(255*(i+u))}else n=r=i=pU(255*o)},s=function(){var e=function(e){return e=parseInt(e,10).toString(16),e.length>1?e:"0"+e};return"#"+e(n)+e(r)+e(i)},l=function(){return{r:n,g:r,b:i}},u=function(){return o(n,r,i)},c=function(e){var o;return"object"===typeof e?"r"in e?(n=e.r,r=e.g,i=e.b):"v"in e&&a(e.h,e.s,e.v):(o=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)[^\)]*\)/gi.exec(e))?(n=parseInt(o[1],10),r=parseInt(o[2],10),i=parseInt(o[3],10)):(o=/#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(e))?(n=parseInt(o[1],16),r=parseInt(o[2],16),i=parseInt(o[3],16)):(o=/#([0-F])([0-F])([0-F])/gi.exec(e))&&(n=parseInt(o[1]+o[1],16),r=parseInt(o[2]+o[2],16),i=parseInt(o[3]+o[3],16)),n=n<0?0:n>255?255:n,r=r<0?0:r>255?255:r,i=i<0?0:i>255?255:i,t};return e&&c(e),t.toRgb=l,t.toHsv=u,t.toHex=s,t.parse=c,t},vU=function(e){var t=JSON.stringify(e);return v(t)?t.replace(/[\u0080-\uFFFF]/g,(function(e){var t=e.charCodeAt(0).toString(16);return"\\u"+"0000".substring(t.length)+t})):t},bU={serialize:vU,parse:function(e){try{return JSON.parse(e)}catch(t){}}},yU={callbacks:{},count:0,send:function(e){var t=this,n=Uu.DOM,r=void 0!==e.count?e.count:t.count,i="tinymce_jsonp_"+r;t.callbacks[r]=function(o){n.remove(i),delete t.callbacks[r],e.callback(o)},n.add(n.doc.body,"script",{id:i,src:e.url,type:"text/javascript"}),t.count++}},wU=je(je({},az),{send:function(e){var t,n=0,r=function(){!e.async||4===t.readyState||n++>1e4?(e.success&&n<1e4&&200===t.status?e.success.call(e.success_scope,""+t.responseText,t,e):e.error&&e.error.call(e.error_scope,n>1e4?"TIMED_OUT":"GENERAL",t,e),t=null):No.setTimeout(r,10)};if(e.scope=e.scope||this,e.success_scope=e.success_scope||e.scope,e.error_scope=e.error_scope||e.scope,e.async=!1!==e.async,e.data=e.data||"",wU.fire("beforeInitialize",{settings:e}),t=new XMLHttpRequest,t.overrideMimeType&&t.overrideMimeType(e.content_type),t.open(e.type||(e.data?"POST":"GET"),e.url,e.async),e.crossDomain&&(t.withCredentials=!0),e.content_type&&t.setRequestHeader("Content-Type",e.content_type),e.requestheaders&&mn.each(e.requestheaders,(function(e){t.setRequestHeader(e.key,e.value)})),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),t=wU.fire("beforeSend",{xhr:t,settings:e}).xhr,t.send(e.data),!e.async)return r();No.setTimeout(r,10)}}),SU=mn.extend,xU=function(){function e(e){this.settings=SU({},e),this.count=0}return e.sendRPC=function(t){return(new e).send(t)},e.prototype.send=function(e){var t=e.error,n=e.success,r=SU(this.settings,e);r.success=function(e,i){e=bU.parse(e),"undefined"===typeof e&&(e={error:"JSON Parse error."}),e.error?t.call(r.error_scope||r.scope,e.error,i):n.call(r.success_scope||r.scope,e.result)},r.error=function(e,n){t&&t.call(r.error_scope||r.scope,e,n)},r.data=bU.serialize({id:e.id||"c"+this.count++,method:e.method,params:e.params}),r.content_type="application/json",wU.send(r)},e}(),CU=function(){return function(){var e={},t=[],n={getItem:function(t){var n=e[t];return n||null},setItem:function(n,r){t.push(n),e[n]=String(r)},key:function(e){return t[e]},removeItem:function(n){t=t.filter((function(e){return e===n})),delete e[n]},clear:function(){t=[],e={}},length:0};return Object.defineProperty(n,"length",{get:function(){return t.length},configurable:!1,enumerable:!1}),n}()};try{var TU="__storage_test__";fU=window.localStorage,fU.setItem(TU,TU),fU.removeItem(TU)}catch(LU){fU=CU()}var DU=fU,kU={geom:{Rect:oU},util:{Promise:Ao,Delay:No,Tools:mn,VK:tv,URI:s_,Class:dU,EventDispatcher:iz,Observable:az,I18n:uc,XHR:wU,JSON:bU,JSONRequest:xU,JSONP:yU,LocalStorage:DU,Color:gU,ImageUploader:gL},dom:{EventUtils:rl,Sizzle:Ul,DomQuery:Iu,TreeWalker:zo,TextSeeker:Yc,DOMUtils:Uu,ScriptLoader:Yu,RangeUtils:Tv,Serializer:I_,StyleSheetLoader:Fo,ControlSelection:rv,BookmarkManager:Bg,Selection:CE,Event:rl.Event},html:{Styles:Hs,Entities:_s,Node:Ay,Schema:Us,SaxParser:p_,DomParser:w_,Writer:Qy,Serializer:Zy},Env:en,AddOnManager:cc,Annotator:Fg,Formatter:_L,UndoManager:RL,EditorCommands:z$,WindowManager:GA,NotificationManager:VA,EditorObservable:fz,Shortcuts:Cz,Editor:Oz,FocusManager:Vb,EditorManager:Gz,DOM:Uu.DOM,ScriptLoader:Yu.ScriptLoader,PluginManager:HA,ThemeManager:jA,IconManager:_A,Resource:lU,trim:mn.trim,isArray:mn.isArray,is:mn.is,toArray:mn.toArray,makeMap:mn.makeMap,each:mn.each,map:mn.map,grep:mn.grep,inArray:mn.inArray,extend:mn.extend,create:mn.create,walk:mn.walk,createNS:mn.createNS,resolve:mn.resolve,explode:mn.explode,_addCacheSuffix:mn._addCacheSuffix,isOpera:en.opera,isWebKit:en.webkit,isIE:en.ie,isGecko:en.gecko,isMac:en.mac},EU=mn.extend(Gz,kU),_U=function(t){try{e.exports=t}catch(n){}},AU=function(e){window.tinymce=e,window.tinyMCE=e};AU(EU),_U(EU)})()}).call(this,n("a282"))},"29ed":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.addModifyVisible,width:"50%"},on:{"update:visible":function(t){e.addModifyVisible=t},close:e.close}},[t("el-form",{ref:"collectionRef",attrs:{model:e.addData,rules:e.collectionRule,"label-position":"right","label-width":"90px"}},[e.vipName?t("el-form-item",{attrs:{label:"收款单位:"}},[e._v(" "+e._s(e.vipName)+" ")]):e._e(),t("el-form-item",{attrs:{label:"收款方式:",prop:"categoryId"}},[t("jat-select",{attrs:{placeholder:"请选择收款方式",clearable:""},model:{value:e.addData.categoryId,callback:function(t){e.$set(e.addData,"categoryId",t)},expression:"addData.categoryId"}},e._l(e.categoryOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"水单:",prop:"receiptUrl"}},[t("upload-image",{model:{value:e.addData.receiptUrl,callback:function(t){e.$set(e.addData,"receiptUrl",t)},expression:"addData.receiptUrl"}})],1),t("el-form-item",{attrs:{label:"收款金额:",prop:"collectionMoney"}},[t("jat-input",{directives:[{name:"input",rawName:"v-input.float",value:2,expression:"2",modifiers:{float:!0}}],attrs:{placeholder:"请输入收款金额"},model:{value:e.addData.collectionMoney,callback:function(t){e.$set(e.addData,"collectionMoney",t)},expression:"addData.collectionMoney"}})],1),t("el-form-item",{attrs:{label:"收款时间:",prop:"collectionTime"}},[t("jat-date-picker",{attrs:{width:"100%",clearable:"",type:"datetime",placeholder:"请选择收款时间",valueFormat:"yyyy-MM-dd HH:mm:ss",size:"small"},model:{value:e.addData.collectionTime,callback:function(t){e.$set(e.addData,"collectionTime",t)},expression:"addData.collectionTime"}})],1),t("el-form-item",{attrs:{label:"收款备注:",prop:"remark"}},[t("jat-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入收款备注"},model:{value:e.addData.remark,callback:function(t){e.$set(e.addData,"remark",t)},expression:"addData.remark"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{attrs:{disabled:e.btnFlag},on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)],1)},i=[],o=n("cbc3"),a=n("b775"),s={components:{uploadImage:o["a"]},data(){return{btnFlag:!1,addModifyVisible:!1,dialogTitle:"",vipName:"",addData:{categoryId:"",collectionMoney:"",collectionTime:"",orderNum:"",receiptUrl:"",remark:""},categoryOptions:[],collectionRule:{categoryId:[{required:!0,message:"请选择收款方式",trigger:"blur"}],collectionMoney:[{required:!0,message:"请输入收款金额",trigger:"blur"}],collectionTime:[{required:!0,message:"请选择收款时间",trigger:"blur"}]}}},mounted(){this.getCategoryList()},methods:{open(e,t,n){this.dialogTitle="创建收款",this.addData.orderNum=e,t&&(this.dialogTitle=t,this.vipName=n),this.addModifyVisible=!0},close(){this.$refs.collectionRef&&this.$refs.collectionRef.clearValidate(),this.vipName="",this.addData={categoryId:"",collectionMoney:"",collectionTime:"",orderNum:"",receiptUrl:"",remark:""},this.addModifyVisible=!1},getCategoryList(){a["a"].post({url:"/system/sysCategory/listNoPage",params:{type:3},success:e=>{this.categoryOptions=e}})},handleSubmit(){this.$refs.collectionRef.validate(e=>{e&&(this.btnFlag=!0,a["a"].post({url:"/system/sysCourseOrderBills/add",params:this.addData,success:e=>{this.$message.success(e),this.close(),this.$emit("success"),this.btnFlag=!1}}))})}}},l=s,u=n("1805"),c=Object(u["a"])(l,r,i,!1,null,"7adb274e",null);t["default"]=c.exports},"2a1e":function(e,t,n){},"2a9b":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));const r=[{value:0,label:"未确认",color:"#34495e"},{value:1,label:"已确认",color:"#1abc9c"},{value:2,label:"订单已报账",color:"#27ae60"},{value:3,label:"操作已终审",color:"#f39c12"},{value:4,label:"财务已报账",color:"#f39c12"},{value:5,label:"已修改待确认",color:"#f1c40f"},{value:6,label:"已请取消",color:"#bdc3c7"},{value:7,label:"已取消",color:"#95a5a6"}],i=[{value:-1,label:"已取消",color:"#409EFF"},{value:0,label:"待审",color:"#409EFF"},{value:1,label:"已审核",color:"#67C23A"},{value:2,label:"已收",color:"#E6A23C"},{value:3,label:"已入账",color:"#909399"}]},"2acd":function(e,t,n){},"2fb5":function(e,t,n){"use strict";(function(e){var r,i;
/*!
* Mui Player Desktop Plugin Javascript Library v1.6.0
* Date：2023-01-23
* Released under GPL-3.0 license
* https://muiplayer.js.org/
*/function o(e){return l(e)||s(e)||c(e)||a()}function a(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function l(e){if(Array.isArray(e))return d(e)}function u(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=c(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;t=function(){};return{s:t,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw i}}}}function c(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(o,a){"object"==f(t)&&"object"==f(e)?e.exports=a():f(n("51d4"))?(r=a,i="function"===typeof r?r.call(t,n,t,e):r,void 0===i||(e.exports=i)):o.MuiPlayerDesktopPlugin=a()}(window,(function(){return function(e){function t(){return{defaults:[{functions:"循环播放",name:"loopPlay",show:!0,model:"switch",selected:!1,onToggle:function(e,t,n){t(),e.event.currentTarget.querySelector(".toogle-switch").classList.contains("open")?a.$el.videoObject.loop=!0:a.$el.videoObject.loop=!1}},{functions:"播放速度",name:"playbackRate",show:!0,model:"select",childConfig:[{functions:"0.25"},{functions:"0.5"},{functions:"0.75"},{functions:"正常",selected:!0},{functions:"1.25"},{functions:"1.5"},{functions:"1.75"},{functions:"2"}],onToggle:function(e,t,n){t(),n(),n=a.$method.getLangObject(),e=e.functions,isNaN(parseFloat(e))?(a.$el.videoObject.playbackRate=1,d.rst(n.dsps)):(a.$el.videoObject.playbackRate=parseFloat(e),d.rst(n.tsps.replace("?",e)))}}],subtitle:{functions:"字幕",name:"subtitle",childConfig:[{functions:"打开",name:"loopPlay",model:"switch",selected:!0},{functions:"选择语言",childConfig:[],onToggle:function(e,t,n){var r=e.getPanelOption(e.panelIndex,"parent").panelIndex,i=a.$el.videoObject.textTracks;i&&i instanceof TextTrackList?function(){for(var n=0;n<i.length;n++){var o=i[n];e.functions==o.label?(o.mode="showing",e.getPanelOption(r,"parent").childConfig[0].selected=!0,t()):"showing"==o.mode&&(o.mode="hidden")}}():d.rst("the textTracks api is not supported by the browser.")}}],onToggle:function(e,t,n){var r=e.event.currentTarget.querySelector(".toogle-switch").classList.contains("open"),i=a.$el.videoObject.textTracks;i&&i instanceof TextTrackList?function(){if(r)for(var n=0;n<i.length;n++){var o=i[n];"showing"==o.mode&&(o.mode="hidden")}else{var a=e.getPanelOption(e.panelIndex,"parent").childConfig[1].childConfig;for(n=0;n<i.length;n++){var s,l=i[n],c=u(a);try{for(c.s();!(s=c.n()).done;){var d=s.value;if(l.label==d.functions&&1==d.selected){l.mode="showing";break}}}catch(n){c.e(n)}finally{c.f()}}}t()}():d.rst("the textTracks api is not supported by the browser.")}}}}function n(n){"statics"==n&&(c=(new t).defaults,p.initSubtitleOption()&&c.push(p.initSubtitleOption())),!c.map((function(e){return e.name})).includes("subtitle")&&"statics"!=n&&p.initSubtitleOption()&&c.push(p.initSubtitleOption());var r,i=a.$method.getLangObject();for(r in c){var s=c[r].name;"loopPlay"!=s?"playbackRate"!=s?"subtitle"!=s||(c[r].functions=i.subtitles,c[r].childConfig[0].functions=i.open,c[r].childConfig[1].functions=i.selectLangage):(c[r].functions=i.playbackSpeed,c[r].childConfig[3].functions=i.normal):c[r].functions=i.loopPlay}var u=o(e.customSetting||[]);if(u instanceof Array){for(var d=0;d<u.length;d++){var f=c.map((function(e){return e.name}));-1!=f.indexOf(u[d].name)&&c.splice(f.indexOf(u[d].name),1)}(function e(){for(var t=0;t<u.length;t++)!1===u[t].show&&(u.splice(t,1),e())})()}var h=(n=a.option).loop,m=n.live;if(1==h||!0===m)for(var g in c)if("loopPlay"==c[g].name){1==h&&(c[0].selected=!0),!0===m&&c.splice(0,c.length);break}(n=[].concat(o(c),o(u))).sort((function(e,t){return e=e.zIndex||0,t=t.zIndex||0,t<e?-1:e<t?1:0})),l.settingConfigs=n,function e(t,n){for(var r=0;r<t.length;r++)t[r].panelIndex=null==n?r.toString():n.toString()+"-"+r,t[r].childConfig instanceof Array&&0<t[r].childConfig.length&&e(t[r].childConfig,t[r].panelIndex)}(l.settingConfigs)}var r=this,i=(e=e||{},"number"==typeof e.fullScaling&&1<e.fullScaling?e.fullScaling:1.2),a={},s=new function(){return{disabledMousemoveEvent:!1,popupNodeInfo:{triggerButtonRect:{},popupRect:{}}}},l={name:"",settingConfigs:null},c=[],d={rst:function(e){a.$method[a.$method.dc("03702W03303B02C03302P037038")](e)}},f={ctxmenuWrapper:function(){return a.$el.mPlayer.querySelector("#ctxmenu-wrapper")},hideShortcutPanel:function(){var e=a.$el.mPlayer.querySelector("#mplayer-shortcut");e&&(e.style.display="none")},hideCtxmenuList:function(e){(e=e||{}).stopPropagation&&e.stopPropagation();var t=f.ctxmenuWrapper().querySelector(".ctxmenulist");t.style.opacity=0,a._this._global_.ctxmenuTimer_1=setTimeout((function(){t.style.display="none"}),100)},onCtxmenuFocus:function(e){a._this._global_.ctxmenuTimer_1&&clearTimeout(a._this._global_.ctxmenuTimer_1),a._this._global_.ctxmenuTimer_2&&clearTimeout(a._this._global_.ctxmenuTimer_2),f.ctxmenuWrapper().style.display="block",f.hideShortcutPanel()},onCtxmenuBlur:function(e){(e=e||{}).stopPropagation&&e.stopPropagation(),f.hideCtxmenuList(),a._this._global_.ctxmenuTimer_2=setTimeout((function(){f.ctxmenuWrapper().style.display="none",f.ctxmenuWrapper().removeChild(e.target)}),300)},disCtx:function(e,t){for(var n=0;n<e.length;n++){var r=t.map((function(e){return e.name})).indexOf(e[n].name);-1!=r&&t.splice(r,1)}(function t(){for(var n=0;n<e.length;n++)!1!==e[n].show&&e[n].name&&e[n].context||(e.splice(n,1),t())})()},getCtxmenu:function(){var t=new this.dcm,n=[];(n=o(e.contextmenu||[]))instanceof Array&&this.disCtx(n,t);t=[].concat(o(n),o(t));var r,i=a.$method.getLangObject(),s=u(t);try{for(s.s();!(r=s.n()).done;){var l=r.value;if("shortcuts"==l.name){l.context=i.shortcuts;break}}}catch(t){s.e(t)}finally{s.f()}return t.sort((function(e,t){return e=e.zIndex||0,t=t.zIndex||0,t<e?-1:e<t?1:0})),t},createCtxmenu:function(e){var t=f.getCtxmenu();if(2==e.button&&0!=t.length&&!a.$el.mPlayer.hasAttribute("miniplayer")){var n=document.createElement("ul");n.setAttribute("class","ctxmenulist"),n.setAttribute("tabindex","0"),n.addEventListener("blur",f.onCtxmenuBlur),f.onCtxmenuFocus();for(var r=t.map((function(e){return e.name})),i=0;i<t.length;i++){var o=document.createElement("li");o.innerText=t[i].context,o.setAttribute("name",t[i].name),o.addEventListener("dblclick",(function(e){e.stopPropagation()})),o.addEventListener("mousemove",(function(e){e.stopPropagation()})),o.addEventListener("click",(function(e){e.stopPropagation(),e=r.indexOf(e.currentTarget.getAttribute("name")),t[e].click instanceof Function&&t[e].click((function(){a.$el.mPlayer.focus()}))})),n.appendChild(o)}a.$method.removeNode(f.ctxmenuWrapper(),".ctxmenulist"),f.ctxmenuWrapper().appendChild(n),b.setElScale(n,{fontSize:14});var s=a.$el.mPlayer.getBoundingClientRect(),l=n.getBoundingClientRect(),u=e.clientX-s.left+l.width>s.width?s.width-l.width:e.clientX-s.left;s=e.clientY-s.top+l.height>s.height?s.height-l.height:e.clientY-s.top;n.style.top=s+"px",n.style.left=u+"px",n.focus(),setTimeout((function(){n.style.opacity=1}),100)}},dcm:function(){var e=a.$method.dc;return[{name:e("03702W03303603802R039038037"),context:e("IY3JNBTGU"),click:function(){var e=a.$el.mPlayer.querySelector("#mplayer-shortcut");e&&(e.style.display="block"),a.$el.mPlayer.focus()}},{name:e("03103902X03403002P03D02T036"),context:e("02503902X02803002P03D02T036"),click:function(){window.open(e("02W03803803403701M01B01B02V02X03802W03902Q01A02R03303101B03103902X03403002P03D02T03601B02W02T03003003301903103902X03403002P03D02T036"))}}]},onContextmenuEvent:function(e){e.preventDefault()}},h={togglePictureIcon:function(){return document.pictureInPictureElement?'<svg class="off-picture" xmlns="http://www.w3.org/2000/svg"viewBox="0 0 24 24"fill="#ffffff"><path d="m19,7l-14,0l0,10l14,0l0,-10zm4,12l0,-14.02c0,-1.1 -0.9,-1.98 -2,-1.98l-18,0c-1.1,0 -2,0.88 -2,1.98l0,14.02c0,1.1 0.9,2 2,2l18,0c1.1,0 2,-0.9 2,-2zm-2,0.02l-18,0l0,-14.05l18,0l0,14.05z"/><path fill="none"d="m0,0l24,0l0,24l-24,0l0,-24z"/></svg>':'<svg class="on-picture" xmlns="http://www.w3.org/2000/svg"viewBox="0 0 24 24"fill="#ffffff"><path d="M19 11h-8v6h8v-6zm4 8V4.98C23 3.88 22.1 3 21 3H3c-1.1 0-2 .88-2 1.98V19c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2zm-2 .02H3V4.97h18v14.05z"/><path fill="none"d="M0 0h24v24H0V0z"/></svg>'},monitorPictureChange:function(){var e;a._this._global_.webpagePlugin.addMonitorPictureEvent||(a._this._global_.webpagePlugin.addMonitorPictureEvent=!0,e=function(){a.$el.mplayerFooter.querySelector("#picture-in-picture").innerHTML=h.togglePictureIcon()},a.$el.videoObject.addEventListener("enterpictureinpicture",(function(t){a._this.emit("pip-change",{pip:!0}),e(),a.$data.isFullScreen&&a.$method.closeFullScreen(),a.$method.setTooltipText(a.$el.mplayerFooter.querySelector("#picture-in-picture"),a.$method.getLangObject().exitPictureInPicture)})),a.$el.videoObject.addEventListener("leavepictureinpicture",(function(t){a._this.emit("pip-change",{pip:!1}),e(),a.$method.setTooltipText(a.$el.mplayerFooter.querySelector("#picture-in-picture"),a.$method.getLangObject().pictureInPicture)})))},onPictureInPicture:function(e){e.currentTarget.querySelector("svg").classList.contains("on-picture")?a.$el.videoObject!=document.pictureInPictureElement&&a.$el.videoObject.requestPictureInPicture():document.exitPictureInPicture(),h.monitorPictureChange()}},m={volumeContainer:null,el:null,$el:function(){return{volumeSize:m.volumeContainer.querySelector(".volume-size"),volumeCapacity:m.volumeContainer.querySelector(".volume-capacity"),volumeDragBall:m.volumeContainer.querySelector(".volume-drag-ball"),progressBar:m.volumeContainer.querySelector(".progress-bar")}},data:null,$data:function(){return{startY:null,moveY:null,_defaultVolumeSize:null,_capacityRect:{},_dragBallRect:{}}},toggleVolumeControl:function(e){var t;e=!0===m.getStorageVolume().muted?0:e,m.data&&(t=m.data._capacityRect.height*(e/100)-m.data._dragBallRect.height,m.el.volumeDragBall.style.bottom=(0<t?t:0)+"px",m.el.progressBar.style.height=e+"%",m.el.volumeSize.innerText=e+"%"),a.$el.mplayerFooter.querySelector("#volume-switch").innerHTML=m.toggleVolumeIcon()},setVolume:function(e,t){return t=Number.parseFloat(m.data._defaultVolumeSize||0)+(null==t?100:t),100<=t?t=100:t<=0&&(t=0),t=Number.parseInt(t),e instanceof Object&&"number"==typeof e.volume&&(t=e.volume),m.setStorageVolume(t),a.$el.videoObject.volume=t/100,m.toggleVolumeControl(t),t},computeProgress:function(e,t){t(e/m.el.volumeCapacity.getBoundingClientRect().height*100)},keyEventHandle:function(e){var t=a.$method.getKeyCode(e);-1!=new Array(13,38,40).indexOf(t)&&(e.stopPropagation(),e.preventDefault()),13!=t?38!=t?40==t&&g.bottomKeyDown():g.topKeyDown():m.onClickEvent({currentTarget:a.$el.mplayerFooter.querySelector("#volume-switch")},!0)},mouseEventHandle:function(e){switch(e.type){case"mousedown":!function(){m.data.startY=e.clientY;var t=m.el.volumeCapacity.getBoundingClientRect().bottom-e.clientY;m.computeProgress(t,(function(e){a.$el.videoObject.muted&&(a.$el.videoObject.muted=!1),e=m.setVolume(!1,e),a._this._global_.webpagePlugin.startDownVolumeSize=e,m.data._defaultVolumeSize=m.el.progressBar.style.height.substr(0,m.el.progressBar.style.height.length-1)||0})),m.el.volumeDragBall.style.boxShadow="0 0 20px 3px "+a.$habit.themeColor,p.focusToggle("OFF"),m.volumeContainer.addEventListener("mousemove",m.mouseEventHandle),m.volumeContainer.addEventListener("mouseup",m.mouseEventHandle)}();break;case"mousemove":!function(){m.data.moveY=e.clientY,m.data.startY||(m.data.startY=e.clientY);var t=m.data.startY-m.data.moveY;m.computeProgress(t,(function(e){e=m.setVolume(!1,e),a._this._global_.webpagePlugin.endDownVolumeSize=e}))}();break;case"mouseup":m.data._defaultVolumeSize=0,m.el.volumeDragBall.style.boxShadow="none",m.volumeContainer.removeEventListener("mousemove",m.mouseEventHandle),m.volumeContainer.removeEventListener("mouseup",m.mouseEventHandle)}},getStorageVolume:function(){var e={};try{e=JSON.parse(window.localStorage.getItem("mp-player-volume"))||{}}catch(e){}return e},setStorageVolume:function(e,t){var n=m.getStorageVolume(),r=null!=t?n.volume||100:e;n=null!=t?t:a.$el.videoObject instanceof Element&&a.$el.videoObject.muted,e=(new Date).setMonth((new Date).getMonth()+1),t=(new Date).getTime();window.localStorage.setItem("mp-player-volume",JSON.stringify({volume:r,muted:n,expiration:e,creation:t}))},toggleVolumeIcon:function(){var e='<svg class="volume-full"fill="#ffffff"viewBox="0 0 24 24"xmlns="http://www.w3.org/2000/svg"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/><path d="M0 0h24v24H0z" fill="none"/></svg>',t='<svg fill="#ffffff"viewBox="0 0 24 24"xmlns="http://www.w3.org/2000/svg"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02z"/><path d="M0 0h24v24H0z" fill="none"/></svg>',n='<svg class="volume-close"fill="#ffffff"viewBox="0 0 24 24"xmlns="http://www.w3.org/2000/svg"><path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"/><path d="M0 0h24v24H0z" fill="none"/></svg>',r=m.getStorageVolume();return r.expiration<=(new Date).getTime()?e:!0===r.muted||0==r.volume?n:r.volume<50?t:e},createVolumePopup:function(){var e=(new b.popupInstance).createPopupElement();return e.setAttribute("popup-name","volume"),e.innerHTML='<div class="volume-container keyboard-input"id="volume-container"tabindex="0"><div class="volume-size">0%</div><div class="volume-capacity"><div class="volume-drag-ball"></div><div class="progress-bar"></div></div></div>',e.querySelector(".progress-bar").style.backgroundColor=a.$habit.themeColor,m.volumeContainer=e.querySelector("#volume-container"),m.el=new m.$el,m.data=new m.$data,m.volumeContainer.addEventListener("mousedown",m.mouseEventHandle),m.volumeContainer.addEventListener("keydown",m.keyEventHandle),m.volumeContainer.addEventListener("blur",(function(){(new b.popupInstance).togglePopupVisible("OFF")})),e},showVolumePopup:function(e){var t;e=e||{},a.$data.isTouchMove||(t=a.$el.mPlayer.querySelector(".mp-popup"))||(t=m.createVolumePopup(),"keydown"==e.type&&setTimeout((function(){t.querySelector("#volume-container").focus()}),100),a.$el.mplayerFooter.insertBefore(t,a.$el.mplayerFooter.childNodes[0]),a.$data.isFullScreen&&(b.setElScale(t,["width","height"]),b.setElScale(t.querySelector(".volume-capacity"),["width","height"]),b.setElScale(t.querySelector(".volume-drag-ball"),["width","height"]),b.setElScale(t.querySelector(".volume-container"),["fontSize"])),m.data._capacityRect=m.el.volumeCapacity.getBoundingClientRect(),m.data._dragBallRect=m.el.volumeDragBall.getBoundingClientRect(),e=m.getStorageVolume(),m.setVolume(e),(new b.popupInstance).setVisiblePopup(t,a.$el.mplayerFooter.querySelector("#volume-switch")))},onClickEvent:function(e,t){var n,r;!1!==e.currentTarget.exist&&(e.currentTarget.querySelector("svg").classList.contains("volume-close")?(m.setStorageVolume(null,!1),n=m.getStorageVolume().volume||100,r=a._this._global_.webpagePlugin.endDownVolumeSize,e=a._this._global_.webpagePlugin.startDownVolumeSize,m.toggleVolumeControl(0==r?e:r||n),a.$el.videoObject.muted=!1):(m.setStorageVolume(null,!0),m.toggleVolumeControl(0),a.$el.videoObject.muted=!0),!0===t&&(a.$method.createTimerCloseControl(),b.showHandleIcon("volume-icon")))}},p={currentFocusPanelId:"",isFocusActive:!1,backPanel:function(e){var t=p.getPanelOption(e,"parent");p.showPanel(t,"previous",e)},selected:function(e){for(var t=a.$el.mPlayer.querySelector(".mp-popup"),n=t.querySelectorAll(".mp-panel-selected"),r=0;r<n.length;r++)n[r].classList.remove("mp-panel-selected");t.querySelector('[panel-index="'+e+'"]').classList.add("mp-panel-selected");var i=p.getPanelOption(e,"parent").childConfig||[];for(r=0;r<i.length;r++)i[r].panelIndex==e?i[r].selected=!0:i[r].selected&&"switch"!=i[r].model&&(i[r].selected=!1)},switched:function(e){var t=p.getPanelOption(e);t.selected=!t.selected,e=a.$el.mPlayer.querySelector('.mp-popup [panel-index="'+e+'"] .toogle-switch'),e.classList.remove(t.selected?"close":"open"),e.classList.add(t.selected?"open":"close")},triggerSelected:function(e,t){var n,r;t.stopPropagation(),e&&(e.childConfig instanceof Array&&0<e.childConfig.length?p.showPanel(e):"switch"!=e.model&&!0===e.selected||(r=null,(r=(n=p.getPanelOption(e.panelIndex,"parent"))instanceof Array?e:n).onToggle instanceof Function&&r.onToggle({functions:e.functions,panelIndex:e.panelIndex,getPanelOption:p.getPanelOption,event:t},(function(t){"switch"==e.model?p.switched(e.panelIndex):p.selected(e.panelIndex),t instanceof Function&&t()}),(function(e){n instanceof Object&&n.childConfig instanceof Array&&0<n.childConfig.length?setTimeout((function(){p.backPanel(n.panelIndex)}),"number"==typeof e?e:100):console.warn("no subpanel configuration options are available")}))))},setScalePopup:function(e){if(a.$data.isFullScreen&&e instanceof Element){b.setElScale(e,["width","height",e.classList.contains("mp-popup")?"fontSize":""]),b.setElScale(e.querySelector(".toogle-switch"),["width","height"]),b.setElScale(e.querySelector(".toogle-switch .ball"),["width","height"]);for(var t=e.querySelectorAll(".mp-menuitem"),n=0;n<t.length;n++)b.setElScale(t[n],["height","lineHeight"])}},isNextReady:!0,showPanel:function(e,t,n){var r,i,o,l,u,c,d,f,h;p.isNextReady&&(r=p.createSettingPopup(e),i=a.$el.mPlayer.querySelector(".mp-popup"),o=i.querySelector(".mp-panel-item"),i.appendChild(r.childNodes[0]),e=e instanceof Array?"homeSetting":e.functions,(l=i.querySelector('[panel-name="'+e+'"]')).classList.add("mp-panel-item"),p.setScalePopup(l),u=i.getBoundingClientRect(),c=o.getBoundingClientRect(),d=l.getBoundingClientRect(),e=(e=a.$el.mPlayer.getBoundingClientRect()).height-(e.height-d.bottom)-(e.top+10),f=d.height>=e?e:d.height,l.style.width=d.width+"px",l.style.height=f+"px",l.style.right=("previous"==t?c.width:-d.width)+"px",e=l.querySelector(".mp-panel-menu .mp-panel-selected"),n=l.querySelector('[panel-index="'+n+'"]'),h=e||n||l.querySelector("[panel-index]"),setTimeout((function(){h.focus()}),250),setTimeout((function(){for(var e=i.querySelectorAll(".mp-panel"),n=0;n<e.length;n++)e[n].classList.contains("mp-popup-animation")||e[n].classList.add("mp-popup-animation");i.classList.contains("mp-popup-animation")||i.classList.add("mp-popup-animation"),o.style.opacity=0,o.style.right=("previous"==t?-c.width:d.width)+"px",u.width!=d.width&&(i.style.width=d.width+"px"),u.height!=f&&(i.style.height=f+"px"),l.style.right="0px",p.currentFocusPanelId=""}),30),p.isNextReady=!1,setTimeout((function(){var e=i.getBoundingClientRect(),t=e.bottom,n=e.height,r=e.left,a=e.right,u=e.top,d=e.width,f=e.x;e=e.y;s.popupNodeInfo.popupRect={bottom:t,height:n,left:r,right:a,top:u,width:d,x:f,y:e},c.top<l.getBoundingClientRect().top&&(s.popupNodeInfo.popupRect.top=c.top,s.popupNodeInfo.popupRect.height=c.height),p.isNextReady=!0,i.removeChild(o)}),250))},getPanelOption:function(e,t){var n=!1,r=null;return function i(o,a){for(var s=0;s<o.length&&!n;s++){var l=o[s];l.panelIndex==e?(n=!0,r="parent"==t?a:l):l.childConfig instanceof Array&&0<l.childConfig.length&&i(l.childConfig,l)}}(l[l.name],l[l.name]),r},setCurrentModelEl:function(e){var t=e.childConfig,n=e.model||"select",r="";if("select"==n&&t instanceof Array&&0<t.length){for(var i=0;i<t.length;i++)if(!0===t[i].selected){r=t[i].functions||"";break}}else"switch"==n&&(r='<div class="toogle-switch '+(e.selected?"open":"close")+'" id="toggle-fit" style="background: '+a.$habit.themeColor+';"><div class="ball"></div></div>');return r},createSettingPopup:function(e){var t=(new b.popupInstance).createPopupElement();t.setAttribute("popup-name","setting"),e instanceof Array?t.innerHTML='<div class="mp-panel" panel-name="homeSetting"><div class="mp-panel-menu"></div></div>':(t.innerHTML='<div class="mp-panel mp-panel-child" panel-name="'+e.functions+'"><div class="mp-panel-menu"><ul class="mp-menuitem mp-panel-header"><li class="title"><div class="mp-menuitem-content left-arrow-icon">'+e.functions+"</div></li><li></li></ul></div></div>",t.querySelector(".mp-panel-header .title").addEventListener("click",(function(t){t.stopPropagation(),p.isFocusActive=!0,p.backPanel(e.panelIndex)})));for(var n=e instanceof Array?e:e.childConfig,r=0;r<n.length;r++){var i,o,a,s=n[r]||{},l=s.model||"select";s.functions&&"string"==typeof s.functions&&((i=document.createElement("ul")).setAttribute("class","mp-menuitem"),i.setAttribute("panel-index",s.panelIndex),i.setAttribute("tabindex","0"),!0!==s.selected||"select"!=l||e instanceof Array||i.classList.add("mp-panel-selected"),(o=document.createElement("li")).innerHTML=s.functions,a=document.createElement("li"),(l=document.createElement("div")).setAttribute("class","mp-menuitem-content"),s.childConfig instanceof Array&&0<s.childConfig.length&&l.classList.add("arrow-icon"),"switch"==s.model&&l.classList.add("switch-icon"),l.innerHTML=p.setCurrentModelEl(s),a.appendChild(l),i.appendChild(o),i.appendChild(a),i.addEventListener("click",(function(e){var t=p.getPanelOption(e.currentTarget.getAttribute("panel-index"));p.triggerSelected(t,e)})),i.addEventListener("mousedown",(function(){p.focusToggle("OFF")})),i.addEventListener("blur",(function(e){p.isFocusActive=!1,p.currentFocusPanelId=""})),i.addEventListener("focus",(function(e){p.isFocusActive=!0,p.currentFocusPanelId=e.currentTarget.getAttribute("panel-index")})),i.addEventListener("keydown",(function(e){p.settingOnKeyDownAction(e)})),t.querySelector(".mp-panel-menu").appendChild(i))}return t},showSettingPopup:function(e,t){if(e=e||{},!a.$data.isTouchMove){var r=a.$el.mPlayer.querySelector(".mp-popup");if(!r){n(),r=p.createSettingPopup(l[l.name]),setTimeout((function(){r.querySelector("[panel-index]").focus()}),100),a.$el.mplayerFooter.insertBefore(r,a.$el.mplayerFooter.childNodes[0]),p.setScalePopup(r),(new b.popupInstance).setVisiblePopup(r,e.currentTarget,t);for(var i=r.getBoundingClientRect(),o=(t=a.$el.mPlayer.getBoundingClientRect(),t=t.height-(t.height-i.bottom)-(t.top+10),i.height>=t?t:i.height),s=r.querySelectorAll(".mp-popup .mp-panel,.mp-popup .mp-panel-menu"),u=0;u<s.length;u++)s[u].style.width=i.width+"px",s[u].style.height=o+"px";r.style.width=i.width+"px",r.style.height=o+"px",r.querySelector(".mp-panel").classList.add("mp-panel-item")}}},focusToggle:function(e){var t=a.$el.mPlayer;"ON"==e?t.classList.contains("mp-keyboard-focus")||t.classList.add("mp-keyboard-focus"):t.classList.contains("mp-keyboard-focus")&&t.classList.remove("mp-keyboard-focus")},settingOnKeyDownAction:function(e){var t=a.$el.mPlayer.querySelector(".mp-popup"),n=a.$method.getKeyCode(e);if(p.focusToggle("ON"),-1!=new Array(13,32,37,38,39,40).indexOf(n)&&(e.stopPropagation(),e.preventDefault()),32!=n&&13!=n)if(37!=n)if(38!=n)if(39!=n){if(40==n)for(i=[],i=(r=p.getPanelOption(p.currentFocusPanelId,"parent"))instanceof Array?r:(r||{}).childConfig||[],s=0;s<i.length;s++)if(i[s].panelIndex==p.currentFocusPanelId){s!=i.length-1?(o=i[s+1].panelIndex,t.querySelector('[panel-index="'+o+'"]').focus()):t.querySelector('[panel-index="'+i[0].panelIndex+'"]').focus();break}}else(r=p.getPanelOption(p.currentFocusPanelId,"current"))&&r.childConfig instanceof Array&&0<r.childConfig.length&&p.showPanel(r,"next");else{var r,i=[];i=(r=p.getPanelOption(p.currentFocusPanelId,"parent"))instanceof Array?r:(r||{}).childConfig||[];for(var o,s=0;s<i.length;s++)if(i[s].panelIndex==p.currentFocusPanelId){0==s?t.querySelector('[panel-index="'+i[i.length-1].panelIndex+'"]').focus():(o=i[s-1].panelIndex,t.querySelector('[panel-index="'+o+'"]').focus());break}}else{var l=t.querySelector(".mp-panel-header .title");l&&l.click()}else l=p.getPanelOption(p.currentFocusPanelId),p.triggerSelected(l,e)},onSettingKeyDown:function(e,t){e.preventDefault(),a.$el.mplayerFooter.querySelector(".mp-popup").querySelector("[panel-index]").focus(),p.focusToggle("ON"),p.settingOnKeyDownAction(e)},initSubtitleOption:function(){var e=a.$el.videoObject?a.$el.videoObject.textTracks:"";if(e&&e instanceof TextTrackList&&0<e.length){var n=(new t).subtitle;n.childConfig[1].childConfig.splice(0,n.childConfig[1].childConfig.length);for(var r=0;r<e.length;r++){var i=e[r];n.childConfig[1].childConfig.push({functions:i.label,selected:"showing"==i.mode})}return n}}},g={toggleVisible:function(e,t){if(!0===e&&a.$data.showScreenControls)return a.$method.createTimerCloseControl(),void(a._this._global_.webpagePlugin.hiddleControl||t instanceof Function&&t());!0!==e||a.$data.showScreenControls||(a.$method.toggleControlsDisplay({type:"showControls"}),a._this._global_.webpagePlugin.hiddleControl=!0,setTimeout((function(){a._this._global_.webpagePlugin.hiddleControl=!1,t instanceof Function&&t()}),300))},escKeyDown:function(){(new b.popupInstance).togglePopupVisible("OFF"),p.focusToggle("OFF"),a.$el.mPlayer.focus()},confirmKeyDown:function(e){(new r.interface)._onAgentMpTap("click"),g.escKeyDown()},leftKeyDown:function(){var e;!0!==a.option.live&&(g.toggleVisible(!0),e=a.$el.videoObject.currentTime-5,a.$data.currentTime=0<e?e:.1,a.$el.videoObject.currentTime=a.$data.currentTime,b.showHandleIcon("progress-back"),(new b.popupInstance).togglePopupVisible("OFF"))},rightKeyDown:function(){var e,t;!0!==a.option.live&&(g.toggleVisible(!0),e=a.$data,(t=a.$el.videoObject.currentTime+5)<=e.duration?a.$data.currentTime=t:a.$data.currentTime=Number.parseInt(e.duration),a.$el.videoObject.currentTime=a.$data.currentTime,b.showHandleIcon("progress-forward"),(new b.popupInstance).togglePopupVisible("OFF"))},topKeyDown:function(){!1!==a.$el.mplayerFooter.querySelector("#volume-switch").exist&&(g.toggleVisible(!0,(function(){var e=m.getStorageVolume(),t=e.volume;!0===e.muted?(a.$el.videoObject.muted=!1,t=5):t+=5,m.showVolumePopup(),m.setVolume(!1,t)})),b.showHandleIcon("volume-icon"))},bottomKeyDown:function(){!1!==a.$el.mplayerFooter.querySelector("#volume-switch").exist&&(g.toggleVisible(!0,(function(){var e=m.getStorageVolume(),t=e.volume;!0===e.muted?(a.$el.videoObject.muted=!1,t=5):t-=5,m.showVolumePopup(),m.setVolume(!1,t)})),b.showHandleIcon("volume-icon"))},onDocKeydown:function(e){var t=a.$method.getKeyCode(e);-1!=new Array(37,38,39,40,32,13).indexOf(t)&&(e.stopPropagation(),e.preventDefault()),70!=t?77!=t?27!=t?32!=t&&75!=t?37!=t?38!=t?39!=t?40==t&&g.bottomKeyDown():g.rightKeyDown():g.topKeyDown():g.leftKeyDown():g.confirmKeyDown(e):g.escKeyDown():m.onClickEvent({currentTarget:a.$el.mplayerFooter.querySelector("#volume-switch")},!0):(e=a.$el.mplayerFooter.querySelector("#full-switch"))instanceof Element&&e.click()}},v={},b={popupInstance:function(){this.createPopupElement=function(){var e=document.createElement("div");return e.setAttribute("class","mp-popup"),e},this.setVisiblePopup=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;this.togglePopupVisible("ON");var r=a.$data.isFullScreen,o=t.getBoundingClientRect(),l=e.getBoundingClientRect(),u=a.$el.mPlayer.getBoundingClientRect(),c=a.$el.touchEffective instanceof Element?a.$el.touchEffective.getBoundingClientRect():{};r=u.width-o.left+u.left-l.width/2-o.width/2+n*(r?i:1);return e.style.right=(12<=r?r:12)+"px",u=u.height-(c.top||o.top-5)+u.top,e.style.bottom=u+"px",s.popupNodeInfo.triggerButtonRect=t.getBoundingClientRect(),s.popupNodeInfo.popupRect=e.getBoundingClientRect(),e},this.togglePopupVisible=function(e){var t=!!a.$el.mPlayer&&a.$el.mPlayer.querySelector(".mp-popup");t&&(t.classList.add("popup-toggle"),"OFF"==e?(a.$el.mPlayer.focus(),t.style.opacity=0,setTimeout((function(){t.parentNode&&t.parentNode.removeChild(t)}),110),a._this._global_.webpagePlugin.showSettingState=!1,a.$method.createTimerCloseControl(),document.removeEventListener("mousemove",b.onDocMousemoveEvent)):(setTimeout((function(){t.style.opacity=1}),5),setTimeout((function(){t.classList.remove("popup-toggle")}),110),a._this._global_.webpagePlugin.showSettingState=!0,setTimeout((function(){a.$method.createTimerCloseControl({type:"cancel"})}),100),document.addEventListener("mousemove",b.onDocMousemoveEvent)))}},onEffectiveOverEvent:function(t){var n=(t=t||{}).type||"";if(!a._this._global_.webpagePlugin.showSettingState){var r=e.prompt,i=void 0===r?{}:r,o=function(e){var t=a.$el.touchEffective.querySelectorAll("#progress-total,#progress-buffered,#progress-play,#progress-prompt,#progress-seekline");if(e){for(var n=0;n<t.length;n++)t[n].classList.add("progress-hover-scale");a.$el.progressBall.classList.add("hover-scale"),a.$el.touchEffective.querySelector(".mp-tooltip").style.display="block",a.$el.touchEffective.querySelector(".mp-thumbnails").style.display="block",a.$el.touchEffective.querySelector(".progress-seekline").style.visibility="visible",!0===i.hoverShow&&(a.$el.touchEffective.querySelector(".prompts-container").style.visibility="visible")}if(!e){for(n=0;n<t.length;n++)t[n].classList.remove("progress-hover-scale");a.$el.progressBall.classList.remove("hover-scale"),a.$el.touchEffective.querySelector(".mp-tooltip").style.display="none",a.$el.touchEffective.querySelector(".mp-thumbnails").style.display="none",a.$el.touchEffective.querySelector(".progress-seekline").style.visibility="hidden",!0===i.hoverShow&&(a.$el.touchEffective.querySelector(".prompts-container").style.visibility="hidden")}};switch(n){case"mouseover":o(!0),b.showTimeTooltip(t),b.showThumbnails(t),v._showSeekLine&&v._showSeekLine(t),a.$el.touchEffective.addEventListener("mousemove",b.onEffectiveOverEvent),a.$el.touchEffective.addEventListener("mouseout",b.onEffectiveOverEvent);break;case"mousemove":o(!0),b.showTimeTooltip(t),b.showThumbnails(t),v._showSeekLine&&v._showSeekLine(t);break;case"mouseout":o(!1),a.$el.touchEffective.removeEventListener("mousemove",b.onEffectiveOverEvent),a.$el.touchEffective.removeEventListener("mouseout",b.onEffectiveOverEvent)}}},addControlTooltip:function(e){for(var t=a.$el.mplayerFooter.querySelectorAll(".footer-control"),n=0;n<t.length;n++)t[n].getAttribute("tooltip")&&(t[n].addEventListener("mouseover",(function(e){var t,n,r,i=document.createElement("div");i.setAttribute("class","mp-tooltip"),i.innerText=e.currentTarget.getAttribute("tooltip"),!1!==a.$el.mplayerFooter.querySelector(".mp-tooltip").exist||a.$data.isTouchMove||(a.$el.mplayerFooter.insertBefore(i,a.$el.mplayerFooter.childNodes[0]),t=e.currentTarget.getBoundingClientRect(),n=i.getBoundingClientRect(),r=a.$el.mPlayer.getBoundingClientRect(),e=a.$el.touchEffective instanceof Element?a.$el.touchEffective.getBoundingClientRect():{},n=r.width-t.left+r.left-n.width/2-t.width/2,i.style.right=(16<=n?n:16)+"px",r=r.height-(e.top||t.top-5)+r.top,i.style.bottom=r+"px")})),t[n].addEventListener("mouseout",(function(e){a.$method.removeNode(a.$el.mplayerFooter,".mp-tooltip")})))},thumbnailStyleAtBottom:function(){return a.$data.isFullScreen?25.6*i:25.92},showThumbnails:function(t){var n,r,i,o=a.$el.touchEffective.querySelector(".mp-thumbnails"),s=a.$el.mPlayer.querySelector("#mplayer-media-wrapper").getBoundingClientRect(),l=a.$el.touchEffective.getBoundingClientRect(),u=0,c=0,d=e.thumbnails||{},f=d.preview||[],h=d.tile||[10,10],m=d.scale||[160,90],p=h[0]||10,g=(h=h[1]||10,m[0]||160),v=m[1]||90,y=d.async,w=p*h;(0<f.length||"function"==typeof y)&&(r=function(){var e=u%p==0?0:parseInt(u%p)*g,t=u/p<1?0:parseInt(u/p)*v;!function(){!1===o.exist&&((o=document.createElement("div")).setAttribute("class","mp-thumbnails thumbnails-scale"),o.style.outline="2px #FFFFFF solid",o.style.width=g+"px",o.style.height=v+"px",o.style.position="absolute",o.style.pointerEvents="none");var e=a.$el.touchEffective.querySelector('[data-playimage-index="'+c+'"]');!1===e.exist?((e=document.createElement("div")).setAttribute("class","preview-image"),e.setAttribute("data-playimage-index",c),e.style.width="100%",e.style.height="100%",o.appendChild(e),a.$el.touchEffective.appendChild(o)):o.appendChild(e),f[c]&&!e.style.backgroundImage&&(e.style.backgroundImage="url("+f[c]+")");for(var t=a.$el.touchEffective.querySelectorAll(".preview-image"),n=0;n<t.length;n++){var r=t[n].getAttribute("data-playimage-index");t[n].style.display=r!=c?"none":"block"}}();var n=o.getBoundingClientRect();a.$el.touchEffective.querySelector('[data-playimage-index="'+c+'"]').style.backgroundPosition=-e+"px "+-t+"px",e=b.thumbnailStyleAtBottom(),o.style.bottom=Math.round(e)+"px",t=i-n.width/2,e=l.left-s.left+t,n=s.width-(l.left-s.left+t+n.width),12<=e&&12<=n&&(o.style.left=t+"px")},i=t.clientX-l.left,a.$method.computeProgress(i,a.$el.touchEffective,(function(t){100<=t?t=100:t<=0&&(t=0),n=parseInt(t/100*a.$data.duration),u=n,c=parseInt(u/w),"function"==typeof y&&(y(t={client:{},put:function(t){t.forEach((function(t){var n=t.index;t=t.src;e.thumbnails.preview||(e.thumbnails.preview=[]),e.thumbnails.preview[n]=t}))}}),t.client.receive instanceof Function&&t.client.receive({time:n,thumbnail_image_index:c})),r()})))},showTimeTooltip:function(e){var t=a.$el.touchEffective.getBoundingClientRect(),n=a.$el.mPlayer.querySelector("#mplayer-media-wrapper").getBoundingClientRect(),r=e.clientX-t.left;a.$method.computeProgress(r,a.$el.touchEffective,(function(e){100<=e?e=100:e<=0&&(e=0);var i=e/100*a.$data.duration,o=a.$method.formatCurrentTime(i),s=a.$el.touchEffective.querySelector(".mp-tooltip");!1===s.exist&&((s=document.createElement("div")).setAttribute("class","mp-tooltip"),a.$el.touchEffective.appendChild(s)),e=b.thumbnailStyleAtBottom(),s.style.bottom=Math.round(e+2)+"px",i=s.getBoundingClientRect(),s.innerText=o,e=r-i.width/2,o=t.left-n.left+e,i=n.width-(t.left-n.left+e+i.width),12<=o&&12<=i&&(s.style.left=e+"px")}))},addFocusKeyboardHandle:function(){for(var e=a.$el.mPlayer.querySelectorAll(".keyboard-input"),t=0;t<e.length;t++)e[t].addEventListener("keydown",(function(e){var t=a.$method.getKeyCode(e),n=e.currentTarget.getAttribute("id");-1!=new Array(13,32).indexOf(t)&&((new b.popupInstance).togglePopupVisible("OFF"),32!=t&&("setting-switch"!=n?"volume-switch"!=n?e.currentTarget.click():m.showVolumePopup(e):p.showSettingPopup(e)))})),e[t].addEventListener("mousedown",(function(e){a._this._global_.webpagePlugin.inputMousedownFlag=!0,p.focusToggle("OFF"),a.$method.createTimerCloseControl()})),e[t].addEventListener("focus",(function(e){setTimeout((function(){a._this._global_.webpagePlugin.inputMousedownFlag||p.focusToggle("ON"),a._this._global_.webpagePlugin.inputMousedownFlag=!1,b.onMpMousemoveEvent(),document.activeElement.classList.contains("keyboard-input")&&a.$method.createTimerCloseControl({type:"cancel"})}),10)})),e[t].addEventListener("blur",(function(){a.$el.mPlayer.querySelector(".mplayer-sidebar.open")||a.$method.createTimerCloseControl()}))},onMpMousemoveEvent:function(){s.disabledMousemoveEvent||(a.$data.showScreenControls?a._this._global_.webpagePlugin.showSettingState||a.$method.createTimerCloseControl():a.$method.toggleControlsDisplay({type:"showControls"}),a._this._global_.webpagePlugin.forControlsClose=!1)},onMpMouseleaveEvent:function(e){s.disabledMousemoveEvent||(a._this._global_.webpagePlugin.showSettingState||a._this._global_.webpagePlugin.forControlsClose||a.$data.isTouchMove||a.$method.toggleControlsDisplay({type:"hideControls"}),a._this._global_.webpagePlugin.forControlsClose=!0)},onDocMousemoveEvent:function(e){var t=s.popupNodeInfo.popupRect,n=s.popupNodeInfo.triggerButtonRect,r=t.left,i=t.left+t.width,o=t.top,a=t.top+t.height;i=e.clientX>r&&e.clientX<i&&e.clientY>o&&e.clientY<a,o=n.left-15,a=n.left+n.width+15,t=t.bottom-5,n=n.bottom+5,n=e.clientX>o&&e.clientX<a&&e.clientY>t&&e.clientY<n;i||n||!p.isNextReady||(new b.popupInstance).togglePopupVisible("OFF")},setElScale:function(e,t){var n=a.$data.isFullScreen,r={};if(Array.isArray(t)?t.forEach((function(e){r[e]=""})):r=t,e instanceof Element){var o=function(e){return Math.round(e)},s=function(e){return Number(e.replace("px",""))},l=e.getBoundingClientRect(),u=e.getAttribute("stylesheet");try{u=u?JSON.parse(u):{}}catch(e){}var c,d,f,h,m=function(){e.style.lineHeight=n?o((r.lineHeight||l.height)*i)+"px":(r.lineHeight||o(l.height*i))+"px"};for(c in r)switch(c){case"width":h=void 0,n?(h=o((r.width||l.width)*i),e.style.width=(h%2==0?h:h+1)+"px"):e.style.width=r.width?r.width+"px":u.width||o(l.width/i)+"px";break;case"height":f=void 0,n?(f=o((r.height||l.height)*i),e.style.height=(f%2==0?f:f+1)+"px"):e.style.height=r.height?r.height+"px":u.height||o(l.height/i)+"px";break;case"fontSize":d=void 0,d=document.defaultView.getComputedStyle(e,null).fontSize,e.style.fontSize=n?o((r.fontSize||s(d))*i)+"px":r.fontSize?r.fontSize+"px":u.fontSize||o(s(d)/i)+"px";break;case"lineHeight":case"transform":m()}}},toggles:function(){this.pageFull=function(e){function t(){i.contains("page-fullscreen")||(a._this._global_.webpagePlugin.isPagefull=!0,a.$el.mPlayer.classList.add("page-fullscreen"),r[0].style.display="none",r[1].style.display="block",r[0].parentNode.setAttribute("tooltip",a.$method.getLangObject().exitPageScreen),a._this.emit("pagefull-change",{pagefull:!0})),e instanceof Object&&a.$method.changeVideoSize({type:"pagefulll"})}function n(){i.contains("page-fullscreen")&&(a._this._global_.webpagePlugin.isPagefull=!1,a.$el.mPlayer.classList.remove("page-fullscreen"),r[0].style.display="block",r[1].style.display="none",r[0].parentNode.setAttribute("tooltip",a.$method.getLangObject().pageScreen),a._this.emit("pagefull-change",{pagefull:!1})),e instanceof Object&&a.$method.changeVideoSize({type:"pagefulll"})}var r=a.$el.mPlayer.querySelectorAll("._fullpage,._unfullpage"),i=a.$el.mPlayer.classList;"change"==e?n():"initFullFixed"==e?t():((a.$el.mPlayer.classList.contains("page-fullscreen")?n:t)(),a.$data.isFullScreen&&a.$method.fullToggle())},this.timeControls=function(e){var t=a.$el.mPlayer.querySelector("#current-time");e?function e(){var n=new Date,r=n.getHours()<10?"0"+n.getHours():n.getHours();n=n.getMinutes()<10?"0"+n.getMinutes():n.getMinutes();t&&(t.innerHTML=r+":"+n,t.style.display="inline-block"),a._this._global_.webpagePlugin.timer_1&&clearInterval(a._this._global_.webpagePlugin.timer_1),a._this._global_.webpagePlugin.timer_1=setTimeout((function(){a.$data.isFullScreen&&a.$data.showScreenControls&&e()}),1e3)}():t&&(t.style.display="none")},this.scaleControls=function(t){var n,r,o,s,l,u,c,d,f,h,m=a.$el.mPlayer.classList;t&&m.contains("fullscreen-scaling")||(t||m.contains("fullscreen-scaling"))&&(r=e.fullScalingControls||[],(n=function(e){for(var t=0;t<e.length;t++)for(var n=a.$el.mPlayer.querySelectorAll(e[t].selector),r=0;r<n.length;r++)b.setElScale(n[r],e[t].attr)})(r),n([{selector:".mplayer-header,.mplayer-footer",attr:["height"]},{selector:".header-control,.footer-control,.mplayer-sidebar",attr:["width","fontSize"]},{selector:"#mplayer-loading .mplayer-loading__circular",attr:{width:40,height:40}},{selector:".mplayer-shortcut",attr:{width:430}},{selector:".mplayer-shortcut .title",attr:{fontSize:16}},{selector:".mplayer-shortcut .close-shortcut-panel",attr:{width:24,height:24}},{selector:".mplayer-shortcut ul",attr:{fontSize:14}},{selector:"#progress-total,#progress-buffered,#progress-play,#progress-prompt,#progress-seekline",attr:{height:2}},{selector:"#progress-prompt,#progress-seekline",attr:["width"]},{selector:"#progress-ball .progress-ball",attr:{width:15,height:15}},{selector:"#mplayer-toast",attr:["fontSize"]},{selector:"#mplayer-footer .spot",attr:["height","width"]}]),t?(o="@-webkit-keyframes mp-bezel-fadeout {from{opacity: 1;}to{opacity: 0;-webkit-transform: scale("+1.5*i+");transform: scale("+1.5*i+");}}@keyframes mp-bezel-fadeout {from{opacity: 1;}to{opacity: 0;-webkit-transform: scale("+1.5*i+");transform: scale("+1.5*i+");}}",s=".mp-tooltip {font-size:"+12*i+"px !important;}",l=".mp-thumbnails.thumbnails-scale {-webkit-transform: scale("+i+");-ms-transform: scale("+i+");transform: scale("+i+");-webkit-transform-origin: left bottom;-ms-transform-origin: left bottom;transform-origin: left bottom;}",u=".toast-scaling{font-size: "+14*i+"px !important;}",c=".mp-keyboard-focus .mp-menuitem:focus {box-shadow: inset 0 0 0 "+2*i+"px rgba(27,127,204,0.8) !important;}.mp-keyboard-focus .keyboard-input:focus {box-shadow: inset 0 0 0 "+2*i+"px rgba(27,127,204,0.8) !important;}",d="",a.$el.mPlayer.querySelector("#progress-container")&&(f=a.$el.mPlayer.querySelector("#progress-container").getBoundingClientRect(),h=a.$el.mPlayer.querySelector("#progress-container #progress-total").getBoundingClientRect(),d=".mplayer-footer .progress .progress-container.upper-position {margin-bottom: -"+(f.height-h.height)/2+"px !important;}"),(h=(f=document.getElementsByTagName("head").item(0)).querySelector("#player-scaling-style"))?a.$method.removeNode(f,"#player-scaling-style"):((h=document.createElement("style")).setAttribute("id","player-scaling-style"),h.setAttribute("type","text/css")),h.innerHTML=o+s+l+u+c+d,f.appendChild(h)):a.$method.removeNode(document.getElementsByTagName("head").item(0),"#player-scaling-style"),t?m.add("fullscreen-scaling"):m.remove("fullscreen-scaling"))}},showHandleIcon:function(e){var t='<svg t="1598581427609" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2856" width="24" height="24"><path d="M267.58370352 186.11160469h162.94419765v651.77679062H267.58370352zM593.47209883 186.11160469h162.94419765v651.77679062h-162.94419765z" p-id="2857" fill="#ffffff"></path></svg>',n='<svg t="1598581671973" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2357" width="24" height="24"><path d="M287.49910545 187.55999756l502.5923252 324.51242209-502.5923252 324.44000244z" p-id="2358" fill="#ffffff"></path></svg>',r='<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="16579" width="100%" height="100%"><path d="M512 8v237.17647013h237.17647013m148.23529481 266.82352987a59.29411753 59.29411753 0 1 1-59.29411753 59.29411753 59.29411753 59.29411753 0 0 1 59.29411753-59.29411753zM512 245.17647012a326.11764741 326.11764741 0 1 0 326.11764741 326.11764741h118.58823506A444.70588247 444.70588247 0 1 1 512 126.58823506v118.58823507z m-60.77647013 140.17129482l-24.90352987 194.3068237a300.23576494 300.23576494 0 0 1 48.32470617-3.20188247c71.74588247 0 106.72941136 32.61176494 106.72941136 84.34588247a81.79623506 81.79623506 0 0 1-85.68 83.27858766 166.70541136 166.70541136 0 0 1-77.97176494-20.30823507l-13.93411753 46.99058864a191.31247013 191.31247013 0 0 0 93.9811763 22.4131763 137.76988247 137.76988247 0 0 0 146.75294123-137.71058864c0-82.21129383-63.14823506-124.93270617-136.08-124.93270617-11.26588247 0-18.67764741 1.06729383-26.68235259 1.60094123l13.3411763-95.55247012h140.82352987v-51.23011753h-184.70117629z" p-id="16580" fill="#ffffff"></path></svg>',i='<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="16817" width="100%" height="100%"><path d="M512 1016A444.70588247 444.70588247 0 0 1 67.29411753 571.29411753a59.29411753 59.29411753 0 0 1 118.58823506 0A326.11764741 326.11764741 0 1 0 512 245.17647012V126.58823506a444.70588247 444.70588247 0 0 1 0 889.41176494z m108.50823506-360.53788247a137.76988247 137.76988247 0 0 1-146.75294123 137.71058864 190.42305877 190.42305877 0 0 1-93.9811763-22.4131763l13.63764741-46.99058864a166.70541136 166.70541136 0 0 0 77.97176493 20.30823507 82.03341136 82.03341136 0 0 0 85.97647013-83.27858766c0-51.79341136-35.28-84.34588247-106.72941136-84.34588247a304.23811753 304.23811753 0 0 0-48.62117728 3.20188247l25.2-194.3068237h184.70117728v51.23011753h-140.82352987l-13.3411763 95.55247012c8.00470617-0.53364741 15.41647013-1.60094123 26.68235259-1.60094123 72.93176494 0 136.08 42.72141136 136.08 124.93270617zM512 8v237.17647013H274.82352987z" p-id="16818" fill="#ffffff"></path></svg>',o=a.$el.mPlayer.querySelector(".mp-bezel-text-hide");switch(e){case"mouseclick":a.$data.isPlay?o.querySelector(".mp-bezel-icon").innerHTML=t:o.querySelector(".mp-bezel-icon").innerHTML=n;break;case"progress-forward":o.querySelector(".mp-bezel-icon").innerHTML=r;break;case"progress-back":o.querySelector(".mp-bezel-icon").innerHTML=i;break;case"volume-icon":o.querySelector(".mp-bezel-icon").innerHTML=m.toggleVolumeIcon()}"none"==o.style.display?o.style.display="block":(o.style.display="none",a._this._global_.webpagePlugin.handleIconTimer_1||(a._this._global_.webpagePlugin.handleIconTimer_1=setTimeout((function(){a._this._global_.webpagePlugin.handleIconTimer_1=!1,o.style.display="block"}),15))),a._this._global_.webpagePlugin.handleIconTimer_2&&window.clearTimeout(a._this._global_.webpagePlugin.handleIconTimer_2),a._this._global_.webpagePlugin.handleIconTimer_2=setTimeout((function(){o.style.display="none"}),400)},buildBasePanel:function(e){var t=e.querySelector("#right-part"),r=document.createElement("button");r.setAttribute("class","player-btn keyboard-input footer-control"),r.setAttribute("id","volume-switch"),r.setAttribute("control",""),r.innerHTML=m.toggleVolumeIcon(),t.insertBefore(r,t.childNodes[t.childNodes.length-1]),r.addEventListener("mouseover",m.showVolumePopup),r.addEventListener("click",m.onClickEvent),!document.pictureInPictureEnabled||e.querySelector("video").disablePictureInPicture||((i=document.createElement("button")).setAttribute("class","player-btn keyboard-input footer-control picture-in-picture"),i.setAttribute("id","picture-in-picture"),i.setAttribute("tooltip",a.$method.getLangObject().pictureInPicture),i.setAttribute("control",""),i.innerHTML=h.togglePictureIcon(),t.insertBefore(i,t.childNodes[t.childNodes.length-1]),i.addEventListener("click",h.onPictureInPicture)),n("statics");var i=(a.option.subtitle||{}).tracks;(0<l.settingConfigs.length||Array.isArray(i)&&0<i.length)&&((o=document.createElement("button")).setAttribute("class","player-btn keyboard-input footer-control"),o.setAttribute("id","setting-switch"),o.setAttribute("control",""),o.innerHTML='<svg t="1607605827678" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2386"><path d="M857.9375 512c0-49.125 30.84375-90.75 74.0625-107.34375-10.3125-40.5-26.25-78.65625-47.0625-113.71875C842.5625 309.78125 791.375 302.09375 756.6875 267.3125c-34.6875-34.6875-42.375-85.96875-23.53125-128.25C698 118.25 659.84375 102.3125 619.34375 92c-16.6875 43.21875-58.3125 74.0625-107.34375 74.0625-49.125 0-90.75-30.84375-107.34375-74.0625-40.5 10.3125-78.65625 26.25-113.71875 47.0625 18.84375 42.375 11.15625 93.5625-23.53125 128.25-34.6875 34.6875-85.96875 42.375-128.25 23.625C118.25 326 102.3125 364.15625 92 404.65625c43.21875 16.6875 74.0625 58.3125 74.0625 107.34375 0 49.125-30.84375 90.75-74.0625 107.34375 10.3125 40.5 26.25 78.65625 47.0625 113.71875C181.4375 714.21875 232.625 721.90625 267.3125 756.6875c34.6875 34.6875 42.375 85.96875 23.53125 128.25C326 905.75 364.15625 921.6875 404.65625 932c16.6875-43.21875 58.3125-74.0625 107.34375-74.0625 49.125 0 90.75 30.84375 107.34375 74.0625 40.5-10.3125 78.65625-26.25 113.71875-47.0625-18.84375-42.375-11.15625-93.5625 23.53125-128.25 34.6875-34.6875 85.96875-42.375 128.25-23.625C905.75 698 921.6875 659.84375 932 619.34375c-43.21875-16.59375-74.0625-58.21875-74.0625-107.34375zM512 627.3125c-63.65625 0-115.3125-51.65625-115.3125-115.3125s51.65625-115.3125 115.3125-115.3125 115.3125 51.65625 115.3125 115.3125-51.65625 115.3125-115.3125 115.3125z" p-id="2387" fill="#ffffff"></path></svg>',t.insertBefore(o,t.childNodes[t.childNodes.length-1]),o.addEventListener("mouseover",(function(e){l.name="settingConfigs",p.showSettingPopup(e)})));var o=document.createElement("button");o.setAttribute("class","player-btn keyboard-input footer-control"),o.setAttribute("id","pagefull-switch"),o.setAttribute("tooltip",a.$method.getLangObject().pageScreen),o.setAttribute("control",""),o.innerHTML='<div class="_fullpage"controls="full-page"><svg t="1607605504727"class="icon"viewBox="0 0 1024 1024"version="1.1"xmlns="http://www.w3.org/2000/svg"p-id="2356"><path d="M948.90666667 851.69493333H75.09333333c-27.30666667 0-49.152-21.84533333-49.152-43.69066666v-655.36c0-27.30666667 21.84533333-49.152 49.152-49.152h873.81333334c27.30666667 0 43.69066667 21.84533333 43.69066666 49.152v655.36c0 27.30666667-16.384 43.69066667-43.69066666 43.69066666z m-824.66133334-87.38133333h780.97066667V196.33493333H124.24533333v567.97866667z"p-id="2357"fill="#ffffff"></path><path d="M238.93333333 496.70826667c-21.84533333 0-43.69066667-16.384-43.69066666-43.69066667v-136.53333333c0-21.84533333 16.384-43.69066667 43.69066666-43.69066667h136.53333334c21.84533333 0 43.69066667 16.384 43.69066666 43.69066667s-21.84533333 38.22933333-43.69066666 38.22933333H282.624v98.304c0 21.84533333-21.84533333 43.69066667-43.69066667 43.69066667zM785.06666667 687.85493333h-136.53333334c-21.84533333 0-43.69066667-16.384-43.69066666-43.69066666s16.384-43.69066667 43.69066666-43.69066667h92.84266667v-98.304c0-21.84533333 16.384-43.69066667 43.69066667-43.69066667s43.69066667 16.384 43.69066666 43.69066667v141.99466667c-5.46133333 21.84533333-21.84533333 43.69066667-43.69066666 43.69066666z"p-id="2358"fill="#ffffff"></path></svg></div><div class="_unfullpage"controls="unfull-page"style="display: none;"><svg t="1607605550628"class="icon"viewBox="0 0 1024 1024"version="1.1"xmlns="http://www.w3.org/2000/svg"p-id="2519"><path d="M948.90666667 851.69493333H75.09333333c-27.30666667 0-49.152-21.84533333-49.152-43.69066666v-655.36c0-27.30666667 21.84533333-49.152 49.152-49.152h873.81333334c27.30666667 0 43.69066667 21.84533333 43.69066666 49.152v655.36c0 27.30666667-16.384 43.69066667-43.69066666 43.69066666z m-824.66133334-87.38133333h780.97066667V196.33493333H124.24533333v567.97866667z"p-id="2520"fill="#ffffff"></path><path d="M375.46666667 496.70826667H238.93333333c-21.84533333 0-43.69066667-16.384-43.69066666-43.69066667s21.84533333-38.22933333 43.69066666-38.22933333h92.84266667v-98.304c0-21.84533333 16.384-43.69066667 43.69066667-43.69066667s38.22933333 21.84533333 38.22933333 43.69066667v136.53333333c0 21.84533333-16.384 43.69066667-38.22933333 43.69066667zM648.53333333 687.85493333c-21.84533333 0-43.69066667-16.384-43.69066666-43.69066666v-136.53333334c0-21.84533333 16.384-43.69066667 43.69066666-43.69066666H785.06666667c21.84533333 0 43.69066667 16.384 43.69066666 43.69066666s-16.384 43.69066667-43.69066666 43.69066667h-92.84266667v92.84266667c-5.46133333 21.84533333-21.84533333 43.69066667-43.69066667 43.69066666z"p-id="2521"fill="#ffffff"></path></svg></div>',t.insertBefore(o,t.childNodes[t.childNodes.length-1]),o.addEventListener("click",(new b.toggles).pageFull),a.$method.removeNode(e,"#back-button #back-icon-svg"),o=document.createElement("button"),a.$method.setElementStyle(o,{fontSize:"18px",color:"#FFFFFF",width:"auto"}),o.setAttribute("class","player-btn header-control"),o.setAttribute("id","current-time"),o.setAttribute("control",""),o.innerHTML='<div id="" style="display: none;"></div>',e.querySelector("#buttom-group").appendChild(o),e.appendChild(a.$method.createRangeIsDocFragment('<div style="display: none;"class="mp-bezel-text-hide"><div class="mp-bezel"><div class="mp-bezel-icon"></div></div></div>')),o=document.createElement("div"),o.setAttribute("class","ctxmenu-wrapper"),o.setAttribute("id","ctxmenu-wrapper"),o.addEventListener("click",(function(e){e.stopPropagation()})),e.appendChild(o);var s=document.createElement("div");return s.setAttribute("class","mplayer-shortcut"),s.setAttribute("id","mplayer-shortcut"),o=a.$method.getLangObject().shortcutsPanel,s.innerHTML='<p class="title">'+o.title+'</p><div class="close-shortcut-panel"><svg height="100%" viewBox="0 0 24 24" width="100%"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" fill="#fff"></path></svg></div><ul><li><label>'+o.space+"：</label><span>"+o.spaceAction+"</span></li><li><label>Esc：</label><span>"+o.esc+"</span></li></ul><ul><li><label>↑：</label><span>"+o.up+"</span></li><li><label>↓：</label><span>"+o.down+"</span></li></ul><ul><li><label>→：</label><span>"+o.right+"</span></li><li><label>←：</label><span>"+o.left+"</span></li></ul>",s.addEventListener("click",(function(e){e.stopPropagation()})),s.addEventListener("dblclick",(function(e){e.stopPropagation()})),s.addEventListener("mouseup",(function(e){e.stopPropagation()})),s.querySelector(".close-shortcut-panel").addEventListener("click",(function(){s.style.display="none"})),e.appendChild(s),v._createDanmakuInput&&v._createDanmakuInput(e),v._createSeekLine&&v._createSeekLine(e),e},initConfigControls:function(e){1!=a.option.live&&((o=document.createElement("button")).setAttribute("class","player-btn footer-control keyboard-input"),o.setAttribute("style","color: white;display: flex;align-items: center;width: auto;"),o.innerHTML='<div class="progress-begin" id="progress-begin"style="width: initial;margin-right: 5px;font-size: inherit;">'+a.$method.getLangObject().begin+'</div><div class="time-symbol">/</div><div class="progress-long" id="progress-long" style="color: #dddddd;width: initial;margin-left: 5px;font-size: inherit;">'+a.$method.getLangObject().end+"</div>",a.$method.setElementStyle(o,{color:"#FFFFFF",display:"flex",width:"auto"}),a.$method.removeNode(e,"#progress-begin"),a.$method.removeNode(e,"#progress-long"),e.querySelector("#left-part").appendChild(o)),e.querySelector("#progress-ball")&&e.querySelector("#progress-ball").classList.add("default-scale"),e.querySelector(".progress-ball")&&(e.querySelector(".progress-ball").style.height="15px"),e.querySelector(".progress-ball")&&(e.querySelector(".progress-ball").style.width="15px"),e.querySelector("#progress-container")&&e.querySelector("#progress-container").setAttribute("style","left: 12px;right: 12px;"),e.querySelector("#touch-effective")&&(e.querySelector("#touch-effective").style.margin="0");for(var t=e.querySelectorAll("#progress-total,#progress-buffered,#progress-play"),n=0;n<t.length;n++)t[n]&&t[n].classList.add("progress-default-scale");var r=m.getStorageVolume(),i=r.expiration,o=r.muted;r=r.volume;return"number"==typeof i&&i>(new Date).getTime()?("boolean"==typeof o&&(e.querySelector("video").muted=o),"number"==typeof r&&(e.querySelector("video").volume=0<r&&r<100?Number.parseInt(r)/100:1)):(r=a.option.volume,m.setStorageVolume(0<=r&&r<=1?100*r:100)),!0===a.option.muted&&(e.querySelector("video").muted=!0,m.setStorageVolume(null,!0)),b.buildBasePanel(e)},onDurationChange:function(e){v._addPrompt&&v._addPrompt(e.duration,"durationChangeSymbol")},onFullscreenChange:function(e){a._this._global_.isReady&&(v.toggleDanmakuStatus&&v.toggleDanmakuStatus(e),e.fullscreen?((new b.toggles).pageFull("change"),(new b.toggles).timeControls(!0),(new b.toggles).scaleControls(!0)):((new b.toggles).scaleControls(!1),(new b.toggles).timeControls(!1),(new b.popupInstance).togglePopupVisible("OFF")))},onControlsToggle:function(e){function t(e){a.$el.mPlayer.style.cursor=e}e.show||(new b.popupInstance).togglePopupVisible("OFF"),a.$data.isFullScreen&&(new b.toggles).timeControls(e.show),a._this._global_.webpagePlugin.timer_2&&clearTimeout(a._this._global_.webpagePlugin.timer_2),e.show||!a.$data.isFullScreen&&!a._this._global_.webpagePlugin.isPagefull?t("default"):a._this._global_.webpagePlugin.timer_2=setTimeout((function(){a.$data.isShowRightSidebar||t("none")}),1e3)},onReady:function(){var e;"function"==typeof a.$el&&(e=new a.$el,a.$el=e),!0===a.option.initFullFixed&&(new b.toggles).pageFull("initFullFixed"),b.addFocusKeyboardHandle(),b.addControlTooltip(),b.toggleEventListenerGlobal("add","playerReady"),r.addProto(),v._addPrompt&&v._addPrompt("","readyChangeSymbol")},onDestroy:function(){b.toggleEventListenerGlobal("remove","playerDestroy")},onError:function(){b.toggleEventListenerGlobal("remove","playerError")},onAction:function(e){var t="add"==e?"on":"off";a._this[t]("duration-change",b.onDurationChange),a._this[t]("fullscreen-change",b.onFullscreenChange),a._this[t]("controls-toggle",b.onControlsToggle),a._this[t]("ready",b.onReady,"MASTER"),a._this[t]("error",b.onError),setTimeout((function(){a._this[t]("destroy",b.onDestroy)}))},vaks:function(){return!1},toggleEventListenerGlobal:function(t,n){var r="add"==t?"addEventListener":"removeEventListener";a._this._global_.webpagePlugin.eventStatus=r,a.$el.touchEffective instanceof Element&&a.$el.touchEffective[r]("mouseover",b.onEffectiveOverEvent),a.$el.mPlayer&&a.$el.mPlayer[r]("mousemove",b.onMpMousemoveEvent),a.$el.mPlayer&&!0===e.leaveHiddenControls&&a.$el.mPlayer[r]("mouseleave",b.onMpMouseleaveEvent),a.$el.mPlayer&&a.$el.mPlayer[r]("keydown",g.onDocKeydown),a.$el.mPlayer&&a.$el.mPlayer[r]("mouseup",f.createCtxmenu),a.$el.mPlayer&&a.$el.mPlayer[r]("contextmenu",f.onContextmenuEvent),"playerDestroy"==n&&b.onAction("remove")}};this.addProto=function(){},this.interface=function(e){this._onAgentMpTap=function(t){if("click"==t)return a.$method.onPlayTap({type:"dblscreen"}),b.showHandleIcon("mouseclick"),void("removeEventListener"==a._this._global_.webpagePlugin.eventStatus&&this._addEvent());"dbclick"!=t||b.vaks()&&a.$el.mPlayer.hasAttribute("miniplayer")||a.$method.fullToggle(e)},this._removeEvent=function(){b.vaks()&&b.toggleEventListenerGlobal("remove","activeRemove")},this._addEvent=function(){b.vaks()&&b.toggleEventListenerGlobal("add")}},this.appendTemplate=function(e,t){return a={},a=t,console.info("loading mui player desktop plugin..."),Object.keys(v).forEach((function(e){delete v[e]})),b.onAction("add"),b.initConfigControls(e)},this.name="MuiPlayerDesktopPlugin"}}))}).call(this,n("92c4")(e))},3167:function(e,t,n){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,s){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"===typeof e?o(a(e),(function(a){var s=encodeURIComponent(r(a))+n;return i(e[a])?o(e[a],(function(e){return s+encodeURIComponent(r(e))})).join(t):s+encodeURIComponent(r(e[a]))})).join(t):s?encodeURIComponent(r(s))+n+encodeURIComponent(r(e)):""};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function o(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var a=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},"31da":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}},[t("span",{attrs:{slot:"adVipld"},slot:"adVipld"},[t("el-select",{staticStyle:{width:"90%"},attrs:{filterable:"",remote:"",size:"small",clearable:"",placeholder:"评论人(输入名称或者手机号)","remote-method":e.remoteMethod,loading:e.remoteLoading},model:{value:e.filterData.adVipld,callback:function(t){e.$set(e.filterData,"adVipld",t)},expression:"filterData.adVipld"}},e._l(e.adVipOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)]),t("BasicTable",{attrs:{columns:e.table.columns,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange}})],1)},i=[],o=n("7591"),a=n("b775"),s={name:"evalPage",components:{BasicTable:o["a"]},data(){return{adVipOptions:[],remoteLoading:!1,loading:!1,filterOptions:{column:[{type:"slot",slotName:"adVipld"}]},filterData:{adVipld:""},table:{columns:[{id:1,prop:"courseName",label:"课程名称"},{id:2,prop:"content",label:"评论内容"},{id:3,prop:"vipName",label:"评论人"},{id:4,prop:"status",label:"状态"},{id:5,prop:"createTime",label:"评论时间",type:"date"}],pageSize:20,currentPage:1,data:[],total:0}}},created(){this.getList()},methods:{searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0,a["a"].post({url:"/admin/adCourseComment/list",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,...this.filterData},success:e=>{this.table.data=e.list,this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1}})},remoteMethod(e){e&&(this.remoteLoading=!0,a["a"].post({url:"/admin/adInfo/queryAdminByNameOrPhone",params:{search:e},success:e=>{this.remoteLoading=!1,this.adVipOptions=e},catch:()=>{this.remoteLoading=!1}}))},clearFilter(){this.filterData={name:""},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()}}},l=s,u=n("1805"),c=Object(u["a"])(l,r,i,!1,null,"07d29816",null);t["default"]=c.exports},"324f":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.addModifyVisible,width:"70%"},on:{"update:visible":function(t){e.addModifyVisible=t},close:e.close}},[t("el-form",{ref:"clientRef",attrs:{model:e.addData,rules:e.clientRule,"label-position":"right","label-width":"150px"}},[t("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"产品编号/产品名称",prop:"course"}},[t("jat-input",{directives:[{name:"input",rawName:"v-input.int",modifiers:{int:!0}}],attrs:{disabled:"",placeholder:"请输入数量"},model:{value:e.addData.course,callback:function(t){e.$set(e.addData,"course",t)},expression:"addData.course"}})],1),t("el-form-item",{attrs:{label:"开始时间:",prop:"time"}},[t("jat-date-picker",{attrs:{width:"100%",clearable:"",type:"daterange",placeholder:"请选择时间",size:"small"},model:{value:e.addData.time,callback:function(t){e.$set(e.addData,"time",t)},expression:"addData.time"}})],1),t("el-form-item",{attrs:{label:"数量:",prop:"count"}},[t("jat-input",{directives:[{name:"input",rawName:"v-input.int",modifiers:{int:!0}}],attrs:{disabled:"",placeholder:"请输入数量"},model:{value:e.addData.count,callback:function(t){e.$set(e.addData,"count",t)},expression:"addData.count"}})],1),t("el-form-item",{attrs:{label:"市场价:",prop:"marketPrice"}},[t("jat-input",{directives:[{name:"input",rawName:"v-input.float",value:2,expression:"2",modifiers:{float:!0}}],attrs:{placeholder:"请输入市场价"},model:{value:e.addData.marketPrice,callback:function(t){e.$set(e.addData,"marketPrice",t)},expression:"addData.marketPrice"}})],1),t("el-form-item",{attrs:{label:"成本价:",prop:"costPrice"}},[t("jat-input",{directives:[{name:"input",rawName:"v-input.float",value:2,expression:"2",modifiers:{float:!0}}],attrs:{placeholder:"请输入成本价"},model:{value:e.addData.costPrice,callback:function(t){e.$set(e.addData,"costPrice",t)},expression:"addData.costPrice"}})],1),t("el-form-item",{attrs:{label:"下单者:",prop:"adId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",clearable:"",filterable:"",remote:"",placeholder:"代客下单选择会员账号，自己下单选择管理员账号","remote-method":t=>e.remoteMethod(t,""),loading:e.remoteLoading},model:{value:e.addData.adId,callback:function(t){e.$set(e.addData,"adId",t)},expression:"addData.adId"}},e._l(e.userAllOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name?e.name:e.account+"(学籍未注册)",value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"利润归属:",prop:"profitAdId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",clearable:"",filterable:"",remote:"",placeholder:"为空为当前登录账户","remote-method":t=>e.remoteMethod(t,0),loading:e.remoteLoading},model:{value:e.addData.profitAdId,callback:function(t){e.$set(e.addData,"profitAdId",t)},expression:"addData.profitAdId"}},e._l(e.userAdminOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"优惠信息/订单备注:",prop:"remark"}},[t("jat-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入优惠信息/订单备注"},model:{value:e.addData.remark,callback:function(t){e.$set(e.addData,"remark",t)},expression:"addData.remark"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)],1)},i=[],o=n("c46c"),a=n("b775"),s=(n("b893"),n("7591")),l=n("de3d"),u={components:{uploadFile:o["a"],BasicTable:s["a"]},data(){return{addModifyVisible:!1,remoteLoading:!1,dialogTitle:"",tableData:[],userAdminOptions:[],userAllOptions:[],addData:{id:"",course:{},adId:"",costPrice:"",count:1,ids:"",marketPrice:"",profitAdId:"",remark:"",time:[]},clientRule:{costPrice:[{required:!0,message:"请输入成本价",trigger:"blur"}],marketPrice:[{required:!0,message:"请输入市场价",trigger:"blur"}],adId:[{required:!0,message:"请输入下单者",trigger:"blur"}],profitAdId:[{required:!0,message:"请输入利润归属人",trigger:"blur"}],count:[{required:!0,message:"请输入数量",trigger:"blur"}],time:[{required:!0,message:"请选择开始时间",trigger:"blur"}]}}},mounted(){},methods:{edit({id:e,name:t,number:n,tag:r}){this.dialogTitle="立即预订",this.addModifyVisible=!0,this.addData={ids:JSON.stringify([e]),course:`${n}/${t}`,count:1,courseType:r,name:l["e"].find(e=>e.value==r).label,time:[],costPrice:"",adId:"",marketPrice:"",profitAdId:"",remark:""},this.getCurrentUser()},close(){this.$refs.clientRef&&this.$refs.clientRef.clearValidate(),this.addData={ids:"",course:"",count:1,courseType:"",name:"",time:[],costPrice:"",adId:"",marketPrice:"",profitAdId:"",remark:""},this.addModifyVisible=!1},getCurrentUser(){const e=sessionStorage.getItem("id")?parseInt(sessionStorage.getItem("id")):"";this.userAdminOptions=[{id:e,name:sessionStorage.getItem("userName")}],this.addData.profitAdId=e},handleSubmit(){this.$refs.clientRef.validate(e=>{const{ids:t,time:n,course:r,...i}=this.addData;e&&a["a"].post({url:"/admin/adCourse/bookingAdd",params:{ids:t,startTime:n&&n.length>0?n[0]:"",endTime:n&&n.length>0?n[1]:"",...i},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}})})},handleSelectionChange(e){this.addData.ids=e.map(e=>e.id)},remoteMethod(e,t){e&&(this.remoteLoading=!0,a["a"].post({url:"/admin/adInfo/queryAdminByNameOrPhone",params:{search:e,type:t},success:e=>{this.remoteLoading=!1,0===t?this.userAdminOptions=e:this.userAllOptions=e},catch:()=>{this.remoteLoading=!1}}))}}},c=u,d=(n("513b"),n("1805")),f=Object(d["a"])(c,r,i,!1,null,"7d54436f",null);t["default"]=f.exports},"348c":function(e,t,n){"use strict";n("600b")},"34aa":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}),t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,operates:e.operates,operateWidth:"280px",data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange},scopedSlots:e._u([{key:"image",fn:function(e){return t("div",{},[e.row.image?t("el-image",{staticStyle:{width:"50px"},attrs:{src:e.row.image,"preview-src-list":[e.row.image]}}):t("span")],1)}}])}),t("add-dialog",{ref:"addDialog",on:{success:e.handleSuccess}}),t("detail-drawer",{ref:"drawerRef"})],1)},i=[],o=(n("5948"),n("7591")),a=n("b775"),s=n("779e"),l=n("b893"),u=n("2a9b"),c=n("a0f2"),d={name:"receivablesPage",components:{BasicTable:o["a"],addDialog:s["default"],detailDrawer:c["default"]},data(){return{loading:!1,categoryOptions:[],orderStatus:u["b"],filterOptions:{column:[{type:"select",label:"收款方式",value:"categoryId",labelKey:"name",valueKey:"id",options:[]},{type:"input",label:"订单号/交易号",value:"orderNum"},{type:"select",label:"收款状态",value:"collectionStatus",options:u["a"]},{type:"user",userType:0,label:"收款人",value:"profitAdId"},{type:"user",userType:1,label:"下单人",value:"vipAdId"},{type:"timeAll",label:["开始日期-开始","开始日期-结束"],value:"openTime"},{type:"timeAll",label:["结束日期-开始","结束日期-结束"],value:"endTime"},{type:"timeAll",label:["创建日期-开始","创建日期-结束"],value:"createTime"}]},filterData:{categoryId:"",orderNum:"",collectionStatus:"",profitAdId:"",openTime:[],endTime:[],createTime:[],vipAdId:""},table:{columns:[{id:1,prop:"orderNum",label:"订单名称",minWidth:"150px",width:"190px"},{id:2,prop:"courseName",label:"课程名称",minWidth:"150px"},{id:12,prop:"collectionTime",label:"收款时间",width:"170px",type:"date"},{id:4,prop:"vipName",label:"下单人",minWidth:"120px"},{id:5,prop:"collectionMoney",label:"金额(正收，负退)",minWidth:"150px",align:"center",render:e=>-1==e.type?"-"+e.collectionMoney:e.collectionMoney,colorRener:e=>-1==e.type?"#C00063":""},{id:22,prop:"remark",label:"备注",width:"120px",render:e=>""===e.remark?"—":e.remark},{id:13,prop:"status",label:"收款状态",render:e=>{const t=u["a"].find(t=>t.value==e.status);return t?t.label:""},colorRener:e=>{const t=u["a"].find(t=>t.value==e.status);return t?t.color:""}},{id:6,prop:"categoryName",label:"收款方式",minWidth:"120px"},{id:8,prop:"profitAdName",label:"销售人",minWidth:"100px"},{id:9,prop:"commission",label:"佣金",minWidth:"100px"},{id:11,prop:"collectionUnit",label:"收款单位"},{id:7,prop:"payTime",label:"支付时间",type:"date",minWidth:"100px"},{id:3,width:"220px",prop:"time",label:"开始/结束日期",minWidth:"210px",render:e=>e.startTime?`${Object(l["b"])(e.startTime,"yyyy-MM-dd")} 至 ${Object(l["b"])(e.endTime,"yyyy-MM-dd")}`:""},{id:14,prop:"colectionNumber",label:"收款交易号",type:"date"},{id:15,prop:"refundNumber",label:"退款交易号",type:"date"}],pageSize:20,currentPage:1,data:[],total:0},operates:[{key:"detail",title:"详情",permission:"",btnStyle:"green",show:e=>!0,action:(e,t)=>{console.log("row",t),t.name=t.categoryName,t.count=1,t.vipName=t.collectionUnit,t.receivablePrice=t.receivable;var n=[];n.push(t.receiptUrl),t.imageArr=n,this.$refs.drawerRef.open(t)}},{key:"received",title:"已收",permission:"system/sysCourseOrderBills/receivedEdit",btnStyle:"blue",action:(e,t)=>{this.handleRecived(t)},show:e=>0==e.status&&-1!==e.type},{key:"cancel",title:"取消",permission:"system/sysCourseOrderBills/cancelEdit",btnStyle:"yellow",action:(e,t)=>{this.handleCancle(t)},show:e=>!0},{key:"recorded",title:"入账",permission:"system/sysCourseOrderBills/enterBillEdit",btnStyle:"yellow",action:(e,t)=>{this.handleRecorded(t)},show:e=>2==e.status},{key:"fallback",title:"回退",permission:"system/sysCourseOrderBills/fallbackEdit",btnStyle:"red",action:(e,t)=>{this.handleFallback(t)},show:e=>0==e.status||1==e.status||2==e.status||3==e.status},{key:"financialAudits",title:"财务审核",permission:"system/sysCourseOrderBills/financialAuditEdit",btnStyle:"blue",action:(e,t)=>{this.handleFinancialAudits(t)},show:e=>0==e.status&&-1==e.type}],headerOperates:[{key:"export",name:"导出",permission:"system/sysCourseOrderBills/collectionDetailListExport",action:()=>{this.handleExport()}}]}},created(){this.$route.query.orderNum&&(this.filterData.orderNum=this.$route.query.orderNum),this.getList(),this.getCategoryList()},methods:{handleExport(){this.$confirm("确定导出收款明细吗？导出的时候请等待页面下载自动开始，如果数据量大，可能会等待稍长时间，请不要关闭或者刷新页面","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$message.warning("请耐心等待，表格正在导出中......");const{openTime:e,endTime:t,createTime:n,...r}=this.filterData;a["a"].post({url:"/system/sysCourseOrderBills/collectionDetailListExport",params:{...r,openStartTime:e&&e.length>0?e[0]:"",openEndTime:e&&e.length>0?e[1]:"",createStartTime:n&&n.length>0?n[0]:"",createEndTime:n&&n.length>0?n[1]:"",endStartTime:t&&t.length>0?t[0]:"",endEndTime:t&&t.length>0?t[1]:""},success:e=>{let t=document.createElement("a");t.href="https://"+e,document.body.appendChild(t),t.click(),document.body.removeChild(t),this.$message.success("导出成功"),this.searchFilter()}})}).catch(()=>{this.$message.info("已取消导出")})},searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0;const{openTime:e,endTime:t,createTime:n,...r}=this.filterData;a["a"].post({url:"/system/sysCourseOrderBills/collectionDetailList",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,...r,openStartTime:e&&e.length>0?e[0]:"",openEndTime:e&&e.length>0?e[1]:"",createStartTime:n&&n.length>0?n[0]:"",createEndTime:n&&n.length>0?n[1]:"",endStartTime:t&&t.length>0?t[0]:"",endEndTime:t&&t.length>0?t[1]:""},success:e=>{this.table.data=e.list,this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1}})},getCategoryList(){a["a"].post({url:"/system/sysCategory/listNoPage",params:{type:3},success:e=>{this.filterOptions.column[0].options=e}})},handleSuccess(){this.getList()},handleRecived(e){this.$confirm("确定执行已收操作, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/system/sysCourseOrderBills/receivedEdit",params:{billsId:e.billsId},success:e=>{this.$message.success(e),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消操作"})})},handleFinancialAudits(e){this.$confirm("确定执行财务审核操作, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/system/sysCourseOrderBills/financialAuditEdit",params:{billsId:e.billsId},success:e=>{this.$message.success(e),this.getList()}})}).catch(e=>{console.log(e),this.$message({type:"info",message:"已取消操作"})})},handleCancle(e){this.$confirm("确定执行取消操作, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/system/sysCourseOrderBills/cancelEdit",params:{billsId:e.billsId},success:e=>{this.$message.success(e),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消操作"})})},handleRecorded(e){this.$confirm("确定执行入账操作, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/system/sysCourseOrderBills/enterBillEdit",params:{billsId:e.billsId},success:e=>{this.$message.success(e),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消操作"})})},handleFallback(e){this.$confirm("确定执行回退操作, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/system/sysCourseOrderBills/fallbackEdit",params:{billsId:e.billsId},success:e=>{this.$message.success(e),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消操作"})})},clearFilter(){this.filterData={categoryId:"",orderNum:"",courseName:"",collectionStatus:"",colectionName:"",time:[],vipName:""},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()}}},f=d,h=(n("baf7"),n("1805")),m=Object(h["a"])(f,r,i,!1,null,"5be18374",null);t["default"]=m.exports},"34dd":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}),t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total,"table-remark":e.totalData},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange}})],1)},i=[],o=n("7591"),a=n("b775"),s=n("787e"),l={name:"profitPersonPage",components:{BasicTable:o["a"]},data(){return{loading:!1,categoryOptions:[],totalData:"",filterOptions:{column:[{type:"select",label:"推广渠道",value:"channelId",valueKey:"id",labelKey:"name",options:[]},{type:"user",userType:0,label:"推广销售员",value:"profitAdId"},{type:"timeAll",label:["添加开始时间","添加结束时间"],value:"time"},{type:"timeAll",label:["删除开始时间","删除结束时间"],value:"rmTime"}]},filterData:{channelId:"",profitAdId:"",time:[],rmTime:[]},table:{columns:[{id:2,prop:"name",label:"推广销售员"},{id:6,prop:"toDayCount",label:"今日增加"},{id:3,prop:"totalDataCount",label:"总数据"},{id:4,prop:"totalAddCount",label:"总增加"},{id:5,prop:"totalRemoveCount",label:"总删除"},{id:7,prop:"removeCount",label:"今日删除"}],pageSize:100,currentPage:1,data:[],total:0},operates:[],headerOperates:[{key:"export",permission:"admin/adPromotionData/promoteSalespersonStatisticsListExport",name:"导出",action:()=>{this.handleExport()}}]}},created(){this.getList(),Object(s["c"])(e=>{this.filterOptions.column[0].options=e}),this.getTotalData()},methods:{getTotalData(){const{time:e,rmTime:t,...n}=this.filterData;a["a"].post({url:"/admin/adPromotionData/promoteSalespersonStatisticsData",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,startTime:e&&e.length>1?e[0]:"",endTime:e&&e.length>1?e[1]:"",rmStartTime:t&&t.length>1?t[0]:"",rmEndTime:t&&t.length>1?t[1]:"",...n},success:e=>{this.totalData=e},catch:()=>{this.loading=!1},finally:()=>{this.loading=!1}})},handleExport(){this.$confirm("确定导出推广销售员统计列表吗？导出的时候请等待页面下载自动开始，如果数据量大，可能会等待稍长时间，请不要关闭或者刷新页面","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$message.warning("请耐心等待，表格正在导出中......");const{time:e,rmTime:t,...n}=this.filterData;a["a"].post({url:"/admin/adPromotionData/promoteSalespersonStatisticsListExport",params:{startTime:e&&e.length>1?e[0]:"",endTime:e&&e.length>1?e[1]:"",rmStartTime:t&&t.length>1?t[0]:"",rmEndTime:t&&t.length>1?t[1]:"",...n},success:e=>{let t=document.createElement("a");t.href="https://"+e,document.body.appendChild(t),t.click(),document.body.removeChild(t),this.$message.success("导出成功"),this.searchFilter()}})}).catch(()=>{this.$message.info("已取消导出")})},searchFilter(){this.table.currentPage=1,this.getList(),this.getTotalData()},getList(){this.loading=!0;const{time:e,rmTime:t,...n}=this.filterData;a["a"].post({url:"/admin/adPromotionData/promoteSalespersonStatisticsList",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,startTime:e&&e.length>1?e[0]:"",endTime:e&&e.length>1?e[1]:"",rmStartTime:t&&t.length>1?t[0]:"",rmEndTime:t&&t.length>1?t[1]:"",...n},success:e=>{this.table.data=e.list,this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1},finally:()=>{this.loading=!1}})},handleSuccess(){this.getList()},clearFilter(){this.filterData={channelId:"",profitAdId:"",time:[],rmTime:[]},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()}}},u=l,c=n("1805"),d=Object(c["a"])(u,r,i,!1,null,"44ecd5e8",null);t["default"]=d.exports},"355f":function(e,t,n){"use strict";n("bc43")},"364e":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}),t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,operates:e.operates,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange},scopedSlots:e._u([{key:"image",fn:function(e){return t("div",{},[e.row.image?t("el-image",{staticStyle:{width:"50px"},attrs:{src:e.row.image,"preview-src-list":[e.row.image]}}):t("span")],1)}}])}),t("add-dialog",{ref:"addDialog",on:{success:e.handleSuccess}})],1)},i=[],o=n("7591"),a=n("b775"),s=n("81b9f"),l=n("969e"),u={name:"adverstPage",components:{BasicTable:o["a"],addDialog:s["default"]},data(){return{loading:!1,categoryOptions:[],filterOptions:{column:[{type:"input",label:"姓名/QQ/微信/电话号码",value:"search"},{type:"select",label:"推广渠道",value:"channelId",valueKey:"id",labelKey:"name",options:[]},{type:"user",userType:0,label:"销售员",value:"promoterId"},{type:"user",userType:0,label:"推广员",value:"createAdId"},{type:"timeAll",label:["添加开始时间","添加结束时间"],value:"time"},{type:"timeAll",label:["删除开始时间","删除结束时间"],value:"rmTime"}]},filterData:{search:"",channelId:"",promoterId:"",createAdId:"",time:[],rmTime:[]},table:{columns:[{id:2,prop:"name",label:"姓名"},{id:3,prop:"channelName",label:"推广渠道"},{id:4,prop:"promoterName",label:"销售员"},{id:10,prop:"createAdName",label:"推广员"},{id:5,prop:"qq",label:"QQ"},{id:6,prop:"wechat",label:"微信"},{id:7,prop:"gender",label:"性别",render:e=>l["b"].find(t=>t.value===e.gender)["label"]},{id:8,prop:"phone",label:"电话号码"},{id:10,prop:"degree",label:"学历",render:e=>e.degree?l["a"].find(t=>t.value===e.degree)["label"]:"未填写"},{id:11,prop:"age",label:"年龄"},{id:13,prop:"deleteTime",label:"删除时间",type:"date"},{id:12,prop:"createTime",label:"添加时间",type:"date"}],pageSize:20,currentPage:1,data:[],total:0},operates:[{key:"restoreData",title:"恢复数据",permission:"admin/adPromotionData/restoreData",btnStyle:"yellow",action:(e,t)=>{this.restoreData(t.id)}}],headerOperates:[{key:"export",permission:"admin/adPromotionData/deleteListExport",name:"导出",action:()=>{this.handleExport()}}]}},created(){this.getList(),Object(l["c"])(e=>{console.log(e),this.filterOptions.column[1].options=e})},methods:{restoreData(e){this.$confirm("确定恢复该数据吗","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{console.log("id:",e),a["a"].post({url:"/admin/adPromotionData/restoreData",params:{id:e},success:e=>{this.$message.success("恢复成功"),this.getList()}})}).catch(()=>{})},handleExport(){this.$confirm("确定导出删除的数据列表吗？导出的时候请等待页面下载自动开始，如果数据量大，可能会等待稍长时间，请不要关闭或者刷新页面","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$message.warning("请耐心等待，表格正在导出中......");const{time:e,rmTime:t,...n}=this.filterData;a["a"].post({url:"/admin/adPromotionData/deleteListExport",params:{startTime:e&&e.length>1?e[0]:"",endTime:e&&e.length>1?e[1]:"",rmStartTime:t&&t.length>1?t[0]:"",rmEndTime:t&&t.length>1?t[1]:"",...n},success:e=>{let t=document.createElement("a");t.href="https://"+e,document.body.appendChild(t),t.click(),document.body.removeChild(t),this.$message.success("导出成功"),this.searchFilter()}})}).catch(()=>{this.$message.info("已取消导出")})},searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0;const{time:e,rmTime:t,...n}=this.filterData;a["a"].post({url:"/admin/adPromotionData/deleteList",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,startTime:e&&e.length>1?e[0]:"",endTime:e&&e.length>1?e[1]:"",rmStartTime:t&&t.length>1?t[0]:"",rmEndTime:t&&t.length>1?t[1]:"",...n},success:e=>{this.table.data=e.list,this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1},finally:()=>{this.loading=!1}})},handleSuccess(){this.getList()},clearFilter(){this.filterData={search:"",channelId:"",promoterId:"",createAdId:"",time:[],rmTime:[]},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()}}},c=u,d=(n("9f4d"),n("1805")),f=Object(d["a"])(c,r,i,!1,null,"0ab9da50",null);t["default"]=f.exports},3966:function(e,t){},"3a6a":function(e,t,n){"use strict";n("61b1")},"3b90":function(e,t,n){},"3e22":function(e,t){(function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=tinymce.util.Tools.resolve("tinymce.Env"),n=tinymce.util.Tools.resolve("tinymce.util.Tools"),r=function(e){return e.getParam("content_style","","string")},i=function(e){return e.getParam("content_css_cors",!1,"boolean")},o=function(e){var t=e.getParam("body_class","","hash");return t[e.id]||""},a=function(e){var t=e.getParam("body_class","","string");return-1===t.indexOf("=")?t:o(e)},s=function(e){var t=e.getParam("body_id","","hash");return t[e.id]||t},l=function(e){var t=e.getParam("body_id","tinymce","string");return-1===t.indexOf("=")?t:s(e)},u=function(e){var o="",s=e.dom.encode,u=r(e);o+='<base href="'+s(e.documentBaseURI.getURI())+'">';var c=i(e)?' crossorigin="anonymous"':"";n.each(e.contentCSS,(function(t){o+='<link type="text/css" rel="stylesheet" href="'+s(e.documentBaseURI.toAbsolute(t))+'"'+c+">"})),u&&(o+='<style type="text/css">'+u+"</style>");var d=l(e),f=a(e),h=t.mac?"e.metaKey":"e.ctrlKey && !e.altKey",m='<script>document.addEventListener && document.addEventListener("click", function(e) {for (var elm = e.target; elm; elm = elm.parentNode) {if (elm.nodeName === "A" && !('+h+")) {e.preventDefault();}}}, false);<\/script> ",p=e.getBody().dir,g=p?' dir="'+s(p)+'"':"",v="<!DOCTYPE html><html><head>"+o+'</head><body id="'+s(d)+'" class="mce-content-body '+s(f)+'"'+g+">"+e.getContent()+m+"</body></html>";return v},c=function(e){var t=u(e),n=e.windowManager.open({title:"Preview",size:"large",body:{type:"panel",items:[{name:"preview",type:"iframe",sandboxed:!0}]},buttons:[{type:"cancel",name:"close",text:"Close",primary:!0}],initialData:{preview:t}});n.focus("close")},d=function(e){e.addCommand("mcePreview",(function(){c(e)}))},f=function(e){var t=function(){return e.execCommand("mcePreview")};e.ui.registry.addButton("preview",{icon:"preview",tooltip:"Preview",onAction:t}),e.ui.registry.addMenuItem("preview",{icon:"preview",text:"Preview",onAction:t})};function h(){e.add("preview",(function(e){d(e),f(e)}))}h()})()},4008:function(e,t,n){"use strict";n.d(t,"a",(function(){return He}));var r,i=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();(function(e){e["InvalidFile"]="InvalidFile",e["InvalidToken"]="InvalidToken",e["InvalidMetadata"]="InvalidMetadata",e["InvalidChunkSize"]="InvalidChunkSize",e["InvalidCustomVars"]="InvalidCustomVars",e["NotAvailableUploadHost"]="NotAvailableUploadHost",e["ReadCacheFailed"]="ReadCacheFailed",e["InvalidCacheData"]="InvalidCacheData",e["WriteCacheFailed"]="WriteCacheFailed",e["RemoveCacheFailed"]="RemoveCacheFailed",e["GetCanvasContextFailed"]="GetCanvasContextFailed",e["UnsupportedFileType"]="UnsupportedFileType",e["FileReaderReadFailed"]="FileReaderReadFailed",e["NotAvailableXMLHttpRequest"]="NotAvailableXMLHttpRequest",e["InvalidProgressEventTarget"]="InvalidProgressEventTarget",e["RequestError"]="RequestError"})(r||(r={}));var o=function(){function e(e,t){this.name=e,this.message=t,this.stack=(new Error).stack}return e}(),a=function(e){function t(t,n,i,o){var a=e.call(this,r.RequestError,i)||this;return a.code=t,a.reqId=n,a.isRequestError=!0,a.data=o,a}return i(t,e),t}(o),s=function(e){function t(t,n){return void 0===n&&(n=""),e.call(this,0,n,t)||this}return i(t,e),t}(a),l=function(){function e(e,t){this.runTask=e,this.limit=t,this.aborted=!1,this.queue=[],this.processing=[]}return e.prototype.enqueue=function(e){var t=this;return new Promise((function(n,r){t.queue.push({task:e,resolve:n,reject:r}),t.check()}))},e.prototype.run=function(e){var t=this;this.queue=this.queue.filter((function(t){return t!==e})),this.processing.push(e),this.runTask(e.task).then((function(){t.processing=t.processing.filter((function(t){return t!==e})),e.resolve(),t.check()}),(function(t){return e.reject(t)}))},e.prototype.check=function(){var e=this;if(!this.aborted){var t=this.processing.length,n=this.limit-t;this.queue.slice(0,n).forEach((function(t){e.run(t)}))}},e.prototype.abort=function(){this.queue=[],this.aborted=!0},e}(),u=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),c=function(){return c=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},c.apply(this,arguments)},d=function(){function e(){this.closed=!1}return e.prototype.unsubscribe=function(){this.closed||(this.closed=!0,this._unsubscribe&&this._unsubscribe())},e.prototype.add=function(e){this._unsubscribe=e},e}(),f=function(e){function t(t,n,r){var i=e.call(this)||this;return i.isStopped=!1,i.destination=t&&"object"===typeof t?t:c(c(c({},t&&{next:t}),n&&{error:n}),r&&{complete:r}),i}return u(t,e),t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype.next=function(e){!this.isStopped&&this.destination.next&&this.destination.next(e)},t.prototype.error=function(e){!this.isStopped&&this.destination.error&&(this.isStopped=!0,this.destination.error(e))},t.prototype.complete=function(e){!this.isStopped&&this.destination.complete&&(this.isStopped=!0,this.destination.complete(e))},t}(d),h=function(){function e(e){this._subscribe=e}return e.prototype.subscribe=function(e,t,n){var r=new f(e,t,n);return r.add(this._subscribe(r)),r},e}();function m(e){if(null===e||"undefined"===typeof e)return"";var t,n,r=e+"",i="",o=0;t=n=0,o=r.length;for(var a=0;a<o;a++){var s=r.charCodeAt(a),l=null;if(s<128)n++;else if(s>127&&s<2048)l=String.fromCharCode(s>>6|192,63&s|128);else if((63488&s^55296)>0)l=String.fromCharCode(s>>12|224,s>>6&63|128,63&s|128);else{if((64512&s^55296)>0)throw new RangeError("Unmatched trail surrogate at "+a);var u=r.charCodeAt(++a);if((64512&u^56320)>0)throw new RangeError("Unmatched lead surrogate at "+(a-1));s=((1023&s)<<10)+(1023&u)+65536,l=String.fromCharCode(s>>18|240,s>>12&63|128,s>>6&63|128,63&s|128)}null!==l&&(n>t&&(i+=r.slice(t,n)),i+=l,t=n=a+1)}return n>t&&(i+=r.slice(t,o)),i}function p(e){var t=[],n=0,r=0,i=0;e+="";while(n<e.length){r=255&e.charCodeAt(n),i=0,r<=191?(r&=127,i=1):r<=223?(r&=31,i=2):r<=239?(r&=15,i=3):(r&=7,i=4);for(var o=1;o<i;++o)r=r<<6|63&e.charCodeAt(o+n);4===i?(r-=65536,t.push(String.fromCharCode(55296|r>>10&1023)),t.push(String.fromCharCode(56320|1023&r))):t.push(String.fromCharCode(r)),n+=i}return t.join("")}function g(e){var t,n,r,i,o,a,s,l,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c=0,d=0,f="",h=[];if(!e)return e;e=m(e+"");do{t=e.charCodeAt(c++),n=e.charCodeAt(c++),r=e.charCodeAt(c++),l=t<<16|n<<8|r,i=l>>18&63,o=l>>12&63,a=l>>6&63,s=63&l,h[d++]=u.charAt(i)+u.charAt(o)+u.charAt(a)+u.charAt(s)}while(c<e.length);switch(f=h.join(""),e.length%3){case 1:f=f.slice(0,-2)+"==";break;case 2:f=f.slice(0,-1)+"=";break}return f}function v(e){var t,n,r,i,o,a,s,l,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c=0,d=0,f="",h=[];if(!e)return e;e+="";do{i=u.indexOf(e.charAt(c++)),o=u.indexOf(e.charAt(c++)),a=u.indexOf(e.charAt(c++)),s=u.indexOf(e.charAt(c++)),l=i<<18|o<<12|a<<6|s,t=l>>16&255,n=l>>8&255,r=255&l,h[d++]=64===a?String.fromCharCode(t):64===s?String.fromCharCode(t,n):String.fromCharCode(t,n,r)}while(c<e.length);return f=h.join(""),p(f)}function b(e){return e=g(e),e.replace(/\//g,"_").replace(/\+/g,"-")}function y(e){return e=e.replace(/_/g,"/").replace(/-/g,"+"),v(e)}var w,S=n("b23c"),x=n.n(S),C=function(){return C=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},C.apply(this,arguments)},T=function(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(t){o(t)}}function s(e){try{l(r["throw"](e))}catch(t){o(t)}}function l(e){e.done?n(e.value):i(e.value).then(a,s)}l((r=r.apply(e,t||[])).next())}))},D=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(e){return function(t){return l([e,t])}}function l(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},k=Math.pow(1024,2);function E(e,t){var n=t*k;if(n>e.size)n=e.size;else while(e.size>1e4*n)n*=2;for(var r=[],i=Math.ceil(e.size/n),o=0;o<i;o++){var a=e.slice(n*o,o===i-1?e.size:n*(o+1));r.push(a)}return r}function _(e){return Object.keys(e).every((function(e){return 0===e.indexOf("x-qn-meta-")}))}function A(e){return Object.keys(e).every((function(e){return 0===e.indexOf("x:")}))}function L(e){return e.reduce((function(e,t){return e+t}),0)}function O(e,t,n){try{localStorage.setItem(e,JSON.stringify(t))}catch(i){n.warn(new o(r.WriteCacheFailed,"setLocalFileInfo failed: "+e))}}function R(e,t,n){var r=null==t?"_":"_key_"+t+"_";return"qiniu_js_sdk_upload_file_name_"+e+r+"size_"+n}function I(e,t){try{localStorage.removeItem(e)}catch(n){t.warn(new o(r.RemoveCacheFailed,"removeLocalFileInfo failed. key: "+e))}}function P(e,t){var n=null;try{n=localStorage.getItem(e)}catch(a){t.warn(new o(r.ReadCacheFailed,"getLocalFileInfo failed. key: "+e))}if(null==n)return null;var i=null;try{i=JSON.parse(n)}catch(s){I(e,t),t.warn(new o(r.InvalidCacheData,"getLocalFileInfo failed to parse. key: "+e))}return i}function M(e){var t="UpToken "+e;return{Authorization:t}}function N(e){var t=M(e);return C({"content-type":"application/octet-stream"},t)}function F(e){var t=M(e);return C({"content-type":"application/json"},t)}function B(){if(window.XMLHttpRequest)return new XMLHttpRequest;if(window.ActiveXObject)return new window.ActiveXObject("Microsoft.XMLHTTP");throw new o(r.NotAvailableXMLHttpRequest,"the current environment does not support.")}function $(e){return T(this,void 0,void 0,(function(){var t,n;return D(this,(function(r){switch(r.label){case 0:return[4,z(e)];case 1:return t=r.sent(),n=new x.a.ArrayBuffer,n.append(t),[2,n.end()]}}))}))}function z(e){return new Promise((function(t,n){var i=new FileReader;i.onload=function(e){if(e.target){var i=e.target.result;t(i)}else n(new o(r.InvalidProgressEventTarget,"progress event target is undefined"))},i.onerror=function(){n(new o(r.FileReaderReadFailed,"fileReader read failed"))},i.readAsArrayBuffer(e)}))}function U(e,t){return new Promise((function(n,r){var i=B();if(i.open(t.method,e),t.onCreate&&t.onCreate(i),t.headers){var o=t.headers;Object.keys(o).forEach((function(e){i.setRequestHeader(e,o[e])}))}i.upload.addEventListener("progress",(function(e){e.lengthComputable&&t.onProgress&&t.onProgress({loaded:e.loaded,total:e.total})})),i.onreadystatechange=function(){var e=i.responseText;if(4===i.readyState){var t=i.getResponseHeader("x-reqId")||"";if(0!==i.status)if(200===i.status)try{n({data:JSON.parse(e),reqId:t})}catch(u){r(u)}else{var o="xhr request failed, code: "+i.status;e&&(o+=" response: "+e);var l=void 0;try{l=JSON.parse(e)}catch(c){}r(new a(i.status,t,o,l))}else r(new s("network error.",t))}},i.send(t.body)}))}function V(e){if(e&&e.match){var t=e.match(/(^https?)/);if(!t)return"";var n=t[1];return t=e.match(/^https?:\/\/([^:^/]*):(\d*)/),t?t[2]:"http"===n?"80":"443"}return""}function H(e){if(e&&e.match){var t=e.match(/^https?:\/\/([^:^/]*)/);return t?t[1]:""}return""}function j(e){if(!e)throw new o(r.InvalidToken,"invalid token.");var t=e.split(":");if(1===t.length)throw new o(r.InvalidToken,"invalid token segments.");var n=t.length>3?t[1]:t[0];if(!n)throw new o(r.InvalidToken,"missing assess key field.");var i=null;try{i=JSON.parse(y(t[t.length-1]))}catch(s){throw new o(r.InvalidToken,"token parse failed.")}if(null==i)throw new o(r.InvalidToken,"putPolicy is null.");if(null==i.scope)throw new o(r.InvalidToken,"scope field is null.");var a=i.scope.split(":")[0];if(!a)throw new o(r.InvalidToken,"resolve bucketName failed.");return{assessKey:n,bucketName:a,scope:i.scope}}function q(e){var t=window.URL||window.webkitURL||window.mozURL;return t.createObjectURL(e)}var G={z0:"z0",z1:"z1",z2:"z2",na0:"na0",as0:"as0",cnEast2:"cn-east-2"},W=(w={},w[G.z0]={srcUphost:["up.qiniup.com"],cdnUphost:["upload.qiniup.com"]},w[G.z1]={srcUphost:["up-z1.qiniup.com"],cdnUphost:["upload-z1.qiniup.com"]},w[G.z2]={srcUphost:["up-z2.qiniup.com"],cdnUphost:["upload-z2.qiniup.com"]},w[G.na0]={srcUphost:["up-na0.qiniup.com"],cdnUphost:["upload-na0.qiniup.com"]},w[G.as0]={srcUphost:["up-as0.qiniup.com"],cdnUphost:["upload-as0.qiniup.com"]},w[G.cnEast2]={srcUphost:["up-cn-east-2.qiniup.com"],cdnUphost:["upload-cn-east-2.qiniup.com"]},w),K=n("66c8"),Y=function(){return Y=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Y.apply(this,arguments)},X=function(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(t){o(t)}}function s(e){try{l(r["throw"](e))}catch(t){o(t)}}function l(e){e.done?n(e.value):i(e.value).then(a,s)}l((r=r.apply(e,t||[])).next())}))},J=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(e){return function(t){return l([e,t])}}function l(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};function Q(e,t,n){return X(this,void 0,void 0,(function(){var r,i;return J(this,(function(o){return r=Object(K["stringify"])({ak:e,bucket:t}),i=n+"://api.qiniu.com/v2/query?"+r,[2,U(i,{method:"GET"})]}))}))}function Z(e,t,n){var r=n.url,i=n.id;return r+"/buckets/"+e+"/objects/"+(null!=t?b(t):"~")+"/uploads/"+i}function ee(e,t,n,r){var i=r+"/buckets/"+t+"/objects/"+(null!=n?b(n):"~")+"/uploads";return U(i,{method:"POST",headers:M(e)})}function te(e,t,n,r,i){var o=j(e).bucketName,a=Z(o,t,r)+"/"+n,s=N(e);return i.md5&&(s["Content-MD5"]=i.md5),U(a,Y(Y({},i),{method:"PUT",headers:s}))}function ne(e,t,n,r){var i=j(e).bucketName,o=Z(i,t,n);return U(o,Y(Y({},r),{method:"POST",headers:F(e)}))}function re(e,t,n){return U(e,Y({method:"POST",body:t},n))}var ie=function(){return ie=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ie.apply(this,arguments)},oe=function(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(t){o(t)}}function s(e){try{l(r["throw"](e))}catch(t){o(t)}}function l(e){e.done?n(e.value):i(e.value).then(a,s)}l((r=r.apply(e,t||[])).next())}))},ae=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(e){return function(t){return l([e,t])}}function l(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},se=function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{while((void 0===t||t-- >0)&&!(r=o.next()).done)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}return a},le=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(se(arguments[t]));return e},ue=4,ce=[0,502,503,504,599],de=le(ce,[612]),fe=Math.pow(1024,3),he=function(){function e(e,t,n,r){this.hostPool=n,this.logger=r,this.aborted=!1,this.retryCount=0,this.xhrList=[],this.config=e.config,r.info("config inited.",this.config),this.putExtra=ie({fname:""},e.putExtra),r.info("putExtra inited.",this.putExtra),this.key=e.key,this.file=e.file,this.token=e.token,this.onData=t.onData,this.onError=t.onError,this.onComplete=t.onComplete;try{var i=j(this.token);this.bucketName=i.bucketName,this.assessKey=i.assessKey}catch(o){r.error("get putPolicy from token failed.",o),this.onError(o)}}return e.prototype.checkAndUpdateUploadHost=function(){return oe(this,void 0,void 0,(function(){var e;return ae(this,(function(t){switch(t.label){case 0:return this.logger.info("get available upload host."),[4,this.hostPool.getUp(this.assessKey,this.bucketName,this.config.upprotocol)];case 1:if(e=t.sent(),null==e)throw new o(r.NotAvailableUploadHost,"no available upload host.");return null!=this.uploadHost&&this.uploadHost.host!==e.host?this.logger.warn("host switches from "+this.uploadHost.host+" to "+e.host+"."):this.logger.info("use host "+e.host+"."),this.uploadHost=e,[2]}}))}))},e.prototype.checkAndUnfreezeHost=function(){this.logger.info("check unfreeze host."),null!=this.uploadHost&&this.uploadHost.isFrozen()&&(this.logger.warn(this.uploadHost.host+" will be unfrozen."),this.uploadHost.unfreeze())},e.prototype.checkAndFreezeHost=function(e){this.logger.info("check freeze host."),e instanceof a&&null!=this.uploadHost&&ce.includes(e.code)&&(this.logger.warn(this.uploadHost.host+" will be temporarily frozen."),this.uploadHost.freeze())},e.prototype.handleError=function(e){this.logger.error(e.message),this.onError(e)},e.prototype.putFile=function(){return oe(this,void 0,void 0,(function(){var e,t,n,i;return ae(this,(function(s){switch(s.label){case 0:if(this.aborted=!1,this.putExtra.fname||(this.logger.info("use file.name as fname."),this.putExtra.fname=this.file.name),this.file.size>1e4*fe)return this.handleError(new o(r.InvalidFile,"file size exceed maximum value 10000G")),[2];if(this.putExtra.customVars&&!A(this.putExtra.customVars))return this.handleError(new o(r.InvalidCustomVars,"customVars key should start width x:")),[2];if(this.putExtra.metadata&&!_(this.putExtra.metadata))return this.handleError(new o(r.InvalidMetadata,"metadata key should start with x-qn-meta-")),[2];s.label=1;case 1:return s.trys.push([1,4,,5]),this.uploadAt=(new Date).getTime(),[4,this.checkAndUpdateUploadHost()];case 2:return s.sent(),[4,this.run()];case 3:return e=s.sent(),this.onComplete(e.data),this.checkAndUnfreezeHost(),this.sendLog(e.reqId,200),[2];case 4:return t=s.sent(),this.aborted?(this.logger.warn("upload is aborted."),this.sendLog("",-2),[2]):(this.clear(),this.logger.error(t),t instanceof a&&(this.sendLog(t.reqId,t.code),this.checkAndFreezeHost(t),n=++this.retryCount<=this.config.retryCount,i=de.includes(t.code),i&&n)?(this.logger.warn("error auto retry: "+this.retryCount+"/"+this.config.retryCount+"."),this.putFile(),[2]):(this.onError(t),[3,5]));case 5:return[2]}}))}))},e.prototype.clear=function(){this.xhrList.forEach((function(e){e.onreadystatechange=null,e.abort()})),this.xhrList=[],this.logger.info("cleanup uploading xhr.")},e.prototype.stop=function(){this.logger.info("aborted."),this.clear(),this.aborted=!0},e.prototype.addXhr=function(e){this.xhrList.push(e)},e.prototype.sendLog=function(e,t){var n,r;this.logger.report({code:t,reqId:e,remoteIp:"",upType:"jssdk-h5",size:this.file.size,time:Math.floor(this.uploadAt/1e3),port:V(null===(n=this.uploadHost)||void 0===n?void 0:n.getUrl()),host:H(null===(r=this.uploadHost)||void 0===r?void 0:r.getUrl()),bytesSent:this.progress?this.progress.total.loaded:0,duration:Math.floor(((new Date).getTime()-this.uploadAt)/1e3)})},e.prototype.getProgressInfoItem=function(e,t,n){return ie({size:t,loaded:e,percent:e/t*100},null==n?{}:{fromCache:n})},e}(),me=he,pe=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ge=function(){return ge=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ge.apply(this,arguments)},ve=function(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(t){o(t)}}function s(e){try{l(r["throw"](e))}catch(t){o(t)}}function l(e){e.done?n(e.value):i(e.value).then(a,s)}l((r=r.apply(e,t||[])).next())}))},be=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(e){return function(t){return l([e,t])}}function l(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};function ye(e){var t=/^[1-9]\d*$/;return t.test(String(e))}var we=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return pe(t,e),t.prototype.run=function(){return ve(this,void 0,void 0,(function(){var e,t,n,i,s,u=this;return be(this,(function(c){switch(c.label){case 0:if(this.logger.info("start run Resume."),!this.config.chunkSize||!ye(this.config.chunkSize))throw new o(r.InvalidChunkSize,"chunkSize must be a positive integer");if(this.config.chunkSize>1024)throw new o(r.InvalidChunkSize,"chunkSize maximum value is 1024");return[4,this.initBeforeUploadChunks()];case 1:c.sent(),e=new l((function(t){return ve(u,void 0,void 0,(function(){return be(this,(function(n){switch(n.label){case 0:if(this.aborted)throw e.abort(),new Error("pool is aborted");return[4,this.uploadChunk(t)];case 1:return n.sent(),[2]}}))}))}),this.config.concurrentRequestLimit),t=null,n=this.getLocalKey(),i=this.chunks.map((function(t,n){return e.enqueue({chunk:t,index:n})})),c.label=2;case 2:return c.trys.push([2,5,,6]),[4,Promise.all(i)];case 3:return c.sent(),[4,this.mkFileReq()];case 4:return t=c.sent(),[3,6];case 5:throw s=c.sent(),s instanceof a&&(612===s.code||400===s.code)&&I(n,this.logger),s;case 6:return I(n,this.logger),[2,t]}}))}))},t.prototype.uploadChunk=function(e){return ve(this,void 0,void 0,(function(){var t,n,r,i,o,a,s,l,u,c=this;return be(this,(function(d){switch(d.label){case 0:return t=e.index,n=e.chunk,r=this.cachedUploadedList[t],this.logger.info("upload part "+t+", cache:",r),i=this.config.checkByMD5,o=function(){c.usedCacheList[t]=!0,c.updateChunkProgress(n.size,t),c.uploadedList[t]=r,c.updateLocalCache()},r&&!i?(o(),[2]):[4,$(n)];case 1:return a=d.sent(),this.logger.info("computed part md5.",a),r&&a===r.md5?(o(),[2]):(this.usedCacheList[t]=!1,s=function(e){c.updateChunkProgress(e.loaded,t)},l={body:n,md5:this.config.checkByServer?a:void 0,onProgress:s,onCreate:function(e){return c.addXhr(e)}},this.logger.info("part "+t+" start uploading."),[4,te(this.token,this.key,e.index+1,this.getUploadInfo(),l)]);case 2:return u=d.sent(),this.logger.info("part "+t+" upload completed."),s({loaded:n.size,total:n.size}),this.uploadedList[t]={etag:u.data.etag,md5:u.data.md5,size:n.size},this.updateLocalCache(),[2]}}))}))},t.prototype.mkFileReq=function(){return ve(this,void 0,void 0,(function(){var e,t,n=this;return be(this,(function(r){switch(r.label){case 0:return e=ge(ge(ge({parts:this.uploadedList.map((function(e,t){return{etag:e.etag,partNumber:t+1}})),fname:this.putExtra.fname},this.putExtra.mimeType&&{mimeType:this.putExtra.mimeType}),this.putExtra.customVars&&{customVars:this.putExtra.customVars}),this.putExtra.metadata&&{metadata:this.putExtra.metadata}),this.logger.info("parts upload completed, make file.",e),[4,ne(this.token,this.key,this.getUploadInfo(),{onCreate:function(e){return n.addXhr(e)},body:JSON.stringify(e)})];case 1:return t=r.sent(),this.logger.info("finish Resume Progress."),this.updateMkFileProgress(1),[2,t]}}))}))},t.prototype.initBeforeUploadChunks=function(){return ve(this,void 0,void 0,(function(){var e,t,n;return be(this,(function(r){switch(r.label){case 0:return this.uploadedList=[],this.usedCacheList=[],e=P(this.getLocalKey(),this.logger),e?[3,2]:(this.logger.info("init upload parts from api."),[4,ee(this.token,this.bucketName,this.key,this.uploadHost.getUrl())]);case 1:return t=r.sent(),this.logger.info("initd upload parts of id: "+t.data.uploadId+"."),this.uploadId=t.data.uploadId,this.cachedUploadedList=[],[3,3];case 2:n=["resume upload parts from local cache,","total "+e.data.length+" part,","id is "+e.id+"."],this.logger.info(n.join(" ")),this.cachedUploadedList=e.data,this.uploadId=e.id,r.label=3;case 3:return this.chunks=E(this.file,this.config.chunkSize),this.loaded={mkFileProgress:0,chunks:this.chunks.map((function(e){return 0}))},this.notifyResumeProgress(),[2]}}))}))},t.prototype.getUploadInfo=function(){return{id:this.uploadId,url:this.uploadHost.getUrl()}},t.prototype.getLocalKey=function(){return R(this.file.name,this.key,this.file.size)},t.prototype.updateLocalCache=function(){O(this.getLocalKey(),{id:this.uploadId,data:this.uploadedList},this.logger)},t.prototype.updateChunkProgress=function(e,t){this.loaded.chunks[t]=e,this.notifyResumeProgress()},t.prototype.updateMkFileProgress=function(e){this.loaded.mkFileProgress=e,this.notifyResumeProgress()},t.prototype.notifyResumeProgress=function(){var e=this;this.progress={total:this.getProgressInfoItem(L(this.loaded.chunks)+this.loaded.mkFileProgress,this.file.size+1),chunks:this.chunks.map((function(t,n){var r=e.usedCacheList[n];return e.getProgressInfoItem(e.loaded.chunks[n],t.size,r)})),uploadInfo:{id:this.uploadId,url:this.uploadHost.getUrl()}},this.onData(this.progress)},t}(me),Se=we,xe=function(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(t){o(t)}}function s(e){try{l(r["throw"](e))}catch(t){o(t)}}function l(e){e.done?n(e.value):i(e.value).then(a,s)}l((r=r.apply(e,t||[])).next())}))},Ce=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(e){return function(t){return l([e,t])}}function l(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},Te=function(){function e(){this.crc=-1,this.table=this.makeTable()}return e.prototype.makeTable=function(){for(var e=new Array,t=0;t<256;t++){for(var n=t,r=0;r<8;r++)1&n?n=n>>>1^3988292384:n>>>=1;e[t]=n}return e},e.prototype.append=function(e){for(var t=this.crc,n=0;n<e.byteLength;n++)t=t>>>8^this.table[255&(t^e[n])];this.crc=t},e.prototype.compute=function(){return(-1^this.crc)>>>0},e.prototype.readAsUint8Array=function(e){return xe(this,void 0,void 0,(function(){var t;return Ce(this,(function(n){switch(n.label){case 0:return"function"!==typeof e.arrayBuffer?[3,2]:(t=Uint8Array.bind,[4,e.arrayBuffer()]);case 1:return[2,new(t.apply(Uint8Array,[void 0,n.sent()]))];case 2:return[2,new Promise((function(t,n){var r=new FileReader;r.onload=function(){null!=r.result&&"string"!==typeof r.result?t(new Uint8Array(r.result)):n()},r.readAsArrayBuffer(e)}))]}}))}))},e.prototype.file=function(e){return xe(this,void 0,void 0,(function(){var t,n,r,i,o,a;return Ce(this,(function(s){switch(s.label){case 0:return e.size<=k?(t=this.append,[4,this.readAsUint8Array(e)]):[3,2];case 1:return t.apply(this,[s.sent()]),[2,this.compute()];case 2:n=Math.ceil(e.size/k),r=0,s.label=3;case 3:return r<n?(i=r*k,o=r===n-1?e.size:i+k,[4,this.readAsUint8Array(e.slice(i,o))]):[3,6];case 4:a=s.sent(),this.append(new Uint8Array(a)),s.label=5;case 5:return r++,[3,3];case 6:return[2,this.compute()]}}))}))},e.file=function(t){var n=new e;return n.file(t)},e}(),De=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ke=function(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(t){o(t)}}function s(e){try{l(r["throw"](e))}catch(t){o(t)}}function l(e){e.done?n(e.value):i(e.value).then(a,s)}l((r=r.apply(e,t||[])).next())}))},Ee=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(e){return function(t){return l([e,t])}}function l(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},_e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return De(t,e),t.prototype.run=function(){return ke(this,void 0,void 0,(function(){var e,t,n,r,i,o=this;return Ee(this,(function(a){switch(a.label){case 0:return this.logger.info("start run Direct."),e=new FormData,e.append("file",this.file),e.append("token",this.token),null!=this.key&&e.append("key",this.key),e.append("fname",this.putExtra.fname),this.config.checkByServer?[4,Te.file(this.file)]:[3,2];case 1:t=a.sent(),e.append("crc32",t.toString()),a.label=2;case 2:return this.putExtra.customVars&&(this.logger.info("init customVars."),n=this.putExtra.customVars,Object.keys(n).forEach((function(t){return e.append(t,n[t].toString())})),this.logger.info("customVars inited.")),this.putExtra.metadata&&(this.logger.info("init metadata."),r=this.putExtra.metadata,Object.keys(r).forEach((function(t){return e.append(t,r[t].toString())}))),this.logger.info("formData inited."),[4,re(this.uploadHost.getUrl(),e,{onProgress:function(e){o.updateDirectProgress(e.loaded,e.total)},onCreate:function(e){return o.addXhr(e)}})];case 3:return i=a.sent(),this.logger.info("Direct progress finish."),this.finishDirectProgress(),[2,i]}}))}))},t.prototype.updateDirectProgress=function(e,t){this.progress={total:this.getProgressInfoItem(e,t+1)},this.onData(this.progress)},t.prototype.finishDirectProgress=function(){if(!this.progress)return this.logger.warn("progress is null."),this.progress={total:this.getProgressInfoItem(this.file.size,this.file.size)},void this.onData(this.progress);var e=this.progress.total;this.progress={total:this.getProgressInfoItem(e.loaded+1,e.size)},this.onData(this.progress)},t}(me),Ae=_e;function Le(e,t,n){void 0===n&&(n=3);var r=B();r.open("POST","https://uplog.qbox.me/log/3"),r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.setRequestHeader("Authorization",M(e).Authorization),r.onreadystatechange=function(){4===r.readyState&&200!==r.status&&n>0&&Le(e,t,n-1)};var i=[t.code||"",t.reqId||"",t.host||"",t.remoteIp||"",t.port||"",t.duration||"",t.time||"",t.bytesSent||"",t.upType||"",t.size||""].join(",");r.send(i)}var Oe=function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{while((void 0===t||t-- >0)&&!(r=o.next()).done)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}return a},Re=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Oe(arguments[t]));return e},Ie=function(){function e(t,n,r,i){void 0===n&&(n=!0),void 0===r&&(r="OFF"),void 0===i&&(i="UPLOAD"),this.token=t,this.disableReport=n,this.level=r,this.prefix=i,this.id=++e.id}return e.prototype.getPrintPrefix=function(e){return"Qiniu-JS-SDK ["+e+"]["+this.prefix+"#"+this.id+"]:"},e.prototype.report=function(e,t){if(!this.disableReport)try{Le(this.token,e,t)}catch(n){this.warn(n)}},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=["INFO"];n.includes(this.level)&&console.log.apply(console,Re([this.getPrintPrefix("INFO")],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=["INFO","WARN"];n.includes(this.level)&&console.warn.apply(console,Re([this.getPrintPrefix("WARN")],e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=["INFO","WARN","ERROR"];n.includes(this.level)&&console.error.apply(console,Re([this.getPrintPrefix("ERROR")],e))},e.id=0,e}(),Pe=Ie,Me=function(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(t){o(t)}}function s(e){try{l(r["throw"](e))}catch(t){o(t)}}function l(e){e.done?n(e.value):i(e.value).then(a,s)}l((r=r.apply(e,t||[])).next())}))},Ne=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(e){return function(t){return l([e,t])}}function l(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},Fe=function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{while((void 0===t||t-- >0)&&!(r=o.next()).done)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}return a},Be=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Fe(arguments[t]));return e},$e=new Map,ze=function(){function e(e,t){this.host=e,this.protocol=t}return e.prototype.isFrozen=function(){var e=(new Date).getTime(),t=$e.get(this.host);return null!=t&&t>=e},e.prototype.freeze=function(e){void 0===e&&(e=20);var t=(new Date).getTime()+1e3*e;$e.set(this.host,t)},e.prototype.unfreeze=function(){$e["delete"](this.host)},e.prototype.getUrl=function(){return this.protocol+"://"+this.host},e.prototype.getUnfreezeTime=function(){return $e.get(this.host)},e}(),Ue=function(){function e(e){void 0===e&&(e=[]),this.initHosts=e,this.cachedHostsMap=new Map}return e.prototype.register=function(e,t,n,r){this.cachedHostsMap.set(e+"@"+t,n.map((function(e){return new ze(e,r)})))},e.prototype.refresh=function(e,t,n){var r,i,o,a;return Me(this,void 0,void 0,(function(){var s,l,u;return Ne(this,(function(c){switch(c.label){case 0:return s=this.cachedHostsMap.get(e+"@"+t)||[],s.length>0?[2]:this.initHosts.length>0?(this.register(e,t,this.initHosts,n),[2]):[4,Q(e,t,n)];case 1:return l=c.sent(),null!=(null===l||void 0===l?void 0:l.data)&&(u=Be((null===(i=null===(r=l.data.up)||void 0===r?void 0:r.acc)||void 0===i?void 0:i.main)||[],(null===(a=null===(o=l.data.up)||void 0===o?void 0:o.acc)||void 0===a?void 0:a.backup)||[]),this.register(e,t,u,n)),[2]}}))}))},e.prototype.getUp=function(e,t,n){return Me(this,void 0,void 0,(function(){var r,i,o;return Ne(this,(function(a){switch(a.label){case 0:return[4,this.refresh(e,t,n)];case 1:return a.sent(),r=this.cachedHostsMap.get(e+"@"+t)||[],0===r.length?[2,null]:(i=r.filter((function(e){return!e.isFrozen()})),i.length>0?[2,i[0]]:(o=r.slice().sort((function(e,t){return(e.getUnfreezeTime()||0)-(t.getUnfreezeTime()||0)})),[2,o[0]]))}}))}))},e}();function Ve(e,t,n,r){return e.config&&e.config.forceDirect?(r.info("ues forceDirect mode."),new Ae(e,t,n,r)):e.file.size>4*k?(r.info("file size over 4M, use Resume."),new Se(e,t,n,r)):(r.info("file size less or equal than 4M, use Direct."),new Ae(e,t,n,r))}function He(e,t,n,r,i){var o=new Pe(n,null===i||void 0===i?void 0:i.disableStatisticsReport,null===i||void 0===i?void 0:i.debugLogLevel,e.name),a={file:e,key:t,token:n,putExtra:r,config:Ke(i,o)},s=new Ue(a.config.uphost);return new h((function(e){var t=Ve(a,{onData:function(t){return e.next(t)},onError:function(t){return e.error(t)},onComplete:function(t){return e.complete(t)}},s,o);return t.putFile(),t.stop.bind(t)}))}var je=function(){return je=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},je.apply(this,arguments)},qe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},Ge=function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{while((void 0===t||t-- >0)&&!(r=o.next()).done)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}return a},We=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Ge(arguments[t]));return e};function Ke(e,t){var n=je({},e),r=n.upprotocol,i=n.uphost,o=qe(n,["upprotocol","uphost"]),a=je({uphost:[],retryCount:3,checkByMD5:!1,forceDirect:!1,useCdnDomain:!0,checkByServer:!1,concurrentRequestLimit:3,chunkSize:ue,upprotocol:"https",debugLogLevel:"OFF",disableStatisticsReport:!1},o);r&&(a.upprotocol=r.replace(/:$/,""));var s=[];if(t&&null!=(null===e||void 0===e?void 0:e.uphost)&&null!=(null===e||void 0===e?void 0:e.region)&&t.warn("do not use both the uphost and region config."),i)Array.isArray(i)?s.push.apply(s,We(i)):s.push(i);else if(null===a||void 0===a?void 0:a.region){var l=W[null===a||void 0===a?void 0:a.region];a.useCdnDomain?s.push.apply(s,We(l.cdnUphost)):s.push.apply(s,We(l.srcUphost))}return je(je({},a),{uphost:s.filter(Boolean)})}var Ye=function(){return Ye=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ye.apply(this,arguments)},Xe=function(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(t){o(t)}}function s(e){try{l(r["throw"](e))}catch(t){o(t)}}function l(e){e.done?n(e.value):i(e.value).then(a,s)}l((r=r.apply(e,t||[])).next())}))},Je=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(e){return function(t){return l([e,t])}}function l(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},Qe={PNG:"image/png",JPEG:"image/jpeg",WEBP:"image/webp",BMP:"image/bmp"},Ze=4,et=Math.log(2),tt=Object.keys(Qe).map((function(e){return Qe[e]})),nt=Qe.JPEG;function rt(e){return tt.includes(e)}(function(){function e(e,t){this.file=e,this.config=t,this.config=Ye({quality:.92,noCompressIfLarger:!1},this.config)}e.prototype.process=function(){return Xe(this,void 0,void 0,(function(){var e,t,n,i,a,s;return Je(this,(function(l){switch(l.label){case 0:if(this.outputType=this.file.type,e={},!rt(this.file.type))throw new o(r.UnsupportedFileType,"unsupported file type: "+this.file.type);return[4,this.getOriginImage()];case 1:return t=l.sent(),[4,this.getCanvas(t)];case 2:return n=l.sent(),i=1,this.config.maxWidth&&(i=Math.min(1,this.config.maxWidth/n.width)),this.config.maxHeight&&(i=Math.min(1,i,this.config.maxHeight/n.height)),e.width=n.width,e.height=n.height,[4,this.doScale(n,i)];case 3:return a=l.sent(),s=this.toBlob(a),s.size>this.file.size&&this.config.noCompressIfLarger?[2,{dist:this.file,width:e.width,height:e.height}]:[2,{dist:s,width:a.width,height:a.height}]}}))}))},e.prototype.clear=function(e,t,n){this.outputType===nt?(e.fillStyle="#fff",e.fillRect(0,0,t,n)):e.clearRect(0,0,t,n)},e.prototype.getOriginImage=function(){var e=this;return new Promise((function(t,n){var r=q(e.file),i=new Image;i.onload=function(){t(i)},i.onerror=function(){n("image load error")},i.src=r}))},e.prototype.getCanvas=function(e){var t=this;return new Promise((function(n,i){var a=document.createElement("canvas"),s=a.getContext("2d");if(s){var l=e.width,u=e.height;a.height=u,a.width=l,t.clear(s,l,u),s.drawImage(e,0,0),n(a)}else i(new o(r.GetCanvasContextFailed,"context is null"))}))},e.prototype.doScale=function(e,t){return Xe(this,void 0,void 0,(function(){var n,i,a,s,l,u,c,d,f,h,m,p,g,v,b,y;return Je(this,(function(w){if(1===t)return[2,e];if(n=e.getContext("2d"),i=Math.min(Ze,Math.ceil(1/t/et)),a=Math.pow(t,1/i),s=document.createElement("canvas"),l=s.getContext("2d"),u=e.width,c=e.height,d=u,f=c,s.width=u,s.height=c,!l||!n)throw new o(r.GetCanvasContextFailed,"mctx or sctx can't be null");for(p=0;p<i;p++)g=u*a|0,v=c*a|0,p===i-1&&(g=d*t,v=f*t),p%2===0?(h=e,m=l):(h=s,m=n),this.clear(m,u,c),m.drawImage(h,0,0,u,c,0,0,g,v),u=g,c=v;return b=h===e?s:e,y=m.getImageData(0,0,u,c),b.width=u,b.height=c,m.putImageData(y,0,0),[2,b]}))}))},e.prototype.toBlob=function(e){var t=e.toDataURL(this.outputType,this.config.quality),n=atob(t.split(",")[1]).split("").map((function(e){return e.charCodeAt(0)})),r=new Blob([new Uint8Array(n)],{type:this.outputType});return r}})()},4056:function(e,t,n){"use strict";var r=n("c54e"),i=n("1515");e.exports=!r((function(){var e=new Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",i(1,7)),7!==e.stack)}))},"40a5":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}),t("BasicTable",{ref:"orderTable",attrs:{columns:e.table.columns,headerOperates:e.headerOperates,selectType:"multi",operates:e.operates,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,"row-key":e.getRowKeys,operateWidth:"250px",total:e.table.total,reserveSelection:!0},on:{"selection-change":e.handleSelectionChange,"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange},scopedSlots:e._u([{key:"marketPrice",fn:function(n){return t("div",{},[t("div",[e._v(e._s(n.row.marketPrice))]),t("div",{staticClass:"detail-price"},[t("div",[e._v("已收："+e._s(n.row.receivedPrice))]),t("div",[e._v("未收："+e._s(n.row.marketPrice-n.row.receivedPrice))])])])}}])}),t("add-dialog",{ref:"addDialog",on:{success:e.handleSuccess}}),t("create-collection-dialog",{ref:"collectionDialog",on:{success:e.handleSuccess}}),t("order-detail",{ref:"detailRef"}),t("openCourse",{ref:"openCourse",on:{success:e.handleSuccess}})],1)},i=[],o=n("7591"),a=n("b775"),s=n("ee0e"),l=n("b893"),u=n("29ed"),c=n("f264"),d=n("2a9b"),f=n("88e2");const h=[{value:0,label:"未开通"},{value:1,label:"已开通"},{value:2,label:"已停课"}];var m={name:"orderPage",components:{BasicTable:o["a"],addDialog:s["default"],CreateCollectionDialog:u["default"],orderDetail:c["default"],openCourse:f["default"]},data(){return{loading:!1,filterOptions:{column:[{type:"input",label:"订单号",value:"orderNum"},{type:"user",userType:0,label:"利润归属",value:"profitAdId"},{type:"user",userType:1,label:"下单人",value:"vipAdId"},{type:"user",userType:0,label:"操作人",value:"createAdId"},{type:"select",label:"订单状态",value:"status",options:d["b"]},{type:"select",label:"开通状态",value:"openStatus",options:h},{type:"timeAll",label:["下单开始时间","下单开始时间"],value:"placeOrderTime"},{type:"timeAll",label:["订单开始时间","订单结束时间"],value:"writeOffTime"}]},selectList:[],filterData:{orderNum:"",profitAdId:"",vipAdId:"",createAdId:"",status:"",openStatus:"",placeOrderTime:[],writeOffTime:[]},table:{columns:[{id:1,prop:"orderNum",minWidth:"160px",label:"订单号",width:200},{id:2,prop:"courseName",label:"套餐名称",minWidth:"180px"},{id:3,prop:"vipName",label:"客户名称",width:"80px"},{id:14,prop:"profitAdName",label:"利润归属",width:"80px"},{id:4,prop:"count",label:"数量",width:"50px"},{id:6,prop:"marketPrice",label:"总销售价",renderName:"marketPrice",width:"120px"},{id:7,prop:"marketPrice",label:"总结算价",width:"80px"},{id:8,prop:"vipName",label:"下单人",width:"100px"},{id:20,prop:"vipAccount",label:"下单账号",width:"100px"},{id:21,prop:"vipPhone",label:"下单手机号",width:"120px"},{id:9,prop:"profitAdName",label:"销售人员",width:"100px"},{id:10,prop:"createAdName",label:"操作人员",width:"80px"},{id:11,prop:"status",label:"订单状态",render:e=>{const t=d["b"].find(t=>t.value==e.status);return t?t.label:""},width:"80px"},{id:12,prop:"openStatus",label:"开通状态",render:e=>1===e.openStatus?"已开通":0===e.openStatus?"未开通":"已停课",width:"80px"},{id:13,prop:"createTime",label:"下单时间",sortable:!0,minWidth:"180px",type:"date",width:"180px"},{id:15,prop:"time",label:"开始/结束时间",minWidth:"200px",render:e=>e.startTime?`${Object(l["b"])(e.startTime,"yyyy-MM-dd")}至${Object(l["b"])(e.endTime,"yyyy-MM-dd")}`:"",width:"180px"}],pageSize:20,currentPage:1,data:[],total:0},operates:[{key:"create",title:"创建收款",btnStyle:"blue",permission:"system/sysCourseOrderBills/add",action:(e,t)=>{this.$refs.collectionDialog.open(t.orderNum)},show:e=>!0},{key:"openCourse",title:"开通课程",btnStyle:"yellow",permission:"system/sysCourseOrder/openCourseEdit",action:(e,t)=>{this.$refs.openCourse.edit(t)},show:e=>0===e.openStatus},{key:"detail",title:"详情",btnStyle:"green",permission:"system/sysVipOrderCourse/stopCourse",action:(e,t)=>{this.$refs.detailRef.open(t.orderNum)},show:e=>!0},{key:"updateOrder",title:"修改订单",btnStyle:"yellow",permission:"system/sysCourseOrder/orderEdit",action:(e,t)=>{console.log(t),this.$refs.addDialog.edit(t)},show:e=>!0},{key:"cancelOrder",title:"取消订单",btnStyle:"red",permission:"system/sysCourseOrder/cancelOrder",action:(e,t)=>{this.cancelOrder(t.orderNum)},show:e=>7!==e.status}],headerOperates:[{key:"el-icon-plus",name:"快捷下单",permission:"system/sysCourseOrder/quicklyPlaceOrderAdd",action:()=>{this.$refs.addDialog.open()}},{key:"export",name:"导出",permission:"system/sysCourseOrder/exportSalesData",action:()=>{this.handleExport()}}]}},created(){this.getList()},methods:{cancelOrder(e){this.$confirm("确定取消订单吗?取消后该学员订单内的所有课程将都无法观看","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/system/sysCourseOrder/cancelOrder",params:{orderNum:e},success:e=>{this.$message.success("操作成功"),this.searchFilter()}})}).catch(()=>{})},searchFilter(){this.$nextTick(()=>{this.$refs.orderTable.$refs.basicTable.$refs.multipleTable.clearSelection()}),this.table.currentPage=1,this.getList()},getList(){this.loading=!0;const{placeOrderTime:e,writeOffTime:t,...n}=this.filterData;a["a"].post({url:"/system/sysCourseOrder/salesOrderList",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,placeOrderStartTime:e&&e.length>1?e[0]:void 0,placeOrderEndTime:e&&e.length>1?e[1]:void 0,writeOffStartTime:t&&t.length>1?t[0]:void 0,writeOffEndTime:t&&t.length>1?t[1]:void 0,...n},success:e=>{this.table.data=e.list,this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1}})},handleExport(){this.$confirm("确定导出销售订单吗？导出的时候请等待页面下载自动开始，如果数据量大，可能会等待稍长时间，请不要关闭或者刷新页面","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$message.warning("请耐心等待，表格正在导出中......");const{placeOrderTime:e,writeOffTime:t,...n}=this.filterData;a["a"].post({url:"/system/sysCourseOrder/exportSalesData",params:{placeOrderStartTime:e&&e.length>1?e[0]:void 0,placeOrderEndTime:e&&e.length>1?e[1]:void 0,writeOffStartTime:t&&t.length>1?t[0]:void 0,writeOffEndTime:t&&t.length>1?t[1]:void 0,...n},success:e=>{let t=document.createElement("a");t.href="https://"+e,document.body.appendChild(t),t.click(),document.body.removeChild(t),this.$message.success("导出成功"),this.searchFilter()}})}).catch(()=>{this.$message.info("已取消导出")})},handleSuccess(){this.getList()},clearFilter(){this.filterData={orderNum:"",profitAdId:"",vipAdId:"",createAdId:"",status:"",openStatus:"",placeOrderTime:[],writeOffTime:[]},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()},handleSelectionChange(e){this.selectList=e},getRowKeys(e){return e.id}}},p=m,g=(n("ecc2"),n("1805")),v=Object(g["a"])(p,r,i,!1,null,"29d4a162",null);t["default"]=v.exports},4234:function(e,t,n){"use strict";n("d946")},"43b6":function(e,t,n){"use strict";n("f8c2")},"43d0":function(e,t,n){"use strict";n("b9fd")},"43d4":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{ref:"filter",attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}),t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total,"table-remark":e.totalData},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange}})],1)},i=[],o=n("7591"),a=n("b775"),s=n("787e"),l=n("b893"),u={name:"adverstPage",components:{BasicTable:o["a"]},data(){return{totalData:"",loading:!1,categoryOptions:[],filterOptions:{column:[{type:"select",label:"推广渠道",value:"channelId",valueKey:"id",labelKey:"name",options:[]},{type:"user",userType:0,label:"推广员",value:"createAdId"},{type:"cascader",label:"部门",value:"departmentId",ref:"departmentRef",options:[],props:{value:"id",label:"name",multiple:!0}},{type:"timeAll",label:["添加开始时间","添加结束时间"],value:"time"},{type:"timeAll",label:["删除开始时间","删除结束时间"],value:"rmTime"}]},filterData:{channelId:"",createAdId:"",time:[],rmTime:[],departmentId:[]},table:{columns:[{id:2,prop:"name",label:"推广员"},{id:6,prop:"toDayCount",label:"今日增加"},{id:3,prop:"totalDataCount",label:"总数据"},{id:4,prop:"totalAddCount",label:"总增加"},{id:5,prop:"totalRemoveCount",label:"总删除"},{id:7,prop:"removeCount",label:"今日删除"}],pageSize:300,currentPage:1,data:[],total:0},operates:[],headerOperates:[{key:"export",permission:"admin/adPromotionData/promoterStatisticsListExport",name:"导出",action:()=>{this.handleExport()}}]}},created(){this.getList(),this.getDepartmentList(),this.getTotalData(),Object(s["c"])(e=>{this.filterOptions.column[0].options=e})},methods:{getTotalData(){const{time:e,rmTime:t,...n}=this.filterData;a["a"].post({url:"/admin/adPromotionData/promoterStatisticsData",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,startTime:e&&e.length>1?e[0]:"",endTime:e&&e.length>1?e[1]:"",rmStartTime:t&&t.length>1?t[0]:"",rmEndTime:t&&t.length>1?t[1]:"",...n},success:e=>{this.totalData=e},catch:()=>{this.loading=!1},finally:()=>{this.loading=!1}})},handleExport(){this.$confirm("确定导出推广员统计列表吗？导出的时候请等待页面下载自动开始，如果数据量大，可能会等待稍长时间，请不要关闭或者刷新页面","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$message.warning("请耐心等待，表格正在导出中......");const{time:e,rmTime:t,...n}=this.filterData;a["a"].post({url:"/admin/adPromotionData/promoterStatisticsListExport",params:{startTime:e&&e.length>1?e[0]:"",endTime:e&&e.length>1?e[1]:"",rmStartTime:t&&t.length>1?t[0]:"",rmEndTime:t&&t.length>1?t[1]:"",...n},success:e=>{let t=document.createElement("a");t.href="https://"+e,document.body.appendChild(t),t.click(),document.body.removeChild(t),this.$message.success("导出成功"),this.searchFilter()}})}).catch(()=>{this.$message.info("已取消导出")})},searchFilter(){this.table.currentPage=1,this.getList()},getDepartmentList(){a["a"].post({url:"/admin/adInfo/canChooseCanSeeDepartmentList",params:{...this.addData,id:sessionStorage.getItem("id")},success:e=>{this.departmentList=e,this.filterOptions.column[2].options=Object(l["c"])(e)}})},getList(){this.loading=!0;const{time:e,rmTime:t,...n}=this.filterData;this.$nextTick(()=>{const r=this.$refs.filter.$refs.departmentRef[0].getCheckedNodes().map(e=>e.data.id);a["a"].post({url:"/admin/adPromotionData/promoterStatisticsList",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,startTime:e&&e.length>1?e[0]:"",endTime:e&&e.length>1?e[1]:"",rmStartTime:t&&t.length>1?t[0]:"",rmEndTime:t&&t.length>1?t[1]:"",...n,departmentId:r&&r.length>0?JSON.stringify(r):""},success:e=>{this.table.data=e.list,this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1},finally:()=>{this.loading=!1}})})},handleSuccess(){this.getList()},clearFilter(){this.filterData={channelId:"",createAdId:"",time:[],rmTime:[],departmentId:[]},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()}}},c=u,d=n("1805"),f=Object(d["a"])(c,r,i,!1,null,"30059e5e",null);t["default"]=f.exports},4402:function(e,t){(function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=function(e,t,n){var r="UL"===t?"InsertUnorderedList":"InsertOrderedList";e.execCommand(r,!1,!1===n?null:{"list-style-type":n})},n=function(e){e.addCommand("ApplyUnorderedListStyle",(function(n,r){t(e,"UL",r["list-style-type"])})),e.addCommand("ApplyOrderedListStyle",(function(n,r){t(e,"OL",r["list-style-type"])}))},r=tinymce.util.Tools.resolve("tinymce.util.Tools"),i=function(e){var t=e.getParam("advlist_number_styles","default,lower-alpha,lower-greek,lower-roman,upper-alpha,upper-roman");return t?t.split(/[ ,]/):[]},o=function(e){var t=e.getParam("advlist_bullet_styles","default,circle,square");return t?t.split(/[ ,]/):[]},a=function(){},s=function(e){return function(){return e}},l=function(e){return e},u=s(!1),c=s(!0),d=function(){return f},f=function(){var e=function(e){return e()},t=l,n={fold:function(e,t){return e()},isSome:u,isNone:c,getOr:t,getOrThunk:e,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:s(null),getOrUndefined:s(void 0),or:t,orThunk:e,map:d,each:a,bind:d,exists:u,forall:c,filter:function(){return d()},toArray:function(){return[]},toString:s("none()")};return n}(),h=function(e){var t=s(e),n=function(){return i},r=function(t){return t(e)},i={fold:function(t,n){return n(e)},isSome:c,isNone:u,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return h(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?i:f},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return i},m=function(e){return null===e||void 0===e?f:h(e)},p={some:h,none:d,from:m},g=function(e,t){return e.$.contains(e.getBody(),t)},v=function(e){return e&&/^(TH|TD)$/.test(e.nodeName)},b=function(e){return function(t){return t&&/^(OL|UL|DL)$/.test(t.nodeName)&&g(e,t)}},y=function(e){var t=e.dom.getParent(e.selection.getNode(),"ol,ul"),n=e.dom.getStyle(t,"listStyleType");return p.from(n)},w=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(t(r))return n}return-1},S=function(e){return e.replace(/\-/g," ").replace(/\b\w/g,(function(e){return e.toUpperCase()}))},x=function(e,t,n){var i=w(t.parents,v),o=-1!==i?t.parents.slice(0,i):t.parents,a=r.grep(o,b(e));return a.length>0&&a[0].nodeName===n},C=function(e,t){return function(n){var r=function(r){n.setActive(x(e,r,t))};return e.on("NodeChange",r),function(){return e.off("NodeChange",r)}}},T=function(e,n,i,o,a,s){e.ui.registry.addSplitButton(n,{tooltip:i,icon:"OL"===a?"ordered-list":"unordered-list",presets:"listpreview",columns:3,fetch:function(e){var t=r.map(s,(function(e){var t="OL"===a?"num":"bull",n="disc"===e||"decimal"===e?"default":e,r="default"===e?"":e,i=S(e);return{type:"choiceitem",value:r,icon:"list-"+t+"-"+n,text:i}}));e(t)},onAction:function(){return e.execCommand(o)},onItemAction:function(n,r){t(e,a,r)},select:function(t){var n=y(e);return n.map((function(e){return t===e})).getOr(!1)},onSetup:C(e,a)})},D=function(e,t,n,r,i,o){e.ui.registry.addToggleButton(t,{active:!1,tooltip:n,icon:"OL"===i?"ordered-list":"unordered-list",onSetup:C(e,i),onAction:function(){return e.execCommand(r)}})},k=function(e,t,n,r,i,o){o.length>1?T(e,t,n,r,i,o):D(e,t,n,r,i)},E=function(e){k(e,"numlist","Numbered list","InsertOrderedList","OL",i(e)),k(e,"bullist","Bullet list","InsertUnorderedList","UL",o(e))};function _(){e.add("advlist",(function(e){e.hasPlugin("lists")?(E(e),n(e)):console.error("Please use the Lists plugin together with the Advanced List plugin.")}))}_()})()},4460:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.addModifyVisible,width:"50%"},on:{"update:visible":function(t){e.addModifyVisible=t},close:e.close}},[t("el-form",{ref:"adminRef",attrs:{model:e.addData,rules:e.adminRule,"label-position":"right","label-width":"90px"}},[t("el-form-item",{attrs:{label:"用户账号:"}},[t("span",{staticClass:"warm_box"},[t("i",{staticClass:"el-icon-info"}),e._v("系统将自动生成用户名")])]),t("el-form-item",{attrs:{label:"角色权限:",prop:"roleIds"}},[t("el-checkbox-group",{model:{value:e.addData.roleIds,callback:function(t){e.$set(e.addData,"roleIds",t)},expression:"addData.roleIds"}},e._l(e.rolesOptions,(function(n){return t("el-checkbox",{key:n.id,attrs:{label:n.id}},[e._v(e._s(n.roleName))])})),1)],1),t("el-form-item",{attrs:{label:"真实姓名:",prop:"name"}},[t("jat-input",{attrs:{placeholder:"请输入真实姓名"},model:{value:e.addData.name,callback:function(t){e.$set(e.addData,"name",t)},expression:"addData.name"}})],1),t("el-form-item",{attrs:{label:"联系电话:",prop:"phone"}},[t("jat-input",{attrs:{placeholder:"请输入联系电话"},model:{value:e.addData.phone,callback:function(t){e.$set(e.addData,"phone",t)},expression:"addData.phone"}})],1),t("el-form-item",{attrs:{label:"QQ:",prop:"qq"}},[t("jat-input",{attrs:{placeholder:"请输入QQ"},model:{value:e.addData.qq,callback:function(t){e.$set(e.addData,"qq",t)},expression:"addData.qq"}})],1),t("el-form-item",{attrs:{label:"微信:",prop:"wechatNum"}},[t("jat-input",{attrs:{placeholder:"请输入微信"},model:{value:e.addData.wechatNum,callback:function(t){e.$set(e.addData,"wechatNum",t)},expression:"addData.wechatNum"}})],1),t("el-form-item",{attrs:{label:"用户密码:",prop:"password"}},[t("jat-input",{attrs:{placeholder:"请输入用户密码，不填系统将会生成随机密码（以短信的方式通知密码给后台账号持有人）"},model:{value:e.addData.password,callback:function(t){e.$set(e.addData,"password",t)},expression:"addData.password"}})],1),t("el-form-item",{attrs:{label:"性别:",prop:"gender"}},[t("jat-select",{attrs:{placeholder:"请输入性别"},model:{value:e.addData.gender,callback:function(t){e.$set(e.addData,"gender",t)},expression:"addData.gender"}},[t("el-option",{attrs:{label:"男",value:1}}),t("el-option",{attrs:{label:"女",value:2}})],1)],1),t("el-form-item",{attrs:{label:"部门",prop:"departmentId"}},[t("el-cascader",{staticStyle:{width:"100%"},attrs:{size:"small",clearable:"",options:e.departmentOptions,props:{label:"name",value:"id",emitPath:!1}},model:{value:e.addData.departmentId,callback:function(t){e.$set(e.addData,"departmentId",t)},expression:"addData.departmentId"}})],1),t("el-form-item",{attrs:{label:"用户状态:",prop:"status"}},[t("jat-select",{attrs:{placeholder:"请选择用户状态"},model:{value:e.addData.status,callback:function(t){e.$set(e.addData,"status",t)},expression:"addData.status"}},[t("el-option",{attrs:{label:"正常",value:0}}),t("el-option",{attrs:{label:"冻结",value:1}}),t("el-option",{attrs:{label:"禁用",value:2}})],1)],1),t("el-form-item",{attrs:{label:"可查看部门:",prop:"canSeeDepartment"}},[t("el-tree",{ref:"departmentRef",attrs:{data:e.canSeeDepartmentList,"node-key":"id","show-checkbox":"","default-expand-all":"","highlight-current":"",props:e.defaultProps}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)],1)},i=[],o=n("cbc3"),a=n("b775"),s=n("9adf"),l=n("b893"),u=n("5258"),c={components:{uploadImage:o["a"],tinymceEdit:s["a"]},data(){return{addModifyVisible:!1,dialogTitle:"",accountVisible:!1,addData:{roleIds:[],name:"",phone:"",qq:"",wechatNum:"",password:"",gender:"",departmentId:"",status:"",canSeeDepartment:[],id:""},departmentOptions:[],rolesOptions:[],canSeeDepartmentList:[],defaultProps:{label:"name",value:"id"},adminRule:{gender:[{required:!0,message:"请选择性别",trigger:"blur"}],name:[{required:!0,message:"请输入真实姓名",trigger:"blur"}],phone:[{required:!0,message:"请输入联系电话",trigger:"blur"}],departmentId:[{required:!0,message:"请选择部门",trigger:"blur"}],status:[{required:!0,message:"请选择用户状态",trigger:"blur"}]}}},mounted(){},methods:{open(){this.dialogTitle="添加管理员",this.addData.name="",this.getcanSeeDepartmentList(),this.getRolesOptions(),this.addModifyVisible=!0},close(){this.$refs.adminRef&&this.$refs.adminRef.clearValidate(),this.$refs.departmentRef.setCheckedKeys([]),this.addData={roleIds:[],name:"",phone:"",qq:"",wechatNum:"",password:"",gender:"",departmentId:"",status:"",canSeeDepartment:[],id:""},this.addModifyVisible=!1},getcanSeeDepartmentList(){a["a"].post({url:"/admin/adInfo/canChooseCanSeeDepartmentList",params:{id:sessionStorage.getItem("id")},success:e=>{this.canSeeDepartmentList=Object(l["c"])(e),this.departmentOptions=this.canSeeDepartmentList}})},getRolesOptions(){a["a"].post({url:"/admin/adRole/list",params:{pageNo:1,pageSize:50},success:e=>{this.rolesOptions=e.list}})},handleSubmit(){this.$refs.adminRef.validate(e=>{const{roleIds:t,password:n,...r}=this.addData,i=this.$refs.departmentRef.getCheckedKeys();e&&(this.addData.id?a["a"].post({url:"/admin/adInfo/editAdmin",params:{...r,canSeeDepartment:i?JSON.stringify(i):void 0,roleIds:JSON.stringify(t)},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}):a["a"].post({url:"/admin/adInfo/addAdmin",params:{...r,canSeeDepartment:i?JSON.stringify(i):void 0,password:u["a"].encryptByPublicKey(n),roleIds:JSON.stringify(t)},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}))})}}},d=c,f=(n("ab41"),n("1805")),h=Object(f["a"])(d,r,i,!1,null,"54d1552c",null);t["default"]=h.exports},4504:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.addModifyVisible,width:"70%"},on:{"update:visible":function(t){e.addModifyVisible=t},close:e.close}},[t("el-form",{ref:"articleRef",attrs:{model:e.addData,rules:e.articleRule,"label-position":"right","label-width":"140px"}},[t("el-form-item",{attrs:{label:"文章标题:",prop:"title"}},[t("jat-input",{attrs:{placeholder:"请输入文章标题"},model:{value:e.addData.title,callback:function(t){e.$set(e.addData,"title",t)},expression:"addData.title"}})],1),t("el-form-item",{attrs:{label:"文章分类:",prop:"categoryId"}},[t("jat-select",{attrs:{placeholder:"请选择文章分类",clearable:"",filterable:""},model:{value:e.addData.categoryId,callback:function(t){e.$set(e.addData,"categoryId",t)},expression:"addData.categoryId"}},e._l(e.categoryOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"封面:",prop:"imgUrl"}},[t("upload-image",{model:{value:e.addData.imgUrl,callback:function(t){e.$set(e.addData,"imgUrl",t)},expression:"addData.imgUrl"}})],1),t("el-form-item",{attrs:{label:"排序:",prop:"sort"}},[t("jat-input",{directives:[{name:"input",rawName:"v-input.int",modifiers:{int:!0}}],attrs:{placeholder:"请输入排序"},model:{value:e.addData.sort,callback:function(t){e.$set(e.addData,"sort",t)},expression:"addData.sort"}})],1),t("el-form-item",{attrs:{label:"文章外链:",prop:"href"}},[t("jat-input",{attrs:{placeholder:"请输入文章外链"},model:{value:e.addData.href,callback:function(t){e.$set(e.addData,"href",t)},expression:"addData.href"}}),t("div",{staticClass:"wram-box"},[t("i",{staticClass:"el-icon-info"}),e._v("文章外部链接;设置后优先使用外部链接。 ")])],1),e.addData.id?t("el-form-item",{attrs:{label:"文章状态:",prop:"status"}},[t("jat-select",{attrs:{placeholder:"请选择文章状态",clearable:""},model:{value:e.addData.status,callback:function(t){e.$set(e.addData,"status",t)},expression:"addData.status"}},[t("el-option",{attrs:{label:"正常",value:0}}),t("el-option",{attrs:{label:"下架",value:1}})],1)],1):e._e(),t("el-form-item",{attrs:{label:"SEO标题:",prop:"seoTitle"}},[t("jat-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入SEO标题"},model:{value:e.addData.seoTitle,callback:function(t){e.$set(e.addData,"seoTitle",t)},expression:"addData.seoTitle"}})],1),t("el-form-item",{attrs:{label:"SEO关键字:",prop:"seoKey"}},[t("jat-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入SEO关键字"},model:{value:e.addData.seoKey,callback:function(t){e.$set(e.addData,"seoKey",t)},expression:"addData.seoKey"}})],1),t("el-form-item",{attrs:{label:"SEO描述:",prop:"seoContent"}},[t("jat-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入SEO关键字"},model:{value:e.addData.seoContent,callback:function(t){e.$set(e.addData,"seoContent",t)},expression:"addData.seoContent"}})],1),t("el-form-item",{attrs:{label:"文章简短描述:",prop:"overview"}},[t("jat-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入课文章简短描述"},model:{value:e.addData.overview,callback:function(t){e.$set(e.addData,"overview",t)},expression:"addData.overview"}})],1),t("el-form-item",{attrs:{label:"发布者:",prop:"createAdId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",clearable:"",filterable:"",remote:"",placeholder:"默认为登录账户","remote-method":e.remoteMethod,loading:e.remoteLoading},model:{value:e.addData.createAdId,callback:function(t){e.$set(e.addData,"createAdId",t)},expression:"addData.createAdId"}},e._l(e.parentAdIdOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"文章详细描述:",prop:"content"}},[t("tinymce-edit",{model:{value:e.addData.content,callback:function(t){e.$set(e.addData,"content",t)},expression:"addData.content"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)],1)},i=[],o=n("c46c"),a=n("cbc3"),s=n("b775"),l=n("9adf"),u={components:{uploadFile:o["a"],uploadImage:a["a"],tinymceEdit:l["a"]},data(){return{addModifyVisible:!1,remoteLoading:!1,categoryOptions:[],dialogTitle:"",addData:{id:"",title:"",categoryId:"",content:"",href:"",createAdId:"",imgUrl:"",overview:"",seoContent:"",seoKey:"",seoTitle:"",status:0,sort:255},parentAdIdOptions:[],articleRule:{title:[{required:!0,message:"请输入文章标题",trigger:"blur"}],categoryId:[{required:!0,message:"请选择文章分类",trigger:"blur"}],content:[{required:!0,message:"请输入文章详细描述",trigger:"blur"}]}}},mounted(){this.getCurrentUser(),this.getCategoryList()},methods:{open(){this.dialogTitle="添加文章",this.addModifyVisible=!0},edit({id:e,title:t,categoryId:n,content:r,status:i,href:o,createAdId:a,createAdName:s,imgUrl:l,overview:u,seoContent:c,seoKey:d,seoTitle:f,sort:h}){this.dialogTitle="编辑文章",this.addModifyVisible=!0,this.addData={id:e,title:t,categoryId:n,content:r,href:o,createAdId:a,createAdName:s,imgUrl:l,overview:u,seoContent:c,seoKey:d,status:i,seoTitle:f,sort:h},this.teacherOptions=[{id:a,name:s}]},close(){this.$refs.articleRef&&this.$refs.articleRef.clearValidate(),this.addData={id:"",title:"",categoryId:"",content:"",href:"",createAdId:"",imgUrl:"",overview:"",status:0,seoContent:"",seoKey:"",seoTitle:"",sort:255},this.addModifyVisible=!1},getCurrentUser(){this.parentAdIdOptions=[{id:sessionStorage.getItem("id")?parseInt(sessionStorage.getItem("id")):"",name:sessionStorage.getItem("userName")}],this.addData.createAdId=parseInt(sessionStorage.getItem("id"))},handleSubmit(){this.$refs.articleRef.validate(e=>{const{id:t,...n}=this.addData;e&&(t?s["a"].post({url:"/system/sysArticle/edit",params:{id:t,...n},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}):s["a"].post({url:"/system/sysArticle/add",params:{...n},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}))})},getCategoryList(){s["a"].post({url:"system/sysCategory/listNoPage",params:{type:1},success:e=>{this.categoryOptions=e}})},remoteMethod(e){e&&(this.remoteLoading=!0,s["a"].post({url:"/admin/adInfo/queryAdminByNameOrPhone",params:{search:e},success:e=>{this.remoteLoading=!1,this.parentAdIdOptions=e},catch:()=>{this.remoteLoading=!1}}))}}},c=u,d=(n("82f3"),n("1805")),f=Object(d["a"])(c,r,i,!1,null,"3eb48ec4",null);t["default"]=f.exports},"456c":function(e,t,n){"use strict";n("f14f")},"458a":function(e,t,n){n("1ac1")},"459b":function(e,t,n){"use strict";n("b488")},"46bb":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-drawer",{attrs:{visible:e.drawer,title:"详情"},on:{"update:visible":function(t){e.drawer=t}}},[t("el-descriptions",{staticClass:"margin-top",attrs:{column:1,border:""}},[t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-unlock"}),e._v(" 角色权限 ")]),e._v(" "+e._s(e.info.roles)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-user"}),e._v(" 用户名 ")]),e._v(" "+e._s(e.info.account)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-user"}),e._v(" 真实姓名 ")]),e._v(" "+e._s(e.info.name)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-mobile-phone"}),e._v(" 联系电话 ")]),e._v(" "+e._s(e.info.phone)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[t("svg-icon",{attrs:{"icon-class":"wechat"}}),e._v(" 微信 ")],1),e._v(" "+e._s(e.info.qq)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[t("svg-icon",{attrs:{"icon-class":"qq"}}),e._v(" QQ ")],1),e._v(" "+e._s(e.info.wechat)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[t("svg-icon",{attrs:{"icon-class":"gender"}}),e._v(" 性别 ")],1),e._v(" "+e._s(e.info.gender)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[t("svg-icon",{attrs:{"icon-class":"department"}}),e._v(" 部门 ")],1),e._v(" "+e._s(e.info.departments)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[t("i",{staticClass:"el-icon-tickets"}),e._v(" 用户状态 ")]),t("el-tag",{attrs:{type:e.statusDic[e.info.status].type,size:"small"}},[e._v(e._s(e.statusDic[e.info.status].label))])],2)],1)],1)],1)},i=[],o={data(){return{drawer:!1,info:{qq:"111",gender:1,adStatus:0,departmentId:12,roles:"角色2,推广专员",wechat:"111",version:0,canSeeDepartment:"[1,11,12,13]",score:0,vipLevel:0,tradeCount:0,createTime:1703572925e3,phone:"111",name:"111",departments:"推广部,优师课堂",id:7,account:"pfk7642",status:0},statusDic:{0:{label:"正常",type:"success"},"-1":{label:"冻结",type:"warning"},"-2":{label:"禁用",type:"danger"},"-3":{label:"未审核",type:"info"}}}},methods:{open(e,t){const{departmentId:n,gender:r,status:i,...o}=e,a=t.find(e=>e.id===n);console.log(a),this.info={departmentId:a?a.name:"",gender:1==r?"男":"女",status:i,...o},this.drawer=!0},close(){this.drawer=!1}}},a=o,s=n("1805"),l=Object(s["a"])(a,r,i,!1,null,"649295a0",null);t["default"]=l.exports},"46d9":function(e,t,n){"use strict";n("2607")},4736:function(e,t,n){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"headerBtn",class:e.name+"-btn",style:{background:e.bgColor}},[e.name.includes("el-icon")?[t("i",{class:e.name}),e._t("default")]:[t("svg-icon",{attrs:{"icon-class":e.name}}),e._t("default")]],2)},i=[],o={name:"HeaderBtn",props:{name:String,bgColor:String},data(){return{}},methods:{}},a=o,s=(n("8ffb"),n("1805")),l=Object(s["a"])(a,r,i,!1,null,"1841434c",null);t["a"]=l.exports},"486f":function(e,t,n){"use strict";n("7d06")},"48ae":function(e,t,n){"use strict";var r=n("887f"),i=n("c7c0"),o=n("4056"),a=Error.captureStackTrace;e.exports=function(e,t,n,s){o&&(a?a(e,t):r(e,"stack",i(n,s)))}},"48ef":function(e,t,n){},"4e01":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}),t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,operates:e.operates,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange}}),t("add-dialog",{ref:"addDialog",on:{success:e.handleSuccess}})],1)},i=[],o=n("7591"),a=n("b775"),s=n("0889"),l={name:"advertisingCategory",components:{BasicTable:o["a"],addDialog:s["default"]},data(){return{loading:!1,filterOptions:{column:[{type:"input",label:"分类名称",value:"name"}]},filterData:{name:""},table:{columns:[{id:1,prop:"name",label:"广告分类名称"},{id:2,prop:"adName",label:"创建人"},{id:3,prop:"createTime",label:"创建时间",type:"date"}],pageSize:20,currentPage:1,data:[],total:0},operates:[{key:"edit",title:"编辑",permission:"system/sysAdvertiseCategory/edit",btnStyle:"yellow",action:(e,t)=>{console.log(t.id),this.$refs.addDialog.edit(t)}},{key:"delete",title:"删除",permission:"system/sysAdvertiseCategory/remove",btnStyle:"red",action:(e,t)=>{this.handleDelete(t)}}],headerOperates:[{key:"el-icon-plus",permission:"system/sysAdvertiseCategory/add",name:"添加广告分类",action:()=>{this.$refs.addDialog.open()}}]}},created(){this.getList()},methods:{searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0,a["a"].post({url:"/system/sysAdvertiseCategory/list",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,...this.filterData},success:e=>{this.table.data=e.list,this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1}})},showData(e){console.log(e)},handleSuccess(){this.getList()},handleDelete(e){this.$confirm("此操作将会删除该分类, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/system/sysAdvertiseCategory/remove",params:{id:e.id},success:e=>{this.$message.success(e),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},clearFilter(){this.filterData={name:""},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()}}},u=l,c=(n("459b"),n("1805")),d=Object(c["a"])(u,r,i,!1,null,"0f00369d",null);t["default"]=d.exports},"4ffd":function(e,t,n){e.exports=n.p+"static/img/logo.82b9c7a5.png"},"502c":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}),t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange}})],1)},i=[],o=n("7591"),a=n("b775"),s={name:"channelStatistics",components:{BasicTable:o["a"]},data(){return{loading:!1,categoryOptions:[],filterOptions:{column:[{type:"timeAll",label:["开始时间","结束时间"],value:"time"}]},filterData:{time:[]},table:{columns:[{id:2,prop:"name",label:"推广渠道"},{id:6,prop:"toDayCount",label:"今日增加"},{id:3,prop:"totalDataCount",label:"总数据"},{id:4,prop:"totalAddCount",label:"总增加"},{id:5,prop:"totalRemoveCount",label:"总删除"},{id:7,prop:"removeCount",label:"今日删除"}],pageSize:20,currentPage:1,data:[],total:0},operates:[],headerOperates:[]}},created(){this.getList()},methods:{searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0;const{time:e,...t}=this.filterData;a["a"].post({url:"/admin/adPromotionData/promotionChannelStatisticsList",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,startTime:e&&e.length>1?e[0]:"",endTime:e&&e.length>1?e[1]:"",...t},success:e=>{this.table.data=e.slice((this.table.currentPage-1)*this.table.pageSize,(this.table.currentPage-1)*this.table.pageSize+this.table.pageSize),this.table.total=e.length,this.loading=!1},catch:()=>{this.loading=!1},finally:()=>{this.loading=!1}})},handleSuccess(){this.getList()},clearFilter(){this.filterData={time:[]},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()}}},l=s,u=n("1805"),c=Object(u["a"])(l,r,i,!1,null,"2746a176",null);t["default"]=c.exports},"50e1":function(e,t,n){},"513b":function(e,t,n){"use strict";n("013b")},"532c":function(e,t,n){"use strict";n("b3dd")},5331:function(e,t,n){},"574d":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.addModifyVisible,width:"70%"},on:{"update:visible":function(t){e.addModifyVisible=t},close:e.close}},[t("el-form",{ref:"courseRef",attrs:{model:e.addData,rules:e.courseRule,"label-position":"right","label-width":"140px"}},[t("el-form-item",{attrs:{label:"课程名称:",prop:"name"}},[t("jat-input",{attrs:{placeholder:"请输入课程名称"},model:{value:e.addData.name,callback:function(t){e.$set(e.addData,"name",t)},expression:"addData.name"}})],1),t("el-form-item",{attrs:{label:"课程类别:",prop:"categoryId"}},[t("jat-select",{attrs:{placeholder:"请选择课程类别",clearable:"",filterable:""},model:{value:e.addData.categoryId,callback:function(t){e.$set(e.addData,"categoryId",t)},expression:"addData.categoryId"}},e._l(e.categoryOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"成本价:",prop:"costPrice"}},[t("jat-input",{directives:[{name:"input",rawName:"v-input.float",value:2,expression:"2",modifiers:{float:!0}}],attrs:{placeholder:"请输入成本价"},model:{value:e.addData.costPrice,callback:function(t){e.$set(e.addData,"costPrice",t)},expression:"addData.costPrice"}})],1),t("el-form-item",{attrs:{label:"市场价:",prop:"price"}},[t("jat-input",{directives:[{name:"input",rawName:"v-input.float",value:2,expression:"2",modifiers:{float:!0}}],attrs:{placeholder:"请输入市场价"},model:{value:e.addData.price,callback:function(t){e.$set(e.addData,"price",t)},expression:"addData.price"}})],1),t("div",{staticStyle:{width:"48%"}},[t("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"是否收费:",prop:"hasFree"}},[t("jat-select",{attrs:{placeholder:"请选择是否收费",clearable:""},on:{change:e.handleHasFreeChange},model:{value:e.addData.hasFree,callback:function(t){e.$set(e.addData,"hasFree",t)},expression:"addData.hasFree"}},e._l(e.hasFreeOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),1==e.addData.hasFree?t("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"课程价格:",prop:"price"}},[t("jat-input",{directives:[{name:"input",rawName:"v-input.float",value:2,expression:"2",modifiers:{float:!0}}],attrs:{placeholder:"请输入课程价格"},model:{value:e.addData.price,callback:function(t){e.$set(e.addData,"price",t)},expression:"addData.price"}})],1):e._e()],1),t("el-form-item",{attrs:{label:"封面:",prop:"image"}},[t("upload-image",{model:{value:e.addData.image,callback:function(t){e.$set(e.addData,"image",t)},expression:"addData.image"}})],1),t("el-form-item",{attrs:{label:"课程标签:",prop:"tag"}},[t("jat-select",{attrs:{placeholder:"请选择课程标签",clearable:""},on:{change:e.handleTagChange},model:{value:e.addData.tag,callback:function(t){e.$set(e.addData,"tag",t)},expression:"addData.tag"}},e._l(e.tagOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),0===e.addData.tag?t("el-form-item",{attrs:{label:"课程套餐:",prop:"setMealCategoryId"}},[t("jat-select",{attrs:{placeholder:"请输入课程套餐",clearable:"",filterable:""},model:{value:e.addData.setMealCategoryId,callback:function(t){e.$set(e.addData,"setMealCategoryId",t)},expression:"addData.setMealCategoryId"}},e._l(e.MealCategoryOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),t("el-form-item",{attrs:{label:"课程类型:",prop:"hasLive"}},[t("jat-select",{attrs:{placeholder:"请选择课程类型",clearable:""},model:{value:e.addData.hasLive,callback:function(t){e.$set(e.addData,"hasLive",t)},expression:"addData.hasLive"}},e._l(e.hasLiveOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"开播时间:",prop:"openLiveTime"}},[t("jat-date-picker",{attrs:{width:"100%",clearable:"",valueFormat:"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"请选择开播时间"},model:{value:e.addData.openLiveTime,callback:function(t){e.$set(e.addData,"openLiveTime",t)},expression:"addData.openLiveTime"}}),t("div",{staticClass:"wram-box"},[t("i",{staticClass:"el-icon-info"}),e._v("该开播时间为会员可看到的课程开播时间，实际时间以讲师开播为准 ")])],1),t("el-form-item",{attrs:{label:"直播频道号:",prop:"channelNumber"}},[t("jat-input",{attrs:{placeholder:"请输入直播频道号"},on:{blur:e.handleCheck},model:{value:e.addData.channelNumber,callback:function(t){e.$set(e.addData,"channelNumber",t)},expression:"addData.channelNumber"}})],1),t("el-form-item",{attrs:{label:"直播回放链接:",prop:"livePlaybackUrl"}},[t("jat-input",{attrs:{placeholder:"请输入直播回放链接"},model:{value:e.addData.livePlaybackUrl,callback:function(t){e.$set(e.addData,"livePlaybackUrl",t)},expression:"addData.livePlaybackUrl"}}),t("uploadFile",{attrs:{limit:1,accept:".mp4",valueType:"string"},model:{value:e.addData.livePlaybackUrl,callback:function(t){e.$set(e.addData,"livePlaybackUrl",t)},expression:"addData.livePlaybackUrl"}}),t("div",{staticClass:"wram-box"},[t("i",{staticClass:"el-icon-info"}),e._v("直播有回放链接先放回放链接，没有则播放录播链接 ")])],1),t("el-form-item",{attrs:{label:"录播链接:",prop:"recordLiveUrl"}},[t("jat-input",{attrs:{placeholder:"请输入录播链接"},model:{value:e.addData.recordLiveUrl,callback:function(t){e.$set(e.addData,"recordLiveUrl",t)},expression:"addData.recordLiveUrl"}}),t("uploadFile",{attrs:{valueType:"string",accept:".mp4",limit:1},model:{value:e.addData.recordLiveUrl,callback:function(t){e.$set(e.addData,"recordLiveUrl",t)},expression:"addData.recordLiveUrl"}}),t("div",{staticClass:"wram-box"},[t("i",{staticClass:"el-icon-info"}),e._v("课程类型为录播时需上传该录播链接 ")])],1),t("el-form-item",{attrs:{label:"课程描述:",prop:"overview"}},[t("jat-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入课程描述"},model:{value:e.addData.overview,callback:function(t){e.$set(e.addData,"overview",t)},expression:"addData.overview"}})],1),t("el-form-item",{attrs:{label:"SEO标题:",prop:"seoTitle"}},[t("jat-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入SEO标题"},model:{value:e.addData.seoTitle,callback:function(t){e.$set(e.addData,"seoTitle",t)},expression:"addData.seoTitle"}})],1),t("el-form-item",{attrs:{label:"SEO关键字:",prop:"seoKey"}},[t("jat-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入SEO关键字"},model:{value:e.addData.seoKey,callback:function(t){e.$set(e.addData,"seoKey",t)},expression:"addData.seoKey"}})],1),t("el-form-item",{attrs:{label:"SEO描述:",prop:"seoContent"}},[t("jat-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入SEO关键字"},model:{value:e.addData.seoContent,callback:function(t){e.$set(e.addData,"seoContent",t)},expression:"addData.seoContent"}})],1),t("el-form-item",{attrs:{label:"讲师:",prop:"teacherAdId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",clearable:"",filterable:"",remote:"",placeholder:"请选择讲师","remote-method":e.teacherRemoteMethod,loading:e.remoteLoading},model:{value:e.addData.teacherAdId,callback:function(t){e.$set(e.addData,"teacherAdId",t)},expression:"addData.teacherAdId"}},e._l(e.teacherOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"排序:",prop:"sort"}},[t("jat-input",{directives:[{name:"input",rawName:"v-input.int",modifiers:{int:!0}}],attrs:{placeholder:"请输入排序"},model:{value:e.addData.sort,callback:function(t){e.$set(e.addData,"sort",t)},expression:"addData.sort"}})],1),t("el-form-item",{attrs:{label:"发布者:",prop:"createAdId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",clearable:"",filterable:"",remote:"",placeholder:"默认为登录账户","remote-method":e.remoteMethod,loading:e.remoteLoading},model:{value:e.addData.createAdId,callback:function(t){e.$set(e.addData,"createAdId",t)},expression:"addData.createAdId"}},e._l(e.parentAdIdOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"推荐位:",prop:"position"}},[t("jat-select",{attrs:{placeholder:"请选择推荐位置",clearable:""},model:{value:e.addData.position,callback:function(t){e.$set(e.addData,"position",t)},expression:"addData.position"}},e._l(e.positionptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"查看数:",prop:"readCount"}},[t("jat-input",{directives:[{name:"input",rawName:"v-input.int",modifiers:{int:!0}}],attrs:{placeholder:"请输入查看数"},model:{value:e.addData.readCount,callback:function(t){e.$set(e.addData,"readCount",t)},expression:"addData.readCount"}})],1),t("el-form-item",{attrs:{label:"是否展示在官网(h5):",prop:"showOfficialWebsite"}},[t("jat-select",{attrs:{placeholder:"请选择是否展示在官网(h5)",clearable:""},model:{value:e.addData.showOfficialWebsite,callback:function(t){e.$set(e.addData,"showOfficialWebsite",t)},expression:"addData.showOfficialWebsite"}},e._l(e.showOfficialWebsiteOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"课程详情:",prop:"content"}},[t("tinymce-edit",{model:{value:e.addData.content,callback:function(t){e.$set(e.addData,"content",t)},expression:"addData.content"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)],1)},i=[],o=(n("7cfc"),n("c46c")),a=n("cbc3"),s=n("b775"),l=n("9adf"),u=n("b893"),c=n("de3d"),d={components:{uploadFile:o["a"],uploadImage:a["a"],tinymceEdit:l["a"]},data(){return{addModifyVisible:!1,remoteLoading:!1,recordLiveUrlPer:0,teacherOptions:[],categoryOptions:[],MealCategoryOptions:[],positionptions:c["c"],tagOptions:c["e"],hasLiveOptions:c["b"],hasFreeOptions:c["a"],showOfficialWebsiteOptions:c["d"],dialogTitle:"",addData:{id:"",name:"",categoryId:"",content:"",createAdId:"",hasFree:"",hasLive:"",image:"",livePlaybackUrl:"",openLiveTime:"",overview:"",position:"",price:0,readCount:"",recordLiveUrl:"",remark:"",seoContent:"",seoKey:"",seoTitle:"",setMealCategoryId:"",sort:255,tag:"",teacherAdId:"",underlinedPrice:"",costPrice:"",showOfficialWebsite:""},parentAdIdOptions:[],courseRule:{name:[{required:!0,message:"请输入课程名称",trigger:"blur"}],hasFree:[{required:!0,message:"请输入选择是否免费",trigger:"blur"}],openLiveTime:[{validator:(e,t,n)=>{this.addData.channelNumber&&this.addData.livePlaybackUrl&&!t?n(new Error("请输入开播时间")):n()},trigger:"blur"}],hasLive:[{required:!0,message:"请输入选择是否直播",trigger:"blur"}],costPrice:[{required:!0,message:"请输入成本价",trigger:"blur"}],underlinedPrice:[{required:!0,message:"请输入市场价",trigger:"blur"}],image:[{required:!0,message:"请上传封面",trigger:"blur"}],price:[{required:!0,message:"请输入价格",trigger:"blur"}],tag:[{required:!0,message:"请输入课程标签",trigger:"blur"}],teacherAdId:[{required:!0,message:"请选择讲师",trigger:"blur"}]}}},mounted(){this.getCurrentUser(),this.getCategoryList(),this.getMealCategoryList()},methods:{open(){this.dialogTitle="添加课程",this.addModifyVisible=!0},edit({id:e,name:t,categoryId:n,content:r,createAdId:i,hasFree:o,hasLive:a,image:s,livePlaybackUrl:l,openLive:c,overview:d,position:f,price:h,readCount:m,recordLiveUrl:p,remark:g,seoContent:v,seoKey:b,seoTitle:y,setMealCategoryId:w,sort:S,tag:x,teacherAdId:C,underlinedPrice:T,costPrice:D,teacherName:k,showOfficialWebsite:E}){this.dialogTitle="编辑课程",this.addModifyVisible=!0,this.addData={id:e,name:t,categoryId:n,content:r,createAdId:i,hasFree:o,hasLive:a,image:s,livePlaybackUrl:l,openLiveTime:Object(u["b"])(c,"yyyy-MM-dd HH:mm:ss"),overview:d,position:f,price:h,readCount:m,recordLiveUrl:p,underlinedPrice:T,costPrice:D,remark:g,seoContent:v,seoKey:b,seoTitle:y,setMealCategoryId:w,sort:S,tag:x,teacherAdId:C,showOfficialWebsite:E},this.teacherOptions=[{id:C,name:k}]},close(){this.$refs.courseRef&&this.$refs.courseRef.clearValidate(),this.addData={id:"",name:"",categoryId:"",content:"",createAdId:"",hasFree:"",hasLive:"",image:"",livePlaybackUrl:"",openLiveTime:"",overview:"",position:"",price:"",readCount:"",recordLiveUrl:"",remark:"",seoContent:"",seoKey:"",seoTitle:"",setMealCategoryId:"",underlinedPrice:"",costPrice:"",sort:255,tag:"",teacherAdId:"",showOfficialWebsite:""},this.addModifyVisible=!1},getCurrentUser(){this.parentAdIdOptions=[{id:sessionStorage.getItem("id")?parseInt(sessionStorage.getItem("id")):"",name:sessionStorage.getItem("userName")}],this.addData.createAdId=parseInt(sessionStorage.getItem("id"))},handleCheck(){this.$refs.courseRef&&this.$refs.courseRef.validateField("openLiveTime")},handleSubmit(){this.$refs.courseRef.validate(e=>{const{id:t,...n}=this.addData;e&&(t?s["a"].post({url:"/admin/adCourse/edit",params:{id:t,...n},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}):s["a"].post({url:"/admin/adCourse/add",params:{...n},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}))})},getCategoryList(){s["a"].post({url:"system/sysCategory/listNoPage",params:{type:2},success:e=>{this.categoryOptions=e}})},getMealCategoryList(){s["a"].post({url:"system/sysCategory/listNoPage",params:{type:4},success:e=>{this.MealCategoryOptions=e}})},remoteMethod(e){if(e){this.remoteLoading=!0;var t=0;s["a"].post({url:"/admin/adInfo/queryAdminByNameOrPhone",params:{search:e,type:t},success:e=>{this.remoteLoading=!1,this.parentAdIdOptions=e},catch:()=>{this.remoteLoading=!1}})}},handleHasFreeChange(e){this.addData.price=e?"":0},handleTagChange(){this.addData.setMealCategoryId=""},teacherRemoteMethod(e,t){e&&(this.remoteLoading=!0,s["a"].post({url:"/admin/adCourse/queryTeacherByNameOrTeacher",params:{keyword:e},success:e=>{this.remoteLoading=!1,this.teacherOptions=e},catch:()=>{this.remoteLoading=!1}}))}},watch:{"addData.livePlaybackUrl":{handler(){this.handleCheck()}}}},f=d,h=(n("76d4"),n("1805")),m=Object(h["a"])(f,r,i,!1,null,"07a842f9",null);t["default"]=m.exports},5789:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.addModifyVisible,width:"50%"},on:{"update:visible":function(t){e.addModifyVisible=t},close:e.close}},[t("el-form",{ref:"promotionRef",attrs:{model:e.addData,rules:e.promotionRule,"label-position":"left","label-width":"90px"}},[t("el-form-item",{attrs:{label:"推广渠道:",prop:"channelId"}},[t("jat-select",{attrs:{placeholder:"请选择推广渠道",clearable:""},model:{value:e.addData.channelId,callback:function(t){e.$set(e.addData,"channelId",t)},expression:"addData.channelId"}},e._l(e.channelIdOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"销售员:",prop:"promoterId"}},[t("select-user-remote",{ref:"selectUser",attrs:{width:"100%",type:0,placeholder:"销售员"},model:{value:e.addData.promoterId,callback:function(t){e.$set(e.addData,"promoterId",t)},expression:"addData.promoterId"}})],1),t("el-form-item",{attrs:{label:"增加时间:",prop:"addTime"}},[t("jat-date-picker",{attrs:{width:"100%",clearable:"",type:"datetime","value-format":"timestamp",placeholder:"请选择增加时间",size:"small"},on:{change:function(t){return e.shijian()}},model:{value:e.addData.addTime,callback:function(t){e.$set(e.addData,"addTime",t)},expression:"addData.addTime"}})],1),t("el-form-item",{attrs:{label:"姓名:",prop:"name"}},[t("jat-input",{attrs:{placeholder:"请输入姓名"},model:{value:e.addData.name,callback:function(t){e.$set(e.addData,"name",t)},expression:"addData.name"}})],1),t("el-form-item",{attrs:{label:"年龄:",prop:"age"}},[t("jat-input",{attrs:{placeholder:"请输入年龄"},model:{value:e.addData.age,callback:function(t){e.$set(e.addData,"age",t)},expression:"addData.age"}})],1),t("el-form-item",{attrs:{label:"QQ:",prop:"qq"}},[t("jat-input",{attrs:{placeholder:"请输入QQ"},model:{value:e.addData.qq,callback:function(t){e.$set(e.addData,"qq",t)},expression:"addData.qq"}})],1),t("el-form-item",{attrs:{label:"钉钉:",prop:"qq"}},[t("jat-input",{attrs:{placeholder:"请输入钉钉号"},model:{value:e.addData.ding,callback:function(t){e.$set(e.addData,"ding",t)},expression:"addData.ding"}})],1),t("el-form-item",{attrs:{label:"微信:",prop:"wechat"}},[t("jat-input",{attrs:{placeholder:"请输入微信"},model:{value:e.addData.wechat,callback:function(t){e.$set(e.addData,"wechat",t)},expression:"addData.wechat"}})],1),t("el-form-item",{attrs:{label:"性别:",prop:"gender"}},[t("jat-select",{attrs:{placeholder:"请选择性别",clearable:""},model:{value:e.addData.gender,callback:function(t){e.$set(e.addData,"gender",t)},expression:"addData.gender"}},e._l(e.genderOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"备注:",prop:"remark"}},[t("jat-input",{attrs:{placeholder:"请输入备注"},model:{value:e.addData.remark,callback:function(t){e.$set(e.addData,"remark",t)},expression:"addData.remark"}})],1),t("el-form-item",{attrs:{label:"学历:",prop:"degree"}},[t("jat-select",{attrs:{placeholder:"请选择学历",clearable:""},model:{value:e.addData.degree,callback:function(t){e.$set(e.addData,"degree",t)},expression:"addData.degree"}},e._l(e.degreeOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"头像:",prop:"avatar"}},[t("upload-image",{model:{value:e.addData.avatar,callback:function(t){e.$set(e.addData,"avatar",t)},expression:"addData.avatar"}})],1)],1),t("span",{directives:[{name:"show",rawName:"v-show",value:e.btnFlag,expression:"btnFlag"}],staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)],1)},i=[],o=(n("7cfc"),n("cbc3")),a=n("b775"),s=n("61da"),l=n("787e"),u=n("61f7"),c={components:{uploadImage:o["a"],selectUserRemote:s["a"]},data(){return{btnFlag:!0,addModifyVisible:!1,dialogTitle:"",channelIdOptions:[],genderOptions:l["b"],degreeOptions:l["a"],addData:{age:"",avatar:"",degree:"",gender:"",name:"",phone:"",qq:"",ding:"",wechat:"",channelId:"",promoterId:"",addTime:"",remark:""},categoryOptions:[],promotionRule:{channelId:[{required:!0,message:"请选推广渠道",trigger:"blur"}],promoterId:[{required:!0,message:"请选择销售员",trigger:"blur"}],addTime:[{required:!0,message:"请选择增加时间",trigger:"blur"}],phone:[{validator:(e,t,n)=>{t?Object(u["b"])(t)?n():n(new Error("格式不正确")):n()},trigger:"blur"}],qq:[{validator:this.validateAtLeastOne,trigger:"blur"}],wechat:[{validator:this.validateAtLeastOne,trigger:"blur"}],ding:[{validator:this.validateAtLeastOne,trigger:"blur"}]}}},mounted(){},methods:{validateAtLeastOne(e,t,n){this.addData.qq||this.addData.wechat||this.addData.ding?n():n(new Error("QQ、微信或钉钉三选一,其中一个必填"))},shijian(){},open(){this.dialogTitle="添加推广数据",this.addData.addTime=Date.now(),this.addModifyVisible=!0,Object(l["c"])(e=>{this.channelIdOptions=e})},edit({id:e,age:t,avatar:n,degree:r,gender:i,name:o,phone:a,addTime:s,qq:u,ding:c,wechat:d,channelId:f,promoterId:h,promoterName:m}){this.dialogTitle="编辑推广数据",this.addModifyVisible=!0,Object(l["c"])(e=>{this.channelIdOptions=e}),this.addData={dataId:e,avatar:n,degree:r,gender:i,name:o,phone:a,age:t,addTime:s,qq:u,ding:c,wechat:d,channelId:f,promoterId:h},this.$nextTick(()=>{this.$refs.selectUser.userOptions=[{name:m,id:h}]})},close(){this.$refs.promotionRef&&this.$refs.promotionRef.clearValidate(),this.addData={age:"",avatar:"",degree:"",gender:"",name:"",phone:"",qq:"",ding:"",wechat:"",channelId:"",promoterId:"",addTime:""},this.addModifyVisible=!1},handleSubmit(){this.$refs.promotionRef.validate(e=>{console.log(e,"valid"),this.addData.qq=this.addData.qq.trim(),this.addData.ding=this.addData.ding.trim(),this.addData.wechat=this.addData.wechat.trim(),this.addData.name=this.addData.name.trim(),e&&(this.btnFlag=!1,this.addData.dataId?a["a"].post({url:"/admin/adPromotionData/edit",params:{...this.addData},success:e=>{this.$message.success(e),this.close(),this.$emit("success")},finally:e=>{this.btnFlag=!0}}):a["a"].post({url:"/admin/adPromotionData/add",params:this.addData,success:e=>{this.$message.success(e),this.close(),this.$emit("success")},finally:e=>{this.btnFlag=!0}}))})}}},d=c,f=n("1805"),h=Object(f["a"])(d,r,i,!1,null,"750c218a",null);t["default"]=h.exports},5831:function(e,t,n){},"5a1c":function(e,t){(function(){"use strict";var e=function(e){var t=typeof e;return null===e?"null":"object"===t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t},t=function(t){return function(n){return e(n)===t}},n=function(e){return function(t){return typeof t===e}},r=function(e){return function(t){return e===t}},i=t("string"),o=t("object"),a=t("array"),s=r(null),l=n("boolean"),u=r(void 0),c=function(e){return null===e||void 0===e},d=function(e){return!c(e)},f=n("function"),h=n("number"),m=function(){},p=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e(t.apply(null,n))}},g=function(e,t){return function(n){return e(t(n))}},v=function(e){return function(){return e}},b=function(e){return e},y=function(e,t){return e===t};function w(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=t.concat(n);return e.apply(null,i)}}var S=function(e){return function(t){return!e(t)}},x=function(e){return function(){throw new Error(e)}},C=v(!1),T=v(!0),D=function(){return k},k=function(){var e=function(e){return e()},t=b,n={fold:function(e,t){return e()},isSome:C,isNone:T,getOr:t,getOrThunk:e,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:v(null),getOrUndefined:v(void 0),or:t,orThunk:e,map:D,each:m,bind:D,exists:C,forall:T,filter:function(){return D()},toArray:function(){return[]},toString:v("none()")};return n}(),E=function(e){var t=v(e),n=function(){return i},r=function(t){return t(e)},i={fold:function(t,n){return n(e)},isSome:T,isNone:C,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return E(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?i:k},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return i},_=function(e){return null===e||void 0===e?k:E(e)},A={some:E,none:D,from:_},L=Array.prototype.slice,O=Array.prototype.indexOf,R=Array.prototype.push,I=function(e,t){return O.call(e,t)},P=function(e,t){return I(e,t)>-1},M=function(e,t){for(var n=0,r=e.length;n<r;n++){var i=e[n];if(t(i,n))return!0}return!1},N=function(e,t){for(var n=[],r=0;r<e;r++)n.push(t(r));return n},F=function(e,t){for(var n=e.length,r=new Array(n),i=0;i<n;i++){var o=e[i];r[i]=t(o,i)}return r},B=function(e,t){for(var n=0,r=e.length;n<r;n++){var i=e[n];t(i,n)}},$=function(e,t){for(var n=e.length-1;n>=0;n--){var r=e[n];t(r,n)}},z=function(e,t){for(var n=[],r=[],i=0,o=e.length;i<o;i++){var a=e[i],s=t(a,i)?n:r;s.push(a)}return{pass:n,fail:r}},U=function(e,t){for(var n=[],r=0,i=e.length;r<i;r++){var o=e[r];t(o,r)&&n.push(o)}return n},V=function(e,t,n){return $(e,(function(e,r){n=t(n,e,r)})),n},H=function(e,t,n){return B(e,(function(e,r){n=t(n,e,r)})),n},j=function(e,t,n){for(var r=0,i=e.length;r<i;r++){var o=e[r];if(t(o,r))return A.some(o);if(n(o,r))break}return A.none()},q=function(e,t){return j(e,t,C)},G=function(e,t){for(var n=0,r=e.length;n<r;n++){var i=e[n];if(t(i,n))return A.some(n)}return A.none()},W=function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!a(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);R.apply(t,e[n])}return t},K=function(e,t){return W(F(e,t))},Y=function(e,t){for(var n=0,r=e.length;n<r;++n){var i=e[n];if(!0!==t(i,n))return!1}return!0},X=function(e){var t=L.call(e,0);return t.reverse(),t},J=function(e,t){for(var n={},r=0,i=e.length;r<i;r++){var o=e[r];n[String(o)]=t(o,r)}return n},Q=function(e){return[e]},Z=function(e,t){var n=L.call(e,0);return n.sort(t),n},ee=function(e,t){return t>=0&&t<e.length?A.some(e[t]):A.none()},te=function(e){return ee(e,0)},ne=function(e){return ee(e,e.length-1)},re=function(e,t){for(var n=0;n<e.length;n++){var r=t(e[n],n);if(r.isSome())return r}return A.none()},ie=function(){return ie=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ie.apply(this,arguments)};function oe(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var ae=function(e){var t,n=!1;return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return n||(n=!0,t=e.apply(null,r)),t}},se=function(e,t,n,r){var i=e.isiOS()&&!0===/ipad/i.test(n),o=e.isiOS()&&!i,a=e.isiOS()||e.isAndroid(),s=a||r("(pointer:coarse)"),l=i||!o&&a&&r("(min-device-width:768px)"),u=o||a&&!l,c=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(n),d=!u&&!l&&!c;return{isiPad:v(i),isiPhone:v(o),isTablet:v(l),isPhone:v(u),isTouch:v(s),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:v(c),isDesktop:v(d)}},le=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}},ue=function(e,t){var n=le(e,t);if(!n)return{major:0,minor:0};var r=function(e){return Number(t.replace(n,"$"+e))};return fe(r(1),r(2))},ce=function(e,t){var n=String(t).toLowerCase();return 0===e.length?de():ue(e,n)},de=function(){return fe(0,0)},fe=function(e,t){return{major:e,minor:t}},he={nu:fe,detect:ce,unknown:de},me=function(e,t){return re(t.brands,(function(t){var n=t.brand.toLowerCase();return q(e,(function(e){var t;return n===(null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())})).map((function(e){return{current:e.name,version:he.nu(parseInt(t.version,10),0)}}))}))},pe=function(e,t){var n=String(t).toLowerCase();return q(e,(function(e){return e.search(n)}))},ge=function(e,t){return pe(e,t).map((function(e){var n=he.detect(e.versionRegexes,t);return{current:e.name,version:n}}))},ve=function(e,t){return pe(e,t).map((function(e){var n=he.detect(e.versionRegexes,t);return{current:e.name,version:n}}))},be=function(e,t){return e.substring(t)},ye=function(e,t,n){return""===t||e.length>=t.length&&e.substr(n,n+t.length)===t},we=function(e,t){return xe(e,t)?be(e,t.length):e},Se=function(e,t){return-1!==e.indexOf(t)},xe=function(e,t){return ye(e,t,0)},Ce=function(e,t){return ye(e,t,e.length-t.length)},Te=function(e){return function(t){return t.replace(e,"")}},De=Te(/^\s+|\s+$/g),ke=function(e){return e.length>0},Ee=function(e){return!ke(e)},_e=function(e){var t=parseFloat(e);return isNaN(t)?A.none():A.some(t)},Ae=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Le=function(e){return function(t){return Se(t,e)}},Oe=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return Se(e,"edge/")&&Se(e,"chrome")&&Se(e,"safari")&&Se(e,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Ae],search:function(e){return Se(e,"chrome")&&!Se(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return Se(e,"msie")||Se(e,"trident")}},{name:"Opera",versionRegexes:[Ae,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Le("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Le("firefox")},{name:"Safari",versionRegexes:[Ae,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(Se(e,"safari")||Se(e,"mobile/"))&&Se(e,"applewebkit")}}],Re=[{name:"Windows",search:Le("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return Se(e,"iphone")||Se(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Le("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Le("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Le("linux"),versionRegexes:[]},{name:"Solaris",search:Le("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Le("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Le("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Ie={browsers:v(Oe),oses:v(Re)},Pe="Edge",Me="Chrome",Ne="IE",Fe="Opera",Be="Firefox",$e="Safari",ze=function(){return Ue({current:void 0,version:he.unknown()})},Ue=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isEdge:r(Pe),isChrome:r(Me),isIE:r(Ne),isOpera:r(Fe),isFirefox:r(Be),isSafari:r($e)}},Ve={unknown:ze,nu:Ue,edge:v(Pe),chrome:v(Me),ie:v(Ne),opera:v(Fe),firefox:v(Be),safari:v($e)},He="Windows",je="iOS",qe="Android",Ge="Linux",We="OSX",Ke="Solaris",Ye="FreeBSD",Xe="ChromeOS",Je=function(){return Qe({current:void 0,version:he.unknown()})},Qe=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isWindows:r(He),isiOS:r(je),isAndroid:r(qe),isOSX:r(We),isLinux:r(Ge),isSolaris:r(Ke),isFreeBSD:r(Ye),isChromeOS:r(Xe)}},Ze={unknown:Je,nu:Qe,windows:v(He),ios:v(je),android:v(qe),linux:v(Ge),osx:v(We),solaris:v(Ke),freebsd:v(Ye),chromeos:v(Xe)},et=function(e,t,n){var r=Ie.browsers(),i=Ie.oses(),o=t.bind((function(e){return me(r,e)})).orThunk((function(){return ge(r,e)})).fold(Ve.unknown,Ve.nu),a=ve(i,e).fold(Ze.unknown,Ze.nu),s=se(a,o,e,n);return{browser:o,os:a,deviceType:s}},tt={detect:et},nt=function(e){return window.matchMedia(e).matches},rt=ae((function(){return tt.detect(navigator.userAgent,A.from(navigator.userAgentData),nt)})),it=function(){return rt()},ot=function(e,t,n){return 0!==(e.compareDocumentPosition(t)&n)},at=function(e,t){return ot(e,t,Node.DOCUMENT_POSITION_CONTAINED_BY)},st=8,lt=9,ut=11,ct=1,dt=3,ft=function(e,t){var n=t||document,r=n.createElement("div");if(r.innerHTML=e,!r.hasChildNodes()||r.childNodes.length>1)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return pt(r.childNodes[0])},ht=function(e,t){var n=t||document,r=n.createElement(e);return pt(r)},mt=function(e,t){var n=t||document,r=n.createTextNode(e);return pt(r)},pt=function(e){if(null===e||void 0===e)throw new Error("Node cannot be null or undefined");return{dom:e}},gt=function(e,t,n){return A.from(e.dom.elementFromPoint(t,n)).map(pt)},vt={fromHtml:ft,fromTag:ht,fromText:mt,fromDom:pt,fromPoint:gt},bt=function(e,t){var n=e.dom;if(n.nodeType!==ct)return!1;var r=n;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},yt=function(e){return e.nodeType!==ct&&e.nodeType!==lt&&e.nodeType!==ut||0===e.childElementCount},wt=function(e,t){var n=void 0===t?document:t.dom;return yt(n)?[]:F(n.querySelectorAll(e),vt.fromDom)},St=function(e,t){var n=void 0===t?document:t.dom;return yt(n)?A.none():A.from(n.querySelector(e)).map(vt.fromDom)},xt=function(e,t){return e.dom===t.dom},Ct=function(e,t){var n=e.dom,r=t.dom;return n!==r&&n.contains(r)},Tt=function(e,t){return at(e.dom,t.dom)},Dt=function(e,t){return it().browser.isIE()?Tt(e,t):Ct(e,t)},kt=bt,Et=Object.keys,_t=Object.hasOwnProperty,At=function(e,t){for(var n=Et(e),r=0,i=n.length;r<i;r++){var o=n[r],a=e[o];t(a,o)}},Lt=function(e,t){return Ot(e,(function(e,n){return{k:n,v:t(e,n)}}))},Ot=function(e,t){var n={};return At(e,(function(e,r){var i=t(e,r);n[i.k]=i.v})),n},Rt=function(e){return function(t,n){e[n]=t}},It=function(e,t,n,r){var i={};return At(e,(function(e,i){(t(e,i)?n:r)(e,i)})),i},Pt=function(e,t){var n={};return It(e,t,Rt(n),m),n},Mt=function(e,t){var n=[];return At(e,(function(e,r){n.push(t(e,r))})),n},Nt=function(e){return Mt(e,b)},Ft=function(e){return Et(e).length},Bt=function(e,t){return $t(e,t)?A.from(e[t]):A.none()},$t=function(e,t){return _t.call(e,t)},zt=function(e,t){return $t(e,t)&&void 0!==e[t]&&null!==e[t]},Ut=function(e){for(var t in e)if(_t.call(e,t))return!1;return!0},Vt=["tfoot","thead","tbody","colgroup"],Ht=function(e){return P(Vt,e)},jt=function(e,t){return{rows:e,columns:t}},qt=function(e,t){return{row:e,column:t}},Gt=function(e,t,n){return{element:e,rowspan:t,colspan:n}},Wt=function(e,t,n,r){return{element:e,rowspan:t,colspan:n,isNew:r}},Kt=function(e,t,n,r,i,o){return{element:e,rowspan:t,colspan:n,row:r,column:i,isLocked:o}},Yt=function(e,t,n){return{element:e,cells:t,section:n}},Xt=function(e,t,n,r){return{element:e,cells:t,section:n,isNew:r}},Jt=function(e,t,n){return{element:e,isNew:t,isLocked:n}},Qt=function(e,t,n,r){return{element:e,cells:t,section:n,isNew:r}},Zt=function(e,t,n,r){return{startRow:e,startCol:t,finishRow:n,finishCol:r}},en=function(e,t,n){return{element:e,colspan:t,column:n}},tn=function(e,t){return{element:e,columns:t}};"undefined"!==typeof window?window:Function("return this;")();var nn=function(e){var t=e.dom.nodeName;return t.toLowerCase()},rn=function(e){return e.dom.nodeType},on=function(e){return function(t){return rn(t)===e}},an=function(e){return rn(e)===st||"#comment"===nn(e)},sn=on(ct),ln=on(dt),un=on(lt),cn=on(ut),dn=function(e){return function(t){return sn(t)&&nn(t)===e}},fn=function(e){return vt.fromDom(e.dom.ownerDocument)},hn=function(e){return un(e)?e:fn(e)},mn=function(e){return vt.fromDom(hn(e).dom.defaultView)},pn=function(e){return A.from(e.dom.parentNode).map(vt.fromDom)},gn=function(e){return A.from(e.dom.parentElement).map(vt.fromDom)},vn=function(e,t){var n=f(t)?t:C,r=e.dom,i=[];while(null!==r.parentNode&&void 0!==r.parentNode){var o=r.parentNode,a=vt.fromDom(o);if(i.push(a),!0===n(a))break;r=o}return i},bn=function(e){return A.from(e.dom.previousSibling).map(vt.fromDom)},yn=function(e){return A.from(e.dom.nextSibling).map(vt.fromDom)},wn=function(e){return F(e.dom.childNodes,vt.fromDom)},Sn=function(e,t){var n=e.dom.childNodes;return A.from(n[t]).map(vt.fromDom)},xn=function(e){return Sn(e,0)},Cn=function(e){return cn(e)&&d(e.dom.host)},Tn=f(Element.prototype.attachShadow)&&f(Node.prototype.getRootNode),Dn=v(Tn),kn=Tn?function(e){return vt.fromDom(e.dom.getRootNode())}:hn,En=function(e){var t=kn(e);return Cn(t)?A.some(t):A.none()},_n=function(e){return vt.fromDom(e.dom.host)},An=function(e){if(Dn()&&d(e.target)){var t=vt.fromDom(e.target);if(sn(t)&&Ln(t)&&e.composed&&e.composedPath){var n=e.composedPath();if(n)return te(n)}}return A.from(e.target)},Ln=function(e){return d(e.dom.shadowRoot)},On=function(e){var t=ln(e)?e.dom.parentNode:e.dom;if(void 0===t||null===t||null===t.ownerDocument)return!1;var n=t.ownerDocument;return En(vt.fromDom(t)).fold((function(){return n.body.contains(t)}),g(On,_n))},Rn=function(){return In(vt.fromDom(document))},In=function(e){var t=e.dom.body;if(null===t||void 0===t)throw new Error("Body is not available yet");return vt.fromDom(t)},Pn=function(e,t,n){return U(vn(e,n),t)},Mn=function(e,t){return U(wn(e),t)},Nn=function(e,t){var n=[];return B(wn(e),(function(e){t(e)&&(n=n.concat([e])),n=n.concat(Nn(e,t))})),n},Fn=function(e,t,n){return Pn(e,(function(e){return bt(e,t)}),n)},Bn=function(e,t){return Mn(e,(function(e){return bt(e,t)}))},$n=function(e,t){return wt(t,e)};function zn(e,t,n,r,i){return e(n,r)?A.some(n):f(i)&&i(n)?A.none():t(n,r,i)}var Un=function(e,t,n){var r=e.dom,i=f(n)?n:C;while(r.parentNode){r=r.parentNode;var o=vt.fromDom(r);if(t(o))return A.some(o);if(i(o))break}return A.none()},Vn=function(e,t,n){var r=function(e,t){return t(e)};return zn(r,Un,e,t,n)},Hn=function(e,t){var n=function(e){return t(vt.fromDom(e))},r=q(e.dom.childNodes,n);return r.map(vt.fromDom)},jn=function(e,t){var n=function(e){for(var r=0;r<e.childNodes.length;r++){var i=vt.fromDom(e.childNodes[r]);if(t(i))return A.some(i);var o=n(e.childNodes[r]);if(o.isSome())return o}return A.none()};return n(e.dom)},qn=function(e,t,n){return Un(e,(function(e){return bt(e,t)}),n)},Gn=function(e,t){return Hn(e,(function(e){return bt(e,t)}))},Wn=function(e,t){return St(t,e)},Kn=function(e,t,n){var r=function(e,t){return bt(e,t)};return zn(r,qn,e,t,n)},Yn=function(e,t,n){if(!(i(n)||l(n)||h(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},Xn=function(e,t,n){Yn(e.dom,t,n)},Jn=function(e,t){var n=e.dom;At(t,(function(e,t){Yn(n,t,e)}))},Qn=function(e,t){At(t,(function(t,n){t.fold((function(){tr(e,n)}),(function(t){Yn(e.dom,n,t)}))}))},Zn=function(e,t){var n=e.dom.getAttribute(t);return null===n?void 0:n},er=function(e,t){return A.from(Zn(e,t))},tr=function(e,t){e.dom.removeAttribute(t)},nr=function(e){return H(e.dom.attributes,(function(e,t){return e[t.name]=t.value,e}),{})},rr=function(e,t,n){return void 0===n&&(n=y),e.exists((function(e){return n(e,t)}))},ir=function(e){for(var t=[],n=function(e){t.push(e)},r=0;r<e.length;r++)e[r].each(n);return t},or=function(e,t,n){return e.isSome()&&t.isSome()?A.some(n(e.getOrDie(),t.getOrDie())):A.none()},ar=function(e,t){return void 0!==e&&null!==e?t(e):A.none()},sr=function(e){return e.bind(b)},lr=function(e,t){return e?A.some(t):A.none()},ur=function(e){return void 0!==e.style&&f(e.style.getPropertyValue)},cr=function(e,t,n){if(!i(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);ur(e)&&e.style.setProperty(t,n)},dr=function(e,t){ur(e)&&e.style.removeProperty(t)},fr=function(e,t,n){var r=e.dom;cr(r,t,n)},hr=function(e,t){var n=e.dom;At(t,(function(e,t){cr(n,t,e)}))},mr=function(e,t){var n=e.dom,r=window.getComputedStyle(n),i=r.getPropertyValue(t);return""!==i||On(e)?i:pr(n,t)},pr=function(e,t){return ur(e)?e.style.getPropertyValue(t):""},gr=function(e,t){var n=e.dom,r=pr(n,t);return A.from(r).filter((function(e){return e.length>0}))},vr=function(e,t){var n=e.dom;dr(n,t),rr(er(e,"style").map(De),"")&&tr(e,"style")},br=function(e,t){var n=e.dom,r=t.dom;ur(n)&&ur(r)&&(r.style.cssText=n.style.cssText)},yr=function(e,t,n){return void 0===n&&(n=0),er(e,t).map((function(e){return parseInt(e,10)})).getOr(n)},wr=function(e,t){return yr(e,t,1)},Sr=function(e){return dn("col")(e)?yr(e,"span",1)>1:wr(e,"colspan")>1},xr=function(e){return wr(e,"rowspan")>1},Cr=function(e,t){return parseInt(mr(e,t),10)},Tr=v(10),Dr=v(10),kr=function(e,t){return Er(e,t,T)},Er=function(e,t,n){return K(wn(e),(function(e){return bt(e,t)?n(e)?[e]:[]:Er(e,t,n)}))},_r=function(e,t,n){if(void 0===n&&(n=C),n(t))return A.none();if(P(e,nn(t)))return A.some(t);var r=function(e){return bt(e,"table")||n(e)};return qn(t,e.join(","),r)},Ar=function(e,t){return _r(["td","th"],e,t)},Lr=function(e){return kr(e,"th,td")},Or=function(e){return bt(e,"colgroup")?Bn(e,"col"):K(Pr(e),(function(e){return Bn(e,"col")}))},Rr=function(e,t){return Kn(e,"table",t)},Ir=function(e){return kr(e,"tr")},Pr=function(e){return Rr(e).fold(v([]),(function(e){return Bn(e,"colgroup")}))},Mr=function(e,t){return F(e,(function(e){if("colgroup"===nn(e)){var n=F(Or(e),(function(e){var t=yr(e,"span",1);return Gt(e,1,t)}));return Yt(e,n,"colgroup")}n=F(Lr(e),(function(e){var t=yr(e,"rowspan",1),n=yr(e,"colspan",1);return Gt(e,t,n)}));return Yt(e,n,t(e))}))},Nr=function(e){return pn(e).map((function(e){var t=nn(e);return Ht(t)?t:"tbody"})).getOr("tbody")},Fr=function(e){var t=Ir(e),n=Pr(e),r=oe(oe([],n,!0),t,!0);return Mr(r,Nr)},Br=function(e,t){return Mr(e,(function(){return t}))},$r=function(e,t,n){var r=e.cells,i=r.slice(0,t),o=r.slice(t),a=i.concat(n).concat(o);return Vr(e,a)},zr=function(e,t,n){return $r(e,t,[n])},Ur=function(e,t,n){var r=e.cells;r[t]=n},Vr=function(e,t){return Qt(e.element,t,e.section,e.isNew)},Hr=function(e,t){var n=e.cells,r=F(n,t);return Qt(e.element,r,e.section,e.isNew)},jr=function(e,t){return e.cells[t]},qr=function(e,t){return jr(e,t).element},Gr=function(e){return e.cells.length},Wr=function(e){var t=z(e,(function(e){return"colgroup"===e.section}));return{rows:t.fail,cols:t.pass}},Kr=function(e,t,n){var r=F(e.cells,n);return Qt(t(e.element),r,e.section,!0)},Yr="data-snooker-locked-cols",Xr=function(e){return er(e,Yr).bind((function(e){return A.from(e.match(/\d+/g))})).map((function(e){return J(e,T)}))},Jr=function(e){var t=H(Wr(e).rows,(function(e,t){return B(t.cells,(function(t,n){t.isLocked&&(e[n]=!0)})),e}),{}),n=Mt(t,(function(e,t){return parseInt(t,10)}));return Z(n)},Qr=function(e,t){return e+","+t},Zr=function(e,t,n){return A.from(e.access[Qr(t,n)])},ei=function(e,t,n){var r=ti(e,(function(e){return n(t,e.element)}));return r.length>0?A.some(r[0]):A.none()},ti=function(e,t){var n=K(e.all,(function(e){return e.cells}));return U(n,t)},ni=function(e){var t={},n=0;return B(e.cells,(function(e){var r=e.colspan;N(r,(function(i){var o=n+i;t[o]=en(e.element,r,o)})),n+=r})),t},ri=function(e){var t={},n=[],r=te(e).map((function(e){return e.element})).bind(Rr),i=r.bind(Xr).getOr({}),o=0,a=0,s=0,l=z(e,(function(e){return"colgroup"===e.section})),u=l.pass,c=l.fail;B(c,(function(e){var r=[];B(e.cells,(function(e){var n=0;while(void 0!==t[Qr(s,n)])n++;for(var o=zt(i,n.toString()),l=Kt(e.element,e.rowspan,e.colspan,s,n,o),u=0;u<e.colspan;u++)for(var c=0;c<e.rowspan;c++){var d=s+c,f=n+u,h=Qr(d,f);t[h]=l,a=Math.max(a,f+1)}r.push(l)})),o++,n.push(Yt(e.element,r,e.section)),s++}));var d=ne(u).map((function(e){var t=ni(e),n=tn(e.element,Nt(t));return{colgroups:[n],columns:t}})).getOrThunk((function(){return{colgroups:[],columns:{}}})),f=d.columns,h=d.colgroups,m=jt(o,a);return{grid:m,access:t,all:n,columns:f,colgroups:h}},ii=function(e){var t=Fr(e);return ri(t)},oi=function(e){return K(e.all,(function(e){return e.cells}))},ai=function(e){return Nt(e.columns)},si=function(e){return Et(e.columns).length>0},li=function(e,t){return A.from(e.columns[t])},ui={fromTable:ii,generate:ri,getAt:Zr,findItem:ei,filterItems:ti,justCells:oi,justColumns:ai,hasColumns:si,getColumnAt:li},ci=function(e,t){var n=t.column,r=t.column+t.colspan-1,i=t.row,o=t.row+t.rowspan-1;return n<=e.finishCol&&r>=e.startCol&&i<=e.finishRow&&o>=e.startRow},di=function(e,t){return t.column>=e.startCol&&t.column+t.colspan-1<=e.finishCol&&t.row>=e.startRow&&t.row+t.rowspan-1<=e.finishRow},fi=function(e,t){for(var n=!0,r=w(di,t),i=t.startRow;i<=t.finishRow;i++)for(var o=t.startCol;o<=t.finishCol;o++)n=n&&ui.getAt(e,i,o).exists(r);return n?A.some(t):A.none()},hi=function(e,t){return Zt(Math.min(e.row,t.row),Math.min(e.column,t.column),Math.max(e.row+e.rowspan-1,t.row+t.rowspan-1),Math.max(e.column+e.colspan-1,t.column+t.colspan-1))},mi=function(e,t,n){var r=ui.findItem(e,t,xt),i=ui.findItem(e,n,xt);return r.bind((function(e){return i.map((function(t){return hi(e,t)}))}))},pi=function(e,t,n){return mi(e,t,n).bind((function(t){return fi(e,t)}))},gi=function(e,t,n,r){return ui.findItem(e,t,xt).bind((function(t){var i=n>0?t.row+t.rowspan-1:t.row,o=r>0?t.column+t.colspan-1:t.column,a=ui.getAt(e,i+n,o+r);return a.map((function(e){return e.element}))}))},vi=function(e,t,n){return mi(e,t,n).map((function(t){var n=ui.filterItems(e,w(ci,t));return F(n,(function(e){return e.element}))}))},bi=function(e,t){var n=function(e,t){return Dt(t,e)};return ui.findItem(e,t,n).map((function(e){return e.element}))},yi=function(e,t,n){return Rr(e).bind((function(r){var i=Ci(r);return gi(i,e,t,n)}))},wi=function(e,t,n){var r=Ci(e);return vi(r,t,n)},Si=function(e,t,n,r,i){var o=Ci(e),a=xt(e,n)?A.some(t):bi(o,t),s=xt(e,i)?A.some(r):bi(o,r);return a.bind((function(e){return s.bind((function(t){return vi(o,e,t)}))}))},xi=function(e,t,n){var r=Ci(e);return pi(r,t,n)},Ci=ui.fromTable,Ti=function(e,t){var n=pn(e);n.each((function(n){n.dom.insertBefore(t.dom,e.dom)}))},Di=function(e,t){var n=yn(e);n.fold((function(){var n=pn(e);n.each((function(e){Ei(e,t)}))}),(function(e){Ti(e,t)}))},ki=function(e,t){var n=xn(e);n.fold((function(){Ei(e,t)}),(function(n){e.dom.insertBefore(t.dom,n.dom)}))},Ei=function(e,t){e.dom.appendChild(t.dom)},_i=function(e,t,n){Sn(e,n).fold((function(){Ei(e,t)}),(function(e){Ti(e,t)}))},Ai=function(e,t){Ti(e,t),Ei(t,e)},Li=function(e,t){B(t,(function(t){Ti(e,t)}))},Oi=function(e,t){B(t,(function(n,r){var i=0===r?e:t[r-1];Di(i,n)}))},Ri=function(e,t){B(t,(function(t){Ei(e,t)}))},Ii=function(e){e.dom.textContent="",B(wn(e),(function(e){Pi(e)}))},Pi=function(e){var t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},Mi=function(e){var t=wn(e);t.length>0&&Li(e,t),Pi(e)},Ni=function(e,t){var n=function(n){if(!e(n))throw new Error("Can only get "+t+" value of a "+t+" node");return r(n).getOr("")},r=function(t){return e(t)?A.from(t.dom.nodeValue):A.none()},i=function(n,r){if(!e(n))throw new Error("Can only set raw "+t+" value of a "+t+" node");n.dom.nodeValue=r};return{get:n,getOption:r,set:i}},Fi=Ni(ln,"text"),Bi=function(e){return Fi.get(e)},$i=function(e){return Fi.getOption(e)},zi=function(e,t){return Fi.set(e,t)},Ui=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function Vi(){var e=function(e){return vt.fromDom(e.dom.cloneNode(!1))},t=function(e){return hn(e).dom},n=function(e){return!!sn(e)&&("body"===nn(e)||P(Ui,nn(e)))},r=function(e){return!!sn(e)&&P(["br","img","hr","input"],nn(e))},i=function(e){return sn(e)&&"false"===Zn(e,"contenteditable")},o=function(e,t){return e.dom.compareDocumentPosition(t.dom)},a=function(e,t){var n=nr(e);Jn(t,n)},s=function(e){var t=nn(e);return P(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],t)},l=function(e){return sn(e)?er(e,"lang"):A.none()};return{up:v({selector:qn,closest:Kn,predicate:Un,all:vn}),down:v({selector:$n,predicate:Nn}),styles:v({get:mr,getRaw:gr,set:fr,remove:vr}),attrs:v({get:Zn,set:Xn,remove:tr,copyTo:a}),insert:v({before:Ti,after:Di,afterAll:Oi,append:Ei,appendAll:Ri,prepend:ki,wrap:Ai}),remove:v({unwrap:Mi,remove:Pi}),create:v({nu:vt.fromTag,clone:e,text:vt.fromText}),query:v({comparePosition:o,prevSibling:bn,nextSibling:yn}),property:v({children:wn,name:nn,parent:pn,document:t,isText:ln,isComment:an,isElement:sn,isSpecial:s,getLanguage:l,getText:Bi,setText:zi,isBoundary:n,isEmptyTag:r,isNonEditable:i}),eq:xt,is:kt}}var Hi=function(e,t,n,r){var i=n[0],o=n.slice(1);return r(e,t,i,o)},ji=function(e,t,n){return n.length>0?Hi(e,t,n,qi):A.none()},qi=function(e,t,n,r){var i=t(e,n);return V(r,(function(n,r){var i=t(e,r);return Gi(e,n,i)}),i)},Gi=function(e,t,n){return t.bind((function(t){return n.filter(w(e.eq,t))}))},Wi=function(e,t){return w(e.eq,t)},Ki=function(e,t,n,r){void 0===r&&(r=C);var i=[t].concat(e.up().all(t)),o=[n].concat(e.up().all(n)),a=function(e){var t=G(e,r);return t.fold((function(){return e}),(function(t){return e.slice(0,t+1)}))},s=a(i),l=a(o),u=q(s,(function(t){return M(l,Wi(e,t))}));return{firstpath:s,secondpath:l,shared:u}},Yi=ji,Xi=Ki,Ji=Vi(),Qi=function(e,t){return Yi(Ji,(function(t,n){return e(n)}),t)},Zi=function(e,t,n){return Xi(Ji,e,t,n)},eo=function(e){return qn(e,"table")},to=function(e,t,n){var r=function(e){return function(t){return void 0!==n&&n(t)||xt(t,e)}};return xt(e,t)?A.some({boxes:A.some([e]),start:e,finish:t}):eo(e).bind((function(i){return eo(t).bind((function(o){if(xt(i,o))return A.some({boxes:wi(i,e,t),start:e,finish:t});if(Dt(i,o)){var a=Fn(t,"td,th",r(i)),s=a.length>0?a[a.length-1]:t;return A.some({boxes:Si(i,e,i,t,o),start:e,finish:s})}if(Dt(o,i)){a=Fn(e,"td,th",r(o));var l=a.length>0?a[a.length-1]:e;return A.some({boxes:Si(o,e,i,t,o),start:e,finish:l})}return Zi(e,t).shared.bind((function(a){return Kn(a,"table",n).bind((function(n){var a=Fn(t,"td,th",r(n)),s=a.length>0?a[a.length-1]:t,l=Fn(e,"td,th",r(n)),u=l.length>0?l[l.length-1]:e;return A.some({boxes:Si(n,e,i,t,o),start:u,finish:s})}))}))}))}))},no=function(e,t){var n=$n(e,t);return n.length>0?A.some(n):A.none()},ro=function(e,t){return q(e,(function(e){return bt(e,t)}))},io=function(e,t,n){return Wn(e,t).bind((function(t){return Wn(e,n).bind((function(e){return Qi(eo,[t,e]).map((function(n){return{first:t,last:e,table:n}}))}))}))},oo=function(e,t){return qn(e,"table").bind((function(n){return Wn(n,t).bind((function(t){return to(t,e).bind((function(e){return e.boxes.map((function(t){return{boxes:t,start:e.start,finish:e.finish}}))}))}))}))},ao=function(e,t,n,r,i){return ro(e,i).bind((function(e){return yi(e,t,n).bind((function(e){return oo(e,r)}))}))},so=function(e,t){return no(e,t)},lo=function(e,t,n){return io(e,t,n).bind((function(t){var n=function(t){return xt(e,t)},r="thead,tfoot,tbody,table",i=qn(t.first,r,n),o=qn(t.last,r,n);return i.bind((function(e){return o.bind((function(n){return xt(e,n)?xi(t.table,t.first,t.last):A.none()}))}))}))},uo=function(e){if(!a(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var t=[],n={};return B(e,(function(r,i){var o=Et(r);if(1!==o.length)throw new Error("one and only one name per case");var s=o[0],l=r[s];if(void 0!==n[s])throw new Error("duplicate key detected:"+s);if("cata"===s)throw new Error("cannot have a case named cata (sorry)");if(!a(l))throw new Error("case arguments must be an array");t.push(s),n[s]=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=n.length;if(o!==l.length)throw new Error("Wrong number of arguments to case "+s+". Expected "+l.length+" ("+l+"), got "+o);var a=function(e){var r=Et(e);if(t.length!==r.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+r.join(","));var i=Y(t,(function(e){return P(r,e)}));if(!i)throw new Error("Not all branches were specified when using match. Specified: "+r.join(", ")+"\nRequired: "+t.join(", "));return e[s].apply(null,n)};return{fold:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(t.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);var o=t[i];return o.apply(null,n)},match:a,log:function(e){console.log(e,{constructors:t,constructor:s,params:n})}}}})),n},co={generate:uo},fo=co.generate([{none:[]},{multiple:["elements"]},{single:["element"]}]),ho=function(e,t,n,r){return e.fold(t,n,r)},mo=fo.none,po=fo.multiple,go=fo.single,vo=function(e,t,n){var r=function(){return so(e(),n).fold((function(){return t().fold(mo,go)}),(function(e){return po(e)}))};return{get:r}},bo=tinymce.util.Tools.resolve("tinymce.PluginManager"),yo=function(e,t){return vt.fromDom(e.dom.cloneNode(t))},wo=function(e){return yo(e,!1)},So=function(e){return yo(e,!0)},xo=function(e,t){var n=vt.fromTag(t),r=nr(e);return Jn(n,r),n},Co=function(e,t){var n=xo(e,t),r=wn(So(e));return Ri(n,r),n},To=function(e,t){var n=xo(e,t);Ti(e,n);var r=wn(e);return Ri(n,r),Pi(e),n},Do=function(e,t){var n=function(t,n){if(!h(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);var r=t.dom;ur(r)&&(r.style[e]=n+"px")},r=function(n){var r=t(n);if(r<=0||null===r){var i=mr(n,e);return parseFloat(i)||0}return r},i=r,o=function(e,t){return H(t,(function(t,n){var r=mr(e,n),i=void 0===r?0:parseInt(r,10);return isNaN(i)?t:t+i}),0)},a=function(e,t,n){var r=o(e,n),i=t>r?t-r:0;return i};return{set:n,get:r,getOuter:i,aggregate:o,max:a}},ko=function(){var e=it().browser;return e.isIE()||e.isEdge()},Eo=function(e,t){return _e(e).getOr(t)},_o=function(e,t,n){return Eo(mr(e,t),n)},Ao=function(e){return mr(e,"box-sizing")},Lo=function(e,t,n,r){var i=_o(e,"padding-"+n,0),o=_o(e,"padding-"+r,0),a=_o(e,"border-"+n+"-width",0),s=_o(e,"border-"+r+"-width",0);return t-i-o-a-s},Oo=function(e,t){var n=e.dom,r=n.getBoundingClientRect().height||n.offsetHeight;return"border-box"===t?r:Lo(e,r,"top","bottom")},Ro=function(e,t){var n=e.dom,r=n.getBoundingClientRect().width||n.offsetWidth;return"border-box"===t?r:Lo(e,r,"left","right")},Io=function(e){return ko()?Oo(e,Ao(e)):_o(e,"height",e.dom.offsetHeight)},Po=function(e){return ko()?Ro(e,Ao(e)):_o(e,"width",e.dom.offsetWidth)},Mo=function(e){return Ro(e,"content-box")},No=Do("width",(function(e){return e.dom.offsetWidth})),Fo=function(e){return No.get(e)},Bo=function(e){return No.getOuter(e)},$o=Mo,zo=Po,Uo=function(e,t){void 0===t&&(t=T);var n=e.grid,r=N(n.columns,b),i=N(n.rows,b);return F(r,(function(n){var r=function(){return K(i,(function(t){return ui.getAt(e,t,n).filter((function(e){return e.column===n})).toArray()}))},o=function(e){return 1===e.colspan&&t(e.element)},a=function(){return ui.getAt(e,0,n)};return Vo(r,o,a)}))},Vo=function(e,t,n){var r=e(),i=q(r,t),o=i.orThunk((function(){return A.from(r[0]).orThunk(n)}));return o.map((function(e){return e.element}))},Ho=function(e){var t=e.grid,n=N(t.rows,b),r=N(t.columns,b);return F(n,(function(t){var n=function(){return K(r,(function(n){return ui.getAt(e,t,n).filter((function(e){return e.row===t})).fold(v([]),(function(e){return[e]}))}))},i=function(e){return 1===e.rowspan},o=function(){return ui.getAt(e,t,0)};return Vo(n,i,o)}))},jo=function(e,t){if(t<0||t>=e.length-1)return A.none();var n=e[t].fold((function(){var n=X(e.slice(0,t));return re(n,(function(e,t){return e.map((function(e){return{value:e,delta:t+1}}))}))}),(function(e){return A.some({value:e,delta:0})})),r=e[t+1].fold((function(){var n=e.slice(t+1);return re(n,(function(e,t){return e.map((function(e){return{value:e,delta:t+1}}))}))}),(function(e){return A.some({value:e,delta:1})}));return n.bind((function(e){return r.map((function(t){var n=t.delta+e.delta;return Math.abs(t.value-e.value)/n}))}))},qo=function(e,t){return function(n){return"rtl"===Go(n)?t:e}},Go=function(e){return"rtl"===mr(e,"direction")?"rtl":"ltr"},Wo=Do("height",(function(e){var t=e.dom;return On(e)?t.getBoundingClientRect().height:t.offsetHeight})),Ko=function(e){return Wo.get(e)},Yo=function(e){return Wo.getOuter(e)},Xo=Io,Jo=function(e,t){var n=function(n,r){return Jo(e+n,t+r)};return{left:e,top:t,translate:n}},Qo=Jo,Zo=function(e){var t=e.getBoundingClientRect();return Qo(t.left,t.top)},ea=function(e,t){return void 0!==e?e:void 0!==t?t:0},ta=function(e){var t=e.dom.ownerDocument,n=t.body,r=t.defaultView,i=t.documentElement;if(n===e.dom)return Qo(n.offsetLeft,n.offsetTop);var o=ea(null===r||void 0===r?void 0:r.pageYOffset,i.scrollTop),a=ea(null===r||void 0===r?void 0:r.pageXOffset,i.scrollLeft),s=ea(i.clientTop,n.clientTop),l=ea(i.clientLeft,n.clientLeft);return na(e).translate(a-l,o-s)},na=function(e){var t=e.dom,n=t.ownerDocument,r=n.body;return r===t?Qo(r.offsetLeft,r.offsetTop):On(e)?Zo(t):Qo(0,0)},ra=function(e,t){return{row:e,y:t}},ia=function(e,t){return{col:e,x:t}},oa=function(e){var t=ta(e);return t.left+Bo(e)},aa=function(e){return ta(e).left},sa=function(e,t){return ia(e,aa(t))},la=function(e,t){return ia(e,oa(t))},ua=function(e){return ta(e).top},ca=function(e,t){return ra(e,ua(t))},da=function(e,t){return ra(e,ua(t)+Yo(t))},fa=function(e,t,n){if(0===n.length)return[];var r=F(n.slice(1),(function(t,n){return t.map((function(t){return e(n,t)}))})),i=n[n.length-1].map((function(e){return t(n.length-1,e)}));return r.concat([i])},ha=function(e){return-e},ma={delta:b,positions:function(e){return fa(ca,da,e)},edge:ua},pa={delta:b,edge:aa,positions:function(e){return fa(sa,la,e)}},ga={delta:ha,edge:oa,positions:function(e){return fa(la,sa,e)}},va=qo(pa,ga),ba={delta:function(e,t){return va(t).delta(e,t)},positions:function(e,t){return va(t).positions(e,t)},edge:function(e){return va(e).edge(e)}},ya={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},wa=function(){var e="[0-9]+",t="[+-]?"+e,n="[eE]"+t,r="\\.",i=function(e){return"(?:"+e+")?"},o=["Infinity",e+r+i(e)+i(n),r+e+i(n),e+i(n)].join("|"),a="[+-]?(?:"+o+")";return new RegExp("^("+a+")(.*)$")}(),Sa=function(e,t){return M(t,(function(t){return M(ya[t],(function(t){return e===t}))}))},xa=function(e,t){var n=A.from(wa.exec(e));return n.bind((function(e){var n=Number(e[1]),r=e[2];return Sa(r,t)?A.some({value:n,unit:r}):A.none()}))},Ca=/(\d+(\.\d+)?)%/,Ta=/(\d+(\.\d+)?)px|em/,Da=dn("col"),ka=function(e,t,n){var r=gn(e).getOrThunk((function(){return In(fn(e))}));return t(e)/n(r)*100},Ea=function(e,t){fr(e,"width",t+"px")},_a=function(e,t){fr(e,"width",t+"%")},Aa=function(e,t){fr(e,"height",t+"px")},La=function(e){return Xo(e)+"px"},Oa=function(e,t,n,r){var i=Rr(e).map((function(e){var r=n(e);return Math.floor(t/100*r)})).getOr(t);return r(e,i),i},Ra=function(e,t,n,r){var i=parseFloat(e);return Ce(e,"%")&&"table"!==nn(t)?Oa(t,i,n,r):i},Ia=function(e){var t=La(e);return t?Ra(t,e,Ko,Aa):Ko(e)},Pa=function(e,t,n){var r=n(e),i=wr(e,t);return r/i},Ma=function(e,t){return gr(e,t).orThunk((function(){return er(e,t).map((function(e){return e+"px"}))}))},Na=function(e){return Ma(e,"width")},Fa=function(e){return Ma(e,"height")},Ba=function(e){return ka(e,Fo,$o)},$a=function(e){return Da(e)?Fo(e):zo(e)},za=function(e){return Pa(e,"rowspan",Ia)},Ua=function(e){var t=Na(e);return t.bind((function(e){return xa(e,["fixed","relative","empty"])}))},Va=function(e,t,n){fr(e,"width",t+n)},Ha=function(e){return Fo(e)+"px"},ja=function(e){return ka(e,Fo,$o)+"%"},qa=function(e){return Na(e).exists((function(e){return Ca.test(e)}))},Ga=function(e){return Na(e).exists((function(e){return Ta.test(e)}))},Wa=function(e){return Na(e).isNone()},Ka=v(Ca),Ya=dn("col"),Xa=function(e){return Na(e).getOrThunk((function(){return $a(e)+"px"}))},Ja=function(e){return Fa(e).getOrThunk((function(){return za(e)+"px"}))},Qa=function(e){return F(ui.justColumns(e),(function(e){return A.from(e.element)}))},Za=function(e){var t=it().browser,n=t.isChrome()||t.isFirefox();return!Ya(e)||n},es=function(e,t,n,r,i,o){return e.filter(r).fold((function(){return o(jo(n,t))}),(function(e){return i(e)}))},ts=function(e,t,n,r){var i=Uo(e),o=ui.hasColumns(e)?Qa(e):i,a=[A.some(ba.edge(t))].concat(F(ba.positions(i,t),(function(e){return e.map((function(e){return e.x}))}))),s=S(Sr);return F(o,(function(e,t){return es(e,t,a,s,(function(e){if(Za(e))return n(e);var o=ar(i[t],b);return es(o,t,a,s,(function(e){return r(A.some(Fo(e)))}),r)}),r)}))},ns=function(e){return e.map((function(e){return e+"px"})).getOr("")},rs=function(e,t){return ts(e,t,Xa,ns)},is=function(e,t,n){return ts(e,t,Ba,(function(e){return e.fold((function(){return n.minCellWidth()}),(function(e){return e/n.pixelWidth()*100}))}))},os=function(e,t,n){return ts(e,t,$a,(function(e){return e.getOrThunk(n.minCellWidth)}))},as=function(e,t,n,r,i){var o=Ho(e),a=[A.some(n.edge(t))].concat(F(n.positions(o,t),(function(e){return e.map((function(e){return e.y}))})));return F(o,(function(e,t){return es(e,t,a,S(xr),r,i)}))},ss=function(e,t,n){return as(e,t,n,za,(function(e){return e.getOrThunk(Dr)}))},ls=function(e,t,n){return as(e,t,n,Ja,ns)},us=function(e,t){return function(){return On(e)?t(e):parseFloat(gr(e,"width").getOr("0"))}},cs=function(e){var t=us(e,Fo),n=v(0),r=function(t,n){return os(t,e,n)};return{width:t,pixelWidth:t,getWidths:r,getCellDelta:n,singleColumnWidth:v([0]),minCellWidth:n,setElementWidth:m,adjustTableWidth:m,isRelative:!0,label:"none"}},ds=function(e){var t=us(e,(function(e){return parseFloat(ja(e))})),n=us(e,Fo),r=function(e){return e/n()*100},i=function(e,t){return[100-e]},o=function(){return Tr()/n()*100},a=function(n){var r=t(),i=n/100*r,o=r+i;_a(e,o)},s=function(t,n){return is(t,e,n)};return{width:t,pixelWidth:n,getWidths:s,getCellDelta:r,singleColumnWidth:i,minCellWidth:o,setElementWidth:_a,adjustTableWidth:a,isRelative:!0,label:"percent"}},fs=function(e){var t=us(e,Fo),n=b,r=function(e,t){var n=Math.max(Tr(),e+t);return[n-e]},i=function(n){var r=t()+n;Ea(e,r)},o=function(t,n){return os(t,e,n)};return{width:t,pixelWidth:t,getWidths:o,getCellDelta:n,singleColumnWidth:r,minCellWidth:Tr,setElementWidth:Ea,adjustTableWidth:i,isRelative:!1,label:"pixel"}},hs=function(e,t){var n=Ka().exec(t);return null!==n?ds(e):fs(e)},ms=function(e){var t=Na(e);return t.fold((function(){return cs(e)}),(function(t){return hs(e,t)}))},ps={getTableSize:ms,pixelSize:fs,percentageSize:ds,noneSize:cs},gs=function(e,t,n,r,i,o){return{minRow:e,minCol:t,maxRow:n,maxCol:r,allCells:i,selectedCells:o}},vs=function(e,t){var n=e.grid.columns,r=e.grid.rows,i=r,o=n,a=0,s=0,l=[],u=[];return At(e.access,(function(e){if(l.push(e),t(e)){u.push(e);var n=e.row,r=n+e.rowspan-1,c=e.column,d=c+e.colspan-1;n<i?i=n:r>a&&(a=r),c<o?o=c:d>s&&(s=d)}})),gs(i,o,a,s,l,u)},bs=function(e,t,n){var r=e[n].element,i=vt.fromTag("td");Ei(i,vt.fromTag("br"));var o=t?Ei:ki;o(r,i)},ys=function(e,t,n,r){for(var i=t.grid.columns,o=t.grid.rows,a=0;a<o;a++)for(var s=!1,l=0;l<i;l++)if(!(a<n.minRow||a>n.maxRow||l<n.minCol||l>n.maxCol)){var u=ui.getAt(t,a,l).filter(r).isNone();u?bs(e,s,a):s=!0}},ws=function(e,t,n,r){At(n.columns,(function(e){(e.column<t.minCol||e.column>t.maxCol)&&Pi(e.element)}));var i=U(kr(e,"tr"),(function(e){return 0===e.dom.childElementCount}));B(i,Pi),t.minCol!==t.maxCol&&t.minRow!==t.maxRow||B(kr(e,"th,td"),(function(e){tr(e,"rowspan"),tr(e,"colspan")})),tr(e,Yr),tr(e,"data-snooker-col-series");var o=ps.getTableSize(e);o.adjustTableWidth(r)},Ss=function(e,t,n,r){if(0===r.minCol&&t.grid.columns===r.maxCol+1)return 0;var i=os(t,e,n),o=H(i,(function(e,t){return e+t}),0),a=H(i.slice(r.minCol,r.maxCol+1),(function(e,t){return e+t}),0),s=a/o*n.pixelWidth(),l=s-n.pixelWidth();return n.getCellDelta(l)},xs=function(e,t){var n=function(e){return bt(e.element,t)},r=So(e),i=Fr(r),o=ps.getTableSize(e),a=ui.generate(i),s=vs(a,n),l="th:not("+t+"),td:not("+t+")",u=Er(r,"th,td",(function(e){return bt(e,l)}));B(u,Pi),ys(i,a,s,n);var c=ui.fromTable(e),d=Ss(e,c,o,s);return ws(r,s,a,d),r},Cs=" ",Ts=function(e){return"img"===nn(e)?1:$i(e).fold((function(){return wn(e).length}),(function(e){return e.length}))},Ds=function(e){return $i(e).filter((function(e){return 0!==e.trim().length||e.indexOf(Cs)>-1})).isSome()},ks=["img","br"],Es=function(e){var t=Ds(e);return t||P(ks,nn(e))},_s=function(e){return jn(e,Es)},As=function(e){return Ls(e,Es)},Ls=function(e,t){var n=function(e){for(var r=wn(e),i=r.length-1;i>=0;i--){var o=r[i];if(t(o))return A.some(o);var a=n(o);if(a.isSome())return a}return A.none()};return n(e)},Os={scope:["row","col"]},Rs=function(e){return function(){var t=vt.fromTag("td",e.dom);return Ei(t,vt.fromTag("br",e.dom)),t}},Is=function(e){return function(){return vt.fromTag("col",e.dom)}},Ps=function(e){return function(){return vt.fromTag("colgroup",e.dom)}},Ms=function(e){return function(){return vt.fromTag("tr",e.dom)}},Ns=function(e,t,n){var r=Co(e,t);return At(n,(function(e,t){null===e?tr(r,t):Xn(r,t,e)})),r},Fs=function(e){return e},Bs=function(e,t,n){var r=_s(e);return r.map((function(r){var i=n.join(","),o=Fn(r,i,(function(t){return xt(t,e)}));return V(o,(function(e,t){var n=wo(t);return tr(n,"contenteditable"),Ei(e,n),n}),t)})).getOr(t)},$s=function(e,t){At(Os,(function(n,r){return er(e,r).filter((function(e){return P(n,e)})).each((function(e){return Xn(t,r,e)}))}))},zs=function(e,t,n){var r=function(e,t){br(e.element,t),vr(t,"height"),1!==e.colspan&&vr(t,"width")},i=function(i){var o=vt.fromTag(nn(i.element),t.dom),a=n.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),s=a.length>0?Bs(i.element,o,a):o;return Ei(s,vt.fromTag("br")),r(i,o),$s(i.element,o),e(i.element,o),o},o=function(n){var i=vt.fromTag(nn(n.element),t.dom);return r(n,i),e(n.element,i),i};return{col:o,colgroup:Ps(t),row:Ms(t),cell:i,replace:Ns,colGap:Is(t),gap:Rs(t)}},Us=function(e){return{col:Is(e),colgroup:Ps(e),row:Ms(e),cell:Rs(e),replace:Fs,colGap:Is(e),gap:Rs(e)}},Vs=function(e,t){var n=t||document,r=n.createElement("div");return r.innerHTML=e,wn(vt.fromDom(r))},Hs=function(e){return F(e,vt.fromDom)},js=function(e){return e.nodeName.toLowerCase()},qs=function(e){return vt.fromDom(e.getBody())},Gs=function(e){return e.getBoundingClientRect().width},Ws=function(e){return e.getBoundingClientRect().height},Ks=function(e){return function(t){return xt(t,qs(e))}},Ys=function(e){return e?e.replace(/px$/,""):""},Xs=function(e){return/^\d+(\.\d+)?$/.test(e)?e+"px":e},Js=function(e){tr(e,"data-mce-style");var t=function(e){return tr(e,"data-mce-style")};B(Lr(e),t),B(Or(e),t),B(Ir(e),t)},Qs=function(e,t){var n=e.dom.getStyle(t,"width")||e.dom.getAttrib(t,"width");return A.from(n).filter(ke)},Zs=function(e){return/^(\d+(\.\d+)?)%$/.test(e)},el=function(e){return/^(\d+(\.\d+)?)px$/.test(e)},tl=function(e){return vt.fromDom(e.selection.getStart())},nl=function(e){return vt.fromDom(e.selection.getEnd())},rl=function(e){return ho(e.get(),v([]),b,Q)},il=function(e){var t=function(e,t){return er(e,t).exists((function(e){return parseInt(e,10)>1}))},n=function(e){return t(e,"rowspan")||t(e,"colspan")},r=rl(e);return r.length>0&&Y(r,n)?A.some(r):A.none()},ol=function(e,t,n){return ho(t.get(),A.none,(function(t){return t.length<=1?A.none():lo(e,n.firstSelectedSelector,n.lastSelectedSelector).map((function(e){return{bounds:e,cells:t}}))}),A.none)},al="data-mce-selected",sl="td["+al+"],th["+al+"]",ll="["+al+"]",ul="data-mce-first-selected",cl="td["+ul+"],th["+ul+"]",dl="data-mce-last-selected",fl="td["+dl+"],th["+dl+"]",hl=ll,ml={selected:al,selectedSelector:sl,firstSelected:ul,firstSelectedSelector:cl,lastSelected:dl,lastSelectedSelector:fl},pl=function(e){return{element:e,mergable:A.none(),unmergable:A.none(),selection:[e]}},gl=function(e,t,n){return{element:n,mergable:ol(t,e,ml),unmergable:il(e),selection:rl(e)}},vl=function(e,t,n){return{element:e,clipboard:t,generators:n}},bl=function(e,t,n,r){return{selection:rl(e),clipboard:n,generators:r}},yl=function(e){return Rr(e).bind((function(e){return so(e,ml.firstSelectedSelector)})).fold(v(e),(function(e){return e[0]}))},wl=function(e){return function(t,n){var r=nn(t),i="col"===r||"colgroup"===r?yl(t):t;return Kn(i,e,n)}},Sl=wl("th,td,caption"),xl=wl("th,td"),Cl=function(e){return rl(e)},Tl=function(e,t){var n=xl(e),r=n.bind((function(e){return Rr(e)})).map((function(e){return Ir(e)}));return or(n,r,(function(e,n){return U(n,(function(n){return M(Hs(n.dom.cells),(function(n){return"1"===Zn(n,t)||xt(n,e)}))}))})).getOr([])},Dl=function(e){return Rr(e[0]).map((function(e){var t=xs(e,hl);return Js(t),[t]}))},kl=function(e,t){return F(t,(function(t){return e.selection.serializer.serialize(t.dom,{})})).join("")},El=function(e){return F(e,(function(e){return e.dom.innerText})).join("")},_l=function(e,t,n){e.on("BeforeGetContent",(function(n){var r=function(t){n.preventDefault(),Dl(t).each((function(t){n.content="text"===n.format?El(t):kl(e,t)}))};!0===n.selection&&ho(t.get(),m,r,m)})),e.on("BeforeSetContent",(function(r){if(!0===r.selection&&!0===r.paste){var i=Cl(t);te(i).each((function(t){Rr(t).each((function(i){var o=U(Vs(r.content),(function(e){return"meta"!==nn(e)})),a=dn("table");if(1===o.length&&a(o[0])){r.preventDefault();var s=vt.fromDom(e.getDoc()),l=Us(s),u=vl(t,o[0],l);n.pasteCells(i,u).each((function(){e.focus()}))}}))}))}}))},Al=co.generate([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),Ll=ie({},Al),Ol=function(e,t){return 0===e.length?Ll.none():1===e.length?Ll.only(0):0===t?Ll.left(0,1):t===e.length-1?Ll.right(t-1,t):t>0&&t<e.length-1?Ll.middle(t-1,t,t+1):Ll.none()},Rl=function(e,t,n,r,i){var o=e.slice(0),a=Ol(e,t),s=v(F(o,v(0))),l=function(e){return r.singleColumnWidth(o[e],n)},u=function(e,t){return i.calcLeftEdgeDeltas(o,e,t,n,r.minCellWidth(),r.isRelative)},c=function(e,t,a){return i.calcMiddleDeltas(o,e,t,a,n,r.minCellWidth(),r.isRelative)},d=function(e,t){return i.calcRightEdgeDeltas(o,e,t,n,r.minCellWidth(),r.isRelative)};return a.fold(s,l,u,c,d)},Il=function(e,t,n){for(var r=0,i=e;i<t;i++)r+=void 0!==n[i]?n[i]:0;return r},Pl=function(e,t){var n=ui.justCells(e);return F(n,(function(e){var n=Il(e.column,e.column+e.colspan,t);return{element:e.element,width:n,colspan:e.colspan}}))},Ml=function(e,t){var n=ui.justColumns(e);return F(n,(function(e,n){return{element:e.element,width:t[n],colspan:e.colspan}}))},Nl=function(e,t){var n=ui.justCells(e);return F(n,(function(e){var n=Il(e.row,e.row+e.rowspan,t);return{element:e.element,height:n,rowspan:e.rowspan}}))},Fl=function(e,t){return F(e.all,(function(e,n){return{element:e.element,height:t[n]}}))},Bl=function(e){return V(e,(function(e,t){return e+t}),0)},$l=function(e,t){return ui.hasColumns(e)?Ml(e,t):Pl(e,t)},zl=function(e,t,n){var r=$l(e,t);B(r,(function(e){n.setElementWidth(e.element,e.width)}))},Ul=function(e,t,n,r,i){var o=ui.fromTable(e),a=i.getCellDelta(t),s=i.getWidths(o,i),l=n===o.grid.columns-1,u=r.clampTableDelta(s,n,a,i.minCellWidth(),l),c=Rl(s,n,u,i,r),d=F(c,(function(e,t){return e+s[t]}));zl(o,d,i),r.resizeTable(i.adjustTableWidth,u,l)},Vl=function(e,t,n,r){var i=ui.fromTable(e),o=ss(i,e,r),a=F(o,(function(e,r){return n===r?Math.max(t+e,Dr()):e})),s=Nl(i,a),l=Fl(i,a);B(l,(function(e){Aa(e.element,e.height)})),B(s,(function(e){Aa(e.element,e.height)}));var u=Bl(a);Aa(e,u)},Hl=function(e,t,n,r,i){var o=ui.generate(t),a=r.getWidths(o,r),s=r.pixelWidth(),l=i.calcRedestributedWidths(a,s,n.pixelDelta,r.isRelative),u=l.newSizes,c=l.delta;zl(o,u,r),r.adjustTableWidth(c)},jl=function(e,t,n,r){var i=ui.generate(t),o=r.getWidths(i,r);zl(i,o,r)},ql=function(e){return F(e,v(0))},Gl=function(e,t,n,r,i){return i(e.slice(0,t)).concat(r).concat(i(e.slice(n)))},Wl=function(e){return function(t,n,r,i){if(e(r)){var o=Math.max(i,t[n]-Math.abs(r)),a=Math.abs(o-t[n]);return r>=0?a:-a}return r}},Kl=Wl((function(e){return e<0})),Yl=Wl(T),Xl=function(){var e=function(e,t,n,r,i){var o=Kl(e,t,r,i);return Gl(e,t,n+1,[o,0],ql)},t=function(e,t,n,r){var i=(100+n)/100,o=Math.max(r,(e[t]+n)/i);return F(e,(function(e,n){var r=n===t?o:e/i;return r-e}))},n=function(n,r,i,o,a,s){return s?t(n,r,o,a):e(n,r,i,o,a)},r=function(e,t,r,i,o,a,s){return n(e,r,i,o,a,s)},i=function(e,t){return e(t)},o=function(e,n,r,i,o,a){if(a)return t(e,r,i,o);var s=Kl(e,r,i,o);return ql(e.slice(0,r)).concat([s])},a=function(e,t,n,r){if(r){var i=t+n,o=i/t,a=F(e,(function(e){return e/o}));return{delta:100*o-100,newSizes:a}}return{delta:n,newSizes:e}};return{resizeTable:i,clampTableDelta:Kl,calcLeftEdgeDeltas:n,calcMiddleDeltas:r,calcRightEdgeDeltas:o,calcRedestributedWidths:a}},Jl=function(){var e=function(e,t,n,r,i){var o=r>=0?n:t,a=Yl(e,o,r,i);return Gl(e,t,n+1,[a,-a],ql)},t=function(t,n,r,i,o,a){return e(t,r,i,o,a)},n=function(e,t,n){n&&e(t)},r=function(e,t,n,r,i,o){if(o)return ql(e);var a=r/e.length;return F(e,v(a))},i=function(e,t,n,r,i){if(i){if(n>=0)return n;var o=H(e,(function(e,t){return e+t-r}),0);return Math.max(-o,n)}return Kl(e,t,n,r)},o=function(e,t,n,r){return{delta:0,newSizes:e}};return{resizeTable:n,clampTableDelta:i,calcLeftEdgeDeltas:e,calcMiddleDeltas:t,calcRightEdgeDeltas:r,calcRedestributedWidths:o}},Ql=function(e,t){var n=A.from(e.dom.documentElement).map(vt.fromDom).getOr(e);return{parent:v(n),view:v(e),origin:v(Qo(0,0)),isResizable:t}},Zl=function(e,t,n){var r=function(){return ta(t)};return{parent:v(t),view:v(e),origin:r,isResizable:n}},eu=function(e,t,n){return{parent:v(t),view:v(e),origin:v(Qo(0,0)),isResizable:n}},tu={only:Ql,detached:Zl,body:eu},nu=co.generate([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),ru=function(e,t,n){var r=n.substring(0,n.length-e.length),i=parseFloat(r);return r===i.toString()?t(i):nu.invalid(n)},iu=function(e){return Ce(e,"%")?ru("%",nu.percent,e):Ce(e,"px")?ru("px",nu.pixels,e):nu.invalid(e)},ou=ie(ie({},nu),{from:iu}),au=function(e,t){return F(e,(function(e){var n=ou.from(e);return n.fold((function(){return e}),(function(e){var n=e/t*100;return n+"%"}),(function(e){return e+"%"}))}))},su=function(e,t,n){var r=n/t;return F(e,(function(e){var t=ou.from(e);return t.fold((function(){return e}),(function(e){return e*r+"px"}),(function(e){return e/100*n+"px"}))}))},lu=function(e,t){var n=e.fold((function(){return v("")}),(function(e){var n=e/t;return v(n+"px")}),(function(){var e=100/t;return v(e+"%")}));return N(t,n)},uu=function(e,t,n){return e.fold((function(){return t}),(function(e){return su(t,n,e)}),(function(e){return au(t,n)}))},cu=function(e,t,n){var r=ou.from(n),i=Y(e,(function(e){return"0px"===e}))?lu(r,e.length):uu(r,e,t);return mu(i)},du=function(e,t){return 0===e.length?t:V(e,(function(e,t){return ou.from(t).fold(v(0),b,b)+e}),0)},fu=function(e,t){var n=Math.floor(e);return{value:n+t,remainder:e-n}},hu=function(e,t){return ou.from(e).fold(v(e),(function(e){return e+t+"px"}),(function(e){return e+t+"%"}))},mu=function(e){if(0===e.length)return e;var t=V(e,(function(e,t){var n=ou.from(t).fold((function(){return{value:t,remainder:0}}),(function(e){return fu(e,"px")}),(function(e){return{value:e+"%",remainder:0}}));return{output:[n.value].concat(e.output),remainder:e.remainder+n.remainder}}),{output:[],remainder:0}),n=t.output;return n.slice(0,n.length-1).concat([hu(n[n.length-1],Math.round(t.remainder))])},pu=ou.from,gu=function(e,t,n){B(t,(function(t){var r=e.slice(t.column,t.colspan+t.column),i=du(r,Tr());fr(t.element,"width",i+n)}))},vu=function(e,t,n){B(t,(function(t,r){var i=du([e[r]],Tr());fr(t.element,"width",i+n)}))},bu=function(e,t,n,r){B(n,(function(t){var n=e.slice(t.row,t.rowspan+t.row),i=du(n,Dr());fr(t.element,"height",i+r)})),B(t,(function(t,n){fr(t.element,"height",e[n])}))},yu=function(e){return pu(e).fold(v("px"),v("px"),v("%"))},wu=function(e,t,n){var r=ui.fromTable(e),i=r.all,o=ui.justCells(r),a=ui.justColumns(r);t.each((function(t){var n=yu(t),i=Fo(e),s=rs(r,e),l=cu(s,i,t);ui.hasColumns(r)?vu(l,a,n):gu(l,o,n),fr(e,"width",t)})),n.each((function(t){var n=yu(t),a=Ko(e),s=ls(r,e,ma),l=cu(s,a,t);bu(l,i,o,n),fr(e,"height",t)}))},Su=qa,xu=Ga,Cu=Wa,Tu=function(e){var t=ui.fromTable(e);return t.grid},Du=function(e){var t=[],n=function(e){if(void 0===e)throw new Error("Event bind error: undefined handler");t.push(e)},r=function(e){t=U(t,(function(t){return t!==e}))},i=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i={};B(e,(function(e,t){i[e]=n[t]})),B(t,(function(e){e(i)}))};return{bind:n,unbind:r,trigger:i}},ku=function(e){var t=Lt(e,(function(e){return{bind:e.bind,unbind:e.unbind}})),n=Lt(e,(function(e){return e.trigger}));return{registry:t,trigger:n}},Eu=function(e,t){var n=null,r=function(){s(n)||(clearTimeout(n),n=null)},i=function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];r(),n=setTimeout((function(){n=null,e.apply(null,i)}),t)};return{cancel:r,throttle:i}},_u=function(e){return e.slice(0).sort()},Au=function(e,t){throw new Error("All required keys ("+_u(e).join(", ")+") were not specified. Specified keys were: "+_u(t).join(", ")+".")},Lu=function(e){throw new Error("Unsupported keys for object: "+_u(e).join(", "))},Ou=function(e,t){if(!a(t))throw new Error("The "+e+" fields must be an array. Was: "+t+".");B(t,(function(t){if(!i(t))throw new Error("The value "+t+" in the "+e+" fields was not a string.")}))},Ru=function(e,t){throw new Error("All values need to be of type: "+t+". Keys ("+_u(e).join(", ")+") were not.")},Iu=function(e){var t=_u(e),n=q(t,(function(e,n){return n<t.length-1&&e===t[n+1]}));n.each((function(e){throw new Error("The field: "+e+" occurs more than once in the combined fields: ["+t.join(", ")+"].")}))},Pu=function(e,t){return Mu(e,t,{validate:f,label:"function"})},Mu=function(e,t,n){if(0===t.length)throw new Error("You must specify at least one required field.");return Ou("required",t),Iu(t),function(r){var i=Et(r),o=Y(t,(function(e){return P(i,e)}));o||Au(t,i),e(t,i);var a=U(t,(function(e){return!n.validate(r[e],e)}));return a.length>0&&Ru(a,n.label),r}},Nu=function(e,t){var n=U(t,(function(t){return!P(e,t)}));n.length>0&&Lu(n)},Fu=function(e){return Pu(Nu,e)},Bu=Fu(["compare","extract","mutate","sink"]),$u=Fu(["element","start","stop","destroy"]),zu=Fu(["forceDrop","drop","move","delayDrop"]),Uu=function(){var e=A.none(),t=function(){e=A.none()},n=function(t,n){var r=e.map((function(e){return t.compare(e,n)}));return e=A.some(n),r},r=function(e,t){var r=t.extract(e);r.each((function(e){var r=n(t,e);r.each((function(e){i.trigger.move(e)}))}))},i=ku({move:Du(["info"])});return{onEvent:r,reset:t,events:i.registry}},Vu=function(){var e=ku({move:Du(["info"])});return{onEvent:m,reset:m,events:e.registry}},Hu=function(){var e=Vu(),t=Uu(),n=e,r=function(){n.reset(),n=t},i=function(){n.reset(),n=e},o=function(e,t){n.onEvent(e,t)},a=function(){return n===t};return{on:r,off:i,isOn:a,onEvent:o,events:t.events}},ju=function(e,t,n){var r=!1,i=ku({start:Du([]),stop:Du([])}),o=Hu(),a=function(){h.stop(),o.isOn()&&(o.off(),i.trigger.stop())},s=Eu(a,200),l=function(e){h.start(e),o.on(),i.trigger.start()},u=function(e){s.cancel(),o.onEvent(e,t)};o.events.move.bind((function(n){t.mutate(e,n.info)}));var c=function(){r=!0},d=function(){r=!1},f=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];r&&e.apply(null,t)}},h=t.sink(zu({forceDrop:a,drop:f(a),move:f(u),delayDrop:f(s.throttle)}),n),m=function(){h.destroy()};return{element:h.element,go:l,on:c,off:d,destroy:m,events:i.registry}},qu=function(e,t,n,r,i,o,a){return{target:e,x:t,y:n,stop:r,prevent:i,kill:o,raw:a}},Gu=function(e){var t=vt.fromDom(An(e).getOr(e.target)),n=function(){return e.stopPropagation()},r=function(){return e.preventDefault()},i=p(r,n);return qu(t,e.clientX,e.clientY,n,r,i,e)},Wu=function(e,t){return function(n){e(n)&&t(Gu(n))}},Ku=function(e,t,n,r,i){var o=Wu(n,r);return e.dom.addEventListener(t,o,i),{unbind:w(Xu,e,t,o,i)}},Yu=function(e,t,n,r){return Ku(e,t,n,r,!1)},Xu=function(e,t,n,r){e.dom.removeEventListener(t,n,r)},Ju=T,Qu=function(e,t,n){return Yu(e,t,Ju,n)},Zu=Gu,ec=function(e,t){var n=Zn(e,t);return void 0===n||""===n?[]:n.split(" ")},tc=function(e,t,n){var r=ec(e,t),i=r.concat([n]);return Xn(e,t,i.join(" ")),!0},nc=function(e,t,n){var r=U(ec(e,t),(function(e){return e!==n}));return r.length>0?Xn(e,t,r.join(" ")):tr(e,t),!1},rc=function(e){return void 0!==e.dom.classList},ic=function(e){return ec(e,"class")},oc=function(e,t){return tc(e,"class",t)},ac=function(e,t){return nc(e,"class",t)},sc=function(e,t){rc(e)?e.dom.classList.add(t):oc(e,t)},lc=function(e){var t=rc(e)?e.dom.classList:ic(e);0===t.length&&tr(e,"class")},uc=function(e,t){if(rc(e)){var n=e.dom.classList;n.remove(t)}else ac(e,t);lc(e)},cc=function(e,t){return rc(e)&&e.dom.classList.contains(t)},dc=function(e){var t=e.replace(/\./g,"-"),n=function(e){return t+"-"+e};return{resolve:n}},fc=dc("ephox-dragster"),hc=fc.resolve,mc=function(e){var t=ie({layerClass:hc("blocker")},e),n=vt.fromTag("div");Xn(n,"role","presentation"),hr(n,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),sc(n,hc("blocker")),sc(n,t.layerClass);var r=v(n),i=function(){Pi(n)};return{element:r,destroy:i}},pc=function(e,t){return Qo(t.left-e.left,t.top-e.top)},gc=function(e){return A.some(Qo(e.x,e.y))},vc=function(e,t){e.mutate(t.left,t.top)},bc=function(e,t){var n=mc(t),r=Qu(n.element(),"mousedown",e.forceDrop),i=Qu(n.element(),"mouseup",e.drop),o=Qu(n.element(),"mousemove",e.move),a=Qu(n.element(),"mouseout",e.delayDrop),s=function(){n.destroy(),i.unbind(),o.unbind(),a.unbind(),r.unbind()},l=function(e){Ei(e,n.element())},u=function(){Pi(n.element())};return $u({element:n.element,start:l,stop:u,destroy:s})},yc=Bu({compare:pc,extract:gc,sink:bc,mutate:vc}),wc=function(e,t){void 0===t&&(t={});var n=void 0!==t.mode?t.mode:yc;return ju(e,n,t)},Sc=function(e){return Kn(e,"[contenteditable]")},xc=function(e,t){return void 0===t&&(t=!1),!it().browser.isIE()&&On(e)?e.dom.isContentEditable:Sc(e).fold(v(t),(function(e){return"true"===Cc(e)}))},Cc=function(e){return e.dom.contentEditable},Tc=dc("ephox-snooker"),Dc=Tc.resolve,kc=function(){var e=ku({drag:Du(["xDelta","yDelta"])}),t=function(t,n){e.trigger.drag(t,n)};return{mutate:t,events:e.registry}},Ec=function(){var e=ku({drag:Du(["xDelta","yDelta","target"])}),t=A.none(),n=kc();n.events.drag.bind((function(n){t.each((function(t){e.trigger.drag(n.xDelta,n.yDelta,t)}))}));var r=function(e){t=A.some(e)},i=function(){return t};return{assign:r,get:i,mutate:n.mutate,events:e.registry}},_c=function(e,t,n,r,i){var o=vt.fromTag("div");return hr(o,{position:"absolute",left:t-r/2+"px",top:n+"px",height:i+"px",width:r+"px"}),Jn(o,{"data-column":e,role:"presentation"}),o},Ac=function(e,t,n,r,i){var o=vt.fromTag("div");return hr(o,{position:"absolute",left:t+"px",top:n-i/2+"px",height:i+"px",width:r+"px"}),Jn(o,{"data-row":e,role:"presentation"}),o},Lc=Dc("resizer-bar"),Oc=Dc("resizer-rows"),Rc=Dc("resizer-cols"),Ic=7,Pc=function(e,t){return K(e.all,(function(e,n){return t(e.element)?[n]:[]}))},Mc=function(e,t){var n=[];return N(e.grid.columns,(function(r){var i=ui.getColumnAt(e,r).map((function(e){return e.element}));i.forall(t)&&n.push(r)})),U(n,(function(n){var r=ui.filterItems(e,(function(e){return e.column===n}));return Y(r,(function(e){return t(e.element)}))}))},Nc=function(e){var t=$n(e.parent(),"."+Lc);B(t,Pi)},Fc=function(e,t,n){var r=e.origin();B(t,(function(t){t.each((function(t){var i=n(r,t);sc(i,Lc),Ei(e.parent(),i)}))}))},Bc=function(e,t,n,r){Fc(e,t,(function(e,t){var i=_c(t.col,t.x-e.left,n.top-e.top,Ic,r);return sc(i,Rc),i}))},$c=function(e,t,n,r){Fc(e,t,(function(e,t){var i=Ac(t.row,n.left-e.left,t.y-e.top,r,Ic);return sc(i,Oc),i}))},zc=function(e,t,n,r,i){var o=ta(n),a=t.isResizable,s=r.length>0?ma.positions(r,n):[],l=s.length>0?Pc(e,a):[],u=U(s,(function(e,t){return M(l,(function(e){return t===e}))}));$c(t,u,o,Bo(n));var c=i.length>0?ba.positions(i,n):[],d=c.length>0?Mc(e,a):[],f=U(c,(function(e,t){return M(d,(function(e){return t===e}))}));Bc(t,f,o,Yo(n))},Uc=function(e,t){if(Nc(e),e.isResizable(t)){var n=ui.fromTable(t),r=Ho(n),i=Uo(n);zc(n,e,t,r,i)}},Vc=function(e,t){var n=$n(e.parent(),"."+Lc);B(n,t)},Hc=function(e){Vc(e,(function(e){fr(e,"display","none")}))},jc=function(e){Vc(e,(function(e){fr(e,"display","block")}))},qc=function(e){return cc(e,Oc)},Gc=function(e){return cc(e,Rc)},Wc=Dc("resizer-bar-dragging"),Kc=function(e){var t=Ec(),n=wc(t,{}),r=A.none(),i=function(e,t){return A.from(Zn(e,t))};t.events.drag.bind((function(e){i(e.target,"data-row").each((function(t){var n=Cr(e.target,"top");fr(e.target,"top",n+e.yDelta+"px")})),i(e.target,"data-column").each((function(t){var n=Cr(e.target,"left");fr(e.target,"left",n+e.xDelta+"px")}))}));var o=function(e,t){var n=Cr(e,t),r=yr(e,"data-initial-"+t,0);return n-r};n.events.stop.bind((function(){t.get().each((function(t){r.each((function(n){i(t,"data-row").each((function(e){var r=o(t,"top");tr(t,"data-initial-top"),h.trigger.adjustHeight(n,r,parseInt(e,10))})),i(t,"data-column").each((function(e){var r=o(t,"left");tr(t,"data-initial-left"),h.trigger.adjustWidth(n,r,parseInt(e,10))})),Uc(e,n)}))}))}));var a=function(r,i){h.trigger.startAdjust(),t.assign(r),Xn(r,"data-initial-"+i,Cr(r,i)),sc(r,Wc),fr(r,"opacity","0.2"),n.go(e.parent())},s=Qu(e.parent(),"mousedown",(function(e){qc(e.target)&&a(e.target,"top"),Gc(e.target)&&a(e.target,"left")})),l=function(t){return xt(t,e.view())},u=function(e){return Kn(e,"table",l).filter(xc)},c=Qu(e.view(),"mouseover",(function(t){u(t.target).fold((function(){On(t.target)&&Nc(e)}),(function(t){r=A.some(t),Uc(e,t)}))})),d=function(){s.unbind(),c.unbind(),n.destroy(),Nc(e)},f=function(t){Uc(e,t)},h=ku({adjustHeight:Du(["table","delta","row"]),adjustWidth:Du(["table","delta","column"]),startAdjust:Du([])});return{destroy:d,refresh:f,on:n.on,off:n.off,hideBars:w(Hc,e),showBars:w(jc,e),events:h.registry}},Yc=function(e,t,n){var r=ma,i=ba,o=Kc(e),a=ku({beforeResize:Du(["table","type"]),afterResize:Du(["table","type"]),startDrag:Du([])});return o.events.adjustHeight.bind((function(e){var t=e.table;a.trigger.beforeResize(t,"row");var n=r.delta(e.delta,t);Vl(t,n,e.row,r),a.trigger.afterResize(t,"row")})),o.events.startAdjust.bind((function(e){a.trigger.startDrag()})),o.events.adjustWidth.bind((function(e){var r=e.table;a.trigger.beforeResize(r,"col");var o=i.delta(e.delta,r),s=n(r);Ul(r,o,e.column,t,s),a.trigger.afterResize(r,"col")})),{on:o.on,off:o.off,hideBars:o.hideBars,showBars:o.showBars,destroy:o.destroy,events:a.registry}},Xc={create:Yc},Jc=function(e,t){return e.fire("newrow",{node:t})},Qc=function(e,t){return e.fire("newcell",{node:t})},Zc=function(e,t,n,r,i){e.fire("ObjectResizeStart",{target:t,width:n,height:r,origin:i})},ed=function(e,t,n,r,i){e.fire("ObjectResized",{target:t,width:n,height:r,origin:i})},td=function(e,t,n,r,i){e.fire("TableSelectionChange",{cells:t,start:n,finish:r,otherCells:i})},nd=function(e){e.fire("TableSelectionClear")},rd=function(e,t,n){e.fire("TableModified",ie(ie({},n),{table:t}))},id={structure:!1,style:!0},od={structure:!0,style:!1},ad={structure:!0,style:!0},sd="tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol",ld={"border-collapse":"collapse",width:"100%"},ud=N(5,(function(e){var t=e+1+"px";return{title:t,value:t}})),cd=F(["Solid","Dotted","Dashed","Double","Groove","Ridge","Inset","Outset","None","Hidden"],(function(e){return{title:e,value:e.toLowerCase()}})),dd=function(e){var t;if(Rd(e)){var n=e.dom,r=null!==(t=n.getParent(e.selection.getStart(),n.isBlock))&&void 0!==t?t:e.getBody(),i=$o(vt.fromDom(r));return ie(ie({},ld),{width:i+"px"})}return Id(e)?Pt(ld,(function(e,t){return"width"!==t})):ld},fd={border:"1"},hd="preservetable",md=function(e){return e.getParam("table_sizing_mode","auto")},pd=function(e){return e.getParam("table_responsive_width")},gd=function(e){return e.getParam("table_border_widths",ud,"array")},vd=function(e){return e.getParam("table_border_styles",cd,"array")},bd=function(e){return e.getParam("table_default_attributes",fd,"object")},yd=function(e){return e.getParam("table_default_styles",dd(e),"object")},wd=function(e){return e.getParam("table_resize_bars",!0,"boolean")},Sd=function(e){return e.getParam("table_tab_navigation",!0,"boolean")},xd=function(e){return e.getParam("table_cell_advtab",!0,"boolean")},Cd=function(e){return e.getParam("table_row_advtab",!0,"boolean")},Td=function(e){return e.getParam("table_advtab",!0,"boolean")},Dd=function(e){return e.getParam("table_appearance_options",!0,"boolean")},kd=function(e){return e.getParam("table_grid",!0,"boolean")},Ed=function(e){return e.getParam("table_style_by_css",!1,"boolean")},_d=function(e){return e.getParam("table_cell_class_list",[],"array")},Ad=function(e){return e.getParam("table_row_class_list",[],"array")},Ld=function(e){return e.getParam("table_class_list",[],"array")},Od=function(e){return"relative"===md(e)||!0===pd(e)},Rd=function(e){return"fixed"===md(e)||!1===pd(e)},Id=function(e){return"responsive"===md(e)},Pd=function(e){return e.getParam("table_toolbar",sd)},Md=function(e){return e.getParam("table_use_colgroups",!1,"boolean")},Nd=function(e){var t="section",n=e.getParam("table_header_type",t,"string"),r=["section","cells","sectionCells","auto"];return P(r,n)?n:t},Fd=function(e){var t=["preservetable","resizetable"],n=e.getParam("table_column_resizing",hd,"string");return q(t,(function(e){return e===n})).getOr(hd)},Bd=function(e){return"preservetable"===Fd(e)},$d=function(e){return"resizetable"===Fd(e)},zd=function(e){var t=e.getParam("table_clone_elements");return i(t)?A.some(t.split(/[ ,]/)):Array.isArray(t)?A.some(t):A.none()},Ud=function(e){var t=e.getParam("object_resizing",!0);return i(t)?"table"===t:t},Vd=function(e){return e.getParam("table_background_color_map",[],"array")},Hd=function(e){return e.getParam("table_border_color_map",[],"array")},jd=function(e,t){return Od(e)?ps.percentageSize(t):Rd(e)?ps.pixelSize(t):ps.getTableSize(t)},qd=function(e){tr(e,"width")},Gd=function(e){var t=ja(e);wu(e,A.some(t),A.none()),qd(e)},Wd=function(e){var t=Ha(e);wu(e,A.some(t),A.none()),qd(e)},Kd=function(e){vr(e,"width");var t=Or(e),n=t.length>0?t:Lr(e);B(n,(function(e){vr(e,"width"),qd(e)})),qd(e)},Yd=Gd,Xd=Wd,Jd=Kd,Qd=function(e){var t=ui.fromTable(e);ui.hasColumns(t)||B(Lr(e),(function(e){var t=mr(e,"width");fr(e,"width",t),tr(e,"width")}))},Zd=function(){var e=vt.fromTag("div");return hr(e,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),Ei(Rn(),e),e},ef=function(e,t){return e.inline?tu.body(qs(e),Zd(),t):tu.only(vt.fromDom(e.getDoc()),t)},tf=function(e,t){e.inline&&Pi(t.parent())},nf="bar-",rf=function(e){return"false"!==Zn(e,"data-mce-resize")},of=function(e){var t,n,r=A.none(),i=A.none(),o=A.none(),a=function(e){return"TABLE"===e.nodeName},s=function(){return i},l=function(){return o.getOr(tu.only(vt.fromDom(e.getBody()),rf))},u=function(t){return jd(e,t)},c=function(){return Bd(e)?Jl():Xl()},d=function(e){return Tu(e).columns},f=function(r,i,o){var a=Ce(i,"e");if(""===n&&Yd(r),o!==t&&""!==n){fr(r,"width",n);var s=c(),l=u(r),f=Bd(e)||a?d(r)-1:0;Ul(r,o-t,f,s,l)}else if(Zs(n)){var h=parseFloat(n.replace("%","")),m=o*h/t;fr(r,"width",m+"%")}el(n)&&Qd(r)},h=function(){i.each((function(e){e.destroy()})),o.each((function(t){tf(e,t)}))};return e.on("init",(function(){var t=ef(e,rf);if(o=A.some(t),Ud(e)&&wd(e)){var n=c(),a=Xc.create(t,n,u);a.on(),a.events.startDrag.bind((function(t){r=A.some(e.selection.getRng())})),a.events.beforeResize.bind((function(t){var n=t.table.dom;Zc(e,n,Gs(n),Ws(n),nf+t.type)})),a.events.afterResize.bind((function(t){var n=t.table,i=n.dom;Js(n),r.each((function(t){e.selection.setRng(t),e.focus()})),ed(e,i,Gs(i),Ws(i),nf+t.type),e.undoManager.add()})),i=A.some(a)}})),e.on("ObjectResizeStart",(function(r){var i=r.target;if(a(i)){var o=vt.fromDom(i);B(e.dom.select(".mce-clonedresizable"),(function(t){e.dom.addClass(t,"mce-"+Fd(e)+"-columns")})),!xu(o)&&Rd(e)?Xd(o):!Su(o)&&Od(e)&&Yd(o),Cu(o)&&xe(r.origin,nf)&&Yd(o),t=r.width,n=Id(e)?"":Qs(e,i).getOr("")}})),e.on("ObjectResized",(function(t){var n=t.target;if(a(n)){var r=vt.fromDom(n),i=t.origin;xe(i,"corner-")&&f(r,i,t.width),Js(r),rd(e,r.dom,id)}})),e.on("SwitchMode",(function(){s().each((function(t){e.mode.isReadOnly()?t.hideBars():t.showBars()}))})),{lazyResize:s,lazyWire:l,destroy:h}},af=function(e,t){return{element:e,offset:t}},sf=function(e,t,n){return e.property().isText(t)&&0===e.property().getText(t).trim().length||e.property().isComment(t)?n(t).bind((function(t){return sf(e,t,n).orThunk((function(){return A.some(t)}))})):A.none()},lf=function(e,t){if(e.property().isText(t))return e.property().getText(t).length;var n=e.property().children(t);return n.length},uf=function(e,t){var n=sf(e,t,e.query().prevSibling).getOr(t);if(e.property().isText(n))return af(n,lf(e,n));var r=e.property().children(n);return r.length>0?uf(e,r[r.length-1]):af(n,lf(e,n))},cf=uf,df=Vi(),ff=function(e){return cf(df,e)},hf=function(e,t){var n=wr(e,"colspan");if(1===n){var r=Ua(e);r.each((function(n){var r=n.value/2;Va(e,r,n.unit),Va(t,r,n.unit)}))}},mf=dn("th"),pf=function(e){return Y(e,(function(e){return mf(e.element)}))},gf=function(e,t){return e&&t?"sectionCells":e?"section":"cells"},vf=function(e){var t="thead"===e.section,n=rr(bf(e.cells),"th");return t||n?{type:"header",subType:gf(t,n)}:"tfoot"===e.section?{type:"footer"}:{type:"body"}},bf=function(e){var t=U(e,(function(e){return mf(e.element)}));return 0===t.length?A.some("td"):t.length===e.length?A.some("th"):A.none()},yf=function(e){var t=F(e,(function(e){return vf(e).type})),n=P(t,"header"),r=P(t,"footer");if(n||r){var i=P(t,"body");return!n||i||r?n||i||!r?A.none():A.some("footer"):A.some("header")}return A.some("body")},wf=function(e){return re(e.all,(function(e){var t=vf(e);return"header"===t.type?A.from(t.subType):A.none()}))},Sf=function(e,t,n){return Jt(n(e.element,t),!0,e.isLocked)},xf=function(e,t){return e.section!==t?Qt(e.element,e.cells,t,e.isNew):e},Cf=function(){return{transformRow:xf,transformCell:function(e,t,n){var r=n(e.element,t),i="td"!==nn(r)?To(r,"td"):r;return Jt(i,e.isNew,e.isLocked)}}},Tf=function(){return{transformRow:xf,transformCell:Sf}},Df=function(){return{transformRow:function(e,t){var n="thead"===t?"tbody":t;return xf(e,n)},transformCell:Sf}},kf=function(){return{transformRow:b,transformCell:Sf}},Ef=function(e,t){var n=ui.fromTable(e),r=wf(n).getOr(t);switch(r){case"section":return Cf();case"sectionCells":return Tf();case"cells":return Df()}},_f={getTableSectionType:Ef,section:Cf,sectionCells:Tf,cells:Df,fallback:kf},Af=function(e,t,n,r){n===r?tr(e,t):Xn(e,t,n)},Lf=function(e,t,n){ne(Bn(e,t)).fold((function(){return ki(e,n)}),(function(e){return Di(e,n)}))},Of=function(e,t){var n=Gn(e,t).getOrThunk((function(){var n=vt.fromTag(t,fn(e).dom);return"thead"===t?Lf(e,"caption,colgroup",n):"colgroup"===t?Lf(e,"caption",n):Ei(e,n),n}));return Ii(n),n},Rf=function(e,t){var n=[],r=[],i=function(e){return F(e,(function(e){e.isNew&&n.push(e.element);var t=e.element;return Ii(t),B(e.cells,(function(e){e.isNew&&r.push(e.element),Af(e.element,"colspan",e.colspan,1),Af(e.element,"rowspan",e.rowspan,1),Ei(t,e.element)})),t}))},o=function(e){return K(e,(function(e){return F(e.cells,(function(e){return Af(e.element,"span",e.colspan,1),e.element}))}))},a=function(t,n){var r=Of(e,n),a="colgroup"===n?o:i,s=a(t);Ri(r,s)},s=function(t){Gn(e,t).each(Pi)},l=function(e,t){e.length>0?a(e,t):s(t)},u=[],c=[],d=[],f=[];return B(t,(function(e){switch(e.section){case"thead":u.push(e);break;case"tbody":c.push(e);break;case"tfoot":d.push(e);break;case"colgroup":f.push(e);break}})),l(f,"colgroup"),l(u,"thead"),l(c,"tbody"),l(d,"tfoot"),{newRows:n,newCells:r}},If=function(e){return F(e,(function(e){var t=wo(e.element);return B(e.cells,(function(e){var n=So(e.element);Af(n,"colspan",e.colspan,1),Af(n,"rowspan",e.rowspan,1),Ei(t,n)})),t}))},Pf=function(e,t){return F(e,(function(e){return jr(e,t)}))},Mf=function(e,t){return e[t]},Nf=function(e,t){if(0===e.length)return 0;var n=e[0],r=G(e,(function(e){return!t(n.element,e.element)}));return r.getOr(e.length)},Ff=function(e,t,n,r){var i=Mf(e,t),o="colgroup"===i.section,a=Nf(i.cells.slice(n),r),s=o?1:Nf(Pf(e.slice(t),n),r);return{colspan:a,rowspan:s}},Bf=function(e,t){var n=F(e,(function(e){return F(e.cells,C)})),r=function(e,t,r,i){for(var o=e;o<e+r;o++)for(var a=t;a<t+i;a++)n[o][a]=!0};return F(e,(function(i,o){var a=K(i.cells,(function(i,a){if(!1===n[o][a]){var s=Ff(e,o,a,t);return r(o,a,s.rowspan,s.colspan),[Wt(i.element,s.rowspan,s.colspan,i.isNew)]}return[]}));return Xt(i.element,a,i.section,i.isNew)}))},$f=function(e,t,n){var r=[];B(e.colgroups,(function(i){for(var o=[],a=0;a<e.grid.columns;a++){var s=ui.getColumnAt(e,a).map((function(e){return Jt(e.element,n,!1)})).getOrThunk((function(){return Jt(t.colGap(),!0,!1)}));o.push(s)}r.push(Qt(i.element,o,"colgroup",n))}));for(var i=0;i<e.grid.rows;i++){for(var o=[],a=0;a<e.grid.columns;a++){var s=ui.getAt(e,i,a).map((function(e){return Jt(e.element,n,e.isLocked)})).getOrThunk((function(){return Jt(t.gap(),!0,!1)}));o.push(s)}var l=e.all[i],u=Qt(l.element,o,l.section,n);r.push(u)}return r},zf=function(e,t){return $f(e,t,!1)},Uf=function(e){return Bf(e,xt)},Vf=function(e,t){return re(e.all,(function(e){return q(e.cells,(function(e){return xt(t,e.element)}))}))},Hf=function(e,t,n){var r=F(t.selection,(function(t){return Ar(t).bind((function(t){return Vf(e,t)})).filter(n)})),i=ir(r);return lr(i.length>0,i)},jf=function(e,t,n,r,i){return function(o,a,s,l,u){var c=ui.fromTable(a),d=A.from(null===u||void 0===u?void 0:u.section).getOrThunk(_f.fallback),f=t(c,s).map((function(t){var n=zf(c,l),r=e(n,t,xt,i(l),d),o=Jr(r.grid),a=Uf(r.grid);return{info:t,grid:a,cursor:r.cursor,lockedColumns:o}}));return f.bind((function(e){var t=Rf(a,e.grid),i=A.from(null===u||void 0===u?void 0:u.sizing).getOrThunk((function(){return ps.getTableSize(a)})),s=A.from(null===u||void 0===u?void 0:u.resize).getOrThunk(Jl);return n(a,e.grid,e.info,{sizing:i,resize:s,section:d}),r(a),Uc(o,a),tr(a,Yr),e.lockedColumns.length>0&&Xn(a,Yr,e.lockedColumns.join(",")),A.some({cursor:e.cursor,newRows:t.newRows,newCells:t.newCells})}))}},qf=function(e,t){return Ar(t.element).bind((function(n){return Vf(e,n).map((function(e){var n=ie(ie({},e),{generators:t.generators,clipboard:t.clipboard});return n}))}))},Gf=function(e,t){return Hf(e,t,T).map((function(e){return{cells:e,generators:t.generators,clipboard:t.clipboard}}))},Wf=function(e,t){return t.mergable},Kf=function(e,t){return t.unmergable},Yf=function(e,t){return Hf(e,t,T)},Xf=function(e,t){return Hf(e,t,(function(e){return!e.isLocked}))},Jf=function(e,t){return Vf(e,t).exists((function(e){return!e.isLocked}))},Qf=function(e,t){return Y(t,(function(t){return Jf(e,t)}))},Zf=function(e,t){return Wf(e,t).filter((function(t){return Qf(e,t.cells)}))},eh=function(e,t){return Kf(e,t).filter((function(t){return Qf(e,t)}))},th=function(e,t,n,r){var i=Wr(e).rows;if(0===i.length)return e;for(var o=t.startRow;o<=t.finishRow;o++)for(var a=t.startCol;a<=t.finishCol;a++){var s=i[o],l=jr(s,a).isLocked;Ur(s,a,Jt(r(),!1,l))}return e},nh=function(e,t,n,r){for(var i=Wr(e).rows,o=!0,a=0;a<i.length;a++)for(var s=0;s<Gr(i[0]);s++){var l=i[a],u=jr(l,s),c=u.element,d=n(c,t);!0===d&&!1===o?Ur(l,s,Jt(r(),!0,u.isLocked)):!0===d&&(o=!1)}return e},rh=function(e,t){return H(e,(function(e,n){return M(e,(function(e){return t(e.element,n.element)}))?e:e.concat([n])}),[])},ih=function(e,t,n,r){return t>0&&t<e[0].cells.length&&B(e,(function(e){var i=e.cells[t-1],o=e.cells[t],a=n(o.element,i.element);a&&Ur(e,t,Jt(r(),!0,o.isLocked))})),e},oh=function(e,t,n,r){var i=Wr(e).rows;if(t>0&&t<i.length){var o=i[t-1].cells,a=rh(o,n);B(a,(function(e){for(var o=A.none(),a=t;a<i.length;a++)for(var s=function(t){var s=i[a],l=jr(s,t),u=n(l.element,e.element);u&&(o.isNone()&&(o=A.some(r())),o.each((function(e){Ur(s,t,Jt(e,!0,l.isLocked))})))},l=0;l<Gr(i[0]);l++)s(l)}))}return e},ah=function(e){var t=function(t){return ah(e)},n=function(t){return ah(e)},r=function(t){return ah(t(e))},i=function(t){return ah(e)},o=function(t){t(e)},a=function(t){return t(e)},s=function(t,n){return n(e)},l=function(t){return t(e)},u=function(t){return t(e)},c=function(){return A.some(e)};return{isValue:T,isError:C,getOr:v(e),getOrThunk:v(e),getOrDie:v(e),or:t,orThunk:n,fold:s,map:r,mapError:i,each:o,bind:a,exists:l,forall:u,toOptional:c}},sh=function(e){var t=function(e){return e()},n=function(){return x(String(e))()},r=b,i=function(e){return e()},o=function(t){return sh(e)},a=function(t){return sh(t(e))},s=function(t){return sh(e)},l=function(t,n){return t(e)};return{isValue:C,isError:T,getOr:b,getOrThunk:t,getOrDie:n,or:r,orThunk:i,fold:l,map:o,mapError:a,each:m,bind:s,exists:C,forall:T,toOptional:A.none}},lh=function(e,t){return e.fold((function(){return sh(t)}),ah)},uh={value:ah,error:sh,fromOption:lh},ch=function(e,t,n){if(e.row>=t.length||e.column>Gr(t[0]))return uh.error("invalid start address out of table bounds, row: "+e.row+", column: "+e.column);var r=t.slice(e.row),i=r[0].cells.slice(e.column),o=Gr(n[0]),a=n.length;return uh.value({rowDelta:r.length-a,colDelta:i.length-o})},dh=function(e,t){var n=Gr(e[0]),r=Gr(t[0]);return{rowDelta:0,colDelta:n-r}},fh=function(e,t){var n=e.length,r=t.length;return{rowDelta:n-r,colDelta:0}},hh=function(e,t,n,r){var i="colgroup"===t.section?n.col:n.cell;return N(e,(function(e){return Jt(i(),!0,r(e))}))},mh=function(e,t,n,r){var i=e[e.length-1];return e.concat(N(t,(function(){var e="colgroup"===i.section?n.colgroup:n.row,t=Kr(i,e,b),o=hh(t.cells.length,t,n,(function(e){return $t(r,e.toString())}));return Vr(t,o)})))},ph=function(e,t,n,r){return F(e,(function(e){var i=hh(t,e,n,C);return $r(e,r,i)}))},gh=function(e,t,n){return F(e,(function(e){return H(n,(function(n,r){var i=hh(1,e,t,T)[0];return zr(n,r,i)}),e)}))},vh=function(e,t,n){var r=t.colDelta<0?ph:b,i=t.rowDelta<0?mh:b,o=Jr(e),a=Gr(e[0]),s=M(o,(function(e){return e===a-1})),l=r(e,Math.abs(t.colDelta),n,s?a-1:a),u=Jr(l);return i(l,Math.abs(t.rowDelta),n,J(u,T))},bh=function(e,t,n,r){var i=jr(e[t],n),o=w(r,i.element),a=e[t];return e.length>1&&Gr(a)>1&&(n>0&&o(qr(a,n-1))||n<a.cells.length-1&&o(qr(a,n+1))||t>0&&o(qr(e[t-1],n))||t<e.length-1&&o(qr(e[t+1],n)))},yh=function(e,t,n,r,i,o){for(var a=e.row,s=e.column,l=n.length,u=Gr(n[0]),c=a+l,d=s+u+o.length,f=J(o,T),h=a;h<c;h++)for(var m=0,p=s;p<d;p++)if(f[p])m++;else{bh(t,h,p,i)&&nh(t,qr(t[h],p),i,r.cell);var g=p-s-m,v=jr(n[h-a],g),b=v.element,y=r.replace(b);Ur(t[h],p,Jt(y,!0,v.isLocked))}return t},wh=function(e,t,n){var r=Gr(t[0]),i=Wr(t).cols.length+e.row,o=N(r-e.column,(function(t){return t+e.column})),a=q(o,(function(e){return Y(n,(function(t){return t!==e}))})).getOr(r-1);return{row:i,column:a}},Sh=function(e,t,n){return U(n,(function(n){return n>=e.column&&n<=Gr(t[0])+e.column}))},xh=function(e,t,n,r,i){var o=Jr(t),a=wh(e,t,o),s=Wr(n).rows,l=Sh(a,s,o),u=ch(a,t,s);return u.map((function(e){var n=ie(ie({},e),{colDelta:e.colDelta-l.length}),o=vh(t,n,r),u=Jr(o),c=Sh(a,s,u);return yh(a,o,s,r,i,c)}))},Ch=function(e,t,n,r,i){ih(t,e,i,r.cell);var o=fh(n,t),a=vh(n,o,r),s=fh(t,a),l=vh(t,s,r);return F(l,(function(t,n){return $r(t,e,a[n].cells)}))},Th=function(e,t,n,r,i){oh(t,e,i,r.cell);var o=Jr(t),a=dh(t,n),s=ie(ie({},a),{colDelta:a.colDelta-o.length}),l=vh(t,s,r),u=Wr(l),c=u.cols,d=u.rows,f=Jr(l),h=dh(n,t),m=ie(ie({},h),{colDelta:h.colDelta+f.length}),p=gh(n,r,f),g=vh(p,m,r);return c.concat(d.slice(0,e)).concat(g).concat(d.slice(e,d.length))},Dh=function(e,t,n,r){return Kr(e,(function(e){return r(e,n)}),t)},kh=function(e,t,n,r,i){var o=Wr(e),a=o.rows,s=o.cols,l=a.slice(0,t),u=a.slice(t),c=Dh(a[n],(function(e,n){var o=t>0&&t<a.length&&r(qr(a[t-1],n),qr(a[t],n)),s=o?jr(a[t],n):Jt(i(e.element,r),!0,e.isLocked);return s}),r,i);return s.concat(l).concat([c]).concat(u)},Eh=function(e,t,n,r,i,o,a){if("colgroup"!==n&&r)return jr(e,t);var s=jr(e,i);return Jt(a(s.element,o),!0,!1)},_h=function(e,t,n,r,i){return F(e,(function(e){var o=t>0&&t<Gr(e)&&r(qr(e,t-1),qr(e,t)),a=Eh(e,t,e.section,o,n,r,i);return zr(e,t,a)}))},Ah=function(e,t){return K(e,(function(e){var n=e.cells,r=V(t,(function(e,t){return t>=0&&t<e.length?e.slice(0,t).concat(e.slice(t+1)):e}),n);return r.length>0?[Qt(e.element,r,e.section,e.isNew)]:[]}))},Lh=function(e,t,n){var r=Wr(e),i=r.rows,o=r.cols;return o.concat(i.slice(0,t)).concat(i.slice(n+1))},Oh=function(e,t,n,r){return void 0!==qr(e[t],n)&&t>0&&r(qr(e[t-1],n),qr(e[t],n))},Rh=function(e,t,n){return t>0&&n(qr(e,t-1),qr(e,t))},Ih=function(e,t,n,r){return Oh(e,t,n,r)||Rh(e[t],n,r)},Ph=function(e,t){var n=Y(t,b)&&pf(e.cells);return n?T:function(e,n,r){var i=nn(e.element);return!("th"===i&&t[r])}},Mh=function(e,t){var n=Y(t,b)&&pf(e);return n?T:function(e,n,r){var i=nn(e.element);return!("th"===i&&t[n])}},Nh=function(e,t,n,r){var i=function(e){return"row"===e?xr(t):Sr(t)},o=function(e){return i(e)?e+"group":e};if(e)return mf(t)?o(n):null;if(r&&mf(t)){var a="row"===n?"col":"row";return o(a)}return null},Fh=function(e,t){return function(n,r,i){return A.some(Nh(e,n.element,"col",t[i]))}},Bh=function(e,t){return function(n,r){return A.some(Nh(e,n.element,"row",t[r]))}},$h=function(e,t,n){return Jt(n(e.element,t),!0,e.isLocked)},zh=function(e,t,n,r,i,o,a){var s=function(e){return M(t,(function(t){return n(e.element,t.element)}))};return F(e,(function(e,t){return Hr(e,(function(e,l){if(s(e)){var u=a(e,t,l)?i(e,n,r):e;return o(u,t,l).each((function(e){Qn(u.element,{scope:A.from(e)})})),u}return e}))}))},Uh=function(e,t,n){return K(e,(function(r,i){return Ih(e,i,t,n)?[]:[jr(r,t)]}))},Vh=function(e,t,n){var r=e[t];return K(r.cells,(function(r,i){return Ih(e,t,i,n)?[]:[r]}))},Hh=function(e,t,n,r,i){var o=Wr(e).rows,a=K(t,(function(e){return Uh(o,e,r)})),s=F(e,(function(e){return pf(e.cells)})),l=Mh(a,s),u=Bh(n,s);return zh(e,a,r,i,$h,u,l)},jh=function(e,t,n,r,i,o,a){var s=Wr(e),l=s.cols,u=s.rows,c=u[t[0]],d=K(t,(function(e){return Vh(u,e,i)})),f=F(c.cells,(function(e,t){return pf(Uh(u,t,i))})),h=oe([],u,!0);B(t,(function(e){h[e]=a.transformRow(u[e],n)}));var m=l.concat(h),p=Ph(c,f),g=Fh(r,f);return zh(m,d,i,o,a.transformCell,g,p)},qh=function(e,t,n,r){var i=Wr(e).rows,o=F(t,(function(e){return jr(i[e.row],e.column)}));return zh(e,o,n,r,$h,A.none,T)},Gh=function(e){var t=function(e,t){var n=M(e,(function(e){return e.column===t.column}));return n?e:e.concat([t])};return H(e,t,[]).sort((function(e,t){return e.column-t.column}))},Wh=dn("col"),Kh=dn("colgroup"),Yh=function(e){return"tr"===nn(e)||Kh(e)},Xh=function(e){var t=yr(e,"colspan",1),n=yr(e,"rowspan",1);return{element:e,colspan:t,rowspan:n}},Jh=function(e,t){void 0===t&&(t=Xh);var n=function(t){return Wh(t.element)?e.col(t):e.cell(t)},r=function(t){return Kh(t.element)?e.colgroup(t):e.row(t)},i=function(e){if(Yh(e))return r({element:e});var i=n(t(e));return o=A.some({item:e,replacement:i}),i},o=A.none(),a=function(e,t){return o.fold((function(){return i(e)}),(function(n){return t(e,n.item)?n.replacement:i(e)}))};return{getOrInit:a}},Qh=function(e){return function(t){var n=[],r=function(e,t){return q(n,(function(n){return t(n.item,e)}))},i=function(r){var i="td"===e?{scope:null}:{},o=t.replace(r,e,i);return n.push({item:r,sub:o}),o},o=function(e,t){return Yh(e)||Wh(e)?e:r(e,t).fold((function(){return i(e)}),(function(n){return t(e,n.item)?n.sub:i(e)}))};return{replaceOrInit:o}}},Zh=function(e){return er(e,"scope").map((function(e){return e.substr(0,3)}))},em=function(e){var t=function(t){var n=Zh(t);return n.each((function(e){return Xn(t,"scope",e)})),function(){var r=e.cell({element:t,colspan:1,rowspan:1});return vr(r,"width"),vr(t,"width"),n.each((function(e){return Xn(r,"scope",e)})),r}},n=function(e){var t=function(){var t=ir(F(e,Zh));if(0===t.length)return A.none();var n=t[0],r=["row","col"],i=M(t,(function(e){return e!==n&&P(r,e)}));return i?A.none():A.from(n)};return vr(e[0],"width"),t().fold((function(){return tr(e[0],"scope")}),(function(t){return Xn(e[0],"scope",t+"group")})),v(e[0])};return{unmerge:t,merge:n}},tm={modification:Jh,transform:Qh,merging:em},nm=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],rm=function(e,t){var n=e.property().name(t);return P(["ol","ul"],n)},im=function(e,t){var n=e.property().name(t);return P(nm,n)},om=function(e,t){return P(["br","img","hr","input"],e.property().name(t))},am=Vi(),sm=function(e){return im(am,e)},lm=function(e){return rm(am,e)},um=function(e){return om(am,e)},cm=function(e){var t=function(e){return"br"===nn(e)},n=function(e){return Y(e,(function(e){return t(e)||ln(e)&&0===Bi(e).trim().length}))},r=function(e){return"li"===nn(e)||Un(e,lm).isSome()},i=function(e){return yn(e).map((function(e){return!!sm(e)||!!um(e)&&"img"!==nn(e)})).getOr(!1)},o=function(e){return As(e).bind((function(n){var o=i(n);return pn(n).map((function(i){return!0===o||r(i)||t(n)||sm(i)&&!xt(e,i)?[]:[vt.fromTag("br")]}))})).getOr([])},a=function(){var t=K(e,(function(e){var t=wn(e);return n(t)?[]:t.concat(o(e))}));return 0===t.length?[vt.fromTag("br")]:t},s=a();Ii(e[0]),Ri(e[0],s)},dm=function(e){return xc(e,!0)},fm=function(e){var t=Lr(e);0===t.length&&Pi(e)},hm=function(e,t){return{grid:e,cursor:t}},mm=function(e){return re(e,(function(e){return re(e.cells,(function(e){var t=e.element;return lr(dm(t),t)}))}))},pm=function(e,t,n){var r,i,o=Wr(e).rows;return A.from(null===(i=null===(r=o[t])||void 0===r?void 0:r.cells[n])||void 0===i?void 0:i.element).filter(dm).orThunk((function(){return mm(o)}))},gm=function(e,t,n){var r=pm(e,t,n);return hm(e,r)},vm=function(e){var t=function(e,t){var n=M(e,(function(e){return e.row===t.row}));return n?e:e.concat([t])};return H(e,t,[]).sort((function(e,t){return e.row-t.row}))},bm=function(e,t,n,r){var i=t[0].row,o=vm(t),a=V(o,(function(e,t){var o=kh(e.grid,i,t.row+e.delta,n,r.getOrInit);return{grid:o,delta:e.delta+1}}),{grid:e,delta:0}).grid;return gm(a,i,t[0].column)},ym=function(e,t,n,r){var i=vm(t),o=i[i.length-1],a=o.row+o.rowspan,s=V(i,(function(e,t){return kh(e,a,t.row,n,r.getOrInit)}),e);return gm(s,a,t[0].column)},wm=function(e,t,n,r){var i=t.details,o=Gh(i),a=o[0].column,s=V(o,(function(e,t){var i=_h(e.grid,a,t.column+e.delta,n,r.getOrInit);return{grid:i,delta:e.delta+1}}),{grid:e,delta:0}).grid;return gm(s,i[0].row,a)},Sm=function(e,t,n,r){var i=t.details,o=i[i.length-1],a=o.column+o.colspan,s=Gh(i),l=V(s,(function(e,t){return _h(e,a,t.column,n,r.getOrInit)}),e);return gm(l,i[0].row,a)},xm=function(e,t,n,r){var i=Gh(t),o=F(i,(function(e){return e.column})),a=Hh(e,o,!0,n,r.replaceOrInit);return gm(a,t[0].row,t[0].column)},Cm=function(e,t,n,r){var i=qh(e,t,n,r.replaceOrInit);return gm(i,t[0].row,t[0].column)},Tm=function(e,t,n,r){var i=Gh(t),o=F(i,(function(e){return e.column})),a=Hh(e,o,!1,n,r.replaceOrInit);return gm(a,t[0].row,t[0].column)},Dm=function(e,t,n,r){var i=qh(e,t,n,r.replaceOrInit);return gm(i,t[0].row,t[0].column)},km=function(e,t){return function(n,r,i,o,a){var s=vm(r),l=F(s,(function(e){return e.row})),u=jh(n,l,e,t,i,o.replaceOrInit,a);return gm(u,r[0].row,r[0].column)}},Em=km("thead",!0),_m=km("tbody",!1),Am=km("tfoot",!1),Lm=function(e,t,n,r){var i=Gh(t.details),o=Ah(e,F(i,(function(e){return e.column}))),a=o.length>0?o[0].cells.length-1:0;return gm(o,i[0].row,Math.min(i[0].column,a))},Om=function(e,t,n,r){var i=vm(t),o=Lh(e,i[0].row,i[i.length-1].row),a=o.length>0?o.length-1:0;return gm(o,Math.min(t[0].row,a),t[0].column)},Rm=function(e,t,n,r){var i=t.cells;cm(i);var o=th(e,t.bounds,n,r.merge(i));return hm(o,A.from(i[0]))},Im=function(e,t,n,r){var i=function(e,t){return nh(e,t,n,r.unmerge(t))},o=V(t,i,e);return hm(o,A.from(t[0]))},Pm=function(e,t,n,r){var i=function(e,t){var n=ui.fromTable(e);return $f(n,t,!0)},o=i(t.clipboard,t.generators),a=qt(t.row,t.column),s=xh(a,e,o,t.generators,n);return s.fold((function(){return hm(e,A.some(t.element))}),(function(e){return gm(e,t.row,t.column)}))},Mm=function(e,t,n){var r=Br(e,n.section),i=ui.generate(r);return $f(i,t,!0)},Nm=function(e,t,n,r){var i=Wr(e).rows,o=t.cells[0].column,a=i[t.cells[0].row],s=Mm(t.clipboard,t.generators,a),l=Ch(o,e,s,t.generators,n);return gm(l,t.cells[0].row,t.cells[0].column)},Fm=function(e,t,n,r){var i=Wr(e).rows,o=t.cells[t.cells.length-1].column+t.cells[t.cells.length-1].colspan,a=i[t.cells[0].row],s=Mm(t.clipboard,t.generators,a),l=Ch(o,e,s,t.generators,n);return gm(l,t.cells[0].row,t.cells[0].column)},Bm=function(e,t,n,r){var i=Wr(e).rows,o=t.cells[0].row,a=i[o],s=Mm(t.clipboard,t.generators,a),l=Th(o,e,s,t.generators,n);return gm(l,t.cells[0].row,t.cells[0].column)},$m=function(e,t,n,r){var i=Wr(e).rows,o=t.cells[t.cells.length-1].row+t.cells[t.cells.length-1].rowspan,a=i[t.cells[0].row],s=Mm(t.clipboard,t.generators,a),l=Th(o,e,s,t.generators,n);return gm(l,t.cells[0].row,t.cells[0].column)},zm=function(e,t){var n=ui.fromTable(e),r=Yf(n,t);return r.bind((function(e){var t=e[e.length-1],r=e[0].column,i=t.column+t.colspan,o=W(F(n.all,(function(e){return U(e.cells,(function(e){return e.column>=r&&e.column<i}))})));return bf(o)})).getOr("")},Um=function(e,t){var n=ui.fromTable(e),r=Yf(n,t);return r.bind(bf).getOr("")},Vm=function(e,t){var n=ui.fromTable(e),r=Yf(n,t);return r.bind((function(e){var t=e[e.length-1],r=e[0].row,i=t.row+t.rowspan,o=n.all.slice(r,i);return yf(o)})).getOr("")},Hm=function(e,t,n,r){return jl(e,t,n,r.sizing)},jm=function(e,t,n,r){return Hl(e,t,n,r.sizing,r.resize)},qm=function(e,t){return M(t,(function(e){return 0===e.column&&e.isLocked}))},Gm=function(e,t){return M(t,(function(t){return t.column+t.colspan>=e.grid.columns&&t.isLocked}))},Wm=function(e,t){var n=Uo(e),r=Gh(t);return H(r,(function(e,t){var r=n[t.column],i=r.map(Bo).getOr(0);return e+i}),0)},Km=function(e){return function(t,n){return Yf(t,n).filter((function(n){var r=e?qm:Gm;return!r(t,n)})).map((function(e){return{details:e,pixelDelta:Wm(t,e)}}))}},Ym=function(e,t){return Xf(e,t).map((function(t){return{details:t,pixelDelta:-Wm(e,t)}}))},Xm=function(e){return function(t,n){return Gf(t,n).filter((function(n){var r=e?qm:Gm;return!r(t,n.cells)}))}},Jm=tm.transform("th"),Qm=tm.transform("td"),Zm=jf(bm,Yf,m,m,tm.modification),ep=jf(ym,Yf,m,m,tm.modification),tp=jf(wm,Km(!0),jm,m,tm.modification),np=jf(Sm,Km(!1),jm,m,tm.modification),rp=jf(Lm,Ym,jm,fm,tm.modification),ip=jf(Om,Yf,m,fm,tm.modification),op=jf(xm,Xf,m,m,Jm),ap=jf(Tm,Xf,m,m,Qm),sp=jf(Em,Xf,m,m,Jm),lp=jf(_m,Xf,m,m,Qm),up=jf(Am,Xf,m,m,Qm),cp=jf(Cm,Xf,m,m,Jm),dp=jf(Dm,Xf,m,m,Qm),fp=jf(Rm,Zf,Hm,m,tm.merging),hp=jf(Im,eh,Hm,m,tm.merging),mp=jf(Pm,qf,Hm,m,tm.modification),pp=jf(Nm,Xm(!0),m,m,tm.modification),gp=jf(Fm,Xm(!1),m,m,tm.modification),vp=jf(Bm,Gf,m,m,tm.modification),bp=jf($m,Gf,m,m,tm.modification),yp=zm,wp=Um,Sp=Vm,xp=function(e,t,n){var r=function(e){return"table"===nn(qs(e))},i=function(t){return!1===r(e)||Tu(t).rows>1},o=function(t){return!1===r(e)||Tu(t).columns>1},a=zd(e),s=$d(e)?m:hf,l=function(t){switch(Nd(e)){case"section":return _f.section();case"sectionCells":return _f.sectionCells();case"cells":return _f.cells();default:return _f.getTableSectionType(t,"section")}},u=function(n,r){return r.cursor.fold((function(){var r=Lr(n);return te(r).filter(On).map((function(r){t.clear(n);var i=e.dom.createRng();return i.selectNode(r.dom),e.selection.setRng(i),Xn(r,"data-mce-selected","1"),i}))}),(function(r){var i=ff(r),o=e.dom.createRng();return o.setStart(i.element.dom,i.offset),o.setEnd(i.element.dom,i.offset),e.selection.setRng(o),t.clear(n),A.some(o)}))},c=function(t,n,r,i,o){return function(s,c,d){void 0===d&&(d=!1),Js(s);var f=i(),h=vt.fromDom(e.getDoc()),m=zs(r,h,a),p={sizing:jd(e,s),resize:$d(e)?Xl():Jl(),section:l(s)};return n(s)?t(f,s,c,m,p).bind((function(t){B(t.newRows,(function(t){Jc(e,t.dom)})),B(t.newCells,(function(t){Qc(e,t.dom)}));var n=u(s,t);return On(s)&&(Js(s),d||rd(e,s.dom,o)),n.map((function(e){return{rng:e,effect:o}}))})):A.none()}},d=c(ip,i,m,n,od),f=c(rp,o,m,n,od),h=c(Zm,T,m,n,od),p=c(ep,T,m,n,od),g=c(tp,T,s,n,od),v=c(np,T,s,n,od),b=c(fp,T,m,n,od),y=c(hp,T,m,n,od),w=c(pp,T,m,n,od),S=c(gp,T,m,n,od),x=c(vp,T,m,n,od),C=c(bp,T,m,n,od),D=c(mp,T,m,n,ad),k=c(cp,T,m,n,od),E=c(dp,T,m,n,od),_=c(op,T,m,n,od),L=c(ap,T,m,n,od),O=c(sp,T,m,n,od),R=c(lp,T,m,n,od),I=c(up,T,m,n,od),P=wp,M=yp,N=Sp;return{deleteRow:d,deleteColumn:f,insertRowsBefore:h,insertRowsAfter:p,insertColumnsBefore:g,insertColumnsAfter:v,mergeCells:b,unmergeCells:y,pasteColsBefore:w,pasteColsAfter:S,pasteRowsBefore:x,pasteRowsAfter:C,pasteCells:D,makeCellsHeader:k,unmakeCellsHeader:E,makeColumnsHeader:_,unmakeColumnsHeader:L,makeRowsHeader:O,makeRowsBody:R,makeRowsFooter:I,getTableRowType:N,getTableCellType:P,getTableColType:M}},Cp={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},Tp=function(){return vt.fromTag("th")},Dp=function(){return vt.fromTag("td")},kp=function(){return vt.fromTag("col")},Ep=function(e,t,n,r){for(var i=vt.fromTag("tr"),o=0;o<e;o++){var a=r<t||o<n?Tp():Dp();o<n&&Xn(a,"scope","row"),r<t&&Xn(a,"scope","col"),Ei(a,vt.fromTag("br")),Ei(i,a)}return i},_p=function(e){var t=vt.fromTag("colgroup");return N(e,(function(){return Ei(t,kp())})),t},Ap=function(e,t,n,r){return N(e,(function(e){return Ep(t,n,r,e)}))},Lp=function(e,t,n,r,i,o){void 0===o&&(o=Cp);var a=vt.fromTag("table"),s="cells"!==i;hr(a,o.styles),Jn(a,o.attributes),o.colGroups&&Ei(a,_p(t));var l=Math.min(e,n);if(s&&n>0){var u=vt.fromTag("thead");Ei(a,u);var c="sectionCells"===i?l:0,d=Ap(n,t,c,r);Ri(u,d)}var f=vt.fromTag("tbody");Ei(a,f);var h=s?e-l:e,m=s?0:n,p=Ap(h,t,m,r);return Ri(f,p),a},Op=function(e){return e.dom.innerHTML},Rp=function(e){var t=vt.fromTag("div"),n=vt.fromDom(e.dom.cloneNode(!0));return Ei(t,n),Op(t)},Ip=function(e,t){e.selection.select(t.dom,!0),e.selection.collapse(!0)},Pp=function(e,t){Wn(t,"td,th").each(w(Ip,e))},Mp=function(e,t){B($n(t,"tr"),(function(t){Jc(e,t.dom),B($n(t,"th,td"),(function(t){Qc(e,t.dom)}))}))},Np=function(e){return i(e)&&-1!==e.indexOf("%")},Fp=function(e,t,n,r,i){var o=yd(e),a={styles:o,attributes:bd(e),colGroups:Md(e)};return e.undoManager.ignore((function(){var o=Lp(n,t,i,r,Nd(e),a);Xn(o,"data-mce-id","__mce");var s=Rp(o);e.insertContent(s),e.addVisual()})),Wn(qs(e),'table[data-mce-id="__mce"]').map((function(t){return Rd(e)?Xd(t):Id(e)?Jd(t):(Od(e)||Np(o.width))&&Yd(t),Js(t),tr(t,"data-mce-id"),Mp(e,t),Pp(e,t),t.dom})).getOr(null)},Bp=function(e,t,n,r,i){void 0===r&&(r={});var o=function(e){return h(e)&&e>0};if(o(t)&&o(n)){var a=r.headerRows||0,s=r.headerColumns||0;return Fp(e,n,t,s,a)}return console.error(i),null},$p=function(e){return function(){return e().fold((function(){return[]}),(function(e){return F(e,(function(e){return e.dom}))}))}},zp=function(e){return function(t){var n=t.length>0?A.some(Hs(t)):A.none();e(n)}},Up=function(e){return function(t,n,r){void 0===r&&(r={});var i=Bp(e,n,t,r,"Invalid values for insertTable - rows and columns values are required to insert a table.");return e.undoManager.add(),i}},Vp=function(e,t,n,r){return{insertTable:Up(e),setClipboardRows:zp(t.setRows),getClipboardRows:$p(t.getRows),setClipboardCols:zp(t.setColumns),getClipboardCols:$p(t.getColumns),resizeHandler:n,selectionTargets:r}},Hp=function(e,t,n){var r=yr(e,t,1);1===n||r<=1?tr(e,t):Xn(e,t,Math.min(n,r))},jp=function(e,t,n){if(ui.hasColumns(e)){var r=U(ui.justColumns(e),(function(e){return e.column>=t&&e.column<n})),i=F(r,(function(e){var r=So(e.element);return Hp(r,"span",n-t),r})),o=vt.fromTag("colgroup");return Ri(o,i),[o]}return[]},qp=function(e,t,n){return F(e.all,(function(e){var r=U(e.cells,(function(e){return e.column>=t&&e.column<n})),i=F(r,(function(e){var r=So(e.element);return Hp(r,"colspan",n-t),r})),o=vt.fromTag("tr");return Ri(o,i),o}))},Gp=function(e,t){var n=ui.fromTable(e),r=Xf(n,t);return r.map((function(e){var t=e[e.length-1],r=e[0].column,i=t.column+t.colspan,o=jp(n,r,i),a=qp(n,r,i);return oe(oe([],o,!0),a,!0)}))},Wp=function(e,t,n){var r=ui.fromTable(e),i=Yf(r,t);return i.bind((function(e){var t=$f(r,n,!1),i=Wr(t).rows,o=i.slice(e[0].row,e[e.length-1].row+e[e.length-1].rowspan),a=K(o,(function(e){var t=U(e.cells,(function(e){return!e.isLocked}));return t.length>0?[ie(ie({},e),{cells:t})]:[]})),s=Uf(a);return lr(s.length>0,s)})).map((function(e){return If(e)}))},Kp=tinymce.util.Tools.resolve("tinymce.util.Tools"),Yp=function(e,t,n){var r,i=e.select("td,th",t),o=function(t,r){for(var i=0;i<r.length;i++){var o=e.getStyle(r[i],n);if("undefined"===typeof t&&(t=o),t!==o)return""}return t};return o(r,i)},Xp=function(e,t,n){n&&e.formatter.apply("align"+n,{},t)},Jp=function(e,t,n){n&&e.formatter.apply("valign"+n,{},t)},Qp=function(e,t){Kp.each("left center right".split(" "),(function(n){e.formatter.remove("align"+n,{},t)}))},Zp=function(e,t){Kp.each("top middle bottom".split(" "),(function(n){e.formatter.remove("valign"+n,{},t)}))},eg=[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}],tg=function(e){return{value:e}},ng=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,rg=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,ig=function(e){return ng.test(e)||rg.test(e)},og=function(e){return we(e,"#").toUpperCase()},ag=function(e){return ig(e)?A.some({value:og(e)}):A.none()},sg=function(e){var t=e.toString(16);return(1===t.length?"0"+t:t).toUpperCase()},lg=function(e){var t=sg(e.red)+sg(e.green)+sg(e.blue);return tg(t)},ug=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,cg=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,dg=function(e,t,n,r){return{red:e,green:t,blue:n,alpha:r}},fg=function(e,t,n,r){var i=parseInt(e,10),o=parseInt(t,10),a=parseInt(n,10),s=parseFloat(r);return dg(i,o,a,s)},hg=function(e){if("transparent"===e)return A.some(dg(0,0,0,0));var t=ug.exec(e);if(null!==t)return A.some(fg(t[1],t[2],t[3],"1"));var n=cg.exec(e);return null!==n?A.some(fg(n[1],n[2],n[3],n[4])):A.none()},mg=function(e){return ag(e).orThunk((function(){return hg(e).map(lg)})).getOrThunk((function(){var t=document.createElement("canvas");t.height=1,t.width=1;var n=t.getContext("2d");n.clearRect(0,0,t.width,t.height),n.fillStyle="#FFFFFF",n.fillStyle=e,n.fillRect(0,0,1,1);var r=n.getImageData(0,0,1,1).data,i=r[0],o=r[1],a=r[2],s=r[3];return lg(dg(i,o,a,s))}))},pg=function(e){var t=e,n=function(){return t},r=function(e){t=e};return{get:n,set:r}},gg=function(e){var t=pg(A.none()),n=function(){return t.get().each(e)},r=function(){n(),t.set(A.none())},i=function(){return t.get().isSome()},o=function(){return t.get()},a=function(e){n(),t.set(A.some(e))};return{clear:r,isSet:i,get:o,set:a}},vg=function(){return gg((function(e){return e.unbind()}))},bg=function(){var e=gg(m),t=function(t){return e.get().each(t)};return ie(ie({},e),{on:t})},yg=function(e,t,n,r){return function(i){var o=vg(),a=Ee(r),s=function(){var s=Cl(t),l=function(t){return e.formatter.match(n,{value:r},t.dom,a)};a?(i.setActive(!M(s,l)),o.set(e.formatter.formatChanged(n,(function(e){return i.setActive(!e)}),!0))):(i.setActive(Y(s,l)),o.set(e.formatter.formatChanged(n,i.setActive,!1,{value:r})))};return e.initialized?s():e.on("init",s),o.clear}},wg=function(e){return zt(e,"menu")},Sg=function(e){return F(e,(function(e){var t=e.text||e.title;return wg(e)?{text:t,items:Sg(e.menu)}:{text:t,value:e.value}}))},xg=function(e,t,n,r,i){return F(n,(function(n){var o=n.text||n.title;return wg(n)?{type:"nestedmenuitem",text:o,getSubmenuItems:function(){return xg(e,t,n.menu,r,i)}}:{text:o,type:"togglemenuitem",onAction:function(){return i(n.value)},onSetup:yg(e,t,r,n.value)}}))},Cg=function(e,t){return function(n){var r;e.execCommand("mceTableApplyCellStyle",!1,(r={},r[t]=n,r))}},Tg=function(e){return K(e,(function(e){return wg(e)?[ie(ie({},e),{menu:Tg(e.menu)})]:ke(e.value)?[e]:[]}))},Dg=function(e,t,n,r,i){return function(o){return o(xg(e,t,n,r,i))}},kg=function(e,t,n){var r=F(t,(function(e){return{text:e.title,value:"#"+mg(e.value).value,type:"choiceitem"}}));return[{type:"fancymenuitem",fancytype:"colorswatch",initData:{colors:r.length>0?r:void 0,allowCustomColors:!1},onAction:function(t){var r,i="remove"===t.value?"":t.value;e.execCommand("mceTableApplyCellStyle",!1,(r={},r[n]=i,r))}}]},Eg=function(e){return function(){var t=e.queryCommandValue("mceTableRowType"),n="header"===t?"body":"header";e.execCommand("mceTableRowType",!1,{type:n})}},_g=function(e){return function(){var t=e.queryCommandValue("mceTableColType"),n="th"===t?"td":"th";e.execCommand("mceTableColType",!1,{type:n})}},Ag=function(e){var t=Sg(_d(e));return t.length>0?A.some({name:"class",type:"listbox",label:"Class",items:t}):A.none()},Lg=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"listbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"listbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"listbox",label:"Horizontal align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"listbox",label:"Vertical align",items:eg}],Og=function(e){return Lg.concat(Ag(e).toArray())},Rg=function(e,t){var n=[{text:"Select...",value:""}],r=[{name:"borderstyle",type:"listbox",label:"Border style",items:n.concat(Sg(vd(e)))},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}],i={name:"borderwidth",type:"input",label:"Border width"},o="cell"===t?[i].concat(r):r;return{title:"Advanced",name:"advanced",items:o}},Ig=function(e){return function(t,n){var r=t.dom,i=function(t,i){e&&!i||r.setAttrib(n,t,i)},o=function(t,i){e&&!i||r.setStyle(n,t,i)},a=function(r,i){e&&!i||(""===i?t.formatter.remove(r,{value:null},n,!0):t.formatter.apply(r,{value:i},n))};return{setAttrib:i,setStyle:o,setFormat:a}}},Pg={normal:Ig(!1),ifTruthy:Ig(!0)},Mg=function(e){return function(t){return xe(t,"rgb")?e.toHex(t):t}},Ng=function(e,t){var n=vt.fromDom(t);return{borderwidth:gr(n,"border-width").getOr(""),borderstyle:gr(n,"border-style").getOr(""),bordercolor:gr(n,"border-color").map(Mg(e)).getOr(""),backgroundcolor:gr(n,"background-color").map(Mg(e)).getOr("")}},Fg=function(e){var t=e[0],n=e.slice(1);return B(n,(function(e){B(Et(t),(function(n){At(e,(function(e,r){var i=t[n];""!==i&&n===r&&i!==e&&(t[n]="")}))}))})),t},Bg=function(e,t,n,r){return q(e,(function(e){return!u(n.formatter.matchNode(r,t+e))})).getOr("")},$g=w(Bg,["left","center","right"],"align"),zg=w(Bg,["top","middle","bottom"],"valign"),Ug=function(e,t){var n=yd(e),r=bd(e),i=function(e){return{borderstyle:Bt(n,"border-style").getOr(""),bordercolor:Mg(e)(Bt(n,"border-color").getOr("")),backgroundcolor:Mg(e)(Bt(n,"background-color").getOr(""))}},o={height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""},a=function(){var t=n["border-width"];return Ed(e)&&t?{border:t}:Bt(r,"border").fold((function(){return{}}),(function(e){return{border:e}}))},s=t?i(e.dom):{},l=function(){var e=Bt(n,"border-spacing").or(Bt(r,"cellspacing")).fold((function(){return{}}),(function(e){return{cellspacing:e}})),t=Bt(n,"border-padding").or(Bt(r,"cellpadding")).fold((function(){return{}}),(function(e){return{cellpadding:e}}));return ie(ie({},e),t)},u=ie(ie(ie(ie(ie(ie({},o),n),r),s),a()),l());return u},Vg=function(e){return Rr(vt.fromDom(e)).map((function(t){var n={selection:Hs(e.cells)};return Sp(t,n)})).getOr("")},Hg=function(e,t,n){var r=function(t,n){var r=gr(vt.fromDom(n),"border-width");return Ed(e)&&r.isSome()?r.getOr(""):t.getAttrib(n,"border")||Yp(e.dom,n,"border-width")||Yp(e.dom,n,"border")},i=e.dom,o=Ed(e)?i.getStyle(t,"border-spacing")||i.getAttrib(t,"cellspacing"):i.getAttrib(t,"cellspacing")||i.getStyle(t,"border-spacing"),a=Ed(e)?Yp(i,t,"padding")||i.getAttrib(t,"cellpadding"):i.getAttrib(t,"cellpadding")||Yp(i,t,"padding");return ie({width:i.getStyle(t,"width")||i.getAttrib(t,"width"),height:i.getStyle(t,"height")||i.getAttrib(t,"height"),cellspacing:o,cellpadding:a,border:r(i,t),caption:!!i.select("caption",t)[0],class:i.getAttrib(t,"class",""),align:$g(e,t)},n?Ng(i,t):{})},jg=function(e,t,n){var r=e.dom;return ie({height:r.getStyle(t,"height")||r.getAttrib(t,"height"),class:r.getAttrib(t,"class",""),type:Vg(t),align:$g(e,t)},n?Ng(r,t):{})},qg=function(e,t,n,r){var i=e.dom,o=r.getOr(t),a=function(e,t){return i.getStyle(e,t)||i.getAttrib(e,t)};return ie({width:a(o,"width"),height:a(t,"height"),scope:i.getAttrib(t,"scope"),celltype:js(t),class:i.getAttrib(t,"class",""),halign:$g(e,t),valign:zg(e,t)},n?Ng(i,t):{})},Gg=function(e,t){var n=ui.fromTable(e),r=ui.justCells(n),i=U(r,(function(e){return M(t,(function(t){return xt(e.element,t)}))}));return F(i,(function(e){return{element:e.element.dom,column:ui.getColumnAt(n,e.column).map((function(e){return e.element.dom}))}}))},Wg=function(e,t,n){e.setAttrib("scope",n.scope),e.setAttrib("class",n.class),e.setStyle("height",Xs(n.height)),t.setStyle("width",Xs(n.width))},Kg=function(e,t){e.setFormat("tablecellbackgroundcolor",t.backgroundcolor),e.setFormat("tablecellbordercolor",t.bordercolor),e.setFormat("tablecellborderstyle",t.borderstyle),e.setFormat("tablecellborderwidth",Xs(t.borderwidth))},Yg=function(e,t,n){var r=1===t.length;B(t,(function(t){var i=t.element,o=r?Pg.normal(e,i):Pg.ifTruthy(e,i),a=t.column.map((function(t){return r?Pg.normal(e,t):Pg.ifTruthy(e,t)})).getOr(o);Wg(o,a,n),xd(e)&&Kg(o,n),r&&(Qp(e,i),Zp(e,i)),n.halign&&Xp(e,i,n.halign),n.valign&&Jp(e,i,n.valign)}))},Xg=function(e,t){e.execCommand("mceTableCellType",!1,{type:t.celltype,no_events:!0})},Jg=function(e,t,n,r){var i=Pt(r,(function(e,t){return n[t]!==e}));Ft(i)>0&&t.length>=1&&Rr(t[0]).each((function(n){var o=Gg(n,t),a=Ft(Pt(i,(function(e,t){return"scope"!==t&&"celltype"!==t})))>0,s=$t(i,"celltype");(a||$t(i,"scope"))&&Yg(e,o,r),s&&Xg(e,r),rd(e,n.dom,{structure:s,style:a})}))},Qg=function(e,t,n,r){var i=r.getData();r.close(),e.undoManager.transact((function(){Jg(e,t,n,i),e.focus()}))},Zg=function(e,t){var n=Rr(t[0]).map((function(n){return F(Gg(n,t),(function(t){return qg(e,t.element,xd(e),t.column)}))}));return Fg(n.getOrDie())},ev=function(e,t){var n=Cl(t);if(0!==n.length){var r=Zg(e,n),i={type:"tabpanel",tabs:[{title:"General",name:"general",items:Og(e)},Rg(e,"cell")]},o={type:"panel",items:[{type:"grid",columns:2,items:Og(e)}]};e.windowManager.open({title:"Cell Properties",size:"normal",body:xd(e)?i:o,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:r,onSubmit:w(Qg,e,n,r)})}},tv=function(e){var t=Sg(Ad(e));return t.length>0?A.some({name:"class",type:"listbox",label:"Class",items:t}):A.none()},nv=[{type:"listbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"}]},{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],rv=function(e){return nv.concat(tv(e).toArray())},iv=function(e,t){e.setAttrib("class",t.class),e.setStyle("height",Xs(t.height))},ov=function(e,t){e.setStyle("background-color",t.backgroundcolor),e.setStyle("border-color",t.bordercolor),e.setStyle("border-style",t.borderstyle)},av=function(e,t,n,r){var i=1===t.length;B(t,(function(t){var o=i?Pg.normal(e,t):Pg.ifTruthy(e,t);iv(o,n),Cd(e)&&ov(o,n),n.align!==r.align&&(Qp(e,t),Xp(e,t,n.align))}))},sv=function(e,t){e.execCommand("mceTableRowType",!1,{type:t.type,no_events:!0})},lv=function(e,t,n,r){var i=Pt(r,(function(e,t){return n[t]!==e}));if(Ft(i)>0){var o=$t(i,"type"),a=!o||Ft(i)>1;a&&av(e,t,r,n),o&&sv(e,r),Rr(vt.fromDom(t[0])).each((function(t){return rd(e,t.dom,{structure:o,style:a})}))}},uv=function(e,t,n,r){var i=r.getData();r.close(),e.undoManager.transact((function(){lv(e,t,n,i),e.focus()}))},cv=function(e){var t=Tl(tl(e),ml.selected);if(0!==t.length){var n=F(t,(function(t){return jg(e,t.dom,Cd(e))})),r=Fg(n),i={type:"tabpanel",tabs:[{title:"General",name:"general",items:rv(e)},Rg(e,"row")]},o={type:"panel",items:[{type:"grid",columns:2,items:rv(e)}]};e.windowManager.open({title:"Row Properties",size:"normal",body:Cd(e)?i:o,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:r,onSubmit:w(uv,e,F(t,(function(e){return e.dom})),r)})}},dv=function(e,t,n){var r=n?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],i=[{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}],o=Dd(e)?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],a=[{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}],s=t.length>0?[{type:"listbox",name:"class",label:"Class",items:t}]:[];return r.concat(i).concat(o).concat(a).concat(s)},fv=function(e,t,n,r){if("TD"===t.tagName||"TH"===t.tagName)i(n)?e.setStyle(t,n,r):e.setStyle(t,n);else if(t.children)for(var o=0;o<t.children.length;o++)fv(e,t.children[o],n,r)},hv=function(e,t,n){var r=e.dom,i={},o={};if(i.class=n.class,o.height=Xs(n.height),r.getAttrib(t,"width")&&!Ed(e)?i.width=Ys(n.width):o.width=Xs(n.width),Ed(e)?(o["border-width"]=Xs(n.border),o["border-spacing"]=Xs(n.cellspacing)):(i.border=n.border,i.cellpadding=n.cellpadding,i.cellspacing=n.cellspacing),Ed(e)&&t.children)for(var a=0;a<t.children.length;a++)fv(r,t.children[a],{"border-width":Xs(n.border),padding:Xs(n.cellpadding)}),Td(e)&&fv(r,t.children[a],{"border-color":n.bordercolor});Td(e)&&(o["background-color"]=n.backgroundcolor,o["border-color"]=n.bordercolor,o["border-style"]=n.borderstyle),i.style=r.serializeStyle(ie(ie({},yd(e)),o)),r.setAttribs(t,ie(ie({},bd(e)),i))},mv=function(e,t,n,r){var i=e.dom,o=r.getData(),a=Pt(o,(function(e,t){return n[t]!==e}));r.close(),""===o.class&&delete o.class,e.undoManager.transact((function(){if(!t){var n=parseInt(o.cols,10)||1,r=parseInt(o.rows,10)||1;t=Fp(e,n,r,0,0)}if(Ft(a)>0){hv(e,t,o);var s=i.select("caption",t)[0];(s&&!o.caption||!s&&o.caption)&&e.execCommand("mceTableToggleCaption"),""===o.align?Qp(e,t):Xp(e,t,o.align)}if(e.focus(),e.addVisual(),Ft(a)>0){var l=$t(a,"caption"),u=!l||Ft(a)>1;rd(e,t,{structure:l,style:u})}}))},pv=function(e,t){var n,r=e.dom,i=Ug(e,Td(e));!1===t?(n=r.getParent(e.selection.getStart(),"table",e.getBody()),n?i=Hg(e,n,Td(e)):Td(e)&&(i.borderstyle="",i.bordercolor="",i.backgroundcolor="")):(i.cols="1",i.rows="1",Td(e)&&(i.borderstyle="",i.bordercolor="",i.backgroundcolor=""));var o=Sg(Ld(e));o.length>0&&i.class&&(i.class=i.class.replace(/\s*mce\-item\-table\s*/g,""));var a={type:"grid",columns:2,items:dv(e,o,t)},s=function(){return{type:"panel",items:[a]}},l=function(){return{type:"tabpanel",tabs:[{title:"General",name:"general",items:[a]},Rg(e,"table")]}},u=Td(e)?l():s();e.windowManager.open({title:"Table Properties",size:"normal",body:u,onSubmit:w(mv,e,n,i),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:i})},gv=function(e){return Sl(tl(e),Ks(e))},vv=function(e){return xl(tl(e),Ks(e))},bv=function(e,t,n,r,a){var s=Ks(e),l=function(){return gv(e).each((function(t){Rr(t,s).filter(S(s)).each((function(t){var n=vt.fromText("");if(Di(t,n),Pi(t),e.dom.isEmpty(e.getBody()))e.setContent(""),e.selection.setCursorLocation();else{var r=e.dom.createRng();r.setStart(n.dom,0),r.setEnd(n.dom,0),e.selection.setRng(r),e.nodeChanged()}}))}))},u=function(t){return gv(e).each((function(n){var r=Id(e)||Rd(e)||Od(e);r||Rr(n,s).each((function(n){"relative"!==t||Su(n)?"fixed"!==t||xu(n)?"responsive"!==t||Cu(n)||Jd(n):Xd(n):Yd(n),Js(n),rd(e,n.dom,od)}))}))},c=function(e){return Rr(e,s)},d=function(t){return vv(e).bind((function(e){return c(e).map((function(n){return t(n,e)}))}))},f=function(t,n){d((function(t){e.formatter.toggle("tableclass",{value:n},t.dom),rd(e,t.dom,id)}))},h=function(t,n){d((function(t){var i=Cl(r),o=Y(i,(function(t){return e.formatter.match("tablecellclass",{value:n},t.dom)})),a=o?e.formatter.remove:e.formatter.apply;B(i,(function(e){return a("tablecellclass",{value:n},e.dom)})),rd(e,t.dom,id)}))},p=function(){gv(e).each((function(t){Rr(t,s).each((function(n){Gn(n,"caption").fold((function(){var t=vt.fromTag("caption");Ei(t,vt.fromText("Caption")),_i(n,t,0),e.selection.setCursorLocation(t.dom,0)}),(function(r){dn("caption")(t)&&St("td",n).each((function(t){return e.selection.setCursorLocation(t.dom,0)})),Pi(r)})),rd(e,n.dom,od)}))}))},g=function(t){e.focus()},v=function(e,t){return void 0===t&&(t=!1),d((function(n,i){var o=gl(r,n,i);e(n,o,t).each(g)}))},b=function(){return d((function(t,n){var i=gl(r,t,n),o=zs(m,vt.fromDom(e.getDoc()),A.none());return Wp(t,i,o)}))},y=function(){return d((function(e,t){var n=gl(r,e,t);return Gp(e,n)}))},x=function(t,n){return n().each((function(n){var i=F(n,(function(e){return So(e)}));d((function(n,o){var a=Us(vt.fromDom(e.getDoc())),s=bl(r,o,i,a);t(n,s).each(g)}))}))},C=function(e){return function(t,n){return Bt(n,"type").each((function(t){v(e(t),n.no_events)}))}};At({mceTableSplitCells:function(){return v(t.unmergeCells)},mceTableMergeCells:function(){return v(t.mergeCells)},mceTableInsertRowBefore:function(){return v(t.insertRowsBefore)},mceTableInsertRowAfter:function(){return v(t.insertRowsAfter)},mceTableInsertColBefore:function(){return v(t.insertColumnsBefore)},mceTableInsertColAfter:function(){return v(t.insertColumnsAfter)},mceTableDeleteCol:function(){return v(t.deleteColumn)},mceTableDeleteRow:function(){return v(t.deleteRow)},mceTableCutCol:function(){return y().each((function(e){a.setColumns(e),v(t.deleteColumn)}))},mceTableCutRow:function(){return b().each((function(e){a.setRows(e),v(t.deleteRow)}))},mceTableCopyCol:function(){return y().each((function(e){return a.setColumns(e)}))},mceTableCopyRow:function(){return b().each((function(e){return a.setRows(e)}))},mceTablePasteColBefore:function(){return x(t.pasteColsBefore,a.getColumns)},mceTablePasteColAfter:function(){return x(t.pasteColsAfter,a.getColumns)},mceTablePasteRowBefore:function(){return x(t.pasteRowsBefore,a.getRows)},mceTablePasteRowAfter:function(){return x(t.pasteRowsAfter,a.getRows)},mceTableDelete:l,mceTableCellToggleClass:h,mceTableToggleClass:f,mceTableToggleCaption:p,mceTableSizingMode:function(e,t){return u(t)},mceTableCellType:C((function(e){return"th"===e?t.makeCellsHeader:t.unmakeCellsHeader})),mceTableColType:C((function(e){return"th"===e?t.makeColumnsHeader:t.unmakeColumnsHeader})),mceTableRowType:C((function(e){switch(e){case"header":return t.makeRowsHeader;case"footer":return t.makeRowsFooter;default:return t.makeRowsBody}}))},(function(t,n){return e.addCommand(n,t)})),At({mceTableProps:w(pv,e,!1),mceTableRowProps:w(cv,e),mceTableCellProps:w(ev,e,r)},(function(t,n){return e.addCommand(n,(function(){return t()}))})),e.addCommand("mceInsertTable",(function(t,n){o(n)&&Et(n).length>0?Bp(e,n.rows,n.columns,n.options,"Invalid values for mceInsertTable - rows and columns values are required to insert a table."):pv(e,!0)})),e.addCommand("mceTableApplyCellStyle",(function(t,n){var a=function(e){return"tablecell"+e.toLowerCase().replace("-","")};if(o(n)){var s=Cl(r);if(0!==s.length){var l=Pt(n,(function(t,n){return e.formatter.has(a(n))&&i(t)}));Ut(l)||(At(l,(function(t,n){B(s,(function(r){Pg.normal(e,r.dom).setFormat(a(n),t)}))})),c(s[0]).each((function(t){return rd(e,t.dom,id)})))}}}))},yv=function(e,t,n){var r=Ks(e),i=function(t){return xl(tl(e)).bind((function(e){return Rr(e,r).map((function(r){var i=gl(n,r,e);return t(r,i)}))})).getOr("")};At({mceTableRowType:function(){return i(t.getTableRowType)},mceTableCellType:function(){return i(t.getTableCellType)},mceTableColType:function(){return i(t.getTableColType)}},(function(t,n){return e.addQueryValueHandler(n,t)}))},wv=function(){var e=bg(),t=bg();return{getRows:e.get,setRows:function(n){n.fold(e.clear,e.set),t.clear()},clearRows:e.clear,getColumns:t.get,setColumns:function(n){n.fold(t.clear,t.set),e.clear()},clearColumns:t.clear}},Sv={remove_similar:!0,inherit:!1},xv=ie({selector:"td,th"},Sv),Cv={tablecellbackgroundcolor:ie({styles:{backgroundColor:"%value"}},xv),tablecellverticalalign:ie({styles:{"vertical-align":"%value"}},xv),tablecellbordercolor:ie({styles:{borderColor:"%value"}},xv),tablecellclass:ie({classes:["%value"]},xv),tableclass:ie({selector:"table",classes:["%value"]},Sv),tablecellborderstyle:ie({styles:{borderStyle:"%value"}},xv),tablecellborderwidth:ie({styles:{borderWidth:"%value"}},xv)},Tv=function(e){e.formatter.register(Cv)},Dv=co.generate([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),kv=function(e){return void 0===e&&(e=void 0),Dv.none(e)},Ev=ie(ie({},Dv),{none:kv}),_v=function(e,t,n,r,i){void 0===i&&(i=T);var o=1===r;if(!o&&n<=0)return Ev.first(e[0]);if(o&&n>=e.length-1)return Ev.last(e[e.length-1]);var a=n+r,s=e[a];return i(s)?Ev.middle(t,s):_v(e,t,a,r,i)},Av=function(e,t){return Rr(e,t).bind((function(t){var n=Lr(t),r=G(n,(function(t){return xt(e,t)}));return r.map((function(e){return{index:e,all:n}}))}))},Lv=function(e,t,n){var r=Av(e,n);return r.fold((function(){return Ev.none(e)}),(function(n){return _v(n.all,e,n.index,1,t)}))},Ov=function(e,t,n){var r=Av(e,n);return r.fold((function(){return Ev.none()}),(function(n){return _v(n.all,e,n.index,-1,t)}))},Rv=function(e,t,n,r){return{start:e,soffset:t,finish:n,foffset:r}},Iv={create:Rv},Pv=co.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Mv=function(e,t,n,r){return e.fold(t,n,r)},Nv=function(e){return e.fold(b,b,b)},Fv=Pv.before,Bv=Pv.on,$v=Pv.after,zv={before:Fv,on:Bv,after:$v,cata:Mv,getStart:Nv},Uv=co.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Vv=function(e){return Uv.exact(e.start,e.soffset,e.finish,e.foffset)},Hv=function(e){return e.match({domRange:function(e){return vt.fromDom(e.startContainer)},relative:function(e,t){return zv.getStart(e)},exact:function(e,t,n,r){return e}})},jv=Uv.domRange,qv=Uv.relative,Gv=Uv.exact,Wv=function(e){var t=Hv(e);return mn(t)},Kv=Iv.create,Yv={domRange:jv,relative:qv,exact:Gv,exactFromRange:Vv,getWin:Wv,range:Kv},Xv=function(e,t){var n=e.document.createRange();return n.selectNode(t.dom),n},Jv=function(e,t){var n=e.document.createRange();return Qv(n,t),n},Qv=function(e,t){return e.selectNodeContents(t.dom)},Zv=function(e,t){t.fold((function(t){e.setStartBefore(t.dom)}),(function(t,n){e.setStart(t.dom,n)}),(function(t){e.setStartAfter(t.dom)}))},eb=function(e,t){t.fold((function(t){e.setEndBefore(t.dom)}),(function(t,n){e.setEnd(t.dom,n)}),(function(t){e.setEndAfter(t.dom)}))},tb=function(e,t,n){var r=e.document.createRange();return Zv(r,t),eb(r,n),r},nb=function(e,t,n,r,i){var o=e.document.createRange();return o.setStart(t.dom,n),o.setEnd(r.dom,i),o},rb=function(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}},ib=function(e){var t=e.getClientRects(),n=t.length>0?t[0]:e.getBoundingClientRect();return n.width>0||n.height>0?A.some(n).map(rb):A.none()},ob=co.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),ab=function(e,t,n){return t(vt.fromDom(n.startContainer),n.startOffset,vt.fromDom(n.endContainer),n.endOffset)},sb=function(e,t){return t.match({domRange:function(e){return{ltr:v(e),rtl:A.none}},relative:function(t,n){return{ltr:ae((function(){return tb(e,t,n)})),rtl:ae((function(){return A.some(tb(e,n,t))}))}},exact:function(t,n,r,i){return{ltr:ae((function(){return nb(e,t,n,r,i)})),rtl:ae((function(){return A.some(nb(e,r,i,t,n))}))}}})},lb=function(e,t){var n=t.ltr();if(n.collapsed){var r=t.rtl().filter((function(e){return!1===e.collapsed}));return r.map((function(e){return ob.rtl(vt.fromDom(e.endContainer),e.endOffset,vt.fromDom(e.startContainer),e.startOffset)})).getOrThunk((function(){return ab(e,ob.ltr,n)}))}return ab(e,ob.ltr,n)},ub=function(e,t){var n=sb(e,t);return lb(e,n)},cb=function(e,t){var n=ub(e,t);return n.match({ltr:function(t,n,r,i){var o=e.document.createRange();return o.setStart(t.dom,n),o.setEnd(r.dom,i),o},rtl:function(t,n,r,i){var o=e.document.createRange();return o.setStart(r.dom,i),o.setEnd(t.dom,n),o}})};ob.ltr,ob.rtl;var db=function(e,t,n,r,i){if(0===i)return 0;if(t===r)return i-1;for(var o=r,a=1;a<i;a++){var s=e(a),l=Math.abs(t-s.left);if(n<=s.bottom){if(n<s.top||l>o)return a-1;o=l}}return 0},fb=function(e,t,n){return t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom},hb=function(e,t,n,r,i){var o=function(n){var r=e.dom.createRange();return r.setStart(t.dom,n),r.collapse(!0),r},a=function(e){var t=o(e);return t.getBoundingClientRect()},s=Bi(t).length,l=db(a,n,r,i.right,s);return o(l)},mb=function(e,t,n,r){var i=e.dom.createRange();i.selectNode(t.dom);var o=i.getClientRects(),a=re(o,(function(e){return fb(e,n,r)?A.some(e):A.none()}));return a.map((function(i){return hb(e,t,n,r,i)}))},pb=function(e,t,n,r){var i=e.dom.createRange(),o=wn(t);return re(o,(function(t){return i.selectNode(t.dom),fb(i.getBoundingClientRect(),n,r)?gb(e,t,n,r):A.none()}))},gb=function(e,t,n,r){return ln(t)?mb(e,t,n,r):pb(e,t,n,r)},vb=function(e,t,n,r){var i=e.dom.createRange();i.selectNode(t.dom);var o=i.getBoundingClientRect(),a=Math.max(o.left,Math.min(o.right,n)),s=Math.max(o.top,Math.min(o.bottom,r));return gb(e,t,a,s)},bb=!0,yb=!1,wb=function(e,t){return t-e.left<e.right-t?bb:yb},Sb=function(e,t,n){var r=e.dom.createRange();return r.selectNode(t.dom),r.collapse(n),r},xb=function(e,t,n){var r=e.dom.createRange();r.selectNode(t.dom);var i=r.getBoundingClientRect(),o=wb(i,n),a=o===bb?_s:As;return a(t).map((function(t){return Sb(e,t,o)}))},Cb=function(e,t,n){var r=t.dom.getBoundingClientRect(),i=wb(r,n);return A.some(Sb(e,t,i))},Tb=function(e,t,n){var r=0===wn(t).length?Cb:xb;return r(e,t,n)},Db=function(e,t,n){var r,i;return A.from(null===(i=(r=e.dom).caretPositionFromPoint)||void 0===i?void 0:i.call(r,t,n)).bind((function(t){if(null===t.offsetNode)return A.none();var n=e.dom.createRange();return n.setStart(t.offsetNode,t.offset),n.collapse(),A.some(n)}))},kb=function(e,t,n){var r,i;return A.from(null===(i=(r=e.dom).caretRangeFromPoint)||void 0===i?void 0:i.call(r,t,n))},Eb=function(e,t,n,r){var i=e.dom.createRange();i.selectNode(t.dom);var o=i.getBoundingClientRect(),a=Math.max(o.left,Math.min(o.right,n)),s=Math.max(o.top,Math.min(o.bottom,r));return vb(e,t,a,s)},_b=function(e,t,n){return vt.fromPoint(e,t,n).bind((function(r){var i=function(){return Tb(e,r,t)};return 0===wn(r).length?i():Eb(e,r,t,n).orThunk(i)}))},Ab=function(){return document.caretPositionFromPoint?Db:document.caretRangeFromPoint?kb:_b}(),Lb=function(e,t,n){var r=vt.fromDom(e.document);return Ab(r,t,n).map((function(e){return Iv.create(vt.fromDom(e.startContainer),e.startOffset,vt.fromDom(e.endContainer),e.endOffset)}))},Ob=function(e,t){var n=nn(e);return"input"===n?zv.after(e):P(["br","img"],n)?0===t?zv.before(e):zv.after(e):zv.on(e,t)},Rb=function(e,t){var n=e.fold(zv.before,Ob,zv.after),r=t.fold(zv.before,Ob,zv.after);return Yv.relative(n,r)},Ib=function(e,t,n,r){var i=Ob(e,t),o=Ob(n,r);return Yv.relative(i,o)},Pb=function(e){return e.match({domRange:function(e){var t=vt.fromDom(e.startContainer),n=vt.fromDom(e.endContainer);return Ib(t,e.startOffset,n,e.endOffset)},relative:Rb,exact:Ib})},Mb=function(e,t,n,r){var i=fn(e),o=i.dom.createRange();return o.setStart(e.dom,t),o.setEnd(n.dom,r),o},Nb=function(e,t,n,r){var i=Mb(e,t,n,r),o=xt(e,n)&&t===r;return i.collapsed&&!o},Fb=function(e){return A.from(e.getSelection())},Bb=function(e,t){Fb(e).each((function(e){e.removeAllRanges(),e.addRange(t)}))},$b=function(e,t,n,r,i){var o=nb(e,t,n,r,i);Bb(e,o)},zb=function(e,t,n,r,i,o){t.collapse(n.dom,r),t.extend(i.dom,o)},Ub=function(e,t){return ub(e,t).match({ltr:function(t,n,r,i){$b(e,t,n,r,i)},rtl:function(t,n,r,i){Fb(e).each((function(o){if(o.setBaseAndExtent)o.setBaseAndExtent(t.dom,n,r.dom,i);else if(o.extend)try{zb(e,o,t,n,r,i)}catch(a){$b(e,r,i,t,n)}else $b(e,r,i,t,n)}))}})},Vb=function(e,t,n,r,i){var o=Ib(t,n,r,i);Ub(e,o)},Hb=function(e,t,n){var r=Rb(t,n);Ub(e,r)},jb=function(e){var t=Yv.getWin(e).dom,n=function(e,n,r,i){return nb(t,e,n,r,i)},r=Pb(e);return ub(t,r).match({ltr:n,rtl:n})},qb=function(e){if(e.rangeCount>0){var t=e.getRangeAt(0),n=e.getRangeAt(e.rangeCount-1);return A.some(Iv.create(vt.fromDom(t.startContainer),t.startOffset,vt.fromDom(n.endContainer),n.endOffset))}return A.none()},Gb=function(e){if(null===e.anchorNode||null===e.focusNode)return qb(e);var t=vt.fromDom(e.anchorNode),n=vt.fromDom(e.focusNode);return Nb(t,e.anchorOffset,n,e.focusOffset)?A.some(Iv.create(t,e.anchorOffset,n,e.focusOffset)):qb(e)},Wb=function(e,t,n){void 0===n&&(n=!0);var r=n?Jv:Xv,i=r(e,t);Bb(e,i)},Kb=function(e){return Fb(e).filter((function(e){return e.rangeCount>0})).bind(Gb)},Yb=function(e){return Kb(e).map((function(e){return Yv.exact(e.start,e.soffset,e.finish,e.foffset)}))},Xb=function(e,t){var n=cb(e,t);return ib(n)},Jb=function(e,t,n){return Lb(e,t,n)},Qb=function(e){Fb(e).each((function(e){return e.removeAllRanges()}))},Zb=tinymce.util.Tools.resolve("tinymce.util.VK"),ey=function(e,t,n){return ry(e,t,Lv(n,xc))},ty=function(e,t,n){return ry(e,t,Ov(n,xc))},ny=function(e,t){var n=Yv.exact(t,0,t,0);return jb(n)},ry=function(e,t,n){return n.fold(A.none,A.none,(function(t,n){return _s(n).map((function(t){return ny(e,t)}))}),(function(n){return e.execCommand("mceTableInsertRowAfter"),ey(e,t,n)}))},iy=["table","li","dl"],oy=function(e,t,n){if(e.keyCode===Zb.TAB){var r=qs(t),i=function(e){var t=nn(e);return xt(e,r)||P(iy,t)},o=t.selection.getRng(),a=vt.fromDom(e.shiftKey?o.startContainer:o.endContainer);Ar(a,i).each((function(r){e.preventDefault(),Rr(r,i).each(n.clear),t.selection.collapse(e.shiftKey);var o=e.shiftKey?ty:ey,a=o(t,i,r);a.each((function(e){t.selection.setRng(e)}))}))}},ay=function(e,t){return{selection:e,kill:t}},sy={create:ay},ly=function(e,t,n,r){return{start:zv.on(e,t),finish:zv.on(n,r)}},uy={create:ly},cy=function(e,t){var n=cb(e,t);return Iv.create(vt.fromDom(n.startContainer),n.startOffset,vt.fromDom(n.endContainer),n.endOffset)},dy=uy.create,fy=function(e,t,n,r,i,o,a){return xt(n,i)&&r===o?A.none():Kn(n,"td,th",t).bind((function(n){return Kn(i,"td,th",t).bind((function(r){return hy(e,t,n,r,a)}))}))},hy=function(e,t,n,r,i){return xt(n,r)?A.none():to(n,r,t).bind((function(t){var r=t.boxes.getOr([]);return r.length>1?(i(e,r,t.start,t.finish),A.some(sy.create(A.some(dy(n,0,n,Ts(n))),!0))):A.none()}))},my=function(e,t,n,r,i){var o=function(e){return i.clearBeforeUpdate(n),i.selectRange(n,e.boxes,e.start,e.finish),e.boxes};return ao(r,e,t,i.firstSelectedSelector,i.lastSelectedSelector).map(o)},py=function(e,t){return{item:e,mode:t}},gy=function(e,t,n,r){return void 0===r&&(r=vy),e.property().parent(t).map((function(e){return py(e,r)}))},vy=function(e,t,n,r){return void 0===r&&(r=by),n.sibling(e,t).map((function(e){return py(e,r)}))},by=function(e,t,n,r){void 0===r&&(r=by);var i=e.property().children(t),o=n.first(i);return o.map((function(e){return py(e,r)}))},yy=[{current:gy,next:vy,fallback:A.none()},{current:vy,next:by,fallback:A.some(gy)},{current:by,next:by,fallback:A.some(vy)}],wy=function(e,t,n,r,i){void 0===i&&(i=yy);var o=q(i,(function(e){return e.current===n}));return o.bind((function(n){return n.current(e,t,r,n.next).orThunk((function(){return n.fallback.bind((function(n){return wy(e,t,n,r)}))}))}))},Sy=function(){var e=function(e,t){return e.query().prevSibling(t)},t=function(e){return e.length>0?A.some(e[e.length-1]):A.none()};return{sibling:e,first:t}},xy=function(){var e=function(e,t){return e.query().nextSibling(t)},t=function(e){return e.length>0?A.some(e[0]):A.none()};return{sibling:e,first:t}},Cy={left:Sy,right:xy},Ty=function(e,t,n,r,i,o){var a=wy(e,t,r,i);return a.bind((function(t){return o(t.item)?A.none():n(t.item)?A.some(t.item):Ty(e,t.item,n,t.mode,i,o)}))},Dy=function(e,t,n,r){return Ty(e,t,n,vy,Cy.left(),r)},ky=function(e,t,n,r){return Ty(e,t,n,vy,Cy.right(),r)},Ey=function(e){return function(t){return 0===e.property().children(t).length}},_y=function(e,t,n){return Ly(e,t,Ey(e),n)},Ay=function(e,t,n){return Oy(e,t,Ey(e),n)},Ly=Dy,Oy=ky,Ry=Vi(),Iy=function(e,t){return _y(Ry,e,t)},Py=function(e,t){return Ay(Ry,e,t)},My=function(e,t,n){return Ly(Ry,e,t,n)},Ny=function(e,t,n){return Oy(Ry,e,t,n)},Fy=function(e,t,n){return Un(e,t,n).isSome()},By=co.generate([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),$y=function(e,t,n){var r=e.getRect(t),i=e.getRect(n);return i.right>r.left&&i.left<r.right},zy=function(e){return Kn(e,"tr")},Uy=function(e,t,n,r,i,o,a){return Kn(r,"td,th",a).bind((function(n){return Kn(t,"td,th",a).map((function(t){return xt(n,t)?xt(r,n)&&Ts(n)===i?o(t):By.none("in same cell"):Qi(zy,[n,t]).fold((function(){return $y(e,t,n)?By.success():o(t)}),(function(e){return o(t)}))}))})).getOr(By.none("default"))},Vy=function(e,t,n,r,i){return e.fold(t,n,r,i)},Hy=ie(ie({},By),{verify:Uy,cata:Vy}),jy=function(e,t,n,r){return{parent:e,children:t,element:n,index:r}},qy=function(e){return pn(e).bind((function(t){var n=wn(t);return Gy(n,e).map((function(r){return jy(t,n,e,r)}))}))},Gy=function(e,t){return G(e,w(xt,t))},Wy=function(e){return"br"===nn(e)},Ky=function(e,t,n){return t(e,n).bind((function(e){return ln(e)&&0===Bi(e).trim().length?Ky(e,t,n):A.some(e)}))},Yy=function(e,t,n){return n.traverse(t).orThunk((function(){return Ky(t,n.gather,e)})).map(n.relative)},Xy=function(e,t){return Sn(e,t).filter(Wy).orThunk((function(){return Sn(e,t-1).filter(Wy)}))},Jy=function(e,t,n,r){return Xy(t,n).bind((function(t){return r.traverse(t).fold((function(){return Ky(t,r.gather,e).map(r.relative)}),(function(e){return qy(e).map((function(e){return zv.on(e.parent,e.index)}))}))}))},Qy=function(e,t,n,r){var i=Wy(t)?Yy(e,t,r):Jy(e,t,n,r);return i.map((function(e){return{start:e,finish:e}}))},Zy=function(e){return Hy.cata(e,(function(e){return A.none()}),(function(){return A.none()}),(function(e){return A.some(af(e,0))}),(function(e){return A.some(af(e,Ts(e)))}))},ew=function(e,t){return{left:e.left,top:e.top+t,right:e.right,bottom:e.bottom+t}},tw=function(e,t){return{left:e.left,top:e.top-t,right:e.right,bottom:e.bottom-t}},nw=function(e,t,n){return{left:e.left+t,top:e.top+n,right:e.right+t,bottom:e.bottom+n}},rw=function(e){return e.top},iw=function(e){return e.bottom},ow=function(e,t,n){return n>=0&&n<Ts(t)?e.getRangedRect(t,n,t,n+1):n>0?e.getRangedRect(t,n-1,t,n):A.none()},aw=function(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom}},sw=function(e,t){return A.some(e.getRect(t))},lw=function(e,t,n){return sn(t)?sw(e,t).map(aw):ln(t)?ow(e,t,n).map(aw):A.none()},uw=function(e,t){return sn(t)?sw(e,t).map(aw):ln(t)?e.getRangedRect(t,0,t,Ts(t)).map(aw):A.none()},cw=5,dw=100,fw=co.generate([{none:[]},{retry:["caret"]}]),hw=function(e,t){return e.left<t.left||Math.abs(t.right-e.left)<1||e.left>t.right},mw=function(e,t,n){return Vn(t,sm).fold(C,(function(t){return uw(e,t).exists((function(e){return hw(n,e)}))}))},pw=function(e,t,n,r,i){var o=ew(i,cw);return Math.abs(n.bottom-r.bottom)<1||n.top>i.bottom?fw.retry(o):n.top===i.bottom?fw.retry(ew(i,1)):mw(e,t,i)?fw.retry(nw(o,cw,0)):fw.none()},gw=function(e,t,n,r,i){var o=tw(i,cw);return Math.abs(n.top-r.top)<1||n.bottom<i.top?fw.retry(o):n.bottom===i.top?fw.retry(tw(i,1)):mw(e,t,i)?fw.retry(nw(o,cw,0)):fw.none()},vw={point:rw,adjuster:gw,move:tw,gather:Iy},bw={point:iw,adjuster:pw,move:ew,gather:Py},yw=function(e,t,n){return e.elementFromPoint(t,n).filter((function(e){return"table"===nn(e)})).isSome()},ww=function(e,t,n,r,i){return Sw(e,t,n,t.move(r,cw),i)},Sw=function(e,t,n,r,i){return 0===i?A.some(r):yw(e,r.left,t.point(r))?ww(e,t,n,r,i-1):e.situsFromPoint(r.left,t.point(r)).bind((function(o){return o.start.fold(A.none,(function(o){return uw(e,o).bind((function(a){return t.adjuster(e,o,a,n,r).fold(A.none,(function(r){return Sw(e,t,n,r,i-1)}))})).orThunk((function(){return A.some(r)}))}),A.none)}))},xw=function(e,t){return e.situsFromPoint(t.left,t.bottom+cw)},Cw=function(e,t){return e.situsFromPoint(t.left,t.top-cw)},Tw=function(e,t,n){return e.point(t)>n.getInnerHeight()?A.some(e.point(t)-n.getInnerHeight()):e.point(t)<0?A.some(-e.point(t)):A.none()},Dw=function(e,t,n){var r=e.move(n,cw),i=Sw(t,e,n,r,dw).getOr(r);return Tw(e,i,t).fold((function(){return t.situsFromPoint(i.left,e.point(i))}),(function(n){return t.scrollBy(0,n),t.situsFromPoint(i.left,e.point(i)-n)}))},kw={tryUp:w(Dw,vw),tryDown:w(Dw,bw),ieTryUp:Cw,ieTryDown:xw,getJumpSize:v(cw)},Ew=20,_w=function(e,t,n){return e.getSelection().bind((function(r){return Qy(t,r.finish,r.foffset,n).fold((function(){return A.some(af(r.finish,r.foffset))}),(function(i){var o=e.fromSitus(i),a=Hy.verify(e,r.finish,r.foffset,o.finish,o.foffset,n.failure,t);return Zy(a)}))}))},Aw=function(e,t,n,r,i,o){return 0===o?A.none():Rw(e,t,n,r,i).bind((function(a){var s=e.fromSitus(a),l=Hy.verify(e,n,r,s.finish,s.foffset,i.failure,t);return Hy.cata(l,(function(){return A.none()}),(function(){return A.some(a)}),(function(a){return xt(n,a)&&0===r?Lw(e,n,r,tw,i):Aw(e,t,a,0,i,o-1)}),(function(a){return xt(n,a)&&r===Ts(a)?Lw(e,n,r,ew,i):Aw(e,t,a,Ts(a),i,o-1)}))}))},Lw=function(e,t,n,r,i){return lw(e,t,n).bind((function(t){return Ow(e,i,r(t,kw.getJumpSize()))}))},Ow=function(e,t,n){var r=it().browser;return r.isChrome()||r.isSafari()||r.isFirefox()||r.isEdge()?t.otherRetry(e,n):r.isIE()?t.ieRetry(e,n):A.none()},Rw=function(e,t,n,r,i){return lw(e,n,r).bind((function(t){return Ow(e,i,t)}))},Iw=function(e,t,n){return _w(e,t,n).bind((function(r){return Aw(e,t,r.element,r.offset,n,Ew).map(e.fromSitus)}))},Pw=function(e,t){return Fy(e,(function(e){return pn(e).exists((function(e){return xt(e,t)}))}))},Mw=function(e,t,n,r,i){return Kn(r,"td,th",t).bind((function(r){return Kn(r,"table",t).bind((function(o){return Pw(i,o)?Iw(e,t,n).bind((function(e){return Kn(e.finish,"td,th",t).map((function(t){return{start:r,finish:t,range:e}}))})):A.none()}))}))},Nw=function(e,t,n,r,i,o){return it().browser.isIE()?A.none():o(r,t).orThunk((function(){return Mw(e,t,n,r,i).map((function(e){var t=e.range;return sy.create(A.some(dy(t.start,t.soffset,t.finish,t.foffset)),!0)}))}))},Fw=function(e,t){return Kn(e,"tr",t).bind((function(e){return Kn(e,"table",t).bind((function(n){var r=$n(n,"tr");return xt(e,r[0])?My(n,(function(e){return As(e).isSome()}),t).map((function(e){var t=Ts(e);return sy.create(A.some(dy(e,t,e,t)),!0)})):A.none()}))}))},Bw=function(e,t){return Kn(e,"tr",t).bind((function(e){return Kn(e,"table",t).bind((function(n){var r=$n(n,"tr");return xt(e,r[r.length-1])?Ny(n,(function(e){return _s(e).isSome()}),t).map((function(e){return sy.create(A.some(dy(e,0,e,0)),!0)})):A.none()}))}))},$w=function(e,t,n,r,i,o,a){return Mw(e,n,r,i,o).bind((function(e){return hy(t,n,e.start,e.finish,a)}))},zw=function(e,t){return Kn(e,"td,th",t)},Uw=function(e,t,n,r){var i=bg(),o=i.clear,a=function(o){i.on((function(i){r.clearBeforeUpdate(t),zw(o.target,n).each((function(a){to(i,a,n).each((function(n){var i=n.boxes.getOr([]);if(1===i.length){var s=i[0],l="false"===Cc(s),u=rr(Sc(o.target),s,xt);l&&u&&(r.selectRange(t,i,s,s),e.selectContents(s))}else i.length>1&&(r.selectRange(t,i,n.start,n.finish),e.selectContents(a))}))}))}))},s=function(e){r.clear(t),zw(e.target,n).each(i.set)},l=function(e){a(e)},u=function(e){a(e),o()};return{clearstate:o,mousedown:s,mouseover:l,mouseup:u}},Vw={traverse:yn,gather:Py,relative:zv.before,otherRetry:kw.tryDown,ieRetry:kw.ieTryDown,failure:Hy.failedDown},Hw={traverse:bn,gather:Iy,relative:zv.before,otherRetry:kw.tryUp,ieRetry:kw.ieTryUp,failure:Hy.failedUp},jw=function(e){return function(t){return t===e}},qw=jw(38),Gw=jw(40),Ww=function(e){return e>=37&&e<=40},Kw={isBackward:jw(37),isForward:jw(39)},Yw={isBackward:jw(39),isForward:jw(37)},Xw=function(e){var t=void 0!==e?e.dom:document,n=t.body.scrollLeft||t.documentElement.scrollLeft,r=t.body.scrollTop||t.documentElement.scrollTop;return Qo(n,r)},Jw=function(e,t,n){var r=void 0!==n?n.dom:document,i=r.defaultView;i&&i.scrollBy(e,t)},Qw=function(e){var t=function(t,n){return vt.fromPoint(vt.fromDom(e.document),t,n)},n=function(e){return e.dom.getBoundingClientRect()},r=function(t,n,r,i){var o=Yv.exact(t,n,r,i);return Xb(e,o)},i=function(){return Yb(e).map((function(t){return cy(e,t)}))},o=function(t){var n=Yv.relative(t.start,t.finish);return cy(e,n)},a=function(t,n){return Jb(e,t,n).map((function(e){return uy.create(e.start,e.soffset,e.finish,e.foffset)}))},s=function(){Qb(e)},l=function(t){void 0===t&&(t=!1),Yb(e).each((function(n){return n.fold((function(e){return e.collapse(t)}),(function(n,r){var i=t?n:r;Hb(e,i,i)}),(function(n,r,i,o){var a=t?n:i,s=t?r:o;Vb(e,a,s,a,s)}))}))},u=function(t){Wb(e,t,!1)},c=function(t){Wb(e,t)},d=function(t){Vb(e,t.start,t.soffset,t.finish,t.foffset)},f=function(t,n){Hb(e,t,n)},h=function(){return e.innerHeight},m=function(){var t=Xw(vt.fromDom(e.document));return t.top},p=function(t,n){Jw(t,n,vt.fromDom(e.document))};return{elementFromPoint:t,getRect:n,getRangedRect:r,getSelection:i,fromSitus:o,situsFromPoint:a,clearSelection:s,collapseSelection:l,setSelection:d,setRelativeSelection:f,selectNode:u,selectContents:c,getInnerHeight:h,getScrollY:m,scrollBy:p}},Zw=function(e,t){return{rows:e,cols:t}},eS=function(e,t,n,r){var i=Qw(e),o=Uw(i,t,n,r);return{clearstate:o.clearstate,mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}},tS=function(e,t,n,r){var i=Qw(e),o=function(){return r.clear(t),A.none()},a=function(e,a,s,l,u,c){var d=e.raw,f=d.which,h=!0===d.shiftKey,m=no(t,r.selectedSelector).fold((function(){return Ww(f)&&!h&&r.clearBeforeUpdate(t),Gw(f)&&h?w($w,i,t,n,Vw,l,a,r.selectRange):qw(f)&&h?w($w,i,t,n,Hw,l,a,r.selectRange):Gw(f)?w(Nw,i,n,Vw,l,a,Bw):qw(f)?w(Nw,i,n,Hw,l,a,Fw):A.none}),(function(e){var n=function(n){return function(){var o=re(n,(function(n){return my(n.rows,n.cols,t,e,r)}));return o.fold((function(){return io(t,r.firstSelectedSelector,r.lastSelectedSelector).map((function(e){var n=Gw(f)||c.isForward(f)?zv.after:zv.before;return i.setRelativeSelection(zv.on(e.first,0),n(e.table)),r.clear(t),sy.create(A.none(),!0)}))}),(function(e){return A.some(sy.create(A.none(),!0))}))}};return Gw(f)&&h?n([Zw(1,0)]):qw(f)&&h?n([Zw(-1,0)]):c.isBackward(f)&&h?n([Zw(0,-1),Zw(-1,0)]):c.isForward(f)&&h?n([Zw(0,1),Zw(1,0)]):Ww(f)&&!h?o:A.none}));return m()},s=function(e,i,o,a,s){return no(t,r.selectedSelector).fold((function(){var l=e.raw,u=l.which,c=!0===l.shiftKey;return c&&Ww(u)?fy(t,n,i,o,a,s,r.selectRange):A.none()}),A.none)};return{keydown:a,keyup:s}},nS=function(e,t,n,r){var i=Qw(e);return function(e,o){r.clearBeforeUpdate(t),to(e,o,n).each((function(e){var n=e.boxes.getOr([]);r.selectRange(t,n,e.start,e.finish),i.selectContents(o),i.collapseSelection()}))}},rS=function(e,t){B(t,(function(t){uc(e,t)}))},iS=function(e){return function(t){sc(t,e)}},oS=function(e){return function(t){rS(t,e)}},aS=function(e){var t=iS(e.selected),n=oS([e.selected,e.lastSelected,e.firstSelected]),r=function(t){var r=$n(t,e.selectedSelector);B(r,n)},i=function(n,i,o,a){r(n),B(i,t),sc(o,e.firstSelected),sc(a,e.lastSelected)};return{clearBeforeUpdate:r,clear:r,selectRange:i,selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}},sS=function(e,t,n){var r=function(t){tr(t,e.selected),tr(t,e.firstSelected),tr(t,e.lastSelected)},i=function(t){Xn(t,e.selected,"1")},o=function(e){a(e),n()},a=function(t){var n=$n(t,e.selectedSelector+","+e.firstSelectedSelector+","+e.lastSelectedSelector);B(n,r)},s=function(n,r,a,s){o(n),B(r,i),Xn(a,e.firstSelected,"1"),Xn(s,e.lastSelected,"1"),t(r,a,s)};return{clearBeforeUpdate:a,clear:o,selectRange:s,selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}},lS={byClass:aS,byAttr:sS},uS=function(e,t){var n=e.slice(0,t[t.length-1].row+1),r=Uf(n);return K(r,(function(e){var n=e.cells.slice(0,t[t.length-1].column+1);return F(n,(function(e){return e.element}))}))},cS=function(e,t){var n=e.slice(t[0].row+t[0].rowspan-1,e.length),r=Uf(n);return K(r,(function(e){var n=e.cells.slice(t[0].column+t[0].colspan-1,e.cells.length);return F(n,(function(e){return e.element}))}))},dS=function(e,t,n){var r=ui.fromTable(e),i=Yf(r,t);return i.map((function(e){var t=$f(r,n,!1),i=uS(t,e),o=cS(t,e);return{upOrLeftCells:i,downOrRightCells:o}}))},fS=tinymce.util.Tools.resolve("tinymce.Env"),hS=function(e){return!1===cc(vt.fromDom(e.target),"ephox-snooker-resizer-bar")};function mS(e,t,n){var r=function(t,r,i){n.targets().each((function(n){var o=Rr(r);o.each((function(o){var a=zd(e),s=zs(m,vt.fromDom(e.getDoc()),a),l=dS(o,n,s);td(e,t,r,i,l)}))}))},i=function(){return nd(e)},o=lS.byAttr(ml,r,i);return e.on("init",(function(n){var r=e.getWin(),i=qs(e),a=Ks(e),s=function(){var t=e.selection,n=vt.fromDom(t.getStart()),r=vt.fromDom(t.getEnd()),a=Qi(Rr,[n,r]);a.fold((function(){return o.clear(i)}),m)},l=eS(r,i,a,o),u=tS(r,i,a,o),c=nS(r,i,a,o),d=function(e){return!0===e.raw.shiftKey};e.on("TableSelectorChange",(function(e){return c(e.start,e.finish)}));var f=function(t,n){d(t)&&(n.kill&&t.kill(),n.selection.each((function(t){var n=Yv.relative(t.start,t.finish),i=cb(r,n);e.selection.setRng(i)})))},h=function(t){var n=Zu(t);if(n.raw.shiftKey&&Ww(n.raw.which)){var r=e.selection.getRng(),i=vt.fromDom(r.startContainer),o=vt.fromDom(r.endContainer);u.keyup(n,i,r.startOffset,o,r.endOffset).each((function(e){f(n,e)}))}},p=function(n){var r=Zu(n);t().each((function(e){return e.hideBars()}));var i=e.selection.getRng(),o=vt.fromDom(i.startContainer),a=vt.fromDom(i.endContainer),s=qo(Kw,Yw)(vt.fromDom(e.selection.getStart()));u.keydown(r,o,i.startOffset,a,i.endOffset,s).each((function(e){f(r,e)})),t().each((function(e){return e.showBars()}))},g=function(e){return 0===e.button},v=function(e){return void 0===e.buttons||(!(!fS.browser.isEdge()||0!==e.buttons)||0!==(1&e.buttons))},b=function(e){l.clearstate()},y=function(e){g(e)&&hS(e)&&l.mousedown(Zu(e))},w=function(e){v(e)&&hS(e)&&l.mouseover(Zu(e))},S=function(e){g(e)&&hS(e)&&l.mouseup(Zu(e))},x=function(){var e=pg(vt.fromDom(i)),t=pg(0),n=function(n){var r=vt.fromDom(n.target);if("td"===nn(r)||"th"===nn(r)){var i=e.get(),o=t.get();xt(i,r)&&n.timeStamp-o<300&&(n.preventDefault(),c(r,r))}e.set(r),t.set(n.timeStamp)};return{touchEnd:n}},C=x();e.on("dragstart",b),e.on("mousedown",y),e.on("mouseover",w),e.on("mouseup",S),e.on("touchend",C.touchEnd),e.on("keyup",h),e.on("keydown",p),e.on("NodeChange",s)})),{clear:o.clear}}var pS=function(e,t){return Gn(e,t).isSome()},gS=function(e,t){var n=pg(A.none()),r=pg([]),i=A.none(),o=dn("caption"),a=function(e){return i.forall((function(t){return!t[e]}))},s=function(){return Sl(tl(e),Ks(e))},l=function(){return Sl(nl(e),Ks(e))},u=function(){return s().bind((function(e){return sr(or(Rr(e),l().bind(Rr),(function(n,r){return xt(n,r)?o(e)?A.some(pl(e)):A.some(gl(t,n,e)):A.none()})))}))},c=function(e){var t=Rr(e.element);return t.map((function(t){var n=ui.fromTable(t),r=Yf(n,e).getOr([]),i=H(r,(function(e,t){return t.isLocked&&(e.onAny=!0,0===t.column?e.onFirst=!0:t.column+t.colspan>=n.grid.columns&&(e.onLast=!0)),e}),{onAny:!1,onFirst:!1,onLast:!1});return{mergeable:Zf(n,e).isSome(),unmergeable:eh(n,e).isSome(),locked:i}}))},d=function(){n.set(ae(u)()),i=n.get().bind(c),B(r.get(),(function(e){return e()}))},f=function(e){return e(),r.set(r.get().concat([e])),function(){r.set(U(r.get(),(function(t){return t!==e})))}},h=function(e,t){return f((function(){return n.get().fold((function(){e.setDisabled(!0)}),(function(n){e.setDisabled(t(n))}))}))},m=function(e,t,r){return f((function(){return n.get().fold((function(){e.setDisabled(!0),e.setActive(!1)}),(function(n){e.setDisabled(t(n)),e.setActive(r(n))}))}))},p=function(e){return i.exists((function(t){return t.locked[e]}))},g=function(e){return h(e,(function(e){return!1}))},v=function(e){return h(e,(function(e){return o(e.element)}))},b=function(e){return function(t){return h(t,(function(t){return o(t.element)||p(e)}))}},y=function(e){return function(t){return h(t,(function(t){return o(t.element)||e().isNone()}))}},w=function(e,t){return function(n){return h(n,(function(n){return o(n.element)||e().isNone()||p(t)}))}},S=function(e){return h(e,(function(e){return a("mergeable")}))},x=function(e){return h(e,(function(e){return a("unmergeable")}))},T=function(t){return m(t,C,(function(t){var n=Rr(t.element,Ks(e));return n.exists((function(e){return pS(e,"caption")}))}))},D=function(t,n){return function(r){return m(r,(function(e){return o(e.element)}),(function(){return e.queryCommandValue(t)===n}))}},k=D("mceTableRowType","header"),E=D("mceTableColType","th");return e.on("NodeChange ExecCommand TableSelectorChange",d),{onSetupTable:g,onSetupCellOrRow:v,onSetupColumn:b,onSetupPasteable:y,onSetupPasteableColumn:w,onSetupMergeable:S,onSetupUnmergeable:x,resetTargets:d,onSetupTableWithCaption:T,onSetupTableRowHeaders:k,onSetupTableColumnHeaders:E,targets:n.get}},vS=function(e,t,n,r){e.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(e){return e("inserttable | cell row column | advtablesort | tableprops deletetable")}});var i=function(t){return function(){return e.execCommand(t)}};e.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:i("mceTableProps"),icon:"table",onSetup:n.onSetupTable}),e.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:i("mceTableDelete"),icon:"table-delete-table",onSetup:n.onSetupTable}),e.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:i("mceTableCellProps"),icon:"table-cell-properties",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:i("mceTableMergeCells"),icon:"table-merge-cells",onSetup:n.onSetupMergeable}),e.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:i("mceTableSplitCells"),icon:"table-split-cells",onSetup:n.onSetupUnmergeable}),e.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:i("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:i("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:i("mceTableDeleteRow"),icon:"table-delete-row",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:i("mceTableRowProps"),icon:"table-row-properties",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:i("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:n.onSetupColumn("onFirst")}),e.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:i("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:n.onSetupColumn("onLast")}),e.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:i("mceTableDeleteCol"),icon:"table-delete-column",onSetup:n.onSetupColumn("onAny")}),e.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",icon:"cut-row",onAction:i("mceTableCutRow"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",icon:"duplicate-row",onAction:i("mceTableCopyRow"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",icon:"paste-row-before",onAction:i("mceTablePasteRowBefore"),onSetup:n.onSetupPasteable(r.getRows)}),e.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",icon:"paste-row-after",onAction:i("mceTablePasteRowAfter"),onSetup:n.onSetupPasteable(r.getRows)}),e.ui.registry.addButton("tablecutcol",{tooltip:"Cut column",icon:"cut-column",onAction:i("mceTableCutCol"),onSetup:n.onSetupColumn("onAny")}),e.ui.registry.addButton("tablecopycol",{tooltip:"Copy column",icon:"duplicate-column",onAction:i("mceTableCopyCol"),onSetup:n.onSetupColumn("onAny")}),e.ui.registry.addButton("tablepastecolbefore",{tooltip:"Paste column before",icon:"paste-column-before",onAction:i("mceTablePasteColBefore"),onSetup:n.onSetupPasteableColumn(r.getColumns,"onFirst")}),e.ui.registry.addButton("tablepastecolafter",{tooltip:"Paste column after",icon:"paste-column-after",onAction:i("mceTablePasteColAfter"),onSetup:n.onSetupPasteableColumn(r.getColumns,"onLast")}),e.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:i("mceInsertTable"),icon:"table"});var o=Tg(Ld(e));0!==o.length&&e.ui.registry.addMenuButton("tableclass",{icon:"table-classes",tooltip:"Table styles",fetch:Dg(e,t,o,"tableclass",(function(t){return e.execCommand("mceTableToggleClass",!1,t)})),onSetup:n.onSetupTable});var a=Tg(_d(e));0!==a.length&&e.ui.registry.addMenuButton("tablecellclass",{icon:"table-cell-classes",tooltip:"Cell styles",fetch:Dg(e,t,a,"tablecellclass",(function(t){return e.execCommand("mceTableCellToggleClass",!1,t)})),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellvalign",{icon:"vertical-align",tooltip:"Vertical align",fetch:Dg(e,t,eg,"tablecellverticalalign",Cg(e,"vertical-align")),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellborderwidth",{icon:"border-width",tooltip:"Border width",fetch:Dg(e,t,gd(e),"tablecellborderwidth",Cg(e,"border-width")),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellborderstyle",{icon:"border-style",tooltip:"Border style",fetch:Dg(e,t,vd(e),"tablecellborderstyle",Cg(e,"border-style")),onSetup:n.onSetupCellOrRow}),e.ui.registry.addToggleButton("tablecaption",{tooltip:"Table caption",onAction:i("mceTableToggleCaption"),icon:"table-caption",onSetup:n.onSetupTableWithCaption}),e.ui.registry.addMenuButton("tablecellbackgroundcolor",{icon:"cell-background-color",tooltip:"Background color",fetch:function(t){return t(kg(e,Vd(e),"background-color"))},onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellbordercolor",{icon:"cell-border-color",tooltip:"Border color",fetch:function(t){return t(kg(e,Hd(e),"border-color"))},onSetup:n.onSetupCellOrRow}),e.ui.registry.addToggleButton("tablerowheader",{tooltip:"Row header",icon:"table-top-header",onAction:Eg(e),onSetup:n.onSetupTableRowHeaders}),e.ui.registry.addToggleButton("tablecolheader",{tooltip:"Column header",icon:"table-left-header",onAction:_g(e),onSetup:n.onSetupTableColumnHeaders})},bS=function(e){var t=function(t){return e.dom.is(t,"table")&&e.getBody().contains(t)},n=Pd(e);n.length>0&&e.ui.registry.addContextToolbar("table",{predicate:t,items:n,scope:"node",position:"node"})},yS=function(e,t,n,r){var i=function(t){return function(){return e.execCommand(t)}},o=function(t){e.execCommand("mceInsertTable",!1,{rows:t.numRows,columns:t.numColumns})},a={text:"Table properties",onSetup:n.onSetupTable,onAction:i("mceTableProps")},s={text:"Delete table",icon:"table-delete-table",onSetup:n.onSetupTable,onAction:i("mceTableDelete")};e.ui.registry.addMenuItem("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",onAction:i("mceTableInsertRowBefore"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuItem("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",onAction:i("mceTableInsertRowAfter"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuItem("tabledeleterow",{text:"Delete row",icon:"table-delete-row",onAction:i("mceTableDeleteRow"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablerowprops",{text:"Row properties",icon:"table-row-properties",onAction:i("mceTableRowProps"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecutrow",{text:"Cut row",icon:"cut-row",onAction:i("mceTableCutRow"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecopyrow",{text:"Copy row",icon:"duplicate-row",onAction:i("mceTableCopyRow"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",onAction:i("mceTablePasteRowBefore"),onSetup:n.onSetupPasteable(r.getRows)}),e.ui.registry.addMenuItem("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",onAction:i("mceTablePasteRowAfter"),onSetup:n.onSetupPasteable(r.getRows)});var l={type:"nestedmenuitem",text:"Row",getSubmenuItems:v("tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter")};e.ui.registry.addMenuItem("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",onAction:i("mceTableInsertColBefore"),onSetup:n.onSetupColumn("onFirst")}),e.ui.registry.addMenuItem("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",onAction:i("mceTableInsertColAfter"),onSetup:n.onSetupColumn("onLast")}),e.ui.registry.addMenuItem("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",onAction:i("mceTableDeleteCol"),onSetup:n.onSetupColumn("onAny")}),e.ui.registry.addMenuItem("tablecutcolumn",{text:"Cut column",icon:"cut-column",onAction:i("mceTableCutCol"),onSetup:n.onSetupColumn("onAny")}),e.ui.registry.addMenuItem("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",onAction:i("mceTableCopyCol"),onSetup:n.onSetupColumn("onAny")}),e.ui.registry.addMenuItem("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",onAction:i("mceTablePasteColBefore"),onSetup:n.onSetupPasteableColumn(r.getColumns,"onFirst")}),e.ui.registry.addMenuItem("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",onAction:i("mceTablePasteColAfter"),onSetup:n.onSetupPasteableColumn(r.getColumns,"onLast")});var u={type:"nestedmenuitem",text:"Column",getSubmenuItems:v("tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter")};e.ui.registry.addMenuItem("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",onAction:i("mceTableCellProps"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",onAction:i("mceTableMergeCells"),onSetup:n.onSetupMergeable}),e.ui.registry.addMenuItem("tablesplitcells",{text:"Split cell",icon:"table-split-cells",onAction:i("mceTableSplitCells"),onSetup:n.onSetupUnmergeable});var c={type:"nestedmenuitem",text:"Cell",getSubmenuItems:v("tablecellprops tablemergecells tablesplitcells")};!1===kd(e)?e.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:i("mceInsertTable")}):e.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:o}]}}),e.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:i("mceInsertTable")}),e.ui.registry.addMenuItem("tableprops",a),e.ui.registry.addMenuItem("deletetable",s),e.ui.registry.addNestedMenuItem("row",l),e.ui.registry.addNestedMenuItem("column",u),e.ui.registry.addNestedMenuItem("cell",c),e.ui.registry.addContextMenu("table",{update:function(){return n.resetTargets(),n.targets().fold(v(""),(function(e){return"caption"===nn(e.element)?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"}))}});var d=Tg(Ld(e));0!==d.length&&e.ui.registry.addNestedMenuItem("tableclass",{icon:"table-classes",text:"Table styles",getSubmenuItems:function(){return xg(e,t,d,"tableclass",(function(t){return e.execCommand("mceTableToggleClass",!1,t)}))},onSetup:n.onSetupTable});var f=Tg(_d(e));0!==f.length&&e.ui.registry.addNestedMenuItem("tablecellclass",{icon:"table-cell-classes",text:"Cell styles",getSubmenuItems:function(){return xg(e,t,f,"tablecellclass",(function(t){return e.execCommand("mceTableCellToggleClass",!1,t)}))},onSetup:n.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellvalign",{icon:"vertical-align",text:"Vertical align",getSubmenuItems:function(){return xg(e,t,eg,"tablecellverticalalign",Cg(e,"vertical-align"))},onSetup:n.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellborderwidth",{icon:"border-width",text:"Border width",getSubmenuItems:function(){return xg(e,t,gd(e),"tablecellborderwidth",Cg(e,"border-width"))},onSetup:n.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellborderstyle",{icon:"border-style",text:"Border style",getSubmenuItems:function(){return xg(e,t,vd(e),"tablecellborderstyle",Cg(e,"border-style"))},onSetup:n.onSetupCellOrRow}),e.ui.registry.addToggleMenuItem("tablecaption",{icon:"table-caption",text:"Table caption",onAction:i("mceTableToggleCaption"),onSetup:n.onSetupTableWithCaption}),e.ui.registry.addNestedMenuItem("tablecellbackgroundcolor",{icon:"cell-background-color",text:"Background color",getSubmenuItems:function(){return kg(e,Vd(e),"background-color")},onSetup:n.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellbordercolor",{icon:"cell-border-color",text:"Border color",getSubmenuItems:function(){return kg(e,Hd(e),"border-color")},onSetup:n.onSetupCellOrRow}),e.ui.registry.addToggleMenuItem("tablerowheader",{text:"Row header",icon:"table-top-header",onAction:Eg(e),onSetup:n.onSetupTableRowHeaders}),e.ui.registry.addToggleMenuItem("tablecolheader",{text:"Column header",icon:"table-left-header",onAction:_g(e),onSetup:n.onSetupTableColumnHeaders})},wS=function(e){var t=vo((function(){return qs(e)}),(function(){return xl(tl(e),Ks(e))}),ml.selectedSelector),n=gS(e,t),r=of(e),i=mS(e,r.lazyResize,n),o=xp(e,i,r.lazyWire),a=wv();return bv(e,o,i,t,a),yv(e,o,t),_l(e,t,o),yS(e,t,n,a),vS(e,t,n,a),bS(e),e.on("PreInit",(function(){e.serializer.addTempAttr(ml.firstSelected),e.serializer.addTempAttr(ml.lastSelected),Tv(e)})),Sd(e)&&e.on("keydown",(function(t){oy(t,e,i)})),e.on("remove",(function(){r.destroy()})),Vp(e,a,r,n)};function SS(){bo.add("table",wS)}SS()})()},"600b":function(e,t,n){},"61b1":function(e,t,n){},"61cb":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{ref:"filter",attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}},[t("span",{attrs:{slot:"parentId"},slot:"parentId"},[t("el-select",{attrs:{filterable:"",remote:"",size:"small",clearable:"",placeholder:"添加人","remote-method":e.remoteMethod,loading:e.remoteLoading},model:{value:e.filterData.parentId,callback:function(t){e.$set(e.filterData,"parentId",t)},expression:"filterData.parentId"}},e._l(e.supervisorAdOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)]),t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,operates:e.operates,data:e.table.data,operateWidth:"120px",pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange},scopedSlots:e._u([{key:"image",fn:function(e){return t("div",{},[e.row.image?t("el-image",{staticStyle:{width:"50px"},attrs:{src:e.row.image,"preview-src-list":[e.row.image]}}):t("span")],1)}}])}),t("add-dialog",{ref:"addDialog",on:{success:e.handleSuccess}}),t("el-dialog",{attrs:{title:"会员交接（订单交接）",visible:e.JJDialogFlag,width:"30%"},on:{"update:visible":function(t){e.JJDialogFlag=t},close:e.closeJJ}},[t("div",{staticClass:"dialog-warning"},[e._v(" 交接后会将原销售账号的所有订单利益归属都转移给新销售账号，不影响原销售账号开单和新销售账号开单。 ")]),t("div",{staticClass:"dialog-row"},[t("span",[e._v("原销售账号（交接前）:")]),t("el-input",{staticClass:"input-field",attrs:{placeholder:"",size:"small",disabled:""},model:{value:e.JJFrom.rawName,callback:function(t){e.$set(e.JJFrom,"rawName",t)},expression:"JJFrom.rawName"}})],1),t("div",{staticClass:"dialog-row"},[t("span",[e._v("新销售账号（交接后）：")]),t("el-select",{staticClass:"select-field",attrs:{filterable:"",remote:"",size:"small",clearable:"",placeholder:"新销售账号","remote-method":e.remoteMethodV2,loading:e.remoteLoading},model:{value:e.JJFrom.newId,callback:function(t){e.$set(e.JJFrom,"newId",t)},expression:"JJFrom.newId"}},e._l(e.supervisorAdOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("div",{staticClass:"dialog-row"},[t("span",[e._v("订单列表：")]),t("el-checkbox",{attrs:{"true-label":0,"false-label":1},model:{value:e.JJFrom.all,callback:function(t){e.$set(e.JJFrom,"all",t)},expression:"JJFrom.all"}},[e._v(" 全选订单 ")]),1===e.JJFrom.all?t("el-select",{directives:[{name:"el-select-handler",rawName:"v-el-select-handler",value:e.loadMoreOrders,expression:"loadMoreOrders"}],staticClass:"select-field",attrs:{remote:"",multiple:"",size:"small",clearable:"",filterable:"",placeholder:"请选择订单","remote-method":e.searchOrderNum,loading:e.remoteLoading},model:{value:e.JJFrom.orders,callback:function(t){e.$set(e.JJFrom,"orders",t)},expression:"JJFrom.orders"}},e._l(e.orderOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.orderNum,value:e.id}})})),1):e._e()],1),t("div",{staticClass:"dialog-footer"},[t("el-button",{on:{click:function(t){e.JJDialogFlag=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handover}},[e._v("确定")])],1)]),t("detailDrawer",{ref:"drawer"})],1)},i=[],o=n("7591"),a=n("b775"),s=n("1f28"),l=n("b893"),u=n("46bb"),c={name:"adminManagePage",components:{BasicTable:o["a"],addDialog:s["default"],detailDrawer:u["default"]},directives:{elSelectHandler:{bind(e,t){setTimeout(()=>{const n=e.querySelector(".el-select-dropdown .el-select-dropdown__wrap");n&&n.addEventListener("scroll",(function(){const e=this.scrollHeight-this.scrollTop<=this.clientHeight+5;e&&t.value()}))},0)},unbind(e){const t=e.querySelector(".el-select-dropdown .el-select-dropdown__wrap");t&&t.removeEventListener("scroll",e._onScroll)}}},watch:{"JJFrom.all":function(e){0===e&&this.loadInitialOrders()}},data(){return{pageNo:1,orderNum:"",noMoreData:!1,JJFrom:{rawName:"",rawId:"",newId:"",orders:[],all:1},JJDialogFlag:!1,supervisorAdOptions:[],orderOptions:[],departmentList:[],remoteLoading:!1,loading:!1,filterOptions:{column:[{type:"input",label:"用户名/真实姓名/电话号码",value:"username"},{type:"input",label:"QQ/微信",value:"qq"},{type:"select",label:"性别",value:"gender",options:[{label:"男",value:"1"},{label:"女",value:"2"}]},{type:"cascader",label:"部门",value:"departmentId",ref:"departmentRef",options:[],props:{value:"id",label:"name",multiple:!0}},{type:"slot",slotName:"parentId"},{type:"select",label:"状态",value:"status",options:[{label:"正常",value:0},{label:"冻结",value:-1},{label:"禁用",value:-2}]},{type:"timeAll",label:["注册开始日期","注册结束日期"],value:"registerTime"}]},filterData:{username:"",qq:"",gender:"",departmentId:[],parentId:"",status:"",registerTime:[]},statusDic:{0:{label:"正常",type:"success"},"-1":{label:"冻结",type:"warning"},"-2":{label:"禁用",type:"danger"}},table:{columns:[{id:1,prop:"account",label:"用户名"},{id:3,prop:"name",label:"真实姓名"},{id:4,prop:"qq",label:"QQ"},{id:5,prop:"wechat",label:"微信"},{id:6,prop:"phone",label:"联系电话"},{id:7,prop:"departments",label:"所属部门",showOverflowTooltip:!1},{id:8,prop:"roles",label:"所属角色",showOverflowTooltip:!1},{id:9,prop:"canSeeDepartmentName",label:"可查看部门",showOverflowTooltip:!1},{id:11,prop:"status",label:"状态",render:e=>this.statusDic[e.status].label,statusType:e=>this.statusDic[e.status].type,width:"70px"},{id:10,prop:"createTime",label:"注册时间",type:"date"}],pageSize:20,currentPage:1,data:[],total:0},operates:[{key:"edit",title:"编辑",btnStyle:"yellow",permission:"admin/adInfo/editAdmin",action:(e,t)=>{this.$refs.addDialog.edit(t)}},{key:"edit",title:"订单交接",permission:"admin/adInfo/handover",btnStyle:"red",action:(e,t)=>{this.openJJ(t)}},{key:"detail",title:"详情",btnStyle:"green",action:(e,t)=>{this.$refs.drawer.open(t,this.departmentList)}}],headerOperates:[{key:"el-icon-plus",name:"添加管理员",permission:"admin/adInfo/addAdmin",action:()=>{this.$refs.addDialog.open()}}]}},created(){this.getList(),this.getDepartmentList()},methods:{loadInitialOrders(){this.pageNo=1,this.noMoreData=!1,this.getOrderOptions(this.JJFrom.rawId,this.pageNo)},loadMoreOrders(){this.noMoreData||(this.pageNo++,this.getOrderOptions(this.JJFrom.rawId,this.pageNo))},getOrderOptions(e,t=1){this.remoteLoading=!0,a["a"].post({url:"/system/sysCourseOrder/salesOrderList",params:{pageNo:t,pageSize:50,profitAdId:e,orderNum:this.orderNum},success:e=>{this.remoteLoading=!1,this.orderOptions=1===t?e.list:[...this.orderOptions,...e.list],e.list.length<50&&(this.noMoreData=!0)},catch:()=>{this.remoteLoading=!1}})},searchOrderNum(e){this.orderNum=e,this.pageNo=1,this.noMoreData=!1,this.getOrderOptions(this.JJFrom.rawId,this.pageNo)},handover(){this.JJFrom.newId?this.JJFrom.rawId?this.$confirm("确定将"+this.JJFrom.rawName+"目前为止的所有订单转移给新销售吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/admin/adInfo/handover",params:{rawId:this.JJFrom.rawId,newId:this.JJFrom.newId,orders:JSON.stringify(this.JJFrom.orders),all:this.JJFrom.all},success:e=>{this.$message.success("交接成功！"),this.JJDialogFlag=!1}})}).catch(()=>{}):this.$message.warning("旧销售不能为空"):this.$message.warning("请选择新销售账号（交接后的）")},closeJJ(){this.JJFrom={rawName:"",rawId:"",newId:"",orders:[],all:1},this.supervisorAdOptions=[]},openJJ(e){this.pageNo=1,this.noMoreData=!1,this.getOrderOptions(e.id),this.JJFrom.rawId=e.id,this.JJFrom.rawName=e.name,this.JJDialogFlag=!0},searchFilter(){this.table.currentPage=1,this.getList()},getList(){const{registerTime:e,...t}=this.filterData;this.loading=!0,this.$nextTick(()=>{const n=this.$refs.filter.$refs.departmentRef[0].getCheckedNodes().map(e=>e.data.id);a["a"].post({url:"/admin/adInfo/adList",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,...t,departmentId:n&&n.length>0?JSON.stringify(n):"",startTime:e&&e.length>0?e[0]:"",endTime:e&&e.length>0?this.$moment(e[1]).add(1,"days").format("YYYY-MM-DD"):""},success:e=>{this.loading=!1,this.table.data=e.list,this.table.total=e.total,console.log("da:",this.table.data),this.table.data.forEach(e=>{this.$common.checkNull(e.qq)||(e.qq="暂未填写qq"),this.$common.checkNull(e.wechat)||(e.wechat="暂未填写微信号"),this.$common.checkNull(e.canSeeDepartmentName)||(e.canSeeDepartmentName="无")})},catch:()=>{this.loading=!1}})})},getDepartmentList(){a["a"].post({url:"/admin/adInfo/canChooseCanSeeDepartmentList",params:{...this.addData,id:sessionStorage.getItem("id")},success:e=>{this.departmentList=e,this.filterOptions.column[3].options=Object(l["c"])(e)}})},handleSuccess(){this.getList()},remoteMethod(e){e&&(this.remoteLoading=!0,a["a"].post({url:"/admin/adInfo/queryAdminByNameOrPhone",params:{search:e},success:e=>{this.remoteLoading=!1,this.supervisorAdOptions=e},catch:()=>{this.remoteLoading=!1}}))},remoteMethodV2(e){if(e){var t=0;this.remoteLoading=!0,a["a"].post({url:"/admin/adInfo/queryAdminByNameOrPhone",params:{search:e,type:t},success:e=>{this.remoteLoading=!1,this.supervisorAdOptions=e},catch:()=>{this.remoteLoading=!1}})}},clearFilter(){this.filterData={username:"",qq:"",gender:"",departmentId:[],parentId:"",status:"",registerTime:[]},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()}}},d=c,f=(n("68c6"),n("1805")),h=Object(f["a"])(d,r,i,!1,null,"02aba2a9",null);t["default"]=h.exports},"648b":function(e,t,n){},"651a":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}},[t("span",{attrs:{slot:"teacherAdId"},slot:"teacherAdId"},[t("el-select",{staticStyle:{width:"85%"},attrs:{size:"small",clearable:"",filterable:"",remote:"",placeholder:"讲师","remote-method":e.teacherRemoteMethod,loading:e.remoteLoading},model:{value:e.filterData.teacherAdId,callback:function(t){e.$set(e.filterData,"teacherAdId",t)},expression:"filterData.teacherAdId"}},e._l(e.teacherOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)]),t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,operates:e.operates,operateWidth:"110px",data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange}}),t("add-dialog",{ref:"addDialog",on:{success:e.handleSuccess}}),t("chapters",{ref:"chapters"})],1)},i=[],o=n("7591"),a=n("b775"),s=n("574d"),l=n("de3d"),u=n("2694"),c={name:"adverstPage",components:{BasicTable:o["a"],addDialog:s["default"],chapters:u["default"]},data(){return{loading:!1,remoteLoading:!1,supervisorAdOptions:[],categoryOptions:[],filterOptions:{column:[{type:"input",label:"课程编号",value:"number"},{type:"input",label:"课程名称",value:"name"},{type:"select",label:"课程类别",value:"categoryId",labelKey:"name",valueKey:"id",options:[]},{type:"select",label:"课程套餐",value:"setMealCategoryId",labelKey:"name",valueKey:"id",options:[]},{type:"select",label:"课程标签",value:"tag",options:l["e"]},{type:"select",label:"是否免费",value:"hasFree",options:l["a"]},{type:"slot",slotName:"teacherAdId"}]},remoteLoading:!1,teacherOptions:[],filterData:{name:"",number:"",hasLive:"",teacherAdId:"",categoryId:"",hasFree:"",setMealCategoryId:""},table:{columns:[{id:1,prop:"number",label:"课程编号"},{id:14,prop:"name",label:"课程名称"},{id:2,prop:"setMealName",label:"所属套餐名称",width:"160px"},{id:3,prop:"hasLive",label:"课程类型",render:e=>{const t=this.hasLiveOptions.find(t=>t.value==e.hasLive);return t?t.label:""}},{id:5,prop:"setMealCategoryId",label:"课程套餐",render:e=>{const t=this.$refs.addDialog.MealCategoryOptions.find(t=>t.id==e.setMealCategoryId);return t?t.name:"无"}},{id:6,prop:"categoryId",label:"课程类别",render:e=>{const t=this.$refs.addDialog.categoryOptions.find(t=>t.id==e.categoryId);return t?t.name:""}},{id:7,prop:"tag",label:"课程标签",render:e=>{const t=l["e"].find(t=>t.value==e.tag);return t?t.label:""}},{id:8,prop:"position",label:"推荐位",render:e=>{const t=l["c"].find(t=>t.value==e.position);return t?t.label:""}},{id:9,prop:"teacherName",label:"讲师"},{id:10,prop:"price",label:"价格"},{id:11,prop:"createAdName",label:"增加人"},{id:12,prop:"createTime",label:"增加时间",type:"date",width:180},{id:13,prop:"sort",label:"排序"}],pageSize:20,currentPage:1,data:[],total:0},operates:[{key:"edit",title:"编辑",btnStyle:"yellow",permission:"admin/adCourse/edit",action:(e,t)=>{this.$refs.addDialog.edit(t)}},{key:"delete",title:"删除",permission:"admin/adCourse/remove",btnStyle:"red",action:(e,t)=>{this.handleDelete(t)}},{key:"charpter",title:"章节详情",permission:"admin/adCourseChapters/courseList",btnStyle:"yellow",action:(e,t)=>{this.$refs.chapters.open(t)}}],headerOperates:[{key:"el-icon-plus",name:"添加课程",permission:"admin/adCourse/add",action:()=>{this.$refs.addDialog.open()}}]}},computed:{hasLiveOptions(){return this.$refs.addDialog?this.$refs.addDialog.hasLiveOptions:[]}},mounted(){this.$watch(()=>this.$refs.addDialog.categoryOptions,e=>{this.filterOptions.column[2].options=e}),this.$watch(()=>this.$refs.addDialog.MealCategoryOptions,e=>{this.filterOptions.column[3].options=e})},created(){this.getList()},methods:{searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0,a["a"].post({url:"/admin/adCourse/list",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,...this.filterData},success:e=>{this.table.data=e.list,this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1}})},teacherRemoteMethod(e){e&&(this.remoteLoading=!0,a["a"].post({url:"/admin/adCourse/queryTeacherByNameOrTeacher",params:{keyword:e},success:e=>{this.remoteLoading=!1,this.teacherOptions=e},catch:()=>{this.remoteLoading=!1}}))},handleSuccess(){this.getList()},handleDelete(e){this.$confirm("此操作将会删除该课程, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/admin/adCourse/remove",params:{id:e.id},success:e=>{this.$message.success(e),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},clearFilter(){this.filterData={name:"",number:"",hasLive:"",teacherAdId:"",categoryId:"",hasFree:"",setMealCategoryId:""},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()},remoteMethod(e){e&&(this.remoteLoading=!0,a["a"].post({url:"/admin/adInfo/queryAdminByNameOrPhone",params:{search:e},success:e=>{this.remoteLoading=!1,this.supervisorAdOptions=e},catch:()=>{this.remoteLoading=!1}}))}}},d=c,f=(n("76d1"),n("1805")),h=Object(f["a"])(d,r,i,!1,null,"13a1a906",null);t["default"]=h.exports},"65b5":function(e,t,n){"use strict";n("a7c6")},"66c8":function(e,t,n){"use strict";t.decode=t.parse=n("bcd0"),t.encode=t.stringify=n("3167")},"68b9":function(e,t,n){"use strict";n("0554")},"68c6":function(e,t,n){"use strict";n("2acd")},"6a2e":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-drawer",{attrs:{visible:e.drawer,title:"详情"},on:{"update:visible":function(t){e.drawer=t}}},[t("el-descriptions",{staticClass:"margin-top",attrs:{column:1,border:""}},[t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" 课程名称 ")]),e._v(" "+e._s(e.info.courseName)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" 作业名称 ")]),e._v(" "+e._s(e.info.workName)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" 作业标题 ")]),e._v(" "+e._s(e.info.subWorkName)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" 讲师 ")]),e._v(" "+e._s(e.info.teacherName)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" 作业案例图 ")]),t("el-image",{staticStyle:{width:"100px"},attrs:{src:e.info.caseUrl,fit:"contain","preview-src-list":[e.info.caseUrl],lazy:!0}})],2),t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" 提交人 ")]),e._v(" "+e._s(e.info.vipName)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" 提交的作业 ")]),t("div",{staticStyle:{display:"flex",gap:"20px"}},e._l(e.info.workUrl,(function(n,r){return t("el-image",{key:r,staticStyle:{width:"100px"},attrs:{src:n,fit:"contain","preview-src-list":[e.info.workUrl],lazy:!0}})})),1)],2),e.info.comment?t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" 点评 ")]),e._v(" "+e._s(e.info.comment)+" ")],2):e._e()],1)],1)],1)},i=[],o={data(){return{drawer:!1,info:{}}},methods:{open(e){this.info=e,console.log(this.info),this.drawer=!0},close(){this.drawer=!1}}},a=o,s=n("1805"),l=Object(s["a"])(a,r,i,!1,null,"11073610",null);t["default"]=l.exports},"6a32":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.addModifyVisible,width:"70%"},on:{"update:visible":function(t){e.addModifyVisible=t},close:e.close}},[t("el-form",{ref:"courseRef",attrs:{model:e.addData,rules:e.courseRule,"label-position":"right","label-width":"140px"}},[t("el-form-item",{attrs:{label:"课程名称:",prop:"name"}},[t("jat-input",{attrs:{placeholder:"请输入课程名称"},model:{value:e.addData.name,callback:function(t){e.$set(e.addData,"name",t)},expression:"addData.name"}})],1),t("el-form-item",{attrs:{label:"课程类别:",prop:"categoryId"}},[t("jat-select",{attrs:{placeholder:"请选择课程类别",clearable:"",filterable:""},model:{value:e.addData.categoryId,callback:function(t){e.$set(e.addData,"categoryId",t)},expression:"addData.categoryId"}},e._l(e.categoryOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"成本价:",prop:"price"}},[t("jat-input",{directives:[{name:"input",rawName:"v-input.float",value:2,expression:"2",modifiers:{float:!0}}],attrs:{placeholder:"请输入成本价"},model:{value:e.addData.costPrice,callback:function(t){e.$set(e.addData,"costPrice",t)},expression:"addData.costPrice"}})],1),t("el-form-item",{attrs:{label:"市场价:",prop:"underlinedPrice"}},[t("jat-input",{directives:[{name:"input",rawName:"v-input.float",value:2,expression:"2",modifiers:{float:!0}}],attrs:{placeholder:"请输入市场价"},model:{value:e.addData.underlinedPrice,callback:function(t){e.$set(e.addData,"underlinedPrice",t)},expression:"addData.underlinedPrice"}})],1),t("div",{staticStyle:{width:"48%"}},[t("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"是否收费:",prop:"hasFree"}},[t("jat-select",{attrs:{placeholder:"请选择是否收费",clearable:""},on:{change:e.handleHasFreeChange},model:{value:e.addData.hasFree,callback:function(t){e.$set(e.addData,"hasFree",t)},expression:"addData.hasFree"}},e._l(e.hasFreeOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),1==e.addData.hasFree?t("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"课程价格:",prop:"price"}},[t("jat-input",{directives:[{name:"input",rawName:"v-input.float",value:2,expression:"2",modifiers:{float:!0}}],attrs:{placeholder:"请输入课程价格"},model:{value:e.addData.price,callback:function(t){e.$set(e.addData,"price",t)},expression:"addData.price"}})],1):e._e()],1),t("el-form-item",{attrs:{label:"封面:",prop:"image"}},[t("upload-image",{model:{value:e.addData.image,callback:function(t){e.$set(e.addData,"image",t)},expression:"addData.image"}})],1),t("el-form-item",{attrs:{label:"课程标签:",prop:"tag"}},[t("jat-select",{attrs:{placeholder:"请选择课程标签",clearable:""},on:{change:e.handleTagChange},model:{value:e.addData.tag,callback:function(t){e.$set(e.addData,"tag",t)},expression:"addData.tag"}},e._l(e.tagOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),0===e.addData.tag?t("el-form-item",{attrs:{label:"课程套餐:",prop:"setMealCategoryId"}},[t("jat-select",{attrs:{placeholder:"请输入课程套餐",clearable:"",filterable:""},model:{value:e.addData.setMealCategoryId,callback:function(t){e.$set(e.addData,"setMealCategoryId",t)},expression:"addData.setMealCategoryId"}},e._l(e.MealCategoryOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),t("el-form-item",{attrs:{label:"课程类型:",prop:"hasLive"}},[t("jat-select",{attrs:{placeholder:"请选择课程类型",clearable:""},model:{value:e.addData.hasLive,callback:function(t){e.$set(e.addData,"hasLive",t)},expression:"addData.hasLive"}},e._l(e.hasLiveOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"开播时间:",prop:"openLiveTime"}},[t("jat-date-picker",{attrs:{width:"100%",clearable:"",valueFormat:"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"请选择开播时间"},model:{value:e.addData.openLiveTime,callback:function(t){e.$set(e.addData,"openLiveTime",t)},expression:"addData.openLiveTime"}}),t("div",{staticClass:"wram-box"},[t("i",{staticClass:"el-icon-info"}),e._v("如果有直播频道号和直播回放链接，直播时间必填，正在直播会进行直播，没有直播会播放录播链接 ")])],1),t("el-form-item",{attrs:{label:"直播频道号:",prop:"channelNumber"}},[t("jat-input",{attrs:{placeholder:"请输入直播频道号"},on:{blur:e.handleCheck},model:{value:e.addData.channelNumber,callback:function(t){e.$set(e.addData,"channelNumber",t)},expression:"addData.channelNumber"}})],1),t("el-form-item",{attrs:{label:"直播回放链接:",prop:"livePlaybackUrl"}},[t("jat-input",{attrs:{placeholder:"请输入直播回放链接"},model:{value:e.addData.livePlaybackUrl,callback:function(t){e.$set(e.addData,"livePlaybackUrl",t)},expression:"addData.livePlaybackUrl"}}),t("uploadFile",{attrs:{limit:1,accept:".mp4",valueType:"string"},model:{value:e.addData.livePlaybackUrl,callback:function(t){e.$set(e.addData,"livePlaybackUrl",t)},expression:"addData.livePlaybackUrl"}}),t("div",{staticClass:"wram-box"},[t("i",{staticClass:"el-icon-info"}),e._v("直播有回放链接先放回放链接，没有则播放录播链接 ")])],1),t("el-form-item",{attrs:{label:"录播链接:",prop:"recordLiveUrl"}},[t("jat-input",{attrs:{placeholder:"请输入录播链接"},model:{value:e.addData.recordLiveUrl,callback:function(t){e.$set(e.addData,"recordLiveUrl",t)},expression:"addData.recordLiveUrl"}}),t("uploadFile",{attrs:{valueType:"string",accept:".mp4",limit:1},model:{value:e.addData.recordLiveUrl,callback:function(t){e.$set(e.addData,"recordLiveUrl",t)},expression:"addData.recordLiveUrl"}}),t("div",{staticClass:"wram-box"},[t("i",{staticClass:"el-icon-info"}),e._v("课程类型为录播时需上传该录播链接 ")])],1),t("el-form-item",{attrs:{label:"课程描述:",prop:"overview"}},[t("jat-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入课程描述"},model:{value:e.addData.overview,callback:function(t){e.$set(e.addData,"overview",t)},expression:"addData.overview"}})],1),t("el-form-item",{attrs:{label:"SEO标题:",prop:"seoTitle"}},[t("jat-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入SEO标题"},model:{value:e.addData.seoTitle,callback:function(t){e.$set(e.addData,"seoTitle",t)},expression:"addData.seoTitle"}})],1),t("el-form-item",{attrs:{label:"SEO关键字:",prop:"seoKey"}},[t("jat-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入SEO关键字"},model:{value:e.addData.seoKey,callback:function(t){e.$set(e.addData,"seoKey",t)},expression:"addData.seoKey"}})],1),t("el-form-item",{attrs:{label:"SEO描述:",prop:"seoContent"}},[t("jat-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入SEO关键字"},model:{value:e.addData.seoContent,callback:function(t){e.$set(e.addData,"seoContent",t)},expression:"addData.seoContent"}})],1),t("el-form-item",{attrs:{label:"讲师:",prop:"teacherAdId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",clearable:"",filterable:"",remote:"",placeholder:"请选择讲师","remote-method":e.teacherRemoteMethod,loading:e.remoteLoading},model:{value:e.addData.teacherAdId,callback:function(t){e.$set(e.addData,"teacherAdId",t)},expression:"addData.teacherAdId"}},e._l(e.teacherOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"排序:",prop:"sort"}},[t("jat-input",{directives:[{name:"input",rawName:"v-input.int",modifiers:{int:!0}}],attrs:{placeholder:"请输入排序"},model:{value:e.addData.sort,callback:function(t){e.$set(e.addData,"sort",t)},expression:"addData.sort"}})],1),t("el-form-item",{attrs:{label:"发布者:",prop:"createAdId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",clearable:"",filterable:"",remote:"",placeholder:"默认为登录账户","remote-method":e.remoteMethod,loading:e.remoteLoading},model:{value:e.addData.createAdId,callback:function(t){e.$set(e.addData,"createAdId",t)},expression:"addData.createAdId"}},e._l(e.parentAdIdOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"推荐位:",prop:"position"}},[t("jat-select",{attrs:{placeholder:"请选择推荐位置",clearable:""},model:{value:e.addData.position,callback:function(t){e.$set(e.addData,"position",t)},expression:"addData.position"}},e._l(e.positionptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"查看数:",prop:"readCount"}},[t("jat-input",{directives:[{name:"input",rawName:"v-input.int",modifiers:{int:!0}}],attrs:{placeholder:"请输入查看数"},model:{value:e.addData.readCount,callback:function(t){e.$set(e.addData,"readCount",t)},expression:"addData.readCount"}})],1),t("el-form-item",{attrs:{label:"是否展示在官网(h5):",prop:"showOfficialWebsite"}},[t("jat-select",{attrs:{placeholder:"请选择是否展示在官网(h5)",clearable:""},model:{value:e.addData.showOfficialWebsite,callback:function(t){e.$set(e.addData,"showOfficialWebsite",t)},expression:"addData.showOfficialWebsite"}},e._l(e.showOfficialWebsiteOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"课程详情:",prop:"content"}},[t("tinymce-edit",{model:{value:e.addData.content,callback:function(t){e.$set(e.addData,"content",t)},expression:"addData.content"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)],1)},i=[],o=(n("7cfc"),n("c46c")),a=n("cbc3"),s=n("b775"),l=n("9adf"),u=n("b893"),c=n("d17b"),d={components:{uploadFile:o["a"],uploadImage:a["a"],tinymceEdit:l["a"]},data(){return{addModifyVisible:!1,remoteLoading:!1,recordLiveUrlPer:0,teacherOptions:[],categoryOptions:[],MealCategoryOptions:[],positionptions:c["c"],tagOptions:c["e"],hasLiveOptions:c["b"],hasFreeOptions:c["a"],showOfficialWebsiteOptions:c["d"],dialogTitle:"",addData:{id:"",name:"",categoryId:"",content:"",createAdId:"",hasFree:"",hasLive:"",image:"",livePlaybackUrl:"",openLiveTime:"",overview:"",position:"",price:0,readCount:"",recordLiveUrl:"",remark:"",seoContent:"",seoKey:"",seoTitle:"",setMealCategoryId:"",sort:255,tag:"",teacherAdId:"",underlinedPrice:"",costPrice:"",showOfficialWebsite:""},parentAdIdOptions:[],courseRule:{name:[{required:!0,message:"请输入课程名称",trigger:"blur"}],hasFree:[{required:!0,message:"请输入选择是否免费",trigger:"blur"}],openLiveTime:[{validator:(e,t,n)=>{this.addData.channelNumber&&this.addData.livePlaybackUrl&&!t?n(new Error("请输入开播时间")):n()},trigger:"blur"}],hasLive:[{required:!0,message:"请输入选择是否直播",trigger:"blur"}],costPrice:[{required:!0,message:"请输入成本价",trigger:"blur"}],image:[{required:!0,message:"请上传封面",trigger:"blur"}],price:[{required:!0,message:"请输入价格",trigger:"blur"}],tag:[{required:!0,message:"请输入课程标签",trigger:"blur"}],teacherAdId:[{required:!0,message:"请选择讲师",trigger:"blur"}]}}},mounted(){this.getCurrentUser(),this.getCategoryList(),this.getMealCategoryList()},methods:{open(){this.dialogTitle="添加课程",this.addModifyVisible=!0},edit({id:e,name:t,categoryId:n,content:r,createAdId:i,hasFree:o,hasLive:a,image:s,livePlaybackUrl:l,openLive:c,overview:d,position:f,price:h,readCount:m,recordLiveUrl:p,remark:g,seoContent:v,seoKey:b,seoTitle:y,setMealCategoryId:w,sort:S,tag:x,teacherAdId:C,underlinedPrice:T,costPrice:D,teacherName:k,showOfficialWebsite:E}){this.dialogTitle="编辑课程",this.addModifyVisible=!0,this.addData={id:e,name:t,categoryId:n,content:r,createAdId:i,hasFree:o,hasLive:a,image:s,livePlaybackUrl:l,openLiveTime:Object(u["b"])(c,"yyyy-MM-dd HH:mm:ss"),overview:d,position:f,price:h,readCount:m,recordLiveUrl:p,underlinedPrice:T,costPrice:D,remark:g,seoContent:v,seoKey:b,seoTitle:y,setMealCategoryId:w,sort:S,tag:x,teacherAdId:C,showOfficialWebsite:E},this.teacherOptions=[{id:C,name:k}]},close(){this.$refs.courseRef&&this.$refs.courseRef.clearValidate(),this.addData={id:"",name:"",categoryId:"",content:"",createAdId:"",hasFree:"",hasLive:"",image:"",livePlaybackUrl:"",openLiveTime:"",overview:"",position:"",price:"",readCount:"",recordLiveUrl:"",remark:"",seoContent:"",seoKey:"",seoTitle:"",setMealCategoryId:"",underlinedPrice:"",costPrice:"",sort:255,tag:"",teacherAdId:"",showOfficialWebsite:""},this.addModifyVisible=!1},getCurrentUser(){this.parentAdIdOptions=[{id:sessionStorage.getItem("id")?parseInt(sessionStorage.getItem("id")):"",name:sessionStorage.getItem("userName")}],this.addData.createAdId=parseInt(sessionStorage.getItem("id"))},handleCheck(){this.$refs.courseRef&&this.$refs.courseRef.validateField("openLiveTime")},handleSubmit(){this.$refs.courseRef.validate(e=>{const{id:t,...n}=this.addData;e&&(t?s["a"].post({url:"/admin/adCourse/edit",params:{id:t,...n},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}):s["a"].post({url:"/admin/adCourse/add",params:{...n},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}))})},getCategoryList(){s["a"].post({url:"system/sysCategory/listNoPage",params:{type:2},success:e=>{this.categoryOptions=e}})},getMealCategoryList(){s["a"].post({url:"system/sysCategory/listNoPage",params:{type:4},success:e=>{this.MealCategoryOptions=e}})},remoteMethod(e){e&&(this.remoteLoading=!0,s["a"].post({url:"/admin/adInfo/queryAdminByNameOrPhone",params:{search:e},success:e=>{this.remoteLoading=!1,this.parentAdIdOptions=e},catch:()=>{this.remoteLoading=!1}}))},handleHasFreeChange(e){this.addData.price=e?"":0},handleTagChange(){this.addData.setMealCategoryId=""},teacherRemoteMethod(e,t){e&&(this.remoteLoading=!0,s["a"].post({url:"/admin/adCourse/queryTeacherByNameOrTeacher",params:{keyword:e},success:e=>{this.remoteLoading=!1,this.teacherOptions=e},catch:()=>{this.remoteLoading=!1}}))}},watch:{"addData.livePlaybackUrl":{handler(){this.handleCheck()}}}},f=d,h=(n("f10b"),n("1805")),m=Object(h["a"])(f,r,i,!1,null,"079d0727",null);t["default"]=m.exports},"6bbf":function(e,t,n){},"6c77":function(e,t,n){},"6f7e":function(e,t,n){},"6fdf":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"章节列表",width:"60%",visible:e.chaptersVisible},on:{"update:visible":function(t){e.chaptersVisible=t}}},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"max-height":"500px"}},[t("BasicTable",{attrs:{columns:e.table.columns,height:"400px",operates:e.isWrite?e.operates:void 0,operateWidth:"130px",hasCard:!1,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,headerOperates:e.isWrite?e.headerOperates:void 0,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange}}),t("addChapters",{ref:"addChatptersDialog",on:{success:e.handleSuccess}})],1)])},i=[],o=n("7591"),a=n("b775"),s=(n("d17b"),n("7d95")),l=n("101b"),u={props:{isWrite:{type:Boolean,default:!0}},name:"chaptersPage",components:{BasicTable:o["a"],addChapters:l["default"],uploadVideo:s["default"]},data(){return{loading:!1,chaptersVisible:!1,remoteLoading:!1,openLiveVisible:!1,openLiveData:{},supervisorAdOptions:[],categoryOptions:[],filterOptions:{column:[]},remoteLoading:!1,teacherOptions:[],filterData:{id:""},table:{columns:[{id:1,prop:"name",label:"章节名称"},{id:2,type:"image",prop:"image",label:"封面"},{id:3,prop:"url",type:"video",label:"视频"},{id:4,prop:"lengthTime",label:"视频时长"}],pageSize:20,currentPage:1,data:[],total:0},operates:[{key:"edit",title:"编辑",permission:"admin/adCourseChapters/uploadCourseEdit",btnStyle:"yellow",action:(e,t)=>{this.$refs.addChatptersDialog.edit(t,this.filterData.id)}},{key:"delete",title:"删除",permission:"admin/adCourseChapters/remove",btnStyle:"red",action:(e,t)=>{this.handleDelete(t)}}],headerOperates:[{key:"el-icon-plus",name:"添加章节",permission:"admin/adCourseChapters/uploadCourseAdd",action:()=>{this.$refs.addChatptersDialog.open(this.filterData.id)}}]}},computed:{hasLiveOptions(){return this.$refs.addDialog?this.$refs.addDialog.hasLiveOptions:[]}},mounted(){},created(){},methods:{open(e){this.chaptersVisible=!0,this.filterData.id=e.id,this.getList()},searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0,a["a"].post({url:"/admin/adCourseChapters/courseList",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,...this.filterData},success:e=>{this.table.data=e.list,this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1}})},handleSuccess(){this.getList()},onCopy(){this.$message.success("复制成功")},handleClose(){this.openLiveData={}},clearFilter(){this.filterData={id:""},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()},handleDelete(e){this.$confirm("此操作将会删除该章节, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/admin/adCourseChapters/remove",params:{id:e.id},success:e=>{this.$message.success(e),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})}}},c=u,d=(n("43b6"),n("1805")),f=Object(d["a"])(c,r,i,!1,null,"6429c60e",null);t["default"]=f.exports},7205:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}),t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,operates:e.operates,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange},scopedSlots:e._u([{key:"image",fn:function(e){return t("div",{},[e.row.image?t("el-image",{staticStyle:{width:"50px"},attrs:{src:e.row.image,"preview-src-list":[e.row.image]}}):t("span")],1)}}])}),t("add-dialog",{ref:"addDialog",on:{success:e.handleSuccess}})],1)},i=[],o=n("7591"),a=n("b775"),s=n("c145"),l=n("b893"),u={name:"adverstPage",components:{BasicTable:o["a"],addDialog:s["default"]},data(){return{loading:!1,categoryOptions:[],filterOptions:{column:[{type:"input",label:"新闻名称",value:"name"},{type:"cascader",label:"新闻分类",value:"categoryId",options:[],props:{value:"id",label:"name",emitPath:!1}}]},filterData:{categoryId:"",name:""},table:{columns:[{id:1,prop:"name",label:"新闻名称"},{id:2,prop:"advertiseCategoryId",label:"新闻分类",render:e=>this.categoryOptions.find(t=>t.id==e.categoryId)["name"]},{id:3,prop:"image",label:"新闻图片",renderName:"image"},{id:4,prop:"sort",label:"排序"},{id:5,prop:"createTime",label:"创建时间",type:"date"}],pageSize:20,currentPage:1,data:[],total:0},operates:[{key:"edit",title:"编辑",btnStyle:"yellow",permission:"system/sysNews/edit",action:(e,t)=>{this.$refs.addDialog.edit(t)}},{key:"delete",title:"删除",btnStyle:"red",permission:"system/sysNews/remove",action:(e,t)=>{this.handleDelete(t)}}],headerOperates:[{key:"el-icon-plus",permission:"system/sysNews/add",name:"添加新闻",action:()=>{this.$refs.addDialog.open()}}]}},created(){this.getList(),this.getCategoryList()},methods:{searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0,a["a"].post({url:"/system/sysNews/list",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,...this.filterData},success:e=>{this.table.data=e.list,this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1}})},getCategoryList(){a["a"].post({url:"/system/sysNewsCategory/listNoPage",params:{...this.addData},success:e=>{this.categoryOptions=e,this.filterOptions.column[1].options=Object(l["c"])(e)}})},handleSuccess(){this.getList()},handleDelete(e){this.$confirm("此操作将会删除该新闻, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/system/sysNews/remove",params:{id:e.id},success:e=>{this.$message.success(e),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},clearFilter(){this.filterData={name:""},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()}}},c=u,d=(n("d059"),n("1805")),f=Object(d["a"])(c,r,i,!1,null,"566794f5",null);t["default"]=f.exports},7317:function(e,t,n){},"734a":function(e,t){(function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=function(){return t=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},t.apply(this,arguments)},n=function(e){var t=typeof e;return null===e?"null":"object"===t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t},r=function(e){return function(t){return n(t)===e}},i=function(e){return function(t){return typeof t===e}},o=function(e){return function(t){return e===t}},a=r("string"),s=r("object"),l=r("array"),u=o(null),c=i("boolean"),d=function(e){return null===e||void 0===e},f=function(e){return!d(e)},h=i("function"),m=i("number"),p=function(){},g=function(e){return function(){return e}},v=function(e){return e},b=g(!1),y=g(!0),w=function(){return S},S=function(){var e=function(e){return e()},t=v,n={fold:function(e,t){return e()},isSome:b,isNone:y,getOr:t,getOrThunk:e,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:g(null),getOrUndefined:g(void 0),or:t,orThunk:e,map:w,each:p,bind:w,exists:b,forall:y,filter:function(){return w()},toArray:function(){return[]},toString:g("none()")};return n}(),x=function(e){var t=g(e),n=function(){return i},r=function(t){return t(e)},i={fold:function(t,n){return n(e)},isSome:y,isNone:b,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return x(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?i:S},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return i},C=function(e){return null===e||void 0===e?S:x(e)},T={some:x,none:w,from:C},D=Object.keys,k=Object.hasOwnProperty,E=function(e,t){for(var n=D(e),r=0,i=n.length;r<i;r++){var o=n[r],a=e[o];t(a,o)}},_=function(e){return function(t,n){e[n]=t}},A=function(e,t,n,r){var i={};return E(e,(function(e,i){(t(e,i)?n:r)(e,i)})),i},L=function(e,t){var n={};return A(e,t,_(n),p),n},O=function(e,t){return k.call(e,t)},R=function(e,t){return O(e,t)&&void 0!==e[t]&&null!==e[t]},I=Array.prototype.push,P=function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!l(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);I.apply(t,e[n])}return t},M=function(e,t){return t>=0&&t<e.length?T.some(e[t]):T.none()},N=function(e){return M(e,0)},F=function(e,t){for(var n=0;n<e.length;n++){var r=t(e[n],n);if(r.isSome())return r}return T.none()};"undefined"!==typeof window?window:Function("return this;")();var B=function(e,t,n){if(!(a(n)||c(n)||m(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},$=function(e,t,n){B(e.dom,t,n)},z=function(e,t){e.dom.removeAttribute(t)},U=function(e,t){var n=t||document,r=n.createElement("div");if(r.innerHTML=e,!r.hasChildNodes()||r.childNodes.length>1)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return j(r.childNodes[0])},V=function(e,t){var n=t||document,r=n.createElement(e);return j(r)},H=function(e,t){var n=t||document,r=n.createTextNode(e);return j(r)},j=function(e){if(null===e||void 0===e)throw new Error("Node cannot be null or undefined");return{dom:e}},q=function(e,t,n){return T.from(e.dom.elementFromPoint(t,n)).map(j)},G={fromHtml:U,fromTag:V,fromText:H,fromDom:j,fromPoint:q},W=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),K=tinymce.util.Tools.resolve("tinymce.util.Promise"),Y=tinymce.util.Tools.resolve("tinymce.util.URI"),X=tinymce.util.Tools.resolve("tinymce.util.XHR"),J=function(e){return e.getParam("image_dimensions",!0,"boolean")},Q=function(e){return e.getParam("image_advtab",!1,"boolean")},Z=function(e){return e.getParam("image_uploadtab",!0,"boolean")},ee=function(e){return e.getParam("image_prepend_url","","string")},te=function(e){return e.getParam("image_class_list")},ne=function(e){return e.getParam("image_description",!0,"boolean")},re=function(e){return e.getParam("image_title",!1,"boolean")},ie=function(e){return e.getParam("image_caption",!1,"boolean")},oe=function(e){return e.getParam("image_list",!1)},ae=function(e){return f(e.getParam("images_upload_url"))},se=function(e){return f(e.getParam("images_upload_handler"))},le=function(e){return e.getParam("a11y_advanced_options",!1,"boolean")},ue=function(e){return e.getParam("automatic_uploads",!0,"boolean")},ce=function(e,t){return Math.max(parseInt(e,10),parseInt(t,10))},de=function(e){return new K((function(t){var n=document.createElement("img"),r=function(e){n.onload=n.onerror=null,n.parentNode&&n.parentNode.removeChild(n),t(e)};n.onload=function(){var e=ce(n.width,n.clientWidth),t=ce(n.height,n.clientHeight),i={width:e,height:t};r(K.resolve(i))},n.onerror=function(){r(K.reject("Failed to get image dimensions for: "+e))};var i=n.style;i.visibility="hidden",i.position="fixed",i.bottom=i.left="0px",i.width=i.height="auto",document.body.appendChild(n),n.src=e}))},fe=function(e){return e&&(e=e.replace(/px$/,"")),e},he=function(e){return e.length>0&&/^[0-9]+$/.test(e)&&(e+="px"),e},me=function(e){if(e.margin){var t=String(e.margin).split(" ");switch(t.length){case 1:e["margin-top"]=e["margin-top"]||t[0],e["margin-right"]=e["margin-right"]||t[0],e["margin-bottom"]=e["margin-bottom"]||t[0],e["margin-left"]=e["margin-left"]||t[0];break;case 2:e["margin-top"]=e["margin-top"]||t[0],e["margin-right"]=e["margin-right"]||t[1],e["margin-bottom"]=e["margin-bottom"]||t[0],e["margin-left"]=e["margin-left"]||t[1];break;case 3:e["margin-top"]=e["margin-top"]||t[0],e["margin-right"]=e["margin-right"]||t[1],e["margin-bottom"]=e["margin-bottom"]||t[2],e["margin-left"]=e["margin-left"]||t[1];break;case 4:e["margin-top"]=e["margin-top"]||t[0],e["margin-right"]=e["margin-right"]||t[1],e["margin-bottom"]=e["margin-bottom"]||t[2],e["margin-left"]=e["margin-left"]||t[3]}delete e.margin}return e},pe=function(e,t){var n=oe(e);a(n)?X.send({url:n,success:function(e){t(JSON.parse(e))}}):h(n)?n(t):t(n)},ge=function(e,t,n){var r=function(){n.onload=n.onerror=null,e.selection&&(e.selection.select(n),e.nodeChanged())};n.onload=function(){t.width||t.height||!J(e)||e.dom.setAttribs(n,{width:String(n.clientWidth),height:String(n.clientHeight)}),r()},n.onerror=r},ve=function(e){return new K((function(t,n){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=function(){n(r.error.message)},r.readAsDataURL(e)}))},be=function(e){return"IMG"===e.nodeName&&(e.hasAttribute("data-mce-object")||e.hasAttribute("data-mce-placeholder"))},ye=function(e,t){return Y.isDomSafe(t,"img",e.settings)},we=W.DOM,Se=function(e){return e.style.marginLeft&&e.style.marginRight&&e.style.marginLeft===e.style.marginRight?fe(e.style.marginLeft):""},xe=function(e){return e.style.marginTop&&e.style.marginBottom&&e.style.marginTop===e.style.marginBottom?fe(e.style.marginTop):""},Ce=function(e){return e.style.borderWidth?fe(e.style.borderWidth):""},Te=function(e,t){return e.hasAttribute(t)?e.getAttribute(t):""},De=function(e,t){return e.style[t]?e.style[t]:""},ke=function(e){return null!==e.parentNode&&"FIGURE"===e.parentNode.nodeName},Ee=function(e,t,n){""===n?e.removeAttribute(t):e.setAttribute(t,n)},_e=function(e){var t=we.create("figure",{class:"image"});we.insertAfter(t,e),t.appendChild(e),t.appendChild(we.create("figcaption",{contentEditable:"true"},"Caption")),t.contentEditable="false"},Ae=function(e){var t=e.parentNode;we.insertAfter(e,t),we.remove(t)},Le=function(e){ke(e)?Ae(e):_e(e)},Oe=function(e,t){var n=e.getAttribute("style"),r=t(null!==n?n:"");r.length>0?(e.setAttribute("style",r),e.setAttribute("data-mce-style",r)):e.removeAttribute("style")},Re=function(e,t){return function(e,n,r){e.style[n]?(e.style[n]=he(r),Oe(e,t)):Ee(e,n,r)}},Ie=function(e,t){return e.style[t]?fe(e.style[t]):Te(e,t)},Pe=function(e,t){var n=he(t);e.style.marginLeft=n,e.style.marginRight=n},Me=function(e,t){var n=he(t);e.style.marginTop=n,e.style.marginBottom=n},Ne=function(e,t){var n=he(t);e.style.borderWidth=n},Fe=function(e,t){e.style.borderStyle=t},Be=function(e){return De(e,"borderStyle")},$e=function(e){return"FIGURE"===e.nodeName},ze=function(e){return"IMG"===e.nodeName},Ue=function(e){return 0===we.getAttrib(e,"alt").length&&"presentation"===we.getAttrib(e,"role")},Ve=function(e){return Ue(e)?"":Te(e,"alt")},He=function(){return{src:"",alt:"",title:"",width:"",height:"",class:"",style:"",caption:!1,hspace:"",vspace:"",border:"",borderStyle:"",isDecorative:!1}},je=function(e,t){var n=document.createElement("img");return Ee(n,"style",t.style),(Se(n)||""!==t.hspace)&&Pe(n,t.hspace),(xe(n)||""!==t.vspace)&&Me(n,t.vspace),(Ce(n)||""!==t.border)&&Ne(n,t.border),(Be(n)||""!==t.borderStyle)&&Fe(n,t.borderStyle),e(n.getAttribute("style"))},qe=function(e,n){var r=document.createElement("img");if(Je(e,t(t({},n),{caption:!1}),r),Ke(r,n.alt,n.isDecorative),n.caption){var i=we.create("figure",{class:"image"});return i.appendChild(r),i.appendChild(we.create("figcaption",{contentEditable:"true"},"Caption")),i.contentEditable="false",i}return r},Ge=function(e,t){return{src:Te(t,"src"),alt:Ve(t),title:Te(t,"title"),width:Ie(t,"width"),height:Ie(t,"height"),class:Te(t,"class"),style:e(Te(t,"style")),caption:ke(t),hspace:Se(t),vspace:xe(t),border:Ce(t),borderStyle:De(t,"borderStyle"),isDecorative:Ue(t)}},We=function(e,t,n,r,i){n[r]!==t[r]&&i(e,r,n[r])},Ke=function(e,t,n){if(n){we.setAttrib(e,"role","presentation");var r=G.fromDom(e);$(r,"alt","")}else{if(u(t)){r=G.fromDom(e);z(r,"alt")}else{r=G.fromDom(e);$(r,"alt",t)}"presentation"===we.getAttrib(e,"role")&&we.setAttrib(e,"role","")}},Ye=function(e,t,n){n.alt===t.alt&&n.isDecorative===t.isDecorative||Ke(e,n.alt,n.isDecorative)},Xe=function(e,t){return function(n,r,i){e(n,i),Oe(n,t)}},Je=function(e,t,n){var r=Ge(e,n);We(n,r,t,"caption",(function(e,t,n){return Le(e)})),We(n,r,t,"src",Ee),We(n,r,t,"title",Ee),We(n,r,t,"width",Re("width",e)),We(n,r,t,"height",Re("height",e)),We(n,r,t,"class",Ee),We(n,r,t,"style",Xe((function(e,t){return Ee(e,"style",t)}),e)),We(n,r,t,"hspace",Xe(Pe,e)),We(n,r,t,"vspace",Xe(Me,e)),We(n,r,t,"border",Xe(Ne,e)),We(n,r,t,"borderStyle",Xe(Fe,e)),Ye(n,r,t)},Qe=function(e,t){var n=e.dom.styles.parse(t),r=me(n),i=e.dom.styles.parse(e.dom.styles.serialize(r));return e.dom.styles.serialize(i)},Ze=function(e){var t=e.selection.getNode(),n=e.dom.getParent(t,"figure.image");return n?e.dom.select("img",n)[0]:t&&("IMG"!==t.nodeName||be(t))?null:t},et=function(e,t){var n=e.dom,r=L(e.schema.getTextBlockElements(),(function(t,n){return!e.schema.isValidChild(n,"figure")})),i=n.getParent(t.parentNode,(function(e){return R(r,e.nodeName)}),e.getBody());return i?n.split(i,t):t},tt=function(e){var t=Ze(e);return t?Ge((function(t){return Qe(e,t)}),t):He()},nt=function(e,t){var n=qe((function(t){return Qe(e,t)}),t);e.dom.setAttrib(n,"data-mce-id","__mcenew"),e.focus(),e.selection.setContent(n.outerHTML);var r=e.dom.select('*[data-mce-id="__mcenew"]')[0];if(e.dom.setAttrib(r,"data-mce-id",null),$e(r)){var i=et(e,r);e.selection.select(i)}else e.selection.select(r)},rt=function(e,t){e.dom.setAttrib(t,"src",t.getAttribute("src"))},it=function(e,t){if(t){var n=e.dom.is(t.parentNode,"figure.image")?t.parentNode:t;e.dom.remove(n),e.focus(),e.nodeChanged(),e.dom.isEmpty(e.getBody())&&(e.setContent(""),e.selection.setCursorLocation())}},ot=function(e,t){var n=Ze(e);if(Je((function(t){return Qe(e,t)}),t,n),rt(e,n),$e(n.parentNode)){var r=n.parentNode;et(e,r),e.selection.select(n.parentNode)}else e.selection.select(n),ge(e,t,n)},at=function(e,n){var r=n.src;return t(t({},n),{src:ye(e,r)?r:""})},st=function(e,n){var r=Ze(e);if(r){var i=Ge((function(t){return Qe(e,t)}),r),o=t(t({},i),n),a=at(e,o);o.src?ot(e,a):it(e,r)}else n.src&&nt(e,t(t({},He()),n))},lt=function(e,t){var n=s(e)&&s(t);return n?ct(e,t):t},ut=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Can't merge zero objects");for(var r={},i=0;i<t.length;i++){var o=t[i];for(var a in o)O(o,a)&&(r[a]=e(r[a],o[a]))}return r}},ct=ut(lt),dt=function(e){return e.length>0},ft=tinymce.util.Tools.resolve("tinymce.util.ImageUploader"),ht=tinymce.util.Tools.resolve("tinymce.util.Tools"),mt=function(e){return a(e.value)?e.value:""},pt=function(e){return a(e.text)?e.text:a(e.title)?e.title:""},gt=function(e,t){var n=[];return ht.each(e,(function(e){var r=pt(e);if(void 0!==e.menu){var i=gt(e.menu,t);n.push({text:r,items:i})}else{var o=t(e);n.push({text:r,value:o})}})),n},vt=function(e){return void 0===e&&(e=mt),function(t){return t?T.from(t).map((function(t){return gt(t,e)})):T.none()}},bt=function(e){return vt(mt)(e)},yt=function(e){return O(e,"items")},wt=function(e,t){return F(e,(function(e){return yt(e)?wt(e.items,t):e.value===t?T.some(e):T.none()}))},St=function(e,t){return e.bind((function(e){return wt(e,t)}))},xt={sanitizer:vt,sanitize:bt,findEntry:St},Ct=function(e){return{title:"Advanced",name:"advanced",items:[{type:"input",label:"Style",name:"style"},{type:"grid",columns:2,items:[{type:"input",label:"Vertical space",name:"vspace",inputMode:"numeric"},{type:"input",label:"Horizontal space",name:"hspace",inputMode:"numeric"},{type:"input",label:"Border width",name:"border",inputMode:"numeric"},{type:"listbox",name:"borderstyle",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]}]}]}},Tt={makeTab:Ct},Dt=function(e){var t=xt.sanitizer((function(t){return e.convertURL(t.value||t.url,"src")})),n=new K((function(n){pe(e,(function(e){n(t(e).map((function(e){return P([[{text:"None",value:""}],e])})))}))})),r=xt.sanitize(te(e)),i=Q(e),o=Z(e),s=ae(e),l=se(e),u=tt(e),c=ne(e),d=re(e),f=J(e),h=ie(e),m=le(e),p=ue(e),g=T.some(ee(e)).filter((function(e){return a(e)&&e.length>0}));return n.then((function(e){return{image:u,imageList:e,classList:r,hasAdvTab:i,hasUploadTab:o,hasUploadUrl:s,hasUploadHandler:l,hasDescription:c,hasImageTitle:d,hasDimensions:f,hasImageCaption:h,prependURL:g,hasAccessibilityOptions:m,automaticUploads:p}}))},kt=function(e){var n={name:"src",type:"urlinput",filetype:"image",label:"Source"},r=e.imageList.map((function(e){return{name:"images",type:"listbox",label:"Image list",items:e}})),i={name:"alt",type:"input",label:"Alternative description",disabled:e.hasAccessibilityOptions&&e.image.isDecorative},o={name:"title",type:"input",label:"Image title"},a={name:"dimensions",type:"sizeinput"},s={type:"label",label:"Accessibility",items:[{name:"isDecorative",type:"checkbox",label:"Image is decorative"}]},l=e.classList.map((function(e){return{name:"classes",type:"listbox",label:"Class",items:e}})),u={type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]},c=function(e){return e?{type:"grid",columns:2}:{type:"panel"}};return P([[n],r.toArray(),e.hasAccessibilityOptions&&e.hasDescription?[s]:[],e.hasDescription?[i]:[],e.hasImageTitle?[o]:[],e.hasDimensions?[a]:[],[t(t({},c(e.classList.isSome()&&e.hasImageCaption)),{items:P([l.toArray(),e.hasImageCaption?[u]:[]])})]])},Et=function(e){return{title:"General",name:"general",items:kt(e)}},_t={makeTab:Et,makeItems:kt},At=function(e){var t=[{type:"dropzone",name:"fileinput"}];return{title:"Upload",name:"upload",items:t}},Lt={makeTab:At},Ot=function(e){return{prevImage:xt.findEntry(e.imageList,e.image.src),prevAlt:e.image.alt,open:!0}},Rt=function(e){return{src:{value:e.src,meta:{}},images:e.src,alt:e.alt,title:e.title,dimensions:{width:e.width,height:e.height},classes:e.class,caption:e.caption,style:e.style,vspace:e.vspace,border:e.border,hspace:e.hspace,borderstyle:e.borderStyle,fileinput:[],isDecorative:e.isDecorative}},It=function(e,t){return{src:e.src.value,alt:0===e.alt.length&&t?null:e.alt,title:e.title,width:e.dimensions.width,height:e.dimensions.height,class:e.classes,style:e.style,caption:e.caption,hspace:e.hspace,vspace:e.vspace,border:e.border,borderStyle:e.borderstyle,isDecorative:e.isDecorative}},Pt=function(e,t){return/^(?:[a-zA-Z]+:)?\/\//.test(t)?T.none():e.prependURL.bind((function(e){return t.substring(0,e.length)!==e?T.some(e+t):T.none()}))},Mt=function(e,t){var n=t.getData();Pt(e,n.src.value).each((function(e){t.setData({src:{value:e,meta:n.src.meta}})}))},Nt=function(e,t,n){e.hasDescription&&a(n.alt)&&(t.alt=n.alt),e.hasAccessibilityOptions&&(t.isDecorative=n.isDecorative||t.isDecorative||!1),e.hasImageTitle&&a(n.title)&&(t.title=n.title),e.hasDimensions&&(a(n.width)&&(t.dimensions.width=n.width),a(n.height)&&(t.dimensions.height=n.height)),a(n.class)&&xt.findEntry(e.classList,n.class).each((function(e){t.classes=e.value})),e.hasImageCaption&&c(n.caption)&&(t.caption=n.caption),e.hasAdvTab&&(a(n.style)&&(t.style=n.style),a(n.vspace)&&(t.vspace=n.vspace),a(n.border)&&(t.border=n.border),a(n.hspace)&&(t.hspace=n.hspace),a(n.borderstyle)&&(t.borderstyle=n.borderstyle))},Ft=function(e,t){var n=t.getData(),r=n.src.meta;if(void 0!==r){var i=ct({},n);Nt(e,i,r),t.setData(i)}},Bt=function(e,t,n,r){var i=r.getData(),o=i.src.value,a=i.src.meta||{};a.width||a.height||!t.hasDimensions||(dt(o)?e.imageSize(o).then((function(e){n.open&&r.setData({dimensions:e})})).catch((function(e){return console.error(e)})):r.setData({dimensions:{width:"",height:""}}))},$t=function(e,t,n){var r=n.getData(),i=xt.findEntry(e.imageList,r.src.value);t.prevImage=i,n.setData({images:i.map((function(e){return e.value})).getOr("")})},zt=function(e,t,n,r){Mt(t,r),Ft(t,r),Bt(e,t,n,r),$t(t,n,r)},Ut=function(e,t,n,r){var i=r.getData(),o=xt.findEntry(t.imageList,i.images);o.each((function(e){var t=""===i.alt||n.prevImage.map((function(e){return e.text===i.alt})).getOr(!1);t?""===e.value?r.setData({src:e,alt:n.prevAlt}):r.setData({src:e,alt:e.text}):r.setData({src:e})})),n.prevImage=o,zt(e,t,n,r)},Vt=function(e){var t=e["margin-top"]&&e["margin-bottom"]&&e["margin-top"]===e["margin-bottom"];return t?fe(String(e["margin-top"])):""},Ht=function(e){var t=e["margin-right"]&&e["margin-left"]&&e["margin-right"]===e["margin-left"];return t?fe(String(e["margin-right"])):""},jt=function(e){return e["border-width"]?fe(String(e["border-width"])):""},qt=function(e){return e["border-style"]?String(e["border-style"]):""},Gt=function(e,t,n){return t(e(t(n)))},Wt=function(e,t,n){var r=me(e(n.style)),i=ct({},n);return i.vspace=Vt(r),i.hspace=Ht(r),i.border=jt(r),i.borderstyle=qt(r),i.style=Gt(e,t,r),i},Kt=function(e,t){var n=t.getData(),r=Wt(e.parseStyle,e.serializeStyle,n);t.setData(r)},Yt=function(e,t,n){var r=ct(Rt(t.image),n.getData()),i=je(e.normalizeCss,It(r,!1));n.setData({style:i})},Xt=function(e,t,n,r){var i=r.getData();r.block("Uploading image"),N(i.fileinput).fold((function(){r.unblock()}),(function(i){var o=URL.createObjectURL(i),a=function(){r.unblock(),URL.revokeObjectURL(o)},s=function(i){r.setData({src:{value:i,meta:{}}}),r.showTab("general"),zt(e,t,n,r)};ve(i).then((function(n){var l=e.createBlobCache(i,o,n);t.automaticUploads?e.uploadImage(l).then((function(e){s(e.url),a()})).catch((function(t){a(),e.alertErr(t)})):(e.addToBlobCache(l),s(l.blobUri()),r.unblock())}))}))},Jt=function(e,t,n){return function(r,i){"src"===i.name?zt(e,t,n,r):"images"===i.name?Ut(e,t,n,r):"alt"===i.name?n.prevAlt=r.getData().alt:"style"===i.name?Kt(e,r):"vspace"===i.name||"hspace"===i.name||"border"===i.name||"borderstyle"===i.name?Yt(e,t,r):"fileinput"===i.name?Xt(e,t,n,r):"isDecorative"===i.name&&(r.getData().isDecorative?r.disable("alt"):r.enable("alt"))}},Qt=function(e){return function(){e.open=!1}},Zt=function(e){if(e.hasAdvTab||e.hasUploadUrl||e.hasUploadHandler){var t={type:"tabpanel",tabs:P([[_t.makeTab(e)],e.hasAdvTab?[Tt.makeTab(e)]:[],e.hasUploadTab&&(e.hasUploadUrl||e.hasUploadHandler)?[Lt.makeTab(e)]:[]])};return t}var n={type:"panel",items:_t.makeItems(e)};return n},en=function(e){return function(t){var n=Ot(t);return{title:"Insert/Edit Image",size:"normal",body:Zt(t),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:Rt(t.image),onSubmit:e.onSubmit(t),onChange:Jt(e,t,n),onClose:Qt(n)}}},tn=function(e){return function(t){return function(n){var r=ct(Rt(t.image),n.getData());e.execCommand("mceUpdateImage",!1,It(r,t.hasAccessibilityOptions)),e.editorUpload.uploadImagesAuto(),n.close()}}},nn=function(e){return function(t){return ye(e,t)?de(e.documentBaseURI.toAbsolute(t)).then((function(e){return{width:String(e.width),height:String(e.height)}})):K.resolve({width:"",height:""})}},rn=function(e){return function(t,n,r){return e.editorUpload.blobCache.create({blob:t,blobUri:n,name:t.name?t.name.replace(/\.[^\.]+$/,""):null,filename:t.name,base64:r.split(",")[1]})}},on=function(e){return function(t){e.editorUpload.blobCache.add(t)}},an=function(e){return function(t){e.windowManager.alert(t)}},sn=function(e){return function(t){return Qe(e,t)}},ln=function(e){return function(t){return e.dom.parseStyle(t)}},un=function(e){return function(t,n){return e.dom.serializeStyle(t,n)}},cn=function(e){return function(t){return ft(e).upload([t],!1).then((function(e){return 0===e.length?K.reject("Failed to upload image"):!1===e[0].status?K.reject(e[0].error.message):e[0]}))}},dn=function(e){var t={onSubmit:tn(e),imageSize:nn(e),addToBlobCache:on(e),createBlobCache:rn(e),alertErr:an(e),normalizeCss:sn(e),parseStyle:ln(e),serializeStyle:un(e),uploadImage:cn(e)},n=function(){Dt(e).then(en(t)).then(e.windowManager.open)};return{open:n}},fn=function(e){e.addCommand("mceImage",dn(e).open),e.addCommand("mceUpdateImage",(function(t,n){e.undoManager.transact((function(){return st(e,n)}))}))},hn=function(e){var t=e.attr("class");return t&&/\bimage\b/.test(t)},mn=function(e){return function(t){var n=t.length,r=function(t){t.attr("contenteditable",e?"true":null)};while(n--){var i=t[n];hn(i)&&(i.attr("contenteditable",e?"false":null),ht.each(i.getAll("figcaption"),r))}}},pn=function(e){e.on("PreInit",(function(){e.parser.addNodeFilter("figure",mn(!0)),e.serializer.addNodeFilter("figure",mn(!1))}))},gn=function(e){e.ui.registry.addToggleButton("image",{icon:"image",tooltip:"Insert/edit image",onAction:dn(e).open,onSetup:function(t){return t.setActive(f(Ze(e))),e.selection.selectorChangedWithUnbind("img:not([data-mce-object],[data-mce-placeholder]),figure.image",t.setActive).unbind}}),e.ui.registry.addMenuItem("image",{icon:"image",text:"Image...",onAction:dn(e).open}),e.ui.registry.addContextMenu("image",{update:function(e){return $e(e)||ze(e)&&!be(e)?["image"]:[]}})};function vn(){e.add("image",(function(e){pn(e),gn(e),fn(e)}))}vn()})()},"743b":function(e,t,n){"use strict";n("2a1e")},7591:function(e,t,n){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"app-main-container",class:{"main-container-no-card":!1===e.hasCard}},[e.isShowTableHead?t("div",{staticClass:"table-header"},[t("div",{staticClass:"table-header-title"},[e._v(e._s(e.tableTitle))]),t("span",{staticStyle:{color:"red","font-size":"15px",position:"absolute",left:"100px",bottom:"15px"}},[e._v(e._s(e.tableRemark))]),t("div",{staticClass:"table-header-operate"},[t("HeaderOperate",{attrs:{operates:e.headerOperates}})],1)]):e._e(),t("div",{staticClass:"data-content"},[t("jat-table",e._g(e._b({ref:"basicTable",staticClass:"basicTable",class:{absolute:e.isTableAbsolute},attrs:{data:e.data,border:!1,stripe:"",highlightCurrentRow:!0,headerCellStyle:{background:"#0579df",fontWeight:"600",color:"#fff"},loading:e.loading}},"jat-table",e.$attrs,!1),e.$listeners),["single"===e.selectType?t("el-table-column",{key:(new Date).getTime(),attrs:{width:"60px",label:"选择",fixed:!e.isMobile&&"left"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-radio",{attrs:{label:n.row[e.singleKey]},on:{change:function(t){return e.onSingleSelectionChange(n.row)}},model:{value:e.curRow,callback:function(t){e.curRow=t},expression:"curRow"}},[e._v(" "+e._s("")+" ")])]}}],null,!1,820933162)}):e._e(),"multi"===e.selectType?t("el-table-column",{attrs:{type:"selection",selectable:e.selectable,"reserve-selection":e.reserveSelection,width:"60px",fixed:!e.isMobile&&"left"}}):e._e(),e.hasPage?[e.hasSort?t("el-table-column",{attrs:{type:"index",label:"序号",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s((e.$attrs.currentPage-1)*e.$attrs.pageSize+(t.$index+1))+" ")]}}],null,!1,1216918600)}):e._e()]:[e.hasSort?t("el-table-column",{attrs:{type:"index",label:"序号"}}):e._e()],e._l(e.columns,(function(n){return t("el-table-column",{key:n.id,attrs:{prop:n.prop,label:n.label,"min-width":n.width||"150px",align:n.align||"center","show-overflow-tooltip":!1!==n.showOverflowTooltip,sortable:n.sortable||!1,formatter:(e,t,r,i)=>n.render?n.render(e,t,r,i):r},scopedSlots:e._u([{key:"default",fn:function({row:r,column:i,$index:o}){return[n.renderName?e._t(n.renderName,null,{row:r}):"date"===n.type?t("span",[e._v(" "+e._s(e.formdatetime(r[n.prop],n.formate))+" ")]):"dateRed"===n.type?t("div",{domProps:{innerHTML:e._s(e.getRed(r[n.prop]))}}):"image"===n.type?t("span",[r[n.prop]?t("el-image",{staticStyle:{width:"50px"},attrs:{src:r[n.prop],"preview-src-list":[r[n.prop]]}}):t("span")],1):"video"===n.type?t("span",[r[n.prop]?t("video",{attrs:{src:r[n.prop],poster:r.image,controls:"",preload:"none",width:"200"}},[t("source",{attrs:{"data-src":r[n.prop],type:"video/mp4"}})]):e._e()]):t("span",{style:{color:n.colorRener?n.colorRener(r):void 0}},[n.statusType?t("el-tag",{attrs:{type:n.statusType(r)}},[e._v(" "+e._s(n.render?n.render(r,i,r[n.prop],o):r[n.prop])+" ")]):t("span",[e._v(" "+e._s(n.render?n.render(r,i,r[n.prop],o):r[n.prop])+" ")])],1)]}}],null,!0)})})),e.operates?t("el-table-column",{attrs:{label:"操作","min-width":e.operateWidth,fixed:!e.isMobile&&"right"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("ListOperate",{attrs:{operates:e.showOperates(n),curRow:n.row}})]}}],null,!1,2847883693)}):e._e()],2)],1),e.hasPage?t("jat-pagination",e._g(e._b({staticStyle:{"margin-top":"10px"},attrs:{layout:e.paginationLayout,total:e.total},on:{"current-change":e.onCurrentChange,"size-change":e.onSizeChange}},"jat-pagination",e.$attrs,!1),e.$listeners)):e._e()],1)},i=[],o=n("b893"),a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"header-btn"},e._l(e.operates,(function(n){return t("span",{key:n.key,attrs:{disabled:n.disabled},on:{click:function(e){return n.action(n)}}},[t("HeaderBtn",{directives:[{name:"permission",rawName:"v-permission",value:n.permission,expression:"o.permission"}],attrs:{name:n.key,bgColor:n.bgColor}},[e._v(e._s(n.name))])],1)})),0)},s=[],l=n("4736"),u={name:"HeaderOperate",components:{HeaderBtn:l["a"]},props:{operates:{type:Array,default:()=>[]}},data(){return{}}},c=u,d=(n("813f"),n("1805")),f=Object(d["a"])(c,a,s,!1,null,"6597c8f2",null),h=f.exports,m=function(){var e=this,t=e._self._c;return t("div",{staticClass:"list-operate"},[e._l(e.operates,(function(n){return[!n.show||n.show(e.curRow)?t("span",{directives:[{name:"permission",rawName:"v-permission",value:n.permission,expression:"o.permission"}],key:n.key,staticClass:"list-operate-btn",class:!0===n.disabled?"not-allowed-btn":n.btnStyle+"-btn",on:{click:function(t){return n.action(n,e.curRow)}}},[e._v(" "+e._s(n.title)+" ")]):e._e()]}))],2)},p=[],g={name:"ListOperate",components:{},props:{operates:{type:Array,default:()=>[]},curRow:{type:Object,default:()=>({})}},computed:{}},v=g,b=(n("d527"),Object(d["a"])(v,m,p,!1,null,null,null)),y=b.exports,w={name:"TaskTable",components:{ListOperate:y,HeaderOperate:h},props:{columns:{type:Array,default:()=>[]},data:{type:Array,default:()=>[]},total:{type:Number,default:0},selectable:{type:Function,default:()=>!0},operates:{type:[Array,Function],default:null},headerOperates:{type:Array,default:()=>[]},tableTitle:{type:String,default:"列表"},tableRemark:{type:String,default:""},selectType:{type:String,default:"none"},singleKey:{type:String,default:""},loading:{type:Boolean,default:!1},hasPage:{default:!0},isTableAbsolute:{default:!1},operateWidth:{default:"200px"},isShowTableHead:{type:Boolean,default:!0},hasCard:{type:Boolean,default:!0},hasSort:{type:Boolean,default:!0},reserveSelection:{type:Boolean,default:!1}},data(){return{curRow:"",windowWidth:window.innerWidth,isMobile:this.checkIfMobile()}},computed:{getWidth(){return window.innerWidth},paginationLayout(){return this.isMobile?"total, prev, next, jumper":"total, sizes, ->, prev, pager, next, jumper"}},methods:{checkIfMobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},handleResize(){this.isMobile=this.checkIfMobile()},handleOrientationChange(){this.isMobile=this.checkIfMobile()},getRed(e){const t=new Date(e),n=new Date;return t.getDate()===n.getDate()&&t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear()?`<font style='color: red'>${this.formdatetime(e,"")}<font/>`:this.formdatetime(e,"")},formdatetime(e,t){return"undefined"!==typeof e&&null!==e?e.time?Object(o["b"])(e.time,t||""):e&&"number"===typeof e?Object(o["b"])(e,t||""):"{}"===JSON.stringify(e)?"--":e:"--"},lazyLoadVideo(e,t){e.forEach(e=>{if(e.isIntersecting){const n=e.target;n.src=n.dataset.src,t.unobserve(n)}})},initLazyLoad(){const e=new IntersectionObserver(this.lazyLoadVideo);this.$nextTick(()=>{const t=this.$el.querySelectorAll("video");t.forEach(t=>{e.observe(t)})})},onCurrentChange(e){this.$emit("current-page-change",e)},onSizeChange(e){this.$emit("size-page-change",e)},onSelectionChange(e){this.$emit("selection-change",e)},onSingleSelectionChange(e){e&&(this.curRow=e[this.singleKey],this.$emit("single-selection-change",e))},clearSingleSelection(){this.curRow=""},showOperates(e){return Array.isArray(this.operates)?this.operates:this.operates(e)}},mounted(){window.addEventListener("resize",this.handleResize),window.addEventListener("orientationchange",this.handleOrientationChange),this.initLazyLoad()},beforeDestroy(){window.removeEventListener("resize",this.handleResize),window.removeEventListener("orientationchange",this.handleOrientationChange)}},S=w,x=(n("0cf9"),Object(d["a"])(S,r,i,!1,null,"580e0498",null));t["a"]=x.exports},"76d1":function(e,t,n){"use strict";n("1b80")},"76d4":function(e,t,n){"use strict";n("9bd3")},"779e":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.addModifyVisible,width:"50%"},on:{"update:visible":function(t){e.addModifyVisible=t},close:e.close}},[t("el-form",{ref:"advertRef",attrs:{model:e.addData,rules:e.advertRule,"label-position":"left","label-width":"90px"}},[t("el-form-item",{attrs:{label:"广告位置:",prop:"categoryId"}},[t("jat-select",{attrs:{placeholder:"请选择广告位置",clearable:""},model:{value:e.addData.categoryId,callback:function(t){e.$set(e.addData,"categoryId",t)},expression:"addData.categoryId"}},e._l(e.categoryOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"广告名称:",prop:"name"}},[t("jat-input",{attrs:{placeholder:"请输入名称"},model:{value:e.addData.name,callback:function(t){e.$set(e.addData,"name",t)},expression:"addData.name"}})],1),t("el-form-item",{attrs:{label:"广告图片:",prop:"image"}},[t("upload-image",{model:{value:e.addData.image,callback:function(t){e.$set(e.addData,"image",t)},expression:"addData.image"}})],1),t("el-form-item",{attrs:{label:"广告链接:",prop:"href"}},[t("jat-input",{attrs:{placeholder:"请输入广告链接"},model:{value:e.addData.href,callback:function(t){e.$set(e.addData,"href",t)},expression:"addData.href"}})],1),t("el-form-item",{attrs:{label:"广告内容:",prop:"content"}},[t("tinymce-edit",{model:{value:e.addData.content,callback:function(t){e.$set(e.addData,"content",t)},expression:"addData.content"}})],1),t("el-form-item",{attrs:{label:"广告排序:",prop:"sort"}},[t("jat-input",{attrs:{placeholder:"请输入广告排序"},model:{value:e.addData.sort,callback:function(t){e.$set(e.addData,"sort",e._n(t))},expression:"addData.sort"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)],1)},i=[],o=n("cbc3"),a=n("b775"),s=n("9adf"),l={components:{uploadImage:o["a"],tinymceEdit:s["a"]},data(){return{addModifyVisible:!1,dialogTitle:"",addData:{categoryId:"",name:"",image:"",href:"",content:"",sort:void 0,id:""},categoryOptions:[],advertRule:{categoryId:[{required:!0,message:"请选择广告位置",trigger:"blur"}],name:[{required:!0,message:"请输入广告名称",trigger:"blur"}],sort:[{required:!0,message:"请输入广告排序",trigger:"blur"},{type:"number",message:"请输入整数"}]}}},mounted(){},methods:{open(){this.dialogTitle="添加广告",this.addData.name="",this.addModifyVisible=!0},edit({id:e,name:t,advertiseCategoryId:n,herf:r,image:i,sort:o,content:a}){this.dialogTitle="编辑广告",this.addModifyVisible=!0,this.addData={id:e,name:t,categoryId:n,href:r,image:i,sort:o,content:a}},close(){this.$refs.advertRef&&this.$refs.advertRef.clearValidate(),this.addData={categoryId:"",name:"",image:"",href:"",content:"",sort:"",id:""},this.addModifyVisible=!1},getCategoryList(){a["a"].post({url:"/system/sysAdvertise/getAllAdvertisingSpace",params:{},success:e=>{this.categoryOptions=e}})},handleSubmit(){this.$refs.advertRef.validate(e=>{e&&(this.addData.id?a["a"].post({url:"/system/sysAdvertise/edit",params:{...this.addData},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}):a["a"].post({url:"/system/sysAdvertise/add",params:this.addData,success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}))})}}},u=l,c=n("1805"),d=Object(c["a"])(u,r,i,!1,null,"1ddb584c",null);t["default"]=d.exports},"783f":function(e,t,n){},"787e":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a}));var r=n("b775");const i=[{label:"小学",value:0},{label:"初中",value:1},{label:"高中",value:2},{label:"中专",value:3},{label:"专科",value:4},{label:"本科",value:5},{label:"硕士",value:6},{label:"博士",value:7}],o=[{label:"男",value:1},{label:"女",value:2}],a=e=>{r["a"].post({url:"/admin/adPromotionChannel/listNoPage",params:{},success:t=>{e(t)}})}},"7cfc":function(e,t,n){"use strict";var r=n("0f07"),i=n("4db2"),o=n("805a"),a=n("b1c0"),s="WebAssembly",l=i[s],u=7!==new Error("e",{cause:7}).cause,c=function(e,t){var n={};n[e]=a(e,t,u),r({global:!0,constructor:!0,arity:1,forced:u},n)},d=function(e,t){if(l&&l[e]){var n={};n[e]=a(s+"."+e,t,u),r({target:s,stat:!0,constructor:!0,arity:1,forced:u},n)}};c("Error",(function(e){return function(t){return o(e,this,arguments)}})),c("EvalError",(function(e){return function(t){return o(e,this,arguments)}})),c("RangeError",(function(e){return function(t){return o(e,this,arguments)}})),c("ReferenceError",(function(e){return function(t){return o(e,this,arguments)}})),c("SyntaxError",(function(e){return function(t){return o(e,this,arguments)}})),c("TypeError",(function(e){return function(t){return o(e,this,arguments)}})),c("URIError",(function(e){return function(t){return o(e,this,arguments)}})),d("CompileError",(function(e){return function(t){return o(e,this,arguments)}})),d("LinkError",(function(e){return function(t){return o(e,this,arguments)}})),d("RuntimeError",(function(e){return function(t){return o(e,this,arguments)}}))},"7d06":function(e,t,n){},"7d95":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.uploadVisible,width:"50%"},on:{"update:visible":function(t){e.uploadVisible=t},close:e.close}},[t("div",[t("el-form",{ref:"uploadVidoRef",attrs:{model:e.addData,rules:e.uploadVidoRules,"label-width":"80px",inline:!1}},[t("el-form-item",{attrs:{label:e.dialogTitle,prop:"url"}},[t("jat-input",{attrs:{placeholder:"请输入"+e.dialogTitle+"链接或者点击上传"},model:{value:e.addData.url,callback:function(t){e.$set(e.addData,"url",t)},expression:"addData.url"}}),t("upload-file",{attrs:{accept:".mp4",valueType:"string",tip:"上传期间请不要关闭或者刷新浏览器"},model:{value:e.addData.url,callback:function(t){e.$set(e.addData,"url",t)},expression:"addData.url"}})],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmit}},[e._v("确 定")])],1)])],1)},i=[],o=n("c46c"),a=n("b775"),s={components:{uploadFile:o["a"]},data(){return{uploadVisible:!1,dialogTitle:"",addData:{id:"",url:""},uploadType:"",uploadVidoRules:{url:{required:!0,message:"请输入视频链接或者点击上传",trigger:"blur"}}}},methods:{open(e,t,n){this.dialogTitle=e,this.uploadType=t,this.addData.id=n,this.uploadVisible=!0},close(){this.uploadVisible=!1,this.addData={id:"",url:""}},handleSubmit(){this.$refs.uploadVidoRef.validate(e=>{e&&(1===this.type?a["a"].post({url:"/admin/adCourse/uploadLivePlaybackUrlEdit",params:{...this.addData},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}):a["a"].post({url:"/admin/adCourse/uploadRecordLiveUrlEdit",params:{...this.addData},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}))})}}},l=s,u=n("1805"),c=Object(u["a"])(l,r,i,!1,null,"f2c9c25a",null);t["default"]=c.exports},"7e4a":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.addModifyVisible,width:"40%"},on:{"update:visible":function(t){e.addModifyVisible=t},close:e.close}},[t("el-form",{ref:"departmentRef",attrs:{model:e.addData,rules:e.departmentRule,"label-position":"right","label-width":"90px"}},[t("el-form-item",{attrs:{label:"部门名称:",prop:"name"}},[t("jat-input",{attrs:{placeholder:"请输入部门名称"},model:{value:e.addData.name,callback:function(t){e.$set(e.addData,"name",t)},expression:"addData.name"}})],1),t("el-form-item",{attrs:{label:"父级名称:",prop:"parentId"}},[t("el-cascader",{staticStyle:{width:"100%"},attrs:{size:"small",placeholder:"请选择父级名称",clearable:"",disabled:e.parentIdDisable,options:e.departmentOptions,props:{label:"name",value:"id",emitPath:!1,checkStrictly:!0}},model:{value:e.addData.parentId,callback:function(t){e.$set(e.addData,"parentId",t)},expression:"addData.parentId"}})],1),t("el-form-item",{attrs:{label:"主管:",prop:"supervisorAdId"}},[t("jat-select",{attrs:{filterable:"",remote:"",placeholder:"请输入名称或手机号关键词","remote-method":e.remoteMethod,loading:e.remoteLoading},model:{value:e.addData.supervisorAdId,callback:function(t){e.$set(e.addData,"supervisorAdId",t)},expression:"addData.supervisorAdId"}},e._l(e.supervisorAdOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"排序:",prop:"sort"}},[t("jat-input",{attrs:{placeholder:"请输入排序"},model:{value:e.addData.sort,callback:function(t){e.$set(e.addData,"sort",e._n(t))},expression:"addData.sort"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)],1)},i=[],o=n("cbc3"),a=n("b775"),s={components:{uploadImage:o["a"]},data(){return{addModifyVisible:!1,addInterfaceVisible:!1,remoteLoading:!1,parentIdDisable:!1,dialogTitle:"",departmentOptions:[{name:"顶级",id:"-1"}],supervisorAdOptions:[],addData:{name:"",parentId:"",sort:void 0,supervisorAdId:"",id:""},departmentRule:{name:[{required:!0,message:"请输入部门名称",trigger:"blur"}],parentId:[{required:!0,message:"请选择父级名称",trigger:"blur"}],sort:[{required:!0,message:"请输入排序",trigger:"blur"},{type:"number",message:"请输入整数"}]}}},mounted(){},methods:{open(e,t){this.dialogTitle="添加部门",this.addData.name="",this.addModifyVisible=!0,this.departmentOptions=[{name:"顶级",id:-1},...e],t&&(this.addData.parentId=t.id,this.parentIdDisable=!0)},edit({id:e,name:t,parentId:n,sort:r,supervisorAdId:i,supervisorAdName:o},a){this.departmentOptions=[{name:"顶级",id:-1},...a],this.parentIdDisable=!0,this.addData={id:e,name:t,parentId:n,supervisorAdId:i,sort:r},i&&(this.supervisorAdOptions=[{id:i,name:o}]),this.dialogTitle="编辑部门",this.addModifyVisible=!0},close(){this.$refs.departmentRef&&this.$refs.departmentRef.clearValidate(),this.addModifyVisible=!1,this.addData={name:"",parentId:"",sort:void 0,supervisorAdId:"",id:""},this.parentIdDisable=!1},remoteMethod(e){e&&(this.remoteLoading=!0,a["a"].post({url:"/admin/adInfo/queryAdminByNameOrPhone",params:{search:e},success:e=>{this.remoteLoading=!1,this.supervisorAdOptions=e},catch:()=>{this.remoteLoading=!1}}))},handleSubmit(){this.$refs.departmentRef.validate(e=>{e&&(this.addData.id?a["a"].post({url:"/admin/adDepartment/edit",params:{...this.addData},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}):a["a"].post({url:"/admin/adDepartment/add",params:this.addData,success:e=>{this.$message.success(e),this.close(),this.$emit("success")},catch:()=>{}}))})},getNewdepartmentList(){a["a"].post({url:"/system/sysNewsdepartment/listNoPage",params:{...this.addData},success:e=>{this.departmentOptions=e.filter(e=>-1==e.parentId)}})}}},l=s,u=n("1805"),c=Object(u["a"])(l,r,i,!1,null,"1e41a7d2",null);t["default"]=c.exports},"801b":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{ref:"filter",attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}),t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,operates:e.operates,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange},scopedSlots:e._u([{key:"image",fn:function(e){return t("div",{},[e.row.image?t("el-image",{staticStyle:{width:"50px"},attrs:{src:e.row.image,"preview-src-list":[e.row.image]}}):t("span")],1)}}])}),t("add-dialog",{ref:"addDialog",on:{success:e.handleSuccess}})],1)},i=[],o=n("7591"),a=n("b775"),s=n("5789"),l=n("787e"),u=n("b893"),c={name:"dataPage",components:{BasicTable:o["a"],addDialog:s["default"]},data(){return{loading:!1,categoryOptions:[],filterOptions:{column:[{type:"input",label:"姓名/QQ/微信/电话号码",value:"search"},{type:"select",label:"推广渠道",value:"channelId",valueKey:"id",labelKey:"name",options:[]},{type:"user",userType:0,label:"销售员",value:"promoterId"},{type:"user",userType:0,label:"推广员",value:"createAdId"},{type:"cascader",label:"部门",value:"departmentId",ref:"departmentRef",options:[],props:{value:"id",label:"name",multiple:!0}},{type:"timeAll",label:["添加开始时间","添加结束时间"],value:"time"},{type:"timeAll",label:["创建开始时间","创建结束时间"],value:"createTime"}]},filterData:{search:"",channelId:"",promoterId:"",createAdId:"",time:[],createTime:[],departmentId:[]},table:{columns:[{id:2,prop:"name",label:"姓名",width:"80px"},{id:3,prop:"channelName",label:"推广渠道",width:"100px"},{id:4,prop:"promoterName",label:"销售员",width:"80px"},{id:13,prop:"createAdName",label:"推广员",width:"80px"},{id:5,prop:"qq",label:"QQ",width:"100px"},{id:22,prop:"ding",label:"钉钉",width:"100px"},{id:6,prop:"wechat",label:"微信",width:"100px"},{id:7,prop:"gender",label:"性别",render:e=>l["b"].find(t=>t.value===e.gender)["label"],width:"80px"},{id:8,prop:"remark",label:"备注",width:"100px"},{id:10,prop:"degree",label:"学历",width:"80px",render:e=>e.degree?l["a"].find(t=>t.value===e.degree)["label"]:"未填写"},{id:11,prop:"age",label:"年龄",width:"50px"},{id:16,prop:"addTime",label:"添加时间",type:"dateRed"},{id:12,prop:"createTime",label:"创建时间",type:"date"}],pageSize:20,currentPage:1,data:[],total:0},operates:[{key:"edit",title:"编辑",permission:"admin/adPromotionData/edit",btnStyle:"yellow",action:(e,t)=>{this.$refs.addDialog.edit(t)}},{key:"logicDelete",title:"删除",permission:"admin/adPromotionData/logicRemove",btnStyle:"red",action:(e,t)=>{this.handleLogicDelete(t)}}],headerOperates:[{key:"export",permission:"admin/adPromotionData/listExport",name:"导出",action:()=>{this.handleExport()}},{key:"el-icon-plus",permission:"admin/adPromotionData/add",name:"添加推广数据",action:()=>{this.$refs.addDialog.open()}}]}},created(){this.getList(),this.getDepartmentList(),Object(l["c"])(e=>{console.log(e),this.filterOptions.column[1].options=e})},methods:{handleExport(){this.$confirm("确定导出推广数据吗？导出的时候请等待页面下载自动开始，如果数据量大，可能会等待稍长时间，请不要关闭或者刷新页面","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$message.warning("请耐心等待，表格正在导出1中......");var e=this;const{time:t,createTime:n,...r}=this.filterData;a["a"].post({url:"/admin/adPromotionData/listExport",params:{startTime:t&&t.length>1?t[0]:"",endTime:t&&t.length>1?t[1]:"",cSTime:n&&n.length>1?n[0]:"",cETime:n&&n.length>1?n[1]:"",...r},success:t=>{let n=document.createElement("a");n.href="https://"+t,document.body.appendChild(n),n.click(),document.body.removeChild(n),e.$message.success("导出成功"),e.searchFilter()}})}).catch(e=>{console.log(e)})},searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0;const{time:e,createTime:t,...n}=this.filterData;this.$nextTick(()=>{const r=this.$refs.filter.$refs.departmentRef[0].getCheckedNodes().map(e=>e.data.id);a["a"].post({url:"/admin/adPromotionData/list",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,startTime:e&&e.length>1?e[0]:"",endTime:e&&e.length>1?e[1]:"",cSTime:t&&t.length>1?t[0]:"",cETime:t&&t.length>1?t[1]:"",...n,departmentId:r&&r.length>0?JSON.stringify(r):""},success:e=>{this.table.data=e.list,this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1},finally:()=>{this.loading=!1}})})},getDepartmentList(){a["a"].post({url:"/admin/adInfo/canChooseCanSeeDepartmentList",params:{...this.addData,id:sessionStorage.getItem("id")},success:e=>{this.departmentList=e,this.filterOptions.column[4].options=Object(u["c"])(e)}})},handleSuccess(){this.getList()},handleLogicDelete(e){this.$confirm("此操作将会删除该推广数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/admin/adPromotionData/logicRemove",params:{id:e.id},success:e=>{this.$message.success(e),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},handleDelete(e){this.$confirm("此操作将会删除该推广数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/admin/adPromotionData/deleteList",params:{id:e.id},success:e=>{this.$message.success(e),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},clearFilter(){this.filterData={search:"",channelId:"",promoterId:"",createAdId:"",time:[],createTime:[],departmentId:[]},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()}}},d=c,f=(n("f9a0"),n("1805")),h=Object(f["a"])(d,r,i,!1,null,"de308184",null);t["default"]=h.exports},"803d":function(e,t,n){"use strict";n("a85f")},"805a":function(e,t,n){"use strict";var r=n("9e48"),i=Function.prototype,o=i.apply,a=i.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?a.bind(o):function(){return a.apply(o,arguments)})},"813f":function(e,t,n){"use strict";n("cb0d")},"81b9f":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.addModifyVisible,width:"50%"},on:{"update:visible":function(t){e.addModifyVisible=t},close:e.close}},[t("el-form",{ref:"promotionRef",attrs:{model:e.addData,rules:e.promotionRule,"label-position":"left","label-width":"90px"}},[t("el-form-item",{attrs:{label:"推广渠道:",prop:"channelId"}},[t("jat-select",{attrs:{placeholder:"请选择推广渠道",clearable:""},model:{value:e.addData.channelId,callback:function(t){e.$set(e.addData,"channelId",t)},expression:"addData.channelId"}},e._l(e.channelIdOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"销售员:",prop:"promoterId"}},[t("select-user-remote",{ref:"selectUser",attrs:{width:"100%",type:0,placeholder:"销售员"},model:{value:e.addData.promoterId,callback:function(t){e.$set(e.addData,"promoterId",t)},expression:"addData.promoterId"}})],1),t("el-form-item",{attrs:{label:"QQ:",prop:"qq"}},[t("jat-input",{attrs:{placeholder:"请输入QQ"},model:{value:e.addData.qq,callback:function(t){e.$set(e.addData,"qq",t)},expression:"addData.qq"}})],1),t("el-form-item",{attrs:{label:"微信:",prop:"wechat"}},[t("jat-input",{attrs:{placeholder:"请输入微信"},model:{value:e.addData.wechat,callback:function(t){e.$set(e.addData,"wechat",t)},expression:"addData.wechat"}})],1),t("el-form-item",{attrs:{label:"姓名:",prop:"name"}},[t("jat-input",{attrs:{placeholder:"请输入姓名"},model:{value:e.addData.name,callback:function(t){e.$set(e.addData,"name",t)},expression:"addData.name"}})],1),t("el-form-item",{attrs:{label:"性别:",prop:"gender"}},[t("jat-select",{attrs:{placeholder:"请选择性别",clearable:""},model:{value:e.addData.gender,callback:function(t){e.$set(e.addData,"gender",t)},expression:"addData.gender"}},e._l(e.genderOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"电话号码:",prop:"phone"}},[t("jat-input",{attrs:{placeholder:"请输入电话号码"},model:{value:e.addData.phone,callback:function(t){e.$set(e.addData,"phone",t)},expression:"addData.phone"}})],1),t("el-form-item",{attrs:{label:"学历:",prop:"degree"}},[t("jat-select",{attrs:{placeholder:"请选择学历",clearable:""},model:{value:e.addData.degree,callback:function(t){e.$set(e.addData,"degree",t)},expression:"addData.degree"}},e._l(e.degreeOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"年龄:",prop:"age"}},[t("jat-input",{attrs:{placeholder:"请输入年龄"},model:{value:e.addData.age,callback:function(t){e.$set(e.addData,"age",t)},expression:"addData.age"}})],1),t("el-form-item",{attrs:{label:"头像:",prop:"avatar"}},[t("upload-image",{model:{value:e.addData.avatar,callback:function(t){e.$set(e.addData,"avatar",t)},expression:"addData.avatar"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)],1)},i=[],o=(n("7cfc"),n("cbc3")),a=n("b775"),s=n("61da"),l=n("969e"),u=n("61f7"),c={components:{uploadImage:o["a"],selectUserRemote:s["a"]},data(){return{btnFlag:!0,addModifyVisible:!1,dialogTitle:"",channelIdOptions:[],genderOptions:l["b"],degreeOptions:l["a"],addData:{age:"",avatar:"",degree:"",gender:"",name:"",phone:"",qq:"",wechat:"",channelId:"",promoterId:""},categoryOptions:[],promotionRule:{channelId:[{required:!0,message:"请选推广渠道",trigger:"blur"}],promoterId:[{required:!0,message:"请选择销售员",trigger:"blur"}],phone:[{validator:(e,t,n)=>{t&&(Object(u["b"])(t)?n():n(new Error("格式不正确")))},trigger:"blur"}],qq:[{validator:(e,t,n)=>{t||this.addData.wechat?(this.$refs.promotionRef.validateField("wechat"),n()):n(new Error("QQ和微信二选一,其中一个必填"))},trigger:"blur"}],wechat:[{validator:(e,t,n)=>{t||this.addData.qq?n():n(new Error("QQ和微信二选一,其中一个必填"))},trigger:"blur"}]}}},mounted(){},methods:{open(){this.dialogTitle="添加推广数据",this.addModifyVisible=!0,Object(l["c"])(e=>{this.channelIdOptions=e})},edit({id:e,age:t,avatar:n,degree:r,gender:i,name:o,phone:a,qq:s,wechat:u,channelId:c,promoterId:d,promoterName:f}){this.dialogTitle="编辑推广数据",this.addModifyVisible=!0,Object(l["c"])(e=>{this.channelIdOptions=e}),this.addData={dataId:e,avatar:n,degree:r,gender:i,name:o,phone:a,age:t,qq:s,wechat:u,channelId:c,promoterId:d},this.$nextTick(()=>{this.$refs.selectUser.userOptions=[{name:f,id:d}]})},close(){this.$refs.promotionRef&&this.$refs.promotionRef.clearValidate(),this.addData={age:"",avatar:"",degree:"",gender:"",name:"",phone:"",qq:"",wechat:"",channelId:"",promoterId:""},this.addModifyVisible=!1},handleSubmit(){this.$refs.promotionRef.validate(e=>{e&&(this.addData.dataId?a["a"].post({url:"/admin/adPromotionData/edit",params:{...this.addData},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}):a["a"].post({url:"/admin/adPromotionData/add",params:this.addData,success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}))})}}},d=c,f=n("1805"),h=Object(f["a"])(d,r,i,!1,null,"e110f2d6",null);t["default"]=h.exports},"82df":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return i}));var r=function(){return"undefined"!==typeof window?window:e},i=function(){var e=r();return e&&e.tinymce?e.tinymce:null}}).call(this,n("a282"))},"82f3":function(e,t,n){"use strict";n("1e5e")},8467:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}),t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total,operates:e.operates},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange},scopedSlots:e._u([{key:"image",fn:function(e){return t("div",{},[e.row.image?t("el-image",{staticStyle:{width:"50px"},attrs:{src:e.row.image,"preview-src-list":[e.row.image]}}):t("span")],1)}}])})],1)},i=[],o=n("7591"),a=n("b775"),s={name:"vipStudent",components:{BasicTable:o["a"]},data(){return{supervisorAdOptions:[],departmentList:[],remoteLoading:!1,accountVisible:!1,accountInfo:{account:"",password:""},loading:!1,filterOptions:{column:[{type:"user",userType:1,label:"下单人",value:"vipId"},{type:"timeAll",label:["学习开始日期","学习结束日期"],value:"registerTime"}]},filterData:{username:"",qq:"",gender:"",departmentId:"",parentId:"",status:-3,registerTime:[]},table:{columns:[{id:1,prop:"vipName",label:"用户名"},{id:3,prop:"account",label:"学员账号"},{id:4,prop:"courseName",label:"课程名称"},{id:5,prop:"chapterName",label:"章节名称"},{id:6,prop:"openTimeName",label:"学习时间"},{id:8,prop:"lastTimeName",label:"最后一次学习时间"},{id:9,prop:"status",label:"学习状态",render:()=>"已学习"}],pageSize:20,currentPage:1,data:[],total:0},headerOperates:[]}},created(){this.getList(),this.getDepartmentList()},methods:{handleClose(){this.accountInfo={account:"",password:""}},handleAudit(e){this.$confirm("确定审核通过吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/admin/adInfo/auditVip",params:{id:e.id},success:e=>{this.accountInfo=e,this.accountVisible=!0,this.$message.success("审核通过，请将账号和密码发给学员"),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消操作"})})},searchFilter(){this.table.currentPage=1,this.getList()},getList(){const{registerTime:e,...t}=this.filterData;this.loading=!0,a["a"].post({url:"/admin/adInfo/vipWatch",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,...t,lastTimeStart:e&&e.length>0?e[0]:"",lastTimeEnd:e&&e.length>0?this.$moment(e[1]).add(1,"days").format("YYYY-MM-DD"):""},success:e=>{this.table.data=e.list,this.table.total=e.total,this.table.data.forEach(e=>{this.$common.checkNull(e.name)||(e.name="未填写"),this.$common.checkNull(e.qq)||(e.qq="未填写"),this.$common.checkNull(e.wechat)||(e.wechat="未填写")}),this.loading=!1},catch:()=>{this.loading=!1}})},getDepartmentList(){a["a"].post({url:"/admin/adInfo/canChooseCanSeeDepartmentList",params:{...this.addData,id:sessionStorage.getItem("id")},success:e=>{this.departmentList=e,this.filterOptions.column[3].options=listToTree(e)}})},handleSuccess(){this.getList()},remoteMethod(e){e&&(this.remoteLoading=!0,a["a"].post({url:"/admin/adInfo/queryAdminByNameOrPhone",params:{search:e},success:e=>{this.remoteLoading=!1,this.supervisorAdOptions=e},catch:()=>{this.remoteLoading=!1}}))},clearFilter(){this.filterData={username:"",qq:"",gender:"",departmentId:"",parentId:"",status:-3,registerTime:[]},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()}}},l=s,u=(n("486f"),n("1805")),c=Object(u["a"])(l,r,i,!1,null,"54029fd5",null);t["default"]=c.exports},"873c":function(e,t,n){},8763:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("el-container",[t("LeftNav"),t("el-container",{attrs:{id:"container"}},[t("Header"),t("Main")],1),t("Drawer")],1)},i=[],o=n("2abc"),a=n("1820"),s=n("b892"),l=n("1115"),u={components:{Header:o["a"],LeftNav:a["a"],Main:s["a"],Drawer:l["a"]},data(){return{notify:{}}},watch:{},mounted(){PubSub.subscribe("showNotify",(e,t)=>{var n=this.$notify({title:t.title,message:t.message,duration:0,position:"bottom-right",showClose:!1});this.notify[t.uid]=n})},methods:{websubscribe(){}},beforeDestroy(){}},c=u,d=(n("43d0"),n("1805")),f=Object(d["a"])(c,r,i,!1,null,"e41bd466",null);t["default"]=f.exports},"877f":function(e,t,n){"use strict";n("7317")},"87bd":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}},[t("span",{attrs:{slot:"parentId"},slot:"parentId"},[t("el-select",{staticStyle:{width:"85%"},attrs:{filterable:"",remote:"",size:"small",clearable:"",placeholder:"添加人(可根据名称或手机号进行搜索)","remote-method":e.remoteMethod,loading:e.remoteLoading},model:{value:e.filterData.parentId,callback:function(t){e.$set(e.filterData,"parentId",t)},expression:"filterData.parentId"}},e._l(e.supervisorAdOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)]),t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,operates:e.operates,operateWidth:"120px",data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange},scopedSlots:e._u([{key:"image",fn:function(e){return t("div",{},[e.row.image?t("el-image",{staticStyle:{width:"50px"},attrs:{src:e.row.image,"preview-src-list":[e.row.image]}}):t("span")],1)}}])}),t("add-dialog",{ref:"addDialog",on:{success:e.handleSuccess}})],1)},i=[],o=n("7591"),a=n("b775"),s=n("e790"),l=n("b893"),u={name:"formalVipPage",components:{BasicTable:o["a"],addDialog:s["default"]},data(){return{supervisorAdOptions:[],departmentList:[],remoteLoading:!1,loading:!1,filterOptions:{column:[{type:"input",label:"用户名/真实姓名/电话号码",value:"username"},{type:"input",label:"QQ/微信",value:"qq"},{type:"select",label:"性别",value:"gender",options:[{label:"男",value:"1"},{label:"女",value:"2"}]},{type:"slot",slotName:"parentId"},{type:"select",label:"状态",value:"status",options:[{label:"正常",value:0},{label:"冻结",value:-1},{label:"禁用",value:-2},{label:"未审核",value:-3}]},{type:"timeAll",label:["注册开始日期","注册结束日期"],value:"registerTime"}]},statusDic:{0:{label:"正常",type:"success"},"-1":{label:"冻结",type:"warning"},"-2":{label:"禁用",type:"danger"},"-3":{label:"未审核",type:"info"}},filterData:{username:"",qq:"",gender:"",departmentId:"",parentId:"",status:"",registerTime:[]},table:{columns:[{id:1,prop:"account",label:"用户名"},{id:2,prop:"studentNumber",label:"学籍号",render:e=>(console.log("学籍:",e),e.studentNumber?e.studentNumber:"未注册学籍")},{id:3,prop:"name",label:"真实姓名"},{id:10,prop:"profitName",label:"所属销售员"},{id:4,prop:"qq",label:"QQ"},{id:5,prop:"wechat",label:"微信"},{id:6,prop:"phone",label:"联系电话"},{id:7,prop:"status",label:"状态",render:e=>this.statusDic[e.status].label,statusType:e=>this.statusDic[e.status].type},{id:8,prop:"createTime",label:"注册时间",type:"date"}],pageSize:20,currentPage:1,data:[],total:0},operates:[{key:"edit",title:"编辑",permission:"admin/adInfo/editVip",btnStyle:"yellow",action:(e,t)=>{this.$refs.addDialog.edit(t)}},{key:"edit",title:"生成学籍",permission:"admin/adInfo/gtStNumber",btnStyle:"green",action:(e,t)=>{this.gtStNumber(t.id)},show:e=>{if(!e.studentNumber)return!0}}],headerOperates:[{key:"el-icon-plus",permission:"admin/adInfo/addVip",name:"添加会员",action:()=>{this.$refs.addDialog.open()}}]}},created(){this.getList(),this.getDepartmentList()},methods:{gtStNumber(e){this.$confirm("确定生成学籍号吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/admin/adInfo/gtStNumber",params:{id:e},success:e=>{console.log("res",e),this.$message.success("操作成功"),this.searchFilter()}})}).catch(()=>{})},searchFilter(){this.table.currentPage=1,this.getList()},getList(){const{registerTime:e,...t}=this.filterData;this.loading=!0,a["a"].post({url:"/admin/adInfo/vipList",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,...t,startTime:e&&e.length>0?e[0]:"",endTime:e&&e.length>0?this.$moment(e[1]).add(1,"days").format("YYYY-MM-DD"):""},success:e=>{this.table.data=e.list,this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1}})},getDepartmentList(){a["a"].post({url:"/admin/adInfo/canChooseCanSeeDepartmentList",params:{...this.addData,id:sessionStorage.getItem("id")},success:e=>{this.departmentList=e,this.filterOptions.column[3].options=Object(l["c"])(e)}})},handleSuccess(){this.getList()},remoteMethod(e){e&&(this.remoteLoading=!0,a["a"].post({url:"/admin/adInfo/queryAdminByNameOrPhone",params:{search:e},success:e=>{this.remoteLoading=!1,this.supervisorAdOptions=e},catch:()=>{this.remoteLoading=!1}}))},clearFilter(){this.filterData={username:"",qq:"",gender:"",departmentId:"",parentId:"",status:"",registerTime:[]},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()}}},c=u,d=(n("fed7"),n("1805")),f=Object(d["a"])(c,r,i,!1,null,"364f7d32",null);t["default"]=f.exports},"88e2":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.addModifyVisible,width:"70%"},on:{"update:visible":function(t){e.addModifyVisible=t},close:e.close}},[t("el-form",{ref:"clientRef",attrs:{model:e.addData,rules:e.clientRule,"label-position":"right","label-width":"150px"}},[t("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"产品名称",prop:"courseName"}},[e._v(" "+e._s(e.addData.courseName)+" ")]),t("el-form-item",{staticStyle:{width:"100%",height:"330px",overflow:"hidden"},attrs:{label:"课程套餐:",prop:"ids"}},[t("BasicTable",{ref:"courseTableRef",attrs:{height:"300px",selectType:"multi",hasCard:!1,hasPage:!1,hasSort:!1,columns:e.columns,isShowTableHead:!1,data:e.tableData},on:{"selection-change":e.handleSelectionChange},model:{value:e.addData.ids,callback:function(t){e.$set(e.addData,"ids",t)},expression:"addData.ids"}})],1),t("el-form-item",{attrs:{label:"开始时间:",prop:"time"}},[t("jat-date-picker",{attrs:{width:"100%",clearable:"",type:"daterange",placeholder:"请选择订单时间",size:"small"},model:{value:e.addData.time,callback:function(t){e.$set(e.addData,"time",t)},expression:"addData.time"}})],1),t("el-form-item",{attrs:{label:"市场价:",prop:"marketPrice"}},[t("jat-input",{directives:[{name:"input",rawName:"v-input.float",value:2,expression:"2",modifiers:{float:!0}}],attrs:{placeholder:"请输入市场价"},model:{value:e.addData.marketPrice,callback:function(t){e.$set(e.addData,"marketPrice",t)},expression:"addData.marketPrice"}})],1),t("el-form-item",{attrs:{label:"下单者:",prop:"vipAdId"}},[t("el-select",{ref:"selectOpenCourse",staticStyle:{width:"100%"},attrs:{size:"small",clearable:"",filterable:"",remote:"",placeholder:"代客下单选择会员账号，自己下单选择管理员账号","remote-method":t=>e.remoteMethod(t,""),loading:e.remoteLoading},on:{"hook:mounted":e.cancalReadOnly,"visible-change":e.cancalReadOnly},model:{value:e.addData.vipAdId,callback:function(t){e.$set(e.addData,"vipAdId",t)},expression:"addData.vipAdId"}},e._l(e.userAllOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name?e.name:e.account+"(学籍未注册)",value:e.id}})})),1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)],1)},i=[],o=n("c46c"),a=n("b775"),s=n("b893"),l=n("7591"),u={components:{uploadFile:o["a"],BasicTable:l["a"]},data(){return{addModifyVisible:!1,remoteLoading:!1,dialogTitle:"",tableData:[],userAdminOptions:[],userAllOptions:[],categoryOptions:[],columns:[{id:1,prop:"name",label:"课程名称"},{id:2,prop:"marketPrice",label:"市场价"},{id:3,prop:"costPrice",label:"成本价"}],addData:{id:"",vipAdId:"",ids:"",orderNum:"",marketPrice:"",time:[]},clientRule:{vipAdId:[{required:!0,message:"请输入下单者",trigger:"blur"}],time:[{required:!0,message:"请选择开始时间",trigger:"blur"}],marketPrice:[{required:!0,message:"请输入市场价",trigger:"blur"}]}}},mounted(){this.getCategoryList()},methods:{edit(e){const{orderNum:t,courseName:n,courseIds:r,vipAdId:i,vipName:o,marketPrice:a,startTime:l,endTime:u}=e;this.dialogTitle="开通课程",this.addModifyVisible=!0,this.userAllOptions=[{id:i,name:o}],this.addData={orderNum:t,courseName:n,courseIds:r,marketPrice:a,time:[Object(s["b"])(l,"yyyy-MM-dd"),Object(s["b"])(u,"yyyy-MM-dd")],vipAdId:i},this.getCourseList(r),this.cancalReadOnly()},close(){this.$refs.clientRef&&this.$refs.clientRef.clearValidate(),this.addData={id:"",vipAdId:"",ids:"",orderNum:"",marketPrice:"",time:[]},this.addModifyVisible=!1},getCurrentUser(){const e=sessionStorage.getItem("id")?parseInt(sessionStorage.getItem("id")):"";this.userAdminOptions=[{id:e,name:sessionStorage.getItem("userName")}],this.addData.profitAdId=e},getCourseList(e){a["a"].post({url:"/system/sysCourseOrder/queryCourseById",params:{ids:e},success:e=>{this.tableData=e,this.$nextTick(()=>{this.tableData.forEach(e=>{this.$refs.courseTableRef.$refs.basicTable.$refs.multipleTable.toggleRowSelection(e)})})}})},getCategoryList(){a["a"].post({url:"system/sysCategory/listNoPage",params:{type:4},success:e=>{this.categoryOptions=e}})},cancalReadOnly(e){this.$nextTick(()=>{if(!e){const{selectOpenCourse:e}=this.$refs,t=e.$el.querySelector(".el-input__inner");t.removeAttribute("readonly")}})},handleSubmit(){this.$refs.clientRef.validate(e=>{const{ids:t,time:n,courseName:r,...i}=this.addData;t.length<1?this.$message.error("请选择要开通的课程套餐"):e&&a["a"].post({url:"/system/sysCourseOrder/openCourseEdit",params:{...i,courseIds:JSON.stringify(t),startTime:n&&n.length>0?n[0]:"",endTime:n&&n.length>0?n[1]:""},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}})})},handleSelectionChange(e){this.addData.ids=e.map(e=>e.id)},remoteMethod(e,t){e&&(this.remoteLoading=!0,a["a"].post({url:"/admin/adInfo/queryAdminByNameOrPhone",params:{search:e,type:t},success:e=>{this.remoteLoading=!1,0===t?this.userAdminOptions=e:this.userAllOptions=e},catch:()=>{this.remoteLoading=!1}}))}}},c=u,d=(n("02f0"),n("1805")),f=Object(d["a"])(c,r,i,!1,null,"4f203459",null);t["default"]=f.exports},"88e9":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"布置作业",width:"60%",visible:e.courseWorkVisible},on:{"update:visible":function(t){e.courseWorkVisible=t}}},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"max-height":"500px"}},[t("BasicTable",{attrs:{columns:e.table.columns,height:"400px",operates:e.operates,operateWidth:"130px","row-key":"id",hasCard:!1,isShowTableHead:!1,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total,hasPage:!1,hasSort:!1,"default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"}},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange}}),t("addCourseWork",{ref:"addWordDia",on:{success:e.handleSuccess}})],1)])},i=[],o=n("7591"),a=n("b775"),s=n("dffa"),l={name:"workChapters",components:{BasicTable:o["a"],addCourseWork:s["default"]},data(){return{loading:!1,courseWorkVisible:!1,remoteLoading:!1,openLiveVisible:!1,openLiveData:{},supervisorAdOptions:[],categoryOptions:[],filterOptions:{column:[]},remoteLoading:!1,teacherOptions:[],filterData:{id:""},table:{columns:[{id:1,prop:"name",label:"章节名称",align:"left",width:"180px"},{id:2,type:"image",prop:"image",label:"封面",width:"100px"},{id:3,prop:"url",type:"video",width:"230px",label:"视频"},{id:4,prop:"lengthTime",label:"视频时长"}],pageSize:20,currentPage:1,data:[],total:0},operates:[{key:"edit",title:"布置作业",permission:"admin/adCourseWork/add",btnStyle:"yellow",action:(e,t)=>{this.$refs.addWordDia.open(t)},show:e=>-1!==e.parentId}]}},computed:{},mounted(){},created(){},methods:{open(e){this.courseWorkVisible=!0,this.filterData.id=e.id,this.getList()},searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0,a["a"].post({url:"/admin/adCourseChapters/list",params:{...this.filterData},success:e=>{this.table.data=e.map(e=>({...e.parent,children:e.sonList.map(t=>({...t,parentInfo:e.parent}))})),this.loading=!1},catch:()=>{this.loading=!1}})},handleSuccess(){this.getList()},onCopy(){this.$message.success("复制成功")},handleClose(){this.openLiveData={}},clearFilter(){this.filterData={id:""},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()},handleDelete(e){this.$confirm("此操作将会删除该章节, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/admin/adCourseChapters/remove",params:{id:e.id},success:e=>{this.$message.success(e),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})}}},u=l,c=(n("9615"),n("1805")),d=Object(c["a"])(u,r,i,!1,null,"212bf72c",null);t["default"]=d.exports},8908:function(e,t,n){"use strict";n("a7ac")},"8a44":function(e,t){tinymce.IconManager.add("default",{icons:{"accessibility-check":'<svg width="24" height="24"><path d="M12 2a2 2 0 012 2 2 2 0 01-2 2 2 2 0 01-2-2c0-1.1.9-2 2-2zm8 7h-5v12c0 .6-.4 1-1 1a1 1 0 01-1-1v-5c0-.6-.4-1-1-1a1 1 0 00-1 1v5c0 .6-.4 1-1 1a1 1 0 01-1-1V9H4a1 1 0 110-2h16c.6 0 1 .4 1 1s-.4 1-1 1z" fill-rule="nonzero"/></svg>',"action-next":'<svg width="24" height="24"><path fill-rule="nonzero" d="M5.7 7.3a1 1 0 00-1.4 1.4l7.7 7.7 7.7-7.7a1 1 0 10-1.4-1.4L12 13.6 5.7 7.3z"/></svg>',"action-prev":'<svg width="24" height="24"><path fill-rule="nonzero" d="M18.3 15.7a1 1 0 001.4-1.4L12 6.6l-7.7 7.7a1 1 0 001.4 1.4L12 9.4l6.3 6.3z"/></svg>',"align-center":'<svg width="24" height="24"><path d="M5 5h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 110-2zm3 4h8c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 110-2zm0 8h8c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 010-2zm-3-4h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 010-2z" fill-rule="evenodd"/></svg>',"align-justify":'<svg width="24" height="24"><path d="M5 5h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 110-2zm0 4h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 110-2zm0 4h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 010-2zm0 4h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 010-2z" fill-rule="evenodd"/></svg>',"align-left":'<svg width="24" height="24"><path d="M5 5h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 110-2zm0 4h8c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 110-2zm0 8h8c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 010-2zm0-4h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 010-2z" fill-rule="evenodd"/></svg>',"align-none":'<svg width="24" height="24"><path d="M14.2 5L13 7H5a1 1 0 110-2h9.2zm4 0h.8a1 1 0 010 2h-2l1.2-2zm-6.4 4l-1.2 2H5a1 1 0 010-2h6.8zm4 0H19a1 1 0 010 2h-4.4l1.2-2zm-6.4 4l-1.2 2H5a1 1 0 010-2h4.4zm4 0H19a1 1 0 010 2h-6.8l1.2-2zM7 17l-1.2 2H5a1 1 0 010-2h2zm4 0h8a1 1 0 010 2H9.8l1.2-2zm5.2-13.5l1.3.7-9.7 16.3-1.3-.7 9.7-16.3z" fill-rule="evenodd"/></svg>',"align-right":'<svg width="24" height="24"><path d="M5 5h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 110-2zm6 4h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 010-2zm0 8h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 010-2zm-6-4h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 010-2z" fill-rule="evenodd"/></svg>',"arrow-left":'<svg width="24" height="24"><path d="M5.6 13l12 6a1 1 0 001.4-1V6a1 1 0 00-1.4-.9l-12 6a1 1 0 000 1.8z" fill-rule="evenodd"/></svg>',"arrow-right":'<svg width="24" height="24"><path d="M18.5 13l-12 6A1 1 0 015 18V6a1 1 0 011.4-.9l12 6a1 1 0 010 1.8z" fill-rule="evenodd"/></svg>',bold:'<svg width="24" height="24"><path d="M7.8 19c-.3 0-.5 0-.6-.2l-.2-.5V5.7c0-.2 0-.4.2-.5l.6-.2h5c1.5 0 2.7.3 3.5 1 .7.6 1.1 1.4 1.1 2.5a3 3 0 01-.6 1.9c-.4.6-1 1-1.6 1.2.4.1.9.3 1.3.6s.8.7 1 1.2c.4.4.5 1 .5 1.6 0 1.3-.4 2.3-1.3 3-.8.7-2.1 1-3.8 1H7.8zm5-8.3c.6 0 1.2-.1 1.6-.5.4-.3.6-.7.6-1.3 0-1.1-.8-1.7-2.3-1.7H9.3v3.5h3.4zm.5 6c.7 0 1.3-.1 1.7-.4.4-.4.6-.9.6-1.5s-.2-1-.7-1.4c-.4-.3-1-.4-2-.4H9.4v3.8h4z" fill-rule="evenodd"/></svg>',bookmark:'<svg width="24" height="24"><path d="M6 4v17l6-4 6 4V4c0-.6-.4-1-1-1H7a1 1 0 00-1 1z" fill-rule="nonzero"/></svg>',"border-style":'<svg width="24" height="24"><g fill-rule="evenodd"><rect width="18" height="2" x="3" y="6" rx="1"/><rect width="2.8" height="2" x="3" y="16" rx="1"/><rect width="2.8" height="2" x="6.8" y="16" rx="1"/><rect width="2.8" height="2" x="10.6" y="16" rx="1"/><rect width="2.8" height="2" x="14.4" y="16" rx="1"/><rect width="2.8" height="2" x="18.2" y="16" rx="1"/><rect width="8" height="2" x="3" y="11" rx="1"/><rect width="8" height="2" x="13" y="11" rx="1"/></g></svg>',"border-width":'<svg width="24" height="24"><g fill-rule="evenodd"><rect width="18" height="5" x="3" y="5" rx="1"/><rect width="18" height="3.5" x="3" y="11.5" rx="1"/><rect width="18" height="2" x="3" y="17" rx="1"/></g></svg>',brightness:'<svg width="24" height="24"><path d="M12 17c.3 0 .5.1.7.3.2.2.3.4.3.7v1c0 .3-.1.5-.3.7a1 1 0 01-.7.3 1 1 0 01-.7-.3 1 1 0 01-.3-.7v-1c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3zm0-10a1 1 0 01-.7-.3A1 1 0 0111 6V5c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3.3 0 .5.1.7.3.2.2.3.4.3.7v1c0 .3-.1.5-.3.7a1 1 0 01-.7.3zm7 4c.3 0 .5.1.7.3.2.2.3.4.3.7 0 .3-.1.5-.3.7a1 1 0 01-.7.3h-1a1 1 0 01-.7-.3 1 1 0 01-.3-.7c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3h1zM7 12c0 .3-.1.5-.3.7a1 1 0 01-.7.3H5a1 1 0 01-.7-.3A1 1 0 014 12c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3h1c.3 0 .5.1.7.3.2.2.3.4.3.7zm10 3.5l.7.8c.2.1.3.4.3.6 0 .3-.1.6-.3.8a1 1 0 01-.8.3 1 1 0 01-.6-.3l-.8-.7a1 1 0 01-.3-.8c0-.2.1-.5.3-.7a1 1 0 011.4 0zm-10-7l-.7-.8a1 1 0 01-.3-.6c0-.3.1-.6.3-.8.2-.2.5-.3.8-.3.2 0 .5.1.7.3l.7.7c.2.2.3.5.3.8 0 .2-.1.5-.3.7a1 1 0 01-.7.3 1 1 0 01-.8-.3zm10 0a1 1 0 01-.8.3 1 1 0 01-.7-.3 1 1 0 01-.3-.7c0-.3.1-.6.3-.8l.8-.7c.1-.2.4-.3.6-.3.3 0 .6.1.8.3.2.2.3.5.3.8 0 .2-.1.5-.3.7l-.7.7zm-10 7c.2-.2.5-.3.8-.3.2 0 .5.1.7.3a1 1 0 010 1.4l-.8.8a1 1 0 01-.6.3 1 1 0 01-.8-.3 1 1 0 01-.3-.8c0-.2.1-.5.3-.6l.7-.8zM12 8a4 4 0 013.7 2.4 4 4 0 010 3.2A4 4 0 0112 16a4 4 0 01-3.7-2.4 4 4 0 010-3.2A4 4 0 0112 8zm0 6.5c.7 0 1.3-.2 1.8-.7.5-.5.7-1.1.7-1.8s-.2-1.3-.7-1.8c-.5-.5-1.1-.7-1.8-.7s-1.3.2-1.8.7c-.5.5-.7 1.1-.7 1.8s.2 1.3.7 1.8c.5.5 1.1.7 1.8.7z" fill-rule="evenodd"/></svg>',browse:'<svg width="24" height="24"><path d="M19 4a2 2 0 012 2v12a2 2 0 01-2 2h-4v-2h4V8H5v10h4v2H5a2 2 0 01-2-2V6c0-1.1.9-2 2-2h14zm-8 9.4l-2.3 2.3a1 1 0 11-1.4-1.4l4-4a1 1 0 011.4 0l4 4a1 1 0 01-1.4 1.4L13 13.4V20a1 1 0 01-2 0v-6.6z" fill-rule="nonzero"/></svg>',cancel:'<svg width="24" height="24"><path d="M12 4.6a7.4 7.4 0 110 14.8 7.4 7.4 0 010-14.8zM12 3a9 9 0 100 18 9 9 0 000-18zm0 8L14.8 8l1 1.1-2.7 2.8 2.7 2.7-1.1 1.1-2.7-2.7-2.7 2.7-1-1.1 2.6-2.7-2.7-2.7 1-1.1 2.8 2.7z" fill-rule="nonzero"/></svg>',"cell-background-color":'<svg width="24" height="24"><path d="M15.7 2l1.6 1.6-2.7 2.6 5.9 5.8c.7.7.7 1.7 0 2.4l-6.3 6.1a1.7 1.7 0 01-2.4 0l-6.3-6.1c-.7-.7-.7-1.7 0-2.4L15.7 2zM18 12l-4.5-4L9 12h9zM4 16s2 2.4 2 3.8C6 21 5.1 22 4 22s-2-1-2-2.2C2 18.4 4 16 4 16z"/></svg>',"cell-border-color":'<svg width="24" height="24"><g fill-rule="evenodd"><path fill-rule="nonzero" d="M5 13v5h2v2H5a2 2 0 01-2-2v-5h2zm8-7V4h6a2 2 0 012 2h-8z" opacity=".2"/><path fill-rule="nonzero" d="M13 4v2H5v7H3V6c0-1.1.9-2 2-2h8zm-2.6 14.1l.1-.1.1.1.2.3.2.2.2.2c.4.6.8 1.2.8 1.7 0 .8-.7 1.5-1.5 1.5S9 21.3 9 20.5c0-.5.4-1.1.8-1.7l.2-.2.2-.2.2-.3z"/><path d="M13 11l-2 2H5v-2h6V6h2z"/><path fill-rule="nonzero" d="M18.4 8l1 1-1.8 1.9 4 4c.5.4.5 1.1 0 1.6l-4.3 4.2a1.2 1.2 0 01-1.6 0l-4.4-4.2c-.4-.5-.4-1.2 0-1.7l7-6.8zm1.6 7l-3-3-3 3h6z"/></g></svg>',"change-case":'<svg width="24" height="24"><path d="M18.4 18.2v-.6c-.5.8-1.3 1.2-2.4 1.2-2.2 0-3.3-1.6-3.3-4.8 0-3.1 1-4.7 3.3-4.7 1.1 0 1.8.3 2.4 1.1v-.6c0-.5.4-.8.8-.8s.8.3.8.8v8.4c0 .5-.4.8-.8.8a.8.8 0 01-.8-.8zm-2-7.4c-1.3 0-1.8.9-1.8 3.2 0 2.4.5 3.3 1.7 3.3 1.3 0 1.8-.9 1.8-3.2 0-2.4-.5-3.3-1.7-3.3zM10 15.7H5.5l-.8 2.6a1 1 0 01-1 .7h-.2a.7.7 0 01-.7-1l4-12a1 1 0 012 0l4 12a.7.7 0 01-.8 1h-.2a1 1 0 01-1-.7l-.8-2.6zm-.3-1.5l-2-6.5-1.9 6.5h3.9z" fill-rule="evenodd"/></svg>',"character-count":'<svg width="24" height="24"><path d="M4 11.5h16v1H4v-1zm4.8-6.8V10H7.7V5.8h-1v-1h2zM11 8.3V9h2v1h-3V7.7l2-1v-.9h-2v-1h3v2.4l-2 1zm6.3-3.4V10h-3.1V9h2.1V8h-2.1V6.8h2.1v-1h-2.1v-1h3.1zM5.8 16.4c0-.5.2-.8.5-1 .2-.2.6-.3 1.2-.3l.8.1c.2 0 .4.2.5.3l.4.4v2.8l.2.3H8.2v-.1-.2l-.6.3H7c-.4 0-.7 0-1-.2a1 1 0 01-.3-.9c0-.3 0-.6.3-.8.3-.2.7-.4 1.2-.4l.6-.2h.3v-.2l-.1-.2a.8.8 0 00-.5-.1 1 1 0 00-.4 0l-.3.4h-1zm2.3.8h-.2l-.2.1-.4.1a1 1 0 00-.4.2l-.2.2.1.3.5.1h.4l.4-.4v-.6zm2-3.4h1.2v1.7l.5-.3h.5c.5 0 .9.1 1.2.5.3.4.5.8.5 1.4 0 .6-.2 1.1-.5 1.5-.3.4-.7.6-1.3.6l-.6-.1-.4-.4v.4h-1.1v-5.4zm1.1 3.3c0 .3 0 .6.2.8a.7.7 0 001.2 0l.2-.8c0-.4 0-.6-.2-.8a.7.7 0 00-.6-.3l-.6.3-.2.8zm6.1-.5c0-.2 0-.3-.2-.4a.8.8 0 00-.5-.2c-.3 0-.5.1-.6.3l-.2.9c0 .3 0 .6.2.8.1.2.3.3.6.3.2 0 .4 0 .5-.2l.2-.4h1.1c0 .5-.3.8-.6 1.1a2 2 0 01-1.3.4c-.5 0-1-.2-1.3-.6a2 2 0 01-.5-1.4c0-.6.1-1.1.5-1.5.3-.4.8-.5 1.4-.5.5 0 1 0 1.2.3.4.3.5.7.5 1.2h-1v-.1z" fill-rule="evenodd"/></svg>',"checklist-rtl":'<svg width="24" height="24"><path d="M5 17h8c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 010-2zm0-6h8c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 010-2zm0-6h8c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 110-2zm14.2 11c.2-.4.6-.5.9-.3.3.2.4.6.2 1L18 20c-.2.3-.7.4-1 0l-1.3-1.3a.7.7 0 010-1c.3-.2.7-.2 1 0l.7.9 1.7-2.8zm0-6c.2-.4.6-.5.9-.3.3.2.4.6.2 1L18 14c-.2.3-.7.4-1 0l-1.3-1.3a.7.7 0 010-1c.3-.2.7-.2 1 0l.7.9 1.7-2.8zm0-6c.2-.4.6-.5.9-.3.3.2.4.6.2 1L18 8c-.2.3-.7.4-1 0l-1.3-1.3a.7.7 0 010-1c.3-.2.7-.2 1 0l.7.9 1.7-2.8z" fill-rule="evenodd"/></svg>',checklist:'<svg width="24" height="24"><path d="M11 17h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 010-2zm0-6h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 010-2zm0-6h8a1 1 0 010 2h-8a1 1 0 010-2zM7.2 16c.2-.4.6-.5.9-.3.3.2.4.6.2 1L6 20c-.2.3-.7.4-1 0l-1.3-1.3a.7.7 0 010-1c.3-.2.7-.2 1 0l.7.9 1.7-2.8zm0-6c.2-.4.6-.5.9-.3.3.2.4.6.2 1L6 14c-.2.3-.7.4-1 0l-1.3-1.3a.7.7 0 010-1c.3-.2.7-.2 1 0l.7.9 1.7-2.8zm0-6c.2-.4.6-.5.9-.3.3.2.4.6.2 1L6 8c-.2.3-.7.4-1 0L3.8 6.9a.7.7 0 010-1c.3-.2.7-.2 1 0l.7.9 1.7-2.8z" fill-rule="evenodd"/></svg>',checkmark:'<svg width="24" height="24"><path d="M18.2 5.4a1 1 0 011.6 1.2l-8 12a1 1 0 01-1.5.1l-5-5a1 1 0 111.4-1.4l4.1 4.1 7.4-11z" fill-rule="nonzero"/></svg>',"chevron-down":'<svg width="10" height="10"><path d="M8.7 2.2c.3-.3.8-.3 1 0 .4.4.4.9 0 1.2L5.7 7.8c-.3.3-.9.3-1.2 0L.2 3.4a.8.8 0 010-1.2c.3-.3.8-.3 1.1 0L5 6l3.7-3.8z" fill-rule="nonzero"/></svg>',"chevron-left":'<svg width="10" height="10"><path d="M7.8 1.3L4 5l3.8 3.7c.3.3.3.8 0 1-.4.4-.9.4-1.2 0L2.2 5.7a.8.8 0 010-1.2L6.6.2C7 0 7.4 0 7.8.2c.3.3.3.8 0 1.1z" fill-rule="nonzero"/></svg>',"chevron-right":'<svg width="10" height="10"><path d="M2.2 1.3a.8.8 0 010-1c.4-.4.9-.4 1.2 0l4.4 4.1c.3.4.3.9 0 1.2L3.4 9.8c-.3.3-.8.3-1.2 0a.8.8 0 010-1.1L6 5 2.2 1.3z" fill-rule="nonzero"/></svg>',"chevron-up":'<svg width="10" height="10"><path d="M8.7 7.8L5 4 1.3 7.8c-.3.3-.8.3-1 0a.8.8 0 010-1.2l4.1-4.4c.3-.3.9-.3 1.2 0l4.2 4.4c.3.3.3.9 0 1.2-.3.3-.8.3-1.1 0z" fill-rule="nonzero"/></svg>',close:'<svg width="24" height="24"><path d="M17.3 8.2L13.4 12l3.9 3.8a1 1 0 01-1.5 1.5L12 13.4l-3.8 3.9a1 1 0 01-1.5-1.5l3.9-3.8-3.9-3.8a1 1 0 011.5-1.5l3.8 3.9 3.8-3.9a1 1 0 011.5 1.5z" fill-rule="evenodd"/></svg>',"code-sample":'<svg width="24" height="26"><path d="M7.1 11a2.8 2.8 0 01-.8 2 2.8 2.8 0 01.8 2v1.7c0 .3.1.6.4.8.2.3.5.4.8.4.3 0 .4.2.4.4v.8c0 .2-.1.4-.4.4-.7 0-1.4-.3-2-.8-.5-.6-.8-1.3-.8-2V15c0-.3-.1-.6-.4-.8-.2-.3-.5-.4-.8-.4a.4.4 0 01-.4-.4v-.8c0-.2.2-.4.4-.4.3 0 .6-.1.8-.4.3-.2.4-.5.4-.8V9.3c0-.7.3-1.4.8-2 .6-.5 1.3-.8 2-.8.3 0 .4.2.4.4v.8c0 .2-.1.4-.4.4-.3 0-.6.1-.8.4-.3.2-.4.5-.4.8V11zm9.8 0V9.3c0-.3-.1-.6-.4-.8-.2-.3-.5-.4-.8-.4a.4.4 0 01-.4-.4V7c0-.2.1-.4.4-.4.7 0 1.4.3 2 .8.5.6.8 1.3.8 2V11c0 .3.1.6.4.8.2.3.5.4.8.4.2 0 .4.2.4.4v.8c0 .2-.2.4-.4.4-.3 0-.6.1-.8.4-.3.2-.4.5-.4.8v1.7c0 .7-.3 1.4-.8 2-.6.5-1.3.8-2 .8a.4.4 0 01-.4-.4v-.8c0-.2.1-.4.4-.4.3 0 .6-.1.8-.4.3-.2.4-.5.4-.8V15a2.8 2.8 0 01.8-2 2.8 2.8 0 01-.8-2zm-3.3-.4c0 .4-.1.8-.5 1.1-.3.3-.7.5-1.1.5-.4 0-.8-.2-1.1-.5-.4-.3-.5-.7-.5-1.1 0-.5.1-.9.5-1.2.3-.3.7-.4 1.1-.4.4 0 .8.1 1.1.4.4.3.5.7.5 1.2zM12 13c.4 0 .8.1 1.1.5.4.3.5.7.5 1.1 0 1-.1 1.6-.5 2a3 3 0 01-1.1 1c-.4.3-.8.4-1.1.4a.5.5 0 01-.5-.5V17a3 3 0 001-.2l.6-.6c-.6 0-1-.2-1.3-.5-.2-.3-.3-.7-.3-1 0-.5.1-1 .5-1.2.3-.4.7-.5 1.1-.5z" fill-rule="evenodd"/></svg>',"color-levels":'<svg width="24" height="24"><path d="M17.5 11.4A9 9 0 0118 14c0 .5 0 1-.2 1.4 0 .4-.3.9-.5 1.3a6.2 6.2 0 01-3.7 3 5.7 5.7 0 01-3.2 0A5.9 5.9 0 017.6 18a6.2 6.2 0 01-1.4-2.6 6.7 6.7 0 010-2.8c0-.4.1-.9.3-1.3a13.6 13.6 0 012.3-4A20 20 0 0112 4a26.4 26.4 0 013.2 3.4 18.2 18.2 0 012.3 4zm-2 4.5c.4-.7.5-1.4.5-2a7.3 7.3 0 00-1-3.2c.2.6.2 1.2.2 1.9a4.5 4.5 0 01-1.3 3 5.3 5.3 0 01-2.3 1.5 4.9 4.9 0 01-2 .1 4.3 4.3 0 002.4.8 4 4 0 002-.6 4 4 0 001.5-1.5z" fill-rule="evenodd"/></svg>',"color-picker":'<svg width="24" height="24"><path d="M12 3a9 9 0 000 18 1.5 1.5 0 001.1-2.5c-.2-.3-.4-.6-.4-1 0-.8.7-1.5 1.5-1.5H16a5 5 0 005-5c0-4.4-4-8-9-8zm-5.5 9a1.5 1.5 0 110-3 1.5 1.5 0 010 3zm3-4a1.5 1.5 0 110-3 1.5 1.5 0 010 3zm5 0a1.5 1.5 0 110-3 1.5 1.5 0 010 3zm3 4a1.5 1.5 0 110-3 1.5 1.5 0 010 3z" fill-rule="nonzero"/></svg>',"color-swatch-remove-color":'<svg width="24" height="24"><path stroke="#000" stroke-width="2" d="M21 3L3 21" fill-rule="evenodd"/></svg>',"color-swatch":'<svg width="24" height="24"><rect x="3" y="3" width="18" height="18" rx="1" fill-rule="evenodd"/></svg>',"comment-add":'<svg width="24" height="24"><g fill-rule="nonzero"><path d="M9 19l3-2h7c.6 0 1-.4 1-1V6c0-.6-.4-1-1-1H5a1 1 0 00-1 1v10c0 .6.4 1 1 1h4v2zm-2 4v-4H5a3 3 0 01-3-3V6a3 3 0 013-3h14a3 3 0 013 3v10a3 3 0 01-3 3h-6.4L7 23z"/><path d="M13 10h2a1 1 0 010 2h-2v2a1 1 0 01-2 0v-2H9a1 1 0 010-2h2V8a1 1 0 012 0v2z"/></g></svg>',comment:'<svg width="24" height="24"><path fill-rule="nonzero" d="M9 19l3-2h7c.6 0 1-.4 1-1V6c0-.6-.4-1-1-1H5a1 1 0 00-1 1v10c0 .6.4 1 1 1h4v2zm-2 4v-4H5a3 3 0 01-3-3V6a3 3 0 013-3h14a3 3 0 013 3v10a3 3 0 01-3 3h-6.4L7 23z"/></svg>',contrast:'<svg width="24" height="24"><path d="M12 4a7.8 7.8 0 015.7 2.3A8 8 0 1112 4zm-6 8a6 6 0 006 6V6a6 6 0 00-6 6z" fill-rule="evenodd"/></svg>',copy:'<svg width="24" height="24"><path d="M16 3H6a2 2 0 00-2 2v11h2V5h10V3zm1 4a2 2 0 012 2v10a2 2 0 01-2 2h-7a2 2 0 01-2-2V9c0-1.2.9-2 2-2h7zm0 12V9h-7v10h7z" fill-rule="nonzero"/></svg>',crop:'<svg width="24" height="24"><path d="M17 8v7h2c.6 0 1 .4 1 1s-.4 1-1 1h-2v2c0 .6-.4 1-1 1a1 1 0 01-1-1v-2H7V9H5a1 1 0 110-2h2V5c0-.6.4-1 1-1s1 .4 1 1v2h7l3-3 1 1-3 3zM9 9v5l5-5H9zm1 6h5v-5l-5 5z" fill-rule="evenodd"/></svg>',"cut-column":'<svg width="24" height="24"><path fill-rule="evenodd" d="M7.2 4.5c.9 0 1.6.4 2.2 1A3.7 3.7 0 0110.5 8v.5l1 1 4-4 1-.5a3.3 3.3 0 012 0c.4 0 .7.3 1 .5L17 8h4v13h-6V10l-1.5 1.5.5.5v4l-2.5-2.5-1 1v.5c0 .4 0 .8-.3 1.2-.2.5-.4.9-.8 1.2-.6.7-1.3 1-2.2 1-.8.2-1.5 0-2-.6l-.5-.8-.2-1c0-.4 0-.8.3-1.2A3.9 3.9 0 017 12.7c.5-.2 1-.3 1.5-.2l1-1-1-1c-.5 0-1 0-1.5-.2-.5-.1-1-.4-1.4-.9-.4-.3-.6-.7-.8-1.2L4.5 7c0-.4 0-.7.2-1 0-.3.3-.6.5-.8.5-.5 1.2-.8 2-.7zm12.3 5h-3v10h3v-10zM8 13.8h-.3l-.4.2a2.8 2.8 0 00-.7.4v.1a2.8 2.8 0 00-.6.8l-.1.4v.7l.2.5.5.2h.7a2.6 2.6 0 00.8-.3 2.4 2.4 0 00.7-.7 2.5 2.5 0 00.3-.8 1.5 1.5 0 000-.8 1 1 0 00-.2-.4 1 1 0 00-.5-.2H8zm3.5-3.7c-.4 0-.7.1-1 .4-.3.3-.4.6-.4 1s.1.7.4 1c.3.3.6.4 1 .4s.7-.1 1-.4c.3-.3.4-.6.4-1s-.1-.7-.4-1c-.3-.3-.6-.4-1-.4zM7 5.8h-.4a1 1 0 00-.5.3 1 1 0 00-.2.5v.7a2.5 2.5 0 00.3.8l.2.3h.1l.4.4.4.2.4.1h.7L9 9l.2-.4a1.6 1.6 0 000-.8 2.6 2.6 0 00-.3-.8A2.5 2.5 0 007.7 6l-.4-.1H7z"/></svg>',"cut-row":'<svg width="24" height="24"><path fill-rule="evenodd" d="M22 3v5H9l3 3 2-2h4l-4 4 1 1h.5c.4 0 .8 0 1.2.3.5.2.9.4 1.2.8.7.6 1 1.3 1 2.2.2.8 0 1.5-.6 2l-.8.5-1 .2c-.4 0-.8 0-1.2-.3a3.9 3.9 0 01-2.1-2.2c-.2-.5-.3-1-.2-1.5l-1-1-1 1c0 .5 0 1-.2 1.5-.1.5-.4 1-.9 1.4-.3.4-.7.6-1.2.8l-1.2.3c-.4 0-.7 0-1-.2-.3 0-.6-.3-.8-.5-.5-.5-.8-1.2-.7-2 0-.9.4-1.6 1-2.2A3.7 3.7 0 018.6 14H9l1-1-4-4-.5-1a3.3 3.3 0 010-2c0-.4.3-.7.5-1l2 2V3h14zM8.5 15.3h-.3a2.6 2.6 0 00-.8.4 2.5 2.5 0 00-.9 1.1l-.1.4v.7l.2.5.5.2h.7a2.5 2.5 0 00.8-.3L9 18V18l.4-.4.2-.4.1-.4v-.3-.4a1 1 0 00-.2-.5 1 1 0 00-.4-.2h-.5zm7 0H15a1 1 0 00-.4.3 1 1 0 00-.2.5 1.5 1.5 0 000 .7v.4a2.8 2.8 0 00.5.7h.1a2.8 2.8 0 00.8.6l.4.1h.7l.5-.2.2-.5v-.4-.3a2.6 2.6 0 00-.3-.8 2.4 2.4 0 00-.7-.7 2.5 2.5 0 00-.8-.3h-.3zM12 11.6c-.4 0-.7.1-1 .4-.3.3-.4.6-.4 1s.1.7.4 1c.3.3.6.4 1 .4s.7-.1 1-.4c.3-.3.4-.6.4-1s-.1-.7-.4-1c-.3-.3-.6-.4-1-.4zm8.5-7.1h-11v2h11v-2z"/></svg>',cut:'<svg width="24" height="24"><path d="M18 15c.6.7 1 1.4 1 2.3 0 .8-.2 1.5-.7 2l-.8.5-1 .2c-.4 0-.8 0-1.2-.3a3.9 3.9 0 01-2.1-2.2c-.2-.5-.3-1-.2-1.5l-1-1-1 1c0 .5 0 1-.2 1.5-.1.5-.4 1-.9 1.4-.3.4-.7.6-1.2.8l-1.2.3c-.4 0-.7 0-1-.2-.3 0-.6-.3-.8-.5-.5-.5-.8-1.2-.7-2 0-.9.4-1.6 1-2.2A3.7 3.7 0 018.6 14H9l1-1-4-4-.5-1a3.3 3.3 0 010-2c0-.4.3-.7.5-1l6 6 6-6 .5 1a3.3 3.3 0 010 2c0 .4-.3.7-.5 1l-4 4 1 1h.5c.4 0 .8 0 1.2.3.5.2.9.4 1.2.8zm-8.5 2.2l.1-.4v-.3-.4a1 1 0 00-.2-.5 1 1 0 00-.4-.2 1.6 1.6 0 00-.8 0 2.6 2.6 0 00-.8.3 2.5 2.5 0 00-.9 1.1l-.1.4v.7l.2.5.5.2h.7a2.5 2.5 0 00.8-.3 2.8 2.8 0 001-1zm2.5-2.8c.4 0 .7-.1 1-.4.3-.3.4-.6.4-1s-.1-.7-.4-1c-.3-.3-.6-.4-1-.4s-.7.1-1 .4c-.3.3-.4.6-.4 1s.1.7.4 1c.3.3.6.4 1 .4zm5.4 4l.2-.5v-.4-.3a2.6 2.6 0 00-.3-.8 2.4 2.4 0 00-.7-.7 2.5 2.5 0 00-.8-.3 1.5 1.5 0 00-.8 0 1 1 0 00-.4.2 1 1 0 00-.2.5 1.5 1.5 0 000 .7v.4l.3.4.3.4a2.8 2.8 0 00.8.5l.4.1h.7l.5-.2z" fill-rule="evenodd"/></svg>',"document-properties":'<svg width="24" height="24"><path d="M14.4 3H7a2 2 0 00-2 2v14c0 1.1.9 2 2 2h10a2 2 0 002-2V7.6L14.4 3zM17 19H7V5h6v4h4v10z" fill-rule="nonzero"/></svg>',drag:'<svg width="24" height="24"><path d="M13 5h2v2h-2V5zm0 4h2v2h-2V9zM9 9h2v2H9V9zm4 4h2v2h-2v-2zm-4 0h2v2H9v-2zm0 4h2v2H9v-2zm4 0h2v2h-2v-2zM9 5h2v2H9V5z" fill-rule="evenodd"/></svg>',"duplicate-column":'<svg width="24" height="24"><path d="M17 6v16h-7V6h7zm-2 2h-3v12h3V8zm-2-6v2H8v15H6V2h7z"/></svg>',"duplicate-row":'<svg width="24" height="24"><path d="M22 11v7H6v-7h16zm-2 2H8v3h12v-3zm-1-6v2H4v5H2V7h17z"/></svg>',duplicate:'<svg width="24" height="24"><g fill-rule="nonzero"><path d="M16 3v2H6v11H4V5c0-1.1.9-2 2-2h10zm3 8h-2V9h-7v10h9a2 2 0 01-2 2h-7a2 2 0 01-2-2V9c0-1.2.9-2 2-2h7a2 2 0 012 2v2z"/><path d="M17 14h1a1 1 0 010 2h-1v1a1 1 0 01-2 0v-1h-1a1 1 0 010-2h1v-1a1 1 0 012 0v1z"/></g></svg>',"edit-block":'<svg width="24" height="24"><path fill-rule="nonzero" d="M19.8 8.8l-9.4 9.4c-.2.2-.5.4-.9.4l-5.4 1.2 1.2-5.4.5-.8 9.4-9.4c.7-.7 1.8-.7 2.5 0l2.1 2.1c.7.7.7 1.8 0 2.5zm-2-.2l1-.9v-.3l-2.2-2.2a.3.3 0 00-.3 0l-1 1L18 8.5zm-1 1l-2.5-2.4-6 6 2.5 2.5 6-6zm-7 7.1l-2.6-2.4-.3.3-.1.2-.7 3 3.1-.6h.1l.4-.5z"/></svg>',"edit-image":'<svg width="24" height="24"><path d="M18 16h2V7a2 2 0 00-2-2H7v2h11v9zM6 17h15a1 1 0 010 2h-1v1a1 1 0 01-2 0v-1H6a2 2 0 01-2-2V7H3a1 1 0 110-2h1V4a1 1 0 112 0v13zm3-5.3l1.3 2 3-4.7 3.7 6H7l2-3.3z" fill-rule="nonzero"/></svg>',"embed-page":'<svg width="24" height="24"><path d="M19 6V5H5v14h2A13 13 0 0119 6zm0 1.4c-.8.8-1.6 2.4-2.2 4.6H19V7.4zm0 5.6h-2.4c-.4 1.8-.6 3.8-.6 6h3v-6zm-4 6c0-2.2.2-4.2.6-6H13c-.7 1.8-1.1 3.8-1.1 6h3zm-4 0c0-2.2.4-4.2 1-6H9.6A12 12 0 008 19h3zM4 3h16c.6 0 1 .4 1 1v16c0 .6-.4 1-1 1H4a1 1 0 01-1-1V4c0-.6.4-1 1-1zm11.8 9c.4-1.9 1-3.4 1.8-4.5a9.2 9.2 0 00-4 4.5h2.2zm-3.4 0a12 12 0 012.8-4 12 12 0 00-5 4h2.2z" fill-rule="nonzero"/></svg>',embed:'<svg width="24" height="24"><path d="M4 3h16c.6 0 1 .4 1 1v16c0 .6-.4 1-1 1H4a1 1 0 01-1-1V4c0-.6.4-1 1-1zm1 2v14h14V5H5zm4.8 2.6l5.6 4a.5.5 0 010 .8l-5.6 4A.5.5 0 019 16V8a.5.5 0 01.8-.4z" fill-rule="nonzero"/></svg>',emoji:'<svg width="24" height="24"><path d="M9 11c.6 0 1-.4 1-1s-.4-1-1-1a1 1 0 00-1 1c0 .6.4 1 1 1zm6 0c.6 0 1-.4 1-1s-.4-1-1-1a1 1 0 00-1 1c0 .6.4 1 1 1zm-3 5.5c2.1 0 4-1.5 4.4-3.5H7.6c.5 2 2.3 3.5 4.4 3.5zM12 4a8 8 0 100 16 8 8 0 000-16zm0 14.5a6.5 6.5 0 110-13 6.5 6.5 0 010 13z" fill-rule="nonzero"/></svg>',export:'<svg width="24" height="24"><g fill-rule="nonzero"><path d="M14.4 3L18 7v1h-5V5H7v14h9a1 1 0 012 0c0 1-.8 2-1.9 2H7c-1 0-2-.8-2-1.9V5c0-1 .8-2 1.9-2h7.5z"/><path d="M18.1 12c.5 0 .9.4.9 1 0 .5-.3 1-.8 1h-7.3c-.5 0-.9-.4-.9-1 0-.5.3-1 .8-1h7.3z"/><path d="M16.4 9.2a1 1 0 011.4.2l2.4 3.6-2.4 3.6a1 1 0 01-1.7-1v-.2l1.7-2.4-1.6-2.4a1 1 0 01.2-1.4z"/></g></svg>',fill:'<svg width="24" height="26"><path d="M16.6 12l-9-9-1.4 1.4 2.4 2.4-5.2 5.1c-.5.6-.5 1.6 0 2.2L9 19.6a1.5 1.5 0 002.2 0l5.5-5.5c.5-.6.5-1.6 0-2.2zM5.2 13L10 8.2l4.8 4.8H5.2zM19 14.5s-2 2.2-2 3.5c0 1.1.9 2 2 2a2 2 0 002-2c0-1.3-2-3.5-2-3.5z" fill-rule="nonzero"/></svg>',"flip-horizontally":'<svg width="24" height="24"><path d="M14 19h2v-2h-2v2zm4-8h2V9h-2v2zM4 7v10c0 1.1.9 2 2 2h3v-2H6V7h3V5H6a2 2 0 00-2 2zm14-2v2h2a2 2 0 00-2-2zm-7 16h2V3h-2v18zm7-6h2v-2h-2v2zm-4-8h2V5h-2v2zm4 12a2 2 0 002-2h-2v2z" fill-rule="nonzero"/></svg>',"flip-vertically":'<svg width="24" height="24"><path d="M5 14v2h2v-2H5zm8 4v2h2v-2h-2zm4-14H7a2 2 0 00-2 2v3h2V6h10v3h2V6a2 2 0 00-2-2zm2 14h-2v2a2 2 0 002-2zM3 11v2h18v-2H3zm6 7v2h2v-2H9zm8-4v2h2v-2h-2zM5 18c0 1.1.9 2 2 2v-2H5z" fill-rule="nonzero"/></svg>',"format-painter":'<svg width="24" height="24"><path d="M18 5V4c0-.5-.4-1-1-1H5a1 1 0 00-1 1v4c0 .6.5 1 1 1h12c.6 0 1-.4 1-1V7h1v4H9v9c0 .6.4 1 1 1h2c.6 0 1-.4 1-1v-7h8V5h-3z" fill-rule="nonzero"/></svg>',format:'<svg width="24" height="24"><path fill-rule="evenodd" d="M17 5a1 1 0 010 2h-4v11a1 1 0 01-2 0V7H7a1 1 0 110-2h10z"/></svg>',fullscreen:'<svg width="24" height="24"><path d="M15.3 10l-1.2-1.3 2.9-3h-2.3a.9.9 0 110-1.7H19c.5 0 .9.4.9.9v4.4a.9.9 0 11-1.8 0V7l-2.9 3zm0 4l3 3v-2.3a.9.9 0 111.7 0V19c0 .5-.4.9-.9.9h-4.4a.9.9 0 110-1.8H17l-3-2.9 1.3-1.2zM10 15.4l-2.9 3h2.3a.9.9 0 110 1.7H5a.9.9 0 01-.9-.9v-4.4a.9.9 0 111.8 0V17l2.9-3 1.2 1.3zM8.7 10L5.7 7v2.3a.9.9 0 01-1.7 0V5c0-.5.4-.9.9-.9h4.4a.9.9 0 010 1.8H7l3 2.9-1.3 1.2z" fill-rule="nonzero"/></svg>',gallery:'<svg width="24" height="24"><path fill-rule="nonzero" d="M5 15.7l2.3-2.2c.3-.3.7-.3 1 0L11 16l5.1-5c.3-.4.8-.4 1 0l2 1.9V8H5v7.7zM5 18V19h3l1.8-1.9-2-2L5 17.9zm14-3l-2.5-2.4-6.4 6.5H19v-4zM4 6h16c.6 0 1 .4 1 1v13c0 .6-.4 1-1 1H4a1 1 0 01-1-1V7c0-.6.4-1 1-1zm6 7a2 2 0 110-4 2 2 0 010 4zM4.5 4h15a.5.5 0 110 1h-15a.5.5 0 010-1zm2-2h11a.5.5 0 110 1h-11a.5.5 0 010-1z"/></svg>',gamma:'<svg width="24" height="24"><path d="M4 3h16c.6 0 1 .4 1 1v16c0 .6-.4 1-1 1H4a1 1 0 01-1-1V4c0-.6.4-1 1-1zm1 2v14h14V5H5zm6.5 11.8V14L9.2 8.7a5.1 5.1 0 00-.4-.8l-.1-.2H8 8v-1l.3-.1.3-.1h.7a1 1 0 01.6.5l.1.3a8.5 8.5 0 01.3.6l1.9 4.6 2-5.2a1 1 0 011-.6.5.5 0 01.5.6L13 14v2.8a.7.7 0 01-1.4 0z" fill-rule="nonzero"/></svg>',help:'<svg width="24" height="24"><g fill-rule="evenodd"><path d="M12 5.5a6.5 6.5 0 00-6 9 6.3 6.3 0 001.4 2l1 1a6.3 6.3 0 003.6 1 6.5 6.5 0 006-9 6.3 6.3 0 00-1.4-2l-1-1a6.3 6.3 0 00-3.6-1zM12 4a7.8 7.8 0 015.7 2.3A8 8 0 1112 4z"/><path d="M9.6 9.7a.7.7 0 01-.7-.8c0-1.1 1.5-1.8 3.2-1.8 1.8 0 3.2.8 3.2 2.4 0 1.4-.4 2.1-1.5 2.8-.2 0-.3.1-.3.2a2 2 0 00-.8.8.8.8 0 01-1.4-.6c.3-.7.8-1 1.3-1.5l.4-.2c.7-.4.8-.6.8-1.5 0-.5-.6-.9-1.7-.9-.5 0-1 .1-1.4.3-.2 0-.3.1-.3.2v-.2c0 .4-.4.8-.8.8z" fill-rule="nonzero"/><circle cx="12" cy="16" r="1"/></g></svg>',"highlight-bg-color":'<svg width="24" height="24"><g fill-rule="evenodd"><path id="tox-icon-highlight-bg-color__color" d="M3 18h18v3H3z"/><path fill-rule="nonzero" d="M7.7 16.7H3l3.3-3.3-.7-.8L10.2 8l4 4.1-4 4.2c-.2.2-.6.2-.8 0l-.6-.7-1.1 1.1zm5-7.5L11 7.4l3-2.9a2 2 0 012.6 0L18 6c.7.7.7 2 0 2.7l-2.9 2.9-1.8-1.8-.5-.6"/></g></svg>',home:'<svg width="24" height="24"><path fill-rule="nonzero" d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>',"horizontal-rule":'<svg width="24" height="24"><path d="M4 11h16v2H4z" fill-rule="evenodd"/></svg>',"image-options":'<svg width="24" height="24"><path d="M6 10a2 2 0 00-2 2c0 1.1.9 2 2 2a2 2 0 002-2 2 2 0 00-2-2zm12 0a2 2 0 00-2 2c0 1.1.9 2 2 2a2 2 0 002-2 2 2 0 00-2-2zm-6 0a2 2 0 00-2 2c0 1.1.9 2 2 2a2 2 0 002-2 2 2 0 00-2-2z" fill-rule="nonzero"/></svg>',image:'<svg width="24" height="24"><path d="M5 15.7l3.3-3.2c.3-.3.7-.3 1 0L12 15l4.1-4c.3-.4.8-.4 1 0l2 1.9V5H5v10.7zM5 18V19h3l2.8-2.9-2-2L5 17.9zm14-3l-2.5-2.4-6.4 6.5H19v-4zM4 3h16c.6 0 1 .4 1 1v16c0 .6-.4 1-1 1H4a1 1 0 01-1-1V4c0-.6.4-1 1-1zm6 8a2 2 0 100-4 2 2 0 000 4z" fill-rule="nonzero"/></svg>',indent:'<svg width="24" height="24"><path d="M7 5h12c.6 0 1 .4 1 1s-.4 1-1 1H7a1 1 0 110-2zm5 4h7c.6 0 1 .4 1 1s-.4 1-1 1h-7a1 1 0 010-2zm0 4h7c.6 0 1 .4 1 1s-.4 1-1 1h-7a1 1 0 010-2zm-5 4h12a1 1 0 010 2H7a1 1 0 010-2zm-2.6-3.8L6.2 12l-1.8-1.2a1 1 0 011.2-1.6l3 2a1 1 0 010 1.6l-3 2a1 1 0 11-1.2-1.6z" fill-rule="evenodd"/></svg>',info:'<svg width="24" height="24"><path d="M12 4a7.8 7.8 0 015.7 2.3A8 8 0 1112 4zm-1 3v2h2V7h-2zm3 10v-1h-1v-5h-3v1h1v4h-1v1h4z" fill-rule="evenodd"/></svg>',"insert-character":'<svg width="24" height="24"><path d="M15 18h4l1-2v4h-6v-3.3l1.4-1a6 6 0 001.8-2.9 6.3 6.3 0 00-.1-4.1 5.8 5.8 0 00-3-3.2c-.6-.3-1.3-.5-2.1-.5a5.1 5.1 0 00-3.9 1.8 6.3 6.3 0 00-1.3 6 6.2 6.2 0 001.8 3l1.4.9V20H4v-4l1 2h4v-.5l-2-1L5.4 15A6.5 6.5 0 014 11c0-1 .2-1.9.6-2.7A7 7 0 016.3 6C7.1 5.4 8 5 9 4.5c1-.3 2-.5 3.1-.5a8.8 8.8 0 015.7 2 7 7 0 011.7 2.3 6 6 0 01.2 4.8c-.2.7-.6 1.3-1 1.9a7.6 7.6 0 01-3.6 2.5v.5z" fill-rule="evenodd"/></svg>',"insert-time":'<svg width="24" height="24"><g fill-rule="nonzero"><path d="M12 19a7 7 0 100-14 7 7 0 000 14zm0 2a9 9 0 110-18 9 9 0 010 18z"/><path d="M16 12h-3V7c0-.6-.4-1-1-1a1 1 0 00-1 1v7h5c.6 0 1-.4 1-1s-.4-1-1-1z"/></g></svg>',invert:'<svg width="24" height="24"><path d="M18 19.3L16.5 18a5.8 5.8 0 01-3.1 1.9 6.1 6.1 0 01-5.5-1.6A5.8 5.8 0 016 14v-.3l.1-1.2A13.9 13.9 0 017.7 9l-3-3 .7-.8 2.8 2.9 9 8.9 1.5 1.6-.7.6zm0-5.5v.3l-.1 1.1-.4 1-1.2-1.2a4.3 4.3 0 00.2-1v-.2c0-.4 0-.8-.2-1.3l-.5-1.4a14.8 14.8 0 00-3-4.2L12 6a26.1 26.1 0 00-2.2 2.5l-1-1a20.9 20.9 0 012.9-3.3L12 4l1 .8a22.2 22.2 0 014 5.4c.6 1.2 1 2.4 1 3.6z" fill-rule="evenodd"/></svg>',italic:'<svg width="24" height="24"><path d="M16.7 4.7l-.1.9h-.3c-.6 0-1 0-1.4.3-.3.3-.4.6-.5 1.1l-2.1 9.8v.6c0 .5.4.8 1.4.8h.2l-.2.8H8l.2-.8h.2c1.1 0 1.8-.5 2-1.5l2-9.8.1-.5c0-.6-.4-.8-1.4-.8h-.3l.2-.9h5.8z" fill-rule="evenodd"/></svg>',language:'<svg width="24" height="24"><path d="M12 3a9 9 0 110 18 9 9 0 010-18zm4.3 13.3c-.5 1-1.2 2-2 2.9a7.5 7.5 0 003.2-2.1l-.2-.2a6 6 0 00-1-.6zm-8.6 0c-.5.2-.9.5-1.2.8.9 1 2 1.7 3.2 2a10 10 0 01-2-2.8zm3.6-.8c-.8 0-1.6.1-2.2.3.5 1 1.2 1.9 2.1 2.7zm1.5 0v3c.9-.8 1.6-1.7 2.1-2.7-.6-.2-1.4-.3-2.1-.3zm-6-2.7H4.5c.2 1 .5 2.1 1 3h.3l1.3-1a10 10 0 01-.3-2zm12.7 0h-2.3c0 .7-.1 1.4-.3 2l1.6 1.1c.5-1 .9-2 1-3.1zm-3.8 0h-3V14c1 0 2 .1 2.7.4.2-.5.3-1 .3-1.6zm-4.4 0h-3l.3 1.6c.8-.3 1.7-.4 2.7-.4v-1.3zm-5.5-5c-.7 1-1.1 2.2-1.3 3.5h2.3c0-1 .2-1.8.5-2.6l-1.5-1zm2.9 1.4v.1c-.2.6-.4 1.3-.4 2h3V9.4c-1 0-1.8-.1-2.6-.3zm6.6 0h-.1l-2.4.3v1.8h3l-.5-2.1zm3-1.4l-.3.1-1.3.8c.3.8.5 1.6.5 2.6h2.3a7.5 7.5 0 00-1.3-3.5zm-9 0l2 .2V5.5a9 9 0 00-2 2.2zm3.5-2.3V8c.6 0 1.3 0 1.9-.2a9 9 0 00-2-2.3zm-3-.7h-.1c-1.1.4-2.1 1-3 1.8l1.2.7a10 10 0 011.9-2.5zm4.4 0l.1.1a10 10 0 011.8 2.4l1.1-.7a7.5 7.5 0 00-3-1.8z"/></svg>',"line-height":'<svg width="24" height="24"><path d="M21 5a1 1 0 01.1 2H13a1 1 0 01-.1-2H21zm0 4a1 1 0 01.1 2H13a1 1 0 01-.1-2H21zm0 4a1 1 0 01.1 2H13a1 1 0 01-.1-2H21zm0 4a1 1 0 01.1 2H13a1 1 0 01-.1-2H21zM7 3.6l3.7 3.7a1 1 0 01-1.3 1.5h-.1L8 7.3v9.2l1.3-1.3a1 1 0 011.3 0h.1c.4.4.4 1 0 1.3v.1L7 20.4l-3.7-3.7a1 1 0 011.3-1.5h.1L6 16.7V7.4L4.7 8.7a1 1 0 01-1.3 0h-.1a1 1 0 010-1.3v-.1L7 3.6z"/></svg>',line:'<svg width="24" height="24"><path d="M15 9l-8 8H4v-3l8-8 3 3zm1-1l-3-3 1-1h1c-.2 0 0 0 0 0l2 2s0 .2 0 0v1l-1 1zM4 18h16v2H4v-2z" fill-rule="evenodd"/></svg>',link:'<svg width="24" height="24"><path d="M6.2 12.3a1 1 0 011.4 1.4l-2.1 2a2 2 0 102.7 2.8l4.8-4.8a1 1 0 000-1.4 1 1 0 111.4-1.3 2.9 2.9 0 010 4L9.6 20a3.9 3.9 0 01-5.5-5.5l2-2zm11.6-.6a1 1 0 01-1.4-1.4l2-2a2 2 0 10-2.6-2.8L11 10.3a1 1 0 000 1.4A1 1 0 119.6 13a2.9 2.9 0 010-4L14.4 4a3.9 3.9 0 015.5 5.5l-2 2z" fill-rule="nonzero"/></svg>',"list-bull-circle":'<svg width="48" height="48"><g fill-rule="evenodd"><path d="M11 16a2 2 0 100-4 2 2 0 000 4zm0 1a3 3 0 110-6 3 3 0 010 6zM11 26a2 2 0 100-4 2 2 0 000 4zm0 1a3 3 0 110-6 3 3 0 010 6zM11 36a2 2 0 100-4 2 2 0 000 4zm0 1a3 3 0 110-6 3 3 0 010 6z" fill-rule="nonzero"/><path opacity=".2" d="M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z"/></g></svg>',"list-bull-default":'<svg width="48" height="48"><g fill-rule="evenodd"><circle cx="11" cy="14" r="3"/><circle cx="11" cy="24" r="3"/><circle cx="11" cy="34" r="3"/><path opacity=".2" d="M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z"/></g></svg>',"list-bull-square":'<svg width="48" height="48"><g fill-rule="evenodd"><path d="M8 11h6v6H8zM8 21h6v6H8zM8 31h6v6H8z"/><path opacity=".2" d="M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z"/></g></svg>',"list-num-default-rtl":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M8 12h22v4H8zM8 22h22v4H8zM8 32h22v4H8z"/><path d="M37.4 17v-4.8l-1.6 1v-1.1l1.6-1h1.2V17zM33.3 17.1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zm1.7 5.7c0-1.2 1-2 2.2-2 1.3 0 2.1.8 2.1 1.8 0 .7-.3 1.2-1.3 2.2l-1.2 1v.2h2.6v1h-4.3v-.9l2-1.9c.8-.8 1-1.1 1-1.5 0-.5-.4-.8-1-.8-.5 0-.9.3-.9.9H35zm-1.7 4.3c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zm3.2 7.3v-1h.7c.6 0 1-.3 1-.8 0-.4-.4-.7-1-.7s-1 .3-1 .8H35c0-1.1 1-1.8 2.2-1.8 1.2 0 2.1.6 2.1 1.6 0 .7-.4 1.2-1 1.3v.1c.7.1 1.3.7 1.3 1.4 0 1-1 1.9-2.4 1.9-1.3 0-2.2-.8-2.3-2h1.2c0 .6.5 1 1.1 1 .6 0 1-.4 1-1 0-.5-.3-.8-1-.8h-.7zm-3.3 2.7c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .8.3.8.7 0 .4-.3.7-.8.7z"/></g></svg>',"list-num-default":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z"/><path d="M10 17v-4.8l-1.5 1v-1.1l1.6-1h1.2V17h-1.2zm3.6.1c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .7.3.7.7 0 .4-.2.7-.7.7zm-5 5.7c0-1.2.8-2 2.1-2s2.1.8 2.1 1.8c0 .7-.3 1.2-1.4 2.2l-1.1 1v.2h2.6v1H8.6v-.9l2-1.9c.8-.8 1-1.1 1-1.5 0-.5-.4-.8-1-.8-.5 0-.9.3-.9.9H8.5zm6.3 4.3c-.5 0-.7-.3-.7-.7 0-.4.2-.7.7-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zM10 34.4v-1h.7c.6 0 1-.3 1-.8 0-.4-.4-.7-1-.7s-1 .3-1 .8H8.6c0-1.1 1-1.8 2.2-1.8 1.3 0 2.1.6 2.1 1.6 0 .7-.4 1.2-1 1.3v.1c.8.1 1.3.7 1.3 1.4 0 1-1 1.9-2.4 1.9-1.3 0-2.2-.8-2.3-2h1.2c0 .6.5 1 1.1 1 .7 0 1-.4 1-1 0-.5-.3-.8-1-.8h-.7zm4.7 2.7c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .8.3.8.7 0 .4-.3.7-.8.7z"/></g></svg>',"list-num-lower-alpha-rtl":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M8 12h22v4H8zM8 22h22v4H8zM8 32h22v4H8z"/><path d="M36.5 16c-.9 0-1.5-.5-1.5-1.3s.6-1.3 1.8-1.4h1v-.4c0-.4-.2-.6-.7-.6-.4 0-.7.1-.8.4h-1.1c0-.8.8-1.4 2-1.4S39 12 39 13V16h-1.2v-.6c-.3.4-.8.7-1.4.7zm.4-.8c.6 0 1-.4 1-.9V14h-1c-.5.1-.7.3-.7.6 0 .4.3.6.7.6zM33.1 16.1c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .8.3.8.7 0 .4-.3.7-.8.7zM37.7 26c-.7 0-1.2-.2-1.5-.7v.7H35v-6.3h1.2v2.5c.3-.5.8-.9 1.5-.9 1.1 0 1.8 1 1.8 2.4 0 1.5-.7 2.4-1.8 2.4zm-.5-3.6c-.6 0-1 .5-1 1.3s.4 1.4 1 1.4c.7 0 1-.6 1-1.4 0-.8-.3-1.3-1-1.3zM33.2 26.1c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .8.3.8.7 0 .4-.3.7-.8.7zm6 7h-1c-.1-.5-.4-.8-1-.8s-1 .5-1 1.4c0 1 .4 1.4 1 1.4.5 0 .9-.2 1-.7h1c0 1-.8 1.7-2 1.7-1.4 0-2.2-.9-2.2-2.4s.8-2.4 2.2-2.4c1.2 0 2 .7 2 1.7zm-6.1 3c-.5 0-.7-.3-.7-.7 0-.4.2-.7.7-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7z"/></g></svg>',"list-num-lower-alpha":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z"/><path d="M10.3 15.2c.5 0 1-.4 1-.9V14h-1c-.5.1-.8.3-.8.6 0 .4.3.6.8.6zm-.4.9c-1 0-1.5-.6-1.5-1.4 0-.8.6-1.3 1.7-1.4h1.1v-.4c0-.4-.2-.6-.7-.6-.5 0-.8.1-.9.4h-1c0-.8.8-1.4 2-1.4 1.1 0 1.8.6 1.8 1.6V16h-1.1v-.6h-.1c-.2.4-.7.7-1.3.7zm4.6 0c-.5 0-.7-.3-.7-.7 0-.4.2-.7.7-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zm-3.2 10c-.6 0-1.2-.3-1.4-.8v.7H8.5v-6.3H10v2.5c.3-.5.8-.9 1.4-.9 1.2 0 1.9 1 1.9 2.4 0 1.5-.7 2.4-1.9 2.4zm-.4-3.7c-.7 0-1 .5-1 1.3s.3 1.4 1 1.4c.6 0 1-.6 1-1.4 0-.8-.4-1.3-1-1.3zm4 3.7c-.5 0-.7-.3-.7-.7 0-.4.2-.7.7-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zm-2.2 7h-1.2c0-.5-.4-.8-.9-.8-.6 0-1 .5-1 1.4 0 1 .4 1.4 1 1.4.5 0 .8-.2 1-.7h1c0 1-.8 1.7-2 1.7-1.4 0-2.2-.9-2.2-2.4s.8-2.4 2.2-2.4c1.2 0 2 .7 2 1.7zm1.8 3c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7z"/></g></svg>',"list-num-lower-greek-rtl":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M8 12h22v4H8zM8 22h22v4H8zM8 32h22v4H8z"/><path d="M37.4 16c-1.2 0-2-.8-2-2.3 0-1.5.8-2.4 2-2.4.6 0 1 .4 1.3 1v-.9H40v3.2c0 .4.1.5.4.5h.2v.9h-.6c-.6 0-1-.2-1-.7h-.2c-.2.4-.7.8-1.3.8zm.3-1c.6 0 1-.5 1-1.3s-.4-1.3-1-1.3-1 .5-1 1.3.4 1.4 1 1.4zM33.3 16.1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zM36 21.9c0-1.5.8-2.3 2.1-2.3 1.2 0 2 .6 2 1.6 0 .6-.3 1-.9 1.3.9.3 1.3.8 1.3 1.7 0 1.2-.7 1.9-1.8 1.9-.6 0-1.1-.3-1.4-.8v2.2H36V22zm1.8 1.2v-1h.3c.5 0 .9-.2.9-.7 0-.5-.3-.8-.9-.8-.5 0-.8.3-.8 1v2.2c0 .8.4 1.3 1 1.3s1-.4 1-1-.4-1-1.2-1h-.3zM33.3 26.1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zM37.1 34.6L34.8 30h1.4l1.7 3.5 1.7-3.5h1.1l-2.2 4.6v.1c.5.8.7 1.4.7 1.8 0 .4-.2.8-.4 1-.2.2-.6.3-1 .3-.9 0-1.3-.4-1.3-1.2 0-.5.2-1 .5-1.7l.1-.2zm.7 1a2 2 0 00-.4.9c0 .3.1.4.4.4.3 0 .4-.1.4-.4 0-.2-.1-.6-.4-1zM33.3 36.1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7z"/></g></svg>',"list-num-lower-greek":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z"/><path d="M10.5 15c.7 0 1-.5 1-1.3s-.3-1.3-1-1.3c-.5 0-.9.5-.9 1.3s.4 1.4 1 1.4zm-.3 1c-1.1 0-1.8-.8-1.8-2.3 0-1.5.7-2.4 1.8-2.4.7 0 1.1.4 1.3 1h.1v-.9h1.2v3.2c0 .4.1.5.4.5h.2v.9h-.6c-.6 0-1-.2-1.1-.7h-.1c-.2.4-.7.8-1.4.8zm5 .1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.7-.7.5 0 .8.3.8.7 0 .4-.3.7-.8.7zm-4.9 7v-1h.3c.6 0 1-.2 1-.7 0-.5-.4-.8-1-.8-.5 0-.8.3-.8 1v2.2c0 .8.4 1.3 1.1 1.3.6 0 1-.4 1-1s-.5-1-1.3-1h-.3zM8.6 22c0-1.5.7-2.3 2-2.3 1.2 0 2 .6 2 1.6 0 .6-.3 1-.8 1.3.8.3 1.3.8 1.3 1.7 0 1.2-.8 1.9-1.9 1.9-.6 0-1.1-.3-1.3-.8v2.2H8.5V22zm6.2 4.2c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .7.3.7.7 0 .4-.2.7-.7.7zm-4.5 8.5L8 30h1.4l1.7 3.5 1.7-3.5h1.1l-2.2 4.6v.1c.5.8.7 1.4.7 1.8 0 .4-.1.8-.4 1-.2.2-.6.3-1 .3-.9 0-1.3-.4-1.3-1.2 0-.5.2-1 .5-1.7l.1-.2zm.7 1a2 2 0 00-.4.9c0 .3.1.4.4.4.3 0 .4-.1.4-.4 0-.2-.1-.6-.4-1zm4.5.5c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7z"/></g></svg>',"list-num-lower-roman-rtl":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M8 12h22v4H8zM8 22h22v4H8zM8 32h22v4H8z"/><path d="M32.9 16v-1.2h-1.3V16H33zm0 10v-1.2h-1.3V26H33zm0 10v-1.2h-1.3V36H33z"/><path fill-rule="nonzero" d="M36 21h-1.5v5H36zM36 31h-1.5v5H36zM39 21h-1.5v5H39zM39 31h-1.5v5H39zM42 31h-1.5v5H42zM36 11h-1.5v5H36zM36 19h-1.5v1H36zM36 29h-1.5v1H36zM39 19h-1.5v1H39zM39 29h-1.5v1H39zM42 29h-1.5v1H42zM36 9h-1.5v1H36z"/></g></svg>',"list-num-lower-roman":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z"/><path d="M15.1 16v-1.2h1.3V16H15zm0 10v-1.2h1.3V26H15zm0 10v-1.2h1.3V36H15z"/><path fill-rule="nonzero" d="M12 21h1.5v5H12zM12 31h1.5v5H12zM9 21h1.5v5H9zM9 31h1.5v5H9zM6 31h1.5v5H6zM12 11h1.5v5H12zM12 19h1.5v1H12zM12 29h1.5v1H12zM9 19h1.5v1H9zM9 29h1.5v1H9zM6 29h1.5v1H6zM12 9h1.5v1H12z"/></g></svg>',"list-num-upper-alpha-rtl":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M8 12h22v4H8zM8 22h22v4H8zM8 32h22v4H8z"/><path d="M39.3 17l-.5-1.4h-2l-.5 1.4H35l2-6h1.6l2 6h-1.3zm-1.6-4.7l-.7 2.3h1.6l-.8-2.3zM33.4 17c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .7.3.7.7 0 .4-.2.7-.7.7zm4.7 9.9h-2.7v-6H38c1.2 0 1.9.6 1.9 1.5 0 .6-.5 1.2-1 1.3.7.1 1.3.7 1.3 1.5 0 1-.8 1.7-2 1.7zm-1.4-5v1.5h1c.6 0 1-.3 1-.8 0-.4-.4-.7-1-.7h-1zm0 4h1.1c.7 0 1.1-.3 1.1-.8 0-.6-.4-.9-1.1-.9h-1.1V26zM33 27.1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zm4.9 10c-1.8 0-2.8-1.1-2.8-3.1s1-3.1 2.8-3.1c1.4 0 2.5.9 2.6 2.2h-1.3c0-.7-.6-1.1-1.3-1.1-1 0-1.6.7-1.6 2s.6 2 1.6 2c.7 0 1.2-.4 1.4-1h1.2c-.1 1.3-1.2 2.2-2.6 2.2zm-4.5 0c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7z"/></g></svg>',"list-num-upper-alpha":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z"/><path d="M12.6 17l-.5-1.4h-2L9.5 17H8.3l2-6H12l2 6h-1.3zM11 12.3l-.7 2.3h1.6l-.8-2.3zm4.7 4.8c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .7.3.7.7 0 .4-.2.7-.7.7zM11.4 27H8.7v-6h2.6c1.2 0 1.9.6 1.9 1.5 0 .6-.5 1.2-1 1.3.7.1 1.3.7 1.3 1.5 0 1-.8 1.7-2 1.7zM10 22v1.5h1c.6 0 1-.3 1-.8 0-.4-.4-.7-1-.7h-1zm0 4H11c.7 0 1.1-.3 1.1-.8 0-.6-.4-.9-1.1-.9H10V26zm5.4 1.1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zm-4.1 10c-1.8 0-2.8-1.1-2.8-3.1s1-3.1 2.8-3.1c1.4 0 2.5.9 2.6 2.2h-1.3c0-.7-.6-1.1-1.3-1.1-1 0-1.6.7-1.6 2s.6 2 1.6 2c.7 0 1.2-.4 1.4-1h1.2c-.1 1.3-1.2 2.2-2.6 2.2zm4.5 0c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7z"/></g></svg>',"list-num-upper-roman-rtl":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M8 12h22v4H8zM8 22h22v4H8zM8 32h22v4H8z"/><path d="M31.6 17v-1.2H33V17h-1.3zm0 10v-1.2H33V27h-1.3zm0 10v-1.2H33V37h-1.3z"/><path fill-rule="nonzero" d="M34.5 20H36v7h-1.5zM34.5 30H36v7h-1.5zM37.5 20H39v7h-1.5zM37.5 30H39v7h-1.5zM40.5 30H42v7h-1.5zM34.5 10H36v7h-1.5z"/></g></svg>',"list-num-upper-roman":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z"/><path d="M15.1 17v-1.2h1.3V17H15zm0 10v-1.2h1.3V27H15zm0 10v-1.2h1.3V37H15z"/><path fill-rule="nonzero" d="M12 20h1.5v7H12zM12 30h1.5v7H12zM9 20h1.5v7H9zM9 30h1.5v7H9zM6 30h1.5v7H6zM12 10h1.5v7H12z"/></g></svg>',lock:'<svg width="24" height="24"><path d="M16.3 11c.2 0 .3 0 .5.2l.2.6v7.4c0 .3 0 .4-.2.6l-.6.2H7.8c-.3 0-.4 0-.6-.2a.7.7 0 01-.2-.6v-7.4c0-.3 0-.4.2-.6l.5-.2H8V8c0-.8.3-1.5.9-2.1.6-.6 1.3-.9 2.1-.9h2c.8 0 1.5.3 2.1.9.6.6.9 1.3.9 2.1v3h.3zM10 8v3h4V8a1 1 0 00-.3-.7A1 1 0 0013 7h-2a1 1 0 00-.7.3 1 1 0 00-.3.7z" fill-rule="evenodd"/></svg>',ltr:'<svg width="24" height="24"><path d="M11 5h7a1 1 0 010 2h-1v11a1 1 0 01-2 0V7h-2v11a1 1 0 01-2 0v-6c-.5 0-1 0-1.4-.3A3.4 3.4 0 017.8 10a3.3 3.3 0 010-2.8 3.4 3.4 0 011.8-1.8L11 5zM4.4 16.2L6.2 15l-1.8-1.2a1 1 0 011.2-1.6l3 2a1 1 0 010 1.6l-3 2a1 1 0 11-1.2-1.6z" fill-rule="evenodd"/></svg>',"more-drawer":'<svg width="24" height="24"><path d="M6 10a2 2 0 00-2 2c0 1.1.9 2 2 2a2 2 0 002-2 2 2 0 00-2-2zm12 0a2 2 0 00-2 2c0 1.1.9 2 2 2a2 2 0 002-2 2 2 0 00-2-2zm-6 0a2 2 0 00-2 2c0 1.1.9 2 2 2a2 2 0 002-2 2 2 0 00-2-2z" fill-rule="nonzero"/></svg>',"new-document":'<svg width="24" height="24"><path d="M14.4 3H7a2 2 0 00-2 2v14c0 1.1.9 2 2 2h10a2 2 0 002-2V7.6L14.4 3zM17 19H7V5h6v4h4v10z" fill-rule="nonzero"/></svg>',"new-tab":'<svg width="24" height="24"><path d="M15 13l2-2v8H5V7h8l-2 2H7v8h8v-4zm4-8v5.5l-2-2-5.6 5.5H10v-1.4L15.5 7l-2-2H19z" fill-rule="evenodd"/></svg>',"non-breaking":'<svg width="24" height="24"><path d="M11 11H8a1 1 0 110-2h3V6c0-.6.4-1 1-1s1 .4 1 1v3h3c.6 0 1 .4 1 1s-.4 1-1 1h-3v3c0 .6-.4 1-1 1a1 1 0 01-1-1v-3zm10 4v5H3v-5c0-.6.4-1 1-1s1 .4 1 1v3h14v-3c0-.6.4-1 1-1s1 .4 1 1z" fill-rule="evenodd"/></svg>',notice:'<svg width="24" height="24"><path d="M17.8 9.8L15.4 4 20 8.5v7L15.5 20h-7L4 15.5v-7L8.5 4h7l2.3 5.8zm0 0l2.2 5.7-2.3-5.8zM13 17v-2h-2v2h2zm0-4V7h-2v6h2z" fill-rule="evenodd"/></svg>',"ordered-list-rtl":'<svg width="24" height="24"><path d="M6 17h8a1 1 0 010 2H6a1 1 0 010-2zm0-6h8a1 1 0 010 2H6a1 1 0 010-2zm0-6h8a1 1 0 010 2H6a1 1 0 110-2zm13-1v3.5a.5.5 0 11-1 0V5h-.5a.5.5 0 110-1H19zm-1 8.8l.2.2h1.3a.5.5 0 110 1h-1.6a1 1 0 01-.9-1V13c0-.4.3-.8.6-1l1.2-.4.2-.3a.2.2 0 00-.2-.2h-1.3a.5.5 0 01-.5-.5c0-.3.2-.5.5-.5h1.6c.5 0 .9.4.9 1v.1c0 .4-.3.8-.6 1l-1.2.4-.2.3zm2 4.2v2c0 .6-.4 1-1 1h-1.5a.5.5 0 010-1h1.2a.3.3 0 100-.6h-1.3a.4.4 0 110-.8h1.3a.3.3 0 000-.6h-1.2a.5.5 0 110-1H19c.6 0 1 .4 1 1z" fill-rule="evenodd"/></svg>',"ordered-list":'<svg width="24" height="24"><path d="M10 17h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 010-2zm0-6h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 010-2zm0-6h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 110-2zM6 4v3.5c0 .3-.2.5-.5.5a.5.5 0 01-.5-.5V5h-.5a.5.5 0 010-1H6zm-1 8.8l.2.2h1.3c.3 0 .5.2.5.5s-.2.5-.5.5H4.9a1 1 0 01-.9-1V13c0-.4.3-.8.6-1l1.2-.4.2-.3a.2.2 0 00-.2-.2H4.5a.5.5 0 01-.5-.5c0-.3.2-.5.5-.5h1.6c.5 0 .9.4.9 1v.1c0 .4-.3.8-.6 1l-1.2.4-.2.3zM7 17v2c0 .6-.4 1-1 1H4.5a.5.5 0 010-1h1.2c.2 0 .3-.1.3-.3 0-.2-.1-.3-.3-.3H4.4a.4.4 0 110-.8h1.3c.2 0 .3-.1.3-.3 0-.2-.1-.3-.3-.3H4.5a.5.5 0 110-1H6c.6 0 1 .4 1 1z" fill-rule="evenodd"/></svg>',orientation:'<svg width="24" height="24"><path d="M7.3 6.4L1 13l6.4 6.5 6.5-6.5-6.5-6.5zM3.7 13l3.6-3.7L11 13l-3.7 3.7-3.6-3.7zM12 6l2.8 2.7c.3.3.3.8 0 1-.3.4-.9.4-1.2 0L9.2 5.7a.8.8 0 010-1.2L13.6.2c.3-.3.9-.3 1.2 0 .3.3.3.8 0 1.1L12 4h1a9 9 0 11-4.3 16.9l1.5-1.5A7 7 0 1013 6h-1z" fill-rule="nonzero"/></svg>',outdent:'<svg width="24" height="24"><path d="M7 5h12c.6 0 1 .4 1 1s-.4 1-1 1H7a1 1 0 110-2zm5 4h7c.6 0 1 .4 1 1s-.4 1-1 1h-7a1 1 0 010-2zm0 4h7c.6 0 1 .4 1 1s-.4 1-1 1h-7a1 1 0 010-2zm-5 4h12a1 1 0 010 2H7a1 1 0 010-2zm1.6-3.8a1 1 0 01-1.2 1.6l-3-2a1 1 0 010-1.6l3-2a1 1 0 011.2 1.6L6.8 12l1.8 1.2z" fill-rule="evenodd"/></svg>',"page-break":'<svg width="24" height="24"><g fill-rule="evenodd"><path d="M5 11c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 010-2zm3 0h1c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 010-2zm4 0c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 010-2zm3 0h1c.6 0 1 .4 1 1s-.4 1-1 1h-1a1 1 0 010-2zm4 0c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 010-2zM7 3v5h10V3c0-.6.4-1 1-1s1 .4 1 1v7H5V3c0-.6.4-1 1-1s1 .4 1 1zM6 22a1 1 0 01-1-1v-7h14v7c0 .6-.4 1-1 1a1 1 0 01-1-1v-5H7v5c0 .6-.4 1-1 1z"/></g></svg>',paragraph:'<svg width="24" height="24"><path fill-rule="evenodd" d="M10 5h7a1 1 0 010 2h-1v11a1 1 0 01-2 0V7h-2v11a1 1 0 01-2 0v-6c-.5 0-1 0-1.4-.3A3.4 3.4 0 016.8 10a3.3 3.3 0 010-2.8 3.4 3.4 0 011.8-1.8L10 5z"/></svg>',"paste-column-after":'<svg width="24" height="24"><path fill-rule="evenodd" d="M12 1a3 3 0 012.8 2H18c1 0 2 .8 2 1.9V7h-2V5h-2v1c0 .6-.4 1-1 1H9a1 1 0 01-1-1V5H6v13h7v2H6c-1 0-2-.8-2-1.9V5c0-1 .8-2 1.9-2H9.2A3 3 0 0112 1zm8 7v12h-6V8h6zm-1.5 1.5h-3v9h3v-9zM12 3a1 1 0 100 2 1 1 0 000-2z"/></svg>',"paste-column-before":'<svg width="24" height="24"><path fill-rule="evenodd" d="M12 1a3 3 0 012.8 2H18c1 0 2 .8 2 1.9V18c0 1-.8 2-1.9 2H11v-2h7V5h-2v1c0 .6-.4 1-1 1H9a1 1 0 01-1-1V5H6v2H4V5c0-1 .8-2 1.9-2H9.2A3 3 0 0112 1zm-2 7v12H4V8h6zM8.5 9.5h-3v9h3v-9zM12 3a1 1 0 100 2 1 1 0 000-2z"/></svg>',"paste-row-after":'<svg width="24" height="24"><path fill-rule="evenodd" d="M12 1a3 3 0 012.8 2H18c1 0 2 .8 2 1.9V11h-2V5h-2v1c0 .6-.4 1-1 1H9a1 1 0 01-1-1V5H6v13h14c0 1-.8 2-1.9 2H6c-1 0-2-.8-2-1.9V5c0-1 .8-2 1.9-2H9.2A3 3 0 0112 1zm10 11v5H8v-5h14zm-1.5 1.5h-11v2h11v-2zM12 3a1 1 0 100 2 1 1 0 000-2z"/></svg>',"paste-row-before":'<svg width="24" height="24"><path fill-rule="evenodd" d="M12 1a3 3 0 012.8 2H18c1 0 2 .8 2 1.9V7h-2V5h-2v1c0 .6-.4 1-1 1H9a1 1 0 01-1-1V5H6v13h12v-4h2v4c0 1-.8 2-1.9 2H6c-1 0-2-.8-2-1.9V5c0-1 .8-2 1.9-2H9.2A3 3 0 0112 1zm10 7v5H8V8h14zm-1.5 1.5h-11v2h11v-2zM12 3a1 1 0 100 2 1 1 0 000-2z"/></svg>',"paste-text":'<svg width="24" height="24"><path d="M18 9V5h-2v1c0 .6-.4 1-1 1H9a1 1 0 01-1-1V5H6v13h3V9h9zM9 20H6a2 2 0 01-2-2V5c0-1.1.9-2 2-2h3.2A3 3 0 0112 1a3 3 0 012.8 2H18a2 2 0 012 2v4h1v12H9v-1zm1.5-9.5v9h9v-9h-9zM12 3a1 1 0 00-1 1c0 .5.4 1 1 1s1-.5 1-1-.4-1-1-1zm0 9h6v2h-.5l-.5-1h-1v4h.8v1h-3.6v-1h.8v-4h-1l-.5 1H12v-2z" fill-rule="nonzero"/></svg>',paste:'<svg width="24" height="24"><path d="M18 9V5h-2v1c0 .6-.4 1-1 1H9a1 1 0 01-1-1V5H6v13h3V9h9zM9 20H6a2 2 0 01-2-2V5c0-1.1.9-2 2-2h3.2A3 3 0 0112 1a3 3 0 012.8 2H18a2 2 0 012 2v4h1v12H9v-1zm1.5-9.5v9h9v-9h-9zM12 3a1 1 0 00-1 1c0 .5.4 1 1 1s1-.5 1-1-.4-1-1-1z" fill-rule="nonzero"/></svg>',"permanent-pen":'<svg width="24" height="24"><path d="M10.5 17.5L8 20H3v-3l3.5-3.5a2 2 0 010-3L14 3l1 1-7.3 7.3a1 1 0 000 1.4l3.6 3.6c.4.4 1 .4 1.4 0L20 9l1 1-7.6 7.6a2 2 0 01-2.8 0l-.1-.1z" fill-rule="nonzero"/></svg>',plus:'<svg width="24" height="24"><path d="M12 4c.5 0 1 .4 1 .9V11h6a1 1 0 01.1 2H13v6a1 1 0 01-2 .1V13H5a1 1 0 01-.1-2H11V5c0-.6.4-1 1-1z"/></svg>',preferences:'<svg width="24" height="24"><path d="M20.1 13.5l-1.9.2a5.8 5.8 0 01-.6 1.5l1.2 1.5c.4.4.3 1 0 1.4l-.7.7a1 1 0 01-1.4 0l-1.5-1.2a6.2 6.2 0 01-1.5.6l-.2 1.9c0 .5-.5.9-1 .9h-1a1 1 0 01-1-.9l-.2-1.9a5.8 5.8 0 01-1.5-.6l-1.5 1.2a1 1 0 01-1.4 0l-.7-.7a1 1 0 010-1.4l1.2-1.5a6.2 6.2 0 01-.6-1.5l-1.9-.2a1 1 0 01-.9-1v-1c0-.5.4-1 .9-1l1.9-.2a5.8 5.8 0 01.6-1.5L5.2 7.3a1 1 0 010-1.4l.7-.7a1 1 0 011.4 0l1.5 1.2a6.2 6.2 0 011.5-.6l.2-1.9c0-.5.5-.9 1-.9h1c.5 0 1 .4 1 .9l.2 1.9a5.8 5.8 0 011.5.6l1.5-1.2a1 1 0 011.4 0l.7.7c.3.4.4 1 0 1.4l-1.2 1.5a6.2 6.2 0 01.6 1.5l1.9.2c.5 0 .9.5.9 1v1c0 .5-.4 1-.9 1zM12 15a3 3 0 100-6 3 3 0 000 6z" fill-rule="evenodd"/></svg>',preview:'<svg width="24" height="24"><path d="M3.5 12.5c.5.8 1.1 1.6 1.8 2.3 2 2 4.2 3.2 6.7 3.2s4.7-1.2 6.7-3.2a16.2 16.2 0 002.1-2.8 15.7 15.7 0 00-2.1-2.8c-2-2-4.2-3.2-6.7-3.2a9.3 9.3 0 00-6.7 3.2A16.2 16.2 0 003.2 12c0 .2.2.3.3.5zm-2.4-1l.7-1.2L4 7.8C6.2 5.4 8.9 4 12 4c3 0 5.8 1.4 8.1 3.8a18.2 18.2 0 012.8 3.7v1l-.7 1.2-2.1 2.5c-2.3 2.4-5 3.8-8.1 3.8-3 0-5.8-1.4-8.1-3.8a18.2 18.2 0 01-2.8-3.7 1 1 0 010-1zm12-3.3a2 2 0 102.7 2.6 4 4 0 11-2.6-2.6z" fill-rule="nonzero"/></svg>',print:'<svg width="24" height="24"><path d="M18 8H6a3 3 0 00-3 3v6h2v3h14v-3h2v-6a3 3 0 00-3-3zm-1 10H7v-4h10v4zm.5-5c-.8 0-1.5-.7-1.5-1.5s.7-1.5 1.5-1.5 1.5.7 1.5 1.5-.7 1.5-1.5 1.5zm.5-8H6v2h12V5z" fill-rule="nonzero"/></svg>',quote:'<svg width="24" height="24"><path d="M7.5 17h.9c.4 0 .7-.2.9-.6L11 13V8c0-.6-.4-1-1-1H6a1 1 0 00-1 1v4c0 .6.4 1 1 1h2l-1.3 2.7a1 1 0 00.8 1.3zm8 0h.9c.4 0 .7-.2.9-.6L19 13V8c0-.6-.4-1-1-1h-4a1 1 0 00-1 1v4c0 .6.4 1 1 1h2l-1.3 2.7a1 1 0 00.8 1.3z" fill-rule="nonzero"/></svg>',redo:'<svg width="24" height="24"><path d="M17.6 10H12c-2.8 0-4.4 1.4-4.9 3.5-.4 2 .3 4 1.4 4.6a1 1 0 11-1 1.8c-2-1.2-2.9-4.1-2.3-6.8.6-3 3-5.1 6.8-5.1h5.6l-3.3-3.3a1 1 0 111.4-1.4l5 5a1 1 0 010 1.4l-5 5a1 1 0 01-1.4-1.4l3.3-3.3z" fill-rule="nonzero"/></svg>',reload:'<svg width="24" height="24"><g fill-rule="nonzero"><path d="M5 22.1l-1.2-4.7v-.2a1 1 0 011-1l5 .4a1 1 0 11-.2 2l-2.2-.2a7.8 7.8 0 008.4.2 7.5 7.5 0 003.5-6.4 1 1 0 112 0 9.5 9.5 0 01-4.5 8 9.9 9.9 0 01-10.2 0l.4 1.4a1 1 0 11-2 .5zM13.6 7.4c0-.5.5-1 1-.9l2.8.2a8 8 0 00-9.5-1 7.5 7.5 0 00-3.6 7 1 1 0 01-2 0 9.5 9.5 0 014.5-8.6 10 10 0 0110.9.3l-.3-1a1 1 0 012-.5l1.1 4.8a1 1 0 01-1 1.2l-5-.4a1 1 0 01-.9-1z"/></g></svg>',"remove-formatting":'<svg width="24" height="24"><path d="M13.2 6a1 1 0 010 .2l-2.6 10a1 1 0 01-1 .8h-.2a.8.8 0 01-.8-1l2.6-10H8a1 1 0 110-2h9a1 1 0 010 2h-3.8zM5 18h7a1 1 0 010 2H5a1 1 0 010-2zm13 1.5L16.5 18 15 19.5a.7.7 0 01-1-1l1.5-1.5-1.5-1.5a.7.7 0 011-1l1.5 1.5 1.5-1.5a.7.7 0 011 1L17.5 17l1.5 1.5a.7.7 0 01-1 1z" fill-rule="evenodd"/></svg>',remove:'<svg width="24" height="24"><path d="M16 7h3a1 1 0 010 2h-1v9a3 3 0 01-3 3H9a3 3 0 01-3-3V9H5a1 1 0 110-2h3V6a3 3 0 013-3h2a3 3 0 013 3v1zm-2 0V6c0-.6-.4-1-1-1h-2a1 1 0 00-1 1v1h4zm2 2H8v9c0 .6.4 1 1 1h6c.6 0 1-.4 1-1V9zm-7 3a1 1 0 012 0v4a1 1 0 01-2 0v-4zm4 0a1 1 0 012 0v4a1 1 0 01-2 0v-4z" fill-rule="nonzero"/></svg>',"resize-handle":'<svg width="10" height="10"><g fill-rule="nonzero"><path d="M8.1 1.1A.5.5 0 119 2l-7 7A.5.5 0 111 8l7-7zM8.1 5.1A.5.5 0 119 6l-3 3A.5.5 0 115 8l3-3z"/></g></svg>',resize:'<svg width="24" height="24"><path d="M4 5c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3h6c.3 0 .5.1.7.3.2.2.3.4.3.7 0 .3-.1.5-.3.7a1 1 0 01-.7.3H7.4L18 16.6V13c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3.3 0 .5.1.7.3.2.2.3.4.3.7v6c0 .3-.1.5-.3.7a1 1 0 01-.7.3h-6a1 1 0 01-.7-.3 1 1 0 01-.3-.7c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3h3.6L6 7.4V11c0 .3-.1.5-.3.7a1 1 0 01-.7.3 1 1 0 01-.7-.3A1 1 0 014 11V5z" fill-rule="evenodd"/></svg>',"restore-draft":'<svg width="24" height="24"><g fill-rule="evenodd"><path d="M17 13c0 .6-.4 1-1 1h-4V8c0-.6.4-1 1-1s1 .4 1 1v4h2c.6 0 1 .4 1 1z"/><path d="M4.7 10H9a1 1 0 010 2H3a1 1 0 01-1-1V5a1 1 0 112 0v3l2.5-2.4a9.2 9.2 0 0110.8-1.5A9 9 0 0113.4 21c-2.4.1-4.7-.7-6.5-2.2a1 1 0 111.3-1.5 7.2 7.2 0 0011.6-3.7 7 7 0 00-3.5-7.7A7.2 7.2 0 008 7L4.7 10z" fill-rule="nonzero"/></g></svg>',"rotate-left":'<svg width="24" height="24"><path d="M4.7 10H9a1 1 0 010 2H3a1 1 0 01-1-1V5a1 1 0 112 0v3l2.5-2.4a9.2 9.2 0 0110.8-1.5A9 9 0 0113.4 21c-2.4.1-4.7-.7-6.5-2.2a1 1 0 111.3-1.5 7.2 7.2 0 0011.6-3.7 7 7 0 00-3.5-7.7A7.2 7.2 0 008 7L4.7 10z" fill-rule="nonzero"/></svg>',"rotate-right":'<svg width="24" height="24"><path d="M20 8V5a1 1 0 012 0v6c0 .6-.4 1-1 1h-6a1 1 0 010-2h4.3L16 7A7.2 7.2 0 007.7 6a7 7 0 003 13.1c1.9.1 3.7-.5 5-1.7a1 1 0 011.4 1.5A9.2 9.2 0 012.2 14c-.9-3.9 1-8 4.5-9.9 3.5-1.9 8-1.3 10.8 1.5L20 8z" fill-rule="nonzero"/></svg>',rtl:'<svg width="24" height="24"><path d="M8 5h8v2h-2v12h-2V7h-2v12H8v-7c-.5 0-1 0-1.4-.3A3.4 3.4 0 014.8 10a3.3 3.3 0 010-2.8 3.4 3.4 0 011.8-1.8L8 5zm12 11.2a1 1 0 11-1 1.6l-3-2a1 1 0 010-1.6l3-2a1 1 0 111 1.6L18.4 15l1.8 1.2z" fill-rule="evenodd"/></svg>',save:'<svg width="24" height="24"><path d="M5 16h14a2 2 0 012 2v2a2 2 0 01-2 2H5a2 2 0 01-2-2v-2c0-1.1.9-2 2-2zm0 2v2h14v-2H5zm10 0h2v2h-2v-2zm-4-6.4L8.7 9.3a1 1 0 10-1.4 1.4l4 4c.4.4 1 .4 1.4 0l4-4a1 1 0 10-1.4-1.4L13 11.6V4a1 1 0 00-2 0v7.6z" fill-rule="nonzero"/></svg>',search:'<svg width="24" height="24"><path d="M16 17.3a8 8 0 111.4-1.4l4.3 4.4a1 1 0 01-1.4 1.4l-4.4-4.3zm-5-.3a6 6 0 100-12 6 6 0 000 12z" fill-rule="nonzero"/></svg>',"select-all":'<svg width="24" height="24"><path d="M3 5h2V3a2 2 0 00-2 2zm0 8h2v-2H3v2zm4 8h2v-2H7v2zM3 9h2V7H3v2zm10-6h-2v2h2V3zm6 0v2h2a2 2 0 00-2-2zM5 21v-2H3c0 1.1.9 2 2 2zm-2-4h2v-2H3v2zM9 3H7v2h2V3zm2 18h2v-2h-2v2zm8-8h2v-2h-2v2zm0 8a2 2 0 002-2h-2v2zm0-12h2V7h-2v2zm0 8h2v-2h-2v2zm-4 4h2v-2h-2v2zm0-16h2V3h-2v2zM7 17h10V7H7v10zm2-8h6v6H9V9z" fill-rule="nonzero"/></svg>',selected:'<svg width="24" height="24"><path fill-rule="nonzero" d="M6 4h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V6c0-1.1.9-2 2-2zm3.6 10.9L7 12.3a.7.7 0 00-1 1L9.6 17 18 8.6a.7.7 0 000-1 .7.7 0 00-1 0l-7.4 7.3z"/></svg>',settings:'<svg width="24" height="24"><path d="M11 6h8c.6 0 1 .4 1 1s-.4 1-1 1h-8v.3c0 .2 0 .3-.2.5l-.6.2H7.8c-.3 0-.4 0-.6-.2a.7.7 0 01-.2-.6V8H5a1 1 0 110-2h2v-.3c0-.2 0-.3.2-.5l.5-.2h2.5c.3 0 .4 0 .6.2l.2.5V6zM8 8h2V6H8v2zm9 2.8v.2h2c.6 0 1 .4 1 1s-.4 1-1 1h-2v.3c0 .2 0 .3-.2.5l-.6.2h-2.4c-.3 0-.4 0-.6-.2a.7.7 0 01-.2-.6V13H5a1 1 0 010-2h8v-.3c0-.2 0-.3.2-.5l.6-.2h2.4c.3 0 .4 0 .6.2l.2.6zM14 13h2v-2h-2v2zm-3 2.8v.2h8c.6 0 1 .4 1 1s-.4 1-1 1h-8v.3c0 .2 0 .3-.2.5l-.6.2H7.8c-.3 0-.4 0-.6-.2a.7.7 0 01-.2-.6V18H5a1 1 0 010-2h2v-.3c0-.2 0-.3.2-.5l.5-.2h2.5c.3 0 .4 0 .6.2l.2.6zM8 18h2v-2H8v2z" fill-rule="evenodd"/></svg>',sharpen:'<svg width="24" height="24"><path d="M16 6l4 4-8 9-8-9 4-4h8zm-4 10.2l5.5-6.2-.1-.1H12v-.3h5.1l-.2-.2H12V9h4.6l-.2-.2H12v-.3h4.1l-.2-.2H12V8h3.6l-.2-.2H8.7L6.5 10l.1.1H12v.3H6.9l.2.2H12v.3H7.3l.2.2H12v.3H7.7l.3.2h4v.3H8.2l.2.2H12v.3H8.6l.3.2H12v.3H9l.3.2H12v.3H9.5l.2.2H12v.3h-2l.2.2H12v.3h-1.6l.2.2H12v.3h-1.1l.2.2h.9v.3h-.7l.2.2h.5v.3h-.3l.3.2z" fill-rule="evenodd"/></svg>',sourcecode:'<svg width="24" height="24"><g fill-rule="nonzero"><path d="M9.8 15.7c.3.3.3.8 0 1-.3.4-.9.4-1.2 0l-4.4-4.1a.8.8 0 010-1.2l4.4-4.2c.3-.3.9-.3 1.2 0 .3.3.3.8 0 1.1L6 12l3.8 3.7zM14.2 15.7c-.3.3-.3.8 0 1 .4.4.9.4 1.2 0l4.4-4.1c.3-.3.3-.9 0-1.2l-4.4-4.2a.8.8 0 00-1.2 0c-.3.3-.3.8 0 1.1L18 12l-3.8 3.7z"/></g></svg>',"spell-check":'<svg width="24" height="24"><path d="M6 8v3H5V5c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3h2c.3 0 .5.1.7.3.2.2.3.4.3.7v6H8V8H6zm0-3v2h2V5H6zm13 0h-3v5h3v1h-3a1 1 0 01-.7-.3 1 1 0 01-.3-.7V5c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3h3v1zm-5 1.5l-.1.7c-.1.2-.3.3-.6.3.3 0 .5.1.6.3l.1.7V10c0 .3-.1.5-.3.7a1 1 0 01-.7.3h-3V4h3c.3 0 .5.1.7.3.2.2.3.4.3.7v1.5zM13 10V8h-2v2h2zm0-3V5h-2v2h2zm3 5l1 1-6.5 7L7 15.5l1.3-1 2.2 2.2L16 12z" fill-rule="evenodd"/></svg>',"strike-through":'<svg width="24" height="24"><g fill-rule="evenodd"><path d="M15.6 8.5c-.5-.7-1-1.1-1.3-1.3-.6-.4-1.3-.6-2-.6-2.7 0-2.8 1.7-2.8 2.1 0 1.6 1.8 2 3.2 2.3 4.4.9 4.6 2.8 4.6 3.9 0 1.4-.7 4.1-5 4.1A6.2 6.2 0 017 16.4l1.5-1.1c.4.6 1.6 2 3.7 2 1.6 0 2.5-.4 3-1.2.4-.8.3-2-.8-2.6-.7-.4-1.6-.7-2.9-1-1-.2-3.9-.8-3.9-3.6C7.6 6 10.3 5 12.4 5c2.9 0 4.2 1.6 4.7 2.4l-1.5 1.1z"/><path d="M5 11h14a1 1 0 010 2H5a1 1 0 010-2z" fill-rule="nonzero"/></g></svg>',subscript:'<svg width="24" height="24"><path d="M10.4 10l4.6 4.6-1.4 1.4L9 11.4 4.4 16 3 14.6 7.6 10 3 5.4 4.4 4 9 8.6 13.6 4 15 5.4 10.4 10zM21 19h-5v-1l1-.8 1.7-1.6c.3-.4.5-.8.5-1.2 0-.3 0-.6-.2-.7-.2-.2-.5-.3-.9-.3a2 2 0 00-.8.2l-.7.3-.4-1.1 1-.6 1.2-.2c.8 0 1.4.3 1.8.7.4.4.6.9.6 1.5s-.2 1.1-.5 1.6a8 8 0 01-1.3 1.3l-.6.6h2.6V19z" fill-rule="nonzero"/></svg>',superscript:'<svg width="24" height="24"><path d="M15 9.4L10.4 14l4.6 4.6-1.4 1.4L9 15.4 4.4 20 3 18.6 7.6 14 3 9.4 4.4 8 9 12.6 13.6 8 15 9.4zm5.9 1.6h-5v-1l1-.8 1.7-1.6c.3-.5.5-.9.5-1.3 0-.3 0-.5-.2-.7-.2-.2-.5-.3-.9-.3l-.8.2-.7.4-.4-1.2c.2-.2.5-.4 1-.5.3-.2.8-.2 1.2-.2.8 0 1.4.2 1.8.6.4.4.6 1 .6 1.6 0 .5-.2 1-.5 1.5l-1.3 1.4-.6.5h2.6V11z" fill-rule="nonzero"/></svg>',"table-caption":'<svg width="24" height="24"><g fill-rule="nonzero"><rect width="12" height="2" x="3" y="4" rx="1"/><path d="M19 8a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2v-8c0-1.1.9-2 2-2h14zM5 15v3h6v-3H5zm14 0h-6v3h6v-3zm0-5h-6v3h6v-3zM5 13h6v-3H5v3z"/></g></svg>',"table-cell-classes":'<svg width="24" height="24"><g fill-rule="evenodd"><path fill-rule="nonzero" d="M13 4v9H3V6c0-1.1.9-2 2-2h8zm-2 2H5v5h6V6z"/><path fill-rule="nonzero" d="M13 4h6a2 2 0 012 2v7h-8v-2h6V6h-6V4z" opacity=".2"/><path d="M18 20l-2.6 1.6.7-3-2.4-2 3.1-.2 1.2-2.9 1.2 2.9 3 .2-2.3 2 .7 3z"/><path fill-rule="nonzero" d="M3 13v5c0 1.1.9 2 2 2h8v-7h-2v5H5v-5H3z" opacity=".2"/></g></svg>',"table-cell-properties":'<svg width="24" height="24"><path fill-rule="nonzero" d="M19 4a2 2 0 012 2v12a2 2 0 01-2 2H5a2 2 0 01-2-2V6c0-1.1.9-2 2-2h14zm-8 9H5v5h6v-5zm8 0h-6v5h6v-5zm-8-7H5v5h6V6z"/></svg>',"table-cell-select-all":'<svg width="24" height="24"><g fill-rule="evenodd"><path fill-rule="nonzero" d="M19 4a2 2 0 012 2v12a2 2 0 01-2 2H5a2 2 0 01-2-2V6c0-1.1.9-2 2-2h14zm0 2H5v12h14V6z"/><path d="M13 6v5h6v2h-6v5h-2v-5H5v-2h6V6h2z" opacity=".2"/></g></svg>',"table-cell-select-inner":'<svg width="24" height="24"><g fill-rule="evenodd"><path fill-rule="nonzero" d="M19 4a2 2 0 012 2v12a2 2 0 01-2 2H5a2 2 0 01-2-2V6c0-1.1.9-2 2-2h14zm0 2H5v12h14V6z" opacity=".2"/><path d="M13 6v5h6v2h-6v5h-2v-5H5v-2h6V6h2z"/></g></svg>',"table-classes":'<svg width="24" height="24"><g fill-rule="evenodd"><path fill-rule="nonzero" d="M19 4a2 2 0 012 2v7h-8v7H5a2 2 0 01-2-2V6c0-1.1.9-2 2-2h14zm-8 9H5v5h6v-5zm8-7h-6v5h6V6zm-8 0H5v5h6V6z"/><path d="M18 20l-2.6 1.6.7-3-2.4-2 3.1-.2 1.2-2.9 1.2 2.9 3 .2-2.3 2 .7 3z"/></g></svg>',"table-delete-column":'<svg width="24" height="24"><path fill-rule="nonzero" d="M19 4a2 2 0 012 2v12a2 2 0 01-2 2H5a2 2 0 01-2-2V6c0-1.1.9-2 2-2h14zm-4 4h-2V6h-2v2H9V6H5v12h4v-2h2v2h2v-2h2v2h4V6h-4v2zm.3.5l1 1.2-3 2.3 3 2.3-1 1.2L12 13l-3.3 2.6-1-1.2 3-2.3-3-2.3 1-1.2L12 11l3.3-2.5z"/></svg>',"table-delete-row":'<svg width="24" height="24"><path fill-rule="nonzero" d="M19 4a2 2 0 012 2v12a2 2 0 01-2 2H5a2 2 0 01-2-2V6c0-1.1.9-2 2-2h14zm0 2H5v3h2.5v2H5v2h2.5v2H5v3h14v-3h-2.5v-2H19v-2h-2.5V9H19V6zm-4.7 1.8l1.2 1L13 12l2.6 3.3-1.2 1-2.3-3-2.3 3-1.2-1L11 12 8.5 8.7l1.2-1 2.3 3 2.3-3z"/></svg>',"table-delete-table":'<svg width="24" height="24"><g fill-rule="nonzero"><path d="M19 4a2 2 0 012 2v12a2 2 0 01-2 2H5a2 2 0 01-2-2V6c0-1.1.9-2 2-2h14zM5 6v12h14V6H5z"/><path d="M14.4 8.6l1 1-2.3 2.4 2.3 2.4-1 1-2.4-2.3-2.4 2.3-1-1 2.3-2.4-2.3-2.4 1-1 2.4 2.3z"/></g></svg>',"table-insert-column-after":'<svg width="24" height="24"><path fill-rule="nonzero" d="M20 4c.6 0 1 .4 1 1v2a1 1 0 01-2 0V6h-8v12h8v-1a1 1 0 012 0v2c0 .5-.4 1-.9 1H5a2 2 0 01-2-2V6c0-1.1.9-2 2-2h15zM9 13H5v5h4v-5zm7-5c.5 0 1 .4 1 .9V11h2a1 1 0 01.1 2H17v2a1 1 0 01-2 .1V13h-2a1 1 0 01-.1-2H15V9c0-.6.4-1 1-1zM9 6H5v5h4V6z"/></svg>',"table-insert-column-before":'<svg width="24" height="24"><path fill-rule="nonzero" d="M19 4a2 2 0 012 2v12a2 2 0 01-2 2H4a1 1 0 01-1-1v-2a1 1 0 012 0v1h8V6H5v1a1 1 0 11-2 0V5c0-.6.4-1 1-1h15zm0 9h-4v5h4v-5zM8 8c.5 0 1 .4 1 .9V11h2a1 1 0 01.1 2H9v2a1 1 0 01-2 .1V13H5a1 1 0 01-.1-2H7V9c0-.6.4-1 1-1zm11-2h-4v5h4V6z"/></svg>',"table-insert-row-above":'<svg width="24" height="24"><path fill-rule="nonzero" d="M6 4a1 1 0 110 2H5v6h14V6h-1a1 1 0 010-2h2c.6 0 1 .4 1 1v13a2 2 0 01-2 2H5a2 2 0 01-2-2V5c0-.6.4-1 1-1h2zm5 10H5v4h6v-4zm8 0h-6v4h6v-4zM12 3c.5 0 1 .4 1 .9V6h2a1 1 0 010 2h-2v2a1 1 0 01-2 .1V8H9a1 1 0 010-2h2V4c0-.6.4-1 1-1z"/></svg>',"table-insert-row-after":'<svg width="24" height="24"><path fill-rule="nonzero" d="M12 13c.5 0 1 .4 1 .9V16h2a1 1 0 01.1 2H13v2a1 1 0 01-2 .1V18H9a1 1 0 01-.1-2H11v-2c0-.6.4-1 1-1zm6 7a1 1 0 010-2h1v-6H5v6h1a1 1 0 010 2H4a1 1 0 01-1-1V6c0-1.1.9-2 2-2h14a2 2 0 012 2v13c0 .5-.4 1-.9 1H18zM11 6H5v4h6V6zm8 0h-6v4h6V6z"/></svg>',"table-left-header":'<svg width="24" height="24"><path d="M19 4a2 2 0 012 2v12a2 2 0 01-2 2H5a2 2 0 01-2-2V6c0-1.1.9-2 2-2h14zm0 9h-4v5h4v-5zm-6 0H9v5h4v-5zm0-7H9v5h4V6zm6 0h-4v5h4V6z"/></svg>',"table-merge-cells":'<svg width="24" height="24"><path fill-rule="nonzero" d="M19 4a2 2 0 012 2v12a2 2 0 01-2 2H5a2 2 0 01-2-2V6c0-1.1.9-2 2-2h14zM5 15.5V18h3v-2.5H5zm14-5h-9V18h9v-7.5zM19 6h-4v2.5h4V6zM8 6H5v2.5h3V6zm5 0h-3v2.5h3V6zm-8 7.5h3v-3H5v3z"/></svg>',"table-row-numbering-rtl":'<svg width="24" height="24"><path d="M6 4a2 2 0 00-2 2v13c0 1.1.9 2 2 2h12a2 2 0 002-2V6a2 2 0 00-2-2H6zm0 12h8v3H6v-3zm11 0c.6 0 1 .4 1 1v1a1 1 0 01-2 0v-1c0-.6.4-1 1-1zM6 11h8v3H6v-3zm11 0c.6 0 1 .4 1 1v1a1 1 0 01-2 0v-1c0-.6.4-1 1-1zM6 6h8v3H6V6zm11 0c.6 0 1 .4 1 1v1a1 1 0 11-2 0V7c0-.6.4-1 1-1z"/></svg>',"table-row-numbering":'<svg width="24" height="24"><path d="M18 4a2 2 0 012 2v13a2 2 0 01-2 2H6a2 2 0 01-2-2V6c0-1.1.9-2 2-2h12zm0 12h-8v3h8v-3zM7 16a1 1 0 00-1 1v1a1 1 0 002 0v-1c0-.6-.4-1-1-1zm11-5h-8v3h8v-3zM7 11a1 1 0 00-1 1v1a1 1 0 002 0v-1c0-.6-.4-1-1-1zm11-5h-8v3h8V6zM7 6a1 1 0 00-1 1v1a1 1 0 102 0V7c0-.6-.4-1-1-1z"/></svg>',"table-row-properties":'<svg width="24" height="24"><path fill-rule="nonzero" d="M19 4a2 2 0 012 2v12a2 2 0 01-2 2H5a2 2 0 01-2-2V6c0-1.1.9-2 2-2h14zM5 15v3h6v-3H5zm14 0h-6v3h6v-3zm0-9h-6v3h6V6zM5 9h6V6H5v3z"/></svg>',"table-split-cells":'<svg width="24" height="24"><path fill-rule="nonzero" d="M19 4a2 2 0 012 2v12a2 2 0 01-2 2H5a2 2 0 01-2-2V6c0-1.1.9-2 2-2h14zM8 15.5H5V18h3v-2.5zm11-5h-9V18h9v-7.5zm-2.5 1l1 1-2 2 2 2-1 1-2-2-2 2-1-1 2-2-2-2 1-1 2 2 2-2zm-8.5-1H5v3h3v-3zM19 6h-4v2.5h4V6zM8 6H5v2.5h3V6zm5 0h-3v2.5h3V6z"/></svg>',"table-top-header":'<svg width="24" height="24"><path d="M19 4a2 2 0 012 2v12a2 2 0 01-2 2H5a2 2 0 01-2-2V6c0-1.1.9-2 2-2h14zm-8 11H5v3h6v-3zm8 0h-6v3h6v-3zm0-5h-6v3h6v-3zM5 13h6v-3H5v3z"/></svg>',table:'<svg width="24" height="24"><path fill-rule="nonzero" d="M19 4a2 2 0 012 2v12a2 2 0 01-2 2H5a2 2 0 01-2-2V6c0-1.1.9-2 2-2h14zM5 14v4h6v-4H5zm14 0h-6v4h6v-4zm0-6h-6v4h6V8zM5 12h6V8H5v4z"/></svg>',template:'<svg width="24" height="24"><path d="M19 19v-1H5v1h14zM9 16v-4a5 5 0 116 0v4h4a2 2 0 012 2v3H3v-3c0-1.1.9-2 2-2h4zm4 0v-5l.8-.6a3 3 0 10-3.6 0l.8.6v5h2z" fill-rule="nonzero"/></svg>',"temporary-placeholder":'<svg width="24" height="24"><g fill-rule="evenodd"><path d="M9 7.6V6h2.5V4.5a.5.5 0 111 0V6H15v1.6a8 8 0 11-6 0zm-2.6 5.3a.5.5 0 00.3.6c.3 0 .6 0 .6-.3l.1-.2a5 5 0 013.3-2.8c.3-.1.4-.4.4-.6-.1-.3-.4-.5-.6-.4a6 6 0 00-4.1 3.7z"/><circle cx="14" cy="4" r="1"/><circle cx="12" cy="2" r="1"/><circle cx="10" cy="4" r="1"/></g></svg>',"text-color":'<svg width="24" height="24"><g fill-rule="evenodd"><path id="tox-icon-text-color__color" d="M3 18h18v3H3z"/><path d="M8.7 16h-.8a.5.5 0 01-.5-.6l2.7-9c.1-.3.3-.4.5-.4h2.8c.2 0 .4.1.5.4l2.7 9a.5.5 0 01-.5.6h-.8a.5.5 0 01-.4-.4l-.7-2.2c0-.3-.3-.4-.5-.4h-3.4c-.2 0-.4.1-.5.4l-.7 2.2c0 .3-.2.4-.4.4zm2.6-7.6l-.6 2a.5.5 0 00.5.6h1.6a.5.5 0 00.5-.6l-.6-2c0-.3-.3-.4-.5-.4h-.4c-.2 0-.4.1-.5.4z"/></g></svg>',toc:'<svg width="24" height="24"><path d="M5 5c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 110-2zm3 0h11c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 110-2zm-3 8c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 010-2zm3 0h11c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 010-2zm0-4c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 110-2zm3 0h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 010-2zm-3 8c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 010-2zm3 0h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 010-2z" fill-rule="evenodd"/></svg>',translate:'<svg width="24" height="24"><path d="M12.7 14.3l-.3.7-.4.7-2.2-2.2-3.1 3c-.3.4-.8.4-1 0a.7.7 0 010-1l3.1-3A12.4 12.4 0 016.7 9H8a10.1 10.1 0 001.7 2.4c.5-.5 1-1.1 1.4-1.8l.9-2H4.7a.7.7 0 110-1.5h4.4v-.7c0-.4.3-.8.7-.8.4 0 .7.4.7.8v.7H15c.4 0 .8.3.8.7 0 .4-.4.8-.8.8h-1.4a12.3 12.3 0 01-1 2.4 13.5 13.5 0 01-1.7 2.3l1.9 1.8zm4.3-3l2.7 7.3a.5.5 0 01-.4.7 1 1 0 01-1-.7l-.6-1.5h-3.4l-.6 1.5a1 1 0 01-1 .7.5.5 0 01-.4-.7l2.7-7.4a1 1 0 012 0zm-2.2 4.4h2.4L16 12.5l-1.2 3.2z" fill-rule="evenodd"/></svg>',underline:'<svg width="24" height="24"><path d="M16 5c.6 0 1 .4 1 1v5.5a4 4 0 01-.4 1.8l-1 1.4a5.3 5.3 0 01-5.5 1 5 5 0 01-1.6-1c-.5-.4-.8-.9-1.1-1.4a4 4 0 01-.4-1.8V6c0-.6.4-1 1-1s1 .4 1 1v5.5c0 .3 0 .6.2 1l.6.7a3.3 3.3 0 002.2.8 3.4 3.4 0 002.2-.8c.3-.2.4-.5.6-.8l.2-.9V6c0-.6.4-1 1-1zM8 17h8c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 010-2z" fill-rule="evenodd"/></svg>',undo:'<svg width="24" height="24"><path d="M6.4 8H12c3.7 0 6.2 2 6.8 5.1.6 2.7-.4 5.6-2.3 6.8a1 1 0 01-1-1.8c1.1-.6 1.8-2.7 1.4-4.6-.5-2.1-2.1-3.5-4.9-3.5H6.4l3.3 3.3a1 1 0 11-1.4 1.4l-5-5a1 1 0 010-1.4l5-5a1 1 0 011.4 1.4L6.4 8z" fill-rule="nonzero"/></svg>',unlink:'<svg width="24" height="24"><path d="M6.2 12.3a1 1 0 011.4 1.4l-2 2a2 2 0 102.6 2.8l4.8-4.8a1 1 0 000-1.4 1 1 0 111.4-1.3 2.9 2.9 0 010 4L9.6 20a3.9 3.9 0 01-5.5-5.5l2-2zm11.6-.6a1 1 0 01-1.4-1.4l2.1-2a2 2 0 10-2.7-2.8L11 10.3a1 1 0 000 1.4A1 1 0 119.6 13a2.9 2.9 0 010-4L14.4 4a3.9 3.9 0 015.5 5.5l-2 2zM7.6 6.3a.8.8 0 01-1 1.1L3.3 4.2a.7.7 0 111-1l3.2 3.1zM5.1 8.6a.8.8 0 010 1.5H3a.8.8 0 010-1.5H5zm5-3.5a.8.8 0 01-1.5 0V3a.8.8 0 011.5 0V5zm6 11.8a.8.8 0 011-1l3.2 3.2a.8.8 0 01-1 1L16 17zm-2.2 2a.8.8 0 011.5 0V21a.8.8 0 01-1.5 0V19zm5-3.5a.7.7 0 110-1.5H21a.8.8 0 010 1.5H19z" fill-rule="nonzero"/></svg>',unlock:'<svg width="24" height="24"><path d="M16 5c.8 0 1.5.3 2.1.9.6.6.9 1.3.9 2.1v3h-2V8a1 1 0 00-.3-.7A1 1 0 0016 7h-2a1 1 0 00-.7.3 1 1 0 00-.3.7v3h.3c.2 0 .3 0 .5.2l.2.6v7.4c0 .3 0 .4-.2.6l-.6.2H4.8c-.3 0-.4 0-.6-.2a.7.7 0 01-.2-.6v-7.4c0-.3 0-.4.2-.6l.5-.2H11V8c0-.8.3-1.5.9-2.1.6-.6 1.3-.9 2.1-.9h2z" fill-rule="evenodd"/></svg>',"unordered-list":'<svg width="24" height="24"><path d="M11 5h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 010-2zm0 6h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 010-2zm0 6h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 010-2zM4.5 6c0-.4.1-.8.4-1 .3-.4.7-.5 1.1-.5.4 0 .8.1 1 .4.4.3.5.7.5 1.1 0 .4-.1.8-.4 1-.3.4-.7.5-1.1.5-.4 0-.8-.1-1-.4-.4-.3-.5-.7-.5-1.1zm0 6c0-.4.1-.8.4-1 .3-.4.7-.5 1.1-.5.4 0 .8.1 1 .4.4.3.5.7.5 1.1 0 .4-.1.8-.4 1-.3.4-.7.5-1.1.5-.4 0-.8-.1-1-.4-.4-.3-.5-.7-.5-1.1zm0 6c0-.4.1-.8.4-1 .3-.4.7-.5 1.1-.5.4 0 .8.1 1 .4.4.3.5.7.5 1.1 0 .4-.1.8-.4 1-.3.4-.7.5-1.1.5-.4 0-.8-.1-1-.4-.4-.3-.5-.7-.5-1.1z" fill-rule="evenodd"/></svg>',unselected:'<svg width="24" height="24"><path fill-rule="nonzero" d="M6 4h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V6c0-1.1.9-2 2-2zm0 1a1 1 0 00-1 1v12c0 .6.4 1 1 1h12c.6 0 1-.4 1-1V6c0-.6-.4-1-1-1H6z"/></svg>',upload:'<svg width="24" height="24"><path d="M18 19v-2a1 1 0 012 0v3c0 .6-.4 1-1 1H5a1 1 0 01-1-1v-3a1 1 0 012 0v2h12zM11 6.4L8.7 8.7a1 1 0 01-1.4-1.4l4-4a1 1 0 011.4 0l4 4a1 1 0 11-1.4 1.4L13 6.4V16a1 1 0 01-2 0V6.4z" fill-rule="nonzero"/></svg>',user:'<svg width="24" height="24"><path d="M12 24a12 12 0 110-24 12 12 0 010 24zm-8.7-5.3a11 11 0 0017.4 0C19.4 16.3 14.6 15 12 15c-2.6 0-7.4 1.3-8.7 3.7zM12 13c2.2 0 4-2 4-4.5S14.2 4 12 4 8 6 8 8.5 9.8 13 12 13z" fill-rule="nonzero"/></svg>',"vertical-align":'<svg width="24" height="24"><g fill-rule="nonzero"><rect width="18" height="2" x="3" y="11" rx="1"/><path d="M12 2c.6 0 1 .4 1 1v4l2-1.3a1 1 0 011.2 1.5l-.1.1-4.1 3-4-3a1 1 0 011-1.7l2 1.5V3c0-.6.4-1 1-1zm0 11.8l4 2.9a1 1 0 01-1 1.7l-2-1.5V21c0 .5-.4 1-.9 1H12a1 1 0 01-1-1v-4l-2 1.3a1 1 0 01-1.2-.1l-.1-.1a1 1 0 01.1-1.3l.1-.1 4.1-3z"/></g></svg>',visualblocks:'<svg width="24" height="24"><path d="M9 19v2H7v-2h2zm-4 0v2a2 2 0 01-2-2h2zm8 0v2h-2v-2h2zm8 0a2 2 0 01-2 2v-2h2zm-4 0v2h-2v-2h2zM15 7a1 1 0 010 2v7a1 1 0 01-2 0V9h-1v7a1 1 0 01-2 0v-4a2.5 2.5 0 01-.2-5H15zM5 15v2H3v-2h2zm16 0v2h-2v-2h2zM5 11v2H3v-2h2zm16 0v2h-2v-2h2zM5 7v2H3V7h2zm16 0v2h-2V7h2zM5 3v2H3c0-1.1.9-2 2-2zm8 0v2h-2V3h2zm6 0a2 2 0 012 2h-2V3zM9 3v2H7V3h2zm8 0v2h-2V3h2z" fill-rule="evenodd"/></svg>',visualchars:'<svg width="24" height="24"><path d="M10 5h7a1 1 0 010 2h-1v11a1 1 0 01-2 0V7h-2v11a1 1 0 01-2 0v-6c-.5 0-1 0-1.4-.3A3.4 3.4 0 016.8 10a3.3 3.3 0 010-2.8 3.4 3.4 0 011.8-1.8L10 5z" fill-rule="evenodd"/></svg>',warning:'<svg width="24" height="24"><path d="M19.8 18.3c.2.5.3.9 0 1.2-.1.3-.5.5-1 .5H5.2c-.5 0-.9-.2-1-.5-.3-.3-.2-.7 0-1.2L11 4.7l.5-.5.5-.2c.2 0 .3 0 .5.2.2 0 .3.3.5.5l6.8 13.6zM12 18c.3 0 .5-.1.7-.3.2-.2.3-.4.3-.7a1 1 0 00-.3-.7 1 1 0 00-.7-.3 1 1 0 00-.7.3 1 1 0 00-.3.7c0 .3.1.5.3.7.2.2.4.3.7.3zm.7-3l.3-4a1 1 0 00-.3-.7 1 1 0 00-.7-.3 1 1 0 00-.7.3 1 1 0 00-.3.7l.3 4h1.4z" fill-rule="evenodd"/></svg>',"zoom-in":'<svg width="24" height="24"><path d="M16 17.3a8 8 0 111.4-1.4l4.3 4.4a1 1 0 01-1.4 1.4l-4.4-4.3zm-5-.3a6 6 0 100-12 6 6 0 000 12zm-1-9a1 1 0 012 0v6a1 1 0 01-2 0V8zm-2 4a1 1 0 010-2h6a1 1 0 010 2H8z" fill-rule="nonzero"/></svg>',"zoom-out":'<svg width="24" height="24"><path d="M16 17.3a8 8 0 111.4-1.4l4.3 4.4a1 1 0 01-1.4 1.4l-4.4-4.3zm-5-.3a6 6 0 100-12 6 6 0 000 12zm-3-5a1 1 0 010-2h6a1 1 0 010 2H8z" fill-rule="nonzero"/></svg>'}})},"8b20":function(e,t,n){"use strict";n.r(t);var r=n("3966"),i=n.n(r);for(var o in r)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(o);t["default"]=i.a},"8f13":function(e,t,n){},"8f18":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}},[t("span",{attrs:{slot:"parentAdId"},slot:"parentAdId"},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",remote:"",size:"small",clearable:"",placeholder:"所属人(输入名称或者手机号)","remote-method":e.remoteMethod,loading:e.remoteLoading},model:{value:e.filterData.parentAdId,callback:function(t){e.$set(e.filterData,"parentAdId",t)},expression:"filterData.parentAdId"}},e._l(e.supervisorAdOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)]),t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,operates:e.operates,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange},scopedSlots:e._u([{key:"image",fn:function(e){return t("div",{},[e.row.image?t("el-image",{staticStyle:{width:"50px"},attrs:{src:e.row.image,"preview-src-list":[e.row.image]}}):t("span")],1)}}])}),t("add-dialog",{ref:"addDialog",on:{success:e.handleSuccess}})],1)},i=[],o=n("7591"),a=n("b775"),s=n("ff04"),l=n("b893"),u={name:"adverstPage",components:{BasicTable:o["a"],addDialog:s["default"]},data(){return{loading:!1,remoteLoading:!1,supervisorAdOptions:[],categoryOptions:[],filterOptions:{column:[{type:"input",label:"客户名称",value:"name"},{type:"input",label:"客户区域",value:"region"},{type:"slot",slotName:"parentAdId"}]},filterData:{name:"",region:"",parentAdId:""},wageLevelOptions:[{label:"三千以下",value:1},{label:"三千到五千",value:2},{label:"五千到一万",value:3},{label:"一万到三万",value:4},{label:"三万以上",value:5}],table:{columns:[{id:1,prop:"name",label:"客户名称"},{id:2,prop:"parentName",label:"所属人"},{id:3,prop:"phone",label:"联系电话"},{id:4,prop:"idCard",label:"证件号码"},{id:5,prop:"birthday",label:"生日",type:"date",formate:"yyyy-MM-dd"},{id:6,prop:"region",label:"所属区域"},{id:7,prop:"homeAddress",label:"家庭住址"},{id:8,prop:"wageLevel",label:"工资水平",render:e=>{const t=this.wageLevelOptions.find(t=>t.value==e.wageLevel);return t?t.label:""}},{id:9,prop:"company",label:"单位"},{id:10,prop:"createTime",label:"创建时间",type:"date"}],pageSize:20,currentPage:1,data:[],total:0},operates:[{key:"edit",title:"编辑",btnStyle:"yellow",permission:"admin/adCustomer/edit",action:(e,t)=>{console.log(t),this.$refs.addDialog.edit(t)}},{key:"delete",title:"删除",permission:"admin/adCustomer/remove",btnStyle:"red",action:(e,t)=>{this.handleDelete(t)}}],headerOperates:[{key:"el-icon-plus",name:"添加客户",permission:"admin/adCustomer/add",action:()=>{this.$refs.addDialog.open()}}]}},created(){this.getList(),this.getCategoryList()},methods:{searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0,a["a"].post({url:"/admin/adCustomer/list",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,...this.filterData},success:e=>{this.table.data=e.list,this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1}})},getCategoryList(){a["a"].post({url:"/system/sysNewsCategory/listNoPage",params:{...this.addData},success:e=>{this.categoryOptions=e,this.filterOptions.column[1].options=Object(l["c"])(e)}})},handleSuccess(){this.getList()},handleDelete(e){this.$confirm("此操作将会删除该客户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/admin/adCustomer/remove",params:{id:e.id},success:e=>{this.$message.success(e),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},clearFilter(){this.filterData={name:""},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()},remoteMethod(e){e&&(this.remoteLoading=!0,a["a"].post({url:"/admin/adInfo/queryAdminByNameOrPhone",params:{search:e},success:e=>{this.remoteLoading=!1,this.supervisorAdOptions=e},catch:()=>{this.remoteLoading=!1}}))}}},c=u,d=(n("3a6a"),n("1805")),f=Object(d["a"])(c,r,i,!1,null,"ac2d01f2",null);t["default"]=f.exports},"8f1b":function(e,t,n){},"8f20":function(e,t,n){e.exports=n.p+"static/img/404.86bb86ac.png"},"8ffb":function(e,t,n){"use strict";n("6bbf")},9011:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{ref:"filter",attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}),t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange}})],1)},i=[],o=n("7591"),a=n("b775"),s=n("b893"),l={name:"personPerformance",components:{BasicTable:o["a"]},data(){return{loading:!1,categoryOptions:[],filterOptions:{column:[{type:"user",userType:0,label:"销售员",value:"profitAdId"},{type:"cascader",label:"部门",value:"departmentId",ref:"departmentRef",options:[],props:{value:"id",label:"name",multiple:!0}},{type:"timeAll",label:["开始日期","结束日期"],value:"time",clearable:!1}]},filterData:{profitAdId:"",departmentId:[],time:[this.$moment().startOf("month").format("YYYY-MM-DD"),this.$moment().endOf("month").format("YYYY-MM-DD")]},table:{columns:[{id:1,prop:"profitAdName",label:"销售员"},{id:2,prop:"receivable",label:"应收"},{id:4,prop:"received",label:"已收"},{id:5,prop:"unReceived",label:"未收"},{id:6,prop:"orderCount",label:"订单数"},{id:7,prop:"unreportedOrder",label:"未入账订单"},{id:8,prop:"orderNum",label:"订单编号"},{id:9,prop:"departments",label:"部门"}],pageSize:20,currentPage:1,data:[],total:0},operates:[],headerOperates:[{key:"export",permission:"system/sysCourseOrderBills/individualPerformanceStatisticsListExport",name:"导出",action:()=>{this.handleExport()}}]}},created(){this.getDepartmentList(),this.getList(),console.log(this.startTime)},methods:{handleExport(){this.$confirm("确定导出个人业绩统计列表吗？导出的时候请等待页面下载自动开始，如果数据量大，可能会等待稍长时间，请不要关闭或者刷新页面","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$message.warning("请耐心等待，表格正在导出中......");const{time:e,...t}=this.filterData;a["a"].post({url:"/system/sysCourseOrderBills/individualPerformanceStatisticsListExport",params:{createTimeSt:e[0],createTimeEt:e[1],...t},success:e=>{let t=document.createElement("a");t.href="https://"+e,document.body.appendChild(t),t.click(),document.body.removeChild(t),this.$message.success("导出成功"),this.searchFilter()}})}).catch(()=>{this.$message.info("已取消导出")})},searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0,this.$nextTick(()=>{console.log(this.$refs.filter.$refs.departmentRef[0].getCheckedNodes());const e=this.$refs.filter.$refs.departmentRef[0].getCheckedNodes().map(e=>e.data.id),{time:t,...n}=this.filterData;a["a"].post({url:"/system/sysCourseOrderBills/individualPerformanceStatisticsList",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,createTimeSt:t[0],createTimeEt:t[1],...n,departmentId:e&&e.length>0?JSON.stringify(e):""},success:e=>{this.table.data=e.list,this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1}})})},handleDelete(e){this.$confirm("此操作将会删除该新闻, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/system/sysNews/remove",params:{id:e.id},success:e=>{this.$message.success(e),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},getDepartmentList(){a["a"].post({url:"/admin/adInfo/canChooseCanSeeDepartmentList",params:{id:sessionStorage.getItem("id")},success:e=>{this.departmentList=e,this.filterOptions.column[1].options=Object(s["c"])(e)}})},clearFilter(){this.filterData={profitAdId:"",departmentId:"",time:[this.$moment().startOf("month").format("YYYY-MM-DD"),this.$moment().endOf("month").format("YYYY-MM-DD")]},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()}}},u=l,c=n("1805"),d=Object(c["a"])(u,r,i,!1,null,"69168ebe",null);t["default"]=d.exports},"91ef":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}),t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,operates:e.operates,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange},scopedSlots:e._u([{key:"image",fn:function(e){return t("div",{},[e.row.image?t("el-image",{staticStyle:{width:"50px"},attrs:{src:e.row.image,"preview-src-list":[e.row.image]}}):t("span")],1)}}])}),t("add-dialog",{ref:"addDialog",on:{success:e.handleSuccess}})],1)},i=[],o=n("7591"),a=n("b775"),s=n("9570"),l=(n("b893"),{name:"adverstPage",components:{BasicTable:o["a"],addDialog:s["default"]},data(){return{loading:!1,filterOptions:{column:[{type:"select",label:"分类类型",value:"type",options:[{label:"文章分类",value:1},{label:"课程分类",value:2},{label:"银行账户分类",value:3},{label:"课程套餐",value:4}]}]},filterData:{type:""},table:{columns:[{id:1,prop:"name",label:"分类名称"},{id:2,prop:"type",label:"分类类型",render:e=>this.filterOptions.column[0].options.find(t=>t.value==e.type)["label"]},{id:6,prop:"createTime",label:"创建时间",type:"date"}],pageSize:20,currentPage:1,data:[],total:0},operates:[{key:"edit",title:"编辑",btnStyle:"yellow",permission:"system/sysCategory/edit",action:(e,t)=>{this.$refs.addDialog.edit(t)}},{key:"delete",title:"删除",btnStyle:"red",permission:"system/sysCategory/remove",action:(e,t)=>{this.handleDelete(t)}}],headerOperates:[{key:"el-icon-plus",name:"添加分类",permission:"system/sysCategory/add",action:()=>{this.$refs.addDialog.open()}}]}},created(){this.getList()},methods:{searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0,a["a"].post({url:"/system/sysCategory/list",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,...this.filterData},success:e=>{this.table.data=e.list,this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1}})},handleSuccess(){this.getList()},handleDelete(e){this.$confirm("此操作将会删除该分类, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/system/sysCategory/remove",params:{id:e.id},success:e=>{this.$message.success(e),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},clearFilter(){this.filterData={name:""},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()}}}),u=l,c=(n("803d"),n("1805")),d=Object(c["a"])(u,r,i,!1,null,"869def7e",null);t["default"]=d.exports},"920b":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.addChaptersVisible,"append-to-body":!0,width:"50%"},on:{"update:visible":function(t){e.addChaptersVisible=t},close:e.close}},[t("el-form",{ref:"addChapterRef",attrs:{model:e.addData,rules:e.addChapterRule,"label-position":"left","label-width":"90px"}},[t("el-form-item",{attrs:{label:"章节名称:",prop:"name"}},[t("jat-input",{attrs:{placeholder:"请输入名称"},model:{value:e.addData.name,callback:function(t){e.$set(e.addData,"name",t)},expression:"addData.name"}})],1),t("el-form-item",{attrs:{label:"排序:",prop:"sort"}},[t("jat-input",{directives:[{name:"input",rawName:"v-input.int",modifiers:{int:!0}}],attrs:{placeholder:"请输入排序"},model:{value:e.addData.sort,callback:function(t){e.$set(e.addData,"sort",t)},expression:"addData.sort"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)},i=[],o=n("cbc3"),a=n("b775"),s=n("c46c"),l={components:{uploadImage:o["a"],uploadFile:s["a"]},data(){return{addChaptersVisible:!1,dialogTitle:"",addData:{name:"",courseId:"",sort:255,id:""},categoryOptions:[],addChapterRule:{name:[{required:!0,message:"请输入章节名称",trigger:"blur"}]}}},mounted(){},methods:{open(e){this.dialogTitle="添加父章节",this.addData.courseId=e,this.addChaptersVisible=!0},edit({name:e,id:t,sort:n},r){this.dialogTitle="编辑父章节",this.addChaptersVisible=!0,this.addData={name:e,id:t,sort:n,courseId:r}},close(){this.$refs.addChapterRef&&this.$refs.addChapterRef.clearValidate(),this.addData={courseId:"",name:"",sort:255,id:""},this.addChaptersVisible=!1},handleSubmit(){this.$refs.addChapterRef.validate(e=>{if(e){const{id:e,...t}=this.addData;e?a["a"].post({url:"/admin/adCourseChapters/uploadCourseEdit",params:{id:e,parentId:-1,...t},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}):a["a"].post({url:"/admin/adCourseChapters/uploadCourseAdd",params:{parentId:-1,...t},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}})}})}},watch:{}},u=l,c=n("1805"),d=Object(c["a"])(u,r,i,!1,null,"790c66cf",null);t["default"]=d.exports},"926b":function(e,t,n){},9303:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"布置作业",width:"60%",visible:e.chaptersVisible},on:{"update:visible":function(t){e.chaptersVisible=t}}},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"max-height":"500px"}},[t("BasicTable",{attrs:{columns:e.table.columns,height:"400px",operates:e.operates,operateWidth:"130px",hasCard:!1,isShowTableHead:!1,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total,"default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"}},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange}}),t("addDialog",{ref:"addWordDia",on:{success:e.handleSuccess}})],1)])},i=[],o=n("7591"),a=n("b775"),s=n("1d0e"),l={name:"chaptersPage",components:{BasicTable:o["a"],addDialog:s["default"]},data(){return{loading:!1,chaptersVisible:!1,remoteLoading:!1,openLiveVisible:!1,openLiveData:{},supervisorAdOptions:[],categoryOptions:[],filterOptions:{column:[]},teacherOptions:[],filterData:{id:""},table:{columns:[{id:1,prop:"name",label:"章节名称"},{id:2,type:"image",prop:"image",label:"封面"},{id:3,prop:"url",type:"video",label:"视频"},{id:4,prop:"lengthTime",label:"视频时长"}],pageSize:20,currentPage:1,data:[],total:0},operates:[{key:"edit",title:"布置作业",permission:"admin/adCourseChapters/uploadCourseEdit",btnStyle:"yellow",action:(e,t)=>{this.$refs.addChatptersDialog.edit(t)}}]}},computed:{},mounted(){},created(){},methods:{open(e){this.chaptersVisible=!0,this.filterData.id=e.id,this.getList()},searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0,a["a"].post({url:"/admin/adCourseChapters/courseList",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,...this.filterData},success:e=>{this.table.data=e.map(e=>({...e.parent,children:e.sonList.map(t=>({...t,parentInfo:e.parent}))})),this.loading=!1},catch:()=>{this.loading=!1}})},handleSuccess(){this.getList()},onCopy(){this.$message.success("复制成功")},handleClose(){this.openLiveData={}},clearFilter(){this.filterData={id:""},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()},handleDelete(e){this.$confirm("此操作将会删除该章节, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/admin/adCourseChapters/remove",params:{id:e.id},success:e=>{this.$message.success(e),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})}}},u=l,c=(n("877f"),n("1805")),d=Object(c["a"])(u,r,i,!1,null,"d1754c02",null);t["default"]=d.exports},"946d":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}},[t("span",{attrs:{slot:"teacherAdId"},slot:"teacherAdId"},[t("el-select",{staticStyle:{width:"85%"},attrs:{size:"small",clearable:"",filterable:"",remote:"",placeholder:"讲师","remote-method":e.teacherRemoteMethod,loading:e.remoteLoading},model:{value:e.filterData.teacherAdId,callback:function(t){e.$set(e.filterData,"teacherAdId",t)},expression:"filterData.teacherAdId"}},e._l(e.teacherOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)]),t("BasicTable",{attrs:{columns:e.table.columns,operates:e.operates,operateWidth:"130px",data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange}}),t("add-dialog",{ref:"addDialog",on:{success:e.handleSuccess}}),t("uploadVideo",{ref:"upload"}),t("el-dialog",{attrs:{title:"开播信息","close-on-click-modal":!1,visible:e.openLiveVisible,width:"50%"},on:{"update:visible":function(t){e.openLiveVisible=t},close:e.handleClose}},[t("div",{staticClass:"tipInfo"},[e._v(" 您已开播成功了。请保存好推流地址和推流码！请注意：不同的订单会产生不同的推流地址，请开播的时候仔细分辨 ")]),t("div",{staticClass:"account-box"},[t("span",[e._v("推流地址："+e._s(e.openLiveData.rtmpPublishUrl))]),t("span",[e._v("推流码："+e._s(e.openLiveData.code))]),t("span",[e._v("pc端观看地址："+e._s(e.openLiveData.pcLive))]),t("span",[e._v("移动端观看地址："+e._s(e.openLiveData.maLive))])]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"})]),t("el-dialog",{staticClass:"checkLive-dialog",attrs:{title:"直播审查","close-on-click-modal":!1,visible:e.openCheckLiveVisible,width:"80%"},on:{"update:visible":function(t){e.openCheckLiveVisible=t},close:e.handleCheckLiveClose}},[t("div",{staticClass:"tipInfo"},[t("div",{staticClass:"button-row"},e._l(e.currentTeachers,(function(n){return t("el-button",{key:n.id,staticClass:"live-button",attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.watchLive(n)}}},[e._v(" 观看"+e._s(n.name)+"的直播 ")])})),1)]),t("div",{staticClass:"video-container"},[t("div",{staticClass:"video-player",attrs:{id:"videoPlayer"}})]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"})]),t("chapters",{ref:"chapters",attrs:{isWrite:!1}}),t("workChapters",{ref:"workChaptersRef"})],1)},i=[],o=n("7591"),a=n("b775"),s=n("6a32"),l=n("5258"),u=n("d17b"),c=n("7d95"),d=n("2694"),f=n("88e9"),h=(n("3b90"),n("0796")),m=n.n(h);function p(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e}var g={exports:{}};(function(e,t){(function(t){var n=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,r=/^(?=([^\/?#]*))\1([^]*)$/,i=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,a={buildAbsoluteURL:function(e,t,n){if(n=n||{},e=e.trim(),t=t.trim(),!t){if(!n.alwaysNormalize)return e;var i=a.parseURL(e);if(!i)throw new Error("Error trying to parse base URL.");return i.path=a.normalizePath(i.path),a.buildURLFromParts(i)}var o=a.parseURL(t);if(!o)throw new Error("Error trying to parse relative URL.");if(o.scheme)return n.alwaysNormalize?(o.path=a.normalizePath(o.path),a.buildURLFromParts(o)):t;var s=a.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var l=r.exec(s.path);s.netLoc=l[1],s.path=l[2]}s.netLoc&&!s.path&&(s.path="/");var u={scheme:s.scheme,netLoc:o.netLoc,path:null,params:o.params,query:o.query,fragment:o.fragment};if(!o.netLoc&&(u.netLoc=s.netLoc,"/"!==o.path[0]))if(o.path){var c=s.path,d=c.substring(0,c.lastIndexOf("/")+1)+o.path;u.path=a.normalizePath(d)}else u.path=s.path,o.params||(u.params=s.params,o.query||(u.query=s.query));return null===u.path&&(u.path=n.alwaysNormalize?a.normalizePath(o.path):o.path),a.buildURLFromParts(u)},parseURL:function(e){var t=n.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){e=e.split("").reverse().join("").replace(i,"");while(e.length!==(e=e.replace(o,"")).length);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};e.exports=a})()})(g);var v=g.exports;function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function S(e){var t=w(e,"string");return"symbol"==typeof t?t:String(t)}function x(e,t,n){return t=S(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(){return C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},C.apply(this,arguments)}const T=Number.isFinite||function(e){return"number"===typeof e&&isFinite(e)},D=Number.isSafeInteger||function(e){return"number"===typeof e&&Math.abs(e)<=k},k=Number.MAX_SAFE_INTEGER||9007199254740991;let E=function(e){return e["MEDIA_ATTACHING"]="hlsMediaAttaching",e["MEDIA_ATTACHED"]="hlsMediaAttached",e["MEDIA_DETACHING"]="hlsMediaDetaching",e["MEDIA_DETACHED"]="hlsMediaDetached",e["BUFFER_RESET"]="hlsBufferReset",e["BUFFER_CODECS"]="hlsBufferCodecs",e["BUFFER_CREATED"]="hlsBufferCreated",e["BUFFER_APPENDING"]="hlsBufferAppending",e["BUFFER_APPENDED"]="hlsBufferAppended",e["BUFFER_EOS"]="hlsBufferEos",e["BUFFER_FLUSHING"]="hlsBufferFlushing",e["BUFFER_FLUSHED"]="hlsBufferFlushed",e["MANIFEST_LOADING"]="hlsManifestLoading",e["MANIFEST_LOADED"]="hlsManifestLoaded",e["MANIFEST_PARSED"]="hlsManifestParsed",e["LEVEL_SWITCHING"]="hlsLevelSwitching",e["LEVEL_SWITCHED"]="hlsLevelSwitched",e["LEVEL_LOADING"]="hlsLevelLoading",e["LEVEL_LOADED"]="hlsLevelLoaded",e["LEVEL_UPDATED"]="hlsLevelUpdated",e["LEVEL_PTS_UPDATED"]="hlsLevelPtsUpdated",e["LEVELS_UPDATED"]="hlsLevelsUpdated",e["AUDIO_TRACKS_UPDATED"]="hlsAudioTracksUpdated",e["AUDIO_TRACK_SWITCHING"]="hlsAudioTrackSwitching",e["AUDIO_TRACK_SWITCHED"]="hlsAudioTrackSwitched",e["AUDIO_TRACK_LOADING"]="hlsAudioTrackLoading",e["AUDIO_TRACK_LOADED"]="hlsAudioTrackLoaded",e["SUBTITLE_TRACKS_UPDATED"]="hlsSubtitleTracksUpdated",e["SUBTITLE_TRACKS_CLEARED"]="hlsSubtitleTracksCleared",e["SUBTITLE_TRACK_SWITCH"]="hlsSubtitleTrackSwitch",e["SUBTITLE_TRACK_LOADING"]="hlsSubtitleTrackLoading",e["SUBTITLE_TRACK_LOADED"]="hlsSubtitleTrackLoaded",e["SUBTITLE_FRAG_PROCESSED"]="hlsSubtitleFragProcessed",e["CUES_PARSED"]="hlsCuesParsed",e["NON_NATIVE_TEXT_TRACKS_FOUND"]="hlsNonNativeTextTracksFound",e["INIT_PTS_FOUND"]="hlsInitPtsFound",e["FRAG_LOADING"]="hlsFragLoading",e["FRAG_LOAD_EMERGENCY_ABORTED"]="hlsFragLoadEmergencyAborted",e["FRAG_LOADED"]="hlsFragLoaded",e["FRAG_DECRYPTED"]="hlsFragDecrypted",e["FRAG_PARSING_INIT_SEGMENT"]="hlsFragParsingInitSegment",e["FRAG_PARSING_USERDATA"]="hlsFragParsingUserdata",e["FRAG_PARSING_METADATA"]="hlsFragParsingMetadata",e["FRAG_PARSED"]="hlsFragParsed",e["FRAG_BUFFERED"]="hlsFragBuffered",e["FRAG_CHANGED"]="hlsFragChanged",e["FPS_DROP"]="hlsFpsDrop",e["FPS_DROP_LEVEL_CAPPING"]="hlsFpsDropLevelCapping",e["MAX_AUTO_LEVEL_UPDATED"]="hlsMaxAutoLevelUpdated",e["ERROR"]="hlsError",e["DESTROYING"]="hlsDestroying",e["KEY_LOADING"]="hlsKeyLoading",e["KEY_LOADED"]="hlsKeyLoaded",e["LIVE_BACK_BUFFER_REACHED"]="hlsLiveBackBufferReached",e["BACK_BUFFER_REACHED"]="hlsBackBufferReached",e["STEERING_MANIFEST_LOADED"]="hlsSteeringManifestLoaded",e}({}),_=function(e){return e["NETWORK_ERROR"]="networkError",e["MEDIA_ERROR"]="mediaError",e["KEY_SYSTEM_ERROR"]="keySystemError",e["MUX_ERROR"]="muxError",e["OTHER_ERROR"]="otherError",e}({}),A=function(e){return e["KEY_SYSTEM_NO_KEYS"]="keySystemNoKeys",e["KEY_SYSTEM_NO_ACCESS"]="keySystemNoAccess",e["KEY_SYSTEM_NO_SESSION"]="keySystemNoSession",e["KEY_SYSTEM_NO_CONFIGURED_LICENSE"]="keySystemNoConfiguredLicense",e["KEY_SYSTEM_LICENSE_REQUEST_FAILED"]="keySystemLicenseRequestFailed",e["KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED"]="keySystemServerCertificateRequestFailed",e["KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED"]="keySystemServerCertificateUpdateFailed",e["KEY_SYSTEM_SESSION_UPDATE_FAILED"]="keySystemSessionUpdateFailed",e["KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED"]="keySystemStatusOutputRestricted",e["KEY_SYSTEM_STATUS_INTERNAL_ERROR"]="keySystemStatusInternalError",e["MANIFEST_LOAD_ERROR"]="manifestLoadError",e["MANIFEST_LOAD_TIMEOUT"]="manifestLoadTimeOut",e["MANIFEST_PARSING_ERROR"]="manifestParsingError",e["MANIFEST_INCOMPATIBLE_CODECS_ERROR"]="manifestIncompatibleCodecsError",e["LEVEL_EMPTY_ERROR"]="levelEmptyError",e["LEVEL_LOAD_ERROR"]="levelLoadError",e["LEVEL_LOAD_TIMEOUT"]="levelLoadTimeOut",e["LEVEL_PARSING_ERROR"]="levelParsingError",e["LEVEL_SWITCH_ERROR"]="levelSwitchError",e["AUDIO_TRACK_LOAD_ERROR"]="audioTrackLoadError",e["AUDIO_TRACK_LOAD_TIMEOUT"]="audioTrackLoadTimeOut",e["SUBTITLE_LOAD_ERROR"]="subtitleTrackLoadError",e["SUBTITLE_TRACK_LOAD_TIMEOUT"]="subtitleTrackLoadTimeOut",e["FRAG_LOAD_ERROR"]="fragLoadError",e["FRAG_LOAD_TIMEOUT"]="fragLoadTimeOut",e["FRAG_DECRYPT_ERROR"]="fragDecryptError",e["FRAG_PARSING_ERROR"]="fragParsingError",e["FRAG_GAP"]="fragGap",e["REMUX_ALLOC_ERROR"]="remuxAllocError",e["KEY_LOAD_ERROR"]="keyLoadError",e["KEY_LOAD_TIMEOUT"]="keyLoadTimeOut",e["BUFFER_ADD_CODEC_ERROR"]="bufferAddCodecError",e["BUFFER_INCOMPATIBLE_CODECS_ERROR"]="bufferIncompatibleCodecsError",e["BUFFER_APPEND_ERROR"]="bufferAppendError",e["BUFFER_APPENDING_ERROR"]="bufferAppendingError",e["BUFFER_STALLED_ERROR"]="bufferStalledError",e["BUFFER_FULL_ERROR"]="bufferFullError",e["BUFFER_SEEK_OVER_HOLE"]="bufferSeekOverHole",e["BUFFER_NUDGE_ON_STALL"]="bufferNudgeOnStall",e["INTERNAL_EXCEPTION"]="internalException",e["INTERNAL_ABORTED"]="aborted",e["UNKNOWN"]="unknown",e}({});const L=function(){},O={trace:L,debug:L,log:L,warn:L,info:L,error:L};let R=O;function I(e){const t=self.console[e];return t?t.bind(self.console,`[${e}] >`):L}function P(e,...t){t.forEach((function(t){R[t]=e[t]?e[t].bind(e):I(t)}))}function M(e,t){if("object"===typeof console&&!0===e||"object"===typeof e){P(e,"debug","log","info","warn","error");try{R.log(`Debug logs enabled for "${t}" in hls.js version 1.5.15`)}catch(n){R=O}}else R=O}const N=R,F=/^(\d+)x(\d+)$/,B=/(.+?)=(".*?"|.*?)(?:,|$)/g;class ${constructor(e){"string"===typeof e&&(e=$.parseAttrList(e)),C(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>"X-"===e.substring(0,2))}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;const n=new Uint8Array(t.length/2);for(let e=0;e<t.length/2;e++)n[e]=parseInt(t.slice(2*e,2*e+2),16);return n}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const n=this[e];return n?parseFloat(n):t}enumeratedString(e){return this[e]}bool(e){return"YES"===this[e]}decimalResolution(e){const t=F.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e){let t;const n={},r='"';B.lastIndex=0;while(null!==(t=B.exec(e))){let e=t[2];0===e.indexOf(r)&&e.lastIndexOf(r)===e.length-1&&(e=e.slice(1,-1));const i=t[1].trim();n[i]=e}return n}}function z(e){return"ID"!==e&&"CLASS"!==e&&"START-DATE"!==e&&"DURATION"!==e&&"END-DATE"!==e&&"END-ON-NEXT"!==e}function U(e){return"SCTE35-OUT"===e||"SCTE35-IN"===e}class V{constructor(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){const n=t.attr;for(const t in n)if(Object.prototype.hasOwnProperty.call(e,t)&&e[t]!==n[t]){N.warn(`DATERANGE tag attribute: "${t}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=t;break}e=C(new $({}),n,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const e=new Date(this.attr["END-DATE"]);T(e.getTime())&&(this._endDate=e)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const e=this.duration;return null!==e?new Date(this._startDate.getTime()+1e3*e):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(T(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&T(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class H{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var j={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class q{constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[j.AUDIO]:null,[j.VIDEO]:null,[j.AUDIOVIDEO]:null},this.baseurl=e}setByteRange(e,t){const n=e.split("@",2);let r;r=1===n.length?(null==t?void 0:t.byteRangeEndOffset)||0:parseInt(n[1]),this._byteRange=[r,parseInt(n[0])+r]}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=v.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}}class G extends q{constructor(e,t){super(t),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new H,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const e=this.levelkeys.identity;if(e)this._decryptdata=e.getDecryptData(this.sn);else{const e=Object.keys(this.levelkeys);if(1===e.length)return this._decryptdata=this.levelkeys[e[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(null===this.programDateTime)return null;if(!T(this.programDateTime))return null;const e=T(this.duration)?this.duration:0;return this.programDateTime+1e3*e}get encrypted(){var e;if(null!=(e=this._decryptdata)&&e.encrypted)return!0;if(this.levelkeys){const e=Object.keys(this.levelkeys),t=e.length;if(t>1||1===t&&this.levelkeys[e[0]].encrypted)return!0}return!1}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;null==(e=this.loader)||e.abort(),null==(t=this.keyLoader)||t.abort()}setElementaryStreamInfo(e,t,n,r,i,o=!1){const{elementaryStreams:a}=this,s=a[e];s?(s.startPTS=Math.min(s.startPTS,t),s.endPTS=Math.max(s.endPTS,n),s.startDTS=Math.min(s.startDTS,r),s.endDTS=Math.max(s.endDTS,i)):a[e]={startPTS:t,endPTS:n,startDTS:r,endDTS:i,partial:o}}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[j.AUDIO]=null,e[j.VIDEO]=null,e[j.AUDIOVIDEO]=null}}class W extends q{constructor(e,t,n,r,i){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new H,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=r;const o=e.enumeratedString("BYTERANGE");o&&this.setByteRange(o,i),i&&(this.fragOffset=i.fragOffset+i.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}const K=10;class Y{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e)return this.advanced=!0,void(this.updated=!0);const t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||0===t&&n>0,this.updated||this.advanced?this.misses=Math.floor(.6*e.misses):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return!!this.fragments.length&&T(this.fragments[this.fragments.length-1].programDateTime)}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||K}get drift(){const e=this.driftEndTime-this.driftStartTime;if(e>0){const t=this.driftEnd-this.driftStart;return 1e3*t/e}return 1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return null!=(e=this.fragments)&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function X(e){return Uint8Array.from(atob(e),e=>e.charCodeAt(0))}function J(e){const t=ee(e).subarray(0,16),n=new Uint8Array(16);return n.set(t,16-t.length),n}function Q(e){const t=function(e,t,n){const r=e[t];e[t]=e[n],e[n]=r};t(e,0,3),t(e,1,2),t(e,4,5),t(e,6,7)}function Z(e){const t=e.split(":");let n=null;if("data"===t[0]&&2===t.length){const e=t[1].split(";"),r=e[e.length-1].split(",");if(2===r.length){const t="base64"===r[0],i=r[1];t?(e.splice(-1,1),n=X(i)):n=J(i)}}return n}function ee(e){return Uint8Array.from(unescape(encodeURIComponent(e)),e=>e.charCodeAt(0))}const te="undefined"!==typeof self?self:void 0;var ne={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},re={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function ie(e){switch(e){case re.FAIRPLAY:return ne.FAIRPLAY;case re.PLAYREADY:return ne.PLAYREADY;case re.WIDEVINE:return ne.WIDEVINE;case re.CLEARKEY:return ne.CLEARKEY}}var oe={CENC:"1077efecc0b24d02ace33c1e52e2fb4b",CLEARKEY:"e2719d58a985b3c9781ab030af78d30e",FAIRPLAY:"94ce86fb07ff4f43adb893d2fa968ca2",PLAYREADY:"9a04f07998404286ab92e65be0885f95",WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function ae(e){return e===oe.WIDEVINE?ne.WIDEVINE:e===oe.PLAYREADY?ne.PLAYREADY:e===oe.CENC||e===oe.CLEARKEY?ne.CLEARKEY:void 0}function se(e){switch(e){case ne.FAIRPLAY:return re.FAIRPLAY;case ne.PLAYREADY:return re.PLAYREADY;case ne.WIDEVINE:return re.WIDEVINE;case ne.CLEARKEY:return re.CLEARKEY}}function le(e){const{drmSystems:t,widevineLicenseUrl:n}=e,r=t?[ne.FAIRPLAY,ne.WIDEVINE,ne.PLAYREADY,ne.CLEARKEY].filter(e=>!!t[e]):[];return!r[ne.WIDEVINE]&&n&&r.push(ne.WIDEVINE),r}const ue=function(e){return null!=te&&null!=(e=te.navigator)&&e.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function ce(e,t,n,r){let i;switch(e){case ne.FAIRPLAY:i=["cenc","sinf"];break;case ne.WIDEVINE:case ne.PLAYREADY:i=["cenc"];break;case ne.CLEARKEY:i=["cenc","keyids"];break;default:throw new Error("Unknown key-system: "+e)}return de(i,t,n,r)}function de(e,t,n,r){const i={initDataTypes:e,persistentState:r.persistentState||"optional",distinctiveIdentifier:r.distinctiveIdentifier||"optional",sessionTypes:r.sessionTypes||[r.sessionType||"temporary"],audioCapabilities:t.map(e=>({contentType:`audio/mp4; codecs="${e}"`,robustness:r.audioRobustness||"",encryptionScheme:r.audioEncryptionScheme||null})),videoCapabilities:n.map(e=>({contentType:`video/mp4; codecs="${e}"`,robustness:r.videoRobustness||"",encryptionScheme:r.videoEncryptionScheme||null}))};return[i]}function fe(e,t,n){return Uint8Array.prototype.slice?e.slice(t,n):new Uint8Array(Array.prototype.slice.call(e,t,n))}const he=(e,t)=>t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128,me=(e,t)=>t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128,pe=(e,t)=>{const n=t;let r=0;while(he(e,t)){r+=10;const n=ge(e,t+6);r+=n,me(e,t+10)&&(r+=10),t+=r}if(r>0)return e.subarray(n,n+r)},ge=(e,t)=>{let n=0;return n=(127&e[t])<<21,n|=(127&e[t+1])<<14,n|=(127&e[t+2])<<7,n|=127&e[t+3],n},ve=(e,t)=>he(e,t)&&ge(e,t+6)+10<=e.length-t,be=e=>{const t=Se(e);for(let n=0;n<t.length;n++){const e=t[n];if(ye(e))return ke(e)}},ye=e=>e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info,we=e=>{const t=String.fromCharCode(e[0],e[1],e[2],e[3]),n=ge(e,4),r=10;return{type:t,size:n,data:e.subarray(r,r+n)}},Se=e=>{let t=0;const n=[];while(he(e,t)){const r=ge(e,t+6);t+=10;const i=t+r;while(t+8<i){const r=we(e.subarray(t)),i=xe(r);i&&n.push(i),t+=r.size+10}me(e,t)&&(t+=10)}return n},xe=e=>"PRIV"===e.type?Ce(e):"W"===e.type[0]?De(e):Te(e),Ce=e=>{if(e.size<2)return;const t=Ee(e.data,!0),n=new Uint8Array(e.data.subarray(t.length+1));return{key:e.type,info:t,data:n.buffer}},Te=e=>{if(e.size<2)return;if("TXXX"===e.type){let t=1;const n=Ee(e.data.subarray(t),!0);t+=n.length+1;const r=Ee(e.data.subarray(t));return{key:e.type,info:n,data:r}}const t=Ee(e.data.subarray(1));return{key:e.type,data:t}},De=e=>{if("WXXX"===e.type){if(e.size<2)return;let t=1;const n=Ee(e.data.subarray(t),!0);t+=n.length+1;const r=Ee(e.data.subarray(t));return{key:e.type,info:n,data:r}}const t=Ee(e.data);return{key:e.type,data:t}},ke=e=>{if(8===e.data.byteLength){const t=new Uint8Array(e.data),n=1&t[3];let r=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return r/=45,n&&(r+=47721858.84),Math.round(r)}},Ee=(e,t=!1)=>{const n=Ae();if(n){const r=n.decode(e);if(t){const e=r.indexOf("\0");return-1!==e?r.substring(0,e):r}return r.replace(/\0/g,"")}const r=e.length;let i,o,a,s="",l=0;while(l<r){if(i=e[l++],0===i&&t)return s;if(0!==i&&3!==i)switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:s+=String.fromCharCode(i);break;case 12:case 13:o=e[l++],s+=String.fromCharCode((31&i)<<6|63&o);break;case 14:o=e[l++],a=e[l++],s+=String.fromCharCode((15&i)<<12|(63&o)<<6|(63&a)<<0);break}}return s};let _e;function Ae(){if(!navigator.userAgent.includes("PlayStation 4"))return _e||"undefined"===typeof self.TextDecoder||(_e=new self.TextDecoder("utf-8")),_e}const Le={hexDump:function(e){let t="";for(let n=0;n<e.length;n++){let r=e[n].toString(16);r.length<2&&(r="0"+r),t+=r}return t}},Oe=Math.pow(2,32)-1,Re=[].push,Ie={video:1,audio:2,id3:3,text:4};function Pe(e){return String.fromCharCode.apply(null,e)}function Me(e,t){const n=e[t]<<8|e[t+1];return n<0?65536+n:n}function Ne(e,t){const n=Be(e,t);return n<0?4294967296+n:n}function Fe(e,t){let n=Ne(e,t);return n*=Math.pow(2,32),n+=Ne(e,t+4),n}function Be(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function $e(e,t,n){e[t]=n>>24,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=255&n}function ze(e){const t=e.byteLength;for(let n=0;n<t;){const r=Ne(e,n);if(r>8&&109===e[n+4]&&111===e[n+5]&&111===e[n+6]&&102===e[n+7])return!0;n=r>1?n+r:t}return!1}function Ue(e,t){const n=[];if(!t.length)return n;const r=e.byteLength;for(let i=0;i<r;){const o=Ne(e,i),a=Pe(e.subarray(i+4,i+8)),s=o>1?i+o:r;if(a===t[0])if(1===t.length)n.push(e.subarray(i+8,s));else{const r=Ue(e.subarray(i+8,s),t.slice(1));r.length&&Re.apply(n,r)}i=s}return n}function Ve(e){const t=[],n=e[0];let r=8;const i=Ne(e,r);r+=4;let o=0,a=0;0===n?(o=Ne(e,r),a=Ne(e,r+4),r+=8):(o=Fe(e,r),a=Fe(e,r+8),r+=16),r+=2;let s=e.length+a;const l=Me(e,r);r+=2;for(let u=0;u<l;u++){let n=r;const o=Ne(e,n);n+=4;const a=2147483647&o,l=(2147483648&o)>>>31;if(1===l)return N.warn("SIDX has hierarchical references (not supported)"),null;const u=Ne(e,n);n+=4,t.push({referenceSize:a,subsegmentDuration:u,info:{duration:u/i,start:s,end:s+a-1}}),s+=a,n+=4,r=n}return{earliestPresentationTime:o,timescale:i,version:n,referencesCount:l,references:t}}function He(e){const t=[],n=Ue(e,["moov","trak"]);for(let i=0;i<n.length;i++){const e=n[i],r=Ue(e,["tkhd"])[0];if(r){let n=r[0];const i=Ne(r,0===n?12:20),o=Ue(e,["mdia","mdhd"])[0];if(o){n=o[0];const r=Ne(o,0===n?12:20),a=Ue(e,["mdia","hdlr"])[0];if(a){const n=Pe(a.subarray(8,12)),o={soun:j.AUDIO,vide:j.VIDEO}[n];if(o){const n=Ue(e,["mdia","minf","stbl","stsd"])[0],a=je(n);t[i]={timescale:r,type:o},t[o]=y({timescale:r,id:i},a)}}}}}const r=Ue(e,["moov","mvex","trex"]);return r.forEach(e=>{const n=Ne(e,4),r=t[n];r&&(r.default={duration:Ne(e,12),flags:Ne(e,20)})}),t}function je(e){const t=e.subarray(8),n=t.subarray(86),r=Pe(t.subarray(4,8));let i=r;const o="enca"===r||"encv"===r;if(o){const e=Ue(t,[r])[0],n=e.subarray("enca"===r?28:78),o=Ue(n,["sinf"]);o.forEach(e=>{const t=Ue(e,["schm"])[0];if(t){const n=Pe(t.subarray(4,8));if("cbcs"===n||"cenc"===n){const t=Ue(e,["frma"])[0];t&&(i=Pe(t))}}})}switch(i){case"avc1":case"avc2":case"avc3":case"avc4":{const e=Ue(n,["avcC"])[0];i+="."+Ge(e[1])+Ge(e[2])+Ge(e[3]);break}case"mp4a":{const e=Ue(t,[r])[0],n=Ue(e.subarray(28),["esds"])[0];if(n&&n.length>12){let e=4;if(3!==n[e++])break;e=qe(n,e),e+=2;const t=n[e++];if(128&t&&(e+=2),64&t&&(e+=n[e++]),4!==n[e++])break;e=qe(n,e);const r=n[e++];if(64!==r)break;if(i+="."+Ge(r),e+=12,5!==n[e++])break;e=qe(n,e);const o=n[e++];let a=(248&o)>>3;31===a&&(a+=1+((7&o)<<3)+((224&n[e])>>5)),i+="."+a}break}case"hvc1":case"hev1":{const e=Ue(n,["hvcC"])[0],t=e[1],r=["","A","B","C"][t>>6],o=31&t,a=Ne(e,2),s=(32&t)>>5?"H":"L",l=e[12],u=e.subarray(6,12);i+="."+r+o,i+="."+a.toString(16).toUpperCase(),i+="."+s+l;let c="";for(let n=u.length;n--;){const e=u[n];if(e||c){const t=e.toString(16).toUpperCase();c="."+t+c}}i+=c;break}case"dvh1":case"dvhe":{const e=Ue(n,["dvcC"])[0],t=e[2]>>1&127,r=e[2]<<5&32|e[3]>>3&31;i+="."+We(t)+"."+We(r);break}case"vp09":{const e=Ue(n,["vpcC"])[0],t=e[4],r=e[5],o=e[6]>>4&15;i+="."+We(t)+"."+We(r)+"."+We(o);break}case"av01":{const e=Ue(n,["av1C"])[0],t=e[1]>>>5,r=31&e[1],o=e[2]>>>7?"H":"M",a=(64&e[2])>>6,s=(32&e[2])>>5,l=2===t&&a?s?12:10:a?10:8,u=(16&e[2])>>4,c=(8&e[2])>>3,d=(4&e[2])>>2,f=3&e[2],h=1,m=1,p=1,g=0;i+="."+t+"."+We(r)+o+"."+We(l)+"."+u+"."+c+d+f+"."+We(h)+"."+We(m)+"."+We(p)+"."+g;break}}return{codec:i,encrypted:o}}function qe(e,t){const n=t+5;while(128&e[t++]&&t<n);return t}function Ge(e){return("0"+e.toString(16).toUpperCase()).slice(-2)}function We(e){return(e<10?"0":"")+e}function Ke(e,t){if(!e||!t)return e;const n=t.keyId;if(n&&t.isCommonEncryption){const t=Ue(e,["moov","trak"]);t.forEach(e=>{const t=Ue(e,["mdia","minf","stbl","stsd"])[0],r=t.subarray(8);let i=Ue(r,["enca"]);const o=i.length>0;o||(i=Ue(r,["encv"])),i.forEach(e=>{const t=o?e.subarray(28):e.subarray(78),r=Ue(t,["sinf"]);r.forEach(e=>{const t=Ye(e);if(t){const e=t.subarray(8,24);e.some(e=>0!==e)||(N.log(`[eme] Patching keyId in 'enc${o?"a":"v"}>sinf>>tenc' box: ${Le.hexDump(e)} -> ${Le.hexDump(n)}`),t.set(n,8))}})})})}return e}function Ye(e){const t=Ue(e,["schm"])[0];if(t){const n=Pe(t.subarray(4,8));if("cbcs"===n||"cenc"===n)return Ue(e,["schi","tenc"])[0]}return null}function Xe(e,t){return Ue(t,["moof","traf"]).reduce((t,n)=>{const r=Ue(n,["tfdt"])[0],i=r[0],o=Ue(n,["tfhd"]).reduce((t,n)=>{const o=Ne(n,4),a=e[o];if(a){let e=Ne(r,4);if(1===i){if(e===Oe)return N.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),t;e*=Oe+1,e+=Ne(r,8)}const n=a.timescale||9e4,o=e/n;if(T(o)&&(null===t||o<t))return o}return t},null);return null!==o&&T(o)&&(null===t||o<t)?o:t},null)}function Je(e,t){let n=0,r=0,i=0;const o=Ue(e,["moof","traf"]);for(let a=0;a<o.length;a++){const e=o[a],s=Ue(e,["tfhd"])[0],l=Ne(s,4),u=t[l];if(!u)continue;const c=u.default,d=Ne(s,0)|(null==c?void 0:c.flags);let f=null==c?void 0:c.duration;8&d&&(f=Ne(s,2&d?12:8));const h=u.timescale||9e4,m=Ue(e,["trun"]);for(let t=0;t<m.length;t++){if(n=Qe(m[t]),!n&&f){const e=Ne(m[t],4);n=f*e}u.type===j.VIDEO?r+=n/h:u.type===j.AUDIO&&(i+=n/h)}}if(0===r&&0===i){let t=1/0,n=0,r=0;const i=Ue(e,["sidx"]);for(let e=0;e<i.length;e++){const o=Ve(i[e]);if(null!=o&&o.references){t=Math.min(t,o.earliestPresentationTime/o.timescale);const e=o.references.reduce((e,t)=>e+t.info.duration||0,0);n=Math.max(n,e+o.earliestPresentationTime/o.timescale),r=n-t}}if(r&&T(r))return r}return r||i}function Qe(e){const t=Ne(e,0);let n=8;1&t&&(n+=4),4&t&&(n+=4);let r=0;const i=Ne(e,4);for(let o=0;o<i;o++){if(256&t){const t=Ne(e,n);r+=t,n+=4}512&t&&(n+=4),1024&t&&(n+=4),2048&t&&(n+=4)}return r}function Ze(e,t,n){Ue(t,["moof","traf"]).forEach(t=>{Ue(t,["tfhd"]).forEach(r=>{const i=Ne(r,4),o=e[i];if(!o)return;const a=o.timescale||9e4;Ue(t,["tfdt"]).forEach(e=>{const t=e[0],r=n*a;if(r){let n=Ne(e,4);if(0===t)n-=r,n=Math.max(n,0),$e(e,4,n);else{n*=Math.pow(2,32),n+=Ne(e,8),n-=r,n=Math.max(n,0);const t=Math.floor(n/(Oe+1)),i=Math.floor(n%(Oe+1));$e(e,4,t),$e(e,8,i)}}})})})}function et(e){const t={valid:null,remainder:null},n=Ue(e,["moof"]);if(n.length<2)return t.remainder=e,t;const r=n[n.length-1];return t.valid=fe(e,0,r.byteOffset-8),t.remainder=fe(e,r.byteOffset-8),t}function tt(e,t){const n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}function nt(e,t){const n=[],r=t.samples,i=t.timescale,o=t.id;let a=!1;const s=Ue(r,["moof"]);return s.map(s=>{const l=s.byteOffset-8,u=Ue(s,["traf"]);u.map(s=>{const u=Ue(s,["tfdt"]).map(e=>{const t=e[0];let n=Ne(e,4);return 1===t&&(n*=Math.pow(2,32),n+=Ne(e,8)),n/i})[0];return void 0!==u&&(e=u),Ue(s,["tfhd"]).map(u=>{const c=Ne(u,4),d=16777215&Ne(u,0),f=0!==(1&d),h=0!==(2&d),m=0!==(8&d);let p=0;const g=0!==(16&d);let v=0;const b=0!==(32&d);let y=8;c===o&&(f&&(y+=8),h&&(y+=4),m&&(p=Ne(u,y),y+=4),g&&(v=Ne(u,y),y+=4),b&&(y+=4),"video"===t.type&&(a=rt(t.codec)),Ue(s,["trun"]).map(o=>{const s=o[0],u=16777215&Ne(o,0),c=0!==(1&u);let d=0;const f=0!==(4&u),h=0!==(256&u);let m=0;const g=0!==(512&u);let b=0;const y=0!==(1024&u),w=0!==(2048&u);let S=0;const x=Ne(o,4);let C=8;c&&(d=Ne(o,C),C+=4),f&&(C+=4);let T=d+l;for(let l=0;l<x;l++){if(h?(m=Ne(o,C),C+=4):m=p,g?(b=Ne(o,C),C+=4):b=v,y&&(C+=4),w&&(S=0===s?Ne(o,C):Be(o,C),C+=4),t.type===j.VIDEO){let t=0;while(t<b){const o=Ne(r,T);if(T+=4,it(a,r[T])){const t=r.subarray(T,T+o);ot(t,a?2:1,e+S/i,n)}T+=o,t+=o+4}}e+=m/i}}))})})}),n}function rt(e){if(!e)return!1;const t=e.indexOf("."),n=t<0?e:e.substring(0,t);return"hvc1"===n||"hev1"===n||"dvh1"===n||"dvhe"===n}function it(e,t){if(e){const e=t>>1&63;return 39===e||40===e}{const e=31&t;return 6===e}}function ot(e,t,n,r){const i=at(e);let o=0;o+=t;let a=0,s=0,l=0;while(o<i.length){a=0;do{if(o>=i.length)break;l=i[o++],a+=l}while(255===l);s=0;do{if(o>=i.length)break;l=i[o++],s+=l}while(255===l);const e=i.length-o;let t=o;if(s<e)o+=s;else if(s>e){N.error(`Malformed SEI payload. ${s} is too small, only ${e} bytes left to parse.`);break}if(4===a){const e=i[t++];if(181===e){const e=Me(i,t);if(t+=2,49===e){const e=Ne(i,t);if(t+=4,1195456820===e){const e=i[t++];if(3===e){const o=i[t++],s=31&o,l=64&o,u=l?2+3*s:0,c=new Uint8Array(u);if(l){c[0]=o;for(let e=1;e<u;e++)c[e]=i[t++]}r.push({type:e,payloadType:a,pts:n,bytes:c})}}}}}else if(5===a&&s>16){const e=[];for(let n=0;n<16;n++){const r=i[t++].toString(16);e.push(1==r.length?"0"+r:r),3!==n&&5!==n&&7!==n&&9!==n||e.push("-")}const o=s-16,l=new Uint8Array(o);for(let n=0;n<o;n++)l[n]=i[t++];r.push({payloadType:a,pts:n,uuid:e.join(""),userData:Ee(l),userDataBytes:l})}}}function at(e){const t=e.byteLength,n=[];let r=1;while(r<t-2)0===e[r]&&0===e[r+1]&&3===e[r+2]?(n.push(r+2),r+=2):r++;if(0===n.length)return e;const i=t-n.length,o=new Uint8Array(i);let a=0;for(r=0;r<i;a++,r++)a===n[0]&&(a++,n.shift()),o[r]=e[a];return o}function st(e){const t=e[0];let n="",r="",i=0,o=0,a=0,s=0,l=0,u=0;if(0===t){while("\0"!==Pe(e.subarray(u,u+1)))n+=Pe(e.subarray(u,u+1)),u+=1;n+=Pe(e.subarray(u,u+1)),u+=1;while("\0"!==Pe(e.subarray(u,u+1)))r+=Pe(e.subarray(u,u+1)),u+=1;r+=Pe(e.subarray(u,u+1)),u+=1,i=Ne(e,12),o=Ne(e,16),s=Ne(e,20),l=Ne(e,24),u=28}else if(1===t){u+=4,i=Ne(e,u),u+=4;const t=Ne(e,u);u+=4;const o=Ne(e,u);u+=4,a=2**32*t+o,D(a)||(a=Number.MAX_SAFE_INTEGER,N.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),s=Ne(e,u),u+=4,l=Ne(e,u),u+=4;while("\0"!==Pe(e.subarray(u,u+1)))n+=Pe(e.subarray(u,u+1)),u+=1;n+=Pe(e.subarray(u,u+1)),u+=1;while("\0"!==Pe(e.subarray(u,u+1)))r+=Pe(e.subarray(u,u+1)),u+=1;r+=Pe(e.subarray(u,u+1)),u+=1}const c=e.subarray(u,e.byteLength);return{schemeIdUri:n,value:r,timeScale:i,presentationTime:a,presentationTimeDelta:o,eventDuration:s,id:l,payload:c}}function lt(e,...t){const n=t.length;let r=8,i=n;while(i--)r+=t[i].byteLength;const o=new Uint8Array(r);for(o[0]=r>>24&255,o[1]=r>>16&255,o[2]=r>>8&255,o[3]=255&r,o.set(e,4),i=0,r=8;i<n;i++)o.set(t[i],r),r+=t[i].byteLength;return o}function ut(e,t,n){if(16!==e.byteLength)throw new RangeError("Invalid system id");let r,i,o;if(t){r=1,i=new Uint8Array(16*t.length);for(let e=0;e<t.length;e++){const n=t[e];if(16!==n.byteLength)throw new RangeError("Invalid key");i.set(n,16*e)}}else r=0,i=new Uint8Array;r>0?(o=new Uint8Array(4),t.length>0&&new DataView(o.buffer).setUint32(0,t.length,!1)):o=new Uint8Array;const a=new Uint8Array(4);return n&&n.byteLength>0&&new DataView(a.buffer).setUint32(0,n.byteLength,!1),lt([112,115,115,104],new Uint8Array([r,0,0,0]),e,o,i,a,n||new Uint8Array)}function ct(e){const t=[];if(e instanceof ArrayBuffer){const n=e.byteLength;let r=0;while(r+32<n){const n=new DataView(e,r),i=dt(n);t.push(i),r+=i.size}}return t}function dt(e){const t=e.getUint32(0),n=e.byteOffset,r=e.byteLength;if(r<t)return{offset:n,size:r};const i=e.getUint32(4);if(1886614376!==i)return{offset:n,size:t};const o=e.getUint32(8)>>>24;if(0!==o&&1!==o)return{offset:n,size:t};const a=e.buffer,s=Le.hexDump(new Uint8Array(a,n+12,16)),l=e.getUint32(28);let u=null,c=null;if(0===o){if(t-32<l||l<22)return{offset:n,size:t};c=new Uint8Array(a,n+32,l)}else if(1===o){if(!l||r<n+32+16*l+16)return{offset:n,size:t};u=[];for(let e=0;e<l;e++)u.push(new Uint8Array(a,n+32+16*e,16))}return{version:o,systemId:s,kids:u,data:c,offset:n,size:t}}let ft={};class ht{static clearKeyUriToKeyIdMap(){ft={}}constructor(e,t,n,r=[1],i=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=n,this.keyFormatVersions=r,this.iv=i,this.encrypted=!!e&&"NONE"!==e,this.isCommonEncryption=this.encrypted&&"AES-128"!==e}isSupported(){if(this.method){if("AES-128"===this.method||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case re.FAIRPLAY:case re.WIDEVINE:case re.PLAYREADY:case re.CLEARKEY:return-1!==["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if("AES-128"===this.method&&this.uri&&!this.iv){"number"!==typeof e&&("AES-128"!==this.method||this.iv||N.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const t=mt(e),n=new ht(this.method,this.uri,"identity",this.keyFormatVersions,t);return n}const t=Z(this.uri);if(t)switch(this.keyFormat){case re.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case re.PLAYREADY:{const e=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=ut(e,null,t);const n=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2),r=String.fromCharCode.apply(null,Array.from(n)),i=r.substring(r.indexOf("<"),r.length),o=new DOMParser,a=o.parseFromString(i,"text/xml"),s=a.getElementsByTagName("KID")[0];if(s){const e=s.childNodes[0]?s.childNodes[0].nodeValue:s.getAttribute("VALUE");if(e){const t=X(e).subarray(0,16);Q(t),this.keyId=t}}break}default:{let e=t.subarray(0,16);if(16!==e.length){const t=new Uint8Array(16);t.set(e,16-e.length),e=t}this.keyId=e;break}}if(!this.keyId||16!==this.keyId.byteLength){let e=ft[this.uri];if(!e){const t=Object.keys(ft).length%Number.MAX_SAFE_INTEGER;e=new Uint8Array(16);const n=new DataView(e.buffer,12,4);n.setUint32(0,t),ft[this.uri]=e}this.keyId=e}return this}}function mt(e){const t=new Uint8Array(16);for(let n=12;n<16;n++)t[n]=e>>8*(15-n)&255;return t}const pt=/\{\$([a-zA-Z0-9-_]+)\}/g;function gt(e){return pt.test(e)}function vt(e,t,n){if(null!==e.variableList||e.hasVariableRefs)for(let r=n.length;r--;){const i=n[r],o=t[i];o&&(t[i]=bt(e,o))}}function bt(e,t){if(null!==e.variableList||e.hasVariableRefs){const n=e.variableList;return t.replace(pt,t=>{const r=t.substring(2,t.length-1),i=null==n?void 0:n[r];return void 0===i?(e.playlistParsingError||(e.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${r}"`)),t):i})}return t}function yt(e,t,n){let r,i,o=e.variableList;if(o||(e.variableList=o={}),"QUERYPARAM"in t){r=t.QUERYPARAM;try{const e=new self.URL(n).searchParams;if(!e.has(r))throw new Error(`"${r}" does not match any query parameter in URI: "${n}"`);i=e.get(r)}catch(a){e.playlistParsingError||(e.playlistParsingError=new Error("EXT-X-DEFINE QUERYPARAM: "+a.message))}}else r=t.NAME,i=t.VALUE;r in o?e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${r}"`)):o[r]=i||""}function wt(e,t,n){const r=t.IMPORT;if(n&&r in n){let t=e.variableList;t||(e.variableList=t={}),t[r]=n[r]}else e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${r}"`))}function St(e=!0){if("undefined"===typeof self)return;const t=(e||!self.MediaSource)&&self.ManagedMediaSource;return t||self.MediaSource||self.WebKitMediaSource}function xt(e){return"undefined"!==typeof self&&e===self.ManagedMediaSource}const Ct={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function Tt(e,t){const n=Ct[t];return!!n&&!!n[e.slice(0,4)]}function Dt(e,t,n=!0){return!e.split(",").some(e=>!kt(e,t,n))}function kt(e,t,n=!0){var r;const i=St(n);return null!=(r=null==i?void 0:i.isTypeSupported(Et(e,t)))&&r}function Et(e,t){return`${t}/mp4;codecs="${e}"`}function _t(e){if(e){const t=e.substring(0,4);return Ct.video[t]}return 2}function At(e){return e.split(",").reduce((e,t)=>{const n=Ct.video[t];return n?(2*n+e)/(e?3:2):(Ct.audio[t]+e)/(e?2:1)},0)}const Lt={};function Ot(e,t=!0){if(Lt[e])return Lt[e];const n={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"]}[e];for(let r=0;r<n.length;r++)if(kt(n[r],"audio",t))return Lt[e]=n[r],n[r];return e}const Rt=/flac|opus/i;function It(e,t=!0){return e.replace(Rt,e=>Ot(e.toLowerCase(),t))}function Pt(e,t){return e&&"mp4a"!==e?e:t?t.split(",")[0]:t}function Mt(e){const t=e.split(",");for(let n=0;n<t.length;n++){const e=t[n].split(".");if(e.length>2){let r=e.shift()+".";r+=parseInt(e.shift()).toString(16),r+=("000"+parseInt(e.shift()).toString(16)).slice(-4),t[n]=r}}return t.join(",")}const Nt=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,Ft=/#EXT-X-MEDIA:(.*)/g,Bt=/^#EXT(?:INF|-X-TARGETDURATION):/m,$t=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),zt=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class Ut{static findGroup(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(r.id===t)return r}}static resolve(e,t){return v.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return Bt.test(e)}static parseMasterPlaylist(e,t){const n=gt(e),r={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:n},i=[];let o;Nt.lastIndex=0;while(null!=(o=Nt.exec(e)))if(o[1]){var a;const e=new $(o[1]);vt(r,e,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const n=bt(r,o[2]),s={attrs:e,bitrate:e.decimalInteger("BANDWIDTH")||e.decimalInteger("AVERAGE-BANDWIDTH"),name:e.NAME,url:Ut.resolve(n,t)},l=e.decimalResolution("RESOLUTION");l&&(s.width=l.width,s.height=l.height),jt(e.CODECS,s),null!=(a=s.unknownCodecs)&&a.length||i.push(s),r.levels.push(s)}else if(o[3]){const e=o[3],n=o[4];switch(e){case"SESSION-DATA":{const e=new $(n);vt(r,e,["DATA-ID","LANGUAGE","VALUE","URI"]);const t=e["DATA-ID"];t&&(null===r.sessionData&&(r.sessionData={}),r.sessionData[t]=e);break}case"SESSION-KEY":{const e=Vt(n,t,r);e.encrypted&&e.isSupported()?(null===r.sessionKeys&&(r.sessionKeys=[]),r.sessionKeys.push(e)):N.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${n}"`);break}case"DEFINE":{const e=new $(n);vt(r,e,["NAME","VALUE","QUERYPARAM"]),yt(r,e,t)}break;case"CONTENT-STEERING":{const e=new $(n);vt(r,e,["SERVER-URI","PATHWAY-ID"]),r.contentSteering={uri:Ut.resolve(e["SERVER-URI"],t),pathwayId:e["PATHWAY-ID"]||"."};break}case"START":r.startTimeOffset=Ht(n);break}}const s=i.length>0&&i.length<r.levels.length;return r.levels=s?i:r.levels,0===r.levels.length&&(r.playlistParsingError=new Error("no levels found in manifest")),r}static parseMasterPlaylistMedia(e,t,n){let r;const i={},o=n.levels,a={AUDIO:o.map(e=>({id:e.attrs.AUDIO,audioCodec:e.audioCodec})),SUBTITLES:o.map(e=>({id:e.attrs.SUBTITLES,textCodec:e.textCodec})),"CLOSED-CAPTIONS":[]};let s=0;Ft.lastIndex=0;while(null!==(r=Ft.exec(e))){const e=new $(r[1]),o=e.TYPE;if(o){const r=a[o],l=i[o]||[];i[o]=l,vt(n,e,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const u=e.LANGUAGE,c=e["ASSOC-LANGUAGE"],d=e.CHANNELS,f=e.CHARACTERISTICS,h=e["INSTREAM-ID"],m={attrs:e,bitrate:0,id:s++,groupId:e["GROUP-ID"]||"",name:e.NAME||u||"",type:o,default:e.bool("DEFAULT"),autoselect:e.bool("AUTOSELECT"),forced:e.bool("FORCED"),lang:u,url:e.URI?Ut.resolve(e.URI,t):""};if(c&&(m.assocLang=c),d&&(m.channels=d),f&&(m.characteristics=f),h&&(m.instreamId=h),null!=r&&r.length){const e=Ut.findGroup(r,m.groupId)||r[0];qt(m,e,"audioCodec"),qt(m,e,"textCodec")}l.push(m)}}return i}static parseLevelPlaylist(e,t,n,r,i,o){const a=new Y(t),s=a.fragments;let l,u,c,d=null,f=0,h=0,m=0,p=0,g=null,v=new G(r,t),b=-1,y=!1,w=null;$t.lastIndex=0,a.m3u8=e,a.hasVariableRefs=gt(e);while(null!==(l=$t.exec(e))){y&&(y=!1,v=new G(r,t),v.start=m,v.sn=f,v.cc=p,v.level=n,d&&(v.initSegment=d,v.rawProgramDateTime=d.rawProgramDateTime,d.rawProgramDateTime=null,w&&(v.setByteRange(w),w=null)));const e=l[1];if(e){v.duration=parseFloat(e);const t=(" "+l[2]).slice(1);v.title=t||null,v.tagList.push(t?["INF",e,t]:["INF",e])}else if(l[3]){if(T(v.duration)){v.start=m,c&&Yt(v,c,a),v.sn=f,v.level=n,v.cc=p,s.push(v);const e=(" "+l[3]).slice(1);v.relurl=bt(a,e),Wt(v,g),g=v,m+=v.duration,f++,h=0,y=!0}}else if(l[4]){const e=(" "+l[4]).slice(1);g?v.setByteRange(e,g):v.setByteRange(e)}else if(l[5])v.rawProgramDateTime=(" "+l[5]).slice(1),v.tagList.push(["PROGRAM-DATE-TIME",v.rawProgramDateTime]),-1===b&&(b=s.length);else{if(l=l[0].match(zt),!l){N.warn("No matches on slow regex match for level playlist!");continue}for(u=1;u<l.length;u++)if("undefined"!==typeof l[u])break;const e=(" "+l[u]).slice(1),i=(" "+l[u+1]).slice(1),m=l[u+2]?(" "+l[u+2]).slice(1):"";switch(e){case"PLAYLIST-TYPE":a.type=i.toUpperCase();break;case"MEDIA-SEQUENCE":f=a.startSN=parseInt(i);break;case"SKIP":{const e=new $(i);vt(a,e,["RECENTLY-REMOVED-DATERANGES"]);const t=e.decimalInteger("SKIPPED-SEGMENTS");if(T(t)){a.skippedSegments=t;for(let e=t;e--;)s.unshift(null);f+=t}const n=e.enumeratedString("RECENTLY-REMOVED-DATERANGES");n&&(a.recentlyRemovedDateranges=n.split("\t"));break}case"TARGETDURATION":a.targetduration=Math.max(parseInt(i),1);break;case"VERSION":a.version=parseInt(i);break;case"INDEPENDENT-SEGMENTS":case"EXTM3U":break;case"ENDLIST":a.live=!1;break;case"#":(i||m)&&v.tagList.push(m?[i,m]:[i]);break;case"DISCONTINUITY":p++,v.tagList.push(["DIS"]);break;case"GAP":v.gap=!0,v.tagList.push([e]);break;case"BITRATE":v.tagList.push([e,i]);break;case"DATERANGE":{const e=new $(i);vt(a,e,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),vt(a,e,e.clientAttrs);const t=new V(e,a.dateRanges[e.ID]);t.isValid||a.skippedSegments?a.dateRanges[t.id]=t:N.warn(`Ignoring invalid DATERANGE tag: "${i}"`),v.tagList.push(["EXT-X-DATERANGE",i]);break}case"DEFINE":{const e=new $(i);vt(a,e,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in e?wt(a,e,o):yt(a,e,t)}break;case"DISCONTINUITY-SEQUENCE":p=parseInt(i);break;case"KEY":{const e=Vt(i,t,a);if(e.isSupported()){if("NONE"===e.method){c=void 0;break}c||(c={}),c[e.keyFormat]&&(c=C({},c)),c[e.keyFormat]=e}else N.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${i}"`);break}case"START":a.startTimeOffset=Ht(i);break;case"MAP":{const e=new $(i);if(vt(a,e,["BYTERANGE","URI"]),v.duration){const i=new G(r,t);Kt(i,e,n,c),d=i,v.initSegment=d,d.rawProgramDateTime&&!v.rawProgramDateTime&&(v.rawProgramDateTime=d.rawProgramDateTime)}else{const t=v.byteRangeEndOffset;if(t){const e=v.byteRangeStartOffset;w=`${t-e}@${e}`}else w=null;Kt(v,e,n,c),d=v,y=!0}break}case"SERVER-CONTROL":{const e=new $(i);a.canBlockReload=e.bool("CAN-BLOCK-RELOAD"),a.canSkipUntil=e.optionalFloat("CAN-SKIP-UNTIL",0),a.canSkipDateRanges=a.canSkipUntil>0&&e.bool("CAN-SKIP-DATERANGES"),a.partHoldBack=e.optionalFloat("PART-HOLD-BACK",0),a.holdBack=e.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const e=new $(i);a.partTarget=e.decimalFloatingPoint("PART-TARGET");break}case"PART":{let e=a.partList;e||(e=a.partList=[]);const n=h>0?e[e.length-1]:void 0,r=h++,o=new $(i);vt(a,o,["BYTERANGE","URI"]);const s=new W(o,v,t,r,n);e.push(s),v.duration+=s.duration;break}case"PRELOAD-HINT":{const e=new $(i);vt(a,e,["URI"]),a.preloadHint=e;break}case"RENDITION-REPORT":{const e=new $(i);vt(a,e,["URI"]),a.renditionReports=a.renditionReports||[],a.renditionReports.push(e);break}default:N.warn("line parsed but not handled: "+l);break}}}g&&!g.relurl?(s.pop(),m-=g.duration,a.partList&&(a.fragmentHint=g)):a.partList&&(Wt(v,g),v.cc=p,a.fragmentHint=v,c&&Yt(v,c,a));const S=s.length,x=s[0],D=s[S-1];if(m+=a.skippedSegments*a.targetduration,m>0&&S&&D){a.averagetargetduration=m/S;const e=D.sn;a.endSN="initSegment"!==e?e:0,a.live||(D.endList=!0),x&&(a.startCC=x.cc)}else a.endSN=0,a.startCC=0;return a.fragmentHint&&(m+=a.fragmentHint.duration),a.totalduration=m,a.endCC=p,b>0&&Gt(s,b),a}}function Vt(e,t,n){var r,i;const o=new $(e);vt(n,o,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const a=null!=(r=o.METHOD)?r:"",s=o.URI,l=o.hexadecimalInteger("IV"),u=o.KEYFORMATVERSIONS,c=null!=(i=o.KEYFORMAT)?i:"identity";s&&o.IV&&!l&&N.error("Invalid IV: "+o.IV);const d=s?Ut.resolve(s,t):"",f=(u||"1").split("/").map(Number).filter(Number.isFinite);return new ht(a,d,c,f,l)}function Ht(e){const t=new $(e),n=t.decimalFloatingPoint("TIME-OFFSET");return T(n)?n:null}function jt(e,t){let n=(e||"").split(/[ ,]+/).filter(e=>e);["video","audio","text"].forEach(e=>{const r=n.filter(t=>Tt(t,e));r.length&&(t[e+"Codec"]=r.join(","),n=n.filter(e=>-1===r.indexOf(e)))}),t.unknownCodecs=n}function qt(e,t,n){const r=t[n];r&&(e[n]=r)}function Gt(e,t){let n=e[t];for(let r=t;r--;){const t=e[r];if(!t)return;t.programDateTime=n.programDateTime-1e3*t.duration,n=t}}function Wt(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):null!=t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime),T(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}function Kt(e,t,n,r){e.relurl=t.URI,t.BYTERANGE&&e.setByteRange(t.BYTERANGE),e.level=n,e.sn="initSegment",r&&(e.levelkeys=r),e.initSegment=null}function Yt(e,t,n){e.levelkeys=t;const{encryptedFragments:r}=n;r.length&&r[r.length-1].levelkeys===t||!Object.keys(t).some(e=>t[e].isCommonEncryption)||r.push(e)}var Xt={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},Jt={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function Qt(e){const{type:t}=e;switch(t){case Xt.AUDIO_TRACK:return Jt.AUDIO;case Xt.SUBTITLE_TRACK:return Jt.SUBTITLE;default:return Jt.MAIN}}function Zt(e,t){let n=e.url;return void 0!==n&&0!==n.indexOf("data:")||(n=t.url),n}class en{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(E.MANIFEST_LOADING,this.onManifestLoading,this),e.on(E.LEVEL_LOADING,this.onLevelLoading,this),e.on(E.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(E.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:e}=this;e.off(E.MANIFEST_LOADING,this.onManifestLoading,this),e.off(E.LEVEL_LOADING,this.onLevelLoading,this),e.off(E.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(E.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(e){const t=this.hls.config,n=t.pLoader,r=t.loader,i=n||r,o=new i(t);return this.loaders[e.type]=o,o}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:n}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:Xt.MANIFEST,url:n,deliveryDirectives:null})}onLevelLoading(e,t){const{id:n,level:r,pathwayId:i,url:o,deliveryDirectives:a}=t;this.load({id:n,level:r,pathwayId:i,responseType:"text",type:Xt.LEVEL,url:o,deliveryDirectives:a})}onAudioTrackLoading(e,t){const{id:n,groupId:r,url:i,deliveryDirectives:o}=t;this.load({id:n,groupId:r,level:null,responseType:"text",type:Xt.AUDIO_TRACK,url:i,deliveryDirectives:o})}onSubtitleTrackLoading(e,t){const{id:n,groupId:r,url:i,deliveryDirectives:o}=t;this.load({id:n,groupId:r,level:null,responseType:"text",type:Xt.SUBTITLE_TRACK,url:i,deliveryDirectives:o})}load(e){var t;const n=this.hls.config;let r,i=this.getInternalLoader(e);if(i){const t=i.context;if(t&&t.url===e.url&&t.level===e.level)return void N.trace("[playlist-loader]: playlist request ongoing");N.log("[playlist-loader]: aborting previous loader for type: "+e.type),i.abort()}if(r=e.type===Xt.MANIFEST?n.manifestLoadPolicy.default:C({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),i=this.createInternalLoader(e),T(null==(t=e.deliveryDirectives)?void 0:t.part)){let t;if(e.type===Xt.LEVEL&&null!==e.level?t=this.hls.levels[e.level].details:e.type===Xt.AUDIO_TRACK&&null!==e.id?t=this.hls.audioTracks[e.id].details:e.type===Xt.SUBTITLE_TRACK&&null!==e.id&&(t=this.hls.subtitleTracks[e.id].details),t){const e=t.partTarget,n=t.targetduration;if(e&&n){const t=1e3*Math.max(3*e,.8*n);r=C({},r,{maxTimeToFirstByteMs:Math.min(t,r.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(t,r.maxTimeToFirstByteMs)})}}}const o=r.errorRetry||r.timeoutRetry||{},a={loadPolicy:r,timeout:r.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},s={onSuccess:(e,t,n,r)=>{const i=this.getInternalLoader(n);this.resetInternalLoader(n.type);const o=e.data;0===o.indexOf("#EXTM3U")?(t.parsing.start=performance.now(),Ut.isMediaPlaylist(o)?this.handleTrackOrLevelPlaylist(e,t,n,r||null,i):this.handleMasterPlaylist(e,t,n,r)):this.handleManifestParsingError(e,n,new Error("no EXTM3U delimiter"),r||null,t)},onError:(e,t,n,r)=>{this.handleNetworkError(t,n,!1,e,r)},onTimeout:(e,t,n)=>{this.handleNetworkError(t,n,!0,void 0,e)}};i.load(e,a,s)}handleMasterPlaylist(e,t,n,r){const i=this.hls,o=e.data,a=Zt(e,n),s=Ut.parseMasterPlaylist(o,a);if(s.playlistParsingError)return void this.handleManifestParsingError(e,n,s.playlistParsingError,r,t);const{contentSteering:l,levels:u,sessionData:c,sessionKeys:d,startTimeOffset:f,variableList:h}=s;this.variableList=h;const{AUDIO:m=[],SUBTITLES:p,"CLOSED-CAPTIONS":g}=Ut.parseMasterPlaylistMedia(o,a,s);if(m.length){const e=m.some(e=>!e.url);e||!u[0].audioCodec||u[0].attrs.AUDIO||(N.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),m.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new $({}),bitrate:0,url:""}))}i.trigger(E.MANIFEST_LOADED,{levels:u,audioTracks:m,subtitles:p,captions:g,contentSteering:l,url:a,stats:t,networkDetails:r,sessionData:c,sessionKeys:d,startTimeOffset:f,variableList:h})}handleTrackOrLevelPlaylist(e,t,n,r,i){const o=this.hls,{id:a,level:s,type:l}=n,u=Zt(e,n),c=0,d=T(s)?s:T(a)?a:0,f=Qt(n),h=Ut.parseLevelPlaylist(e.data,u,d,f,c,this.variableList);if(l===Xt.MANIFEST){const e={attrs:new $({}),bitrate:0,details:h,name:"",url:u};o.trigger(E.MANIFEST_LOADED,{levels:[e],audioTracks:[],url:u,stats:t,networkDetails:r,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=h,this.handlePlaylistLoaded(h,e,t,n,r,i)}handleManifestParsingError(e,t,n,r,i){this.hls.trigger(E.ERROR,{type:_.NETWORK_ERROR,details:A.MANIFEST_PARSING_ERROR,fatal:t.type===Xt.MANIFEST,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:r,stats:i})}handleNetworkError(e,t,n=!1,r,i){let o=`A network ${n?"timeout":"error"+(r?" (status "+r.code+")":"")} occurred while loading ${e.type}`;e.type===Xt.LEVEL?o+=`: ${e.level} id: ${e.id}`:e.type!==Xt.AUDIO_TRACK&&e.type!==Xt.SUBTITLE_TRACK||(o+=` id: ${e.id} group-id: "${e.groupId}"`);const a=new Error(o);N.warn("[playlist-loader]: "+o);let s=A.UNKNOWN,l=!1;const u=this.getInternalLoader(e);switch(e.type){case Xt.MANIFEST:s=n?A.MANIFEST_LOAD_TIMEOUT:A.MANIFEST_LOAD_ERROR,l=!0;break;case Xt.LEVEL:s=n?A.LEVEL_LOAD_TIMEOUT:A.LEVEL_LOAD_ERROR,l=!1;break;case Xt.AUDIO_TRACK:s=n?A.AUDIO_TRACK_LOAD_TIMEOUT:A.AUDIO_TRACK_LOAD_ERROR,l=!1;break;case Xt.SUBTITLE_TRACK:s=n?A.SUBTITLE_TRACK_LOAD_TIMEOUT:A.SUBTITLE_LOAD_ERROR,l=!1;break}u&&this.resetInternalLoader(e.type);const c={type:_.NETWORK_ERROR,details:s,fatal:l,url:e.url,loader:u,context:e,error:a,networkDetails:t,stats:i};if(r){const n=(null==t?void 0:t.url)||e.url;c.response=y({url:n,data:void 0},r)}this.hls.trigger(E.ERROR,c)}handlePlaylistLoaded(e,t,n,r,i,o){const a=this.hls,{type:s,level:l,id:u,groupId:c,deliveryDirectives:d}=r,f=Zt(t,r),h=Qt(r),m="number"===typeof r.level&&h===Jt.MAIN?l:void 0;if(!e.fragments.length){const e=new Error("No Segments found in Playlist");return void a.trigger(E.ERROR,{type:_.NETWORK_ERROR,details:A.LEVEL_EMPTY_ERROR,fatal:!1,url:f,error:e,reason:e.message,response:t,context:r,level:m,parent:h,networkDetails:i,stats:n})}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const p=e.playlistParsingError;if(p)a.trigger(E.ERROR,{type:_.NETWORK_ERROR,details:A.LEVEL_PARSING_ERROR,fatal:!1,url:f,error:p,reason:p.message,response:t,context:r,level:m,parent:h,networkDetails:i,stats:n});else switch(e.live&&o&&(o.getCacheAge&&(e.ageHeader=o.getCacheAge()||0),o.getCacheAge&&!isNaN(e.ageHeader)||(e.ageHeader=0)),s){case Xt.MANIFEST:case Xt.LEVEL:a.trigger(E.LEVEL_LOADED,{details:e,level:m||0,id:u||0,stats:n,networkDetails:i,deliveryDirectives:d});break;case Xt.AUDIO_TRACK:a.trigger(E.AUDIO_TRACK_LOADED,{details:e,id:u||0,groupId:c||"",stats:n,networkDetails:i,deliveryDirectives:d});break;case Xt.SUBTITLE_TRACK:a.trigger(E.SUBTITLE_TRACK_LOADED,{details:e,id:u||0,groupId:c||"",stats:n,networkDetails:i,deliveryDirectives:d});break}}}function tn(e,t){let n;try{n=new Event("addtrack")}catch(r){n=document.createEvent("Event"),n.initEvent("addtrack",!1,!1)}n.track=e,t.dispatchEvent(n)}function nn(e,t){const n=e.mode;if("disabled"===n&&(e.mode="hidden"),e.cues&&!e.cues.getCueById(t.id))try{if(e.addCue(t),!e.cues.getCueById(t.id))throw new Error("addCue is failed for: "+t)}catch(r){N.debug("[texttrack-utils]: "+r);try{const n=new self.TextTrackCue(t.startTime,t.endTime,t.text);n.id=t.id,e.addCue(n)}catch(i){N.debug("[texttrack-utils]: Legacy TextTrackCue fallback failed: "+i)}}"disabled"===n&&(e.mode=n)}function rn(e){const t=e.mode;if("disabled"===t&&(e.mode="hidden"),e.cues)for(let n=e.cues.length;n--;)e.removeCue(e.cues[n]);"disabled"===t&&(e.mode=t)}function on(e,t,n,r){const i=e.mode;if("disabled"===i&&(e.mode="hidden"),e.cues&&e.cues.length>0){const i=sn(e.cues,t,n);for(let t=0;t<i.length;t++)r&&!r(i[t])||e.removeCue(i[t])}"disabled"===i&&(e.mode=i)}function an(e,t){if(t<e[0].startTime)return 0;const n=e.length-1;if(t>e[n].endTime)return-1;let r=0,i=n;while(r<=i){const o=Math.floor((i+r)/2);if(t<e[o].startTime)i=o-1;else{if(!(t>e[o].startTime&&r<n))return o;r=o+1}}return e[r].startTime-t<t-e[i].startTime?r:i}function sn(e,t,n){const r=[],i=an(e,t);if(i>-1)for(let o=i,a=e.length;o<a;o++){const i=e[o];if(i.startTime>=t&&i.endTime<=n)r.push(i);else if(i.startTime>n)return r}return r}function ln(e){const t=[];for(let n=0;n<e.length;n++){const r=e[n];"subtitles"!==r.kind&&"captions"!==r.kind||!r.label||t.push(e[n])}return t}var un={audioId3:"org.id3",dateRange:"com.apple.quicktime.HLS",emsg:"https://aomedia.org/emsg/ID3"};const cn=.25;function dn(){if("undefined"!==typeof self)return self.VTTCue||self.TextTrackCue}function fn(e,t,n,r,i){let o=new e(t,n,"");try{o.value=r,i&&(o.type=i)}catch(a){o=new e(t,n,JSON.stringify(i?y({type:i},r):r))}return o}const hn=(()=>{const e=dn();try{e&&new e(0,Number.POSITIVE_INFINITY,"")}catch(t){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function mn(e,t){return e.getTime()/1e3-t}function pn(e){return Uint8Array.from(e.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class gn{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:e}=this;e.on(E.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(E.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(E.MANIFEST_LOADING,this.onManifestLoading,this),e.on(E.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(E.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(E.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(E.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(E.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(E.MANIFEST_LOADING,this.onManifestLoading,this),e.off(E.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(E.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(E.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,t){this.media=t.media}onMediaDetaching(){this.id3Track&&(rn(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const n=e[t];if("metadata"===n.kind&&"id3"===n.label)return tn(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:n,enableID3MetadataCues:r}}}=this;if(!n&&!r)return;const{samples:i}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const o=dn();if(o)for(let a=0;a<i.length;a++){const e=i[a].type;if(e===un.emsg&&!n||!r)continue;const t=Se(i[a].data);if(t){const n=i[a].pts;let r=n+i[a].duration;r>hn&&(r=hn);const s=r-n;s<=0&&(r=n+cn);for(let i=0;i<t.length;i++){const a=t[i];if(!ye(a)){this.updateId3CueEnds(n,e);const t=fn(o,n,r,a,e);t&&this.id3Track.addCue(t)}}}}}updateId3CueEnds(e,t){var n;const r=null==(n=this.id3Track)?void 0:n.cues;if(r)for(let i=r.length;i--;){const n=r[i];n.type===t&&n.startTime<e&&n.endTime===hn&&(n.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:n,type:r}){const{id3Track:i,hls:o}=this;if(!o)return;const{config:{enableEmsgMetadataCues:a,enableID3MetadataCues:s}}=o;if(i&&(a||s)){let e;e="audio"===r?e=>e.type===un.audioId3&&s:"video"===r?e=>e.type===un.emsg&&a:e=>e.type===un.audioId3&&s||e.type===un.emsg&&a,on(i,t,n,e)}}onLevelUpdated(e,{details:t}){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:n,id3Track:r}=this,{dateRanges:i}=t,o=Object.keys(i);if(r){const e=Object.keys(n).filter(e=>!o.includes(e));for(let t=e.length;t--;){const i=e[t];Object.keys(n[i].cues).forEach(e=>{r.removeCue(n[i].cues[e])}),delete n[i]}}const a=t.fragments[t.fragments.length-1];if(0===o.length||!T(null==a?void 0:a.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const s=a.programDateTime/1e3-a.start,l=dn();for(let u=0;u<o.length;u++){const e=o[u],t=i[e],r=mn(t.startDate,s),a=n[e],c=(null==a?void 0:a.cues)||{};let d=(null==a?void 0:a.durationKnown)||!1,f=hn;const h=t.endDate;if(h)f=mn(h,s),d=!0;else if(t.endOnNext&&!d){const e=o.reduce((e,n)=>{if(n!==t.id){const r=i[n];if(r.class===t.class&&r.startDate>t.startDate&&(!e||t.startDate<e.startDate))return r}return e},null);e&&(f=mn(e.startDate,s),d=!0)}const m=Object.keys(t.attr);for(let n=0;n<m.length;n++){const i=m[n];if(!z(i))continue;const o=c[i];if(o)d&&!a.durationKnown&&(o.endTime=f);else if(l){let n=t.attr[i];U(i)&&(n=pn(n));const o=fn(l,r,f,{key:i,data:n},un.dateRange);o&&(o.id=e,this.id3Track.addCue(o),c[i]=o)}}n[e]={cues:c,dateRange:t,durationKnown:d}}}}class vn{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=e,this.config=e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:e,levelDetails:t}=this;return void 0!==e.liveMaxLatencyDuration?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const{levelDetails:e}=this;if(null===e)return null;const{holdBack:t,partHoldBack:n,targetduration:r}=e,{liveSyncDuration:i,liveSyncDurationCount:o,lowLatencyMode:a}=this.config,s=this.hls.userConfig;let l=a&&n||t;(s.liveSyncDuration||s.liveSyncDurationCount||0===l)&&(l=void 0!==i?i:o*r);const u=r,c=1;return l+Math.min(this.stallCount*c,u)}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency,n=this.levelDetails;if(null===e||null===t||null===n)return null;const r=n.edge,i=e-t-this.edgeStalled,o=r-n.totalduration,a=r-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(o,i),a)}get drift(){const{levelDetails:e}=this;return null===e?1:e.drift}get edgeStalled(){const{levelDetails:e}=this;if(null===e)return 0;const t=3*(this.config.lowLatencyMode&&e.partTarget||e.targetduration);return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e,levelDetails:t}=this;if(!e||!t)return 0;const n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(E.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(E.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(E.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(E.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(E.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(E.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(E.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(E.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(E.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(E.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){this.levelDetails=t,t.advanced&&this.timeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(e,t){var n;t.details===A.BUFFER_STALLED_ERROR&&(this.stallCount++,null!=(n=this.levelDetails)&&n.live&&N.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:e,levelDetails:t}=this;if(!e||!t)return;this.currentTime=e.currentTime;const n=this.computeLatency();if(null===n)return;this._latency=n;const{lowLatencyMode:r,maxLiveSyncPlaybackRate:i}=this.config;if(!r||1===i||!t.live)return;const o=this.targetLatency;if(null===o)return;const a=n-o,s=Math.min(this.maxLatency,o+t.targetduration),l=a<s;if(l&&a>.05&&this.forwardBufferLength>1){const t=Math.min(2,Math.max(1,i)),n=Math.round(2/(1+Math.exp(-.75*a-this.edgeStalled))*20)/20;e.playbackRate=Math.min(t,Math.max(1,n))}else 1!==e.playbackRate&&0!==e.playbackRate&&(e.playbackRate=1)}estimateLiveEdge(){const{levelDetails:e}=this;return null===e?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return null===e?null:e-this.currentTime}}const bn=["NONE","TYPE-0","TYPE-1",null];function yn(e){return bn.indexOf(e)>-1}const wn=["SDR","PQ","HLG"];function Sn(e){return!!e&&wn.indexOf(e)>-1}var xn={No:"",Yes:"YES",v2:"v2"};function Cn(e){const{canSkipUntil:t,canSkipDateRanges:n,age:r}=e,i=r<t/2;return t&&i?n?xn.v2:xn.Yes:xn.No}class Tn{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){const t=new self.URL(e);return void 0!==this.msn&&t.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class Dn{constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(e=>!!e).map(e=>e.substring(0,4)).join(","),this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return kn(this._audioGroups,e)}hasSubtitleGroup(e){return kn(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t)if("audio"===e){let e=this._audioGroups;e||(e=this._audioGroups=[]),-1===e.indexOf(t)&&e.push(t)}else if("text"===e){let e=this._subtitleGroups;e||(e=this._subtitleGroups=[]),-1===e.indexOf(t)&&e.push(t)}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return null==(e=this.audioGroups)?void 0:e[0]}get textGroupId(){var e;return null==(e=this.subtitleGroups)?void 0:e[0]}addFallback(){}}function kn(e,t){return!(!t||!e)&&-1!==e.indexOf(t)}function En(e,t){const n=t.startPTS;if(T(n)){let r,i=0;t.sn>e.sn?(i=n-e.start,r=e):(i=e.start-n,r=t),r.duration!==i&&(r.duration=i)}else if(t.sn>e.sn){const n=e.cc===t.cc;n&&e.minEndPTS?t.start=e.start+(e.minEndPTS-e.start):t.start=e.start+e.duration}else t.start=Math.max(e.start-t.duration,0)}function _n(e,t,n,r,i,o){const a=r-n;a<=0&&(N.warn("Fragment should have a positive duration",t),r=n+t.duration,o=i+t.duration);let s=n,l=r;const u=t.startPTS,c=t.endPTS;if(T(u)){const e=Math.abs(u-n);T(t.deltaPTS)?t.deltaPTS=Math.max(e,t.deltaPTS):t.deltaPTS=e,s=Math.max(n,u),n=Math.min(n,u),i=Math.min(i,t.startDTS),l=Math.min(r,c),r=Math.max(r,c),o=Math.max(o,t.endDTS)}const d=n-t.start;0!==t.start&&(t.start=n),t.duration=r-t.start,t.startPTS=n,t.maxStartPTS=s,t.startDTS=i,t.endPTS=r,t.minEndPTS=l,t.endDTS=o;const f=t.sn;if(!e||f<e.startSN||f>e.endSN)return 0;let h;const m=f-e.startSN,p=e.fragments;for(p[m]=t,h=m;h>0;h--)En(p[h],p[h-1]);for(h=m;h<p.length-1;h++)En(p[h],p[h+1]);return e.fragmentHint&&En(p[p.length-1],e.fragmentHint),e.PTSKnown=e.alignedSliding=!0,d}function An(e,t){let n=null;const r=e.fragments;for(let l=r.length-1;l>=0;l--){const e=r[l].initSegment;if(e){n=e;break}}e.fragmentHint&&delete e.fragmentHint.endPTS;let i,o=0;if(Rn(e,t,(e,r)=>{e.relurl&&(o=e.cc-r.cc),T(e.startPTS)&&T(e.endPTS)&&(r.start=r.startPTS=e.startPTS,r.startDTS=e.startDTS,r.maxStartPTS=e.maxStartPTS,r.endPTS=e.endPTS,r.endDTS=e.endDTS,r.minEndPTS=e.minEndPTS,r.duration=e.endPTS-e.startPTS,r.duration&&(i=r),t.PTSKnown=t.alignedSliding=!0),r.elementaryStreams=e.elementaryStreams,r.loader=e.loader,r.stats=e.stats,e.initSegment&&(r.initSegment=e.initSegment,n=e.initSegment)}),n){const e=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments;e.forEach(e=>{var t;!e||e.initSegment&&e.initSegment.relurl!==(null==(t=n)?void 0:t.relurl)||(e.initSegment=n)})}if(t.skippedSegments)if(t.deltaUpdateFailed=t.fragments.some(e=>!e),t.deltaUpdateFailed){N.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let e=t.skippedSegments;e--;)t.fragments.shift();t.startSN=t.fragments[0].sn,t.startCC=t.fragments[0].cc}else t.canSkipDateRanges&&(t.dateRanges=Ln(e.dateRanges,t.dateRanges,t.recentlyRemovedDateranges));const a=t.fragments;if(o){N.warn("discontinuity sliding from playlist, take drift into account");for(let e=0;e<a.length;e++)a[e].cc+=o}t.skippedSegments&&(t.startCC=t.fragments[0].cc),On(e.partList,t.partList,(e,t)=>{t.elementaryStreams=e.elementaryStreams,t.stats=e.stats}),i?_n(t,i,i.startPTS,i.endPTS,i.startDTS,i.endDTS):In(e,t),a.length&&(t.totalduration=t.edge-a[0].start),t.driftStartTime=e.driftStartTime,t.driftStart=e.driftStart;const s=t.advancedDateTime;if(t.advanced&&s){const e=t.edge;t.driftStart||(t.driftStartTime=s,t.driftStart=e),t.driftEndTime=s,t.driftEnd=e}else t.driftEndTime=e.driftEndTime,t.driftEnd=e.driftEnd,t.advancedDateTime=e.advancedDateTime}function Ln(e,t,n){const r=C({},e);return n&&n.forEach(e=>{delete r[e]}),Object.keys(t).forEach(e=>{const n=new V(t[e].attr,r[e]);n.isValid?r[e]=n:N.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(t[e].attr)}"`)}),r}function On(e,t,n){if(e&&t){let r=0;for(let i=0,o=e.length;i<=o;i++){const o=e[i],a=t[i+r];o&&a&&o.index===a.index&&o.fragment.sn===a.fragment.sn?n(o,a):r--}}}function Rn(e,t,n){const r=t.skippedSegments,i=Math.max(e.startSN,t.startSN)-t.startSN,o=(e.fragmentHint?1:0)+(r?t.endSN:Math.min(e.endSN,t.endSN))-t.startSN,a=t.startSN-e.startSN,s=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,l=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments;for(let u=i;u<=o;u++){const e=l[a+u];let i=s[u];r&&!i&&u<r&&(i=t.fragments[u]=e),e&&i&&n(e,i)}}function In(e,t){const n=t.startSN+t.skippedSegments-e.startSN,r=e.fragments;n<0||n>=r.length||Pn(t,r[n].start)}function Pn(e,t){if(t){const n=e.fragments;for(let r=e.skippedSegments;r<n.length;r++)n[r].start+=t;e.fragmentHint&&(e.fragmentHint.start+=t)}}function Mn(e,t=1/0){let n=1e3*e.targetduration;if(e.updated){const r=e.fragments,i=4;if(r.length&&n*i>t){const e=1e3*r[r.length-1].duration;e<n&&(n=e)}}else n/=2;return Math.round(n)}function Nn(e,t,n){if(null==e||!e.details)return null;const r=e.details;let i=r.fragments[t-r.startSN];return i||(i=r.fragmentHint,i&&i.sn===t?i:t<r.startSN&&n&&n.sn===t?n:null)}function Fn(e,t,n){var r;return null!=e&&e.details?Bn(null==(r=e.details)?void 0:r.partList,t,n):null}function Bn(e,t,n){if(e)for(let r=e.length;r--;){const i=e[r];if(i.index===n&&i.fragment.sn===t)return i}return null}function $n(e){e.forEach((e,t)=>{const{details:n}=e;null!=n&&n.fragments&&n.fragments.forEach(e=>{e.level=t})})}function zn(e){switch(e.details){case A.FRAG_LOAD_TIMEOUT:case A.KEY_LOAD_TIMEOUT:case A.LEVEL_LOAD_TIMEOUT:case A.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function Un(e,t){const n=zn(t);return e.default[(n?"timeout":"error")+"Retry"]}function Vn(e,t){const n="linear"===e.backoff?1:Math.pow(2,t);return Math.min(n*e.retryDelayMs,e.maxRetryDelayMs)}function Hn(e){return y(y({},e),{errorRetry:null,timeoutRetry:null})}function jn(e,t,n,r){if(!e)return!1;const i=null==r?void 0:r.code,o=t<e.maxNumRetry&&(qn(i)||!!n);return e.shouldRetry?e.shouldRetry(e,t,n,r,o):o}function qn(e){return 0===e&&!1===navigator.onLine||!!e&&(e<400||e>499)}const Gn={search:function(e,t){let n=0,r=e.length-1,i=null,o=null;while(n<=r){i=(n+r)/2|0,o=e[i];const a=t(o);if(a>0)n=i+1;else{if(!(a<0))return o;r=i-1}}return null}};function Wn(e,t,n){if(null===t||!Array.isArray(e)||!e.length||!T(t))return null;const r=e[0].programDateTime;if(t<(r||0))return null;const i=e[e.length-1].endProgramDateTime;if(t>=(i||0))return null;n=n||0;for(let o=0;o<e.length;++o){const r=e[o];if(Jn(t,n,r))return r}return null}function Kn(e,t,n=0,r=0,i=.005){let o=null;if(e){o=t[e.sn-t[0].sn+1]||null;const r=e.endDTS-n;r>0&&r<15e-7&&(n+=15e-7)}else 0===n&&0===t[0].start&&(o=t[0]);if(o&&((!e||e.level===o.level)&&0===Xn(n,r,o)||Yn(o,e,Math.min(i,r))))return o;const a=Gn.search(t,Xn.bind(null,n,r));return!a||a===e&&o?o:a}function Yn(e,t,n){if(t&&0===t.start&&t.level<e.level&&(t.endPTS||0)>0){const r=t.tagList.reduce((e,t)=>("INF"===t[0]&&(e+=parseFloat(t[1])),e),n);return e.start<=r}return!1}function Xn(e=0,t=0,n){if(n.start<=e&&n.start+n.duration>e)return 0;const r=Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0));return n.start+n.duration-r<=e?1:n.start-r>e&&n.start?-1:0}function Jn(e,t,n){const r=1e3*Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0)),i=n.endProgramDateTime||0;return i-r>e}function Qn(e,t){return Gn.search(e,e=>e.cc<t?1:e.cc>t?-1:0)}var Zn={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},er={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,SwitchToSDR:4};class tr{constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=N.log.bind(N,"[info]:"),this.warn=N.warn.bind(N,"[warning]:"),this.error=N.error.bind(N,"[error]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(E.ERROR,this.onError,this),e.on(E.MANIFEST_LOADING,this.onManifestLoading,this),e.on(E.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(E.ERROR,this.onError,this),e.off(E.ERROR,this.onErrorOut,this),e.off(E.MANIFEST_LOADING,this.onManifestLoading,this),e.off(E.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(null==e?void 0:e.type)===Jt.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var n,r;if(t.fatal)return;const i=this.hls,o=t.context;switch(t.details){case A.FRAG_LOAD_ERROR:case A.FRAG_LOAD_TIMEOUT:case A.KEY_LOAD_ERROR:case A.KEY_LOAD_TIMEOUT:return void(t.errorAction=this.getFragRetryOrSwitchAction(t));case A.FRAG_PARSING_ERROR:if(null!=(n=t.frag)&&n.gap)return void(t.errorAction={action:Zn.DoNothing,flags:er.None});case A.FRAG_GAP:case A.FRAG_DECRYPT_ERROR:return t.errorAction=this.getFragRetryOrSwitchAction(t),void(t.errorAction.action=Zn.SendAlternateToPenaltyBox);case A.LEVEL_EMPTY_ERROR:case A.LEVEL_PARSING_ERROR:{var a,s;const e=t.parent===Jt.MAIN?t.level:i.loadLevel;t.details===A.LEVEL_EMPTY_ERROR&&null!=(a=t.context)&&null!=(s=a.levelDetails)&&s.live?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,e):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,e))}return;case A.LEVEL_LOAD_ERROR:case A.LEVEL_LOAD_TIMEOUT:return void("number"===typeof(null==o?void 0:o.level)&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,o.level)));case A.AUDIO_TRACK_LOAD_ERROR:case A.AUDIO_TRACK_LOAD_TIMEOUT:case A.SUBTITLE_LOAD_ERROR:case A.SUBTITLE_TRACK_LOAD_TIMEOUT:if(o){const e=i.levels[i.loadLevel];if(e&&(o.type===Xt.AUDIO_TRACK&&e.hasAudioGroup(o.groupId)||o.type===Xt.SUBTITLE_TRACK&&e.hasSubtitleGroup(o.groupId)))return t.errorAction=this.getPlaylistRetryOrSwitchAction(t,i.loadLevel),t.errorAction.action=Zn.SendAlternateToPenaltyBox,void(t.errorAction.flags=er.MoveAllAlternatesMatchingHost)}return;case A.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const e=i.levels[i.loadLevel],n=null==e?void 0:e.attrs["HDCP-LEVEL"];n?t.errorAction={action:Zn.SendAlternateToPenaltyBox,flags:er.MoveAllAlternatesMatchingHDCP,hdcpLevel:n}:this.keySystemError(t)}return;case A.BUFFER_ADD_CODEC_ERROR:case A.REMUX_ALLOC_ERROR:case A.BUFFER_APPEND_ERROR:return void(t.errorAction=this.getLevelSwitchAction(t,null!=(r=t.level)?r:i.loadLevel));case A.INTERNAL_EXCEPTION:case A.BUFFER_APPENDING_ERROR:case A.BUFFER_FULL_ERROR:case A.LEVEL_SWITCH_ERROR:case A.BUFFER_STALLED_ERROR:case A.BUFFER_SEEK_OVER_HOLE:case A.BUFFER_NUDGE_ON_STALL:return void(t.errorAction={action:Zn.DoNothing,flags:er.None})}t.type===_.KEY_SYSTEM_ERROR&&this.keySystemError(t)}keySystemError(e){const t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)}getPlaylistRetryOrSwitchAction(e,t){const n=this.hls,r=Un(n.config.playlistLoadPolicy,e),i=this.playlistError++,o=jn(r,i,zn(e),e.response);if(o)return{action:Zn.RetryRequest,flags:er.None,retryConfig:r,retryCount:i};const a=this.getLevelSwitchAction(e,t);return r&&(a.retryConfig=r,a.retryCount=i),a}getFragRetryOrSwitchAction(e){const t=this.hls,n=this.getVariantLevelIndex(e.frag),r=t.levels[n],{fragLoadPolicy:i,keyLoadPolicy:o}=t.config,a=Un(e.details.startsWith("key")?o:i,e),s=t.levels.reduce((e,t)=>e+t.fragmentError,0);if(r){e.details!==A.FRAG_GAP&&r.fragmentError++;const t=jn(a,s,zn(e),e.response);if(t)return{action:Zn.RetryRequest,flags:er.None,retryConfig:a,retryCount:s}}const l=this.getLevelSwitchAction(e,n);return a&&(l.retryConfig=a,l.retryCount=s),l}getLevelSwitchAction(e,t){const n=this.hls;null!==t&&void 0!==t||(t=n.loadLevel);const r=this.hls.levels[t];if(r){var i,o;const t=e.details;r.loadError++,t===A.BUFFER_APPEND_ERROR&&r.fragmentError++;let l=-1;const{levels:u,loadLevel:c,minAutoLevel:d,maxAutoLevel:f}=n;n.autoLevelEnabled||(n.loadLevel=-1);const h=null==(i=e.frag)?void 0:i.type,m=h===Jt.AUDIO&&t===A.FRAG_PARSING_ERROR||"audio"===e.sourceBufferName&&(t===A.BUFFER_ADD_CODEC_ERROR||t===A.BUFFER_APPEND_ERROR),p=m&&u.some(({audioCodec:e})=>r.audioCodec!==e),g="video"===e.sourceBufferName&&(t===A.BUFFER_ADD_CODEC_ERROR||t===A.BUFFER_APPEND_ERROR),v=g&&u.some(({codecSet:e,audioCodec:t})=>r.codecSet!==e&&r.audioCodec===t),{type:b,groupId:y}=null!=(o=e.context)?o:{};for(let n=u.length;n--;){const i=(n+c)%u.length;if(i!==c&&i>=d&&i<=f&&0===u[i].loadError){var a,s;const n=u[i];if(t===A.FRAG_GAP&&h===Jt.MAIN&&e.frag){const t=u[i].details;if(t){const n=Kn(e.frag,t.fragments,e.frag.start);if(null!=n&&n.gap)continue}}else{if(b===Xt.AUDIO_TRACK&&n.hasAudioGroup(y)||b===Xt.SUBTITLE_TRACK&&n.hasSubtitleGroup(y))continue;if(h===Jt.AUDIO&&null!=(a=r.audioGroups)&&a.some(e=>n.hasAudioGroup(e))||h===Jt.SUBTITLE&&null!=(s=r.subtitleGroups)&&s.some(e=>n.hasSubtitleGroup(e))||p&&r.audioCodec===n.audioCodec||!p&&r.audioCodec!==n.audioCodec||v&&r.codecSet===n.codecSet)continue}l=i;break}}if(l>-1&&n.loadLevel!==l)return e.levelRetry=!0,this.playlistError=0,{action:Zn.SendAlternateToPenaltyBox,flags:er.None,nextAutoLevel:l}}return{action:Zn.SendAlternateToPenaltyBox,flags:er.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var n;switch(null==(n=t.errorAction)?void 0:n.action){case Zn.DoNothing:break;case Zn.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),t.errorAction.resolved||t.details===A.FRAG_GAP?/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError()):t.fatal=!0;break;case Zn.RetryRequest:break}t.fatal&&this.hls.stopLoad()}sendAlternateToPenaltyBox(e){const t=this.hls,n=e.errorAction;if(!n)return;const{flags:r,hdcpLevel:i,nextAutoLevel:o}=n;switch(r){case er.None:this.switchLevel(e,o);break;case er.MoveAllAlternatesMatchingHDCP:i&&(t.maxHdcpLevel=bn[bn.indexOf(i)-1],n.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}n.resolved||this.switchLevel(e,o)}switchLevel(e,t){void 0!==t&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}}class nr{constructor(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=N.log.bind(N,t+":"),this.warn=N.warn.bind(N,t+":"),this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){-1!==this.timer&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,n){const r=null==t?void 0:t.renditionReports;if(r){let o=-1;for(let n=0;n<r.length;n++){const a=r[n];let s;try{s=new self.URL(a.URI,t.url).href}catch(i){N.warn("Could not construct new URL for Rendition Report: "+i),s=a.URI||""}if(s===e){o=n;break}s===e.substring(0,s.length)&&(o=n)}if(-1!==o){const e=r[o],i=parseInt(e["LAST-MSN"])||(null==t?void 0:t.lastPartSn);let a=parseInt(e["LAST-PART"])||(null==t?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const e=Math.min(t.age-t.partTarget,t.targetduration);a>=0&&e>t.partTarget&&(a+=1)}const s=n&&Cn(n);return new Tn(i,a>=0?a:void 0,s)}}}loadPlaylist(e){-1===this.requestScheduled&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return-1===this.timer&&-1===this.requestScheduled&&this.shouldLoadPlaylist(e)}playlistLoaded(e,t,n){const{details:r,stats:i}=t,o=self.performance.now(),a=i.loading.first?Math.max(0,o-i.loading.first):0;if(r.advancedDateTime=Date.now()-a,r.live||null!=n&&n.live){if(r.reloaded(n),n&&this.log(`live playlist ${e} ${r.advanced?"REFRESHED "+r.lastPartSn+"-"+r.lastPartIndex:r.updated?"UPDATED":"MISSED"}`),n&&r.fragments.length>0&&An(n,r),!this.canLoad||!r.live)return;let a,s=void 0,l=void 0;if(r.canBlockReload&&r.endSN&&r.advanced){const e=this.hls.config.lowLatencyMode,i=r.lastPartSn,o=r.endSN,u=r.lastPartIndex,c=-1!==u,d=i===o,f=e?0:u;c?(s=d?o+1:i,l=d?f:u+1):s=o+1;const h=r.age,m=h+r.ageHeader;let p=Math.min(m-r.partTarget,1.5*r.targetduration);if(p>0){if(n&&p>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${p} with playlist age: ${r.age}`),p=0;else{const e=Math.floor(p/r.targetduration);if(s+=e,void 0!==l){const e=Math.round(p%r.targetduration/r.partTarget);l+=e}this.log(`CDN Tune-in age: ${r.ageHeader}s last advanced ${h.toFixed(2)}s goal: ${p} skip sn ${e} to part ${l}`)}r.tuneInGoal=p}if(a=this.getDeliveryDirectives(r,t.deliveryDirectives,s,l),e||!d)return void this.loadPlaylist(a)}else(r.canBlockReload||r.canSkipUntil)&&(a=this.getDeliveryDirectives(r,t.deliveryDirectives,s,l));const u=this.hls.mainForwardBufferInfo,c=u?u.end-u.len:0,d=1e3*(r.edge-c),f=Mn(r,d);r.updated&&o>this.requestScheduled+f&&(this.requestScheduled=i.loading.start),void 0!==s&&r.canBlockReload?this.requestScheduled=i.loading.first+f-(1e3*r.partTarget||1e3):-1===this.requestScheduled||this.requestScheduled+f<o?this.requestScheduled=o:this.requestScheduled-o<=0&&(this.requestScheduled+=f);let h=this.requestScheduled-o;h=Math.max(0,h),this.log(`reload live playlist ${e} in ${Math.round(h)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(a),h)}else this.clearTimer()}getDeliveryDirectives(e,t,n,r){let i=Cn(e);return null!=t&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,r=t.part,i=xn.No),new Tn(n,r,i)}checkRetry(e){const t=e.details,n=zn(e),r=e.errorAction,{action:i,retryCount:o=0,retryConfig:a}=r||{},s=!!r&&!!a&&(i===Zn.RetryRequest||!r.resolved&&i===Zn.SendAlternateToPenaltyBox);if(s){var l;if(this.requestScheduled=-1,o>=a.maxNumRetry)return!1;if(n&&null!=(l=e.context)&&l.deliveryDirectives)this.warn(`Retrying playlist loading ${o+1}/${a.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const e=Vn(a,o);this.timer=self.setTimeout(()=>this.loadPlaylist(),e),this.warn(`Retrying playlist loading ${o+1}/${a.maxNumRetry} after "${t}" in ${e}ms`)}e.levelRetry=!0,r.resolved=!0}return s}}class rr{constructor(e,t=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){const n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class ir{constructor(e,t,n,r=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new rr(e),this.fast_=new rr(t),this.defaultTTFB_=r,this.ttfb_=new rr(e)}update(e,t){const{slow_:n,fast_:r,ttfb_:i}=this;n.halfLife!==e&&(this.slow_=new rr(e,n.getEstimate(),n.getTotalWeight())),r.halfLife!==t&&(this.fast_=new rr(t,r.getEstimate(),r.getTotalWeight())),i.halfLife!==e&&(this.ttfb_=new rr(e,i.getEstimate(),i.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const n=8*t,r=e/1e3,i=n/r;this.fast_.sample(r,i),this.slow_.sample(r,i)}sampleTTFB(e){const t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}const or={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]},ar={};function sr(e,t,n,r,i,o){const a=e.audioCodec?e.audioGroups:null,s=null==o?void 0:o.audioCodec,l=null==o?void 0:o.channels,u=l?parseInt(l):s?1/0:2;let c=null;if(null!=a&&a.length)try{c=1===a.length&&a[0]?t.groups[a[0]].channels:a.reduce((e,n)=>{if(n){const r=t.groups[n];if(!r)throw new Error(`Audio track group ${n} not found`);Object.keys(r.channels).forEach(t=>{e[t]=(e[t]||0)+r.channels[t]})}return e},{2:0})}catch(d){return!0}return void 0!==e.videoCodec&&(e.width>1920&&e.height>1088||e.height>1920&&e.width>1088||e.frameRate>Math.max(r,30)||"SDR"!==e.videoRange&&e.videoRange!==n||e.bitrate>Math.max(i,8e6))||!!c&&T(u)&&Object.keys(c).some(e=>parseInt(e)>u)}function lr(e,t,n){const r=e.videoCodec,i=e.audioCodec;if(!r||!i||!n)return Promise.resolve(or);const o={width:e.width,height:e.height,bitrate:Math.ceil(Math.max(.9*e.bitrate,e.averageBitrate)),framerate:e.frameRate||30},a=e.videoRange;"SDR"!==a&&(o.transferFunction=a.toLowerCase());const s=r.split(",").map(e=>({type:"media-source",video:y(y({},o),{},{contentType:Et(e,"video")})}));return i&&e.audioGroups&&e.audioGroups.forEach(e=>{var n;e&&(null==(n=t.groups[e])||n.tracks.forEach(t=>{if(t.groupId===e){const e=t.channels||"",n=parseFloat(e);T(n)&&n>2&&s.push.apply(s,i.split(",").map(e=>({type:"media-source",audio:{contentType:Et(e,"audio"),channels:""+n}})))}}))}),Promise.all(s.map(e=>{const t=ur(e);return ar[t]||(ar[t]=n.decodingInfo(e))})).then(e=>({supported:!e.some(e=>!e.supported),configurations:s,decodingInfoResults:e})).catch(e=>({supported:!1,configurations:s,decodingInfoResults:[],error:e}))}function ur(e){const{audio:t,video:n}=e,r=n||t;if(r){const e=r.contentType.split('"')[1];if(n)return`r${n.height}x${n.width}f${Math.ceil(n.framerate)}${n.transferFunction||"sd"}_${e}_${Math.ceil(n.bitrate/1e5)}`;if(t)return`c${t.channels}${t.spatialRendering?"s":"n"}_${e}`}return""}function cr(){if("function"===typeof matchMedia){const e=matchMedia("(dynamic-range: high)"),t=matchMedia("bad query");if(e.media!==t.media)return!0===e.matches}return!1}function dr(e,t){let n=!1,r=[];return e&&(n="SDR"!==e,r=[e]),t&&(r=t.allowedVideoRanges||wn.slice(0),n=void 0!==t.preferHDR?t.preferHDR:cr(),r=n?r.filter(e=>"SDR"!==e):["SDR"]),{preferHDR:n,allowedVideoRanges:r}}function fr(e,t,n,r,i){const o=Object.keys(e),a=null==r?void 0:r.channels,s=null==r?void 0:r.audioCodec,l=a&&2===parseInt(a);let u=!0,c=!1,d=1/0,f=1/0,h=1/0,m=0,p=[];const{preferHDR:g,allowedVideoRanges:v}=dr(t,i);for(let S=o.length;S--;){const t=e[o[S]];u=t.channels[2]>0,d=Math.min(d,t.minHeight),f=Math.min(f,t.minFramerate),h=Math.min(h,t.minBitrate);const n=v.filter(e=>t.videoRanges[e]>0);n.length>0&&(c=!0,p=n)}d=T(d)?d:0,f=T(f)?f:0;const b=Math.max(1080,d),y=Math.max(30,f);h=T(h)?h:n,n=Math.max(h,n),c||(t=void 0,p=[]);const w=o.reduce((t,r)=>{const i=e[r];if(r===t)return t;if(i.minBitrate>n)return hr(r,`min bitrate of ${i.minBitrate} > current estimate of ${n}`),t;if(!i.hasDefaultAudio)return hr(r,"no renditions with default or auto-select sound found"),t;if(s&&r.indexOf(s.substring(0,4))%5!==0)return hr(r,`audio codec preference "${s}" not found`),t;if(a&&!l){if(!i.channels[a])return hr(r,`no renditions with ${a} channel sound found (channels options: ${Object.keys(i.channels)})`),t}else if((!s||l)&&u&&0===i.channels["2"])return hr(r,"no renditions with stereo sound found"),t;return i.minHeight>b?(hr(r,`min resolution of ${i.minHeight} > maximum of ${b}`),t):i.minFramerate>y?(hr(r,`min framerate of ${i.minFramerate} > maximum of ${y}`),t):p.some(e=>i.videoRanges[e]>0)?i.maxScore<m?(hr(r,`max score of ${i.maxScore} < selected max of ${m}`),t):t&&(At(r)>=At(t)||i.fragmentError>e[t].fragmentError)?t:(m=i.maxScore,r):(hr(r,`no variants with VIDEO-RANGE of ${JSON.stringify(p)} found`),t)},void 0);return{codecSet:w,videoRanges:p,preferHDR:g,minFramerate:f,minBitrate:h}}function hr(e,t){N.log(`[abr] start candidates with "${e}" ignored because ${t}`)}function mr(e){return e.reduce((e,t)=>{let n=e.groups[t.groupId];n||(n=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),n.tracks.push(t);const r=t.channels||"2";return n.channels[r]=(n.channels[r]||0)+1,n.hasDefault=n.hasDefault||t.default,n.hasAutoSelect=n.hasAutoSelect||t.autoselect,n.hasDefault&&(e.hasDefaultAudio=!0),n.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function pr(e,t,n,r){return e.slice(n,r+1).reduce((e,n)=>{if(!n.codecSet)return e;const r=n.audioGroups;let i=e[n.codecSet];i||(e[n.codecSet]=i={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!r,fragmentError:0}),i.minBitrate=Math.min(i.minBitrate,n.bitrate);const o=Math.min(n.height,n.width);return i.minHeight=Math.min(i.minHeight,o),i.minFramerate=Math.min(i.minFramerate,n.frameRate),i.maxScore=Math.max(i.maxScore,n.score),i.fragmentError+=n.fragmentError,i.videoRanges[n.videoRange]=(i.videoRanges[n.videoRange]||0)+1,r&&r.forEach(e=>{if(!e)return;const n=t.groups[e];n&&(i.hasDefaultAudio=i.hasDefaultAudio||t.hasDefaultAudio?n.hasDefault:n.hasAutoSelect||!t.hasDefaultAudio&&!t.hasAutoSelectAudio,Object.keys(n.channels).forEach(e=>{i.channels[e]=(i.channels[e]||0)+n.channels[e]}))}),e},{})}function gr(e,t,n){if("attrs"in e){const n=t.indexOf(e);if(-1!==n)return n}for(let r=0;r<t.length;r++){const i=t[r];if(vr(e,i,n))return r}return-1}function vr(e,t,n){const{groupId:r,name:i,lang:o,assocLang:a,characteristics:s,default:l}=e,u=e.forced;return(void 0===r||t.groupId===r)&&(void 0===i||t.name===i)&&(void 0===o||t.lang===o)&&(void 0===o||t.assocLang===a)&&(void 0===l||t.default===l)&&(void 0===u||t.forced===u)&&(void 0===s||br(s,t.characteristics))&&(void 0===n||n(e,t))}function br(e,t=""){const n=e.split(","),r=t.split(",");return n.length===r.length&&!n.some(e=>-1===r.indexOf(e))}function yr(e,t){const{audioCodec:n,channels:r}=e;return(void 0===n||(t.audioCodec||"").substring(0,4)===n.substring(0,4))&&(void 0===r||r===(t.channels||"2"))}function wr(e,t,n,r,i){const o=t[r],a=t.reduce((e,t,n)=>{const r=t.uri,i=e[r]||(e[r]=[]);return i.push(n),e},{}),s=a[o.uri];s.length>1&&(r=Math.max.apply(Math,s));const l=o.videoRange,u=o.frameRate,c=o.codecSet.substring(0,4),d=Sr(t,r,t=>{if(t.videoRange!==l||t.frameRate!==u||t.codecSet.substring(0,4)!==c)return!1;const r=t.audioGroups,o=n.filter(e=>!r||-1!==r.indexOf(e.groupId));return gr(e,o,i)>-1});return d>-1?d:Sr(t,r,t=>{const r=t.audioGroups,o=n.filter(e=>!r||-1!==r.indexOf(e.groupId));return gr(e,o,i)>-1})}function Sr(e,t,n){for(let r=t;r;r--)if(n(e[r]))return r;for(let r=t+1;r<e.length;r++)if(n(e[r]))return r;return-1}class xr{constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this._abandonRulesCheck=()=>{const{fragCurrent:e,partCurrent:t,hls:n}=this,{autoLevelEnabled:r,media:i}=n;if(!e||!i)return;const o=performance.now(),a=t?t.stats:e.stats,s=t?t.duration:e.duration,l=o-a.loading.start,u=n.minAutoLevel;if(a.aborted||a.loaded&&a.loaded===a.total||e.level<=u)return this.clearTimer(),void(this._nextAutoLevel=-1);if(!r||i.paused||!i.playbackRate||!i.readyState)return;const c=n.mainForwardBufferInfo;if(null===c)return;const d=this.bwEstimator.getEstimateTTFB(),f=Math.abs(i.playbackRate);if(l<=Math.max(d,s/(2*f)*1e3))return;const h=c.len/f,m=a.loading.first?a.loading.first-a.loading.start:-1,p=a.loaded&&m>-1,g=this.getBwEstimate(),v=n.levels,b=v[e.level],y=a.total||Math.max(a.loaded,Math.round(s*b.averageBitrate/8));let w=p?l-m:l;w<1&&p&&(w=Math.min(l,8*a.loaded/g));const S=p?1e3*a.loaded/w:0,x=S?(y-a.loaded)/S:8*y/g+d/1e3;if(x<=h)return;const C=S?8*S:g;let D,k=Number.POSITIVE_INFINITY;for(D=e.level-1;D>u;D--){const e=v[D].maxBitrate;if(k=this.getTimeToLoadFrag(d/1e3,C,s*e,!v[D].details),k<h)break}if(k>=x)return;if(k>10*s)return;n.nextLoadLevel=n.nextAutoLevel=D,p?this.bwEstimator.sample(l-Math.min(d,m),a.loaded):this.bwEstimator.sampleTTFB(l);const _=v[D].maxBitrate;this.getBwEstimate()*this.hls.config.abrBandWidthUpFactor>_&&this.resetEstimator(_),this.clearTimer(),N.warn(`[abr] Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} is loading too slowly;\n      Time to underbuffer: ${h.toFixed(3)} s\n      Estimated load time for current fragment: ${x.toFixed(3)} s\n      Estimated load time for down switch fragment: ${k.toFixed(3)} s\n      TTFB estimate: ${0|m} ms\n      Current BW estimate: ${T(g)?0|g:"Unknown"} bps\n      New BW estimate: ${0|this.getBwEstimate()} bps\n      Switching to level ${D} @ ${0|_} bps`),n.trigger(E.FRAG_LOAD_EMERGENCY_ABORTED,{frag:e,part:t,stats:a})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(N.log("setting initial bwe to "+e),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new ir(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(E.MANIFEST_LOADING,this.onManifestLoading,this),e.on(E.FRAG_LOADING,this.onFragLoading,this),e.on(E.FRAG_LOADED,this.onFragLoaded,this),e.on(E.FRAG_BUFFERED,this.onFragBuffered,this),e.on(E.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(E.LEVEL_LOADED,this.onLevelLoaded,this),e.on(E.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(E.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(E.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(E.MANIFEST_LOADING,this.onManifestLoading,this),e.off(E.FRAG_LOADING,this.onFragLoading,this),e.off(E.FRAG_LOADED,this.onFragLoaded,this),e.off(E.FRAG_BUFFERED,this.onFragBuffered,this),e.off(E.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(E.LEVEL_LOADED,this.onLevelLoaded,this),e.off(E.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(E.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(E.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const n=t.frag;if(!this.ignoreFragment(n)){var r;if(!n.bitrateTest)this.fragCurrent=n,this.partCurrent=null!=(r=t.part)?r:null;this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case A.BUFFER_ADD_CODEC_ERROR:case A.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case A.FRAG_LOAD_TIMEOUT:{const e=t.frag,{fragCurrent:n,partCurrent:r}=this;if(e&&n&&e.sn===n.sn&&e.level===n.level){const t=performance.now(),n=r?r.stats:e.stats,i=t-n.loading.start,o=n.loading.first?n.loading.first-n.loading.start:-1,a=n.loaded&&o>-1;if(a){const e=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(i-Math.min(e,o),n.loaded)}else this.bwEstimator.sampleTTFB(i)}break}}}getTimeToLoadFrag(e,t,n,r){const i=e+n/t,o=r?this.lastLevelLoadSec:0;return i+o}onLevelLoaded(e,t){const n=this.hls.config,{loading:r}=t.stats,i=r.end-r.start;T(i)&&(this.lastLevelLoadSec=i/1e3),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD)}onFragLoaded(e,{frag:t,part:n}){const r=n?n.stats:t.stats;if(t.type===Jt.MAIN&&this.bwEstimator.sampleTTFB(r.loading.first-r.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const e=n?n.duration:t.duration,i=this.hls.levels[t.level],o=(i.loaded?i.loaded.bytes:0)+r.loaded,a=(i.loaded?i.loaded.duration:0)+e;i.loaded={bytes:o,duration:a},i.realBitrate=Math.round(8*o/a)}if(t.bitrateTest){const e={stats:r,frag:t,part:n,id:t.type};this.onFragBuffered(E.FRAG_BUFFERED,e),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:n,part:r}=t,i=null!=r&&r.stats.loaded?r.stats:n.stats;if(i.aborted)return;if(this.ignoreFragment(n))return;const o=i.parsing.end-i.loading.start-Math.min(i.loading.first-i.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(o,i.loaded),i.bwEstimate=this.getBwEstimate(),n.bitrateTest?this.bitrateTestDelay=o/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==Jt.MAIN||"initSegment"===e.sn}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,n=this.getBwEstimate(),r=this.hls.config.maxStarvationDelay,i=this.findBestLevel(n,t,e,0,r,1,1);if(i>-1)return i;const o=this.hls.firstLevel,a=Math.min(Math.max(o,t),e);return N.warn(`[abr] Could not find best starting auto level. Defaulting to first in playlist ${o} clamped to ${a}`),a}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,t=this.bwEstimator,n=t.canEstimate(),r=this.lastLoadedFragLevel>-1;if(-1!==e&&(!n||!r||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const i=n&&r?this.getNextABRAutoLevel():this.firstAutoLevel;if(-1!==e){const t=this.hls.levels;if(t.length>Math.max(e,i)&&t[e].loadError<=t[i].loadError)return e}return this._nextAutoLevel=i,this.nextAutoLevelKey=this.getAutoLevelKey(),i}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:n}=this,{maxAutoLevel:r,config:i,minAutoLevel:o}=n,a=t?t.duration:e?e.duration:0,s=this.getBwEstimate(),l=this.getStarvationDelay();let u=i.abrBandWidthFactor,c=i.abrBandWidthUpFactor;if(l){const e=this.findBestLevel(s,o,r,l,0,u,c);if(e>=0)return e}let d=a?Math.min(a,i.maxStarvationDelay):i.maxStarvationDelay;if(!l){const e=this.bitrateTestDelay;if(e){const t=a?Math.min(a,i.maxLoadingDelay):i.maxLoadingDelay;d=t-e,N.info(`[abr] bitrate test took ${Math.round(1e3*e)}ms, set first fragment max fetchDuration to ${Math.round(1e3*d)} ms`),u=c=1}}const f=this.findBestLevel(s,o,r,l,d,u,c);if(N.info(`[abr] ${l?"rebuffering expected":"buffer is empty"}, optimal quality level ${f}`),f>-1)return f;const h=n.levels[o],m=n.levels[n.loadLevel];return(null==h?void 0:h.bitrate)<(null==m?void 0:m.bitrate)?o:n.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const n=t&&0!==t.playbackRate?Math.abs(t.playbackRate):1,r=e.mainForwardBufferInfo;return(r?r.len:0)/n}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,n,r,i,o,a){var s;const l=r+i,u=this.lastLoadedFragLevel,c=-1===u?this.hls.firstLevel:u,{fragCurrent:d,partCurrent:f}=this,{levels:h,allAudioTracks:m,loadLevel:p,config:g}=this.hls;if(1===h.length)return 0;const v=h[c],b=!(null==v||null==(s=v.details)||!s.live),y=-1===p||-1===u;let w,S="SDR",x=(null==v?void 0:v.frameRate)||0;const{audioPreference:C,videoPreference:D}=g,k=this.audioTracksByGroup||(this.audioTracksByGroup=mr(m));if(y){if(-1!==this.firstSelection)return this.firstSelection;const r=this.codecTiers||(this.codecTiers=pr(h,k,t,n)),i=fr(r,S,e,C,D),{codecSet:o,videoRanges:a,minFramerate:s,minBitrate:l,preferHDR:u}=i;w=o,S=u?a[a.length-1]:a[0],x=s,e=Math.max(e,l),N.log("[abr] picked start tier "+JSON.stringify(i))}else w=null==v?void 0:v.codecSet,S=null==v?void 0:v.videoRange;const E=f?f.duration:d?d.duration:0,_=this.bwEstimator.getEstimateTTFB()/1e3,A=[];for(let O=n;O>=t;O--){var L;const t=h[O],s=O>c;if(!t)continue;if(g.useMediaCapabilities&&!t.supportedResult&&!t.supportedPromise){const n=navigator.mediaCapabilities;"function"===typeof(null==n?void 0:n.decodingInfo)&&sr(t,k,S,x,e,C)?(t.supportedPromise=lr(t,k,n),t.supportedPromise.then(e=>{if(!this.hls)return;t.supportedResult=e;const n=this.hls.levels,r=n.indexOf(t);e.error?N.warn(`[abr] MediaCapabilities decodingInfo error: "${e.error}" for level ${r} ${JSON.stringify(e)}`):e.supported||(N.warn(`[abr] Unsupported MediaCapabilities decodingInfo result for level ${r} ${JSON.stringify(e)}`),r>-1&&n.length>1&&(N.log("[abr] Removing unsupported level "+r),this.hls.removeLevel(r)))})):t.supportedResult=or}if(w&&t.codecSet!==w||S&&t.videoRange!==S||s&&x>t.frameRate||!s&&x>0&&x<t.frameRate||t.supportedResult&&(null==(L=t.supportedResult.decodingInfoResults)||!L[0].smooth)){A.push(O);continue}const d=t.details,m=(f?null==d?void 0:d.partTarget:null==d?void 0:d.averagetargetduration)||E;let D;D=s?a*e:o*e;const R=E&&r>=2*E&&0===i?h[O].averageBitrate:h[O].maxBitrate,I=this.getTimeToLoadFrag(_,D,R*m,void 0===d),P=D>=R&&(O===u||0===t.loadError&&0===t.fragmentError)&&(I<=_||!T(I)||b&&!this.bitrateTestDelay||I<l);if(P){const e=this.forcedAutoLevel;return O===p||-1!==e&&e===p||(A.length&&N.trace(`[abr] Skipped level(s) ${A.join(",")} of ${n} max with CODECS and VIDEO-RANGE:"${h[A[0]].codecs}" ${h[A[0]].videoRange}; not compatible with "${v.codecs}" ${S}`),N.info(`[abr] switch candidate:${c}->${O} adjustedbw(${Math.round(D)})-bitrate=${Math.round(D-R)} ttfb:${_.toFixed(1)} avgDuration:${m.toFixed(1)} maxFetchDuration:${l.toFixed(1)} fetchDuration:${I.toFixed(1)} firstSelection:${y} codecSet:${w} videoRange:${S} hls.loadLevel:${p}`)),y&&(this.firstSelection=O),O}}return-1}set nextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:n}=this.hls,r=Math.min(Math.max(e,n),t);this._nextAutoLevel!==r&&(this.nextAutoLevelKey="",this._nextAutoLevel=r)}}class Cr{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)}clearNextTick(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)}tick(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}var Tr={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class Dr{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(E.BUFFER_APPENDED,this.onBufferAppended,this),e.on(E.FRAG_BUFFERED,this.onFragBuffered,this),e.on(E.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(E.BUFFER_APPENDED,this.onBufferAppended,this),e.off(E.FRAG_BUFFERED,this.onFragBuffered,this),e.off(E.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const n=this.activePartLists[t];if(n)for(let r=n.length;r--;){const t=n[r];if(!t)break;const i=t.end;if(t.start<=e&&null!==i&&e<=i)return t}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){const{fragments:n}=this,r=Object.keys(n);for(let i=r.length;i--;){const o=n[r[i]];if((null==o?void 0:o.body.type)===t&&o.buffered){const t=o.body;if(t.start<=e&&e<=t.end)return t}}return null}detectEvictedFragments(e,t,n,r){this.timeRanges&&(this.timeRanges[e]=t);const i=(null==r?void 0:r.fragment.sn)||-1;Object.keys(this.fragments).forEach(r=>{const o=this.fragments[r];if(!o)return;if(i>=o.body.sn)return;if(!o.buffered&&!o.loaded)return void(o.body.type===n&&this.removeFragment(o.body));const a=o.range[e];a&&a.time.some(e=>{const n=!this.isTimeBuffered(e.startPTS,e.endPTS,t);return n&&this.removeFragment(o.body),n})})}detectPartialFragments(e){const t=this.timeRanges,{frag:n,part:r}=e;if(!t||"initSegment"===n.sn)return;const i=Er(n),o=this.fragments[i];if(!o||o.buffered&&n.gap)return;const a=!n.relurl;if(Object.keys(t).forEach(e=>{const i=n.elementaryStreams[e];if(!i)return;const s=t[e],l=a||!0===i.partial;o.range[e]=this.getBufferedTimes(n,r,l,s)}),o.loaded=null,Object.keys(o.range).length){o.buffered=!0;const e=o.body.endList=n.endList||o.body.endList;e&&(this.endListFragments[o.body.type]=o),kr(o)||this.removeParts(n.sn-1,n.type)}else this.removeFragment(o.body)}removeParts(e,t){const n=this.activePartLists[t];n&&(this.activePartLists[t]=n.filter(t=>t.fragment.sn>=e))}fragBuffered(e,t){const n=Er(e);let r=this.fragments[n];!r&&t&&(r=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),r&&(r.loaded=null,r.buffered=!0)}getBufferedTimes(e,t,n,r){const i={time:[],partial:n},o=e.start,a=e.end,s=e.minEndPTS||a,l=e.maxStartPTS||o;for(let u=0;u<r.length;u++){const e=r.start(u)-this.bufferPadding,t=r.end(u)+this.bufferPadding;if(l>=e&&s<=t){i.time.push({startPTS:Math.max(o,r.start(u)),endPTS:Math.min(a,r.end(u))});break}if(o<t&&a>e){const e=Math.max(o,r.start(u)),t=Math.min(a,r.end(u));t>e&&(i.partial=!0,i.time.push({startPTS:e,endPTS:t}))}else if(a<=e)break}return i}getPartialFragment(e){let t,n,r,i=null,o=0;const{bufferPadding:a,fragments:s}=this;return Object.keys(s).forEach(l=>{const u=s[l];u&&kr(u)&&(n=u.body.start-a,r=u.body.end+a,e>=n&&e<=r&&(t=Math.min(e-n,r-e),o<=t&&(i=u.body,o=t)))}),i}isEndListAppended(e){const t=this.endListFragments[e];return void 0!==t&&(t.buffered||kr(t))}getState(e){const t=Er(e),n=this.fragments[t];return n?n.buffered?kr(n)?Tr.PARTIAL:Tr.OK:Tr.APPENDING:Tr.NOT_LOADED}isTimeBuffered(e,t,n){let r,i;for(let o=0;o<n.length;o++){if(r=n.start(o)-this.bufferPadding,i=n.end(o)+this.bufferPadding,e>=r&&t<=i)return!0;if(t<=r)return!1}return!1}onFragLoaded(e,t){const{frag:n,part:r}=t;if("initSegment"===n.sn||n.bitrateTest)return;const i=r?null:t,o=Er(n);this.fragments[o]={body:n,appendedPTS:null,loaded:i,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:n,part:r,timeRanges:i}=t;if("initSegment"===n.sn)return;const o=n.type;if(r){let e=this.activePartLists[o];e||(this.activePartLists[o]=e=[]),e.push(r)}this.timeRanges=i,Object.keys(i).forEach(e=>{const t=i[e];this.detectEvictedFragments(e,t,o,r)})}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=Er(e);return!!this.fragments[t]}hasParts(e){var t;return!(null==(t=this.activePartLists[e])||!t.length)}removeFragmentsInRange(e,t,n,r,i){r&&!this.hasGaps||Object.keys(this.fragments).forEach(o=>{const a=this.fragments[o];if(!a)return;const s=a.body;s.type!==n||r&&!s.gap||s.start<t&&s.end>e&&(a.buffered||i)&&this.removeFragment(s)})}removeFragment(e){const t=Er(e);e.stats.loaded=0,e.clearElementaryStreamInfo();const n=this.activePartLists[e.type];if(n){const t=e.sn;this.activePartLists[e.type]=n.filter(e=>e.fragment.sn!==t)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function kr(e){var t,n,r;return e.buffered&&(e.body.gap||(null==(t=e.range.video)?void 0:t.partial)||(null==(n=e.range.audio)?void 0:n.partial)||(null==(r=e.range.audiovideo)?void 0:r.partial))}function Er(e){return`${e.type}_${e.level}_${e.sn}`}const _r={length:0,start:()=>0,end:()=>0};class Ar{static isBuffered(e,t){try{if(e){const n=Ar.getBuffered(e);for(let e=0;e<n.length;e++)if(t>=n.start(e)&&t<=n.end(e))return!0}}catch(n){}return!1}static bufferInfo(e,t,n){try{if(e){const r=Ar.getBuffered(e),i=[];let o;for(o=0;o<r.length;o++)i.push({start:r.start(o),end:r.end(o)});return this.bufferedInfo(i,t,n)}}catch(r){}return{len:0,start:t,end:t,nextStart:void 0}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.sort((function(e,t){const n=e.start-t.start;return n||t.end-e.end}));let r=[];if(n)for(let l=0;l<e.length;l++){const t=r.length;if(t){const i=r[t-1].end;e[l].start-i<n?e[l].end>i&&(r[t-1].end=e[l].end):r.push(e[l])}else r.push(e[l])}else r=e;let i,o=0,a=t,s=t;for(let l=0;l<r.length;l++){const e=r[l].start,u=r[l].end;if(t+n>=e&&t<u)a=e,s=u,o=s-t;else if(t+n<e){i=e;break}}return{len:o,start:a||0,end:s||0,nextStart:i}}static getBuffered(e){try{return e.buffered}catch(t){return N.log("failed to get media.buffered",t),_r}}}class Lr{constructor(e,t,n,r=0,i=-1,o=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=Or(),this.buffering={audio:Or(),video:Or(),audiovideo:Or()},this.level=e,this.sn=t,this.id=n,this.size=r,this.part=i,this.partial=o}}function Or(){return{start:0,executeStart:0,executeEnd:0,end:0}}function Rr(e,t){for(let r=0,i=e.length;r<i;r++){var n;if((null==(n=e[r])?void 0:n.cc)===t)return e[r]}return null}function Ir(e,t,n){return!(!t||!(n.endCC>n.startCC||e&&e.cc<n.startCC))}function Pr(e,t){const n=e.fragments,r=t.fragments;if(!r.length||!n.length)return void N.log("No fragments to align");const i=Rr(n,r[0].cc);if(i&&(!i||i.startPTS))return i;N.log("No frag in previous level to align on")}function Mr(e,t){if(e){const n=e.start+t;e.start=e.startPTS=n,e.endPTS=n+e.duration}}function Nr(e,t){const n=t.fragments;for(let r=0,i=n.length;r<i;r++)Mr(n[r],e);t.fragmentHint&&Mr(t.fragmentHint,e),t.alignedSliding=!0}function Fr(e,t,n){t&&(Br(e,n,t),!n.alignedSliding&&t&&$r(n,t),n.alignedSliding||!t||n.skippedSegments||In(t,n))}function Br(e,t,n){if(Ir(e,n,t)){const e=Pr(n,t);e&&T(e.start)&&(N.log("Adjusting PTS using last level due to CC increase within current level "+t.url),Nr(e.start,t))}}function $r(e,t){if(!e.hasProgramDateTime||!t.hasProgramDateTime)return;const n=e.fragments,r=t.fragments;if(!n.length||!r.length)return;let i,o;const a=Math.min(t.endCC,e.endCC);t.startCC<a&&e.startCC<a&&(i=Rr(r,a),o=Rr(n,a)),i&&o||(i=r[Math.floor(r.length/2)],o=Rr(n,i.cc)||n[Math.floor(n.length/2)]);const s=i.programDateTime,l=o.programDateTime;if(!s||!l)return;const u=(l-s)/1e3-(o.start-i.start);Nr(u,e)}const zr=Math.pow(2,17);class Ur{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const n=e.url;if(!n)return Promise.reject(new jr({type:_.NETWORK_ERROR,details:A.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error("Fragment does not have a "+(n?"part list":"url")),networkDetails:null}));this.abort();const r=this.config,i=r.fLoader,o=r.loader;return new Promise((a,s)=>{if(this.loader&&this.loader.destroy(),e.gap){if(e.tagList.some(e=>"GAP"===e[0]))return void s(Hr(e));e.gap=!1}const l=this.loader=e.loader=i?new i(r):new o(r),u=Vr(e),c=Hn(r.fragLoadPolicy.default),d={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===e.sn?1/0:zr};e.stats=l.stats,l.load(u,d,{onSuccess:(t,n,r,i)=>{this.resetLoader(e,l);let o=t.data;r.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(o.slice(0,16)),o=o.slice(16)),a({frag:e,part:null,payload:o,networkDetails:i})},onError:(t,r,i,o)=>{this.resetLoader(e,l),s(new jr({type:_.NETWORK_ERROR,details:A.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:y({url:n,data:void 0},t),error:new Error(`HTTP Error ${t.code} ${t.text}`),networkDetails:i,stats:o}))},onAbort:(t,n,r)=>{this.resetLoader(e,l),s(new jr({type:_.NETWORK_ERROR,details:A.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:r,stats:t}))},onTimeout:(t,n,r)=>{this.resetLoader(e,l),s(new jr({type:_.NETWORK_ERROR,details:A.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${d.timeout}ms`),networkDetails:r,stats:t}))},onProgress:(n,r,i,o)=>{t&&t({frag:e,part:null,payload:i,networkDetails:o})}})})}loadPart(e,t,n){this.abort();const r=this.config,i=r.fLoader,o=r.loader;return new Promise((a,s)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap)return void s(Hr(e,t));const l=this.loader=e.loader=i?new i(r):new o(r),u=Vr(e,t),c=Hn(r.fragLoadPolicy.default),d={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:zr};t.stats=l.stats,l.load(u,d,{onSuccess:(r,i,o,s)=>{this.resetLoader(e,l),this.updateStatsFromPart(e,t);const u={frag:e,part:t,payload:r.data,networkDetails:s};n(u),a(u)},onError:(n,r,i,o)=>{this.resetLoader(e,l),s(new jr({type:_.NETWORK_ERROR,details:A.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:y({url:u.url,data:void 0},n),error:new Error(`HTTP Error ${n.code} ${n.text}`),networkDetails:i,stats:o}))},onAbort:(n,r,i)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,l),s(new jr({type:_.NETWORK_ERROR,details:A.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:i,stats:n}))},onTimeout:(n,r,i)=>{this.resetLoader(e,l),s(new jr({type:_.NETWORK_ERROR,details:A.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${d.timeout}ms`),networkDetails:i,stats:n}))}})})}updateStatsFromPart(e,t){const n=e.stats,r=t.stats,i=r.total;if(n.loaded+=r.loaded,i){const r=Math.round(e.duration/t.duration),o=Math.min(Math.round(n.loaded/i),r),a=r-o,s=a*Math.round(n.loaded/o);n.total=n.loaded+s}else n.total=Math.max(n.loaded,n.total);const o=n.loading,a=r.loading;o.start?o.first+=a.first-a.start:(o.start=a.start,o.first=a.first),o.end=a.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function Vr(e,t=null){const n=t||e,r={frag:e,part:t,responseType:"arraybuffer",url:n.url,headers:{},rangeStart:0,rangeEnd:0},i=n.byteRangeStartOffset,o=n.byteRangeEndOffset;if(T(i)&&T(o)){var a;let t=i,n=o;if("initSegment"===e.sn&&"AES-128"===(null==(a=e.decryptdata)?void 0:a.method)){const e=o-i;e%16&&(n=o+(16-e%16)),0!==i&&(r.resetIV=!0,t=i-16)}r.rangeStart=t,r.rangeEnd=n}return r}function Hr(e,t){const n=new Error(`GAP ${e.gap?"tag":"attribute"} found`),r={type:_.MEDIA_ERROR,details:A.FRAG_GAP,fatal:!1,frag:e,error:n,networkDetails:null};return t&&(r.part=t),(t||e).stats.aborted=!0,new jr(r)}class jr extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class qr{constructor(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}decrypt(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}class Gr{constructor(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}function Wr(e){const t=e.byteLength,n=t&&new DataView(e.buffer).getUint8(t-1);return n?fe(e,0,t-n):e}class Kr{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),n=new Uint32Array(4);for(let r=0;r<4;r++)n[r]=t.getUint32(4*r);return n}initTable(){const e=this.sBox,t=this.invSBox,n=this.subMix,r=n[0],i=n[1],o=n[2],a=n[3],s=this.invSubMix,l=s[0],u=s[1],c=s[2],d=s[3],f=new Uint32Array(256);let h=0,m=0,p=0;for(p=0;p<256;p++)f[p]=p<128?p<<1:p<<1^283;for(p=0;p<256;p++){let n=m^m<<1^m<<2^m<<3^m<<4;n=n>>>8^255&n^99,e[h]=n,t[n]=h;const s=f[h],p=f[s],g=f[p];let v=257*f[n]^16843008*n;r[h]=v<<24|v>>>8,i[h]=v<<16|v>>>16,o[h]=v<<8|v>>>24,a[h]=v,v=16843009*g^65537*p^257*s^16843008*h,l[n]=v<<24|v>>>8,u[n]=v<<16|v>>>16,c[n]=v<<8|v>>>24,d[n]=v,h?(h=s^f[f[f[g^s]]],m^=f[f[m]]):h=m=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let n=!0,r=0;while(r<t.length&&n)n=t[r]===this.key[r],r++;if(n)return;this.key=t;const i=this.keySize=t.length;if(4!==i&&6!==i&&8!==i)throw new Error("Invalid aes key size="+i);const o=this.ksRows=4*(i+6+1);let a,s;const l=this.keySchedule=new Uint32Array(o),u=this.invKeySchedule=new Uint32Array(o),c=this.sBox,d=this.rcon,f=this.invSubMix,h=f[0],m=f[1],p=f[2],g=f[3];let v,b;for(a=0;a<o;a++)a<i?v=l[a]=t[a]:(b=v,a%i===0?(b=b<<8|b>>>24,b=c[b>>>24]<<24|c[b>>>16&255]<<16|c[b>>>8&255]<<8|c[255&b],b^=d[a/i|0]<<24):i>6&&a%i===4&&(b=c[b>>>24]<<24|c[b>>>16&255]<<16|c[b>>>8&255]<<8|c[255&b]),l[a]=v=(l[a-i]^b)>>>0);for(s=0;s<o;s++)a=o-s,b=3&s?l[a]:l[a-4],u[s]=s<4||a<=4?b:h[c[b>>>24]]^m[c[b>>>16&255]]^p[c[b>>>8&255]]^g[c[255&b]],u[s]=u[s]>>>0}networkToHostOrderSwap(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}decrypt(e,t,n){const r=this.keySize+6,i=this.invKeySchedule,o=this.invSBox,a=this.invSubMix,s=a[0],l=a[1],u=a[2],c=a[3],d=this.uint8ArrayToUint32Array_(n);let f=d[0],h=d[1],m=d[2],p=d[3];const g=new Int32Array(e),v=new Int32Array(g.length);let b,y,w,S,x,C,T,D,k,E,_,A,L,O;const R=this.networkToHostOrderSwap;while(t<g.length){for(k=R(g[t]),E=R(g[t+1]),_=R(g[t+2]),A=R(g[t+3]),x=k^i[0],C=A^i[1],T=_^i[2],D=E^i[3],L=4,O=1;O<r;O++)b=s[x>>>24]^l[C>>16&255]^u[T>>8&255]^c[255&D]^i[L],y=s[C>>>24]^l[T>>16&255]^u[D>>8&255]^c[255&x]^i[L+1],w=s[T>>>24]^l[D>>16&255]^u[x>>8&255]^c[255&C]^i[L+2],S=s[D>>>24]^l[x>>16&255]^u[C>>8&255]^c[255&T]^i[L+3],x=b,C=y,T=w,D=S,L+=4;b=o[x>>>24]<<24^o[C>>16&255]<<16^o[T>>8&255]<<8^o[255&D]^i[L],y=o[C>>>24]<<24^o[T>>16&255]<<16^o[D>>8&255]<<8^o[255&x]^i[L+1],w=o[T>>>24]<<24^o[D>>16&255]<<16^o[x>>8&255]<<8^o[255&C]^i[L+2],S=o[D>>>24]<<24^o[x>>16&255]<<16^o[C>>8&255]<<8^o[255&T]^i[L+3],v[t]=R(b^f),v[t+1]=R(S^h),v[t+2]=R(w^m),v[t+3]=R(y^p),f=k,h=E,m=_,p=A,t+=4}return v.buffer}}const Yr=16;class Xr{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const e=self.crypto;e&&(this.subtle=e.subtle||e.webkitSubtle)}catch(n){}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?Wr(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n){return this.useSoftware?new Promise((r,i)=>{this.softwareDecrypt(new Uint8Array(e),t,n);const o=this.flush();o?r(o.buffer):i(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,n)}softwareDecrypt(e,t,n){const{currentIV:r,currentResult:i,remainderData:o}=this;this.logOnce("JS AES decrypt"),o&&(e=tt(o,e),this.remainderData=null);const a=this.getValidChunk(e);if(!a.length)return null;r&&(n=r);let s=this.softwareDecrypter;s||(s=this.softwareDecrypter=new Kr),s.expandKey(t);const l=i;return this.currentResult=s.decrypt(a.buffer,0,n),this.currentIV=fe(a,-16).buffer,l||null}webCryptoDecrypt(e,t,n){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,n));this.key=t,this.fastAesKey=new Gr(this.subtle,t)}return this.fastAesKey.expandKey().then(t=>{if(!this.subtle)return Promise.reject(new Error("web crypto not initialized"));this.logOnce("WebCrypto AES decrypt");const r=new qr(this.subtle,new Uint8Array(n));return r.decrypt(e.buffer,t)}).catch(r=>(N.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${r.name}: ${r.message}`),this.onWebCryptoError(e,t,n)))}onWebCryptoError(e,t,n){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n);const r=this.flush();if(r)return r.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(e){let t=e;const n=e.length-e.length%Yr;return n!==e.length&&(t=fe(e,0,n),this.remainderData=fe(e,n)),t}logOnce(e){this.logEnabled&&(N.log("[decrypter]: "+e),this.logEnabled=!1)}}const Jr={toString:function(e){let t="";const n=e.length;for(let r=0;r<n;r++)t+=`[${e.start(r).toFixed(3)}-${e.end(r).toFixed(3)}]`;return t}},Qr={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Zr extends Cr{constructor(e,t,n,r,i){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=Qr.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=i,this.logPrefix=r,this.log=N.log.bind(N,r+":"),this.warn=N.warn.bind(N,r+":"),this.hls=e,this.fragmentLoader=new Ur(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new Xr(e.config),e.on(E.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;null!=e&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=Qr.STOPPED}_streamEnded(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;const n=t.partList;if(null!=n&&n.length){const e=n[n.length-1],t=Ar.isBuffered(this.media,e.start+e.duration/2);return t}const r=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(r)}getLevelDetails(){var e;if(this.levels&&null!==this.levelLastLoaded)return null==(e=this.levelLastLoaded)?void 0:e.details}onMediaAttached(e,t){const n=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),n.addEventListener("seeking",this.onvseeking),n.addEventListener("ended",this.onvended);const r=this.config;this.levels&&r.autoStartLoad&&this.state===Qr.STOPPED&&this.startLoad(r.startPosition)}onMediaDetaching(){const e=this.media;null!=e&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:e,fragCurrent:t,media:n,mediaBuffer:r,state:i}=this,o=n?n.currentTime:0,a=Ar.bufferInfo(r||n,o,e.maxBufferHole);if(this.log(`media seeking to ${T(o)?o.toFixed(3):o}, state: ${i}`),this.state===Qr.ENDED)this.resetLoadingState();else if(t){const n=e.maxFragLookUpTolerance,r=t.start-n,i=t.start+t.duration+n;if(!a.len||i<a.start||r>a.end){const e=o>i;(o<r||e)&&(e&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}n&&(this.fragmentTracker.removeFragmentsInRange(o,1/0,this.playlistType,!0),this.lastCurrentTime=o),this.loadedmetadata||a.len||(this.nextLoadPosition=this.startPosition=o),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.hls.off(E.MANIFEST_LOADED,this.onManifestLoaded,this),this.stopLoad(),super.onHandlerDestroying(),this.hls=null}onHandlerDestroyed(){this.state=Qr.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){const r=t=>{if(this.fragContextChanged(e))return this.warn(`Fragment ${e.sn}${t.part?" p: "+t.part.index:""} of level ${e.level} was dropped during download.`),void this.fragmentTracker.removeFragment(e);e.stats.chunkCount++,this._handleFragmentLoadProgress(t)};this._doFragLoad(e,t,n,r).then(t=>{if(!t)return;const n=this.state;this.fragContextChanged(e)?(n===Qr.FRAG_LOADING||!this.fragCurrent&&n===Qr.PARSING)&&(this.fragmentTracker.removeFragment(e),this.state=Qr.IDLE):("payload"in t&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(E.FRAG_LOADED,t)),this._handleFragmentLoadComplete(t))}).catch(t=>{this.state!==Qr.STOPPED&&this.state!==Qr.ERROR&&(this.warn("Frag error: "+((null==t?void 0:t.message)||t)),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:n}=this,r=n.getState(e);if(r===Tr.APPENDING){const t=e.type,r=this.getFwdBufferInfo(this.mediaBuffer,t),i=Math.max(e.duration,r?r.len:this.config.maxBufferLength),o=this.backtrackFragment,a=o?e.sn-o.sn:0;(1===a||this.reduceMaxBufferLength(i,e.duration))&&n.removeFragment(e)}else 0===(null==(t=this.mediaBuffer)?void 0:t.buffered.length)?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===Tr.PARTIAL&&n.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}flushMainBuffer(e,t,n=null){if(!(e-t))return;const r={startOffset:e,endOffset:t,type:n};this.hls.trigger(E.BUFFER_FLUSHING,r)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(t=>{if(!t||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return t}).then(t=>{const{hls:n}=this,{payload:r}=t,i=e.decryptdata;if(r&&r.byteLength>0&&null!=i&&i.key&&i.iv&&"AES-128"===i.method){const o=self.performance.now();return this.decrypter.decrypt(new Uint8Array(r),i.key.buffer,i.iv.buffer).catch(t=>{throw n.trigger(E.ERROR,{type:_.MEDIA_ERROR,details:A.FRAG_DECRYPT_ERROR,fatal:!1,error:t,reason:t.message,frag:e}),t}).then(r=>{const i=self.performance.now();return n.trigger(E.FRAG_DECRYPTED,{frag:e,payload:r,stats:{tstart:o,tdecrypt:i}}),t.payload=r,this.completeInitSegmentLoad(t)})}return this.completeInitSegmentLoad(t)}).catch(t=>{this.state!==Qr.STOPPED&&this.state!==Qr.ERROR&&(this.warn(t),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const n=e.frag.stats;this.state=Qr.IDLE,e.frag.data=new Uint8Array(e.payload),n.parsing.start=n.buffering.start=self.performance.now(),n.parsing.end=n.buffering.end=self.performance.now(),this.tick()}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){var n,r,i,o;const a=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.playlistType===Jt.MAIN?"level":"track"} ${e.level} (frag:[${(null!=(n=e.startPTS)?n:NaN).toFixed(3)}-${(null!=(r=e.endPTS)?r:NaN).toFixed(3)}] > buffer:${a?Jr.toString(Ar.getBuffered(a)):"(detached)"})`),"initSegment"!==e.sn){var s;if(e.type!==Jt.SUBTITLE){const t=e.elementaryStreams;if(!Object.keys(t).some(e=>!!t[e]))return void(this.state=Qr.IDLE)}const t=null==(s=this.levels)?void 0:s[e.level];null!=t&&t.fragmentError&&(this.log(`Resetting level fragment error count of ${t.fragmentError} on frag buffered`),t.fragmentError=0)}this.state=Qr.IDLE,a&&(!this.loadedmetadata&&e.type==Jt.MAIN&&a.buffered.length&&(null==(i=this.fragCurrent)?void 0:i.sn)===(null==(o=this.fragPrevious)?void 0:o.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:n,part:r,partsLoaded:i}=e,o=!i||0===i.length||i.some(e=>!e),a=new Lr(n.level,n.sn,n.stats.chunkCount+1,0,r?r.index:-1,!o);t.flush(a)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,n=null,r){var i;const o=null==t?void 0:t.details;if(!this.levels||!o)throw new Error(`frag load aborted, missing level${o?"":" detail"}s`);let a=null;if(!e.encrypted||null!=(i=e.decryptdata)&&i.key?!e.encrypted&&o.encryptedFragments.length&&this.keyLoader.loadClear(e,o.encryptedFragments):(this.log(`Loading key for ${e.sn} of [${o.startSN}-${o.endSN}], ${"[stream-controller]"===this.logPrefix?"level":"track"} ${e.level}`),this.state=Qr.KEY_LOADING,this.fragCurrent=e,a=this.keyLoader.load(e).then(e=>{if(!this.fragContextChanged(e.frag))return this.hls.trigger(E.KEY_LOADED,e),this.state===Qr.KEY_LOADING&&(this.state=Qr.IDLE),e}),this.hls.trigger(E.KEY_LOADING,{frag:e}),null===this.fragCurrent&&(a=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))),n=Math.max(e.start,n||0),this.config.lowLatencyMode&&"initSegment"!==e.sn){const i=o.partList;if(i&&r){n>e.end&&o.fragmentHint&&(e=o.fragmentHint);const s=this.getNextPart(i,e,n);if(s>-1){const l=i[s];let u;return this.log(`Loading part sn: ${e.sn} p: ${l.index} cc: ${e.cc} of playlist [${o.startSN}-${o.endSN}] parts [0-${s}-${i.length-1}] ${"[stream-controller]"===this.logPrefix?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=l.start+l.duration,this.state=Qr.FRAG_LOADING,u=a?a.then(n=>!n||this.fragContextChanged(n.frag)?null:this.doFragPartsLoad(e,l,t,r)).catch(e=>this.handleFragLoadError(e)):this.doFragPartsLoad(e,l,t,r).catch(e=>this.handleFragLoadError(e)),this.hls.trigger(E.FRAG_LOADING,{frag:e,part:l,targetBufferTime:n}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):u}if(!e.url||this.loadedEndOfParts(i,n))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${o?"of ["+o.startSN+"-"+o.endSN+"] ":""}${"[stream-controller]"===this.logPrefix?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),T(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=Qr.FRAG_LOADING;const s=this.config.progressive;let l;return l=s&&a?a.then(t=>!t||this.fragContextChanged(null==t?void 0:t.frag)?null:this.fragmentLoader.load(e,r)).catch(e=>this.handleFragLoadError(e)):Promise.all([this.fragmentLoader.load(e,s?r:void 0),a]).then(([e])=>(!s&&e&&r&&r(e),e)).catch(e=>this.handleFragLoadError(e)),this.hls.trigger(E.FRAG_LOADING,{frag:e,targetBufferTime:n}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):l}doFragPartsLoad(e,t,n,r){return new Promise((i,o)=>{var a;const s=[],l=null==(a=n.details)?void 0:a.partList,u=t=>{this.fragmentLoader.loadPart(e,t,r).then(r=>{s[t.index]=r;const o=r.part;this.hls.trigger(E.FRAG_LOADED,r);const a=Fn(n,e.sn,t.index+1)||Bn(l,e.sn,t.index+1);if(!a)return i({frag:e,part:o,partsLoaded:s});u(a)}).catch(o)};u(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===A.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(E.ERROR,t)}else this.hls.trigger(E.ERROR,{type:_.OTHER_ERROR,details:A.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==Qr.PARSING)return void(this.fragCurrent||this.state===Qr.STOPPED||this.state===Qr.ERROR||(this.state=Qr.IDLE));const{frag:n,part:r,level:i}=t,o=self.performance.now();n.stats.parsing.end=o,r&&(r.stats.parsing.end=o),this.updateLevelTiming(n,r,i,e.partial)}getCurrentContext(e){const{levels:t,fragCurrent:n}=this,{level:r,sn:i,part:o}=e;if(null==t||!t[r])return this.warn(`Levels object was unset while buffering fragment ${i} of level ${r}. The current chunk will not be buffered.`),null;const a=t[r],s=o>-1?Fn(a,i,o):null,l=s?s.fragment:Nn(a,i,n);return l?(n&&n!==l&&(l.stats=n.stats),{frag:l,part:s,level:a}):null}bufferFragmentData(e,t,n,r,i){var o;if(!e||this.state!==Qr.PARSING)return;const{data1:a,data2:s}=e;let l=a;if(a&&s&&(l=tt(a,s)),null==(o=l)||!o.length)return;const u={type:e.type,frag:t,part:n,chunkMeta:r,parent:t.type,data:l};if(this.hls.trigger(E.BUFFER_APPENDING,u),e.dropped&&e.independent&&!n){if(i)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!Ar.isBuffered(t,t.currentTime))return void this.flushMainBuffer(0,e.start);const n=t.currentTime,r=Ar.bufferInfo(t,n,0),i=e.duration,o=Math.min(2*this.config.maxFragLookUpTolerance,.25*i),a=Math.max(Math.min(e.start-o,r.end-o),n+o);e.start-a>o&&this.flushMainBuffer(a,e.start)}getFwdBufferInfo(e,t){const n=this.getLoadPosition();return T(n)?this.getFwdBufferInfoAtPos(e,n,t):null}getFwdBufferInfoAtPos(e,t,n){const{config:{maxBufferHole:r}}=this,i=Ar.bufferInfo(e,t,r);if(0===i.len&&void 0!==i.nextStart){const o=this.fragmentTracker.getBufferedFrag(t,n);if(o&&i.nextStart<o.end)return Ar.bufferInfo(e,t,Math.max(i.nextStart,r))}return i}getMaxBufferLength(e){const{config:t}=this;let n;return n=e?Math.max(8*t.maxBufferSize/e,t.maxBufferLength):t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const n=this.config,r=Math.max(Math.min(e-t,n.maxBufferLength),t),i=Math.max(e-3*t,n.maxMaxBufferLength/2,r);return i>=r&&(n.maxMaxBufferLength=i,this.warn(`Reduce max buffer length to ${i}s`),!0)}getAppendedFrag(e,t=Jt.MAIN){const n=this.fragmentTracker.getAppendedFrag(e,Jt.MAIN);return n&&"fragment"in n?n.fragment:n}getNextFragment(e,t){const n=t.fragments,r=n.length;if(!r)return null;const{config:i}=this,o=n[0].start;let a;if(t.live){const s=i.initialLiveManifestSize;if(r<s)return this.warn(`Not enough fragments to start playback (have: ${r}, need: ${s})`),null;(!t.PTSKnown&&!this.startFragRequested&&-1===this.startPosition||e<o)&&(a=this.getInitialLiveFragment(t,n),this.startPosition=this.nextLoadPosition=a?this.hls.liveSyncPosition||a.start:e)}else e<=o&&(a=n[0]);if(!a){const n=i.lowLatencyMode?t.partEnd:t.fragmentEnd;a=this.getFragmentAtPosition(e,n,t)}return this.mapToInitFragWhenRequired(a)}isLoopLoading(e,t){const n=this.fragmentTracker.getState(e);return(n===Tr.OK||n===Tr.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,r,i){const o=e.gap,a=this.getNextFragment(this.nextLoadPosition,t);if(null===a)return a;if(e=a,o&&e&&!e.gap&&n.nextStart){const t=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,r);if(null!==t&&n.len+t.len>=i)return this.log(`buffer full after gaps in "${r}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return null==e||!e.initSegment||null!=e&&e.initSegment.data||this.bitrateTest?e:e.initSegment}getNextPart(e,t,n){let r=-1,i=!1,o=!0;for(let a=0,s=e.length;a<s;a++){const s=e[a];if(o=o&&!s.independent,r>-1&&n<s.start)break;const l=s.loaded;l?r=-1:(i||s.independent||o)&&s.fragment===t&&(r=a),i=l}return r}loadedEndOfParts(e,t){const n=e[e.length-1];return n&&t>n.start&&n.loaded}getInitialLiveFragment(e,t){const n=this.fragPrevious;let r=null;if(n){if(e.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+n.programDateTime),r=Wn(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!r){const i=n.sn+1;if(i>=e.startSN&&i<=e.endSN){const o=t[i-e.startSN];n.cc===o.cc&&(r=o,this.log("Live playlist, switching playlist, load frag with next SN: "+r.sn))}r||(r=Qn(t,n.cc),r&&this.log("Live playlist, switching playlist, load frag with same CC: "+r.sn))}}else{const t=this.hls.liveSyncPosition;null!==t&&(r=this.getFragmentAtPosition(t,this.bitrateTest?e.fragmentEnd:e.edge,e))}return r}getFragmentAtPosition(e,t,n){const{config:r}=this;let{fragPrevious:i}=this,{fragments:o,endSN:a}=n;const{fragmentHint:s}=n,{maxFragLookUpTolerance:l}=r,u=n.partList,c=!!(r.lowLatencyMode&&null!=u&&u.length&&s);let d;if(c&&s&&!this.bitrateTest&&(o=o.concat(s),a=s.sn),e<t){const n=e>t-l?0:l;d=Kn(i,o,e,n)}else d=o[o.length-1];if(d){const e=d.sn-n.startSN,t=this.fragmentTracker.getState(d);if((t===Tr.OK||t===Tr.PARTIAL&&d.gap)&&(i=d),i&&d.sn===i.sn&&(!c||u[0].fragment.sn>d.sn)){const t=i&&d.level===i.level;if(t){const t=o[e+1];d=d.sn<a&&this.fragmentTracker.getState(t)!==Tr.OK?t:null}}}return d}synchronizeToLiveEdge(e){const{config:t,media:n}=this;if(!n)return;const r=this.hls.liveSyncPosition,i=n.currentTime,o=e.fragments[0].start,a=e.edge,s=i>=o-t.maxFragLookUpTolerance&&i<=a;if(null!==r&&n.duration>r&&(i<r||!s)){const o=void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!s&&n.readyState<4||i<a-o)&&(this.loadedmetadata||(this.nextLoadPosition=r),n.readyState&&(this.warn(`Playback: ${i.toFixed(3)} is located too far from the end of live sliding playlist: ${a}, reset currentTime to : ${r.toFixed(3)}`),n.currentTime=r))}}alignPlaylists(e,t,n){const r=e.fragments.length;if(!r)return this.warn("No fragments in live playlist"),0;const i=e.fragments[0].start,o=!t,a=e.alignedSliding&&T(i);if(o||!a&&!i){const{fragPrevious:i}=this;Fr(i,n,e);const o=e.fragments[0].start;return this.log(`Live playlist sliding: ${o.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} prev-sn: ${i?i.sn:"na"} fragments: ${r}`),o}return i}waitForCdnTuneIn(e){const t=3;return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*t)}setStartPosition(e,t){let n=this.startPosition;if(n<t&&(n=-1),-1===n||-1===this.lastCurrentTime){const r=null!==this.startTimeOffset,i=r?this.startTimeOffset:e.startTimeOffset;null!==i&&T(i)?(n=t+i,i<0&&(n+=e.totalduration),n=Math.min(Math.max(t,n),t+e.totalduration),this.log(`Start time offset ${i} found in ${r?"multivariant":"media"} playlist, adjust startPosition to ${n}`),this.startPosition=n):e.live?n=this.hls.liveSyncPosition||t:this.startPosition=n=0,this.lastCurrentTime=n}this.nextLoadPosition=n}getLoadPosition(){const{media:e}=this;let t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}handleFragLoadAborted(e,t){this.transmuxer&&"initSegment"!==e.sn&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){this.fragCurrent&&(this.fragContextChanged(e)||this.state===Qr.FRAG_LOADING_WAITING_RETRY)||(this.state=Qr.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const e=this.getCurrentContext(t.chunkMeta);e&&(t.frag=e.frag)}const n=t.frag;if(!n||n.type!==e||!this.levels)return;var r;if(this.fragContextChanged(n))return void this.warn(`Frag load error must match current frag to retry ${n.url} > ${null==(r=this.fragCurrent)?void 0:r.url}`);const i=t.details===A.FRAG_GAP;i&&this.fragmentTracker.fragBuffered(n,!0);const o=t.errorAction,{action:a,retryCount:s=0,retryConfig:l}=o||{};if(o&&a===Zn.RetryRequest&&l){this.resetStartWhenNotLoaded(this.levelLastLoaded);const r=Vn(l,s);this.warn(`Fragment ${n.sn} of ${e} ${n.level} errored with ${t.details}, retrying loading ${s+1}/${l.maxNumRetry} in ${r}ms`),o.resolved=!0,this.retryDate=self.performance.now()+r,this.state=Qr.FRAG_LOADING_WAITING_RETRY}else if(l&&o){if(this.resetFragmentErrors(e),!(s<l.maxNumRetry))return void N.warn(`${t.details} reached or exceeded max retry (${s})`);i||a===Zn.RemoveAlternatePermanently||(o.resolved=!0)}else(null==o?void 0:o.action)===Zn.SendAlternateToPenaltyBox?this.state=Qr.WAITING_LEVEL:this.state=Qr.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===Qr.PARSING||this.state===Qr.PARSED){const t=e.frag,n=e.parent,r=this.getFwdBufferInfo(this.mediaBuffer,n),i=r&&r.len>.5;i&&this.reduceMaxBufferLength(r.len,(null==t?void 0:t.duration)||10);const o=!i;return o&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${n} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),o}return!1}resetFragmentErrors(e){e===Jt.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==Qr.STOPPED&&(this.state=Qr.IDLE)}afterBufferFlushed(e,t,n){if(!e)return;const r=Ar.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,r,n),this.state===Qr.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=Qr.IDLE}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;const t=e?e.details:null;null!=t&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,r){var i;const o=n.details;if(!o)return void this.warn("level.details undefined");const a=Object.keys(e.elementaryStreams).reduce((t,i)=>{const a=e.elementaryStreams[i];if(a){const s=a.endPTS-a.startPTS;if(s<=0)return this.warn(`Could not parse fragment ${e.sn} ${i} duration reliably (${s})`),t||!1;const l=r?0:_n(o,e,a.startPTS,a.endPTS,a.startDTS,a.endDTS);return this.hls.trigger(E.LEVEL_PTS_UPDATED,{details:o,level:n,drift:l,type:i,frag:e,start:a.startPTS,end:a.endPTS}),!0}return t},!1);if(!a&&null===(null==(i=this.transmuxer)?void 0:i.error)){const t=new Error(`Found no media in fragment ${e.sn} of level ${e.level} resetting transmuxer to fallback to playlist timing`);if(0===n.fragmentError&&(n.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)),this.warn(t.message),this.hls.trigger(E.ERROR,{type:_.MEDIA_ERROR,details:A.FRAG_PARSING_ERROR,fatal:!1,error:t,frag:e,reason:`Found no media in msn ${e.sn} of level "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=Qr.PARSED,this.hls.trigger(E.FRAG_PARSED,{frag:e,part:t})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){"demuxerWorker"===e.event&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}class ei{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let n;return e.length?(n=1===e.length?e[0]:ti(e,t),this.reset(),n):new Uint8Array(0)}reset(){this.chunks.length=0,this.dataLength=0}}function ti(e,t){const n=new Uint8Array(t);let r=0;for(let i=0;i<e.length;i++){const t=e[i];n.set(t,r),r+=t.length}return n}function ni(){return"function"===typeof __HLS_WORKER_BUNDLE__}function ri(){const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e),n=new self.Worker(t);return{worker:n,objectURL:t}}function ii(e){const t=new self.URL(e,self.location.href).href,n=new self.Worker(t);return{worker:n,scriptURL:t}}function oi(e="",t=9e4){return{type:e,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}class ai{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,r){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=tt(this.cachedData,e),this.cachedData=null);let n,r=pe(e,0),i=r?r.length:0;const o=this._audioTrack,a=this._id3Track,s=r?be(r):void 0,l=e.length;(null===this.basePTS||0===this.frameIndex&&T(s))&&(this.basePTS=si(s,t,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),r&&r.length>0&&a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:un.audioId3,duration:Number.POSITIVE_INFINITY});while(i<l){if(this.canParse(e,i)){const t=this.appendFrame(o,e,i);t?(this.frameIndex++,this.lastPTS=t.sample.pts,i+=t.length,n=i):i=l}else ve(e,i)?(r=pe(e,i),a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:un.audioId3,duration:Number.POSITIVE_INFINITY}),i+=r.length,n=i):i++;if(i===l&&n!==l){const t=fe(e,n);this.cachedData?this.cachedData=tt(this.cachedData,t):this.cachedData=t}}return{audioTrack:o,videoTrack:oi(),id3Track:a,textTrack:oi()}}demuxSampleAes(e,t,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:oi(),id3Track:this._id3Track,textTrack:oi()}}destroy(){}}const si=(e,t,n)=>{if(T(e))return 90*e;const r=n?9e4*n.baseTime/n.timescale:0;return 9e4*t+r};function li(e,t,n,r){let i,o,a,s;const l=navigator.userAgent.toLowerCase(),u=r,c=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];i=1+((192&t[n+2])>>>6);const d=(60&t[n+2])>>>2;if(!(d>c.length-1))return a=(1&t[n+2])<<2,a|=(192&t[n+3])>>>6,N.log(`manifest codec:${r}, ADTS type:${i}, samplingIndex:${d}`),/firefox/i.test(l)?d>=6?(i=5,s=new Array(4),o=d-3):(i=2,s=new Array(2),o=d):-1!==l.indexOf("android")?(i=2,s=new Array(2),o=d):(i=5,s=new Array(4),r&&(-1!==r.indexOf("mp4a.40.29")||-1!==r.indexOf("mp4a.40.5"))||!r&&d>=6?o=d-3:((r&&-1!==r.indexOf("mp4a.40.2")&&(d>=6&&1===a||/vivaldi/i.test(l))||!r&&1===a)&&(i=2,s=new Array(2)),o=d)),s[0]=i<<3,s[0]|=(14&d)>>1,s[1]|=(1&d)<<7,s[1]|=a<<3,5===i&&(s[1]|=(14&o)>>1,s[2]=(1&o)<<7,s[2]|=8,s[3]=0),{config:s,samplerate:c[d],channelCount:a,codec:"mp4a.40."+i,manifestCodec:u};{const t=new Error("invalid ADTS sampling index:"+d);e.emit(E.ERROR,E.ERROR,{type:_.MEDIA_ERROR,details:A.FRAG_PARSING_ERROR,fatal:!0,error:t,reason:t.message})}}function ui(e,t){return 255===e[t]&&240===(246&e[t+1])}function ci(e,t){return 1&e[t+1]?7:9}function di(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function fi(e,t){return t+5<e.length}function hi(e,t){return t+1<e.length&&ui(e,t)}function mi(e,t){return fi(e,t)&&ui(e,t)&&di(e,t)<=e.length-t}function pi(e,t){if(hi(e,t)){const n=ci(e,t);if(t+n>=e.length)return!1;const r=di(e,t);if(r<=n)return!1;const i=t+r;return i===e.length||hi(e,i)}return!1}function gi(e,t,n,r,i){if(!e.samplerate){const o=li(t,n,r,i);if(!o)return;e.config=o.config,e.samplerate=o.samplerate,e.channelCount=o.channelCount,e.codec=o.codec,e.manifestCodec=o.manifestCodec,N.log(`parsed codec:${e.codec}, rate:${o.samplerate}, channels:${o.channelCount}`)}}function vi(e){return 9216e4/e}function bi(e,t){const n=ci(e,t);if(t+n<=e.length){const r=di(e,t)-n;if(r>0)return{headerLength:n,frameLength:r}}}function yi(e,t,n,r,i){const o=vi(e.samplerate),a=r+i*o,s=bi(t,n);let l;if(s){const{frameLength:r,headerLength:i}=s,o=i+r,u=Math.max(0,n+o-t.length);u?(l=new Uint8Array(o-i),l.set(t.subarray(n+i,t.length),0)):l=t.subarray(n+i,n+o);const c={unit:l,pts:a};return u||e.samples.push(c),{sample:c,length:o,missing:u}}const u=t.length-n;l=new Uint8Array(u),l.set(t.subarray(n,t.length),0);const c={unit:l,pts:a};return{sample:c,length:u,missing:-1}}let wi=null;const Si=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],xi=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],Ci=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],Ti=[0,1,1,4];function Di(e,t,n,r,i){if(n+24>t.length)return;const o=ki(t,n);if(o&&n+o.frameLength<=t.length){const a=9e4*o.samplesPerFrame/o.sampleRate,s=r+i*a,l={unit:t.subarray(n,n+o.frameLength),pts:s,dts:s};return e.config=[],e.channelCount=o.channelCount,e.samplerate=o.sampleRate,e.samples.push(l),{sample:l,length:o.frameLength,missing:0}}}function ki(e,t){const n=e[t+1]>>3&3,r=e[t+1]>>1&3,i=e[t+2]>>4&15,o=e[t+2]>>2&3;if(1!==n&&0!==i&&15!==i&&3!==o){const a=e[t+2]>>1&1,s=e[t+3]>>6,l=3===n?3-r:3===r?3:4,u=1e3*Si[14*l+i-1],c=3===n?0:2===n?1:2,d=xi[3*c+o],f=3===s?1:2,h=Ci[n][r],m=Ti[r],p=8*h*m,g=Math.floor(h*u/d+a)*m;if(null===wi){const e=navigator.userAgent||"",t=e.match(/Chrome\/(\d+)/i);wi=t?parseInt(t[1]):0}const v=!!wi&&wi<=87;return v&&2===r&&u>=224e3&&0===s&&(e[t+3]=128|e[t+3]),{sampleRate:d,channelCount:f,frameLength:g,samplesPerFrame:p}}}function Ei(e,t){return 255===e[t]&&224===(224&e[t+1])&&0!==(6&e[t+1])}function _i(e,t){return t+1<e.length&&Ei(e,t)}function Ai(e,t){const n=4;return Ei(e,t)&&n<=e.length-t}function Li(e,t){if(t+1<e.length&&Ei(e,t)){const n=4,r=ki(e,t);let i=n;null!=r&&r.frameLength&&(i=r.frameLength);const o=t+i;return o===e.length||_i(e,o)}return!1}class Oi extends ai{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=pe(e,0);let n=(null==t?void 0:t.length)||0;if(Li(e,n))return!1;for(let r=e.length;n<r;n++)if(pi(e,n))return N.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return mi(e,t)}appendFrame(e,t,n){gi(e,this.observer,t,n,e.manifestCodec);const r=yi(e,t,n,this.basePTS,this.frameIndex);if(r&&0===r.missing)return r}}const Ri=/\/emsg[-/]ID3/i;class Ii{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,r){const i=this.videoTrack=oi("video",1),o=this.audioTrack=oi("audio",1),a=this.txtTrack=oi("text",1);if(this.id3Track=oi("id3",1),this.timeOffset=0,null==e||!e.byteLength)return;const s=He(e);if(s.video){const{id:e,timescale:t,codec:n}=s.video;i.id=e,i.timescale=a.timescale=t,i.codec=n}if(s.audio){const{id:e,timescale:t,codec:n}=s.audio;o.id=e,o.timescale=t,o.codec=n}a.id=Ie.text,i.sampleDuration=0,i.duration=o.duration=r}resetContiguity(){this.remainderData=null}static probe(e){return ze(e)}demux(e,t){this.timeOffset=t;let n=e;const r=this.videoTrack,i=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=tt(this.remainderData,e));const t=et(n);this.remainderData=t.remainder,r.samples=t.valid||new Uint8Array}else r.samples=n;const o=this.extractID3Track(r,t);return i.samples=nt(t,r),{videoTrack:r,audioTrack:this.audioTrack,id3Track:o,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const r=this.extractID3Track(t,this.timeOffset);return n.samples=nt(e,t),{videoTrack:t,audioTrack:oi(),id3Track:r,textTrack:oi()}}extractID3Track(e,t){const n=this.id3Track;if(e.samples.length){const r=Ue(e.samples,["emsg"]);r&&r.forEach(e=>{const r=st(e);if(Ri.test(r.schemeIdUri)){const e=T(r.presentationTime)?r.presentationTime/r.timeScale:t+r.presentationTimeDelta/r.timeScale;let i=4294967295===r.eventDuration?Number.POSITIVE_INFINITY:r.eventDuration/r.timeScale;i<=.001&&(i=Number.POSITIVE_INFINITY);const o=r.payload;n.samples.push({data:o,len:o.byteLength,dts:e,pts:e,type:un.emsg,duration:i})}})}return n}demuxSampleAes(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}}const Pi=(e,t)=>{let n=0,r=5;t+=r;const i=new Uint32Array(1),o=new Uint32Array(1),a=new Uint8Array(1);while(r>0){a[0]=e[t];const s=Math.min(r,8),l=8-s;o[0]=4278190080>>>24+l<<l,i[0]=(a[0]&o[0])>>l,n=n?n<<s|i[0]:i[0],t+=1,r-=s}return n};class Mi extends ai{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,n){const r=Ni(e,t,n,this.basePTS,this.frameIndex);if(-1!==r){const t=e.samples[e.samples.length-1];return{sample:t,length:r,missing:0}}}static probe(e){if(!e)return!1;const t=pe(e,0);if(!t)return!1;const n=t.length;return 11===e[n]&&119===e[n+1]&&void 0!==be(t)&&Pi(e,n)<16}}function Ni(e,t,n,r,i){if(n+8>t.length)return-1;if(11!==t[n]||119!==t[n+1])return-1;const o=t[n+4]>>6;if(o>=3)return-1;const a=[48e3,44100,32e3],s=a[o],l=63&t[n+4],u=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920],c=2*u[3*l+o];if(n+c>t.length)return-1;const d=t[n+6]>>5;let f=0;2===d?f+=2:(1&d&&1!==d&&(f+=2),4&d&&(f+=2));const h=(t[n+6]<<8|t[n+7])>>12-f&1,m=[2,1,2,3,3,4,4,5],p=m[d]+h,g=t[n+5]>>3,v=7&t[n+5],b=new Uint8Array([o<<6|g<<1|v>>2,(3&v)<<6|d<<3|h<<2|l>>4,l<<4&224]),y=1536/s*9e4,w=r+i*y,S=t.subarray(n,n+c);return e.config=b,e.channelCount=p,e.samplerate=s,e.samples.push({unit:S,pts:w}),c}class Fi{constructor(){this.VideoSample=null}createVideoSample(e,t,n,r){return{key:e,frame:!1,pts:t,dts:n,units:[],debug:r,length:0}}getLastNalUnit(e){var t;let n,r=this.VideoSample;if(r&&0!==r.units.length||(r=e[e.length-1]),null!=(t=r)&&t.units){const e=r.units;n=e[e.length-1]}return n}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(void 0===e.pts){const n=t.samples,r=n.length;if(!r)return void t.dropped++;{const t=n[r-1];e.pts=t.pts,e.dts=t.dts}}t.samples.push(e)}e.debug.length&&N.log(e.pts+"/"+e.dts+":"+e.debug)}}class Bi{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,n=e.byteLength-t,r=new Uint8Array(4),i=Math.min(4,t);if(0===i)throw new Error("no bytes available");r.set(e.subarray(n,n+i)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=8*i,this.bytesAvailable-=i}skipBits(e){let t;e=Math.min(e,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const n=this.word>>>32-t;if(e>32&&N.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(0!==(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return 1===this.readBits(1)}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let t,n=8,r=8;for(let i=0;i<e;i++)0!==r&&(t=this.readEG(),r=(n+t+256)%256),n=0===r?n:r}readSPS(){let e,t,n,r=0,i=0,o=0,a=0;const s=this.readUByte.bind(this),l=this.readBits.bind(this),u=this.readUEG.bind(this),c=this.readBoolean.bind(this),d=this.skipBits.bind(this),f=this.skipEG.bind(this),h=this.skipUEG.bind(this),m=this.skipScalingList.bind(this);s();const p=s();if(l(5),d(3),s(),h(),100===p||110===p||122===p||244===p||44===p||83===p||86===p||118===p||128===p){const e=u();if(3===e&&d(1),h(),h(),d(1),c())for(t=3!==e?8:12,n=0;n<t;n++)c()&&m(n<6?16:64)}h();const g=u();if(0===g)u();else if(1===g)for(d(1),f(),f(),e=u(),n=0;n<e;n++)f();h(),d(1);const v=u(),b=u(),y=l(1);0===y&&d(1),d(1),c()&&(r=u(),i=u(),o=u(),a=u());let w=[1,1];if(c()&&c()){const e=s();switch(e){case 1:w=[1,1];break;case 2:w=[12,11];break;case 3:w=[10,11];break;case 4:w=[16,11];break;case 5:w=[40,33];break;case 6:w=[24,11];break;case 7:w=[20,11];break;case 8:w=[32,11];break;case 9:w=[80,33];break;case 10:w=[18,11];break;case 11:w=[15,11];break;case 12:w=[64,33];break;case 13:w=[160,99];break;case 14:w=[4,3];break;case 15:w=[3,2];break;case 16:w=[2,1];break;case 255:w=[s()<<8|s(),s()<<8|s()];break}}return{width:Math.ceil(16*(v+1)-2*r-2*i),height:(2-y)*(b+1)*16-(y?2:4)*(o+a),pixelRatio:w}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class $i extends Fi{parseAVCPES(e,t,n,r,i){const o=this.parseAVCNALu(e,n.data);let a,s=this.VideoSample,l=!1;n.data=null,s&&o.length&&!e.audFound&&(this.pushAccessUnit(s,e),s=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts,"")),o.forEach(r=>{var o;switch(r.type){case 1:{let t=!1;a=!0;const i=r.data;if(l&&i.length>4){const e=new Bi(i).readSliceType();2!==e&&4!==e&&7!==e&&9!==e||(t=!0)}var u;if(t)null!=(u=s)&&u.frame&&!s.key&&(this.pushAccessUnit(s,e),s=this.VideoSample=null);s||(s=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts,"")),s.frame=!0,s.key=t;break}case 5:a=!0,null!=(o=s)&&o.frame&&!s.key&&(this.pushAccessUnit(s,e),s=this.VideoSample=null),s||(s=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts,"")),s.key=!0,s.frame=!0;break;case 6:a=!0,ot(r.data,1,n.pts,t.samples);break;case 7:{var c,d;a=!0,l=!0;const t=r.data,n=new Bi(t),o=n.readSPS();if(!e.sps||e.width!==o.width||e.height!==o.height||(null==(c=e.pixelRatio)?void 0:c[0])!==o.pixelRatio[0]||(null==(d=e.pixelRatio)?void 0:d[1])!==o.pixelRatio[1]){e.width=o.width,e.height=o.height,e.pixelRatio=o.pixelRatio,e.sps=[t],e.duration=i;const n=t.subarray(1,4);let r="avc1.";for(let e=0;e<3;e++){let t=n[e].toString(16);t.length<2&&(t="0"+t),r+=t}e.codec=r}break}case 8:a=!0,e.pps=[r.data];break;case 9:a=!0,e.audFound=!0,s&&this.pushAccessUnit(s,e),s=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts,"");break;case 12:a=!0;break;default:a=!1,s&&(s.debug+="unknown NAL "+r.type+" ");break}if(s&&a){const e=s.units;e.push(r)}}),r&&s&&(this.pushAccessUnit(s,e),this.VideoSample=null)}parseAVCNALu(e,t){const n=t.byteLength;let r=e.naluState||0;const i=r,o=[];let a,s,l,u=0,c=-1,d=0;-1===r&&(c=0,d=31&t[0],r=0,u=1);while(u<n)if(a=t[u++],r)if(1!==r)if(a)if(1===a){if(s=u-r-1,c>=0){const e={data:t.subarray(c,s),type:d};o.push(e)}else{const n=this.getLastNalUnit(e.samples);n&&(i&&u<=4-i&&n.state&&(n.data=n.data.subarray(0,n.data.byteLength-i)),s>0&&(n.data=tt(n.data,t.subarray(0,s)),n.state=0))}u<n?(l=31&t[u],c=u,d=l,r=0):r=-1}else r=0;else r=3;else r=a?0:2;else r=a?0:1;if(c>=0&&r>=0){const e={data:t.subarray(c,n),type:d,state:r};o.push(e)}if(0===o.length){const n=this.getLastNalUnit(e.samples);n&&(n.data=tt(n.data,t))}return e.naluState=r,o}}class zi{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new Xr(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,t,n){const r=e[t].unit;if(r.length<=16)return;const i=r.subarray(16,r.length-r.length%16),o=i.buffer.slice(i.byteOffset,i.byteOffset+i.length);this.decryptBuffer(o).then(i=>{const o=new Uint8Array(i);r.set(o,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)})}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length)return void n();if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,n),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=16*Math.floor((e.length-48)/160)+16,n=new Int8Array(t);let r=0;for(let i=32;i<e.length-16;i+=160,r+=16)n.set(e.subarray(i,i+16),r);return n}getAvcDecryptedUnit(e,t){const n=new Uint8Array(t);let r=0;for(let i=32;i<e.length-16;i+=160,r+=16)e.set(n.subarray(r,r+16),i);return e}decryptAvcSample(e,t,n,r,i){const o=at(i.data),a=this.getAvcEncryptedData(o);this.decryptBuffer(a.buffer).then(a=>{i.data=this.getAvcDecryptedUnit(o,a),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,r)})}decryptAvcSamples(e,t,n,r){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length)return void r();const i=e[t].units;for(;;n++){if(n>=i.length)break;const o=i[n];if(!(o.data.length<=48||1!==o.type&&5!==o.type)&&(this.decryptAvcSample(e,t,n,r,o),!this.decrypter.isSync()))return}}}}const Ui=188;class Vi{constructor(e,t,n){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.videoParser=new $i}static probe(e){const t=Vi.syncOffset(e);return t>0&&N.warn("MPEG2-TS detected but first sync word found @ offset "+t),-1!==t}static syncOffset(e){const t=e.length;let n=Math.min(5*Ui,t-Ui)+1,r=0;while(r<n){let i=!1,o=-1,a=0;for(let s=r;s<t;s+=Ui){if(71!==e[s]||t-s!==Ui&&71!==e[s+Ui]){if(a)return-1;break}if(a++,-1===o&&(o=s,0!==o&&(n=Math.min(o+99*Ui,e.length-Ui)+1)),i||(i=0===Hi(e,s)),i&&a>1&&(0===o&&a>2||s+Ui>n))return o}r++}return-1}static createTrack(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:Ie[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===e?t:void 0}}resetInitSegment(e,t,n,r){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=Vi.createTrack("video"),this._audioTrack=Vi.createTrack("audio",r),this._id3Track=Vi.createTrack("id3"),this._txtTrack=Vi.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n,this._duration=r}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,n=!1,r=!1){let i;n||(this.sampleAes=null);const o=this._videoTrack,a=this._audioTrack,s=this._id3Track,l=this._txtTrack;let u=o.pid,c=o.pesData,d=a.pid,f=s.pid,h=a.pesData,m=s.pesData,p=null,g=this.pmtParsed,v=this._pmtId,b=e.length;if(this.remainderData&&(e=tt(this.remainderData,e),b=e.length,this.remainderData=null),b<Ui&&!r)return this.remainderData=e,{audioTrack:a,videoTrack:o,id3Track:s,textTrack:l};const y=Math.max(0,Vi.syncOffset(e));b-=(b-y)%Ui,b<e.byteLength&&!r&&(this.remainderData=new Uint8Array(e.buffer,b,e.buffer.byteLength-b));let w=0;for(let x=y;x<b;x+=Ui)if(71===e[x]){const t=!!(64&e[x+1]),r=Hi(e,x),b=(48&e[x+3])>>4;let w;if(b>1){if(w=x+5+e[x+4],w===x+Ui)continue}else w=x+4;switch(r){case u:t&&(c&&(i=Ki(c))&&this.videoParser.parseAVCPES(o,l,i,!1,this._duration),c={data:[],size:0}),c&&(c.data.push(e.subarray(w,x+Ui)),c.size+=x+Ui-w);break;case d:if(t){if(h&&(i=Ki(h)))switch(a.segmentCodec){case"aac":this.parseAACPES(a,i);break;case"mp3":this.parseMPEGPES(a,i);break;case"ac3":this.parseAC3PES(a,i);break}h={data:[],size:0}}h&&(h.data.push(e.subarray(w,x+Ui)),h.size+=x+Ui-w);break;case f:t&&(m&&(i=Ki(m))&&this.parseID3PES(s,i),m={data:[],size:0}),m&&(m.data.push(e.subarray(w,x+Ui)),m.size+=x+Ui-w);break;case 0:t&&(w+=e[w]+1),v=this._pmtId=ji(e,w);break;case v:{t&&(w+=e[w]+1);const r=qi(e,w,this.typeSupported,n,this.observer);u=r.videoPid,u>0&&(o.pid=u,o.segmentCodec=r.segmentVideoCodec),d=r.audioPid,d>0&&(a.pid=d,a.segmentCodec=r.segmentAudioCodec),f=r.id3Pid,f>0&&(s.pid=f),null===p||g||(N.warn(`MPEG-TS PMT found at ${x} after unknown PID '${p}'. Backtracking to sync byte @${y} to parse all TS packets.`),p=null,x=y-188),g=this.pmtParsed=!0;break}case 17:case 8191:break;default:p=r;break}}else w++;w>0&&Gi(this.observer,new Error(`Found ${w} TS packet/s that do not start with 0x47`)),o.pesData=c,a.pesData=h,s.pesData=m;const S={audioTrack:a,videoTrack:o,id3Track:s,textTrack:l};return r&&this.extractRemainingSamples(S),S}flush(){const{remainderData:e}=this;let t;return this.remainderData=null,t=e?this.demux(e,-1,!1,!0):{videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:n,id3Track:r,textTrack:i}=e,o=n.pesData,a=t.pesData,s=r.pesData;let l;if(o&&(l=Ki(o))?(this.videoParser.parseAVCPES(n,i,l,!0,this._duration),n.pesData=null):n.pesData=o,a&&(l=Ki(a))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,l);break;case"mp3":this.parseMPEGPES(t,l);break;case"ac3":this.parseAC3PES(t,l);break}t.pesData=null}else null!=a&&a.size&&N.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=a;s&&(l=Ki(s))?(this.parseID3PES(r,l),r.pesData=null):r.pesData=s}demuxSampleAes(e,t,n){const r=this.demux(e,n,!0,!this.config.progressive),i=this.sampleAes=new zi(this.observer,this.config,t);return this.decrypt(r,i)}decrypt(e,t){return new Promise(n=>{const{audioTrack:r,videoTrack:i}=e;r.samples&&"aac"===r.segmentCodec?t.decryptAacSamples(r.samples,0,()=>{i.samples?t.decryptAvcSamples(i.samples,0,0,()=>{n(e)}):n(e)}):i.samples&&t.decryptAvcSamples(i.samples,0,0,()=>{n(e)})})}destroy(){this._duration=0}parseAACPES(e,t){let n=0;const r=this.aacOverFlow;let i,o,a,s=t.data;if(r){this.aacOverFlow=null;const t=r.missing,i=r.sample.unit.byteLength;if(-1===t)s=tt(r.sample.unit,s);else{const o=i-t;r.sample.unit.set(s.subarray(0,t),o),e.samples.push(r.sample),n=r.missing}}for(i=n,o=s.length;i<o-1;i++)if(hi(s,i))break;if(i!==n){let e;const t=i<o-1;if(e=t?"AAC PES did not start with ADTS header,offset:"+i:"No ADTS header found in AAC PES",Gi(this.observer,new Error(e),t),!t)return}if(gi(e,this.observer,s,i,this.audioCodec),void 0!==t.pts)a=t.pts;else{if(!r)return void N.warn("[tsdemuxer]: AAC PES unknown PTS");{const t=vi(e.samplerate);a=r.sample.pts+t}}let l,u=0;while(i<o){if(l=yi(e,s,i,a,u),i+=l.length,l.missing){this.aacOverFlow=l;break}for(u++;i<o-1;i++)if(hi(s,i))break}}parseMPEGPES(e,t){const n=t.data,r=n.length;let i=0,o=0;const a=t.pts;if(void 0!==a)while(o<r)if(_i(n,o)){const t=Di(e,n,o,a,i);if(!t)break;o+=t.length,i++}else o++;else N.warn("[tsdemuxer]: MPEG PES unknown PTS")}parseAC3PES(e,t){{const n=t.data,r=t.pts;if(void 0===r)return void N.warn("[tsdemuxer]: AC3 PES unknown PTS");const i=n.length;let o,a=0,s=0;while(s<i&&(o=Ni(e,n,s,r,a++))>0)s+=o}}parseID3PES(e,t){if(void 0===t.pts)return void N.warn("[tsdemuxer]: ID3 PES unknown PTS");const n=C({},t,{type:this._videoTrack?un.emsg:un.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}}function Hi(e,t){return((31&e[t+1])<<8)+e[t+2]}function ji(e,t){return(31&e[t+10])<<8|e[t+11]}function qi(e,t,n,r,i){const o={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},a=(15&e[t+1])<<8|e[t+2],s=t+3+a-4,l=(15&e[t+10])<<8|e[t+11];t+=12+l;while(t<s){const a=Hi(e,t),s=(15&e[t+3])<<8|e[t+4];switch(e[t]){case 207:if(!r){Wi("ADTS AAC");break}case 15:-1===o.audioPid&&(o.audioPid=a);break;case 21:-1===o.id3Pid&&(o.id3Pid=a);break;case 219:if(!r){Wi("H.264");break}case 27:-1===o.videoPid&&(o.videoPid=a,o.segmentVideoCodec="avc");break;case 3:case 4:n.mpeg||n.mp3?-1===o.audioPid&&(o.audioPid=a,o.segmentAudioCodec="mp3"):N.log("MPEG audio found, not supported in this browser");break;case 193:if(!r){Wi("AC-3");break}case 129:n.ac3?-1===o.audioPid&&(o.audioPid=a,o.segmentAudioCodec="ac3"):N.log("AC-3 audio found, not supported in this browser");break;case 6:if(-1===o.audioPid&&s>0){let r=t+5,i=s;while(i>2){const t=e[r];switch(t){case 106:!0!==n.ac3?N.log("AC-3 audio found, not supported in this browser for now"):(o.audioPid=a,o.segmentAudioCodec="ac3");break}const s=e[r+1]+2;r+=s,i-=s}}break;case 194:case 135:return Gi(i,new Error("Unsupported EC-3 in M2TS found")),o;case 36:return Gi(i,new Error("Unsupported HEVC in M2TS found")),o}t+=s+5}return o}function Gi(e,t,n){N.warn("parsing error: "+t.message),e.emit(E.ERROR,E.ERROR,{type:_.MEDIA_ERROR,details:A.FRAG_PARSING_ERROR,fatal:!1,levelRetry:n,error:t,reason:t.message})}function Wi(e){N.log(e+" with AES-128-CBC encryption found in unencrypted stream")}function Ki(e){let t,n,r,i,o,a=0;const s=e.data;if(!e||0===e.size)return null;while(s[0].length<19&&s.length>1)s[0]=tt(s[0],s[1]),s.splice(1,1);t=s[0];const l=(t[0]<<16)+(t[1]<<8)+t[2];if(1===l){if(n=(t[4]<<8)+t[5],n&&n>e.size-6)return null;const l=t[7];192&l&&(i=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,64&l?(o=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2,i-o>54e5&&(N.warn(Math.round((i-o)/9e4)+"s delta between PTS and DTS, align them"),i=o)):o=i),r=t[8];let u=r+9;if(e.size<=u)return null;e.size-=u;const c=new Uint8Array(e.size);for(let e=0,n=s.length;e<n;e++){t=s[e];let n=t.byteLength;if(u){if(u>n){u-=n;continue}t=t.subarray(u),n-=u,u=0}c.set(t,a),a+=n}return n&&(n-=r+3),{data:c,pts:i,dts:o,len:n}}return null}class Yi extends ai{resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=pe(e,0);let n=(null==t?void 0:t.length)||0;if(t&&11===e[n]&&119===e[n+1]&&void 0!==be(t)&&Pi(e,n)<=16)return!1;for(let r=e.length;n<r;n++)if(Li(e,n))return N.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return Ai(e,t)}appendFrame(e,t,n){if(null!==this.basePTS)return Di(e,t,n,this.basePTS,this.frameIndex)}}class Xi{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const Ji=Math.pow(2,32)-1;class Qi{static init(){let e;for(e in Qi.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},Qi.types)Qi.types.hasOwnProperty(e)&&(Qi.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);Qi.HDLR_TYPES={video:t,audio:n};const r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),i=new Uint8Array([0,0,0,0,0,0,0,0]);Qi.STTS=Qi.STSC=Qi.STCO=i,Qi.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Qi.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Qi.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),Qi.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const o=new Uint8Array([105,115,111,109]),a=new Uint8Array([97,118,99,49]),s=new Uint8Array([0,0,0,1]);Qi.FTYP=Qi.box(Qi.types.ftyp,o,s,o,a),Qi.DINF=Qi.box(Qi.types.dinf,Qi.box(Qi.types.dref,r))}static box(e,...t){let n=8,r=t.length;const i=r;while(r--)n+=t[r].byteLength;const o=new Uint8Array(n);for(o[0]=n>>24&255,o[1]=n>>16&255,o[2]=n>>8&255,o[3]=255&n,o.set(e,4),r=0,n=8;r<i;r++)o.set(t[r],n),n+=t[r].byteLength;return o}static hdlr(e){return Qi.box(Qi.types.hdlr,Qi.HDLR_TYPES[e])}static mdat(e){return Qi.box(Qi.types.mdat,e)}static mdhd(e,t){t*=e;const n=Math.floor(t/(Ji+1)),r=Math.floor(t%(Ji+1));return Qi.box(Qi.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,r>>24,r>>16&255,r>>8&255,255&r,85,196,0,0]))}static mdia(e){return Qi.box(Qi.types.mdia,Qi.mdhd(e.timescale,e.duration),Qi.hdlr(e.type),Qi.minf(e))}static mfhd(e){return Qi.box(Qi.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))}static minf(e){return"audio"===e.type?Qi.box(Qi.types.minf,Qi.box(Qi.types.smhd,Qi.SMHD),Qi.DINF,Qi.stbl(e)):Qi.box(Qi.types.minf,Qi.box(Qi.types.vmhd,Qi.VMHD),Qi.DINF,Qi.stbl(e))}static moof(e,t,n){return Qi.box(Qi.types.moof,Qi.mfhd(e),Qi.traf(n,t))}static moov(e){let t=e.length;const n=[];while(t--)n[t]=Qi.trak(e[t]);return Qi.box.apply(null,[Qi.types.moov,Qi.mvhd(e[0].timescale,e[0].duration)].concat(n).concat(Qi.mvex(e)))}static mvex(e){let t=e.length;const n=[];while(t--)n[t]=Qi.trex(e[t]);return Qi.box.apply(null,[Qi.types.mvex,...n])}static mvhd(e,t){t*=e;const n=Math.floor(t/(Ji+1)),r=Math.floor(t%(Ji+1)),i=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,r>>24,r>>16&255,r>>8&255,255&r,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Qi.box(Qi.types.mvhd,i)}static sdtp(e){const t=e.samples||[],n=new Uint8Array(4+t.length);let r,i;for(r=0;r<t.length;r++)i=t[r].flags,n[r+4]=i.dependsOn<<4|i.isDependedOn<<2|i.hasRedundancy;return Qi.box(Qi.types.sdtp,n)}static stbl(e){return Qi.box(Qi.types.stbl,Qi.stsd(e),Qi.box(Qi.types.stts,Qi.STTS),Qi.box(Qi.types.stsc,Qi.STSC),Qi.box(Qi.types.stsz,Qi.STSZ),Qi.box(Qi.types.stco,Qi.STCO))}static avc1(e){let t,n,r,i=[],o=[];for(t=0;t<e.sps.length;t++)n=e.sps[t],r=n.byteLength,i.push(r>>>8&255),i.push(255&r),i=i.concat(Array.prototype.slice.call(n));for(t=0;t<e.pps.length;t++)n=e.pps[t],r=n.byteLength,o.push(r>>>8&255),o.push(255&r),o=o.concat(Array.prototype.slice.call(n));const a=Qi.box(Qi.types.avcC,new Uint8Array([1,i[3],i[4],i[5],255,224|e.sps.length].concat(i).concat([e.pps.length]).concat(o))),s=e.width,l=e.height,u=e.pixelRatio[0],c=e.pixelRatio[1];return Qi.box(Qi.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,s>>8&255,255&s,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a,Qi.box(Qi.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Qi.box(Qi.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,255&u,c>>24,c>>16&255,c>>8&255,255&c])))}static esds(e){const t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}static audioStsd(e){const t=e.samplerate;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0])}static mp4a(e){return Qi.box(Qi.types.mp4a,Qi.audioStsd(e),Qi.box(Qi.types.esds,Qi.esds(e)))}static mp3(e){return Qi.box(Qi.types[".mp3"],Qi.audioStsd(e))}static ac3(e){return Qi.box(Qi.types["ac-3"],Qi.audioStsd(e),Qi.box(Qi.types.dac3,e.config))}static stsd(e){return"audio"===e.type?"mp3"===e.segmentCodec&&"mp3"===e.codec?Qi.box(Qi.types.stsd,Qi.STSD,Qi.mp3(e)):"ac3"===e.segmentCodec?Qi.box(Qi.types.stsd,Qi.STSD,Qi.ac3(e)):Qi.box(Qi.types.stsd,Qi.STSD,Qi.mp4a(e)):Qi.box(Qi.types.stsd,Qi.STSD,Qi.avc1(e))}static tkhd(e){const t=e.id,n=e.duration*e.timescale,r=e.width,i=e.height,o=Math.floor(n/(Ji+1)),a=Math.floor(n%(Ji+1));return Qi.box(Qi.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,a>>24,a>>16&255,a>>8&255,255&a,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,r>>8&255,255&r,0,0,i>>8&255,255&i,0,0]))}static traf(e,t){const n=Qi.sdtp(e),r=e.id,i=Math.floor(t/(Ji+1)),o=Math.floor(t%(Ji+1));return Qi.box(Qi.types.traf,Qi.box(Qi.types.tfhd,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r])),Qi.box(Qi.types.tfdt,new Uint8Array([1,0,0,0,i>>24,i>>16&255,i>>8&255,255&i,o>>24,o>>16&255,o>>8&255,255&o])),Qi.trun(e,n.length+16+20+8+16+8+8),n)}static trak(e){return e.duration=e.duration||4294967295,Qi.box(Qi.types.trak,Qi.tkhd(e),Qi.mdia(e))}static trex(e){const t=e.id;return Qi.box(Qi.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const n=e.samples||[],r=n.length,i=12+16*r,o=new Uint8Array(i);let a,s,l,u,c,d;for(t+=8+i,o.set(["video"===e.type?1:0,0,15,1,r>>>24&255,r>>>16&255,r>>>8&255,255&r,t>>>24&255,t>>>16&255,t>>>8&255,255&t],0),a=0;a<r;a++)s=n[a],l=s.duration,u=s.size,c=s.flags,d=s.cts,o.set([l>>>24&255,l>>>16&255,l>>>8&255,255&l,u>>>24&255,u>>>16&255,u>>>8&255,255&u,c.isLeading<<2|c.dependsOn,c.isDependedOn<<6|c.hasRedundancy<<4|c.paddingValue<<1|c.isNonSync,61440&c.degradPrio,15&c.degradPrio,d>>>24&255,d>>>16&255,d>>>8&255,255&d],12+16*a);return Qi.box(Qi.types.trun,o)}static initSegment(e){Qi.types||Qi.init();const t=Qi.moov(e),n=tt(Qi.FTYP,t);return n}}Qi.types=void 0,Qi.HDLR_TYPES=void 0,Qi.STTS=void 0,Qi.STSC=void 0,Qi.STCO=void 0,Qi.STSZ=void 0,Qi.VMHD=void 0,Qi.SMHD=void 0,Qi.STSD=void 0,Qi.FTYP=void 0,Qi.DINF=void 0;const Zi=9e4;function eo(e,t,n=1,r=!1){const i=e*t*n;return r?Math.round(i):i}function to(e,t,n=1,r=!1){return eo(e,t,1/n,r)}function no(e,t=!1){return eo(e,1e3,1/Zi,t)}function ro(e,t=1){return eo(e,Zi,1/t)}const io=1e4,oo=1024,ao=1152,so=1536;let lo,uo=null,co=null;class fo{constructor(e,t,n,r=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.ISGenerated=!1,null===uo){const e=navigator.userAgent||"",t=e.match(/Chrome\/(\d+)/i);uo=t?parseInt(t[1]):0}if(null===co){const e=navigator.userAgent.match(/Safari\/(\d+)/i);co=e?parseInt(e[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){N.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){N.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){N.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const n=e.reduce((e,n)=>{const r=n.pts-e;return r<-4294967296?(t=!0,ho(e,n.pts)):r>0?e:n.pts},e[0].pts);return t&&N.debug("PTS rollover detected"),n}remux(e,t,n,r,i,o,a,s){let l,u,c,d,f,h,m=i,p=i;const g=e.pid>-1,v=t.pid>-1,b=t.samples.length,y=e.samples.length>0,w=a&&b>0||b>1,S=(!g||y)&&(!v||w)||this.ISGenerated||a;if(S){if(this.ISGenerated){var x,C,T,D;const e=this.videoTrackConfig;!e||t.width===e.width&&t.height===e.height&&(null==(x=t.pixelRatio)?void 0:x[0])===(null==(C=e.pixelRatio)?void 0:C[0])&&(null==(T=t.pixelRatio)?void 0:T[1])===(null==(D=e.pixelRatio)?void 0:D[1])||this.resetInitSegment()}else c=this.generateIS(e,t,i,o);const n=this.isVideoContiguous;let r,a=-1;if(w&&(a=mo(t.samples),!n&&this.config.forceKeyFrameOnDiscontinuity))if(h=!0,a>0){N.warn(`[mp4-remuxer]: Dropped ${a} out of ${b} video samples due to a missing keyframe`);const e=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(a),t.dropped+=a,p+=(t.samples[0].pts-e)/t.inputTimeScale,r=p}else-1===a&&(N.warn(`[mp4-remuxer]: No keyframe found out of ${b} video samples`),h=!1);if(this.ISGenerated){if(y&&w){const n=this.getVideoStartPts(t.samples),r=ho(e.samples[0].pts,n)-n,i=r/t.inputTimeScale;m+=Math.max(0,i),p+=Math.max(0,-i)}if(y){if(e.samplerate||(N.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),c=this.generateIS(e,t,i,o)),u=this.remuxAudio(e,m,this.isAudioContiguous,o,v||w||s===Jt.AUDIO?p:void 0),w){const r=u?u.endPTS-u.startPTS:0;t.inputTimeScale||(N.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),c=this.generateIS(e,t,i,o)),l=this.remuxVideo(t,p,n,r)}}else w&&(l=this.remuxVideo(t,p,n,0));l&&(l.firstKeyFrame=a,l.independent=-1!==a,l.firstKeyFramePTS=r)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(f=po(n,i,this._initPTS,this._initDTS)),r.samples.length&&(d=go(r,i,this._initPTS))),{audio:u,video:l,initSegment:c,independent:h,text:d,id3:f}}generateIS(e,t,n,r){const i=e.samples,o=t.samples,a=this.typeSupported,s={},l=this._initPTS;let u,c,d,f=!l||r,h="audio/mp4";if(f&&(u=c=1/0),e.config&&i.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":a.mpeg?(h="audio/mpeg",e.codec=""):a.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}s.audio={id:"audio",container:h,codec:e.codec,initSegment:"mp3"===e.segmentCodec&&a.mpeg?new Uint8Array(0):Qi.initSegment([e]),metadata:{channelCount:e.channelCount}},f&&(d=e.inputTimeScale,l&&d===l.timescale?f=!1:u=c=i[0].pts-Math.round(d*n))}if(t.sps&&t.pps&&o.length){if(t.timescale=t.inputTimeScale,s.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:Qi.initSegment([t]),metadata:{width:t.width,height:t.height}},f)if(d=t.inputTimeScale,l&&d===l.timescale)f=!1;else{const e=this.getVideoStartPts(o),t=Math.round(d*n);c=Math.min(c,ho(o[0].dts,e)-t),u=Math.min(u,e-t)}this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(s).length)return this.ISGenerated=!0,f?(this._initPTS={baseTime:u,timescale:d},this._initDTS={baseTime:c,timescale:d}):u=d=void 0,{tracks:s,initPTS:u,timescale:d}}remuxVideo(e,t,n,r){const i=e.inputTimeScale,o=e.samples,a=[],s=o.length,l=this._initPTS;let u,c,d=this.nextAvcDts,f=8,h=this.videoSampleDuration,m=Number.POSITIVE_INFINITY,p=Number.NEGATIVE_INFINITY,g=!1;if(!n||null===d){const e=t*i,r=o[0].pts-ho(o[0].dts,o[0].pts);uo&&null!==d&&Math.abs(e-r-d)<15e3?n=!0:d=e-r}const v=l.baseTime*i/l.timescale;for(let C=0;C<s;C++){const e=o[C];e.pts=ho(e.pts-v,d),e.dts=ho(e.dts-v,d),e.dts<o[C>0?C-1:C].dts&&(g=!0)}g&&o.sort((function(e,t){const n=e.dts-t.dts,r=e.pts-t.pts;return n||r})),u=o[0].dts,c=o[o.length-1].dts;const b=c-u,y=b?Math.round(b/(s-1)):h||e.inputTimeScale/30;if(n){const e=u-d,n=e>y,r=e<-1;if((n||r)&&(n?N.warn(`AVC: ${no(e,!0)} ms (${e}dts) hole between fragments detected at ${t.toFixed(3)}`):N.warn(`AVC: ${no(-e,!0)} ms (${e}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!r||d>=o[0].pts||uo)){u=d;const t=o[0].pts-e;if(n)o[0].dts=u,o[0].pts=t;else for(let n=0;n<o.length;n++){if(o[n].dts>t)break;o[n].dts-=e,o[n].pts-=e}N.log(`Video: Initial PTS/DTS adjusted: ${no(t,!0)}/${no(u,!0)}, delta: ${no(e,!0)} ms`)}}u=Math.max(0,u);let w=0,S=0,x=u;for(let C=0;C<s;C++){const e=o[C],t=e.units,n=t.length;let r=0;for(let i=0;i<n;i++)r+=t[i].data.length;S+=r,w+=n,e.length=r,e.dts<x?(e.dts=x,x+=y/4|0||1):x=e.dts,m=Math.min(e.pts,m),p=Math.max(e.pts,p)}c=o[s-1].dts;const T=S+4*w+8;let D;try{D=new Uint8Array(T)}catch($){return void this.observer.emit(E.ERROR,E.ERROR,{type:_.MUX_ERROR,details:A.REMUX_ALLOC_ERROR,fatal:!1,error:$,bytes:T,reason:"fail allocating video mdat "+T})}const k=new DataView(D.buffer);k.setUint32(0,T),D.set(Qi.types.mdat,4);let L=!1,O=Number.POSITIVE_INFINITY,R=Number.POSITIVE_INFINITY,I=Number.NEGATIVE_INFINITY,P=Number.NEGATIVE_INFINITY;for(let C=0;C<s;C++){const e=o[C],t=e.units;let n,l=0;for(let r=0,i=t.length;r<i;r++){const e=t[r],n=e.data,i=e.data.byteLength;k.setUint32(f,i),f+=4,D.set(n,f),f+=i,l+=4+i}if(C<s-1)h=o[C+1].dts-e.dts,n=o[C+1].pts-e.pts;else{const t=this.config,a=C>0?e.dts-o[C-1].dts:y;if(n=C>0?e.pts-o[C-1].pts:y,t.stretchShortVideoTrack&&null!==this.nextAudioPts){const n=Math.floor(t.maxBufferHole*i),o=(r?m+r*i:this.nextAudioPts)-e.pts;o>n?(h=o-a,h<0?h=a:L=!0,N.log(`[mp4-remuxer]: It is approximately ${o/90} ms to the next segment; using duration ${h/90} ms for the last video frame.`)):h=a}else h=a}const u=Math.round(e.pts-e.dts);O=Math.min(O,h),I=Math.max(I,h),R=Math.min(R,n),P=Math.max(P,n),a.push(new vo(e.key,h,l,u))}if(a.length)if(uo){if(uo<70){const e=a[0].flags;e.dependsOn=2,e.isNonSync=0}}else if(co&&P-R<I-O&&y/I<.025&&0===a[0].cts){N.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let e=u;for(let t=0,n=a.length;t<n;t++){const r=e+a[t].duration,i=e+a[t].cts;if(t<n-1){const e=r+a[t+1].cts;a[t].duration=e-i}else a[t].duration=t?a[t-1].duration:y;a[t].cts=0,e=r}}h=L||!h?y:h,this.nextAvcDts=d=c+h,this.videoSampleDuration=h,this.isVideoContiguous=!0;const M=Qi.moof(e.sequenceNumber++,u,C({},e,{samples:a})),F="video",B={data1:M,data2:D,startPTS:m/i,endPTS:(p+h)/i,startDTS:u/i,endDTS:d/i,type:F,hasAudio:!1,hasVideo:!0,nb:a.length,dropped:e.dropped};return e.samples=[],e.dropped=0,B}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return ao;case"ac3":return so;default:return oo}}remuxAudio(e,t,n,r,i){const o=e.inputTimeScale,a=e.samplerate?e.samplerate:o,s=o/a,l=this.getSamplesPerFrame(e),u=l*s,c=this._initPTS,d="mp3"===e.segmentCodec&&this.typeSupported.mpeg,f=[],h=void 0!==i;let m=e.samples,p=d?0:8,g=this.nextAudioPts||-1;const v=t*o,b=c.baseTime*o/c.timescale;if(this.isAudioContiguous=n=n||m.length&&g>0&&(r&&Math.abs(v-g)<9e3||Math.abs(ho(m[0].pts-b,v)-g)<20*u),m.forEach((function(e){e.pts=ho(e.pts-b,v)})),!n||g<0){if(m=m.filter(e=>e.pts>=0),!m.length)return;g=0===i?0:r&&!h?Math.max(0,v):m[0].pts}if("aac"===e.segmentCodec){const t=this.config.maxAudioFramesDrift;for(let n=0,r=g;n<m.length;n++){const i=m[n],a=i.pts,s=a-r,l=Math.abs(1e3*s/o);if(s<=-t*u&&h)0===n&&(N.warn(`Audio frame @ ${(a/o).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*s/o)} ms.`),this.nextAudioPts=g=r=a);else if(s>=t*u&&l<io&&h){let t=Math.round(s/u);r=a-t*u,r<0&&(t--,r+=u),0===n&&(this.nextAudioPts=g=r),N.warn(`[mp4-remuxer]: Injecting ${t} audio frame @ ${(r/o).toFixed(3)}s due to ${Math.round(1e3*s/o)} ms gap.`);for(let o=0;o<t;o++){const t=Math.max(r,0);let o=Xi.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);o||(N.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),o=i.unit.subarray()),m.splice(n,0,{unit:o,pts:t}),r+=u,n++}}i.pts=r,r+=u}}let y,w=null,S=null,x=0,T=m.length;while(T--)x+=m[T].unit.byteLength;for(let C=0,N=m.length;C<N;C++){const t=m[C],r=t.unit;let i=t.pts;if(null!==S){const e=f[C-1];e.duration=Math.round((i-S)/s)}else{if(n&&"aac"===e.segmentCodec&&(i=g),w=i,!(x>0))return;x+=p;try{y=new Uint8Array(x)}catch(M){return void this.observer.emit(E.ERROR,E.ERROR,{type:_.MUX_ERROR,details:A.REMUX_ALLOC_ERROR,fatal:!1,error:M,bytes:x,reason:"fail allocating audio mdat "+x})}if(!d){const e=new DataView(y.buffer);e.setUint32(0,x),y.set(Qi.types.mdat,4)}}y.set(r,p);const o=r.byteLength;p+=o,f.push(new vo(!0,l,o,0)),S=i}const D=f.length;if(!D)return;const k=f[f.length-1];this.nextAudioPts=g=S+s*k.duration;const L=d?new Uint8Array(0):Qi.moof(e.sequenceNumber++,w/s,C({},e,{samples:f}));e.samples=[];const O=w/o,R=g/o,I="audio",P={data1:L,data2:y,startPTS:O,endPTS:R,startDTS:O,endDTS:R,type:I,hasAudio:!0,hasVideo:!1,nb:D};return this.isAudioContiguous=!0,P}remuxEmptyAudio(e,t,n,r){const i=e.inputTimeScale,o=e.samplerate?e.samplerate:i,a=i/o,s=this.nextAudioPts,l=this._initDTS,u=9e4*l.baseTime/l.timescale,c=(null!==s?s:r.startDTS*i)+u,d=r.endDTS*i+u,f=a*oo,h=Math.ceil((d-c)/f),m=Xi.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(N.warn("[mp4-remuxer]: remux empty Audio"),!m)return void N.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");const p=[];for(let g=0;g<h;g++){const e=c+g*f;p.push({unit:m,pts:e,dts:e})}return e.samples=p,this.remuxAudio(e,t,n,!1)}}function ho(e,t){let n;if(null===t)return e;n=t<e?-8589934592:8589934592;while(Math.abs(e-t)>4294967296)e+=n;return e}function mo(e){for(let t=0;t<e.length;t++)if(e[t].key)return t;return-1}function po(e,t,n,r){const i=e.samples.length;if(!i)return;const o=e.inputTimeScale;for(let s=0;s<i;s++){const i=e.samples[s];i.pts=ho(i.pts-n.baseTime*o/n.timescale,t*o)/o,i.dts=ho(i.dts-r.baseTime*o/r.timescale,t*o)/o}const a=e.samples;return e.samples=[],{samples:a}}function go(e,t,n){const r=e.samples.length;if(!r)return;const i=e.inputTimeScale;for(let a=0;a<r;a++){const r=e.samples[a];r.pts=ho(r.pts-n.baseTime*i/n.timescale,t*i)/i}e.samples.sort((e,t)=>e.pts-t.pts);const o=e.samples;return e.samples=[],{samples:o}}class vo{constructor(e,t,n,r){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=n,this.cts=r,this.flags={isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:e?2:1,isNonSync:e?0:1}}}class bo{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,n,r){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(Ke(e,r)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:n}=this;if(null==e||!e.byteLength)return this.initTracks=void 0,void(this.initData=void 0);const r=this.initData=He(e);r.audio&&(t=wo(r.audio,j.AUDIO)),r.video&&(n=wo(r.video,j.VIDEO));const i={};r.audio&&r.video?i.audiovideo={container:"video/mp4",codec:t+","+n,initSegment:e,id:"main"}:r.audio?i.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:r.video?i.video={container:"video/mp4",codec:n,initSegment:e,id:"main"}:N.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=i}remux(e,t,n,r,i,o){var a,s;let{initPTS:l,lastEndTime:u}=this;const c={audio:void 0,video:void 0,text:r,id3:n,initSegment:void 0};T(u)||(u=this.lastEndTime=i||0);const d=t.samples;if(null==d||!d.length)return c;const f={initPTS:void 0,timescale:1};let h=this.initData;if(null!=(a=h)&&a.length||(this.generateInitSegment(d),h=this.initData),null==(s=h)||!s.length)return N.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),c;this.emitInitSegment&&(f.tracks=this.initTracks,this.emitInitSegment=!1);const m=Je(d,h),p=Xe(h,d),g=null===p?i:p;(yo(l,g,i,m)||f.timescale!==l.timescale&&o)&&(f.initPTS=g-i,l&&1===l.timescale&&N.warn("Adjusting initPTS by "+(f.initPTS-l.baseTime)),this.initPTS=l={baseTime:f.initPTS,timescale:1});const v=e?g-l.baseTime/l.timescale:u,b=v+m;Ze(h,d,l.baseTime/l.timescale),m>0?this.lastEndTime=b:(N.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const y=!!h.audio,w=!!h.video;let S="";y&&(S+="audio"),w&&(S+="video");const x={data1:d,startPTS:v,startDTS:v,endPTS:b,endDTS:b,type:S,hasAudio:y,hasVideo:w,nb:1,dropped:0};return c.audio="audio"===x.type?x:void 0,c.video="audio"!==x.type?x:void 0,c.initSegment=f,c.id3=po(n,i,l,l),r.samples.length&&(c.text=go(r,i,l)),c}}function yo(e,t,n,r){if(null===e)return!0;const i=Math.max(r,1),o=t-e.baseTime/e.timescale;return Math.abs(o-n)>i}function wo(e,t){const n=null==e?void 0:e.codec;if(n&&n.length>4)return n;if(t===j.AUDIO){if("ec-3"===n||"ac-3"===n||"alac"===n)return n;if("fLaC"===n||"Opus"===n){const e=!1;return It(n,e)}const e="mp4a.40.5";return N.info(`Parsed audio codec "${n}" or audio object type not handled. Using "${e}"`),e}return N.warn(`Unhandled video codec "${n}"`),"hvc1"===n||"hev1"===n?"hvc1.1.6.L120.90":"av01"===n?"av01.0.04M.08":"avc1.42e01e"}try{lo=self.performance.now.bind(self.performance)}catch(Gl){N.debug("Unable to use Performance API on this environment"),lo=null==te?void 0:te.Date.now}const So=[{demux:Ii,remux:bo},{demux:Vi,remux:fo},{demux:Oi,remux:fo},{demux:Yi,remux:fo}];So.splice(2,0,{demux:Mi,remux:fo});class xo{constructor(e,t,n,r,i){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.vendor=r,this.id=i}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,r){const i=n.transmuxing;i.executeStart=lo();let o=new Uint8Array(e);const{currentTransmuxState:a,transmuxConfig:s}=this;r&&(this.currentTransmuxState=r);const{contiguous:l,discontinuity:u,trackSwitch:c,accurateTimeOffset:d,timeOffset:f,initSegmentChange:h}=r||a,{audioCodec:m,videoCodec:p,defaultInitPts:g,duration:v,initSegmentData:b}=s,y=Co(o,t);if(y&&"AES-128"===y.method){const e=this.getDecrypter();if(!e.isSync())return this.decryptionPromise=e.webCryptoDecrypt(o,y.key.buffer,y.iv.buffer).then(e=>{const t=this.push(e,null,n);return this.decryptionPromise=null,t}),this.decryptionPromise;{let t=e.softwareDecrypt(o,y.key.buffer,y.iv.buffer);const r=n.part>-1;if(r&&(t=e.flush()),!t)return i.executeEnd=lo(),To(n);o=new Uint8Array(t)}}const w=this.needsProbing(u,c);if(w){const e=this.configureTransmuxer(o);if(e)return N.warn("[transmuxer] "+e.message),this.observer.emit(E.ERROR,E.ERROR,{type:_.MEDIA_ERROR,details:A.FRAG_PARSING_ERROR,fatal:!1,error:e,reason:e.message}),i.executeEnd=lo(),To(n)}(u||c||h||w)&&this.resetInitSegment(b,m,p,v,t),(u||h||w)&&this.resetInitialTimestamp(g),l||this.resetContiguity();const S=this.transmux(o,y,f,d,n),x=this.currentTransmuxState;return x.contiguous=!0,x.discontinuity=!1,x.trackSwitch=!1,i.executeEnd=lo(),S}flush(e){const t=e.transmuxing;t.executeStart=lo();const{decrypter:n,currentTransmuxState:r,decryptionPromise:i}=this;if(i)return i.then(()=>this.flush(e));const o=[],{timeOffset:a}=r;if(n){const t=n.flush();t&&o.push(this.push(t,null,e))}const{demuxer:s,remuxer:l}=this;if(!s||!l)return t.executeEnd=lo(),[To(e)];const u=s.flush(a);return Do(u)?u.then(t=>(this.flushRemux(o,t,e),o)):(this.flushRemux(o,u,e),o)}flushRemux(e,t,n){const{audioTrack:r,videoTrack:i,id3Track:o,textTrack:a}=t,{accurateTimeOffset:s,timeOffset:l}=this.currentTransmuxState;N.log(`[transmuxer.ts]: Flushed fragment ${n.sn}${n.part>-1?" p: "+n.part:""} of level ${n.level}`);const u=this.remuxer.remux(r,i,o,a,l,s,!0,this.id);e.push({remuxResult:u,chunkMeta:n}),n.transmuxing.executeEnd=lo()}resetInitialTimestamp(e){const{demuxer:t,remuxer:n}=this;t&&n&&(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;e&&t&&(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,r,i){const{demuxer:o,remuxer:a}=this;o&&a&&(o.resetInitSegment(e,t,n,r),a.resetInitSegment(e,t,n,i))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,r,i){let o;return o=t&&"SAMPLE-AES"===t.method?this.transmuxSampleAes(e,t,n,r,i):this.transmuxUnencrypted(e,n,r,i),o}transmuxUnencrypted(e,t,n,r){const{audioTrack:i,videoTrack:o,id3Track:a,textTrack:s}=this.demuxer.demux(e,t,!1,!this.config.progressive),l=this.remuxer.remux(i,o,a,s,t,n,!1,this.id);return{remuxResult:l,chunkMeta:r}}transmuxSampleAes(e,t,n,r,i){return this.demuxer.demuxSampleAes(e,t,n).then(e=>{const t=this.remuxer.remux(e.audioTrack,e.videoTrack,e.id3Track,e.textTrack,n,r,!1,this.id);return{remuxResult:t,chunkMeta:i}})}configureTransmuxer(e){const{config:t,observer:n,typeSupported:r,vendor:i}=this;let o;for(let d=0,f=So.length;d<f;d++){var a;if(null!=(a=So[d].demux)&&a.probe(e)){o=So[d];break}}if(!o)return new Error("Failed to find demuxer by probing fragment data");const s=this.demuxer,l=this.remuxer,u=o.remux,c=o.demux;l&&l instanceof u||(this.remuxer=new u(n,t,r,i)),s&&s instanceof c||(this.demuxer=new c(n,t,r),this.probe=c.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new Xr(this.config)),e}}function Co(e,t){let n=null;return e.byteLength>0&&null!=(null==t?void 0:t.key)&&null!==t.iv&&null!=t.method&&(n=t),n}const To=e=>({remuxResult:{},chunkMeta:e});function Do(e){return"then"in e&&e.then instanceof Function}class ko{constructor(e,t,n,r,i){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=r,this.defaultInitPts=i||null}}class Eo{constructor(e,t,n,r,i,o){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=r,this.timeOffset=i,this.initSegmentChange=o}}var _o={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,r,o,a){if("function"!==typeof r)throw new TypeError("The listener must be a function");var s=new i(r,o||e,a),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],s]:e._events[l].push(s):(e._events[l]=s,e._eventsCount++),e}function a(e,t){0===--e._eventsCount?e._events=new r:delete e._events[t]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,a=new Array(o);i<o;i++)a[i]=r[i].fn;return a},s.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},s.prototype.emit=function(e,t,r,i,o,a){var s=n?n+e:e;if(!this._events[s])return!1;var l,u,c=this._events[s],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,r),!0;case 4:return c.fn.call(c.context,t,r,i),!0;case 5:return c.fn.call(c.context,t,r,i,o),!0;case 6:return c.fn.call(c.context,t,r,i,o,a),!0}for(u=1,l=new Array(d-1);u<d;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var f,h=c.length;for(u=0;u<h;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),d){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,t);break;case 3:c[u].fn.call(c[u].context,t,r);break;case 4:c[u].fn.call(c[u].context,t,r,i);break;default:if(!l)for(f=1,l=new Array(d-1);f<d;f++)l[f-1]=arguments[f];c[u].fn.apply(c[u].context,l)}}return!0},s.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,r,i){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||i&&!s.once||r&&s.context!==r||a(this,o);else{for(var l=0,u=[],c=s.length;l<c;l++)(s[l].fn!==t||i&&!s[l].once||r&&s[l].context!==r)&&u.push(s[l]);u.length?this._events[o]=1===u.length?u[0]:u:a(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s})(_o);var Ao=_o.exports,Lo=p(Ao);class Oo{constructor(e,t,n,r){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const i=e.config;this.hls=e,this.id=t,this.useWorker=!!i.enableWorker,this.onTransmuxComplete=n,this.onFlush=r;const o=(e,t)=>{t=t||{},t.frag=this.frag,t.id=this.id,e===E.ERROR&&(this.error=t.error),this.hls.trigger(e,t)};this.observer=new Lo,this.observer.on(E.FRAG_DECRYPTED,o),this.observer.on(E.ERROR,o);const a=St(i.preferManagedMediaSource)||{isTypeSupported:()=>!1},s={mpeg:a.isTypeSupported("audio/mpeg"),mp3:a.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:a.isTypeSupported('audio/mp4; codecs="ac-3"')};if(this.useWorker&&"undefined"!==typeof Worker){const e=i.workerPath||ni();if(e){try{i.workerPath?(N.log(`loading Web Worker ${i.workerPath} for "${t}"`),this.workerContext=ii(i.workerPath)):(N.log(`injecting Web Worker for "${t}"`),this.workerContext=ri()),this.onwmsg=e=>this.onWorkerMessage(e);const{worker:e}=this.workerContext;e.addEventListener("message",this.onwmsg),e.onerror=e=>{const n=new Error(`${e.message}  (${e.filename}:${e.lineno})`);i.enableWorker=!1,N.warn(`Error in "${t}" Web Worker, fallback to inline`),this.hls.trigger(E.ERROR,{type:_.OTHER_ERROR,details:A.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:n})},e.postMessage({cmd:"init",typeSupported:s,vendor:"",id:t,config:JSON.stringify(i)})}catch(Gl){N.warn(`Error setting up "${t}" Web Worker, fallback to inline`,Gl),this.resetWorker(),this.error=null,this.transmuxer=new xo(this.observer,s,i,"",t)}return}}this.transmuxer=new xo(this.observer,s,i,"",t)}resetWorker(){if(this.workerContext){const{worker:e,objectURL:t}=this.workerContext;t&&self.URL.revokeObjectURL(t),e.removeEventListener("message",this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const e=this.transmuxer;e&&(e.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,t,n,r,i,o,a,s,l,u){var c,d;l.transmuxing.start=self.performance.now();const{transmuxer:f}=this,h=o?o.start:i.start,m=i.decryptdata,p=this.frag,g=!(p&&i.cc===p.cc),v=!(p&&l.level===p.level),b=p?l.sn-p.sn:-1,y=this.part?l.part-this.part.index:-1,w=0===b&&l.id>1&&l.id===(null==p?void 0:p.stats.chunkCount),S=!v&&(1===b||0===b&&(1===y||w&&y<=0)),x=self.performance.now();(v||b||0===i.stats.parsing.start)&&(i.stats.parsing.start=x),!o||!y&&S||(o.stats.parsing.start=x);const C=!(p&&(null==(c=i.initSegment)?void 0:c.url)===(null==(d=p.initSegment)?void 0:d.url)),T=new Eo(g,S,s,v,h,C);if(!S||g||C){N.log(`[transmuxer-interface, ${i.type}]: Starting new transmux session for sn: ${l.sn} p: ${l.part} level: ${l.level} id: ${l.id}\n        discontinuity: ${g}\n        trackSwitch: ${v}\n        contiguous: ${S}\n        accurateTimeOffset: ${s}\n        timeOffset: ${h}\n        initSegmentChange: ${C}`);const e=new ko(n,r,t,a,u);this.configureTransmuxer(e)}if(this.frag=i,this.part=o,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:m,chunkMeta:l,state:T},e instanceof ArrayBuffer?[e]:[]);else if(f){const t=f.push(e,m,l,T);Do(t)?(f.async=!0,t.then(e=>{this.handleTransmuxComplete(e)}).catch(e=>{this.transmuxerError(e,l,"transmuxer-interface push error")})):(f.async=!1,this.handleTransmuxComplete(t))}}flush(e){e.transmuxing.start=self.performance.now();const{transmuxer:t}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(t){let n=t.flush(e);const r=Do(n);r||t.async?(Do(n)||(n=Promise.resolve(n)),n.then(t=>{this.handleFlushResult(t,e)}).catch(t=>{this.transmuxerError(t,e,"transmuxer-interface flush error")})):this.handleFlushResult(n,e)}}transmuxerError(e,t,n){this.hls&&(this.error=e,this.hls.trigger(E.ERROR,{type:_.MEDIA_ERROR,details:A.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach(e=>{this.handleTransmuxComplete(e)}),this.onFlush(t)}onWorkerMessage(e){const t=e.data;if(null==t||!t.event)return void N.warn("worker message received with no "+(t?"event name":"data"));const n=this.hls;if(this.hls)switch(t.event){case"init":{var r;const e=null==(r=this.workerContext)?void 0:r.objectURL;e&&self.URL.revokeObjectURL(e);break}case"transmuxComplete":this.handleTransmuxComplete(t.data);break;case"flush":this.onFlush(t.data);break;case"workerLog":N[t.data.logType]&&N[t.data.logType](t.data.message);break;default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,n.trigger(t.event,t.data);break}}configureTransmuxer(e){const{transmuxer:t}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}function Ro(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!Io(e[n].attrs,t[n].attrs))return!1;return!0}function Io(e,t,n){const r=e["STABLE-RENDITION-ID"];return r&&!n?r===t["STABLE-RENDITION-ID"]:!(n||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(n=>e[n]!==t[n])}function Po(e,t){return t.label.toLowerCase()===e.name.toLowerCase()&&(!t.language||t.language.toLowerCase()===(e.lang||"").toLowerCase())}const Mo=100;class No extends Zr{constructor(e,t,n){super(e,t,n,"[audio-stream-controller]",Jt.AUDIO),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:e}=this;e.on(E.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(E.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(E.MANIFEST_LOADING,this.onManifestLoading,this),e.on(E.LEVEL_LOADED,this.onLevelLoaded,this),e.on(E.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(E.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(E.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(E.ERROR,this.onError,this),e.on(E.BUFFER_RESET,this.onBufferReset,this),e.on(E.BUFFER_CREATED,this.onBufferCreated,this),e.on(E.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(E.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(E.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(E.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(E.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(E.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(E.MANIFEST_LOADING,this.onManifestLoading,this),e.off(E.LEVEL_LOADED,this.onLevelLoaded,this),e.off(E.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(E.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(E.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(E.ERROR,this.onError,this),e.off(E.BUFFER_RESET,this.onBufferReset,this),e.off(E.BUFFER_CREATED,this.onBufferCreated,this),e.off(E.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(E.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(E.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(E.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,{frag:t,id:n,initPTS:r,timescale:i}){if("main"===n){const e=t.cc;this.initPTS[t.cc]={baseTime:r,timescale:i},this.log(`InitPTS for cc: ${e} found from main: ${r}`),this.videoTrackCC=e,this.state===Qr.WAITING_INIT_PTS&&this.tick()}}startLoad(e){if(!this.levels)return this.startPosition=e,void(this.state=Qr.STOPPED);const t=this.lastCurrentTime;this.stopLoad(),this.setInterval(Mo),t>0&&-1===e?(this.log("Override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t,this.state=Qr.IDLE):(this.loadedmetadata=!1,this.state=Qr.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){switch(this.state){case Qr.IDLE:this.doTickIdle();break;case Qr.WAITING_TRACK:{var e;const{levels:t,trackId:n}=this,r=null==t||null==(e=t[n])?void 0:e.details;if(r){if(this.waitForCdnTuneIn(r))break;this.state=Qr.WAITING_INIT_PTS}break}case Qr.FRAG_LOADING_WAITING_RETRY:{var t;const e=performance.now(),n=this.retryDate;if(!n||e>=n||null!=(t=this.media)&&t.seeking){const{levels:e,trackId:t}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((null==e?void 0:e[t])||null),this.state=Qr.IDLE}break}case Qr.WAITING_INIT_PTS:{const e=this.waitingData;if(e){const{frag:t,part:n,cache:r,complete:i}=e;if(void 0!==this.initPTS[t.cc]){this.waitingData=null,this.waitingVideoCC=-1,this.state=Qr.FRAG_LOADING;const e=r.flush(),o={frag:t,part:n,payload:e,networkDetails:null};this._handleFragmentLoadProgress(o),i&&super._handleFragmentLoadComplete(o)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${t.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const e=this.getLoadPosition(),n=Ar.bufferInfo(this.mediaBuffer,e,this.config.maxBufferHole),r=Xn(n.end,this.config.maxFragLookUpTolerance,t);r<0&&(this.log(`Waiting fragment cc (${t.cc}) @ ${t.start} cancelled because another fragment at ${n.end} is needed`),this.clearWaitingFragment())}}else this.state=Qr.IDLE}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=Qr.IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;null!=e&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){const{hls:e,levels:t,media:n,trackId:r}=this,i=e.config;if(!n&&(this.startFragRequested||!i.startFragPrefetch)||null==t||!t[r])return;const o=t[r],a=o.details;if(!a||a.live&&this.levelLastLoaded!==o||this.waitForCdnTuneIn(a))return void(this.state=Qr.WAITING_TRACK);const s=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&s&&(this.bufferFlushed=!1,this.afterBufferFlushed(s,j.AUDIO,Jt.AUDIO));const l=this.getFwdBufferInfo(s,Jt.AUDIO);if(null===l)return;const{bufferedTrack:u,switchingTrack:c}=this;if(!c&&this._streamEnded(l,a))return e.trigger(E.BUFFER_EOS,{type:"audio"}),void(this.state=Qr.ENDED);const d=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,Jt.MAIN),f=l.len,h=this.getMaxBufferLength(null==d?void 0:d.len),m=a.fragments,p=m[0].start;let g=this.flushing?this.getLoadPosition():l.end;if(c&&n){const e=this.getLoadPosition();u&&!Io(c.attrs,u.attrs)&&(g=e),a.PTSKnown&&e<p&&(l.end>p||l.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=p+.05)}if(f>=h&&!c&&g<m[m.length-1].start)return;let v=this.getNextFragment(g,a),b=!1;if(v&&this.isLoopLoading(v,g)&&(b=!!v.gap,v=this.getNextFragmentLoopLoading(v,a,l,Jt.MAIN,h)),!v)return void(this.bufferFlushed=!0);const y=d&&v.start>d.end+a.targetduration;if(y||(null==d||!d.len)&&l.len){const e=this.getAppendedFrag(v.start,Jt.MAIN);if(null===e)return;if(b||(b=!!e.gap||!!y&&0===d.len),y&&!b||b&&l.nextStart&&l.nextStart<e.end)return}this.loadFragment(v,o,g)}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}onMediaDetaching(){this.videoBuffer=null,this.bufferFlushed=this.flushing=!1,super.onMediaDetaching()}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(e=>new Dn(e))}onAudioTrackSwitching(e,t){const n=!!t.url;this.trackId=t.id;const{fragCurrent:r}=this;r&&(r.abortRequests(),this.removeUnbufferedFrags(r.start)),this.resetLoadingState(),n?this.setInterval(Mo):this.resetTransmuxer(),n?(this.switchingTrack=t,this.state=Qr.IDLE,this.flushAudioIfNeeded(t)):(this.switchingTrack=null,this.bufferedTrack=t,this.state=Qr.STOPPED),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=this.flushing=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(e,t){this.mainDetails=t.details,null!==this.cachedTrackLoadedData&&(this.hls.trigger(E.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,t){var n;if(null==this.mainDetails)return void(this.cachedTrackLoadedData=t);const{levels:r}=this,{details:i,id:o}=t;if(!r)return void this.warn("Audio tracks were reset while loading level "+o);this.log(`Audio track ${o} loaded [${i.startSN},${i.endSN}]${i.lastPartSn?`[part-${i.lastPartSn}-${i.lastPartIndex}]`:""},duration:${i.totalduration}`);const a=r[o];let s=0;if(i.live||null!=(n=a.details)&&n.live){this.checkLiveUpdate(i);const e=this.mainDetails;if(i.deltaUpdateFailed||!e)return;var l;if(!a.details&&i.hasProgramDateTime&&e.hasProgramDateTime)$r(i,e),s=i.fragments[0].start;else s=this.alignPlaylists(i,a.details,null==(l=this.levelLastLoaded)?void 0:l.details)}a.details=i,this.levelLastLoaded=a,this.startFragRequested||!this.mainDetails&&i.live||this.setStartPosition(this.mainDetails||i,s),this.state!==Qr.WAITING_TRACK||this.waitForCdnTuneIn(i)||(this.state=Qr.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:r,payload:i}=e,{config:o,trackId:a,levels:s}=this;if(!s)return void this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);const l=s[a];if(!l)return void this.warn("Audio track is undefined on fragment load progress");const u=l.details;if(!u)return this.warn("Audio track details undefined on fragment load progress"),void this.removeUnbufferedFrags(n.start);const c=o.defaultAudioCodec||l.audioCodec||"mp4a.40.2";let d=this.transmuxer;d||(d=this.transmuxer=new Oo(this.hls,Jt.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const f=this.initPTS[n.cc],h=null==(t=n.initSegment)?void 0:t.data;if(void 0!==f){const e=!1,t=r?r.index:-1,o=-1!==t,a=new Lr(n.level,n.sn,n.stats.chunkCount,i.byteLength,t,o);d.push(i,h,c,"",n,r,u.totalduration,e,a,f)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${u.startSN} ,${u.endSN}],track ${a}`);const{cache:e}=this.waitingData=this.waitingData||{frag:n,part:r,cache:new ei,complete:!1};e.push(new Uint8Array(i)),this.waitingVideoCC=this.videoTrackCC,this.state=Qr.WAITING_INIT_PTS}}_handleFragmentLoadComplete(e){this.waitingData?this.waitingData.complete=!0:super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,t){const n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}onFragBuffered(e,t){const{frag:n,part:r}=t;if(n.type===Jt.AUDIO)if(this.fragContextChanged(n))this.warn(`Fragment ${n.sn}${r?" p: "+r.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);else{if("initSegment"!==n.sn){this.fragPrevious=n;const e=this.switchingTrack;e&&(this.bufferedTrack=e,this.switchingTrack=null,this.hls.trigger(E.AUDIO_TRACK_SWITCHED,y({},e)))}this.fragBufferedComplete(n,r)}else if(!this.loadedmetadata&&n.type===Jt.MAIN){const e=this.videoBuffer||this.media;if(e){const t=Ar.getBuffered(e);t.length&&(this.loadedmetadata=!0)}}}onError(e,t){var n;if(t.fatal)this.state=Qr.ERROR;else switch(t.details){case A.FRAG_GAP:case A.FRAG_PARSING_ERROR:case A.FRAG_DECRYPT_ERROR:case A.FRAG_LOAD_ERROR:case A.FRAG_LOAD_TIMEOUT:case A.KEY_LOAD_ERROR:case A.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Jt.AUDIO,t);break;case A.AUDIO_TRACK_LOAD_ERROR:case A.AUDIO_TRACK_LOAD_TIMEOUT:case A.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==Qr.WAITING_TRACK||(null==(n=t.context)?void 0:n.type)!==Xt.AUDIO_TRACK||(this.state=Qr.IDLE);break;case A.BUFFER_APPEND_ERROR:case A.BUFFER_FULL_ERROR:if(!t.parent||"audio"!==t.parent)return;if(t.details===A.BUFFER_APPEND_ERROR)return void this.resetLoadingState();this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case A.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==j.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==j.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===Qr.ENDED&&(this.state=Qr.IDLE);const e=this.mediaBuffer||this.media;e&&(this.afterBufferFlushed(e,t,Jt.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const n="audio",{hls:r}=this,{remuxResult:i,chunkMeta:o}=e,a=this.getCurrentContext(o);if(!a)return void this.resetWhenMissingContext(o);const{frag:s,part:l,level:u}=a,{details:c}=u,{audio:d,text:f,id3:h,initSegment:m}=i;if(!this.fragContextChanged(s)&&c){if(this.state=Qr.PARSING,this.switchingTrack&&d&&this.completeAudioSwitch(this.switchingTrack),null!=m&&m.tracks){const e=s.initSegment||s;this._bufferInitSegment(u,m.tracks,e,o),r.trigger(E.FRAG_PARSING_INIT_SEGMENT,{frag:e,id:n,tracks:m.tracks})}if(d){const{startPTS:e,endPTS:t,startDTS:n,endDTS:r}=d;l&&(l.elementaryStreams[j.AUDIO]={startPTS:e,endPTS:t,startDTS:n,endDTS:r}),s.setElementaryStreamInfo(j.AUDIO,e,t,n,r),this.bufferFragmentData(d,s,l,o)}if(null!=h&&null!=(t=h.samples)&&t.length){const e=C({id:n,frag:s,details:c},h);r.trigger(E.FRAG_PARSING_METADATA,e)}if(f){const e=C({id:n,frag:s,details:c},f);r.trigger(E.FRAG_PARSING_USERDATA,e)}}else this.fragmentTracker.removeFragment(s)}_bufferInitSegment(e,t,n,r){if(this.state!==Qr.PARSING)return;t.video&&delete t.video;const i=t.audio;if(!i)return;i.id="audio";const o=e.audioCodec;this.log(`Init audio buffer, container:${i.container}, codecs[level/parsed]=[${o}/${i.codec}]`),o&&1===o.split(",").length&&(i.levelCodec=o),this.hls.trigger(E.BUFFER_CODECS,t);const a=i.initSegment;if(null!=a&&a.byteLength){const e={type:"audio",frag:n,part:null,chunkMeta:r,parent:n.type,data:a};this.hls.trigger(E.BUFFER_APPENDING,e)}this.tickImmediate()}loadFragment(e,t,n){const r=this.fragmentTracker.getState(e);var i;if(this.fragCurrent=e,this.switchingTrack||r===Tr.NOT_LOADED||r===Tr.PARTIAL)if("initSegment"===e.sn)this._loadInitSegment(e,t);else if(null!=(i=t.details)&&i.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=Qr.WAITING_INIT_PTS;const n=this.mainDetails;n&&n.fragments[0].start!==t.details.fragments[0].start&&$r(t.details,n)}else this.startFragRequested=!0,super.loadFragment(e,t,n);else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){const{media:t,bufferedTrack:n}=this,r=null==n?void 0:n.attrs,i=e.attrs;t&&r&&(r.CHANNELS!==i.CHANNELS||n.name!==e.name||n.lang!==e.lang)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null)}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(E.AUDIO_TRACK_SWITCHED,y({},e))}}class Fo extends nr{constructor(e){super(e,"[audio-track-controller]"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(E.MANIFEST_LOADING,this.onManifestLoading,this),e.on(E.MANIFEST_PARSED,this.onManifestParsed,this),e.on(E.LEVEL_LOADING,this.onLevelLoading,this),e.on(E.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(E.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(E.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(E.MANIFEST_LOADING,this.onManifestLoading,this),e.off(E.MANIFEST_PARSED,this.onManifestParsed,this),e.off(E.LEVEL_LOADING,this.onLevelLoading,this),e.off(E.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(E.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(E.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:n,groupId:r,details:i}=t,o=this.tracksInGroup[n];if(!o||o.groupId!==r)return void this.warn(`Audio track with id:${n} and group:${r} not found in active group ${null==o?void 0:o.groupId}`);const a=o.details;o.details=t.details,this.log(`Audio track ${n} "${o.name}" lang:${o.lang} group:${r} loaded [${i.startSN}-${i.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.audioGroups||null,r=this.groupIds;let i=this.currentTrack;if(!n||(null==r?void 0:r.length)!==(null==n?void 0:n.length)||null!=n&&n.some(e=>-1===(null==r?void 0:r.indexOf(e)))){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const e=this.tracks.filter(e=>!n||-1!==n.indexOf(e.groupId));if(e.length)this.selectDefaultTrack&&!e.some(e=>e.default)&&(this.selectDefaultTrack=!1),e.forEach((e,t)=>{e.id=t});else if(!i&&!this.tracksInGroup.length)return;this.tracksInGroup=e;const t=this.hls.config.audioPreference;if(!i&&t){const n=gr(t,e,yr);if(n>-1)i=e[n];else{const e=gr(t,this.tracks);i=this.tracks[e]}}let r=this.findTrackId(i);-1===r&&i&&(r=this.findTrackId(null));const a={audioTracks:e};this.log(`Updating audio tracks, ${e.length} track(s) found in group(s): ${null==n?void 0:n.join(",")}`),this.hls.trigger(E.AUDIO_TRACKS_UPDATED,a);const s=this.trackId;if(-1!==r&&-1===s)this.setAudioTrack(r);else if(e.length&&-1===s){var o;const t=new Error(`No audio track selected for current audio group-ID(s): ${null==(o=this.groupIds)?void 0:o.join(",")} track count: ${e.length}`);this.warn(t.message),this.hls.trigger(E.ERROR,{type:_.MEDIA_ERROR,details:A.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:t})}}else this.shouldReloadPlaylist(i)&&this.setAudioTrack(this.trackId)}onError(e,t){!t.fatal&&t.context&&(t.context.type!==Xt.AUDIO_TRACK||t.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(t.context.groupId)||(this.requestScheduled=-1,this.checkRetry(t)))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const n=this.allAudioTracks;if(this.selectDefaultTrack=!1,n.length){const r=this.currentTrack;if(r&&vr(e,r,yr))return r;const i=gr(e,this.tracksInGroup,yr);if(i>-1){const e=this.tracksInGroup[i];return this.setAudioTrack(i),e}if(r){let r=t.loadLevel;-1===r&&(r=t.firstAutoLevel);const i=wr(e,t.levels,n,r,yr);if(-1===i)return null;t.nextLoadLevel=i}if(e.channels||e.audioCodec){const t=gr(e,n);if(t>-1)return n[t]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length)return void this.warn("Invalid audio track id: "+e);this.clearTimer(),this.selectDefaultTrack=!1;const n=this.currentTrack,r=t[e],i=r.details&&!r.details.live;if(e===this.trackId&&r===n&&i)return;if(this.log(`Switching to audio-track ${e} "${r.name}" lang:${r.lang} group:${r.groupId} channels:${r.channels}`),this.trackId=e,this.currentTrack=r,this.hls.trigger(E.AUDIO_TRACK_SWITCHING,y({},r)),i)return;const o=this.switchParams(r.url,null==n?void 0:n.details,r.details);this.loadPlaylist(o)}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const r=t[n];if((!this.selectDefaultTrack||r.default)&&(!e||vr(e,r,yr)))return n}if(e){const{name:n,lang:r,assocLang:i,characteristics:o,audioCodec:a,channels:s}=e;for(let e=0;e<t.length;e++){const l=t[e];if(vr({name:n,lang:r,assocLang:i,characteristics:o,audioCodec:a,channels:s},l,yr))return e}for(let l=0;l<t.length;l++){const n=t[l];if(Io(e.attrs,n.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return l}for(let l=0;l<t.length;l++){const n=t[l];if(Io(e.attrs,n.attrs,["LANGUAGE"]))return l}}return-1}loadPlaylist(e){const t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){super.loadPlaylist();const r=t.id,i=t.groupId;let o=t.url;if(e)try{o=e.addDirectives(o)}catch(n){this.warn("Could not construct new URL with HLS Delivery Directives: "+n)}this.log(`loading audio-track playlist ${r} "${t.name}" lang:${t.lang} group:${i}`),this.clearTimer(),this.hls.trigger(E.AUDIO_TRACK_LOADING,{url:o,id:r,groupId:i,deliveryDirectives:e||null})}}}const Bo=500;class $o extends Zr{constructor(e,t,n){super(e,t,n,"[subtitle-stream-controller]",Jt.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}_registerListeners(){const{hls:e}=this;e.on(E.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(E.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(E.MANIFEST_LOADING,this.onManifestLoading,this),e.on(E.LEVEL_LOADED,this.onLevelLoaded,this),e.on(E.ERROR,this.onError,this),e.on(E.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(E.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(E.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(E.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(E.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(E.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(E.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(E.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(E.MANIFEST_LOADING,this.onManifestLoading,this),e.off(E.LEVEL_LOADED,this.onLevelLoaded,this),e.off(E.ERROR,this.onError,this),e.off(E.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(E.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(E.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(E.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(E.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(E.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state=Qr.IDLE,this.setInterval(Bo),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:n,success:r}=t;if(this.fragPrevious=n,this.state=Qr.IDLE,!r)return;const i=this.tracksBuffered[this.currentTrackId];if(!i)return;let o;const a=n.start;for(let l=0;l<i.length;l++)if(a>=i[l].start&&a<=i[l].end){o=i[l];break}const s=n.start+n.duration;o?o.end=s:(o={start:a,end:s},i.push(o)),this.fragmentTracker.fragBuffered(n),this.fragBufferedComplete(n,null)}onBufferFlushing(e,t){const{startOffset:n,endOffset:r}=t;if(0===n&&r!==Number.POSITIVE_INFINITY){const e=r-1;if(e<=0)return;t.endOffsetSubtitles=Math.max(0,e),this.tracksBuffered.forEach(t=>{for(let n=0;n<t.length;)if(t[n].end<=e)t.shift();else{if(!(t[n].start<e))break;t[n].start=e,n++}}),this.fragmentTracker.removeFragmentsInRange(n,e,Jt.SUBTITLE)}}onFragBuffered(e,t){var n;this.loadedmetadata||t.frag.type!==Jt.MAIN||null!=(n=this.media)&&n.buffered.length&&(this.loadedmetadata=!0)}onError(e,t){const n=t.frag;(null==n?void 0:n.type)===Jt.SUBTITLE&&(t.details===A.FRAG_GAP&&this.fragmentTracker.fragBuffered(n,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==Qr.STOPPED&&(this.state=Qr.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){this.levels&&Ro(this.levels,t)?this.levels=t.map(e=>new Dn(e)):(this.tracksBuffered=[],this.levels=t.map(e=>{const t=new Dn(e);return this.tracksBuffered[t.id]=[],t}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,Jt.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null)}onSubtitleTrackSwitch(e,t){var n;if(this.currentTrackId=t.id,null==(n=this.levels)||!n.length||-1===this.currentTrackId)return void this.clearInterval();const r=this.levels[this.currentTrackId];null!=r&&r.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,r&&this.setInterval(Bo)}onSubtitleTrackLoaded(e,t){var n;const{currentTrackId:r,levels:i}=this,{details:o,id:a}=t;if(!i)return void this.warn("Subtitle tracks were reset while loading level "+a);const s=i[a];if(a>=i.length||!s)return;this.log(`Subtitle track ${a} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""},duration:${o.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let l=0;if(o.live||null!=(n=s.details)&&n.live){const e=this.mainDetails;if(o.deltaUpdateFailed||!e)return;const t=e.fragments[0];var u;if(s.details)l=this.alignPlaylists(o,s.details,null==(u=this.levelLastLoaded)?void 0:u.details),0===l&&t&&(l=t.start,Pn(o,l));else o.hasProgramDateTime&&e.hasProgramDateTime?($r(o,e),l=o.fragments[0].start):t&&(l=t.start,Pn(o,l))}if(s.details=o,this.levelLastLoaded=s,a===r&&(this.startFragRequested||!this.mainDetails&&o.live||this.setStartPosition(this.mainDetails||o,l),this.tick(),o.live&&!this.fragCurrent&&this.media&&this.state===Qr.IDLE)){const e=Kn(null,o.fragments,this.media.currentTime,0);e||(this.warn("Subtitle playlist not aligned with playback"),s.details=void 0)}}_handleFragmentLoadComplete(e){const{frag:t,payload:n}=e,r=t.decryptdata,i=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&null!=r&&r.key&&r.iv&&"AES-128"===r.method){const e=performance.now();this.decrypter.decrypt(new Uint8Array(n),r.key.buffer,r.iv.buffer).catch(e=>{throw i.trigger(E.ERROR,{type:_.MEDIA_ERROR,details:A.FRAG_DECRYPT_ERROR,fatal:!1,error:e,reason:e.message,frag:t}),e}).then(n=>{const r=performance.now();i.trigger(E.FRAG_DECRYPTED,{frag:t,payload:n,stats:{tstart:e,tdecrypt:r}})}).catch(e=>{this.warn(`${e.name}: ${e.message}`),this.state=Qr.IDLE})}}doTick(){if(this.media){if(this.state===Qr.IDLE){const{currentTrackId:e,levels:t}=this,n=null==t?void 0:t[e];if(!n||!t.length||!n.details)return;const{config:r}=this,i=this.getLoadPosition(),o=Ar.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],i,r.maxBufferHole),{end:a,len:s}=o,l=this.getFwdBufferInfo(this.media,Jt.MAIN),u=n.details,c=this.getMaxBufferLength(null==l?void 0:l.len)+u.levelTargetDuration;if(s>c)return;const d=u.fragments,f=d.length,h=u.edge;let m=null;const p=this.fragPrevious;if(a<h){const e=r.maxFragLookUpTolerance,t=a>h-e?0:e;m=Kn(p,d,Math.max(d[0].start,a),t),!m&&p&&p.start<d[0].start&&(m=d[0])}else m=d[f-1];if(!m)return;if(m=this.mapToInitFragWhenRequired(m),"initSegment"!==m.sn){const e=m.sn-u.startSN,t=d[e-1];t&&t.cc===m.cc&&this.fragmentTracker.getState(t)===Tr.NOT_LOADED&&(m=t)}this.fragmentTracker.getState(m)===Tr.NOT_LOADED&&this.loadFragment(m,n,a)}}else this.state=Qr.IDLE}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.max(t,e):t}loadFragment(e,t,n){this.fragCurrent=e,"initSegment"===e.sn?this._loadInitSegment(e,t):(this.startFragRequested=!0,super.loadFragment(e,t,n))}get mediaBufferTimeRanges(){return new zo(this.tracksBuffered[this.currentTrackId]||[])}}class zo{constructor(e){this.buffered=void 0;const t=(t,n,r)=>{if(n>>>=0,n>r-1)throw new DOMException(`Failed to execute '${t}' on 'TimeRanges': The index provided (${n}) is greater than the maximum bound (${r})`);return e[n][t]};this.buffered={get length(){return e.length},end(n){return t("end",n,e.length)},start(n){return t("start",n,e.length)}}}}class Uo extends nr{constructor(e){super(e,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let e=null;const t=ln(this.media.textTracks);for(let r=0;r<t.length;r++)if("hidden"===t[r].mode)e=t[r];else if("showing"===t[r].mode){e=t[r];break}const n=this.findTrackForTextTrack(e);this.subtitleTrack!==n&&this.setSubtitleTrack(n)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(E.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(E.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(E.MANIFEST_LOADING,this.onManifestLoading,this),e.on(E.MANIFEST_PARSED,this.onManifestParsed,this),e.on(E.LEVEL_LOADING,this.onLevelLoading,this),e.on(E.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(E.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(E.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(E.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(E.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(E.MANIFEST_LOADING,this.onManifestLoading,this),e.off(E.MANIFEST_PARSED,this.onManifestParsed,this),e.off(E.LEVEL_LOADING,this.onLevelLoading,this),e.off(E.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(E.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(E.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId);const e=ln(this.media.textTracks);e.forEach(e=>{rn(e)}),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:n,groupId:r,details:i}=t,o=this.tracksInGroup[n];if(!o||o.groupId!==r)return void this.warn(`Subtitle track with id:${n} and group:${r} not found in active group ${null==o?void 0:o.groupId}`);const a=o.details;o.details=t.details,this.log(`Subtitle track ${n} "${o.name}" lang:${o.lang} group:${r} loaded [${i.startSN}-${i.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.subtitleGroups||null,r=this.groupIds;let i=this.currentTrack;if(!n||(null==r?void 0:r.length)!==(null==n?void 0:n.length)||null!=n&&n.some(e=>-1===(null==r?void 0:r.indexOf(e)))){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const e=this.tracks.filter(e=>!n||-1!==n.indexOf(e.groupId));if(e.length)this.selectDefaultTrack&&!e.some(e=>e.default)&&(this.selectDefaultTrack=!1),e.forEach((e,t)=>{e.id=t});else if(!i&&!this.tracksInGroup.length)return;this.tracksInGroup=e;const t=this.hls.config.subtitlePreference;if(!i&&t){this.selectDefaultTrack=!1;const n=gr(t,e);if(n>-1)i=e[n];else{const e=gr(t,this.tracks);i=this.tracks[e]}}let r=this.findTrackId(i);-1===r&&i&&(r=this.findTrackId(null));const o={subtitleTracks:e};this.log(`Updating subtitle tracks, ${e.length} track(s) found in "${null==n?void 0:n.join(",")}" group-id`),this.hls.trigger(E.SUBTITLE_TRACKS_UPDATED,o),-1!==r&&-1===this.trackId&&this.setSubtitleTrack(r)}else this.shouldReloadPlaylist(i)&&this.setSubtitleTrack(this.trackId)}findTrackId(e){const t=this.tracksInGroup,n=this.selectDefaultTrack;for(let r=0;r<t.length;r++){const i=t[r];if((!n||i.default)&&(n||e)&&(!e||vr(i,e)))return r}if(e){for(let n=0;n<t.length;n++){const r=t[n];if(Io(e.attrs,r.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return n}for(let n=0;n<t.length;n++){const r=t[n];if(Io(e.attrs,r.attrs,["LANGUAGE"]))return n}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const r=t[n];if(Po(r,e))return n}}return-1}onError(e,t){!t.fatal&&t.context&&(t.context.type!==Xt.SUBTITLE_TRACK||t.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(t.context.groupId)||this.checkRetry(t))}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const n=this.currentTrack;if(n&&vr(e,n))return n;const r=gr(e,this.tracksInGroup);if(r>-1){const e=this.tracksInGroup[r];return this.setSubtitleTrack(r),e}if(n)return null;{const n=gr(e,t);if(n>-1)return t[n]}}}return null}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){const r=t.id,i=t.groupId;let o=t.url;if(e)try{o=e.addDirectives(o)}catch(n){this.warn("Could not construct new URL with HLS Delivery Directives: "+n)}this.log("Loading subtitle playlist for id "+r),this.hls.trigger(E.SUBTITLE_TRACK_LOADING,{url:o,id:r,groupId:i,deliveryDirectives:e||null})}}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=ln(e.textTracks),n=this.currentTrack;let r;if(n&&(r=t.filter(e=>Po(n,e))[0],r||this.warn(`Unable to find subtitle TextTrack with name "${n.name}" and language "${n.lang}"`)),[].slice.call(t).forEach(e=>{"disabled"!==e.mode&&e!==r&&(e.mode="disabled")}),r){const e=this.subtitleDisplay?"showing":"hidden";r.mode!==e&&(r.mode=e)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media)return void(this.queuedDefaultTrack=e);if(e<-1||e>=t.length||!T(e))return void this.warn("Invalid subtitle track id: "+e);this.clearTimer(),this.selectDefaultTrack=!1;const n=this.currentTrack,r=t[e]||null;if(this.trackId=e,this.currentTrack=r,this.toggleTrackModes(),!r)return void this.hls.trigger(E.SUBTITLE_TRACK_SWITCH,{id:e});const i=!!r.details&&!r.details.live;if(e===this.trackId&&r===n&&i)return;this.log("Switching to subtitle-track "+e+(r?` "${r.name}" lang:${r.lang} group:${r.groupId}`:""));const{id:o,groupId:a="",name:s,type:l,url:u}=r;this.hls.trigger(E.SUBTITLE_TRACK_SWITCH,{id:o,groupId:a,name:s,type:l,url:u});const c=this.switchParams(r.url,null==n?void 0:n.details,r.details);this.loadPlaylist(c)}}class Vo{constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}append(e,t,n){const r=this.queues[t];r.push(e),1!==r.length||n||this.executeNext(t)}insertAbort(e,t){const n=this.queues[t];n.unshift(e),this.executeNext(t)}appendBlocker(e){let t;const n=new Promise(e=>{t=e}),r={execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(r,e),n}executeNext(e){const t=this.queues[e];if(t.length){const r=t[0];try{r.execute()}catch(n){N.warn(`[buffer-operation-queue]: Exception executing "${e}" SourceBuffer operation: ${n}`),r.onError(n);const t=this.buffers[e];null!=t&&t.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}}const Ho=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/;class jo{constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendSource=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this.log=void 0,this.warn=void 0,this.error=void 0,this._onEndStreaming=e=>{this.hls&&this.hls.pauseBuffering()},this._onStartStreaming=e=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=()=>{const{media:e,mediaSource:t}=this;this.log("Media source opened"),e&&(e.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(E.MEDIA_ATTACHED,{media:e,mediaSource:t})),t&&t.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:e,_objectUrl:t}=this;e!==t&&N.error(`Media element src was set while attaching MediaSource (${t} > ${e})`)},this.hls=e;const t="[buffer-controller]";this.appendSource=xt(St(e.config.preferManagedMediaSource)),this.log=N.log.bind(N,t),this.warn=N.warn.bind(N,t),this.error=N.error.bind(N,t),this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null,this.hls=null}registerListeners(){const{hls:e}=this;e.on(E.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(E.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(E.MANIFEST_LOADING,this.onManifestLoading,this),e.on(E.MANIFEST_PARSED,this.onManifestParsed,this),e.on(E.BUFFER_RESET,this.onBufferReset,this),e.on(E.BUFFER_APPENDING,this.onBufferAppending,this),e.on(E.BUFFER_CODECS,this.onBufferCodecs,this),e.on(E.BUFFER_EOS,this.onBufferEos,this),e.on(E.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(E.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(E.FRAG_PARSED,this.onFragParsed,this),e.on(E.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:e}=this;e.off(E.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(E.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(E.MANIFEST_LOADING,this.onManifestLoading,this),e.off(E.MANIFEST_PARSED,this.onManifestParsed,this),e.off(E.BUFFER_RESET,this.onBufferReset,this),e.off(E.BUFFER_APPENDING,this.onBufferAppending,this),e.off(E.BUFFER_CODECS,this.onBufferCodecs,this),e.off(E.BUFFER_EOS,this.onBufferEos,this),e.off(E.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(E.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(E.FRAG_PARSED,this.onFragParsed,this),e.off(E.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new Vo(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.appendErrors={audio:0,video:0,audiovideo:0},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){let n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=n,this.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")}onMediaAttaching(e,t){const n=this.media=t.media,r=St(this.appendSource);if(n&&r){var i;const e=this.mediaSource=new r;this.log("created media source: "+(null==(i=e.constructor)?void 0:i.name)),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming));const t=this._objectUrl=self.URL.createObjectURL(e);if(this.appendSource)try{n.removeAttribute("src");const r=self.ManagedMediaSource;n.disableRemotePlayback=n.disableRemotePlayback||r&&e instanceof r,qo(n),Go(n,t),n.load()}catch(o){n.src=t}else n.src=t;n.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:e,mediaSource:t,_objectUrl:n}=this;if(t){if(this.log("media source detaching"),"open"===t.readyState)try{t.endOfStream()}catch(Gl){this.warn(`onMediaDetaching: ${Gl.message} while calling endOfStream`)}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(t.removeEventListener("startstreaming",this._onStartStreaming),t.removeEventListener("endstreaming",this._onEndStreaming)),e&&(e.removeEventListener("emptied",this._onMediaEmptied),n&&self.URL.revokeObjectURL(n),this.mediaSrc===n?(e.removeAttribute("src"),this.appendSource&&qo(e),e.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(E.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(e=>{this.resetBuffer(e)}),this._initSourceBuffer()}resetBuffer(e){const t=this.sourceBuffer[e];try{var n;if(t)this.removeBufferListeners(e),this.sourceBuffer[e]=void 0,null!=(n=this.mediaSource)&&n.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(t)}catch(Gl){this.warn("onBufferReset "+e,Gl)}}onBufferCodecs(e,t){const n=this.getSourceBufferTypes().length,r=Object.keys(t);if(r.forEach(e=>{if(n){const n=this.tracks[e];if(n&&"function"===typeof n.buffer.changeType){var r;const{id:i,codec:o,levelCodec:a,container:s,metadata:l}=t[e],u=Pt(n.codec,n.levelCodec),c=null==u?void 0:u.replace(Ho,"$1");let d=Pt(o,a);const f=null==(r=d)?void 0:r.replace(Ho,"$1");if(d&&c!==f){"audio"===e.slice(0,5)&&(d=It(d,this.appendSource));const t=`${s};codecs=${d}`;this.appendChangeType(e,t),this.log(`switching codec ${u} to ${d}`),this.tracks[e]={buffer:n.buffer,codec:o,container:s,levelCodec:a,metadata:l,id:i}}}}else this.pendingTracks[e]=t[e]}),n)return;const i=Math.max(this.bufferCodecEventsExpected-1,0);this.bufferCodecEventsExpected!==i&&(this.log(`${i} bufferCodec event(s) expected ${r.join(",")}`),this.bufferCodecEventsExpected=i),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks()}appendChangeType(e,t){const{operationQueue:n}=this,r={execute:()=>{const r=this.sourceBuffer[e];r&&(this.log(`changing ${e} sourceBuffer type to ${t}`),r.changeType(t)),n.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:t=>{this.warn(`Failed to change ${e} SourceBuffer type`,t)}};n.append(r,e,!!this.pendingTracks[e])}onBufferAppending(e,t){const{hls:n,operationQueue:r,tracks:i}=this,{data:o,type:a,frag:s,part:l,chunkMeta:u}=t,c=u.buffering[a],d=self.performance.now();c.start=d;const f=s.stats.buffering,h=l?l.stats.buffering:null;0===f.start&&(f.start=d),h&&0===h.start&&(h.start=d);const m=i.audio;let p=!1;"audio"===a&&"audio/mpeg"===(null==m?void 0:m.container)&&(p=!this.lastMpegAudioChunk||1===u.id||this.lastMpegAudioChunk.sn!==u.sn,this.lastMpegAudioChunk=u);const g=s.start,v={execute:()=>{if(c.executeStart=self.performance.now(),p){const e=this.sourceBuffer[a];if(e){const t=g-e.timestampOffset;Math.abs(t)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${g} (delta: ${t}) sn: ${s.sn})`),e.timestampOffset=g)}}this.appendExecutor(o,a)},onStart:()=>{},onComplete:()=>{const e=self.performance.now();c.executeEnd=c.end=e,0===f.first&&(f.first=e),h&&0===h.first&&(h.first=e);const{sourceBuffer:t}=this,n={};for(const r in t)n[r]=Ar.getBuffered(t[r]);this.appendErrors[a]=0,"audio"===a||"video"===a?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(E.BUFFER_APPENDED,{type:a,frag:s,part:l,chunkMeta:u,parent:s.type,timeRanges:n})},onError:e=>{const t={type:_.MEDIA_ERROR,parent:s.type,details:A.BUFFER_APPEND_ERROR,sourceBufferName:a,frag:s,part:l,chunkMeta:u,error:e,err:e,fatal:!1};if(e.code===DOMException.QUOTA_EXCEEDED_ERR)t.details=A.BUFFER_FULL_ERROR;else{const e=++this.appendErrors[a];t.details=A.BUFFER_APPEND_ERROR,this.warn(`Failed ${e}/${n.config.appendErrorMaxRetry} times to append segment in "${a}" sourceBuffer`),e>=n.config.appendErrorMaxRetry&&(t.fatal=!0)}n.trigger(E.ERROR,t)}};r.append(v,a,!!this.pendingTracks[a])}onBufferFlushing(e,t){const{operationQueue:n}=this,r=e=>({execute:this.removeExecutor.bind(this,e,t.startOffset,t.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(E.BUFFER_FLUSHED,{type:e})},onError:t=>{this.warn(`Failed to remove from ${e} SourceBuffer`,t)}});t.type?n.append(r(t.type),t.type):this.getSourceBufferTypes().forEach(e=>{n.append(r(e),e)})}onFragParsed(e,t){const{frag:n,part:r}=t,i=[],o=r?r.elementaryStreams:n.elementaryStreams;o[j.AUDIOVIDEO]?i.push("audiovideo"):(o[j.AUDIO]&&i.push("audio"),o[j.VIDEO]&&i.push("video"));const a=()=>{const e=self.performance.now();n.stats.buffering.end=e,r&&(r.stats.buffering.end=e);const t=r?r.stats:n.stats;this.hls.trigger(E.FRAG_BUFFERED,{frag:n,part:r,stats:t,id:n.type})};0===i.length&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers(a,i)}onFragChanged(e,t){this.trimBuffers()}onBufferEos(e,t){const n=this.getSourceBufferTypes().reduce((e,n)=>{const r=this.sourceBuffer[n];return!r||t.type&&t.type!==n||(r.ending=!0,r.ended||(r.ended=!0,this.log(n+" sourceBuffer now EOS"))),e&&!(r&&!r.ended)},!0);n&&(this.log("Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(e=>{const t=this.sourceBuffer[e];t&&(t.ending=!1)});const{mediaSource:e}=this;e&&"open"===e.readyState?(this.log("Calling mediaSource.endOfStream()"),e.endOfStream()):e&&this.log("Could not call mediaSource.endOfStream(). mediaSource.readyState: "+e.readyState)}))}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}trimBuffers(){const{hls:e,details:t,media:n}=this;if(!n||null===t)return;const r=this.getSourceBufferTypes();if(!r.length)return;const i=e.config,o=n.currentTime,a=t.levelTargetDuration,s=t.live&&null!==i.liveBackBufferLength?i.liveBackBufferLength:i.backBufferLength;if(T(s)&&s>0){const e=Math.max(s,a),t=Math.floor(o/a)*a-e;this.flushBackBuffer(o,a,t)}if(T(i.frontBufferFlushThreshold)&&i.frontBufferFlushThreshold>0){const e=Math.max(i.maxBufferLength,i.frontBufferFlushThreshold),t=Math.max(e,a),n=Math.floor(o/a)*a+t;this.flushFrontBuffer(o,a,n)}}flushBackBuffer(e,t,n){const{details:r,sourceBuffer:i}=this,o=this.getSourceBufferTypes();o.forEach(o=>{const a=i[o];if(a){const i=Ar.getBuffered(a);if(i.length>0&&n>i.start(0)){if(this.hls.trigger(E.BACK_BUFFER_REACHED,{bufferEnd:n}),null!=r&&r.live)this.hls.trigger(E.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n});else if(a.ended&&i.end(i.length-1)-e<2*t)return void this.log(`Cannot flush ${o} back buffer while SourceBuffer is in ended state`);this.hls.trigger(E.BUFFER_FLUSHING,{startOffset:0,endOffset:n,type:o})}}})}flushFrontBuffer(e,t,n){const{sourceBuffer:r}=this,i=this.getSourceBufferTypes();i.forEach(i=>{const o=r[i];if(o){const r=Ar.getBuffered(o),a=r.length;if(a<2)return;const s=r.start(a-1),l=r.end(a-1);if(n>s||e>=s&&e<=l)return;if(o.ended&&e-l<2*t)return void this.log(`Cannot flush ${i} front buffer while SourceBuffer is in ended state`);this.hls.trigger(E.BUFFER_FLUSHING,{startOffset:s,endOffset:1/0,type:i})}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||"open"!==this.mediaSource.readyState)return;const{details:e,hls:t,media:n,mediaSource:r}=this,i=e.fragments[0].start+e.totalduration,o=n.duration,a=T(r.duration)?r.duration:0;e.live&&t.config.liveDurationInfinity?(r.duration=1/0,this.updateSeekableRange(e)):(i>a&&i>o||!T(o))&&(this.log("Updating Media Source duration to "+i.toFixed(3)),r.duration=i)}updateSeekableRange(e){const t=this.mediaSource,n=e.fragments,r=n.length;if(r&&e.live&&null!=t&&t.setLiveSeekableRange){const r=Math.max(0,n[0].start),i=Math.max(r,r+e.totalduration);this.log(`Media Source duration is set to ${t.duration}. Setting seekable range to ${r}-${i}.`),t.setLiveSeekableRange(r,i)}}checkPendingTracks(){const{bufferCodecEventsExpected:e,operationQueue:t,pendingTracks:n}=this,r=Object.keys(n).length;if(r&&(!e||2===r||"audiovideo"in n)){this.createSourceBuffers(n),this.pendingTracks={};const e=this.getSourceBufferTypes();if(e.length)this.hls.trigger(E.BUFFER_CREATED,{tracks:this.tracks}),e.forEach(e=>{t.executeNext(e)});else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(E.ERROR,{type:_.MEDIA_ERROR,details:A.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}}createSourceBuffers(e){const{sourceBuffer:t,mediaSource:n}=this;if(!n)throw Error("createSourceBuffers called when mediaSource was null");for(const i in e)if(!t[i]){var r;const o=e[i];if(!o)throw Error(`source buffer exists for track ${i}, however track does not`);let a=-1===(null==(r=o.levelCodec)?void 0:r.indexOf(","))?o.levelCodec:o.codec;a&&"audio"===i.slice(0,5)&&(a=It(a,this.appendSource));const s=`${o.container};codecs=${a}`;this.log(`creating sourceBuffer(${s})`);try{const e=t[i]=n.addSourceBuffer(s),r=i;this.addBufferListener(r,"updatestart",this._onSBUpdateStart),this.addBufferListener(r,"updateend",this._onSBUpdateEnd),this.addBufferListener(r,"error",this._onSBUpdateError),this.appendSource&&this.addBufferListener(r,"bufferedchange",(e,t)=>{const n=t.removedRanges;null!=n&&n.length&&this.hls.trigger(E.BUFFER_FLUSHED,{type:i})}),this.tracks[i]={buffer:e,codec:a,container:o.container,levelCodec:o.levelCodec,metadata:o.metadata,id:o.id}}catch(Gl){this.error("error while trying to add sourceBuffer: "+Gl.message),this.hls.trigger(E.ERROR,{type:_.MEDIA_ERROR,details:A.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:Gl,sourceBufferName:i,mimeType:s})}}}get mediaSrc(){var e,t;const n=(null==(e=this.media)||null==(t=e.querySelector)?void 0:t.call(e,"source"))||this.media;return null==n?void 0:n.src}_onSBUpdateStart(e){const{operationQueue:t}=this,n=t.current(e);n.onStart()}_onSBUpdateEnd(e){var t;if("closed"===(null==(t=this.mediaSource)?void 0:t.readyState))return void this.resetBuffer(e);const{operationQueue:n}=this,r=n.current(e);r.onComplete(),n.shiftAndExecuteNext(e)}_onSBUpdateError(e,t){var n;const r=new Error(`${e} SourceBuffer error. MediaSource readyState: ${null==(n=this.mediaSource)?void 0:n.readyState}`);this.error(""+r,t),this.hls.trigger(E.ERROR,{type:_.MEDIA_ERROR,details:A.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:r,fatal:!1});const i=this.operationQueue.current(e);i&&i.onError(r)}removeExecutor(e,t,n){const{media:r,mediaSource:i,operationQueue:o,sourceBuffer:a}=this,s=a[e];if(!r||!i||!s)return this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),void o.shiftAndExecuteNext(e);const l=T(r.duration)?r.duration:1/0,u=T(i.duration)?i.duration:1/0,c=Math.max(0,t),d=Math.min(n,l,u);d>c&&(!s.ending||s.ended)?(s.ended=!1,this.log(`Removing [${c},${d}] from the ${e} SourceBuffer`),s.remove(c,d)):o.shiftAndExecuteNext(e)}appendExecutor(e,t){const n=this.sourceBuffer[t];if(n)n.ended=!1,n.appendBuffer(e);else if(!this.pendingTracks[t])throw new Error(`Attempting to append to the ${t} SourceBuffer, but it does not exist`)}blockBuffers(e,t=this.getSourceBufferTypes()){if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),void Promise.resolve().then(e);const{operationQueue:n}=this,r=t.map(e=>n.appendBlocker(e));Promise.all(r).then(()=>{e(),t.forEach(e=>{const t=this.sourceBuffer[e];null!=t&&t.updating||n.shiftAndExecuteNext(e)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,t,n){const r=this.sourceBuffer[e];if(!r)return;const i=n.bind(this,e);this.listeners[e].push({event:t,listener:i}),r.addEventListener(t,i)}removeBufferListeners(e){const t=this.sourceBuffer[e];t&&this.listeners[e].forEach(e=>{t.removeEventListener(e.event,e.listener)})}}function qo(e){const t=e.querySelectorAll("source");[].slice.call(t).forEach(t=>{e.removeChild(t)})}function Go(e,t){const n=self.document.createElement("source");n.type="video/mp4",n.src=t,e.appendChild(n)}const Wo={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},Ko=e=>String.fromCharCode(Wo[e]||e),Yo=15,Xo=100,Jo={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},Qo={17:2,18:4,21:6,22:8,23:10,19:13,20:15},Zo={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},ea={25:2,26:4,29:6,30:8,31:10,27:13,28:15},ta=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class na{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const n="function"===typeof t?t():t;N.log(`${this.time} [${e}] ${n}`)}}}const ra=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t};class ia{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let n=0;n<t.length;n++){const r=t[n];e.hasOwnProperty(r)&&(this[r]=e[r])}}isDefault(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class oa{constructor(){this.uchar=" ",this.penState=new ia}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return" "===this.uchar&&this.penState.isDefault()}}class aa{constructor(e){this.chars=[],this.pos=0,this.currPenState=new ia,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<Xo;t++)this.chars.push(new oa);this.logger=e}equals(e){for(let t=0;t<Xo;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<Xo;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<Xo;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Xo&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Xo)}moveCursor(e){const t=this.pos+e;if(e>1)for(let n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=Ko(e);this.pos>=Xo?this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))}clearFromPos(e){let t;for(t=e;t<Xo;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let n=0;n<Xo;n++){const r=this.chars[n].uchar;" "!==r&&(t=!1),e.push(r)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e);const t=this.chars[this.pos];t.setPenState(this.currPenState)}}class sa{constructor(e){this.rows=[],this.currRow=Yo-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<Yo;t++)this.rows.push(new aa(e));this.logger=e}reset(){for(let e=0;e<Yo;e++)this.rows[e].clear();this.currRow=Yo-1}equals(e){let t=!0;for(let n=0;n<Yo;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<Yo;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<Yo;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){const e=this.rows[this.currRow];e.backSpace()}clearToEndOfRow(){const e=this.rows[this.currRow];e.clearToEndOfRow()}insertChar(e){const t=this.rows[this.currRow];t.insertChar(e)}setPen(e){const t=this.rows[this.currRow];t.setPenStyles(e)}moveCursor(e){const t=this.rows[this.currRow];t.moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e);const t=this.rows[this.currRow];t.setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+JSON.stringify(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let t=0;t<Yo;t++)this.rows[t].clear();const e=this.currRow+1-this.nrRollUpRows,n=this.lastOutputScreen;if(n){const r=n.rows[e].cueStartTime,i=this.logger.time;if(null!==r&&null!==i&&r<i)for(let o=0;o<this.nrRollUpRows;o++)this.rows[t-this.nrRollUpRows+o+1].copy(n.rows[e+o])}}this.currRow=t;const n=this.rows[this.currRow];if(null!==e.indent){const t=e.indent,r=Math.max(t-1,0);n.setCursor(e.indent),e.color=n.chars[r].penState.foreground}const r={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(r)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(null===this.nrRollUpRows)return void this.logger.log(3,"roll_up but nrRollUpRows not set yet");this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let n="",r=-1;for(let i=0;i<Yo;i++){const n=this.rows[i].getTextString();n&&(r=i+1,e?t.push("Row "+r+": '"+n+"'"):t.push(n.trim()))}return t.length>0&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n}getTextAndFormat(){return this.rows}}class la{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new sa(n),this.nonDisplayedMemory=new sa(n),this.lastOutputScreen=new sa(n),this.currRollUpRow=this.displayedMemory.rows[Yo-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[Yo-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let n=0;n<e.length;n++)this.writeScreen.insertChar(e[n]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const n=Math.floor(e/2)-16,r=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=r[n]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class ua{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=fa(),this.logger=void 0;const r=this.logger=new na;this.channels=[null,new la(e,t,r),new la(e+1,n,r)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let n=0;n<t.length;n+=2){const e=127&t[n],r=127&t[n+1];let i=!1,o=null;if(0===e&&0===r)continue;this.logger.log(3,()=>"["+ra([t[n],t[n+1]])+"] -> ("+ra([e,r])+")");const a=this.cmdHistory,s=e>=16&&e<=31;if(s){if(da(e,r,a)){ca(null,null,a),this.logger.log(3,()=>"Repeated command ("+ra([e,r])+") is dropped");continue}ca(e,r,this.cmdHistory),i=this.parseCmd(e,r),i||(i=this.parseMidrow(e,r)),i||(i=this.parsePAC(e,r)),i||(i=this.parseBackgroundAttributes(e,r))}else ca(null,null,a);if(!i&&(o=this.parseChars(e,r),o)){const e=this.currentChannel;if(e&&e>0){const t=this.channels[e];t.insertChars(o)}else this.logger.log(2,"No channel found yet. TEXT-MODE?")}i||o||this.logger.log(2,()=>"Couldn't parse cleaned data "+ra([e,r])+" orig: "+ra([t[n],t[n+1]]))}}parseCmd(e,t){const n=(20===e||28===e||21===e||29===e)&&t>=32&&t<=47,r=(23===e||31===e)&&t>=33&&t<=35;if(!n&&!r)return!1;const i=20===e||21===e||23===e?1:2,o=this.channels[i];return 20===e||21===e||28===e||29===e?32===t?o.ccRCL():33===t?o.ccBS():34===t?o.ccAOF():35===t?o.ccAON():36===t?o.ccDER():37===t?o.ccRU(2):38===t?o.ccRU(3):39===t?o.ccRU(4):40===t?o.ccFON():41===t?o.ccRDC():42===t?o.ccTR():43===t?o.ccRTD():44===t?o.ccEDM():45===t?o.ccCR():46===t?o.ccENM():47===t&&o.ccEOC():o.ccTO(t-32),this.currentChannel=i,!0}parseMidrow(e,t){let n=0;if((17===e||25===e)&&t>=32&&t<=47){if(n=17===e?1:2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const r=this.channels[n];return!!r&&(r.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+ra([e,t])+")"),!0)}return!1}parsePAC(e,t){let n;const r=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,i=(16===e||24===e)&&t>=64&&t<=95;if(!r&&!i)return!1;const o=e<=23?1:2;n=t>=64&&t<=95?1===o?Jo[e]:Zo[e]:1===o?Qo[e]:ea[e];const a=this.channels[o];return!!a&&(a.setPAC(this.interpretPAC(n,t)),this.currentChannel=o,!0)}interpretPAC(e,t){let n;const r={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,r.underline=1===(1&n),n<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(r.italics=!0,r.color="white"):r.indent=4*Math.floor((n-16)/2),r}parseChars(e,t){let n,r=null,i=null;if(e>=25?(n=2,i=e-8):(n=1,i=e),i>=17&&i<=19){let e;e=17===i?t+80:18===i?t+112:t+144,this.logger.log(2,()=>"Special char '"+Ko(e)+"' in channel "+n),r=[e]}else e>=32&&e<=127&&(r=0===t?[e]:[e,t]);return r&&this.logger.log(3,()=>"Char codes =  "+ra(r).join(",")),r}parseBackgroundAttributes(e,t){const n=(16===e||24===e)&&t>=32&&t<=47,r=(23===e||31===e)&&t>=45&&t<=47;if(!n&&!r)return!1;let i;const o={};16===e||24===e?(i=Math.floor((t-32)/2),o.background=ta[i],t%2===1&&(o.background=o.background+"_semi")):45===t?o.background="transparent":(o.foreground="black",47===t&&(o.underline=!0));const a=e<=23?1:2,s=this.channels[a];return s.setBkgData(o),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}ca(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const n=this.channels[t];n&&n.cueSplitAtTime(e)}}}function ca(e,t,n){n.a=e,n.b=t}function da(e,t,n){return n.a===e&&n.b===t}function fa(){return{a:null,b:null}}class ha{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var ma=function(){if(null!=te&&te.VTTCue)return self.VTTCue;const e=["","lr","rl"],t=["start","middle","end","left","right"];function n(e,t){if("string"!==typeof t)return!1;if(!Array.isArray(e))return!1;const n=t.toLowerCase();return!!~e.indexOf(n)&&n}function r(t){return n(e,t)}function i(e){return n(t,e)}function o(e,...t){let n=1;for(;n<arguments.length;n++){const t=arguments[n];for(const n in t)e[n]=t[n]}return e}function a(e,t,n){const a=this,s={enumerable:!0};a.hasBeenReset=!1;let l="",u=!1,c=e,d=t,f=n,h=null,m="",p=!0,g="auto",v="start",b=50,y="middle",w=50,S="middle";Object.defineProperty(a,"id",o({},s,{get:function(){return l},set:function(e){l=""+e}})),Object.defineProperty(a,"pauseOnExit",o({},s,{get:function(){return u},set:function(e){u=!!e}})),Object.defineProperty(a,"startTime",o({},s,{get:function(){return c},set:function(e){if("number"!==typeof e)throw new TypeError("Start time must be set to a number.");c=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"endTime",o({},s,{get:function(){return d},set:function(e){if("number"!==typeof e)throw new TypeError("End time must be set to a number.");d=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"text",o({},s,{get:function(){return f},set:function(e){f=""+e,this.hasBeenReset=!0}})),Object.defineProperty(a,"region",o({},s,{get:function(){return h},set:function(e){h=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"vertical",o({},s,{get:function(){return m},set:function(e){const t=r(e);if(!1===t)throw new SyntaxError("An invalid or illegal string was specified.");m=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"snapToLines",o({},s,{get:function(){return p},set:function(e){p=!!e,this.hasBeenReset=!0}})),Object.defineProperty(a,"line",o({},s,{get:function(){return g},set:function(e){if("number"!==typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");g=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"lineAlign",o({},s,{get:function(){return v},set:function(e){const t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"position",o({},s,{get:function(){return b},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");b=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"positionAlign",o({},s,{get:function(){return y},set:function(e){const t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");y=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"size",o({},s,{get:function(){return w},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");w=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"align",o({},s,{get:function(){return S},set:function(e){const t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");S=t,this.hasBeenReset=!0}})),a.displayState=void 0}return a.prototype.getCueAsHTML=function(){const e=self.WebVTT;return e.convertCueToDOMTree(self,this.text)},a}();class pa{decode(e,t){if(!e)return"";if("string"!==typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function ga(e){function t(e,t,n,r){return 3600*(0|e)+60*(0|t)+(0|n)+parseFloat(r||0)}const n=e.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return n?parseFloat(n[2])>59?t(n[2],n[3],0,n[4]):t(n[1],n[2],n[3],n[4]):null}class va{constructor(){this.values=Object.create(null)}set(e,t){this.get(e)||""===t||(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let r=0;r<n.length;++r)if(t===n[r]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}}function ba(e,t,n,r){const i=r?e.split(r):[e];for(const o in i){if("string"!==typeof i[o])continue;const e=i[o].split(n);if(2!==e.length)continue;const r=e[0],a=e[1];t(r,a)}}const ya=new ma(0,0,""),wa="middle"===ya.align?"middle":"center";function Sa(e,t,n){const r=e;function i(){const t=ga(e);if(null===t)throw new Error("Malformed timestamp: "+r);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function o(e,t){const r=new va;ba(e,(function(e,t){let i;switch(e){case"region":for(let i=n.length-1;i>=0;i--)if(n[i].id===t){r.set(e,n[i].region);break}break;case"vertical":r.alt(e,t,["rl","lr"]);break;case"line":i=t.split(","),r.integer(e,i[0]),r.percent(e,i[0])&&r.set("snapToLines",!1),r.alt(e,i[0],["auto"]),2===i.length&&r.alt("lineAlign",i[1],["start",wa,"end"]);break;case"position":i=t.split(","),r.percent(e,i[0]),2===i.length&&r.alt("positionAlign",i[1],["start",wa,"end","line-left","line-right","auto"]);break;case"size":r.percent(e,t);break;case"align":r.alt(e,t,["start",wa,"end","left","right"]);break}}),/:/,/\s/),t.region=r.get("region",null),t.vertical=r.get("vertical","");let i=r.get("line","auto");"auto"===i&&-1===ya.line&&(i=-1),t.line=i,t.lineAlign=r.get("lineAlign","start"),t.snapToLines=r.get("snapToLines",!0),t.size=r.get("size",100),t.align=r.get("align",wa);let o=r.get("position","auto");"auto"===o&&50===ya.position&&(o="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=o}function a(){e=e.replace(/^\s+/,"")}if(a(),t.startTime=i(),a(),"--\x3e"!==e.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+r);e=e.slice(3),a(),t.endTime=i(),a(),o(e,t)}function xa(e){return e.replace(/<br(?: \/)?>/gi,"\n")}class Ca{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new pa,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;function n(){let e=t.buffer,n=0;e=xa(e);while(n<e.length&&"\r"!==e[n]&&"\n"!==e[n])++n;const r=e.slice(0,n);return"\r"===e[n]&&++n,"\n"===e[n]&&++n,t.buffer=e.slice(n),r}function r(e){ba(e,(function(e,t){}),/:/)}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{let e="";if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;e=n();const r=e.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(null==r||!r[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let o=!1;while(t.buffer){if(!/\r\n|\n/.test(t.buffer))return this;switch(o?o=!1:e=n(),t.state){case"HEADER":/:/.test(e)?r(e):e||(t.state="ID");continue;case"NOTE":e||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(e)){t.state="NOTE";break}if(!e)continue;if(t.cue=new ma(0,0,""),t.state="CUE",-1===e.indexOf("--\x3e")){t.cue.id=e;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{Sa(e,t.cue,t.regionList)}catch(i){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const n=-1!==e.indexOf("--\x3e");if(!e||n&&(o=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(null===t.cue)continue;t.cue.text&&(t.cue.text+="\n"),t.cue.text+=e}continue;case"BADCUE":e||(t.state="ID")}}}catch(i){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state||"BADWEBVTT"===e.state)throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const Ta=/\r\n|\n\r|\n|\r/g,Da=function(e,t,n=0){return e.slice(n,n+t.length)===t},ka=function(e){let t=parseInt(e.slice(-3));const n=parseInt(e.slice(-6,-4)),r=parseInt(e.slice(-9,-7)),i=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!T(t)||!T(n)||!T(r)||!T(i))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+e);return t+=1e3*n,t+=6e4*r,t+=36e5*i,t},Ea=function(e){let t=5381,n=e.length;while(n)t=33*t^e.charCodeAt(--n);return(t>>>0).toString()};function _a(e,t,n){return Ea(e.toString())+Ea(t.toString())+Ea(n)}const Aa=function(e,t,n){let r=e[t],i=e[r.prevCC];if(!i||!i.new&&r.new)return e.ccOffset=e.presentationOffset=r.start,void(r.new=!1);while(null!=(o=i)&&o.new){var o;e.ccOffset+=r.start-i.start,r.new=!1,r=i,i=e[r.prevCC]}e.presentationOffset=n};function La(e,t,n,r,i,o,a){const s=new Ca,l=Ee(new Uint8Array(e)).trim().replace(Ta,"\n").split("\n"),u=[],c=t?ro(t.baseTime,t.timescale):0;let d,f="00:00.000",h=0,m=0,p=!0;s.oncue=function(e){const o=n[r];let a=n.ccOffset;const s=(h-c)/9e4;if(null!=o&&o.new&&(void 0!==m?a=n.ccOffset=o.start:Aa(n,r,s)),s){if(!t)return void(d=new Error("Missing initPTS for VTT MPEGTS"));a=s-n.presentationOffset}const l=e.endTime-e.startTime,f=ho(9e4*(e.startTime+a-m),9e4*i)/9e4;e.startTime=Math.max(f,0),e.endTime=Math.max(f+l,0);const p=e.text.trim();e.text=decodeURIComponent(encodeURIComponent(p)),e.id||(e.id=_a(e.startTime,e.endTime,p)),e.endTime>0&&u.push(e)},s.onparsingerror=function(e){d=e},s.onflush=function(){d?a(d):o(u)},l.forEach(e=>{if(p){if(Da(e,"X-TIMESTAMP-MAP=")){p=!1,e.slice(16).split(",").forEach(e=>{Da(e,"LOCAL:")?f=e.slice(6):Da(e,"MPEGTS:")&&(h=parseInt(e.slice(7)))});try{m=ka(f)/1e3}catch(t){d=t}return}""===e&&(p=!1)}s.parse(e+"\n")}),s.flush()}const Oa="stpp.ttml.im1t",Ra=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Ia=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,Pa={left:"start",center:"center",right:"end",start:"start",end:"end"};function Ma(e,t,n,r){const i=Ue(new Uint8Array(e),["mdat"]);if(0===i.length)return void r(new Error("Could not parse IMSC1 mdat"));const o=i.map(e=>Ee(e)),a=to(t.baseTime,1,t.timescale);try{o.forEach(e=>n(Na(e,a)))}catch(s){r(s)}}function Na(e,t){const n=new DOMParser,r=n.parseFromString(e,"text/xml"),i=r.getElementsByTagName("tt")[0];if(!i)throw new Error("Invalid ttml");const o={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},a=Object.keys(o).reduce((e,t)=>(e[t]=i.getAttribute("ttp:"+t)||o[t],e),{}),s="preserve"!==i.getAttribute("xml:space"),l=Ba(Fa(i,"styling","style")),u=Ba(Fa(i,"layout","region")),c=Fa(i,"body","[begin]");return[].map.call(c,e=>{const n=$a(e,s);if(!n||!e.hasAttribute("begin"))return null;const r=Ha(e.getAttribute("begin"),a),i=Ha(e.getAttribute("dur"),a);let o=Ha(e.getAttribute("end"),a);if(null===r)throw Va(e);if(null===o){if(null===i)throw Va(e);o=r+i}const c=new ma(r-t,o-t,n);c.id=_a(c.startTime,c.endTime,c.text);const d=u[e.getAttribute("region")],f=l[e.getAttribute("style")],h=za(d,f,l),{textAlign:m}=h;if(m){const e=Pa[m];e&&(c.lineAlign=e),c.align=m}return C(c,h),c}).filter(e=>null!==e)}function Fa(e,t,n){const r=e.getElementsByTagName(t)[0];return r?[].slice.call(r.querySelectorAll(n)):[]}function Ba(e){return e.reduce((e,t)=>{const n=t.getAttribute("xml:id");return n&&(e[n]=t),e},{})}function $a(e,t){return[].slice.call(e.childNodes).reduce((e,n,r)=>{var i;return"br"===n.nodeName&&r?e+"\n":null!=(i=n.childNodes)&&i.length?$a(n,t):t?e+n.textContent.trim().replace(/\s+/g," "):e+n.textContent},"")}function za(e,t,n){const r="http://www.w3.org/ns/ttml#styling";let i=null;const o=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],a=null!=e&&e.hasAttribute("style")?e.getAttribute("style"):null;return a&&n.hasOwnProperty(a)&&(i=n[a]),o.reduce((n,o)=>{const a=Ua(t,r,o)||Ua(e,r,o)||Ua(i,r,o);return a&&(n[o]=a),n},{})}function Ua(e,t,n){return e&&e.hasAttributeNS(t,n)?e.getAttributeNS(t,n):null}function Va(e){return new Error("Could not parse ttml timestamp "+e)}function Ha(e,t){if(!e)return null;let n=ga(e);return null===n&&(Ra.test(e)?n=ja(e,t):Ia.test(e)&&(n=qa(e,t))),n}function ja(e,t){const n=Ra.exec(e),r=(0|n[4])+(0|n[5])/t.subFrameRate;return 3600*(0|n[1])+60*(0|n[2])+(0|n[3])+r/t.frameRate}function qa(e,t){const n=Ia.exec(e),r=Number(n[1]),i=n[2];switch(i){case"h":return 3600*r;case"m":return 60*r;case"ms":return 1e3*r;case"f":return r/t.frameRate;case"t":return r/t.tickRate}return r}class Ga{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Xa(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(E.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(E.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(E.MANIFEST_LOADING,this.onManifestLoading,this),e.on(E.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(E.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(E.FRAG_LOADING,this.onFragLoading,this),e.on(E.FRAG_LOADED,this.onFragLoaded,this),e.on(E.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(E.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(E.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(E.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(E.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(E.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(E.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(E.MANIFEST_LOADING,this.onManifestLoading,this),e.off(E.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(E.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(E.FRAG_LOADING,this.onFragLoading,this),e.off(E.FRAG_LOADED,this.onFragLoaded,this),e.off(E.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(E.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(E.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(E.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(E.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){if(this.config.enableCEA708Captions&&(!this.cea608Parser1||!this.cea608Parser2)){const e=new ha(this,"textTrack1"),t=new ha(this,"textTrack2"),n=new ha(this,"textTrack3"),r=new ha(this,"textTrack4");this.cea608Parser1=new ua(1,e,t),this.cea608Parser2=new ua(3,n,r)}}addCues(e,t,n,r,i){let o=!1;for(let a=i.length;a--;){const e=i[a],r=Ya(e[0],e[1],t,n);if(r>=0&&(e[0]=Math.min(e[0],t),e[1]=Math.max(e[1],n),o=!0,r/(n-t)>.5))return}if(o||i.push([t,n]),this.config.renderTextTracksNatively){const i=this.captionsTracks[e];this.Cues.newCue(i,t,n,r)}else{const i=this.Cues.newCue(null,t,n,r);this.hls.trigger(E.CUES_PARSED,{type:"captions",cues:i,track:e})}}onInitPtsFound(e,{frag:t,id:n,initPTS:r,timescale:i}){const{unparsedVttFrags:o}=this;"main"===n&&(this.initPTS[t.cc]={baseTime:r,timescale:i}),o.length&&(this.unparsedVttFrags=[],o.forEach(e=>{this.onFragLoaded(E.FRAG_LOADED,e)}))}getExistingTrack(e,t){const{media:n}=this;if(n)for(let r=0;r<n.textTracks.length;r++){const i=n.textTracks[r];if(Ka(i,{name:e,lang:t,attrs:{}}))return i}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:n,media:r}=this,{label:i,languageCode:o}=t[e],a=this.getExistingTrack(i,o);if(a)n[e]=a,rn(n[e]),tn(n[e],r);else{const t=this.createTextTrack("captions",i,o);t&&(t[e]=!0,n[e]=t)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const n=t.label,r={_id:e,label:n,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(E.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}createTextTrack(e,t,n){const r=this.media;if(r)return r.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:e}=this;Object.keys(e).forEach(t=>{rn(e[t]),delete e[t]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Xa(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let n=0;n<t.length;n++)rn(t[n])}onSubtitleTracksUpdated(e,t){const n=t.subtitleTracks||[],r=n.some(e=>e.textCodec===Oa);if(this.config.enableWebVTT||r&&this.config.enableIMSC1){const e=Ro(this.tracks,n);if(e)return void(this.tracks=n);if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const e=this.media,t=e?ln(e.textTracks):null;if(this.tracks.forEach((e,n)=>{let r;if(t){let n=null;for(let r=0;r<t.length;r++)if(t[r]&&Ka(t[r],e)){n=t[r],t[r]=null;break}n&&(r=n)}if(r)rn(r);else{const t=Wa(e);r=this.createTextTrack(t,e.name,e.lang),r&&(r.mode="disabled")}r&&this.textTracks.push(r)}),null!=t&&t.length){const e=t.filter(e=>null!==e).map(e=>e.label);e.length&&N.warn(`Media element contains unused subtitle tracks: ${e.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const e=this.tracks.map(e=>({label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e}));this.hls.trigger(E.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:e})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(e=>{const t=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(!t)return;const n="textTrack"+t[1],r=this.captionsProperties[n];r&&(r.label=e.name,e.lang&&(r.languageCode=e.lang),r.media=e)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return null==t?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===Jt.MAIN){var n,r;const{cea608Parser1:e,cea608Parser2:i,lastSn:o}=this,{cc:a,sn:s}=t.frag,l=null!=(n=null==(r=t.part)?void 0:r.index)?n:-1;e&&i&&(s!==o+1||s===o&&l!==this.lastPartIndex+1||a!==this.lastCc)&&(e.reset(),i.reset()),this.lastCc=a,this.lastSn=s,this.lastPartIndex=l}}onFragLoaded(e,t){const{frag:n,payload:r}=t;if(n.type===Jt.SUBTITLE)if(r.byteLength){const e=n.decryptdata,i="stats"in t;if(null==e||!e.encrypted||i){const e=this.tracks[n.level],i=this.vttCCs;i[n.cc]||(i[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),e&&e.textCodec===Oa?this._parseIMSC1(n,r):this._parseVTTs(t)}}else this.hls.trigger(E.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const n=this.hls;Ma(t,this.initPTS[e.cc],t=>{this._appendCues(t,e.level),n.trigger(E.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},t=>{N.log("Failed to parse IMSC1: "+t),n.trigger(E.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:t})})}_parseVTTs(e){var t;const{frag:n,payload:r}=e,{initPTS:i,unparsedVttFrags:o}=this,a=i.length-1;if(!i[n.cc]&&-1===a)return void o.push(e);const s=this.hls,l=null!=(t=n.initSegment)&&t.data?tt(n.initSegment.data,new Uint8Array(r)):r;La(l,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,e=>{this._appendCues(e,n.level),s.trigger(E.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},t=>{const i="Missing initPTS for VTT MPEGTS"===t.message;i?o.push(e):this._fallbackToIMSC1(n,r),N.log("Failed to parse VTT cue: "+t),i&&a>n.cc||s.trigger(E.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:t})})}_fallbackToIMSC1(e,t){const n=this.tracks[e.level];n.textCodec||Ma(t,this.initPTS[e.cc],()=>{n.textCodec=Oa,this._parseIMSC1(e,t)},()=>{n.textCodec="wvtt"})}_appendCues(e,t){const n=this.hls;if(this.config.renderTextTracksNatively){const n=this.textTracks[t];if(!n||"disabled"===n.mode)return;e.forEach(e=>nn(n,e))}else{const r=this.tracks[t];if(!r)return;const i=r.default?"default":"subtitles"+t;n.trigger(E.CUES_PARSED,{type:"subtitles",cues:e,track:i})}}onFragDecrypted(e,t){const{frag:n}=t;n.type===Jt.SUBTITLE&&this.onFragLoaded(E.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){this.initCea608Parsers();const{cea608Parser1:n,cea608Parser2:r}=this;if(!this.enabled||!n||!r)return;const{frag:i,samples:o}=t;if(i.type!==Jt.MAIN||"NONE"!==this.closedCaptionsForLevel(i))for(let a=0;a<o.length;a++){const e=o[a].bytes;if(e){const t=this.extractCea608Data(e);n.addData(o[a].pts,t[0]),r.addData(o[a].pts,t[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:n,endOffsetSubtitles:r,type:i}){const{media:o}=this;if(o&&!(o.currentTime<n)){if(!i||"video"===i){const{captionsTracks:e}=this;Object.keys(e).forEach(r=>on(e[r],t,n))}if(this.config.renderTextTracksNatively&&0===t&&void 0!==r){const{textTracks:e}=this;Object.keys(e).forEach(n=>on(e[n],t,r))}}}extractCea608Data(e){const t=[[],[]],n=31&e[0];let r=2;for(let i=0;i<n;i++){const n=e[r++],i=127&e[r++],o=127&e[r++];if(0===i&&0===o)continue;const a=0!==(4&n);if(a){const e=3&n;0!==e&&1!==e||(t[e].push(i),t[e].push(o))}}return t}}function Wa(e){return e.characteristics&&/transcribes-spoken-dialog/gi.test(e.characteristics)&&/describes-music-and-sound/gi.test(e.characteristics)?"captions":"subtitles"}function Ka(e,t){return!!e&&e.kind===Wa(t)&&Po(t,e)}function Ya(e,t,n,r){return Math.min(t,r)-Math.max(e,n)}function Xa(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}class Ja{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(E.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(E.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(E.MANIFEST_PARSED,this.onManifestParsed,this),e.on(E.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(E.BUFFER_CODECS,this.onBufferCodecs,this),e.on(E.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(E.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(E.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(E.MANIFEST_PARSED,this.onManifestParsed,this),e.off(E.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(E.BUFFER_CODECS,this.onBufferCodecs,this),e.off(E.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&T(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){const n=this.hls;n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0)return void(this.clientRect=null);const e=this.hls.levels;if(e.length){const t=this.hls,n=this.getMaxLevel(e.length-1);n!==this.autoLevelCapping&&N.log(`Setting autoLevelCapping to ${n}: ${e[n].height}p@${e[n].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=n,t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const n=t.filter((t,n)=>this.isLevelAllowed(t)&&n<=e);return this.clientRect=null,Ja.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,t.width||t.height||(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch(t){}return e}isLevelAllowed(e){const t=this.restrictedLevels;return!t.some(t=>e.bitrate===t.bitrate&&e.width===t.width&&e.height===t.height)}static getMaxLevelByMediaSize(e,t,n){if(null==e||!e.length)return-1;const r=(e,t)=>!t||(e.width!==t.width||e.height!==t.height);let i=e.length-1;const o=Math.max(t,n);for(let a=0;a<e.length;a+=1){const t=e[a];if((t.width>=o||t.height>=o)&&r(t,e[a+1])){i=a;break}}return i}}class Qa{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(E.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(E.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const n=this.hls.config;if(n.capLevelOnFPSDrop){const e=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=e,e&&"function"===typeof e.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}checkFPS(e,t,n){const r=performance.now();if(t){if(this.lastTime){const e=r-this.lastTime,i=n-this.lastDroppedFrames,o=t-this.lastDecodedFrames,a=1e3*i/e,s=this.hls;if(s.trigger(E.FPS_DROP,{currentDropped:i,currentDecoded:o,totalDroppedFrames:n}),a>0&&i>s.config.fpsDroppedMonitoringThreshold*o){let e=s.currentLevel;N.warn("drop FPS ratio greater than max allowed value for currentLevel: "+e),e>0&&(-1===s.autoLevelCapping||s.autoLevelCapping>=e)&&(e-=1,s.trigger(E.FPS_DROP_LEVEL_CAPPING,{level:e,droppedLevel:s.currentLevel}),s.autoLevelCapping=e,this.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}const Za="[eme]";class es{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=es.CDMCleanupPromise?[es.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=N.debug.bind(N,Za),this.log=N.log.bind(N,Za),this.warn=N.warn.bind(N,Za),this.error=N.error.bind(N,Za),this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(E.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(E.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(E.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(E.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(E.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(E.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(E.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(E.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:n}=this.config,r=t[e];if(r)return r.licenseUrl;if(e===ne.WIDEVINE&&n)return n;throw new Error(`no license server URL configured for key-system "${e}"`)}getServerCertificateUrl(e){const{drmSystems:t}=this.config,n=t[e];if(n)return n.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,n=(e,t,n)=>!!e&&n.indexOf(e)===t,r=t.map(e=>e.audioCodec).filter(n),i=t.map(e=>e.videoCodec).filter(n);return r.length+i.length===0&&i.push("avc1.42e01e"),new Promise((t,n)=>{const o=e=>{const a=e.shift();this.getMediaKeysPromise(a,r,i).then(e=>t({keySystem:a,mediaKeys:e})).catch(t=>{e.length?o(e):n(t instanceof ts?t:new ts({type:_.KEY_SYSTEM_ERROR,details:A.KEY_SYSTEM_NO_ACCESS,error:t,fatal:!0},t.message))})};o(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:n}=this.config;if("function"!==typeof n){let e="Configured requestMediaKeySystemAccess is not a function "+n;return null===ue&&"http:"===self.location.protocol&&(e="navigator.requestMediaKeySystemAccess is not available over insecure protocol "+location.protocol),Promise.reject(new Error(e))}return n(e,t)}getMediaKeysPromise(e,t,n){const r=ce(e,t,n,this.config.drmSystemOptions),i=this.keySystemAccessPromises[e];let o=null==i?void 0:i.keySystemAccess;if(!o){this.log(`Requesting encrypted media "${e}" key-system access with config: ${JSON.stringify(r)}`),o=this.requestMediaKeySystemAccess(e,r);const t=this.keySystemAccessPromises[e]={keySystemAccess:o};return o.catch(t=>{this.log(`Failed to obtain access to key-system "${e}": ${t}`)}),o.then(n=>{this.log(`Access for key-system "${n.keySystem}" obtained`);const r=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),t.mediaKeys=n.createMediaKeys().then(t=>(this.log(`Media-keys created for "${e}"`),r.then(n=>n?this.setMediaKeysServerCertificate(t,e,n):t))),t.mediaKeys.catch(t=>{this.error(`Failed to create media-keys for "${e}"}: ${t}`)}),t.mediaKeys})}return o.then(()=>i.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:n}){this.log(`Creating key-system session "${t}" keyId: ${Le.hexDump(e.keyId||[])}`);const r=n.createSession(),i={decryptdata:e,keySystem:t,mediaKeys:n,mediaKeysSession:r,keyStatus:"status-pending"};return this.mediaKeySessions.push(i),i}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const n=this.createMediaKeySessionContext(e),r=this.getKeyIdString(t),i="cenc";this.keyIdToKeySessionPromise[r]=this.generateRequestWithPreferredKeySession(n,i,t.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(null===e.keyId)throw new Error("keyId is null");return Le.hexDump(e.keyId)}updateKeySession(e,t){var n;const r=e.mediaKeysSession;return this.log(`Updating key-session "${r.sessionId}" for keyID ${Le.hexDump((null==(n=e.decryptdata)?void 0:n.keyId)||[])}\n      } (data length: ${t?t.byteLength:t})`),r.update(t)}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise((t,n)=>{const r=le(this.config),i=e.map(ie).filter(e=>!!e&&-1!==r.indexOf(e));return this.getKeySystemSelectionPromise(i).then(({keySystem:e})=>{const r=se(e);r?t(r):n(new Error(`Unable to find format for key-system "${e}"`))}).catch(n)})}loadKey(e){const t=e.keyInfo.decryptdata,n=this.getKeyIdString(t),r=`(keyId: ${n} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log("Starting session for key "+r);let i=this.keyIdToKeySessionPromise[n];return i||(i=this.keyIdToKeySessionPromise[n]=this.getKeySystemForKeyPromise(t).then(({keySystem:n,mediaKeys:i})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${r}`),this.attemptSetMediaKeys(n,i).then(()=>{this.throwIfDestroyed();const e=this.createMediaKeySessionContext({keySystem:n,mediaKeys:i,decryptdata:t}),r="cenc";return this.generateRequestWithPreferredKeySession(e,r,t.pssh,"playlist-key")}))),i.catch(e=>this.handleError(e))),i}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof ts?this.hls.trigger(E.ERROR,e.data):this.hls.trigger(E.ERROR,{type:_.KEY_SYSTEM_ERROR,details:A.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),n=this.keyIdToKeySessionPromise[t];if(!n){const t=ie(e.keyFormat),n=t?[t]:le(this.config);return this.attemptKeySystemAccess(n)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=le(this.config)),0===e.length)throw new ts({type:_.KEY_SYSTEM_ERROR,details:A.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},"Missing key-system license configuration options "+JSON.stringify({drmSystems:this.config.drmSystems}));return this.attemptKeySystemAccess(e)}_onMediaEncrypted(e){const{initDataType:t,initData:n}=e,r=`"${e.type}" event: init data type: "${t}"`;if(this.debug(r),null===n)return;let i,o;if("sinf"===t&&this.config.drmSystems[ne.FAIRPLAY]){const e=Pe(new Uint8Array(n));try{const t=X(JSON.parse(e).sinf),n=Ye(new Uint8Array(t));if(!n)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");i=n.subarray(8,24),o=ne.FAIRPLAY}catch(c){return void this.warn(`${r} Failed to parse sinf: ${c}`)}}else{const e=ct(n),t=e.filter(e=>e.systemId===oe.WIDEVINE)[0];if(!t)return void(0===e.length||e.some(e=>!e.systemId)?this.warn(r+" contains incomplete or invalid pssh data"):this.log(`ignoring ${r} for ${e.map(e=>ae(e.systemId)).join(",")} pssh data in favor of playlist keys`));if(o=ae(t.systemId),0===t.version&&t.data){const e=t.data.length-22;i=t.data.subarray(e,e+16)}}if(!o||!i)return;const a=Le.hexDump(i),{keyIdToKeySessionPromise:s,mediaKeySessions:l}=this;let u=s[a];for(let d=0;d<l.length;d++){const e=l[d],r=e.decryptdata;if(!r.keyId)continue;const o=Le.hexDump(r.keyId);if(a===o||-1!==r.uri.replace(/-/g,"").indexOf(a)){if(u=s[o],r.pssh)break;delete s[o],r.pssh=new Uint8Array(n),r.keyId=i,u=s[a]=u.then(()=>this.generateRequestWithPreferredKeySession(e,t,n,"encrypted-event-key-match"));break}}u||(u=s[a]=this.getKeySystemSelectionPromise([o]).then(({keySystem:e,mediaKeys:r})=>{var o;this.throwIfDestroyed();const s=new ht("ISO-23001-7",a,null!=(o=se(e))?o:"");return s.pssh=new Uint8Array(n),s.keyId=i,this.attemptSetMediaKeys(e,r).then(()=>{this.throwIfDestroyed();const i=this.createMediaKeySessionContext({decryptdata:s,keySystem:e,mediaKeys:r});return this.generateRequestWithPreferredKeySession(i,t,n,"encrypted-event-no-match")})})),u.catch(e=>this.handleError(e))}_onWaitingForKey(e){this.log(`"${e.type}" event`)}attemptSetMediaKeys(e,t){const n=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const r=Promise.all(n).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.setMediaKeysQueue.push(r),r.then(()=>{this.log(`Media-keys set for "${e}"`),n.push(r),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(e=>-1===n.indexOf(e))})}generateRequestWithPreferredKeySession(e,t,n,r){var i,o;const a=null==(i=this.config.drmSystems)||null==(o=i[e.keySystem])?void 0:o.generateRequest;if(a)try{const r=a.call(this.hls,t,n,e);if(!r)throw new Error("Invalid response from configured generateRequest filter");t=r.initDataType,n=e.decryptdata.pssh=r.initData?new Uint8Array(r.initData):null}catch(h){var s;if(this.warn(h.message),null!=(s=this.hls)&&s.config.debug)throw h}if(null===n)return this.log(`Skipping key-session request for "${r}" (no initData)`),Promise.resolve(e);const l=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${r}": ${l} (init data type: ${t} length: ${n?n.byteLength:null})`);const u=new Lo,c=e._onmessage=t=>{const n=e.mediaKeysSession;if(!n)return void u.emit("error",new Error("invalid state"));const{messageType:r,message:i}=t;this.log(`"${r}" message event for session "${n.sessionId}" message size: ${i.byteLength}`),"license-request"===r||"license-renewal"===r?this.renewLicense(e,i).catch(e=>{this.handleError(e),u.emit("error",e)}):"license-release"===r?e.keySystem===ne.FAIRPLAY&&(this.updateKeySession(e,ee("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${r}"`)},d=e._onkeystatuseschange=t=>{const n=e.mediaKeysSession;if(!n)return void u.emit("error",new Error("invalid state"));this.onKeyStatusChange(e);const r=e.keyStatus;u.emit("keyStatus",r),"expired"===r&&(this.warn(`${e.keySystem} expired for key ${l}`),this.renewKeySession(e))};e.mediaKeysSession.addEventListener("message",c),e.mediaKeysSession.addEventListener("keystatuseschange",d);const f=new Promise((e,t)=>{u.on("error",t),u.on("keyStatus",n=>{n.startsWith("usable")?e():"output-restricted"===n?t(new ts({type:_.KEY_SYSTEM_ERROR,details:A.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):"internal-error"===n?t(new ts({type:_.KEY_SYSTEM_ERROR,details:A.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${n}"`)):"expired"===n?t(new Error("key expired while generating request")):this.warn(`unhandled key status change "${n}"`)})});return e.mediaKeysSession.generateRequest(t,n).then(()=>{var t;this.log(`Request generated for key-session "${null==(t=e.mediaKeysSession)?void 0:t.sessionId}" keyId: ${l}`)}).catch(e=>{throw new ts({type:_.KEY_SYSTEM_ERROR,details:A.KEY_SYSTEM_NO_SESSION,error:e,fatal:!1},"Error generating key-session request: "+e)}).then(()=>f).catch(t=>{throw u.removeAllListeners(),this.removeSession(e),t}).then(()=>(u.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,n)=>{this.log(`key status change "${t}" for keyStatuses keyId: ${Le.hexDump("buffer"in n?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n))} session keyId: ${Le.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){const t=this.config,n=t.loader,r=new n(t),i=this.getServerCertificateUrl(e);return i?(this.log(`Fetching server certificate for "${e}"`),new Promise((n,o)=>{const a={responseType:"arraybuffer",url:i},s=t.certLoadPolicy.default,l={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},u={onSuccess:(e,t,r,i)=>{n(e.data)},onError:(t,n,r,s)=>{o(new ts({type:_.KEY_SYSTEM_ERROR,details:A.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:r,response:y({url:a.url,data:void 0},t)},`"${e}" certificate request failed (${i}). Status: ${t.code} (${t.text})`))},onTimeout:(t,n,r)=>{o(new ts({type:_.KEY_SYSTEM_ERROR,details:A.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:r,response:{url:a.url,data:void 0}},`"${e}" certificate request timed out (${i})`))},onAbort:(e,t,n)=>{o(new Error("aborted"))}};r.load(a,l,u)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,n){return new Promise((r,i)=>{e.setServerCertificate(n).then(i=>{this.log(`setServerCertificate ${i?"success":"not supported by CDM"} (${null==n?void 0:n.byteLength}) on "${t}"`),r(e)}).catch(e=>{i(new ts({type:_.KEY_SYSTEM_ERROR,details:A.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:e,fatal:!0},e.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(t=>this.updateKeySession(e,new Uint8Array(t)).catch(e=>{throw new ts({type:_.KEY_SYSTEM_ERROR,details:A.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:e,fatal:!0},e.message)}))}unpackPlayReadyKeyMessage(e,t){const n=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!n.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const r=(new DOMParser).parseFromString(n,"application/xml"),i=r.querySelectorAll("HttpHeader");if(i.length>0){let t;for(let n=0,r=i.length;n<r;n++){var o,a;t=i[n];const r=null==(o=t.querySelector("name"))?void 0:o.textContent,s=null==(a=t.querySelector("value"))?void 0:a.textContent;r&&s&&e.setRequestHeader(r,s)}}const s=r.querySelector("Challenge"),l=null==s?void 0:s.textContent;if(!l)throw new Error("Cannot find <Challenge> in key message");return ee(atob(l))}setupLicenseXHR(e,t,n,r){const i=this.config.licenseXhrSetup;return i?Promise.resolve().then(()=>{if(!n.decryptdata)throw new Error("Key removed");return i.call(this.hls,e,t,n,r)}).catch(o=>{if(!n.decryptdata)throw o;return e.open("POST",t,!0),i.call(this.hls,e,t,n,r)}).then(n=>{e.readyState||e.open("POST",t,!0);const i=n||r;return{xhr:e,licenseChallenge:i}}):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:r}))}requestLicense(e,t){const n=this.config.keyLoadPolicy.default;return new Promise((r,i)=>{const o=this.getLicenseServerUrl(e.keySystem);this.log("Sending license request to URL: "+o);const a=new XMLHttpRequest;a.responseType="arraybuffer",a.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return i(new Error("invalid state"));if(4===a.readyState)if(200===a.status){this._requestLicenseFailureCount=0;let t=a.response;this.log("License received "+(t instanceof ArrayBuffer?t.byteLength:t));const n=this.config.licenseResponseCallback;if(n)try{t=n.call(this.hls,a,o,e)}catch(s){this.error(s)}r(t)}else{const s=n.errorRetry,l=s?s.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>l||a.status>=400&&a.status<500)i(new ts({type:_.KEY_SYSTEM_ERROR,details:A.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:a,response:{url:o,data:void 0,code:a.status,text:a.statusText}},`License Request XHR failed (${o}). Status: ${a.status} (${a.statusText})`));else{const n=l-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${n} attempts left`),this.requestLicense(e,t).then(r,i)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=a,this.setupLicenseXHR(a,o,e,t).then(({xhr:t,licenseChallenge:n})=>{e.keySystem==ne.PLAYREADY&&(n=this.unpackPlayReadyKeyMessage(t,n)),t.send(n)})})}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const n=t.media;this.media=n,n.addEventListener("encrypted",this.onMediaEncrypted),n.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media,t=this.mediaKeySessions;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},ht.clearKeyUriToKeyIdMap();const n=t.length;es.CDMCleanupPromise=Promise.all(t.map(e=>this.removeSession(e)).concat(null==e?void 0:e.setMediaKeys(null).catch(e=>{this.log("Could not clear media keys: "+e)}))).then(()=>{n&&(this.log("finished closing key sessions and clearing media keys"),t.length=0)}).catch(e=>{this.log("Could not close sessions and clear media keys: "+e)})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(t&&this.config.emeEnabled&&!this.keyFormatPromise){const e=t.reduce((e,t)=>(-1===e.indexOf(t.keyFormat)&&e.push(t.keyFormat),e),[]);this.log("Selecting key-system from session-keys "+e.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(e)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:n}=e;if(t){this.log("Remove licenses and keys and close session "+t.sessionId),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const r=this.mediaKeySessions.indexOf(e);return r>-1&&this.mediaKeySessions.splice(r,1),t.remove().catch(e=>{this.log("Could not remove session: "+e)}).then(()=>t.close()).catch(e=>{this.log("Could not close session: "+e)})}}}es.CDMCleanupPromise=void 0;class ts extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}var ns,rs,is;(function(e){e["MANIFEST"]="m",e["AUDIO"]="a",e["VIDEO"]="v",e["MUXED"]="av",e["INIT"]="i",e["CAPTION"]="c",e["TIMED_TEXT"]="tt",e["KEY"]="k",e["OTHER"]="o"})(ns||(ns={})),function(e){e["DASH"]="d",e["HLS"]="h",e["SMOOTH"]="s",e["OTHER"]="o"}(rs||(rs={})),function(e){e["OBJECT"]="CMCD-Object",e["REQUEST"]="CMCD-Request",e["SESSION"]="CMCD-Session",e["STATUS"]="CMCD-Status"}(is||(is={}));const os={[is.OBJECT]:["br","d","ot","tb"],[is.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[is.SESSION]:["cid","pr","sf","sid","st","v"],[is.STATUS]:["bs","rtp"]};class as{constructor(e,t){this.value=void 0,this.params=void 0,Array.isArray(e)&&(e=e.map(e=>e instanceof as?e:new as(e))),this.value=e,this.params=t}}class ss{constructor(e){this.description=void 0,this.description=e}}const ls="Dict";function us(e){return Array.isArray(e)?JSON.stringify(e):e instanceof Map?"Map{}":e instanceof Set?"Set{}":"object"===typeof e?JSON.stringify(e):String(e)}function cs(e,t,n,r){return new Error(`failed to ${e} "${us(t)}" as ${n}`,{cause:r})}const ds="Bare Item",fs="Boolean",hs="Byte Sequence",ms="Decimal",ps="Integer";function gs(e){return e<-999999999999999||999999999999999<e}const vs=/[\x00-\x1f\x7f]+/,bs="Token",ys="Key";function ws(e,t,n){return cs("serialize",e,t,n)}function Ss(e){if("boolean"!==typeof e)throw ws(e,fs);return e?"?1":"?0"}function xs(e){return btoa(String.fromCharCode(...e))}function Cs(e){if(!1===ArrayBuffer.isView(e))throw ws(e,hs);return`:${xs(e)}:`}function Ts(e){if(gs(e))throw ws(e,ps);return e.toString()}function Ds(e){return"@"+Ts(e.getTime()/1e3)}function ks(e,t){if(e<0)return-ks(-e,t);const n=Math.pow(10,t),r=Math.abs(e*n%1-.5)<Number.EPSILON;if(r){const t=Math.floor(e*n);return(t%2===0?t:t+1)/n}return Math.round(e*n)/n}function Es(e){const t=ks(e,3);if(Math.floor(Math.abs(t)).toString().length>12)throw ws(e,ms);const n=t.toString();return n.includes(".")?n:n+".0"}const _s="String";function As(e){if(vs.test(e))throw ws(e,_s);return`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function Ls(e){return e.description||e.toString().slice(7,-1)}function Os(e){const t=Ls(e);if(!1===/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(t))throw ws(t,bs);return t}function Rs(e){switch(typeof e){case"number":if(!T(e))throw ws(e,ds);return Number.isInteger(e)?Ts(e):Es(e);case"string":return As(e);case"symbol":return Os(e);case"boolean":return Ss(e);case"object":if(e instanceof Date)return Ds(e);if(e instanceof Uint8Array)return Cs(e);if(e instanceof ss)return Os(e);default:throw ws(e,ds)}}function Is(e){if(!1===/^[a-z*][a-z0-9\-_.*]*$/.test(e))throw ws(e,ys);return e}function Ps(e){return null==e?"":Object.entries(e).map(([e,t])=>!0===t?";"+Is(e):`;${Is(e)}=${Rs(t)}`).join("")}function Ms(e){return e instanceof as?`${Rs(e.value)}${Ps(e.params)}`:Rs(e)}function Ns(e){return`(${e.value.map(Ms).join(" ")})${Ps(e.params)}`}function Fs(e,t={whitespace:!0}){if("object"!==typeof e)throw ws(e,ls);const n=e instanceof Map?e.entries():Object.entries(e),r=null!=t&&t.whitespace?" ":"";return Array.from(n).map(([e,t])=>{t instanceof as===!1&&(t=new as(t));let n=Is(e);return!0===t.value?n+=Ps(t.params):(n+="=",Array.isArray(t.value)?n+=Ns(t):n+=Ms(t)),n}).join(","+r)}function Bs(e,t){return Fs(e,t)}const $s=e=>"ot"===e||"sf"===e||"st"===e,zs=e=>"number"===typeof e?T(e):null!=e&&""!==e&&!1!==e;function Us(e,t){const n=new URL(e),r=new URL(t);if(n.origin!==r.origin)return e;const i=n.pathname.split("/").slice(1),o=r.pathname.split("/").slice(1,-1);while(i[0]===o[0])i.shift(),o.shift();while(o.length)o.shift(),i.unshift("..");return i.join("/")}function Vs(){try{return crypto.randomUUID()}catch(e){try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch(e){let t=(new Date).getTime();const n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:3&n|8).toString(16)});return n}}}const Hs=e=>Math.round(e),js=(e,t)=>(null!=t&&t.baseUrl&&(e=Us(e,t.baseUrl)),encodeURIComponent(e)),qs=e=>100*Hs(e/100),Gs={br:Hs,d:Hs,bl:qs,dl:qs,mtp:qs,nor:js,rtp:qs,tb:Hs};function Ws(e,t){const n={};if(null==e||"object"!==typeof e)return n;const r=Object.keys(e).sort(),i=C({},Gs,null==t?void 0:t.formatters),o=null==t?void 0:t.filter;return r.forEach(r=>{if(null!=o&&o(r))return;let a=e[r];const s=i[r];s&&(a=s(a,t)),"v"===r&&1===a||"pr"==r&&1===a||zs(a)&&($s(r)&&"string"===typeof a&&(a=new ss(a)),n[r]=a)}),n}function Ks(e,t={}){return e?Bs(Ws(e,t),C({whitespace:!1},t)):""}function Ys(e,t={}){if(!e)return{};const n=Object.entries(e),r=Object.entries(os).concat(Object.entries((null==t?void 0:t.customHeaderMap)||{})),i=n.reduce((e,t)=>{var n;const[i,o]=t,a=(null==(n=r.find(e=>e[1].includes(i)))?void 0:n[0])||is.REQUEST;return null!=e[a]||(e[a]={}),e[a][i]=o,e},{});return Object.entries(i).reduce((e,[n,r])=>(e[n]=Ks(r,t),e),{})}function Xs(e,t,n){return C(e,Ys(t,n))}const Js="CMCD";function Qs(e,t={}){if(!e)return"";const n=Ks(e,t);return`${Js}=${encodeURIComponent(n)}`}const Zs=/CMCD=[^&#]+/;function el(e,t,n){const r=Qs(t,n);if(!r)return e;if(Zs.test(e))return e.replace(Zs,r);const i=e.includes("?")?"&":"?";return`${e}${i}${r}`}class tl{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=e=>{try{this.apply(e,{ot:ns.MANIFEST,su:!this.initialized})}catch(t){N.warn("Could not generate manifest CMCD data.",t)}},this.applyFragmentData=e=>{try{const t=e.frag,n=this.hls.levels[t.level],r=this.getObjectType(t),i={d:1e3*t.duration,ot:r};r!==ns.VIDEO&&r!==ns.AUDIO&&r!=ns.MUXED||(i.br=n.bitrate/1e3,i.tb=this.getTopBandwidth(r)/1e3,i.bl=this.getBufferLength(r)),this.apply(e,i)}catch(t){N.warn("Could not generate segment CMCD data.",t)}},this.hls=e;const t=this.config=e.config,{cmcd:n}=t;null!=n&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||Vs(),this.cid=n.contentId,this.useHeaders=!0===n.useHeaders,this.includeKeys=n.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(E.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(E.MEDIA_DETACHED,this.onMediaDetached,this),e.on(E.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(E.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(E.MEDIA_DETACHED,this.onMediaDetached,this),e.off(E.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,r;this.audioBuffer=null==(n=t.tracks.audio)?void 0:n.buffer,this.videoBuffer=null==(r=t.tracks.video)?void 0:r.buffer}createData(){var e;return{v:1,sf:rs.HLS,sid:this.sid,cid:this.cid,pr:null==(e=this.media)?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){C(t,this.createData());const n=t.ot===ns.INIT||t.ot===ns.VIDEO||t.ot===ns.MUXED;this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),null==t.su&&(t.su=this.buffering);const{includeKeys:r}=this;r&&(t=Object.keys(t).reduce((e,n)=>(r.includes(n)&&(e[n]=t[n]),e),{})),this.useHeaders?(e.headers||(e.headers={}),Xs(e.headers,t)):e.url=el(e.url,t)}getObjectType(e){const{type:t}=e;return"subtitle"===t?ns.TIMED_TEXT:"initSegment"===e.sn?ns.INIT:"audio"===t?ns.AUDIO:"main"===t?this.hls.audioTracks.length?ns.VIDEO:ns.MUXED:void 0}getTopBandwidth(e){let t,n=0;const r=this.hls;if(e===ns.AUDIO)t=r.audioTracks;else{const e=r.maxAutoLevel,n=e>-1?e+1:r.levels.length;t=r.levels.slice(0,n)}for(const i of t)i.bitrate>n&&(n=i.bitrate);return n>0?n:NaN}getBufferLength(e){const t=this.hls.media,n=e===ns.AUDIO?this.audioBuffer:this.videoBuffer;if(!n||!t)return NaN;const r=Ar.bufferInfo(n,t.currentTime,this.config.maxBufferHole);return 1e3*r.len}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(e){this.loader=void 0,this.loader=new n(e)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(e,n,r){t(e),this.loader.load(e,n,r)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(e){this.loader=void 0,this.loader=new n(e)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(e,n,r){t(e),this.loader.load(e,n,r)}}}}const nl=3e5;class rl{constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=N.log.bind(N,"[content-steering]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(E.MANIFEST_LOADING,this.onManifestLoading,this),e.on(E.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(E.MANIFEST_PARSED,this.onManifestParsed,this),e.on(E.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(E.MANIFEST_LOADING,this.onManifestLoading,this),e.off(E.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(E.MANIFEST_PARSED,this.onManifestParsed,this),e.off(E.ERROR,this.onError,this))}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=1e3*this.timeToLoad-(performance.now()-this.updated);if(e>0)return void this.scheduleRefresh(this.uri,e)}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){-1!==this.reloadTimer&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(t=>t!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:n}=t;null!==n&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:n}=t;if((null==n?void 0:n.action)===Zn.SendAlternateToPenaltyBox&&n.flags===er.MoveAllAlternatesMatchingHost){const e=this.levels;let r=this.pathwayPriority,i=this.pathwayId;if(t.context){const{groupId:n,pathwayId:r,type:o}=t.context;n&&e?i=this.getPathwayForGroupId(n,o,i):r&&(i=r)}i in this.penalizedPathways||(this.penalizedPathways[i]=performance.now()),!r&&e&&(r=e.reduce((e,t)=>(-1===e.indexOf(t.pathwayId)&&e.push(t.pathwayId),e),[])),r&&r.length>1&&(this.updatePathwayPriority(r),n.resolved=this.pathwayId!==i),n.resolved||N.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${i} levels: ${e?e.length:e} priorities: ${JSON.stringify(r)} penalized: ${JSON.stringify(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(0===t.length){const n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length?(this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t):e}getLevelsForPathway(e){return null===this.levels?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){let t;this.pathwayPriority=e;const n=this.penalizedPathways,r=performance.now();Object.keys(n).forEach(e=>{r-n[e]>nl&&delete n[e]});for(let i=0;i<e.length;i++){const r=e[i];if(r in n)continue;if(r===this.pathwayId)return;const o=this.hls.nextLoadLevel,a=this.hls.levels[o];if(t=this.getLevelsForPathway(r),t.length>0){this.log(`Setting Pathway to "${r}"`),this.pathwayId=r,$n(t),this.hls.trigger(E.LEVELS_UPDATED,{levels:t});const e=this.hls.levels[o];a&&e&&this.levels&&(e.attrs["STABLE-VARIANT-ID"]!==a.attrs["STABLE-VARIANT-ID"]&&e.bitrate!==a.bitrate&&this.log(`Unstable Pathways change from bitrate ${a.bitrate} to ${e.bitrate}`),this.hls.nextLoadLevel=o);break}}}getPathwayForGroupId(e,t,n){const r=this.getLevelsForPathway(n).concat(this.levels||[]);for(let i=0;i<r.length;i++)if(t===Xt.AUDIO_TRACK&&r[i].hasAudioGroup(e)||t===Xt.SUBTITLE_TRACK&&r[i].hasSubtitleGroup(e))return r[i].pathwayId;return n}clonePathways(e){const t=this.levels;if(!t)return;const n={},r={};e.forEach(e=>{const{ID:i,"BASE-ID":o,"URI-REPLACEMENT":a}=e;if(t.some(e=>e.pathwayId===i))return;const s=this.getLevelsForPathway(o).map(e=>{const t=new $(e.attrs);t["PATHWAY-ID"]=i;const o=t.AUDIO&&`${t.AUDIO}_clone_${i}`,s=t.SUBTITLES&&`${t.SUBTITLES}_clone_${i}`;o&&(n[t.AUDIO]=o,t.AUDIO=o),s&&(r[t.SUBTITLES]=s,t.SUBTITLES=s);const l=ol(e.uri,t["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",a),u=new Dn({attrs:t,audioCodec:e.audioCodec,bitrate:e.bitrate,height:e.height,name:e.name,url:l,videoCodec:e.videoCodec,width:e.width});if(e.audioGroups)for(let n=1;n<e.audioGroups.length;n++)u.addGroupId("audio",`${e.audioGroups[n]}_clone_${i}`);if(e.subtitleGroups)for(let n=1;n<e.subtitleGroups.length;n++)u.addGroupId("text",`${e.subtitleGroups[n]}_clone_${i}`);return u});t.push(...s),il(this.audioTracks,n,a,i),il(this.subtitleTracks,r,a,i)})}loadSteeringManifest(e){const t=this.hls.config,n=t.loader;let r;this.loader&&this.loader.destroy(),this.loader=new n(t);try{r=new self.URL(e)}catch(u){return this.enabled=!1,void this.log("Failed to parse Steering Manifest URI: "+e)}if("data:"!==r.protocol){const e=0|(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate);r.searchParams.set("_HLS_pathway",this.pathwayId),r.searchParams.set("_HLS_throughput",""+e)}const i={responseType:"json",url:r.href},o=t.steeringManifestLoadPolicy.default,a=o.errorRetry||o.timeoutRetry||{},s={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},l={onSuccess:(e,t,n,i)=>{this.log(`Loaded steering manifest: "${r}"`);const o=e.data;if(1!==o.VERSION)return void this.log(`Steering VERSION ${o.VERSION} not supported!`);this.updated=performance.now(),this.timeToLoad=o.TTL;const{"RELOAD-URI":a,"PATHWAY-CLONES":s,"PATHWAY-PRIORITY":l}=o;if(a)try{this.uri=new self.URL(a,r).href}catch(u){return this.enabled=!1,void this.log("Failed to parse Steering Manifest RELOAD-URI: "+a)}this.scheduleRefresh(this.uri||n.url),s&&this.clonePathways(s);const c={steeringManifest:o,url:r.toString()};this.hls.trigger(E.STEERING_MANIFEST_LOADED,c),l&&this.updatePathwayPriority(l)},onError:(e,t,n,r)=>{if(this.log(`Error loading steering manifest: ${e.code} ${e.text} (${t.url})`),this.stopLoad(),410===e.code)return this.enabled=!1,void this.log(`Steering manifest ${t.url} no longer available`);let i=1e3*this.timeToLoad;if(429!==e.code)this.scheduleRefresh(this.uri||t.url,i);else{const e=this.loader;if("function"===typeof(null==e?void 0:e.getResponseHeader)){const t=e.getResponseHeader("Retry-After");t&&(i=1e3*parseFloat(t))}this.log(`Steering manifest ${t.url} rate limited`)}},onTimeout:(e,t,n)=>{this.log(`Timeout loading steering manifest (${t.url})`),this.scheduleRefresh(this.uri||t.url)}};this.log("Requesting steering manifest: "+r),this.loader.load(i,s,l)}scheduleRefresh(e,t=1e3*this.timeToLoad){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var t;const n=null==(t=this.hls)?void 0:t.media;!n||n.ended?this.scheduleRefresh(e,1e3*this.timeToLoad):this.loadSteeringManifest(e)},t)}}function il(e,t,n,r){e&&Object.keys(t).forEach(i=>{const o=e.filter(e=>e.groupId===i).map(e=>{const o=C({},e);return o.details=void 0,o.attrs=new $(o.attrs),o.url=o.attrs.URI=ol(e.url,e.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",n),o.groupId=o.attrs["GROUP-ID"]=t[i],o.attrs["PATHWAY-ID"]=r,o});e.push(...o)})}function ol(e,t,n,r){const{HOST:i,PARAMS:o,[n]:a}=r;let s;t&&(s=null==a?void 0:a[t],s&&(e=s));const l=new self.URL(e);return i&&!s&&(l.host=i),o&&Object.keys(o).sort().forEach(e=>{e&&l.searchParams.set(e,o[e])}),l.href}const al=/^age:\s*[\d.]+\s*$/im;class sl{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new H,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,4!==e.readyState&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const n=this.loader=new self.XMLHttpRequest,r=this.stats;r.loading.first=0,r.loaded=0,r.aborted=!1;const i=this.xhrSetup;i?Promise.resolve().then(()=>{if(this.loader===n&&!this.stats.aborted)return i(n,t.url)}).catch(e=>{if(this.loader===n&&!this.stats.aborted)return n.open("GET",t.url,!0),i(n,t.url)}).then(()=>{this.loader!==n||this.stats.aborted||this.openAndSendXhr(n,t,e)}).catch(e=>{this.callbacks.onError({code:n.status,text:e.message},t,n,r)}):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open("GET",t.url,!0);const r=t.headers,{maxTimeToFirstByteMs:i,maxLoadTimeMs:o}=n.loadPolicy;if(r)for(const a in r)e.setRequestHeader(a,r[a]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=i&&T(i)?i:o,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:n}=this;if(!e||!t)return;const r=t.readyState,i=this.config;if(!n.aborted&&r>=2&&(0===n.loading.first&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),i.timeout!==i.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),i.timeout=i.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),4===r)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const r=t.status,o="text"!==t.responseType;if(r>=200&&r<300&&(o&&t.response||null!==t.responseText)){n.loading.end=Math.max(self.performance.now(),n.loading.first);const i=o?t.response:t.responseText,a="arraybuffer"===t.responseType?i.byteLength:i.length;if(n.loaded=n.total=a,n.bwEstimate=8e3*n.total/(n.loading.end-n.loading.first),!this.callbacks)return;const s=this.callbacks.onProgress;if(s&&s(n,e,i,t),!this.callbacks)return;const l={url:t.responseURL,data:i,code:r};this.callbacks.onSuccess(l,n,e,t)}else{const o=i.loadPolicy.errorRetry,a=n.retry,s={url:e.url,data:void 0,code:r};jn(o,a,!1,s)?this.retry(o):(N.error(`${r} while loading ${e.url}`),this.callbacks.onError({code:r,text:t.statusText},e,t,n))}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(jn(e,t,!0))this.retry(e);else{var n;N.warn("timeout while loading "+(null==(n=this.context)?void 0:n.url));const e=this.callbacks;e&&(this.abortInternal(),e.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:n}=this;this.retryDelay=Vn(e,n.retry),n.retry++,N.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${null==t?void 0:t.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&al.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}function ll(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(e){}return!1}const ul=/(\d+)-(\d+)\/(\d+)/;class cl{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||ml,this.controller=new self.AbortController,this.stats=new H}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){const r=this.stats;if(r.loading.start)throw new Error("Loader can only be used once.");r.loading.start=self.performance.now();const i=dl(e,this.controller.signal),o=n.onProgress,a="arraybuffer"===e.responseType,s=a?"byteLength":"length",{maxTimeToFirstByteMs:l,maxLoadTimeMs:u}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,i),self.clearTimeout(this.requestTimeout),t.timeout=l&&T(l)?l:u,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(r,e,this.response)},t.timeout),self.fetch(this.request).then(i=>{this.response=this.loader=i;const s=Math.max(self.performance.now(),r.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=u,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(r,e,this.response)},u-(s-r.loading.start)),!i.ok){const{status:e,statusText:t}=i;throw new pl(t||"fetch, bad network response",e,i)}return r.loading.first=s,r.total=hl(i.headers)||r.total,o&&T(t.highWaterMark)?this.loadProgressively(i,r,e,t.highWaterMark,o):a?i.arrayBuffer():"json"===e.responseType?i.json():i.text()}).then(i=>{const a=this.response;if(!a)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),r.loading.end=Math.max(self.performance.now(),r.loading.first);const l=i[s];l&&(r.loaded=r.total=l);const u={url:a.url,data:i,code:a.status};o&&!T(t.highWaterMark)&&o(r,e,i,a),n.onSuccess(u,r,e,a)}).catch(t=>{if(self.clearTimeout(this.requestTimeout),r.aborted)return;const i=t&&t.code||0,o=t?t.message:null;n.onError({code:i,text:o},e,t?t.details:null,r)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n,r=0,i){const o=new ei,a=e.body.getReader(),s=()=>a.read().then(a=>{if(a.done)return o.dataLength&&i(t,n,o.flush(),e),Promise.resolve(new ArrayBuffer(0));const l=a.value,u=l.length;return t.loaded+=u,u<r||o.dataLength?(o.push(l),o.dataLength>=r&&i(t,n,o.flush(),e)):i(t,n,l,e),s()}).catch(()=>Promise.reject());return s()}}function dl(e,t){const n={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(C({},e.headers))};return e.rangeEnd&&n.headers.set("Range","bytes="+e.rangeStart+"-"+String(e.rangeEnd-1)),n}function fl(e){const t=ul.exec(e);if(t)return parseInt(t[2])-parseInt(t[1])+1}function hl(e){const t=e.get("Content-Range");if(t){const e=fl(t);if(T(e))return e}const n=e.get("Content-Length");if(n)return parseInt(n)}function ml(e,t){return new self.Request(e.url,t)}class pl extends Error{constructor(e,t,n){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=n}}const gl=/\s/,vl={newCue(e,t,n,r){const i=[];let o,a,s,l,u;const c=self.VTTCue||self.TextTrackCue;for(let f=0;f<r.rows.length;f++)if(o=r.rows[f],s=!0,l=0,u="",!o.isEmpty()){var d;for(let e=0;e<o.chars.length;e++)gl.test(o.chars[e].uchar)&&s?l++:(u+=o.chars[e].uchar,s=!1);o.cueStartTime=t,t===n&&(n+=1e-4),l>=16?l--:l++;const r=xa(u.trim()),h=_a(t,n,r);null!=e&&null!=(d=e.cues)&&d.getCueById(h)||(a=new c(t,n,r),a.id=h,a.line=f+1,a.align="left",a.position=10+Math.min(80,10*Math.floor(8*l/32)),i.push(a))}return e&&i.length&&(i.sort((e,t)=>"auto"===e.line||"auto"===t.line?0:e.line>8&&t.line>8?t.line-e.line:e.line-t.line),i.forEach(t=>nn(e,t))),i}},bl={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},yl=y(y({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:sl,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:xr,bufferController:jo,capLevelController:Ja,errorController:tr,fpsController:Qa,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:ue,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,useMediaCapabilities:!0,certLoadPolicy:{default:bl},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},wl()),{},{subtitleStreamController:$o,subtitleTrackController:Uo,timelineController:Ga,audioStreamController:No,audioTrackController:Fo,emeController:es,cmcdController:tl,contentSteeringController:rl});function wl(){return{cueHandler:vl,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function Sl(e,t){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==t.liveMaxLatencyDurationCount&&(void 0===t.liveSyncDurationCount||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(void 0===t.liveSyncDuration||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const n=xl(e),r=["manifest","level","frag"],i=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return r.forEach(e=>{const r=("level"===e?"playlist":e)+"LoadPolicy",o=void 0===t[r],a=[];i.forEach(i=>{const s=`${e}Loading${i}`,l=t[s];if(void 0!==l&&o){a.push(s);const e=n[r].default;switch(t[r]={default:e},i){case"TimeOut":e.maxLoadTimeMs=l,e.maxTimeToFirstByteMs=l;break;case"MaxRetry":e.errorRetry.maxNumRetry=l,e.timeoutRetry.maxNumRetry=l;break;case"RetryDelay":e.errorRetry.retryDelayMs=l,e.timeoutRetry.retryDelayMs=l;break;case"MaxRetryTimeout":e.errorRetry.maxRetryDelayMs=l,e.timeoutRetry.maxRetryDelayMs=l;break}}}),a.length&&N.warn(`hls.js config: "${a.join('", "')}" setting(s) are deprecated, use "${r}": ${JSON.stringify(t[r])}`)}),y(y({},n),t)}function xl(e){return e&&"object"===typeof e?Array.isArray(e)?e.map(xl):Object.keys(e).reduce((t,n)=>(t[n]=xl(e[n]),t),{}):e}function Cl(e){const t=e.loader;if(t!==cl&&t!==sl)N.log("[config]: Custom loader detected, cannot enable progressive streaming"),e.progressive=!1;else{const t=ll();t&&(e.loader=cl,e.progressive=!0,e.enableSoftwareAES=!0,N.log("[config]: Progressive streaming enabled, using FetchLoader"))}}let Tl;class Dl extends nr{constructor(e,t){super(e,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(E.MANIFEST_LOADING,this.onManifestLoading,this),e.on(E.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(E.LEVEL_LOADED,this.onLevelLoaded,this),e.on(E.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(E.FRAG_BUFFERED,this.onFragBuffered,this),e.on(E.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(E.MANIFEST_LOADING,this.onManifestLoading,this),e.off(E.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(E.LEVEL_LOADED,this.onLevelLoaded,this),e.off(E.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(E.FRAG_BUFFERED,this.onFragBuffered,this),e.off(E.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){const e=this._levels;e.forEach(e=>{e.loadError=0,e.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const n=this.hls.config.preferManagedMediaSource,r=[],i={},o={};let a=!1,s=!1,l=!1;t.levels.forEach(e=>{var t,u;const c=e.attrs;let{audioCodec:d,videoCodec:f}=e;-1!==(null==(t=d)?void 0:t.indexOf("mp4a.40.34"))&&(Tl||(Tl=/chrome|firefox/i.test(navigator.userAgent)),Tl&&(e.audioCodec=d=void 0)),d&&(e.audioCodec=d=It(d,n)),0===(null==(u=f)?void 0:u.indexOf("avc1"))&&(f=e.videoCodec=Mt(f));const{width:h,height:m,unknownCodecs:p}=e;if(a||(a=!(!h||!m)),s||(s=!!f),l||(l=!!d),null!=p&&p.length||d&&!Dt(d,"audio",n)||f&&!Dt(f,"video",n))return;const{CODECS:g,"FRAME-RATE":v,"HDCP-LEVEL":b,"PATHWAY-ID":y,RESOLUTION:w,"VIDEO-RANGE":S}=c,x=(y||".")+"-",C=`${x}${e.bitrate}-${w}-${v}-${g}-${S}-${b}`;if(i[C])if(i[C].uri===e.url||e.attrs["PATHWAY-ID"])i[C].addGroupId("audio",c.AUDIO),i[C].addGroupId("text",c.SUBTITLES);else{const t=o[C]+=1;e.attrs["PATHWAY-ID"]=new Array(t+1).join(".");const n=new Dn(e);i[C]=n,r.push(n)}else{const t=new Dn(e);i[C]=t,o[C]=1,r.push(t)}}),this.filterAndSortMediaOptions(r,t,a,s,l)}filterAndSortMediaOptions(e,t,n,r,i){let o=[],a=[],s=e;if((n||r)&&i&&(s=s.filter(({videoCodec:e,videoRange:t,width:n,height:r})=>(!!e||!(!n||!r))&&Sn(t))),0===s.length)return void Promise.resolve().then(()=>{if(this.hls){t.levels.length&&this.warn("One or more CODECS in variant not supported: "+JSON.stringify(t.levels[0].attrs));const e=new Error("no level with compatible codecs found in manifest");this.hls.trigger(E.ERROR,{type:_.MEDIA_ERROR,details:A.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:e,reason:e.message})}});if(t.audioTracks){const{preferManagedMediaSource:e}=this.hls.config;o=t.audioTracks.filter(t=>!t.audioCodec||Dt(t.audioCodec,"audio",e)),kl(o)}t.subtitles&&(a=t.subtitles,kl(a));const l=s.slice(0);s.sort((e,t)=>{if(e.attrs["HDCP-LEVEL"]!==t.attrs["HDCP-LEVEL"])return(e.attrs["HDCP-LEVEL"]||"")>(t.attrs["HDCP-LEVEL"]||"")?1:-1;if(n&&e.height!==t.height)return e.height-t.height;if(e.frameRate!==t.frameRate)return e.frameRate-t.frameRate;if(e.videoRange!==t.videoRange)return wn.indexOf(e.videoRange)-wn.indexOf(t.videoRange);if(e.videoCodec!==t.videoCodec){const n=_t(e.videoCodec),r=_t(t.videoCodec);if(n!==r)return r-n}if(e.uri===t.uri&&e.codecSet!==t.codecSet){const n=At(e.codecSet),r=At(t.codecSet);if(n!==r)return r-n}return e.averageBitrate!==t.averageBitrate?e.averageBitrate-t.averageBitrate:0});let u=l[0];if(this.steering&&(s=this.steering.filterParsedLevels(s),s.length!==l.length))for(let h=0;h<l.length;h++)if(l[h].pathwayId===s[0].pathwayId){u=l[h];break}this._levels=s;for(let h=0;h<s.length;h++)if(s[h]===u){var c;this._firstLevel=h;const e=u.bitrate,t=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${s.length} level(s) found, first bitrate: ${e}`),void 0===(null==(c=this.hls.userConfig)?void 0:c.abrEwmaDefaultEstimate)){const n=Math.min(e,this.hls.config.abrEwmaDefaultEstimateMax);n>t&&t===yl.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=n)}break}const d=i&&!r,f={levels:s,audioTracks:o,subtitleTracks:a,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:i,video:r,altAudio:!d&&o.some(e=>!!e.url)};this.hls.trigger(E.MANIFEST_PARSED,f),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return 0===this._levels.length?null:this._levels}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(0===t.length)return;if(e<0||e>=t.length){const n=new Error("invalid level idx"),r=e<0;if(this.hls.trigger(E.ERROR,{type:_.OTHER_ERROR,details:A.LEVEL_SWITCH_ERROR,level:e,fatal:r,error:n,reason:n.message}),r)return;e=Math.min(e,t.length-1)}const n=this.currentLevelIndex,r=this.currentLevel,i=r?r.attrs["PATHWAY-ID"]:void 0,o=t[e],a=o.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=o,n===e&&o.details&&r&&i===a)return;this.log(`Switching to level ${e} (${o.height?o.height+"p ":""}${o.videoRange?o.videoRange+" ":""}${o.codecSet?o.codecSet+" ":""}@${o.bitrate})${a?" with Pathway "+a:""} from level ${n}${i?" with Pathway "+i:""}`);const s={level:e,attrs:o.attrs,details:o.details,bitrate:o.bitrate,averageBitrate:o.averageBitrate,maxBitrate:o.maxBitrate,realBitrate:o.realBitrate,width:o.width,height:o.height,codecSet:o.codecSet,audioCodec:o.audioCodec,videoCodec:o.videoCodec,audioGroups:o.audioGroups,subtitleGroups:o.subtitleGroups,loaded:o.loaded,loadError:o.loadError,fragmentError:o.fragmentError,name:o.name,id:o.id,uri:o.uri,url:o.url,urlId:0,audioGroupIds:o.audioGroupIds,textGroupIds:o.textGroupIds};this.hls.trigger(E.LEVEL_SWITCHING,s);const l=o.details;if(!l||l.live){const e=this.switchParams(o.uri,null==r?void 0:r.details,l);this.loadPlaylist(e)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(void 0===this._startLevel){const e=this.hls.config.startLevel;return void 0!==e?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}onError(e,t){!t.fatal&&t.context&&t.context.type===Xt.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(void 0!==t&&t.type===Jt.MAIN){const e=t.elementaryStreams;if(!Object.keys(e).some(t=>!!e[t]))return;const n=this._levels[t.level];null!=n&&n.loadError&&(this.log(`Resetting level error count of ${n.loadError} on frag buffered`),n.loadError=0)}}onLevelLoaded(e,t){var n;const{level:r,details:i}=t,o=this._levels[r];var a;if(!o)return this.warn("Invalid level index "+r),void(null!=(a=t.deliveryDirectives)&&a.skip&&(i.deltaUpdateFailed=!0));r===this.currentLevelIndex?(0===o.fragmentError&&(o.loadError=0),this.playlistLoaded(r,t,o.details)):null!=(n=t.deliveryDirectives)&&n.skip&&(i.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist();const t=this.currentLevelIndex,n=this.currentLevel;if(n&&this.shouldLoadPlaylist(n)){let i=n.uri;if(e)try{i=e.addDirectives(i)}catch(r){this.warn("Could not construct new URL with HLS Delivery Directives: "+r)}const o=n.attrs["PATHWAY-ID"];this.log(`Loading level index ${t}${void 0!==(null==e?void 0:e.msn)?" at sn "+e.msn+" part "+e.part:""} with${o?" Pathway "+o:""} ${i}`),this.clearTimer(),this.hls.trigger(E.LEVEL_LOADING,{url:i,level:t,pathwayId:n.attrs["PATHWAY-ID"],id:0,deliveryDirectives:e||null})}}get nextLoadLevel(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;const n=this._levels.filter((t,n)=>n!==e||(this.steering&&this.steering.removeLevel(t),t===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,t.details&&t.details.fragments.forEach(e=>e.level=-1)),!1));$n(n),this._levels=n,this.currentLevelIndex>-1&&null!=(t=this.currentLevel)&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.hls.trigger(E.LEVELS_UPDATED,{levels:n})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:n}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(E.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))}}function kl(e){const t={};e.forEach(e=>{const n=e.groupId||"";e.id=t[n]=t[n]||0,t[n]++})}class El{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const n in this.keyUriToKeyInfo){const r=this.keyUriToKeyInfo[n].loader;if(r){var t;if(e&&e!==(null==(t=r.context)?void 0:t.frag.type))return;r.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=A.KEY_LOAD_ERROR,n,r,i){return new jr({type:_.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:i,error:n,networkDetails:r})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){const{sn:n,cc:r}=e;for(let e=0;e<t.length;e++){const i=t[e];if(r<=i.cc&&("initSegment"===n||"initSegment"===i.sn||n<i.sn)){this.emeController.selectKeySystemFormat(i).then(e=>{i.setKeyFormat(e)});break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var n,r;t&&e.setKeyFormat(t);const i=e.decryptdata;if(!i){const n=new Error(t?"Expected frag.decryptdata to be defined after setting format "+t:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,A.KEY_LOAD_ERROR,n))}const o=i.uri;if(!o)return Promise.reject(this.createKeyLoadError(e,A.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${o}"`)));let a=this.keyUriToKeyInfo[o];if(null!=(n=a)&&n.decryptdata.key)return i.key=a.decryptdata.key,Promise.resolve({frag:e,keyInfo:a});var s;if(null!=(r=a)&&r.keyLoadPromise)switch(null==(s=a.mediaKeySessionContext)?void 0:s.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return a.keyLoadPromise.then(t=>(i.key=t.keyInfo.decryptdata.key,{frag:e,keyInfo:a}))}switch(a=this.keyUriToKeyInfo[o]={decryptdata:i,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},i.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return"identity"===i.keyFormat?this.loadKeyHTTP(a,e):this.loadKeyEME(a,e);case"AES-128":return this.loadKeyHTTP(a,e);default:return Promise.reject(this.createKeyLoadError(e,A.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${i.method}"`)))}}loadKeyEME(e,t){const n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const t=this.emeController.loadKey(n);if(t)return(e.keyLoadPromise=t.then(t=>(e.mediaKeySessionContext=t,n))).catch(t=>{throw e.keyLoadPromise=null,t})}return Promise.resolve(n)}loadKeyHTTP(e,t){const n=this.config,r=n.loader,i=new r(n);return t.keyLoader=e.loader=i,e.keyLoadPromise=new Promise((r,o)=>{const a={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},s=n.keyLoadPolicy.default,l={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},u={onSuccess:(e,t,n,i)=>{const{frag:a,keyInfo:s,url:l}=n;if(!a.decryptdata||s!==this.keyUriToKeyInfo[l])return o(this.createKeyLoadError(a,A.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),i));s.decryptdata.key=a.decryptdata.key=new Uint8Array(e.data),a.keyLoader=null,s.loader=null,r({frag:a,keyInfo:s})},onError:(e,n,r,i)=>{this.resetLoader(n),o(this.createKeyLoadError(t,A.KEY_LOAD_ERROR,new Error(`HTTP Error ${e.code} loading key ${e.text}`),r,y({url:a.url,data:void 0},e)))},onTimeout:(e,n,r)=>{this.resetLoader(n),o(this.createKeyLoadError(t,A.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),r))},onAbort:(e,n,r)=>{this.resetLoader(n),o(this.createKeyLoadError(t,A.INTERNAL_ABORTED,new Error("key loading aborted"),r))}};i.load(a,l,u)})}resetLoader(e){const{frag:t,keyInfo:n,url:r}=e,i=n.loader;t.keyLoader===i&&(t.keyLoader=null,n.loader=null),delete this.keyUriToKeyInfo[r],i&&i.destroy()}}function _l(){return self.SourceBuffer||self.WebKitSourceBuffer}function Al(){const e=St();if(!e)return!1;const t=_l();return!t||t.prototype&&"function"===typeof t.prototype.appendBuffer&&"function"===typeof t.prototype.remove}function Ll(){if(!Al())return!1;const e=St();return"function"===typeof(null==e?void 0:e.isTypeSupported)&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(t=>e.isTypeSupported(Et(t,"video")))||["mp4a.40.2","fLaC"].some(t=>e.isTypeSupported(Et(t,"audio"))))}function Ol(){var e;const t=_l();return"function"===typeof(null==t||null==(e=t.prototype)?void 0:e.changeType)}const Rl=250,Il=2,Pl=.1,Ml=.05;class Nl{constructor(e,t,n,r){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=n,this.hls=r}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,t){const{config:n,media:r,stalled:i}=this;if(null===r)return;const{currentTime:o,seeking:a}=r,s=this.seeking&&!a,l=!this.seeking&&a;if(this.seeking=a,o!==e){if(this.moved=!0,a||(this.nudgeRetry=0),null!==i){if(this.stallReported){const e=self.performance.now()-i;N.warn(`playback not stuck anymore @${o}, after ${Math.round(e)}ms`),this.stallReported=!1}this.stalled=null}return}if(l||s)return void(this.stalled=null);if(r.paused&&!a||r.ended||0===r.playbackRate||!Ar.getBuffered(r).length)return void(this.nudgeRetry=0);const u=Ar.bufferInfo(r,o,0),c=u.nextStart||0;if(a){const e=u.len>Il,n=!c||t&&t.start<=o||c-o>Il&&!this.fragmentTracker.getPartialFragment(o);if(e||n)return;this.moved=!1}if(!this.moved&&null!==this.stalled){var d;const e=u.len>0;if(!e&&!c)return;const t=Math.max(c,u.start||0)-o,n=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,i=null==n||null==(d=n.details)?void 0:d.live,a=i?2*n.details.targetduration:Il,s=this.fragmentTracker.getPartialFragment(o);if(t>0&&(t<=a||s))return void(r.paused||this._trySkipBufferHole(s))}const f=self.performance.now();if(null===i)return void(this.stalled=f);const h=f-i;if(!a&&h>=Rl&&(this._reportStall(u),!this.media))return;const m=Ar.bufferInfo(r,o,n.maxBufferHole);this._tryFixBufferStall(m,h)}_tryFixBufferStall(e,t){const{config:n,fragmentTracker:r,media:i}=this;if(null===i)return;const o=i.currentTime,a=r.getPartialFragment(o);if(a){const e=this._trySkipBufferHole(a);if(e||!this.media)return}(e.len>n.maxBufferHole||e.nextStart&&e.nextStart-o<n.maxBufferHole)&&t>1e3*n.highBufferWatchdogPeriod&&(N.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){const{hls:t,media:n,stallReported:r}=this;if(!r&&n){this.stallReported=!0;const r=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${JSON.stringify(e)})`);N.warn(r.message),t.trigger(E.ERROR,{type:_.MEDIA_ERROR,details:A.BUFFER_STALLED_ERROR,fatal:!1,error:r,buffer:e.len})}}_trySkipBufferHole(e){const{config:t,hls:n,media:r}=this;if(null===r)return 0;const i=r.currentTime,o=Ar.bufferInfo(r,i,0),a=i<o.start?o.start:o.nextStart;if(a){const s=o.len<=t.maxBufferHole,l=o.len>0&&o.len<1&&r.readyState<3,u=a-i;if(u>0&&(s||l)){if(u>t.maxBufferHole){const{fragmentTracker:t}=this;let n=!1;if(0===i){const e=t.getAppendedFrag(0,Jt.MAIN);e&&a<e.end&&(n=!0)}if(!n){const n=e||t.getAppendedFrag(i,Jt.MAIN);if(n){let e=!1,r=n.end;while(r<a){const n=t.getPartialFragment(r);if(!n){e=!0;break}r+=n.duration}if(e)return 0}}}const o=Math.max(a+Ml,i+Pl);if(N.warn(`skipping hole, adjusting currentTime from ${i} to ${o}`),this.moved=!0,this.stalled=null,r.currentTime=o,e&&!e.gap){const t=new Error(`fragment loaded with buffer holes, seeking from ${i} to ${o}`);n.trigger(E.ERROR,{type:_.MEDIA_ERROR,details:A.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:t,reason:t.message,frag:e})}return o}}return 0}_tryNudgeBuffer(){const{config:e,hls:t,media:n,nudgeRetry:r}=this;if(null===n)return;const i=n.currentTime;if(this.nudgeRetry++,r<e.nudgeMaxRetry){const o=i+(r+1)*e.nudgeOffset,a=new Error(`Nudging 'currentTime' from ${i} to ${o}`);N.warn(a.message),n.currentTime=o,t.trigger(E.ERROR,{type:_.MEDIA_ERROR,details:A.BUFFER_NUDGE_ON_STALL,error:a,fatal:!1})}else{const n=new Error(`Playhead still not moving while enough data buffered @${i} after ${e.nudgeMaxRetry} nudges`);N.error(n.message),t.trigger(E.ERROR,{type:_.MEDIA_ERROR,details:A.BUFFER_STALLED_ERROR,error:n,fatal:!0})}}}const Fl=100;class Bl extends Zr{constructor(e,t,n){super(e,t,n,"[stream-controller]",Jt.MAIN),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(E.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(E.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(E.MANIFEST_LOADING,this.onManifestLoading,this),e.on(E.MANIFEST_PARSED,this.onManifestParsed,this),e.on(E.LEVEL_LOADING,this.onLevelLoading,this),e.on(E.LEVEL_LOADED,this.onLevelLoaded,this),e.on(E.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(E.ERROR,this.onError,this),e.on(E.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(E.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(E.BUFFER_CREATED,this.onBufferCreated,this),e.on(E.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(E.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(E.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(E.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(E.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(E.MANIFEST_LOADING,this.onManifestLoading,this),e.off(E.MANIFEST_PARSED,this.onManifestParsed,this),e.off(E.LEVEL_LOADED,this.onLevelLoaded,this),e.off(E.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(E.ERROR,this.onError,this),e.off(E.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(E.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(E.BUFFER_CREATED,this.onBufferCreated,this),e.off(E.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(E.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(E.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying()}startLoad(e){if(this.levels){const{lastCurrentTime:t,hls:n}=this;if(this.stopLoad(),this.setInterval(Fl),this.level=-1,!this.startFragRequested){let e=n.startLevel;-1===e&&(n.config.testBandwidth&&this.levels.length>1?(e=0,this.bitrateTest=!0):e=n.firstAutoLevel),n.nextLoadLevel=e,this.level=n.loadLevel,this.loadedmetadata=!1}t>0&&-1===e&&(this.log("Override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=Qr.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=Qr.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case Qr.WAITING_LEVEL:{const{levels:e,level:t}=this,n=null==e?void 0:e[t],r=null==n?void 0:n.details;if(r&&(!r.live||this.levelLastLoaded===n)){if(this.waitForCdnTuneIn(r))break;this.state=Qr.IDLE;break}if(this.hls.nextLoadLevel!==this.level){this.state=Qr.IDLE;break}break}case Qr.FRAG_LOADING_WAITING_RETRY:{var e;const t=self.performance.now(),n=this.retryDate;if(!n||t>=n||null!=(e=this.media)&&e.seeking){const{levels:e,level:t}=this,n=null==e?void 0:e[t];this.resetStartWhenNotLoaded(n||null),this.state=Qr.IDLE}}break}this.state===Qr.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:n,media:r}=this;if(null===t||!r&&(this.startFragRequested||!e.config.startFragPrefetch))return;if(this.altAudio&&this.audioOnly)return;const i=e.nextLoadLevel;if(null==n||!n[i])return;const o=n[i],a=this.getMainFwdBufferInfo();if(null===a)return;const s=this.getLevelDetails();if(s&&this._streamEnded(a,s)){const e={};return this.altAudio&&(e.type="video"),this.hls.trigger(E.BUFFER_EOS,e),void(this.state=Qr.ENDED)}e.loadLevel!==i&&-1===e.manualLevel&&this.log(`Adapting to level ${i} from level ${this.level}`),this.level=e.nextLoadLevel=i;const l=o.details;if(!l||this.state===Qr.WAITING_LEVEL||l.live&&this.levelLastLoaded!==o)return this.level=i,void(this.state=Qr.WAITING_LEVEL);const u=a.len,c=this.getMaxBufferLength(o.maxBitrate);if(u>=c)return;this.backtrackFragment&&this.backtrackFragment.start>a.end&&(this.backtrackFragment=null);const d=this.backtrackFragment?this.backtrackFragment.start:a.end;let f=this.getNextFragment(d,l);if(this.couldBacktrack&&!this.fragPrevious&&f&&"initSegment"!==f.sn&&this.fragmentTracker.getState(f)!==Tr.OK){var h;const e=(null!=(h=this.backtrackFragment)?h:f).sn,t=e-l.startSN,n=l.fragments[t-1];n&&f.cc===n.cc&&(f=n,this.fragmentTracker.removeFragment(n))}else this.backtrackFragment&&a.len&&(this.backtrackFragment=null);if(f&&this.isLoopLoading(f,d)){const e=f.gap;if(!e){const e=this.audioOnly&&!this.altAudio?j.AUDIO:j.VIDEO,t=(e===j.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;t&&this.afterBufferFlushed(t,e,Jt.MAIN)}f=this.getNextFragmentLoopLoading(f,l,a,Jt.MAIN,c)}f&&(!f.initSegment||f.initSegment.data||this.bitrateTest||(f=f.initSegment),this.loadFragment(f,o,d))}loadFragment(e,t,n){const r=this.fragmentTracker.getState(e);this.fragCurrent=e,r===Tr.NOT_LOADED||r===Tr.PARTIAL?"initSegment"===e.sn?this._loadInitSegment(e,t):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,super.loadFragment(e,t,n)):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,Jt.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(null!=t&&t.readyState){let n;const r=this.getAppendedFrag(t.currentTime);r&&r.start>1&&this.flushMainBuffer(0,r.start-1);const i=this.getLevelDetails();if(null!=i&&i.live){const e=this.getMainFwdBufferInfo();if(!e||e.len<2*i.targetduration)return}if(!t.paused&&e){const t=this.hls.nextLoadLevel,r=e[t],i=this.fragLastKbps;n=i&&this.fragCurrent?this.fragCurrent.duration*r.maxBitrate/(1e3*i)+1:0}else n=0;const o=this.getBufferedFrag(t.currentTime+n);if(o){const e=this.followingBufferedFrag(o);if(e){this.abortCurrentFrag();const t=e.maxStartPTS?e.maxStartPTS:e.start,n=e.duration,r=Math.max(o.end,t+Math.min(Math.max(n-this.config.maxFragLookUpTolerance,n*(this.couldBacktrack?.5:.125)),n*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(r,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case Qr.KEY_LOADING:case Qr.FRAG_LOADING:case Qr.FRAG_LOADING_WAITING_RETRY:case Qr.PARSING:case Qr.PARSED:this.state=Qr.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const n=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),n.addEventListener("playing",this.onvplaying),n.addEventListener("seeked",this.onvseeked),this.gapController=new Nl(this.config,n,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const e=this.media,t=e?e.currentTime:null;T(t)&&this.log("Media seeked to "+t.toFixed(3));const n=this.getMainFwdBufferInfo();null!==n&&0!==n.len?this.tick():this.warn(`Main forward buffer length on "seeked" event ${n?n.len:"empty"})`)}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(E.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=this.fragLastKbps=0,this.levels=this.fragPlaying=this.backtrackFragment=this.levelLastLoaded=null,this.altAudio=this.audioOnly=this.startFragRequested=!1}onManifestParsed(e,t){let n=!1,r=!1;t.levels.forEach(e=>{const t=e.audioCodec;t&&(n=n||-1!==t.indexOf("mp4a.40.2"),r=r||-1!==t.indexOf("mp4a.40.5"))}),this.audioCodecSwitch=n&&r&&!Ol(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:n}=this;if(!n||this.state!==Qr.IDLE)return;const r=n[t.level];(!r.details||r.details.live&&this.levelLastLoaded!==r||this.waitForCdnTuneIn(r.details))&&(this.state=Qr.WAITING_LEVEL)}onLevelLoaded(e,t){var n;const{levels:r}=this,i=t.level,o=t.details,a=o.totalduration;if(!r)return void this.warn("Levels were reset while loading level "+i);this.log(`Level ${i} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""}, cc [${o.startCC}, ${o.endCC}] duration:${a}`);const s=r[i],l=this.fragCurrent;!l||this.state!==Qr.FRAG_LOADING&&this.state!==Qr.FRAG_LOADING_WAITING_RETRY||l.level!==t.level&&l.loader&&this.abortCurrentFrag();let u=0;if(o.live||null!=(n=s.details)&&n.live){var c;if(this.checkLiveUpdate(o),o.deltaUpdateFailed)return;u=this.alignPlaylists(o,s.details,null==(c=this.levelLastLoaded)?void 0:c.details)}if(s.details=o,this.levelLastLoaded=s,this.hls.trigger(E.LEVEL_UPDATED,{details:o,level:i}),this.state===Qr.WAITING_LEVEL){if(this.waitForCdnTuneIn(o))return;this.state=Qr.IDLE}this.startFragRequested?o.live&&this.synchronizeToLiveEdge(o):this.setStartPosition(o,u),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:r,payload:i}=e,{levels:o}=this;if(!o)return void this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);const a=o[n.level],s=a.details;if(!s)return this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),void this.fragmentTracker.removeFragment(n);const l=a.videoCodec,u=s.PTSKnown||!s.live,c=null==(t=n.initSegment)?void 0:t.data,d=this._getAudioCodec(a),f=this.transmuxer=this.transmuxer||new Oo(this.hls,Jt.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),h=r?r.index:-1,m=-1!==h,p=new Lr(n.level,n.sn,n.stats.chunkCount,i.byteLength,h,m),g=this.initPTS[n.cc];f.push(i,c,d,l,n,r,s.totalduration,u,p,g)}onAudioTrackSwitching(e,t){const n=this.altAudio,r=!!t.url;if(!r){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const e=this.fragCurrent;e&&(this.log("Switching to main audio track, cancel main fragment load"),e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const e=this.hls;n&&(e.trigger(E.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),e.trigger(E.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const n=t.id,r=!!this.hls.audioTracks[n].url;if(r){const e=this.videoBuffer;e&&this.mediaBuffer!==e&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=e)}this.altAudio=r,this.tick()}onBufferCreated(e,t){const n=t.tracks;let r,i,o=!1;for(const a in n){const e=n[a];if("main"===e.id){if(i=a,r=e,"video"===a){const e=n[a];e&&(this.videoBuffer=e.buffer)}}else o=!0}o&&r?(this.log(`Alternate track found, use ${i}.buffered to schedule main fragment loading`),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:n,part:r}=t;if(n&&n.type!==Jt.MAIN)return;if(this.fragContextChanged(n))return this.warn(`Fragment ${n.sn}${r?" p: "+r.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),void(this.state===Qr.PARSED&&(this.state=Qr.IDLE));const i=r?r.stats:n.stats;this.fragLastKbps=Math.round(8*i.total/(i.buffering.end-i.loading.first)),"initSegment"!==n.sn&&(this.fragPrevious=n),this.fragBufferedComplete(n,r)}onError(e,t){var n;if(t.fatal)this.state=Qr.ERROR;else switch(t.details){case A.FRAG_GAP:case A.FRAG_PARSING_ERROR:case A.FRAG_DECRYPT_ERROR:case A.FRAG_LOAD_ERROR:case A.FRAG_LOAD_TIMEOUT:case A.KEY_LOAD_ERROR:case A.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Jt.MAIN,t);break;case A.LEVEL_LOAD_ERROR:case A.LEVEL_LOAD_TIMEOUT:case A.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==Qr.WAITING_LEVEL||(null==(n=t.context)?void 0:n.type)!==Xt.LEVEL||(this.state=Qr.IDLE);break;case A.BUFFER_APPEND_ERROR:case A.BUFFER_FULL_ERROR:if(!t.parent||"main"!==t.parent)return;if(t.details===A.BUFFER_APPEND_ERROR)return void this.resetLoadingState();this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case A.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}checkBuffer(){const{media:e,gapController:t}=this;if(e&&t&&e.readyState){if(this.loadedmetadata||!Ar.getBuffered(e).length){const e=this.state!==Qr.IDLE?this.fragCurrent:null;t.poll(this.lastCurrentTime,e)}this.lastCurrentTime=e.currentTime}}onFragLoadEmergencyAborted(){this.state=Qr.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==j.AUDIO||this.audioOnly&&!this.altAudio){const e=(t===j.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(e,t,Jt.MAIN),this.tick()}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let n=this.startPosition;if(n>=0&&t<n){if(e.seeking)return void this.log(`could not seek to ${n}, already seeking at ${t}`);const r=Ar.getBuffered(e),i=r.length?r.start(0):0,o=i-n;o>0&&(o<this.config.maxBufferHole||o<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${o} to match buffer start`),n+=o,this.startPosition=n),this.log(`seek to target start position ${n} from current time ${t}`),e.currentTime=n}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(n=>{const{hls:r}=this;if(!n||this.fragContextChanged(e))return;t.fragmentError=0,this.state=Qr.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const i=e.stats;i.parsing.start=i.parsing.end=i.buffering.start=i.buffering.end=self.performance.now(),r.trigger(E.FRAG_LOADED,n),e.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const n="main",{hls:r}=this,{remuxResult:i,chunkMeta:o}=e,a=this.getCurrentContext(o);if(!a)return void this.resetWhenMissingContext(o);const{frag:s,part:l,level:u}=a,{video:c,text:d,id3:f,initSegment:h}=i,{details:m}=u,p=this.altAudio?void 0:i.audio;if(this.fragContextChanged(s))this.fragmentTracker.removeFragment(s);else{if(this.state=Qr.PARSING,h){if(null!=h&&h.tracks){const e=s.initSegment||s;this._bufferInitSegment(u,h.tracks,e,o),r.trigger(E.FRAG_PARSING_INIT_SEGMENT,{frag:e,id:n,tracks:h.tracks})}const e=h.initPTS,t=h.timescale;T(e)&&(this.initPTS[s.cc]={baseTime:e,timescale:t},r.trigger(E.INIT_PTS_FOUND,{frag:s,id:n,initPTS:e,timescale:t}))}if(c&&m&&"initSegment"!==s.sn){const e=m.fragments[s.sn-1-m.startSN],t=s.sn===m.startSN,n=!e||s.cc>e.cc;if(!1!==i.independent){const{startPTS:e,endPTS:r,startDTS:i,endDTS:a}=c;if(l)l.elementaryStreams[c.type]={startPTS:e,endPTS:r,startDTS:i,endDTS:a};else if(c.firstKeyFrame&&c.independent&&1===o.id&&!n&&(this.couldBacktrack=!0),c.dropped&&c.independent){const i=this.getMainFwdBufferInfo(),o=(i?i.end:this.getLoadPosition())+this.config.maxBufferHole,l=c.firstKeyFramePTS?c.firstKeyFramePTS:e;if(!t&&o<l-this.config.maxBufferHole&&!n)return void this.backtrack(s);n&&(s.gap=!0),s.setElementaryStreamInfo(c.type,s.start,r,s.start,a,!0)}else t&&e>Il&&(s.gap=!0);s.setElementaryStreamInfo(c.type,e,r,i,a),this.backtrackFragment&&(this.backtrackFragment=s),this.bufferFragmentData(c,s,l,o,t||n)}else{if(!t&&!n)return void this.backtrack(s);s.gap=!0}}if(p){const{startPTS:e,endPTS:t,startDTS:n,endDTS:r}=p;l&&(l.elementaryStreams[j.AUDIO]={startPTS:e,endPTS:t,startDTS:n,endDTS:r}),s.setElementaryStreamInfo(j.AUDIO,e,t,n,r),this.bufferFragmentData(p,s,l,o)}if(m&&null!=f&&null!=(t=f.samples)&&t.length){const e={id:n,frag:s,details:m,samples:f.samples};r.trigger(E.FRAG_PARSING_METADATA,e)}if(m&&d){const e={id:n,frag:s,details:m,samples:d.samples};r.trigger(E.FRAG_PARSING_USERDATA,e)}}}_bufferInitSegment(e,t,n,r){if(this.state!==Qr.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;const{audio:i,video:o,audiovideo:a}=t;if(i){let t=e.audioCodec;const n=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){t&&(t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5");const e=i.metadata;e&&"channelCount"in e&&1!==(e.channelCount||1)&&-1===n.indexOf("firefox")&&(t="mp4a.40.5")}t&&-1!==t.indexOf("mp4a.40.5")&&-1!==n.indexOf("android")&&"audio/mpeg"!==i.container&&(t="mp4a.40.2",this.log("Android: force audio codec to "+t)),e.audioCodec&&e.audioCodec!==t&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${t}"`),i.levelCodec=t,i.id="main",this.log(`Init audio buffer, container:${i.container}, codecs[selected/level/parsed]=[${t||""}/${e.audioCodec||""}/${i.codec}]`)}o&&(o.levelCodec=e.videoCodec,o.id="main",this.log(`Init video buffer, container:${o.container}, codecs[level/parsed]=[${e.videoCodec||""}/${o.codec}]`)),a&&this.log(`Init audiovideo buffer, container:${a.container}, codecs[level/parsed]=[${e.codecs}/${a.codec}]`),this.hls.trigger(E.BUFFER_CODECS,t),Object.keys(t).forEach(e=>{const i=t[e],o=i.initSegment;null!=o&&o.byteLength&&this.hls.trigger(E.BUFFER_APPENDING,{type:e,data:o,frag:n,part:null,chunkMeta:r,parent:n.type})}),this.tickImmediate()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,Jt.MAIN)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=Qr.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&!1===e.seeking){const n=e.currentTime;if(Ar.isBuffered(e,n)?t=this.getAppendedFrag(n):Ar.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;const e=this.fragPlaying,n=t.level;e&&t.sn===e.sn&&e.level===n||(this.fragPlaying=t,this.hls.trigger(E.FRAG_CHANGED,{frag:t}),e&&e.level===n||this.hls.trigger(E.LEVEL_SWITCHED,{level:n}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){const e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){const e=this.media;if(e){const t=e.currentTime,n=this.currentFrag;if(n&&T(t)&&T(n.programDateTime)){const e=n.programDateTime+1e3*(t-n.start);return new Date(e)}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class $l{static get version(){return"1.5.15"}static isMSESupported(){return Al()}static isSupported(){return Ll()}static getMediaSource(){return St()}static get Events(){return E}static get ErrorTypes(){return _}static get ErrorDetails(){return A}static get DefaultConfig(){return $l.defaultConfig?$l.defaultConfig:yl}static set DefaultConfig(e){$l.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this.started=!1,this._emitter=new Lo,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,this.triggeringException=void 0,M(e.debug||!1,"Hls instance");const t=this.config=Sl($l.DefaultConfig,e);this.userConfig=e,t.progressive&&Cl(t);const{abrController:n,bufferController:r,capLevelController:i,errorController:o,fpsController:a}=t,s=new o(this),l=this.abrController=new n(this),u=this.bufferController=new r(this),c=this.capLevelController=new i(this),d=new a(this),f=new en(this),h=new gn(this),m=t.contentSteeringController,p=m?new m(this):null,g=this.levelController=new Dl(this,p),v=new Dr(this),b=new El(this.config),y=this.streamController=new Bl(this,v,b);c.setStreamController(y),d.setStreamController(y);const w=[f,g,y];p&&w.splice(1,0,p),this.networkControllers=w;const S=[l,u,c,d,h,v];this.audioTrackController=this.createController(t.audioTrackController,w);const x=t.audioStreamController;x&&w.push(new x(this,v,b)),this.subtitleTrackController=this.createController(t.subtitleTrackController,w);const C=t.subtitleStreamController;C&&w.push(new C(this,v,b)),this.createController(t.timelineController,S),b.emeController=this.emeController=this.createController(t.emeController,S),this.cmcdController=this.createController(t.cmcdController,S),this.latencyController=this.createController(vn,S),this.coreComponents=S,w.push(s);const T=s.onErrorOut;"function"===typeof T&&this.on(E.ERROR,T,s)}createController(e,t){if(e){const n=new e(this);return t&&t.push(n),n}return null}on(e,t,n=this){this._emitter.on(e,t,n)}once(e,t,n=this){this._emitter.once(e,t,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,n=this,r){this._emitter.off(e,t,n,r)}listeners(e){return this._emitter.listeners(e)}emit(e,t,n){return this._emitter.emit(e,t,n)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(n){if(N.error("An internal error happened while handling event "+e+'. Error message: "'+n.message+'". Here is a stacktrace:',n),!this.triggeringException){this.triggeringException=!0;const t=e===E.ERROR;this.trigger(E.ERROR,{type:_.OTHER_ERROR,details:A.INTERNAL_EXCEPTION,fatal:t,event:e,error:n}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){N.log("destroy"),this.trigger(E.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(e=>e.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(e=>e.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){N.log("attachMedia"),this._media=e,this.trigger(E.MEDIA_ATTACHING,{media:e})}detachMedia(){N.log("detachMedia"),this.trigger(E.MEDIA_DETACHING,void 0),this._media=null}loadSource(e){this.stopLoad();const t=this.media,n=this.url,r=this.url=v.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,N.log("loadSource:"+r),t&&n&&(n!==r||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(E.MANIFEST_LOADING,{url:e})}startLoad(e=-1){N.log(`startLoad(${e})`),this.started=!0,this.networkControllers.forEach(t=>{t.startLoad(e)})}stopLoad(){N.log("stopLoad"),this.started=!1,this.networkControllers.forEach(e=>{e.stopLoad()})}resumeBuffering(){this.started&&this.networkControllers.forEach(e=>{"fragmentLoader"in e&&e.startLoad(-1)})}pauseBuffering(){this.networkControllers.forEach(e=>{"fragmentLoader"in e&&e.stopLoad()})}swapAudioCodec(){N.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){N.log("recoverMediaError");const e=this._media;this.detachMedia(),e&&this.attachMedia(e)}removeLevel(e){this.levelController.removeLevel(e)}get levels(){const e=this.levelController.levels;return e||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){N.log("set currentLevel:"+e),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){N.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){N.log("set loadLevel:"+e),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){N.log("set firstLevel:"+e),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return-1===e&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){N.log("set startLevel:"+e),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(N.log("set autoLevelCapping:"+e),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){yn(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return-1===this.levelController.manualLevel}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const n=e.length;for(let r=0;r<n;r++)if(e[r].maxBitrate>=t)return r;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:n}=this;let r;if(r=-1===t&&null!=e&&e.length?e.length-1:t,n)for(let i=r;i--;){const t=e[i].attrs["HDCP-LEVEL"];if(t&&t<=n)return i}return r}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}setAudioOption(e){var t;return null==(t=this.audioTrackController)?void 0:t.setAudioOption(e)}setSubtitleOption(e){var t;return null==(t=this.subtitleTrackController)||t.setSubtitleOption(e),null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return!!e&&e.subtitleDisplay}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}$l.defaultConfig=void 0;var zl=n("2fb5"),Ul=n.n(zl),Vl={name:"myCoursePage",components:{BasicTable:o["a"],addDialog:s["default"],uploadVideo:c["default"],chapters:d["default"],workChapters:f["default"]},data(){return{loading:!1,remoteLoading:!1,openLiveVisible:!1,openCheckLiveVisible:!1,currentTeachers:[],openLiveData:{},supervisorAdOptions:[],categoryOptions:[],filterOptions:{column:[{type:"input",label:"课程编号",value:"number"},{type:"input",label:"订单编号",value:"orderNum"},{type:"input",label:"课程名称",value:"name"},{type:"select",label:"课程类别",value:"categoryId",labelKey:"name",valueKey:"id",options:[]},{type:"select",label:"课程套餐",value:"setMealCategoryId",labelKey:"name",valueKey:"id",options:[]},{type:"select",label:"课程标签",value:"tag",options:u["e"]},{type:"select",label:"是否免费",value:"hasFree",options:u["a"]},{type:"slot",slotName:"teacherAdId"}]},teacherOptions:[],filterData:{name:"",number:"",hasLive:"",teacherAdId:"",categoryId:"",hasFree:"",setMealCategoryId:""},table:{columns:[{id:1,prop:"number",label:"课程编号"},{id:99,prop:"orderNum",label:"订单编号"},{id:2,prop:"name",label:"课程名称",width:"160px"},{id:3,prop:"hasLive",label:"课程类型",render:e=>{const t=this.hasLiveOptions.find(t=>t.value==e.hasLive);return t?t.label:""}},{id:4,prop:"tag",label:"课程标签",render:e=>{const t=u["e"].find(t=>t.value==e.hasLive);return t?t.label:""}},{id:5,prop:"setMealCategoryId",label:"课程套餐",render:e=>{const t=this.$refs.addDialog.MealCategoryOptions.find(t=>t.id==e.setMealCategoryId);return t?t.name:"无"}},{id:6,prop:"categoryId",label:"课程类别",render:e=>{const t=this.$refs.addDialog.categoryOptions.find(t=>t.id==e.categoryId);return t?t.name:""}},{id:7,prop:"tag",label:"课程标签",render:e=>{const t=u["e"].find(t=>t.value==e.tag);return t?t.label:""}},{id:8,prop:"position",label:"推荐位",render:e=>{const t=u["c"].find(t=>t.value==e.position);return t?t.label:""}},{id:10,prop:"price",label:"价格"},{id:11,prop:"createAdName",label:"增加人"},{id:12,prop:"createTime",label:"增加时间",type:"date"},{id:13,prop:"sort",label:"排序"}],pageSize:20,currentPage:1,data:[],total:0},operates:[{key:"openLive",title:"一键开播",btnStyle:"green",permission:"",action:(e,t)=>{this.handleOpenLive(t)},show:e=>0===e.hasLive&&0===e.liveStatus},{key:"closeLive",title:"一键关播",btnStyle:"red",permission:"",action:(e,t)=>{this.handleCloseLive(t)},show:e=>0===e.hasLive&&1===e.liveStatus},{key:"checkLive",title:"直播巡查",btnStyle:"red",permission:"",action:(e,t)=>{console.log("row",t),this.handleCheckLive(t)},show:e=>0===e.hasLive&&1===e.liveStatus},{key:"edit",title:"上传回放",btnStyle:"yellow",permission:"",action:(e,t)=>{this.$refs.upload.open("上传录播",1,t.id)},show:e=>!1},{key:"upload",title:"上传直播回放",permission:"",btnStyle:"blue",action:(e,t)=>{this.$refs.upload.open("上传直播回放",2,t.id)},show:e=>!1},{key:"charpter",title:"章节详情",permission:"admin/adCourseChapters/list",btnStyle:"yellow",action:(e,t)=>{this.$refs.chapters.open(t)}},{key:"courseWork",title:"布置作业",permission:"admin/adCourseWork/add",btnStyle:"blue",action:(e,t)=>{this.$refs.workChaptersRef.open(t)}}]}},computed:{hasLiveOptions(){return this.$refs.addDialog?this.$refs.addDialog.hasLiveOptions:[]}},mounted(){this.$watch(()=>this.$refs.addDialog.categoryOptions,e=>{this.filterOptions.column[2].options=e}),this.$watch(()=>this.$refs.addDialog.MealCategoryOptions,e=>{this.filterOptions.column[3].options=e})},created(){this.getList()},methods:{initVideo(e,t=!0,n,r){n&&(this.chapterImage=n),this.player=new m.a({container:"#videoPlayer",title:r||"",src:e,live:t,autoplay:t,lang:"zh-cn",volume:.6,poster:this.chapterImage,muted:!1,height:"100%",preload:"auto",parse:{type:t?"hls":"mp4",loader:t?$l:""},plugins:[new Ul.a({contextmenu:[],customSetting:[]})]}),this.player.on("error",e=>{this.hanleVideoError(e)})},hanleVideoError(){this.emptyVisible=!0,1===this.info.adCourse.hasLive?this.emptyMessage="视频出错啦~，请重新加载！":this.emptyMessage="当前暂无直播"},searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0,a["a"].post({url:"/admin/adCourse/myList",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,...this.filterData},success:e=>{this.table.data=e.list,this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1}})},teacherRemoteMethod(e){e&&(this.remoteLoading=!0,a["a"].post({url:"/admin/adCourse/queryTeacherByNameOrTeacher",params:{keyword:e},success:e=>{this.remoteLoading=!1,this.teacherOptions=e},catch:()=>{this.remoteLoading=!1}}))},handleSuccess(){this.getList()},onCopy(){this.$message.success("复制成功")},handleClose(){this.openLiveData={}},handleCheckLiveClose(){this.openCheckLiveVisible=!1},handleOpenLive(e){this.$confirm("确定要开播此课程, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/admin/adCourse/liveOpenAdd",params:{id:e.id,orderNum:e.orderNum},success:e=>{this.openLiveData=e,this.openLiveVisible=!0,this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消开播"})})},handleCheckLive(e){this.currentTeachers=e.liveTeracher,this.openCheckLiveVisible=!0},watchLive(e){const t=l["a"].decryptByPublicKey(e.tLive);this.initVideo(t)},handleCloseLive(e){console.log("关播row",e),this.$confirm("确定要关闭该场直播, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/admin/adCourse/closeLiveEdit",params:{orderNum:e.orderNum},success:()=>{this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消关播"})})},clearFilter(){this.filterData={name:"",number:"",hasLive:"",teacherAdId:"",categoryId:"",hasFree:"",setMealCategoryId:""},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()},remoteMethod(e){e&&(this.remoteLoading=!0,a["a"].post({url:"/admin/adInfo/queryAdminByNameOrPhone",params:{search:e},success:e=>{this.remoteLoading=!1,this.supervisorAdOptions=e},catch:()=>{this.remoteLoading=!1}}))}}},Hl=Vl,jl=(n("46d9"),n("743b"),n("1805")),ql=Object(jl["a"])(Hl,r,i,!1,null,"44ef5c6e",null);t["default"]=ql.exports},9570:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.addModifyVisible,width:"50%"},on:{"update:visible":function(t){e.addModifyVisible=t},close:e.close}},[t("el-form",{ref:"categoryRef",attrs:{model:e.addData,rules:e.categoryRule,"label-position":"left","label-width":"90px"}},[t("el-form-item",{attrs:{label:"分类类型",prop:"type"}},[t("jat-select",{attrs:{placeholder:"请选择分类类型",clearable:""},model:{value:e.addData.type,callback:function(t){e.$set(e.addData,"type",t)},expression:"addData.type"}},e._l(e.typeOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"分类名称:",prop:"name"}},[t("jat-input",{attrs:{placeholder:"分类名称"},model:{value:e.addData.name,callback:function(t){e.$set(e.addData,"name",t)},expression:"addData.name"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)],1)},i=[],o=n("cbc3"),a=n("b775"),s=n("9adf"),l=(n("b893"),{components:{uploadImage:o["a"],tinymceEdit:s["a"]},data(){return{addModifyVisible:!1,dialogTitle:"",addData:{type:"",name:"",id:""},typeOptions:[{label:"文章分类",value:1},{label:"课程分类",value:2},{label:"银行账户分类",value:3},{label:"课程套餐",value:4}],categoryRule:{type:[{required:!0,message:"请选择分类类型",trigger:"blur"}],name:[{required:!0,message:"请输入分类名称",trigger:"blur"}]}}},mounted(){},methods:{open(){this.dialogTitle="添加分类",this.addData.name="",this.addModifyVisible=!0},edit({id:e,name:t,type:n}){this.dialogTitle="编辑分类",this.addModifyVisible=!0,this.addData={id:e,name:t,type:n}},close(){this.$refs.cateRef&&this.$refs.categoryRef.clearValidate(),this.addData={type:"",name:"",id:""},this.addModifyVisible=!1},handleSubmit(){this.$refs.categoryRef.validate(e=>{e&&(this.addData.id?a["a"].post({url:"/system/sysCategory/edit",params:{...this.addData},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}):a["a"].post({url:"/system/sysCategory/add",params:{...this.addData},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}))})}}}),u=l,c=n("1805"),d=Object(c["a"])(u,r,i,!1,null,"84e0e6ec",null);t["default"]=d.exports},9615:function(e,t,n){"use strict";n("fa5f")},"969e":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a}));var r=n("b775");const i=[{label:"小学",value:0},{label:"初中",value:1},{label:"高中",value:2},{label:"中专",value:3},{label:"专科",value:4},{label:"本科",value:5},{label:"硕士",value:6},{label:"博士",value:7}],o=[{label:"男",value:1},{label:"女",value:2}],a=e=>{r["a"].post({url:"/admin/adPromotionChannel/listNoPage",params:{},success:t=>{e(t)}})}},"971c":function(e,t,n){"use strict";n("9f12")},9842:function(e,t,n){n("4402")},"9adf":function(e,t,n){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"editorContent"},[t("Editor",{attrs:{init:e.init},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})],1)},i=[],o=(n("295d"),["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"]),a=function(e){return-1!==o.map((function(e){return e.toLowerCase()})).indexOf(e.toLowerCase())},s=function(e,t,n){Object.keys(t).filter(a).forEach((function(r){var i=t[r];"function"===typeof i&&("onInit"===r?i(e,n):n.on(r.substring(2),(function(e){return i(e,n)})))}))},l=function(e,t){var n=e.$props.modelEvents?e.$props.modelEvents:null,r=Array.isArray(n)?n.join(" "):n;t.on(r||"change input undo redo",(function(){e.$emit("input",t.getContent({format:e.$props.outputFormat}))}))},u=function(e,t,n){var r=t.$props.value?t.$props.value:"",i=t.$props.initialValue?t.$props.initialValue:"";n.setContent(r||(t.initialized?t.cache:i)),t.$watch("value",(function(e,r){n&&"string"===typeof e&&e!==r&&e!==n.getContent({format:t.$props.outputFormat})&&n.setContent(e)})),t.$listeners.input&&l(t,n),s(e,t.$listeners,n),t.initialized=!0},c=0,d=function(e){var t=Date.now(),n=Math.floor(1e9*Math.random());return c++,e+"_"+n+c+String(t)},f=function(e){return null!==e&&"textarea"===e.tagName.toLowerCase()},h=function(e){return"undefined"===typeof e||""===e?[]:Array.isArray(e)?e:e.split(" ")},m=function(e,t){return h(e).concat(h(t))},p=function(e){return null===e||void 0===e},g=function(){return{listeners:[],scriptId:d("tiny-script"),scriptLoaded:!1}},v=function(){var e=g(),t=function(e,t,n,r){var i=t.createElement("script");i.referrerPolicy="origin",i.type="application/javascript",i.id=e,i.src=n;var o=function(){i.removeEventListener("load",o),r()};i.addEventListener("load",o),t.head&&t.head.appendChild(i)},n=function(n,r,i){e.scriptLoaded?i():(e.listeners.push(i),n.getElementById(e.scriptId)||t(e.scriptId,n,r,(function(){e.listeners.forEach((function(e){return e()})),e.scriptLoaded=!0})))},r=function(){e=g()};return{load:n,reinitialize:r}},b=v(),y=n("82df"),w={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],value:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return"html"===e||"text"===e}}},S=function(){return S=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},S.apply(this,arguments)},x=function(e,t,n){return e(n||"div",{attrs:{id:t}})},C=function(e,t){return e("textarea",{attrs:{id:t},style:{visibility:"hidden"}})},T=function(e){return function(){var t=S(S({},e.$props.init),{readonly:e.$props.disabled,selector:"#"+e.elementId,plugins:m(e.$props.init&&e.$props.init.plugins,e.$props.plugins),toolbar:e.$props.toolbar||e.$props.init&&e.$props.init.toolbar,inline:e.inlineEditor,setup:function(t){e.editor=t,t.on("init",(function(n){return u(n,e,t)})),e.$props.init&&"function"===typeof e.$props.init.setup&&e.$props.init.setup(t)}});f(e.element)&&(e.element.style.visibility="",e.element.style.display=""),Object(y["a"])().init(t)}},D={props:w,created:function(){this.elementId=this.$props.id||d("tiny-vue"),this.inlineEditor=this.$props.init&&this.$props.init.inline||this.$props.inline,this.initialized=!1},watch:{disabled:function(){this.editor.setMode(this.disabled?"readonly":"design")}},mounted:function(){if(this.element=this.$el,null!==Object(y["a"])())T(this)();else if(this.element&&this.element.ownerDocument){var e=this.$props.cloudChannel?this.$props.cloudChannel:"5",t=this.$props.apiKey?this.$props.apiKey:"no-api-key",n=p(this.$props.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/"+t+"/tinymce/"+e+"/tinymce.min.js":this.$props.tinymceScriptSrc;b.load(this.element.ownerDocument,n,T(this))}},beforeDestroy:function(){null!==Object(y["a"])()&&Object(y["a"])().remove(this.editor)},deactivated:function(){var e;this.inlineEditor||(this.cache=this.editor.getContent(),null===(e=Object(y["a"])())||void 0===e||e.remove(this.editor))},activated:function(){!this.inlineEditor&&this.initialized&&T(this)()},render:function(e){return this.inlineEditor?x(e,this.elementId,this.$props.tagName):C(e,this.elementId)}},k=D,E=(n("1bba"),n("a57b"),n("9842"),n("b942"),n("e9eb"),n("d2f8"),n("458a"),n("b775")),_=n("4008"),A={model:{prop:"editorContent",event:"change"},props:{id:String,editorContent:String},data(){return{customDeleteTabs:!1,content:"",init:{height:"100%",accept:"image/jpeg, image/png, image/jpg",selector:"#tinymce",readonly:1,toolbar:"code undo redo restoredraft | cut copy paste pastetext | forecolor backcolor bold italic underline strikethrough link anchor | alignleft aligncenter alignright alignjustify outdent indent |     styleselect formatselect fontselect fontsizeselect | bullist numlist | blockquote subscript superscript removeformat |     table image media charmap emoticons hr pagebreak insertdatetime print preview | fullscreen | bdmap indent2em lineheight formatpainter axupimgs",font_formats:"微软雅黑=Microsoft YaHei,Helvetica Neue,PingFang SC,sans-serif;苹果苹方=PingFang SC,Microsoft YaHei,sans-serif;宋体=simsun,serif;仿宋体=FangSong,serif;黑体=SimHei,sans-serif;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;",language_url:window.location.origin+window.location.pathname+"static/tinymce5/langs/zh_CN.js",language:"zh_CN",skin_url:window.location.origin+window.location.pathname+"static/tinymce5/skins/ui/oxide",content_css:window.location.origin+window.location.pathname+"static/tinymce5/skins/content/default/content.min.css",plugins:["advlist","table","image","preview"],content_style:"body {background: #fff}",external_plugins:{powerpaste:window.location.origin+window.location.pathname+"static/tinymce5/plugins/powerpaste/plugin.min.js"},powerpaste_word_import:"merge",powerpaste_html_import:"merge",powerpaste_allow_local_images:!0,paste_data_images:!0,end_container_on_empty_block:!0,images_upload_handler:this.imagesUploadHandler}}},components:{Editor:k},created(){console.log(window.location.origin+"/static/tinymce5/skins/content/default/content.min.css"),this.content=this.editorContent},mounted(){},methods:{imagesUploadHandler(e,t){this.handleUpload(e.blob(),t)},handleUpload(e,t){try{E["a"].post({url:"/comm/getUpToken",params:{},success:n=>{const r=_["a"](e,null,n);r.subscribe({next:void 0,error:()=>{this.$message.error("上传出错，请重新上传！"),t("uploadFail")},complete:({key:e})=>{this.$message.success("上传成功！"),t(this.$envConfig.qiniuDomain+e)}})}})}catch(n){console.log(n),this.$message.error("上传出错，请重新上传！")}}},watch:{content(){this.$emit("change",this.content)},editorContent(e){this.content=e}}},L=A,O=(n("ae6b"),n("532c"),n("1805")),R=Object(O["a"])(L,r,i,!1,null,"4209945a",null);t["a"]=R.exports},"9bd3":function(e,t,n){},"9c27":function(e,t,n){},"9f12":function(e,t,n){},"9f30":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.addModifyVisible,width:"60%"},on:{"update:visible":function(t){e.addModifyVisible=t},close:e.close}},[t("el-form",{ref:"noticeRef",attrs:{model:e.addData,rules:e.noticeRule,"label-position":"left","label-width":"90px"}},[t("el-form-item",{attrs:{label:"公告名称:",prop:"name"}},[t("jat-input",{attrs:{placeholder:"请输入公告名称"},model:{value:e.addData.name,callback:function(t){e.$set(e.addData,"name",t)},expression:"addData.name"}})],1),t("el-form-item",{attrs:{label:"公告时间:",prop:"noticeTime"}},[t("jat-date-picker",{attrs:{width:"300px",clearable:"",type:"daterange"},model:{value:e.addData.noticeTime,callback:function(t){e.$set(e.addData,"noticeTime",t)},expression:"addData.noticeTime"}})],1),t("el-form-item",{attrs:{label:"封面:",prop:"image"}},[t("upload-image",{model:{value:e.addData.image,callback:function(t){e.$set(e.addData,"image",t)},expression:"addData.image"}})],1),t("el-form-item",{attrs:{label:"公告内容:",prop:"content"}},[t("tinymce-edit",{model:{value:e.addData.content,callback:function(t){e.$set(e.addData,"content",t)},expression:"addData.content"}})],1),t("el-form-item",{attrs:{label:"排序:",prop:"sort"}},[t("jat-input",{attrs:{placeholder:"请输入排序"},model:{value:e.addData.sort,callback:function(t){e.$set(e.addData,"sort",e._n(t))},expression:"addData.sort"}})],1),t("el-form-item",{attrs:{label:"描述:",prop:"remark"}},[t("jat-input",{attrs:{type:"textarea",rows:6,placeholder:"请输入描述"},model:{value:e.addData.remark,callback:function(t){e.$set(e.addData,"remark",t)},expression:"addData.remark"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)],1)},i=[],o=n("cbc3"),a=n("b775"),s=n("9adf"),l=n("b893"),u={components:{uploadImage:o["a"],tinymceEdit:s["a"]},data(){return{addModifyVisible:!1,dialogTitle:"",addData:{name:"",image:"",noticeTime:[],content:"",remark:"",sort:null,id:""},categoryOptions:[],noticeRule:{name:[{required:!0,message:"请输入公告名称",trigger:"blur"}],noticeTime:[{required:!0,message:"请输入公告时间",trigger:"blur"}],content:[{required:!0,message:"请输入公告内容",trigger:"blur"}],sort:[{type:"number",required:!1,message:"请输入整数"}]}}},mounted(){},methods:{open(){this.dialogTitle="添加公告",this.addModifyVisible=!0},edit({id:e,name:t,image:n,remark:r,stratTime:i,endTime:o,sort:a,content:s}){this.dialogTitle="编辑公告",this.addModifyVisible=!0,this.addData={id:e,name:t,image:n,remark:r,sort:a,content:s,noticeTime:i&&o&&[Object(l["b"])(i),Object(l["b"])(o)]}},close(){this.$refs.noticeRef&&this.$refs.noticeRef.clearValidate(),this.addData={name:"",image:"",noticeTime:[],content:"",remark:"",sort:null,id:""},this.addModifyVisible=!1},handleSubmit(){this.$refs.noticeRef.validate(e=>{const{noticeTime:t,...n}=this.addData,r={startTime:t&&t.length>0&&t[0],endTime:t&&t.length>0&&t[1]};e&&(this.addData.id?a["a"].post({url:"/system/sysNotice/edit",params:{...n,...r},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}):a["a"].post({url:"/system/sysNotice/add",params:{...n,...r},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}))})}}},c=u,d=n("1805"),f=Object(d["a"])(c,r,i,!1,null,"570d9ce8",null);t["default"]=f.exports},"9f4d":function(e,t,n){"use strict";n("9c27")},a0f2:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-drawer",{attrs:{visible:e.drawer,title:"详情"},on:{"update:visible":function(t){e.drawer=t}}},[t("el-descriptions",{staticClass:"margin-top",attrs:{column:1,border:""}},[t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" 收款单位 ")]),e._v(" "+e._s(e.info.vipName)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" 数量 ")]),e._v(" "+e._s(e.info.count)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" 收款方式 ")]),e._v(" "+e._s(e.info.name)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" 应收金额 ")]),e._v(" "+e._s(e.info.receivablePrice)+" ")],2),e.info.aa?t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" 收款明细 ")]),e._v(" "+e._s(e.info.aa)+" ")],2):e._e(),t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" 收款备注 ")]),e._v(" "+e._s(e.info.remark)+" ")],2),t("el-descriptions-item",[t("template",{slot:"label"},[e._v(" 水单 ")]),t("el-image",{staticStyle:{width:"50px"},attrs:{src:e.info.receiptUrl,"preview-src-list":e.info.imageArr}})],2)],1)],1)],1)},i=[],o={data(){return{drawer:!1,info:{}}},methods:{open(e){console.log("row",e),this.info=e,this.drawer=!0},close(){this.info={},this.drawer=!1}}},a=o,s=n("1805"),l=Object(s["a"])(a,r,i,!1,null,"49612029",null);t["default"]=l.exports},a140:function(e,t,n){},a2f0:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:"审核作业","close-on-click-modal":!1,visible:e.addModifyVisible,"append-to-body":!0,width:"50%"},on:{"update:visible":function(t){e.addModifyVisible=t},close:e.close}},[t("el-form",{ref:"auditRef",attrs:{model:e.addData,rules:e.workRule,"label-position":"left","label-width":"120px"}},[t("el-form-item",{attrs:{label:"作业图片:",prop:"comment"}},[t("div",{staticStyle:{display:"flex",gap:"20px"}},e._l(e.addData.url,(function(n,r){return t("el-image",{key:r,staticStyle:{width:"100px",height:"100px"},attrs:{src:n,"preview-src-list":e.addData.url}})})),1)]),t("el-form-item",{attrs:{label:"点评内容:",prop:"comment"}},[t("jat-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入点评内容"},model:{value:e.addData.comment,callback:function(t){e.$set(e.addData,"comment",t)},expression:"addData.comment"}})],1),t("el-form-item",{attrs:{label:"状态:",prop:"status"}},[t("jat-select",{attrs:{placeholder:"请选择状态",clearable:""},model:{value:e.addData.status,callback:function(t){e.$set(e.addData,"status",t)},expression:"addData.status"}},[t("el-option",{attrs:{label:"正常显示",value:0}}),t("el-option",{attrs:{label:"隐藏",value:1}})],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)],1)},i=[],o=n("b775"),a={name:"auditWork",components:{},data(){return{addModifyVisible:!1,dialogTitle:"",addData:{comment:"",status:"",sWorkId:"",url:[]},workRule:{status:[{required:!0,message:"请选择状态",trigger:"blur"}]}}},mounted(){},methods:{open(e){this.addData.sWorkId=e.sWorkId,this.addData.url=e.workUrl,this.addModifyVisible=!0,console.log("addData",this.addData)},close(){this.$refs.auditRef&&this.$refs.auditRef.clearValidate(),this.addData={comment:"",status:"",sWorkId:""},this.addModifyVisible=!1},handleSubmit(){this.$refs.auditRef.validate(e=>{e&&o["a"].post({url:"/admin/adCourseWorkSubmit/auditWorkEdit",params:{...this.addData},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}})})}}},s=a,l=n("1805"),u=Object(l["a"])(s,r,i,!1,null,"eaddd006",null);t["default"]=u.exports},a55b3:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"login"}},[e.$store.state.isPhone?e._e():t("div",{staticClass:"back_img"},[t("div",{staticClass:"shade"},[t("div",{staticClass:"title",staticStyle:{display:"flex","align-items":"center","justify-content":"center"}},[t("el-image",{staticStyle:{width:"55px",height:"55px"},attrs:{src:n("e723")}}),t("span",{staticStyle:{"margin-left":"10px"}},[e._v("优师课堂智能后台")])],1)])]),t("div",{staticClass:"form"},[t("el-form",{ref:"login",attrs:{model:e.params,"status-icon":"",rules:e.rules,"hide-required-asterisk":!0},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitForm()}}},[t("div",{staticClass:"form_title"},[e._v("登 录")]),t("el-form-item",{attrs:{prop:"account"}},[t("el-input",{attrs:{placeholder:"账号","prefix-icon":"el-icon-user"},model:{value:e.params.account,callback:function(t){e.$set(e.params,"account",t)},expression:"params.account"}})],1),t("el-form-item",{attrs:{prop:"password"}},[t("el-input",{attrs:{placeholder:"密码",type:"password","prefix-icon":"el-icon-lock","show-password":""},model:{value:e.params.password,callback:function(t){e.$set(e.params,"password",t)},expression:"params.password"}})],1),t("el-checkbox",{on:{change:e.rememberChange},model:{value:e.remember,callback:function(t){e.remember=t},expression:"remember"}},[e._v("记住密码")]),t("el-button",{staticClass:"form_btn",attrs:{type:"primary",loading:e.loading},on:{click:e.submitForm}},[e._v("登录")])],1)],1)])},i=[],o=(n("5948"),n("97ba"),n("c0eb")),a=n("5258"),s=n("1f46"),l={components:{ImgCode:o["a"]},data(){return{remember:!1,logo:n("4ffd"),redirect:void 0,otherQuery:{},params:{account:"",password:"",code:"",verifySign:""},rules:{account:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"}]},verifyCode:{codeUrl:"",sign:"",code:""},loading:!1}},mounted(){sessionStorage.removeItem("adminToken"),sessionStorage.removeItem("menuList");var e=localStorage.getItem("pfaccount"),t=localStorage.getItem("pfpwd"),n=localStorage.getItem("pfremeber");this.$common.checkNull(e,t)&&(this.params.account=e,this.params.password=t,n&&(this.remember=!0))},methods:{rememberChange(){this.remember||(localStorage.removeItem("pfaccount"),localStorage.removeItem("pfpwd"))},submitForm(){this.$refs["login"].validate(e=>{if(!e)return!1;this.loading=!0,this.$request.post({url:"admin/adInfo/public/login",params:{account:a["a"].encryptByPublicKey(this.params.account),password:a["a"].encryptByPublicKey(this.params.password),verifyCode:this.params.code,verifySign:this.params.verifySign},success:e=>{this.remember&&(localStorage.setItem("pfaccount",this.params.account),localStorage.setItem("pfpwd",this.params.password)),localStorage.setItem("pfremeber",this.remember),sessionStorage.setItem("adminToken",e.token),sessionStorage.setItem("userName",e.name),sessionStorage.setItem("id",e.id),sessionStorage.setItem("roleId",e.roleId),sessionStorage.setItem("interfaceList",JSON.stringify(e.interfaceList));const t=e.menuList;if(sessionStorage.setItem("menuList",JSON.stringify(t)),sessionStorage.setItem("roleName",e.roleName),s["a"].init(),1===e.id)this.$router.push({path:this.redirect||"/orderManage/index",query:this.otherQuery});else{const e=t.findIndex(e=>"系统设置"===e.menuName);if(-1!==e)this.$router.push({path:this.redirect||"/orderManage/index",query:this.otherQuery});else{const e=t.filter(e=>2===e.flag);e&&e.length>0&&this.$router.push({path:this.redirect||e[0].requestUrl,query:this.otherQuery})}}localStorage.setItem("perList",JSON.stringify(e.preList)),this.$message.success("登录成功")},allError:e=>{this.$refs.imgCode.getImgCode()},finally:()=>{this.loading=!1}})})},resetForm(){this.$refs["login"].resetFields()},getMenus(){this.loading=!0,this.$request.post({url:"admin/roleMenu/getMenuUrl",success:e=>{sessionStorage.setItem("menuList",e);let t=decodeURIComponent(this.$route.query.redirect||"/");-1==t.indexOf("/")&&-1==t.indexOf("login")||(t="/manage/welcome"),localStorage.setItem("account",this.admin.account),this.$router.replace(t)},finally:()=>{this.loading=!1}})},getOtherQuery(e){return Object.keys(e).reduce((t,n)=>("redirect"!==n&&(t[n]=e[n]),t))}},watch:{$route:{handler:function(e){const t=e.query;t&&(this.redirect=t.redirect,this.otherQuery=this.getOtherQuery(t))},immediate:!0}}},u=l,c=(n("68b9"),n("1805")),d=Object(c["a"])(u,r,i,!1,null,"10b95ddc",null);t["default"]=d.exports},a57b:function(e,t,n){(function(e){(function(){"use strict";var t=function(e){var t=typeof e;return null===e?"null":"object"===t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t},n=function(e){return function(n){return t(n)===e}},r=function(e){return function(t){return typeof t===e}},i=function(e){return function(t){return e===t}},o=n("string"),a=n("object"),s=n("array"),l=i(null),u=r("boolean"),c=i(void 0),d=function(e){return null===e||void 0===e},f=function(e){return!d(e)},h=r("function"),m=r("number"),p=function(e,t){if(s(e)){for(var n=0,r=e.length;n<r;++n)if(!t(e[n]))return!1;return!0}return!1},g=function(){},v=function(e){return function(){return e()}},b=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e(t.apply(null,n))}},y=function(e,t){return function(n){return e(t(n))}},w=function(e){return function(){return e}},S=function(e){return e},x=function(e,t){return e===t};function C(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=t.concat(n);return e.apply(null,i)}}var T=function(e){return function(t){return!e(t)}},D=function(e){return function(){throw new Error(e)}},k=w(!1),E=w(!0),_=tinymce.util.Tools.resolve("tinymce.ThemeManager"),A=function(){return A=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},A.apply(this,arguments)};function L(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function O(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var R=function(){return I},I=function(){var e=function(e){return e()},t=S,n={fold:function(e,t){return e()},isSome:k,isNone:E,getOr:t,getOrThunk:e,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:w(null),getOrUndefined:w(void 0),or:t,orThunk:e,map:R,each:g,bind:R,exists:k,forall:E,filter:function(){return R()},toArray:function(){return[]},toString:w("none()")};return n}(),P=function(e){var t=w(e),n=function(){return i},r=function(t){return t(e)},i={fold:function(t,n){return n(e)},isSome:E,isNone:k,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return P(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?i:I},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return i},M=function(e){return null===e||void 0===e?I:P(e)},N={some:P,none:R,from:M},F=Array.prototype.slice,B=Array.prototype.indexOf,$=Array.prototype.push,z=function(e,t){return B.call(e,t)},U=function(e,t){var n=z(e,t);return-1===n?N.none():N.some(n)},V=function(e,t){return z(e,t)>-1},H=function(e,t){for(var n=0,r=e.length;n<r;n++){var i=e[n];if(t(i,n))return!0}return!1},j=function(e,t){for(var n=[],r=0;r<e;r++)n.push(t(r));return n},q=function(e,t){for(var n=[],r=0;r<e.length;r+=t){var i=F.call(e,r,r+t);n.push(i)}return n},G=function(e,t){for(var n=e.length,r=new Array(n),i=0;i<n;i++){var o=e[i];r[i]=t(o,i)}return r},W=function(e,t){for(var n=0,r=e.length;n<r;n++){var i=e[n];t(i,n)}},K=function(e,t){for(var n=e.length-1;n>=0;n--){var r=e[n];t(r,n)}},Y=function(e,t){for(var n=[],r=[],i=0,o=e.length;i<o;i++){var a=e[i],s=t(a,i)?n:r;s.push(a)}return{pass:n,fail:r}},X=function(e,t){for(var n=[],r=0,i=e.length;r<i;r++){var o=e[r];t(o,r)&&n.push(o)}return n},J=function(e,t,n){return K(e,(function(e,r){n=t(n,e,r)})),n},Q=function(e,t,n){return W(e,(function(e,r){n=t(n,e,r)})),n},Z=function(e,t,n){for(var r=0,i=e.length;r<i;r++){var o=e[r];if(t(o,r))return N.some(o);if(n(o,r))break}return N.none()},ee=function(e,t){return Z(e,t,k)},te=function(e,t){for(var n=0,r=e.length;n<r;n++){var i=e[n];if(t(i,n))return N.some(n)}return N.none()},ne=function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!s(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);$.apply(t,e[n])}return t},re=function(e,t){return ne(G(e,t))},ie=function(e,t){for(var n=0,r=e.length;n<r;++n){var i=e[n];if(!0!==t(i,n))return!1}return!0},oe=function(e){var t=F.call(e,0);return t.reverse(),t},ae=function(e,t){return X(e,(function(e){return!V(t,e)}))},se=function(e,t){for(var n={},r=0,i=e.length;r<i;r++){var o=e[r];n[String(o)]=t(o,r)}return n},le=function(e){return[e]},ue=function(e,t){var n=F.call(e,0);return n.sort(t),n},ce=function(e,t){return t>=0&&t<e.length?N.some(e[t]):N.none()},de=function(e){return ce(e,0)},fe=function(e){return ce(e,e.length-1)},he=h(Array.from)?Array.from:function(e){return F.call(e)},me=function(e,t){for(var n=0;n<e.length;n++){var r=t(e[n],n);if(r.isSome())return r}return N.none()},pe=Object.keys,ge=Object.hasOwnProperty,ve=function(e,t){for(var n=pe(e),r=0,i=n.length;r<i;r++){var o=n[r],a=e[o];t(a,o)}},be=function(e,t){return ye(e,(function(e,n){return{k:n,v:t(e,n)}}))},ye=function(e,t){var n={};return ve(e,(function(e,r){var i=t(e,r);n[i.k]=i.v})),n},we=function(e){return function(t,n){e[n]=t}},Se=function(e,t,n,r){var i={};return ve(e,(function(e,i){(t(e,i)?n:r)(e,i)})),i},xe=function(e,t){var n={};return Se(e,t,we(n),g),n},Ce=function(e,t){var n=[];return ve(e,(function(e,r){n.push(t(e,r))})),n},Te=function(e,t){for(var n=pe(e),r=0,i=n.length;r<i;r++){var o=n[r],a=e[o];if(t(a,o,e))return N.some(a)}return N.none()},De=function(e){return Ce(e,S)},ke=function(e,t){return Ee(e,t)?N.from(e[t]):N.none()},Ee=function(e,t){return ge.call(e,t)},_e=function(e,t){return Ee(e,t)&&void 0!==e[t]&&null!==e[t]},Ae=function(e,t,n){return void 0===n&&(n=x),e.exists((function(e){return n(e,t)}))},Le=function(e,t,n){return void 0===n&&(n=x),Ie(e,t,n).getOr(e.isNone()&&t.isNone())},Oe=function(e){for(var t=[],n=function(e){t.push(e)},r=0;r<e.length;r++)e[r].each(n);return t},Re=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];if(!r.isSome())return N.none();t.push(r.getOrDie())}return N.some(t)},Ie=function(e,t,n){return e.isSome()&&t.isSome()?N.some(n(e.getOrDie(),t.getOrDie())):N.none()},Pe=function(e,t,n,r){return e.isSome()&&t.isSome()&&n.isSome()?N.some(r(e.getOrDie(),t.getOrDie(),n.getOrDie())):N.none()},Me=function(e,t){return void 0!==e&&null!==e?N.some(t(e)):N.none()},Ne=function(e,t){return e?N.some(t):N.none()},Fe=function(e,t){return e+t},Be=function(e,t){return e.substring(t)},$e=function(e,t,n){return""===t||e.length>=t.length&&e.substr(n,n+t.length)===t},ze=function(e,t){return He(e,t)?Be(e,t.length):e},Ue=function(e,t){return je(e,t)?e:Fe(e,t)},Ve=function(e,t){return-1!==e.indexOf(t)},He=function(e,t){return $e(e,t,0)},je=function(e,t){return $e(e,t,e.length-t.length)},qe=function(e){return function(t){return t.replace(e,"")}},Ge=qe(/^\s+|\s+$/g),We=function(e){return e.length>0},Ke=function(e){return!We(e)},Ye=function(e){return void 0!==e.style&&h(e.style.getPropertyValue)},Xe=function(e,t){var n=t||document,r=n.createElement("div");if(r.innerHTML=e,!r.hasChildNodes()||r.childNodes.length>1)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return Ze(r.childNodes[0])},Je=function(e,t){var n=t||document,r=n.createElement(e);return Ze(r)},Qe=function(e,t){var n=t||document,r=n.createTextNode(e);return Ze(r)},Ze=function(e){if(null===e||void 0===e)throw new Error("Node cannot be null or undefined");return{dom:e}},et=function(e,t,n){return N.from(e.dom.elementFromPoint(t,n)).map(Ze)},tt={fromHtml:Xe,fromTag:Je,fromText:Qe,fromDom:Ze,fromPoint:et};"undefined"!==typeof window?window:Function("return this;")();var nt,rt=9,it=11,ot=1,at=3,st=function(e){var t=e.dom.nodeName;return t.toLowerCase()},lt=function(e){return e.dom.nodeType},ut=function(e){return function(t){return lt(t)===e}},ct=ut(ot),dt=ut(at),ft=ut(rt),ht=ut(it),mt=function(e){var t,n=!1;return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return n||(n=!0,t=e.apply(null,r)),t}},pt=function(e,t,n,r){var i=e.isiOS()&&!0===/ipad/i.test(n),o=e.isiOS()&&!i,a=e.isiOS()||e.isAndroid(),s=a||r("(pointer:coarse)"),l=i||!o&&a&&r("(min-device-width:768px)"),u=o||a&&!l,c=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(n),d=!u&&!l&&!c;return{isiPad:w(i),isiPhone:w(o),isTablet:w(l),isPhone:w(u),isTouch:w(s),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:w(c),isDesktop:w(d)}},gt=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}},vt=function(e,t){var n=gt(e,t);if(!n)return{major:0,minor:0};var r=function(e){return Number(t.replace(n,"$"+e))};return wt(r(1),r(2))},bt=function(e,t){var n=String(t).toLowerCase();return 0===e.length?yt():vt(e,n)},yt=function(){return wt(0,0)},wt=function(e,t){return{major:e,minor:t}},St={nu:wt,detect:bt,unknown:yt},xt=function(e,t){return me(t.brands,(function(t){var n=t.brand.toLowerCase();return ee(e,(function(e){var t;return n===(null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())})).map((function(e){return{current:e.name,version:St.nu(parseInt(t.version,10),0)}}))}))},Ct=function(e,t){var n=String(t).toLowerCase();return ee(e,(function(e){return e.search(n)}))},Tt=function(e,t){return Ct(e,t).map((function(e){var n=St.detect(e.versionRegexes,t);return{current:e.name,version:n}}))},Dt=function(e,t){return Ct(e,t).map((function(e){var n=St.detect(e.versionRegexes,t);return{current:e.name,version:n}}))},kt=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Et=function(e){return function(t){return Ve(t,e)}},_t=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return Ve(e,"edge/")&&Ve(e,"chrome")&&Ve(e,"safari")&&Ve(e,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,kt],search:function(e){return Ve(e,"chrome")&&!Ve(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return Ve(e,"msie")||Ve(e,"trident")}},{name:"Opera",versionRegexes:[kt,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Et("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Et("firefox")},{name:"Safari",versionRegexes:[kt,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(Ve(e,"safari")||Ve(e,"mobile/"))&&Ve(e,"applewebkit")}}],At=[{name:"Windows",search:Et("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return Ve(e,"iphone")||Ve(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Et("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Et("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Et("linux"),versionRegexes:[]},{name:"Solaris",search:Et("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Et("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Et("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Lt={browsers:w(_t),oses:w(At)},Ot="Edge",Rt="Chrome",It="IE",Pt="Opera",Mt="Firefox",Nt="Safari",Ft=function(){return Bt({current:void 0,version:St.unknown()})},Bt=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isEdge:r(Ot),isChrome:r(Rt),isIE:r(It),isOpera:r(Pt),isFirefox:r(Mt),isSafari:r(Nt)}},$t={unknown:Ft,nu:Bt,edge:w(Ot),chrome:w(Rt),ie:w(It),opera:w(Pt),firefox:w(Mt),safari:w(Nt)},zt="Windows",Ut="iOS",Vt="Android",Ht="Linux",jt="OSX",qt="Solaris",Gt="FreeBSD",Wt="ChromeOS",Kt=function(){return Yt({current:void 0,version:St.unknown()})},Yt=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isWindows:r(zt),isiOS:r(Ut),isAndroid:r(Vt),isOSX:r(jt),isLinux:r(Ht),isSolaris:r(qt),isFreeBSD:r(Gt),isChromeOS:r(Wt)}},Xt={unknown:Kt,nu:Yt,windows:w(zt),ios:w(Ut),android:w(Vt),linux:w(Ht),osx:w(jt),solaris:w(qt),freebsd:w(Gt),chromeos:w(Wt)},Jt=function(e,t,n){var r=Lt.browsers(),i=Lt.oses(),o=t.bind((function(e){return xt(r,e)})).orThunk((function(){return Tt(r,e)})).fold($t.unknown,$t.nu),a=Dt(i,e).fold(Xt.unknown,Xt.nu),s=pt(a,o,e,n);return{browser:o,os:a,deviceType:s}},Qt={detect:Jt},Zt=function(e){return window.matchMedia(e).matches},en=mt((function(){return Qt.detect(navigator.userAgent,N.from(navigator.userAgentData),Zt)})),tn=function(){return en()},nn=function(e,t,n){return 0!==(e.compareDocumentPosition(t)&n)},rn=function(e,t){return nn(e,t,Node.DOCUMENT_POSITION_CONTAINED_BY)},on=function(e,t){var n=e.dom;if(n.nodeType!==ot)return!1;var r=n;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},an=function(e){return e.nodeType!==ot&&e.nodeType!==rt&&e.nodeType!==it||0===e.childElementCount},sn=function(e,t){var n=void 0===t?document:t.dom;return an(n)?[]:G(n.querySelectorAll(e),tt.fromDom)},ln=function(e,t){var n=void 0===t?document:t.dom;return an(n)?N.none():N.from(n.querySelector(e)).map(tt.fromDom)},un=function(e,t){return e.dom===t.dom},cn=function(e,t){var n=e.dom,r=t.dom;return n!==r&&n.contains(r)},dn=function(e,t){return rn(e.dom,t.dom)},fn=function(e,t){return tn().browser.isIE()?dn(e,t):cn(e,t)},hn=function(e){return tt.fromDom(e.dom.ownerDocument)},mn=function(e){return ft(e)?e:hn(e)},pn=function(e){return tt.fromDom(mn(e).dom.documentElement)},gn=function(e){return tt.fromDom(mn(e).dom.defaultView)},vn=function(e){return N.from(e.dom.parentNode).map(tt.fromDom)},bn=function(e){return vn(e)},yn=function(e){return N.from(e.dom.offsetParent).map(tt.fromDom)},wn=function(e){return N.from(e.dom.nextSibling).map(tt.fromDom)},Sn=function(e){return G(e.dom.childNodes,tt.fromDom)},xn=function(e,t){var n=e.dom.childNodes;return N.from(n[t]).map(tt.fromDom)},Cn=function(e){return xn(e,0)},Tn=function(e,t){return{element:e,offset:t}},Dn=function(e,t){var n=Sn(e);return n.length>0&&t<n.length?Tn(n[t],0):Tn(e,t)},kn=function(e){return ht(e)&&f(e.dom.host)},En=h(Element.prototype.attachShadow)&&h(Node.prototype.getRootNode),_n=w(En),An=En?function(e){return tt.fromDom(e.dom.getRootNode())}:mn,Ln=function(e){return kn(e)?e:tt.fromDom(mn(e).dom.body)},On=function(e){return Rn(e).isSome()},Rn=function(e){var t=An(e);return kn(t)?N.some(t):N.none()},In=function(e){return tt.fromDom(e.dom.host)},Pn=function(e){if(_n()&&f(e.target)){var t=tt.fromDom(e.target);if(ct(t)&&Mn(t)&&e.composed&&e.composedPath){var n=e.composedPath();if(n)return de(n)}}return N.from(e.target)},Mn=function(e){return f(e.dom.shadowRoot)},Nn=function(e){var t=dt(e)?e.dom.parentNode:e.dom;if(void 0===t||null===t||null===t.ownerDocument)return!1;var n=t.ownerDocument;return Rn(tt.fromDom(t)).fold((function(){return n.body.contains(t)}),y(Nn,In))},Fn=function(){return Bn(tt.fromDom(document))},Bn=function(e){var t=e.dom.body;if(null===t||void 0===t)throw new Error("Body is not available yet");return tt.fromDom(t)},$n=function(e,t,n){if(!(o(n)||u(n)||m(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},zn=function(e,t,n){$n(e.dom,t,n)},Un=function(e,t){var n=e.dom;ve(t,(function(e,t){$n(n,t,e)}))},Vn=function(e,t){var n=e.dom.getAttribute(t);return null===n?void 0:n},Hn=function(e,t){return N.from(Vn(e,t))},jn=function(e,t){var n=e.dom;return!(!n||!n.hasAttribute)&&n.hasAttribute(t)},qn=function(e,t){e.dom.removeAttribute(t)},Gn=function(e,t,n){if(!o(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);Ye(e)&&e.style.setProperty(t,n)},Wn=function(e,t){Ye(e)&&e.style.removeProperty(t)},Kn=function(e,t,n){var r=e.dom;Gn(r,t,n)},Yn=function(e,t){var n=e.dom;ve(t,(function(e,t){Gn(n,t,e)}))},Xn=function(e,t){var n=e.dom;ve(t,(function(e,t){e.fold((function(){Wn(n,t)}),(function(e){Gn(n,t,e)}))}))},Jn=function(e,t){var n=e.dom,r=window.getComputedStyle(n),i=r.getPropertyValue(t);return""!==i||Nn(e)?i:Qn(n,t)},Qn=function(e,t){return Ye(e)?e.style.getPropertyValue(t):""},Zn=function(e,t){var n=e.dom,r=Qn(n,t);return N.from(r).filter((function(e){return e.length>0}))},er=function(e){var t={},n=e.dom;if(Ye(n))for(var r=0;r<n.style.length;r++){var i=n.style.item(r);t[i]=n.style[i]}return t},tr=function(e,t,n){var r=tt.fromTag(e);Kn(r,t,n);var i=Zn(r,t);return i.isSome()},nr=function(e,t){var n=e.dom;Wn(n,t),Ae(Hn(e,"style").map(Ge),"")&&qn(e,"style")},rr=function(e){return e.dom.offsetWidth},ir=function(e,t){var n=function(t,n){if(!m(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);var r=t.dom;Ye(r)&&(r.style[e]=n+"px")},r=function(n){var r=t(n);if(r<=0||null===r){var i=Jn(n,e);return parseFloat(i)||0}return r},i=r,o=function(e,t){return Q(t,(function(t,n){var r=Jn(e,n),i=void 0===r?0:parseInt(r,10);return isNaN(i)?t:t+i}),0)},a=function(e,t,n){var r=o(e,n),i=t>r?t-r:0;return i};return{set:n,get:r,getOuter:i,aggregate:o,max:a}},or=ir("height",(function(e){var t=e.dom;return Nn(e)?t.getBoundingClientRect().height:t.offsetHeight})),ar=function(e){return or.get(e)},sr=function(e){return or.getOuter(e)},lr=function(e,t){var n=["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"],r=or.max(e,t,n);Kn(e,"max-height",r+"px")},ur=function(e,t){var n=function(n,r){return ur(e+n,t+r)};return{left:e,top:t,translate:n}},cr=ur,dr=function(e){var t=e.getBoundingClientRect();return cr(t.left,t.top)},fr=function(e,t){return void 0!==e?e:void 0!==t?t:0},hr=function(e){var t=e.dom.ownerDocument,n=t.body,r=t.defaultView,i=t.documentElement;if(n===e.dom)return cr(n.offsetLeft,n.offsetTop);var o=fr(null===r||void 0===r?void 0:r.pageYOffset,i.scrollTop),a=fr(null===r||void 0===r?void 0:r.pageXOffset,i.scrollLeft),s=fr(i.clientTop,n.clientTop),l=fr(i.clientLeft,n.clientLeft);return mr(e).translate(a-l,o-s)},mr=function(e){var t=e.dom,n=t.ownerDocument,r=n.body;return r===t?cr(r.offsetLeft,r.offsetTop):Nn(e)?dr(t):cr(0,0)},pr=ir("width",(function(e){return e.dom.offsetWidth})),gr=function(e,t){return pr.set(e,t)},vr=function(e){return pr.get(e)},br=function(e){return pr.getOuter(e)},yr=function(e,t){var n=["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"],r=pr.max(e,t,n);Kn(e,"max-width",r+"px")},wr=function(e,t,n,r,i,o,a){return{target:e,x:t,y:n,stop:r,prevent:i,kill:o,raw:a}},Sr=function(e){var t=tt.fromDom(Pn(e).getOr(e.target)),n=function(){return e.stopPropagation()},r=function(){return e.preventDefault()},i=b(r,n);return wr(t,e.clientX,e.clientY,n,r,i,e)},xr=function(e,t){return function(n){e(n)&&t(Sr(n))}},Cr=function(e,t,n,r,i){var o=xr(n,r);return e.dom.addEventListener(t,o,i),{unbind:C(kr,e,t,o,i)}},Tr=function(e,t,n,r){return Cr(e,t,n,r,!1)},Dr=function(e,t,n,r){return Cr(e,t,n,r,!0)},kr=function(e,t,n,r){e.dom.removeEventListener(t,n,r)},Er=function(e,t){var n=vn(e);n.each((function(n){n.dom.insertBefore(t.dom,e.dom)}))},_r=function(e,t){var n=wn(e);n.fold((function(){var n=vn(e);n.each((function(e){Lr(e,t)}))}),(function(e){Er(e,t)}))},Ar=function(e,t){var n=Cn(e);n.fold((function(){Lr(e,t)}),(function(n){e.dom.insertBefore(t.dom,n.dom)}))},Lr=function(e,t){e.dom.appendChild(t.dom)},Or=function(e,t,n){xn(e,n).fold((function(){Lr(e,t)}),(function(e){Er(e,t)}))},Rr=function(e,t){W(t,(function(t){Er(e,t)}))},Ir=function(e,t){W(t,(function(t){Lr(e,t)}))},Pr=function(e){e.dom.textContent="",W(Sn(e),(function(e){Mr(e)}))},Mr=function(e){var t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},Nr=function(e){var t=Sn(e);t.length>0&&Rr(e,t),Mr(e)},Fr=function(e){var t=void 0!==e?e.dom:document,n=t.body.scrollLeft||t.documentElement.scrollLeft,r=t.body.scrollTop||t.documentElement.scrollTop;return cr(n,r)},Br=function(e,t,n){var r=void 0!==n?n.dom:document,i=r.defaultView;i&&i.scrollTo(e,t)},$r=function(e){var t=void 0===e?window:e;return tn().browser.isFirefox()?N.none():N.from(t["visualViewport"])},zr=function(e,t,n,r){return{x:e,y:t,width:n,height:r,right:e+n,bottom:t+r}},Ur=function(e){var t=void 0===e?window:e,n=t.document,r=Fr(tt.fromDom(n));return $r(t).fold((function(){var e=t.document.documentElement,n=e.clientWidth,i=e.clientHeight;return zr(r.left,r.top,n,i)}),(function(e){return zr(Math.max(e.pageLeft,r.left),Math.max(e.pageTop,r.top),e.width,e.height)}))},Vr=function(e,t){var n=e.view(t);return n.fold(w([]),(function(t){var n=e.owner(t),r=Vr(e,n);return[t].concat(r)}))},Hr=function(e,t){var n=t.owner(e),r=Vr(t,n);return N.some(r)},jr=function(e){var t,n=e.dom===document?N.none():N.from(null===(t=e.dom.defaultView)||void 0===t?void 0:t.frameElement);return n.map(tt.fromDom)},qr=function(e){return hn(e)},Gr=Object.freeze({__proto__:null,view:jr,owner:qr}),Wr=function(e){var t=tt.fromDom(document),n=Fr(t),r=Hr(e,Gr);return r.fold(C(hr,e),(function(t){var r=mr(e),i=J(t,(function(e,t){var n=mr(t);return{left:e.left+n.left,top:e.top+n.top}}),{left:0,top:0});return cr(i.left+r.left+n.left,i.top+r.top+n.top)}))},Kr=function(e,t,n){return{point:e,width:t,height:n}},Yr=function(e,t,n,r){return{x:e,y:t,width:n,height:r}},Xr=function(e,t,n,r){return{x:e,y:t,width:n,height:r,right:e+n,bottom:t+r}},Jr=function(e){var t=hr(e),n=br(e),r=sr(e);return Xr(t.left,t.top,n,r)},Qr=function(e){var t=Wr(e),n=br(e),r=sr(e);return Xr(t.left,t.top,n,r)},Zr=function(){return Ur(window)},ei=function(e){var t=function(t){return ei(e)},n=function(t){return ei(e)},r=function(t){return ei(t(e))},i=function(t){return ei(e)},o=function(t){t(e)},a=function(t){return t(e)},s=function(t,n){return n(e)},l=function(t){return t(e)},u=function(t){return t(e)},c=function(){return N.some(e)};return{isValue:E,isError:k,getOr:w(e),getOrThunk:w(e),getOrDie:w(e),or:t,orThunk:n,fold:s,map:r,mapError:i,each:o,bind:a,exists:l,forall:u,toOptional:c}},ti=function(e){var t=function(e){return e()},n=function(){return D(String(e))()},r=S,i=function(e){return e()},o=function(t){return ti(e)},a=function(t){return ti(t(e))},s=function(t){return ti(e)},l=function(t,n){return t(e)};return{isValue:k,isError:E,getOr:S,getOrThunk:t,getOrDie:n,or:r,orThunk:i,fold:l,map:o,mapError:a,each:g,bind:s,exists:k,forall:E,toOptional:N.none}},ni=function(e,t){return e.fold((function(){return ti(t)}),ei)},ri={value:ei,error:ti,fromOption:ni};(function(e){e[e["Error"]=0]="Error",e[e["Value"]=1]="Value"})(nt||(nt={}));var ii=function(e,t,n){return e.stype===nt.Error?t(e.serror):n(e.svalue)},oi=function(e){var t=[],n=[];return W(e,(function(e){ii(e,(function(e){return n.push(e)}),(function(e){return t.push(e)}))})),{values:t,errors:n}},ai=function(e,t){return e.stype===nt.Error?{stype:nt.Error,serror:t(e.serror)}:e},si=function(e,t){return e.stype===nt.Value?{stype:nt.Value,svalue:t(e.svalue)}:e},li=function(e,t){return e.stype===nt.Value?t(e.svalue):e},ui=function(e,t){return e.stype===nt.Error?t(e.serror):e},ci=function(e){return{stype:nt.Value,svalue:e}},di=function(e){return{stype:nt.Error,serror:e}},fi=function(e){return ii(e,ri.error,ri.value)},hi=function(e){return e.fold(di,ci)},mi={fromResult:hi,toResult:fi,svalue:ci,partition:oi,serror:di,bind:li,bindError:ui,map:si,mapError:ai,fold:ii},pi=function(e,t,n,r){return{tag:"field",key:e,newKey:t,presence:n,prop:r}},gi=function(e,t){return{tag:"custom",newKey:e,instantiator:t}},vi=function(e,t,n){switch(e.tag){case"field":return t(e.key,e.newKey,e.presence,e.prop);case"custom":return n(e.newKey,e.instantiator)}},bi=function(e,t){return t},yi=function(e,t){var n=a(e)&&a(t);return n?Si(e,t):t},wi=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Can't merge zero objects");for(var r={},i=0;i<t.length;i++){var o=t[i];for(var a in o)Ee(o,a)&&(r[a]=e(r[a],o[a]))}return r}},Si=wi(yi),xi=wi(bi),Ci=function(){return{tag:"required",process:{}}},Ti=function(e){return{tag:"defaultedThunk",process:e}},Di=function(e){return Ti(w(e))},ki=function(){return{tag:"option",process:{}}},Ei=function(e){return{tag:"mergeWithThunk",process:e}},_i=function(e){return Ei(w(e))},Ai=function(e,t){return e.length>0?mi.svalue(Si(t,xi.apply(void 0,e))):mi.svalue(t)},Li=function(e){return b(mi.serror,ne)(e)},Oi=function(e,t){var n=mi.partition(e);return n.errors.length>0?Li(n.errors):Ai(n.values,t)},Ri=function(e){var t=mi.partition(e);return t.errors.length>0?Li(t.errors):mi.svalue(t.values)},Ii={consolidateObj:Oi,consolidateArr:Ri},Pi=function(e){return a(e)&&pe(e).length>100?" removed due to size":JSON.stringify(e,null,2)},Mi=function(e){var t=e.length>10?e.slice(0,10).concat([{path:[],getErrorInfo:w("... (only showing first ten failures)")}]):e;return G(t,(function(e){return"Failed path: ("+e.path.join(" > ")+")\n"+e.getErrorInfo()}))},Ni=function(e,t){return mi.serror([{path:e,getErrorInfo:t}])},Fi=function(e,t,n){return Ni(e,(function(){return'Could not find valid *required* value for "'+t+'" in '+Pi(n)}))},Bi=function(e,t){return Ni(e,(function(){return'Choice schema did not contain choice key: "'+t+'"'}))},$i=function(e,t,n){return Ni(e,(function(){return'The chosen schema: "'+n+'" did not exist in branches: '+Pi(t)}))},zi=function(e,t){return Ni(e,(function(){return"There are unsupported fields: ["+t.join(", ")+"] specified"}))},Ui=function(e,t){return Ni(e,w(t))},Vi=function(e){var t=function(t,n){return mi.bindError(e(n),(function(e){return Ui(t,e)}))},n=w("val");return{extract:t,toString:n}},Hi=Vi(mi.svalue),ji=function(e,t,n,r){return ke(t,n).fold((function(){return Fi(e,n,t)}),r)},qi=function(e,t,n,r){var i=ke(e,t).getOrThunk((function(){return n(e)}));return r(i)},Gi=function(e,t,n){return n(ke(e,t))},Wi=function(e,t,n,r){var i=ke(e,t).map((function(t){return!0===t?n(e):t}));return r(i)},Ki=function(e,t,n,r,i){var o=function(e){return i.extract(t.concat([r]),e)},a=function(e){return e.fold((function(){return mi.svalue(N.none())}),(function(e){var n=i.extract(t.concat([r]),e);return mi.map(n,N.some)}))};switch(e.tag){case"required":return ji(t,n,r,o);case"defaultedThunk":return qi(n,r,e.process,o);case"option":return Gi(n,r,a);case"defaultedOptionThunk":return Wi(n,r,e.process,a);case"mergeWithThunk":return qi(n,r,w({}),(function(t){var r=Si(e.process(n),t);return o(r)}))}},Yi=function(e,t,n){for(var r={},i=[],o=0,a=n;o<a.length;o++){var s=a[o];vi(s,(function(n,o,a,s){var l=Ki(a,e,t,n,s);mi.fold(l,(function(e){i.push.apply(i,e)}),(function(e){r[o]=e}))}),(function(e,n){r[e]=n(t)}))}return i.length>0?mi.serror(i):mi.svalue(r)},Xi=function(e){var t=function(t,n){return e().extract(t,n)},n=function(){return e().toString()};return{extract:t,toString:n}},Ji=function(e){return pe(xe(e,f))},Qi=function(e){var t=Zi(e),n=J(e,(function(e,t){return vi(t,(function(t){var n;return Si(e,(n={},n[t]=!0,n))}),w(e))}),{}),r=function(e,r){var i=u(r)?[]:Ji(r),o=X(i,(function(e){return!_e(n,e)}));return 0===o.length?t.extract(e,r):zi(e,o)};return{extract:r,toString:t.toString}},Zi=function(e){var t=function(t,n){return Yi(t,n,e)},n=function(){var t=G(e,(function(e){return vi(e,(function(e,t,n,r){return e+" -> "+r.toString()}),(function(e,t){return"state("+e+")"}))}));return"obj{\n"+t.join("\n")+"}"};return{extract:t,toString:n}},eo=function(e){var t=function(t,n){var r=G(n,(function(n,r){return e.extract(t.concat(["["+r+"]"]),n)}));return Ii.consolidateArr(r)},n=function(){return"array("+e.toString()+")"};return{extract:t,toString:n}},to=function(e){var t=function(t,n){for(var r=[],i=0,o=e;i<o.length;i++){var a=o[i],s=a.extract(t,n);if(s.stype===nt.Value)return s;r.push(s)}return Ii.consolidateArr(r)},n=function(){return"oneOf("+G(e,(function(e){return e.toString()})).join(", ")+")"};return{extract:t,toString:n}},no=function(e,t){var n=function(t,n){return eo(Vi(e)).extract(t,n)},r=function(e,r){var i=pe(r),o=n(e,i);return mi.bind(o,(function(n){var i=G(n,(function(e){return pi(e,e,Ci(),t)}));return Zi(i).extract(e,r)}))},i=function(){return"setOf("+t.toString()+")"};return{extract:r,toString:i}},ro=function(e,t){var n=mt(t),r=function(e,t){return n().extract(e,t)},i=function(){return n().toString()};return{extract:r,toString:i}},io=b(eo,Zi),oo=w(Hi),ao=function(e,t){return Vi((function(n){var r=typeof n;return e(n)?mi.svalue(n):mi.serror("Expected type: "+t+" but got: "+r)}))},so=ao(m,"number"),lo=ao(o,"string"),uo=ao(u,"boolean"),co=ao(h,"function"),fo=function(e){if(Object(e)!==e)return!0;switch({}.toString.call(e).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(e).every((function(t){return fo(e[t])}));default:return!1}},ho=Vi((function(e){return fo(e)?mi.svalue(e):mi.serror("Expected value to be acceptable for sending via postMessage")})),mo=function(e,t,n,r){var i=ke(n,r);return i.fold((function(){return $i(e,n,r)}),(function(n){return n.extract(e.concat(["branch: "+r]),t)}))},po=function(e,t){var n=function(n,r){var i=ke(r,e);return i.fold((function(){return Bi(n,e)}),(function(e){return mo(n,r,t,e)}))},r=function(){return"chooseOn("+e+"). Possible values: "+pe(t)};return{extract:n,toString:r}},go=function(){return eo(Hi)},vo=function(e){return Vi((function(t){return e(t).fold(mi.serror,mi.svalue)}))},bo=function(e,t){return no((function(t){return mi.fromResult(e(t))}),t)},yo=function(e,t,n){var r=t.extract([e],n);return mi.mapError(r,(function(e){return{input:n,errors:e}}))},wo=function(e,t,n){return mi.toResult(yo(e,t,n))},So=function(e){return e.fold((function(e){throw new Error(Co(e))}),S)},xo=function(e,t,n){return So(wo(e,t,n))},Co=function(e){return"Errors: \n"+Mi(e.errors).join("\n")+"\n\nInput object: "+Pi(e.input)},To=function(e,t){return po(e,be(t,Zi))},Do=function(e,t){return ro(e,t)},ko=pi,Eo=gi,_o=function(e){return vo((function(t){return V(e,t)?ri.value(t):ri.error('Unsupported value: "'+t+'", choose one of "'+e.join(", ")+'".')}))},Ao=function(e){return ko(e,e,Ci(),oo())},Lo=function(e,t){return ko(e,e,Ci(),t)},Oo=function(e){return Lo(e,so)},Ro=function(e){return Lo(e,lo)},Io=function(e,t){return ko(e,e,Ci(),_o(t))},Po=function(e){return Lo(e,uo)},Mo=function(e){return Lo(e,co)},No=function(e,t){return ko(e,e,ki(),Vi((function(n){return mi.serror("The field: "+e+" is forbidden. "+t)})))},Fo=function(e,t){return ko(e,e,Ci(),Zi(t))},Bo=function(e,t){return ko(e,e,Ci(),io(t))},$o=function(e,t){return ko(e,e,Ci(),eo(t))},zo=function(e){return ko(e,e,ki(),oo())},Uo=function(e,t){return ko(e,e,ki(),t)},Vo=function(e){return Uo(e,so)},Ho=function(e){return Uo(e,lo)},jo=function(e){return Uo(e,co)},qo=function(e,t){return Uo(e,eo(t))},Go=function(e,t){return Uo(e,Zi(t))},Wo=function(e,t){return Uo(e,Qi(t))},Ko=function(e,t){return ko(e,e,Di(t),oo())},Yo=function(e,t,n){return ko(e,e,Di(t),n)},Xo=function(e,t){return Yo(e,t,so)},Jo=function(e,t){return Yo(e,t,lo)},Qo=function(e,t,n){return Yo(e,t,_o(n))},Zo=function(e,t){return Yo(e,t,uo)},ea=function(e,t){return Yo(e,t,co)},ta=function(e,t){return Yo(e,t,ho)},na=function(e,t,n){return Yo(e,t,eo(n))},ra=function(e,t,n){return Yo(e,t,Zi(n))},ia=function(e){var t=e,n=function(){return t},r=function(e){t=e};return{get:n,set:r}},oa=function(e){if(!s(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var t=[],n={};return W(e,(function(r,i){var o=pe(r);if(1!==o.length)throw new Error("one and only one name per case");var a=o[0],l=r[a];if(void 0!==n[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!s(l))throw new Error("case arguments must be an array");t.push(a),n[a]=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=n.length;if(o!==l.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+l.length+" ("+l+"), got "+o);var s=function(e){var r=pe(e);if(t.length!==r.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+r.join(","));var i=ie(t,(function(e){return V(r,e)}));if(!i)throw new Error("Not all branches were specified when using match. Specified: "+r.join(", ")+"\nRequired: "+t.join(", "));return e[a].apply(null,n)};return{fold:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(t.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);var o=t[i];return o.apply(null,n)},match:s,log:function(e){console.log(e,{constructors:t,constructor:a,params:n})}}}})),n},aa={generate:oa};aa.generate([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);var sa,la=function(e){var t=[],n=[];return W(e,(function(e){e.fold((function(e){t.push(e)}),(function(e){n.push(e)}))})),{errors:t,values:n}},ua=function(e,t){var n={};return ve(e,(function(e,r){V(t,r)||(n[r]=e)})),n},ca=function(e,t){var n;return n={},n[e]=t,n},da=function(e){var t={};return W(e,(function(e){t[e.key]=e.value})),t},fa=function(e,t){return ua(e,t)},ha=function(e,t){return ca(e,t)},ma=function(e){return da(e)},pa=function(e,t){return 0===e.length?ri.value(t):ri.value(Si(t,xi.apply(void 0,e)))},ga=function(e){return ri.error(ne(e))},va=function(e,t){var n=la(e);return n.errors.length>0?ga(n.errors):pa(n.values,t)},ba=function(e){return h(e)?e:k},ya=function(e,t,n){var r=e.dom,i=ba(n);while(r.parentNode){r=r.parentNode;var o=tt.fromDom(r),a=t(o);if(a.isSome())return a;if(i(o))break}return N.none()},wa=function(e,t,n){var r=t(e),i=ba(n);return r.orThunk((function(){return i(e)?N.none():ya(e,t,i)}))},Sa=function(e,t){return un(e.element,t.event.target)},xa={can:E,abort:k,run:g},Ca=function(e){if(!_e(e,"can")&&!_e(e,"abort")&&!_e(e,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(e,null,2)+" does not have can, abort, or run!");return A(A({},xa),e)},Ta=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return Q(e,(function(e,r){return e&&t(r).apply(void 0,n)}),!0)}},Da=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return Q(e,(function(e,r){return e||t(r).apply(void 0,n)}),!1)}},ka=function(e){return h(e)?{can:E,abort:k,run:e}:e},Ea=function(e){var t=Ta(e,(function(e){return e.can})),n=Da(e,(function(e){return e.abort})),r=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];W(e,(function(e){e.run.apply(void 0,t)}))};return{can:t,abort:n,run:r}},_a=w,Aa=_a("touchstart"),La=_a("touchmove"),Oa=_a("touchend"),Ra=_a("touchcancel"),Ia=_a("mousedown"),Pa=_a("mousemove"),Ma=_a("mouseout"),Na=_a("mouseup"),Fa=_a("mouseover"),Ba=_a("focusin"),$a=_a("focusout"),za=_a("keydown"),Ua=_a("keyup"),Va=_a("input"),Ha=_a("change"),ja=_a("click"),qa=_a("transitioncancel"),Ga=_a("transitionend"),Wa=_a("transitionstart"),Ka=_a("selectstart"),Ya=function(e){return w("alloy."+e)},Xa={tap:Ya("tap")},Ja=Ya("focus"),Qa=Ya("blur.post"),Za=Ya("paste.post"),es=Ya("receive"),ts=Ya("execute"),ns=Ya("focus.item"),rs=Xa.tap,is=Ya("longpress"),os=Ya("sandbox.close"),as=Ya("typeahead.cancel"),ss=Ya("system.init"),ls=Ya("system.touchmove"),us=Ya("system.touchend"),cs=Ya("system.scroll"),ds=Ya("system.resize"),fs=Ya("system.attached"),hs=Ya("system.detached"),ms=Ya("system.dismissRequested"),ps=Ya("system.repositionRequested"),gs=Ya("focusmanager.shifted"),vs=Ya("slotcontainer.visibility"),bs=Ya("change.tab"),ys=Ya("dismiss.tab"),ws=Ya("highlight"),Ss=Ya("dehighlight"),xs=function(e,t){ks(e,e.element,t,{})},Cs=function(e,t,n){ks(e,e.element,t,n)},Ts=function(e){xs(e,ts())},Ds=function(e,t,n){ks(e,t,n,{})},ks=function(e,t,n,r){var i=A({target:t},r);e.getSystem().triggerEvent(n,t,i)},Es=function(e,t,n,r){e.getSystem().triggerEvent(n,t,r.event)},_s=function(e){return ma(e)},As=function(e,t){return{key:e,value:Ca({abort:t})}},Ls=function(e,t){return{key:e,value:Ca({can:t})}},Os=function(e){return{key:e,value:Ca({run:function(e,t){t.event.prevent()}})}},Rs=function(e,t){return{key:e,value:Ca({run:t})}},Is=function(e,t,n){return{key:e,value:Ca({run:function(e,r){t.apply(void 0,[e,r].concat(n))}})}},Ps=function(e){return function(t){return Rs(e,t)}},Ms=function(e){return function(t){return{key:e,value:Ca({run:function(e,n){Sa(e,n)&&t(e,n)}})}}},Ns=function(e,t){return Rs(e,(function(n,r){n.getSystem().getByUid(t).each((function(t){Es(t,t.element,e,r)}))}))},Fs=function(e,t,n){var r=t.partUids[n];return Ns(e,r)},Bs=function(e,t){return Rs(e,(function(e,n){var r=n.event,i=e.getSystem().getByDom(r.target).getOrThunk((function(){var t=wa(r.target,(function(t){return e.getSystem().getByDom(t).toOptional()}),k);return t.getOr(e)}));t(e,i,n)}))},$s=function(e){return Rs(e,(function(e,t){t.cut()}))},zs=function(e){return Rs(e,(function(e,t){t.stop()}))},Us=function(e,t){return Ms(e)(t)},Vs=Ms(fs()),Hs=Ms(hs()),js=Ms(ss()),qs=Ps(ts()),Gs=function(e,t){var n=t||document,r=n.createElement("div");return r.innerHTML=e,Sn(tt.fromDom(r))},Ws=function(e){return e.dom.innerHTML},Ks=function(e,t){var n=hn(e),r=n.dom,i=tt.fromDom(r.createDocumentFragment()),o=Gs(t,r);Ir(i,o),Pr(e),Lr(e,i)},Ys=function(e){var t=tt.fromTag("div"),n=tt.fromDom(e.dom.cloneNode(!0));return Lr(t,n),Ws(t)},Xs=function(e,t){return tt.fromDom(e.dom.cloneNode(t))},Js=function(e){return Xs(e,!1)},Qs=function(e){if(kn(e))return"#shadow-root";var t=Js(e);return Ys(t)},Zs=function(e){return Qs(e)},el=function(e,t,n){return un(t,e.element)&&!un(t,n)},tl=_s([Ls(Ja(),(function(e,t){var n=t.event,r=n.originator,i=n.target;return!el(e,r,i)||(console.warn(Ja()+" did not get interpreted by the desired target. \nOriginator: "+Zs(r)+"\nTarget: "+Zs(i)+"\nCheck the "+Ja()+" event handlers"),!1)}))]),nl=Object.freeze({__proto__:null,events:tl}),rl=0,il=function(e){var t=new Date,n=t.getTime(),r=Math.floor(1e9*Math.random());return rl++,e+"_"+r+rl+String(n)},ol=w("alloy-id-"),al=w("data-alloy-id"),sl=ol(),ll=al(),ul=function(e,t){var n=il(sl+e);return cl(t,n),n},cl=function(e,t){Object.defineProperty(e.dom,ll,{value:t,writable:!0})},dl=function(e){var t=ct(e)?e.dom[ll]:null;return N.from(t)},fl=function(e){return il(e)},hl=S,ml=function(e){var t=function(t){return"The component must be in a context to execute: "+t+(e?"\n"+Zs(e().element)+" is not in context.":"")},n=function(e){return function(){throw new Error(t(e))}},r=function(e){return function(){console.warn(t(e))}};return{debugInfo:w("fake"),triggerEvent:r("triggerEvent"),triggerFocus:r("triggerFocus"),triggerEscape:r("triggerEscape"),broadcast:r("broadcast"),broadcastOn:r("broadcastOn"),broadcastEvent:r("broadcastEvent"),build:n("build"),addToWorld:n("addToWorld"),removeFromWorld:n("removeFromWorld"),addToGui:n("addToGui"),removeFromGui:n("removeFromGui"),getByUid:n("getByUid"),getByDom:n("getByDom"),isConnected:k}},pl=ml(),gl=function(e,t,n){var r=n.toString(),i=r.indexOf(")")+1,o=r.indexOf("("),a=r.substring(o+1,i-1).split(/,\s*/);return e.toFunctionAnnotation=function(){return{name:t,parameters:vl(a.slice(0,1).concat(a.slice(3)))}},e},vl=function(e){return G(e,(function(e){return je(e,"/*")?e.substring(0,e.length-"/*".length):e}))},bl=function(e,t){var n=e.toString(),r=n.indexOf(")")+1,i=n.indexOf("("),o=n.substring(i+1,r-1).split(/,\s*/);return e.toFunctionAnnotation=function(){return{name:t,parameters:vl(o)}},e},yl=function(e,t){var n=t.toString(),r=n.indexOf(")")+1,i=n.indexOf("("),o=n.substring(i+1,r-1).split(/,\s*/);return e.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:vl(o.slice(1))}},e},wl=il("alloy-premade"),Sl=function(e){return ha(wl,e)},xl=function(e){return ke(e,wl)},Cl=function(e){return yl((function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return e.apply(void 0,O([t.getApis(),t],n,!1))}),e)},Tl={init:function(){return Dl({readState:w("No State required")})}},Dl=function(e){return e},kl=function(e,t){var n=G(t,(function(e){return Go(e.name(),[Ao("config"),Ko("state",Tl)])})),r=wo("component.behaviours",Zi(n),e.behaviours).fold((function(t){throw new Error(Co(t)+"\nComplete spec:\n"+JSON.stringify(e,null,2))}),S);return{list:t,data:be(r,(function(e){var t=e.map((function(e){return{config:e.config,state:e.state.init(e.config)}}));return w(t)}))}},El=function(e){return e.list},_l=function(e){return e.data},Al=function(e,t){var n={};return ve(e,(function(e,r){ve(e,(function(e,i){var o=ke(n,i).getOr([]);n[i]=o.concat([t(r,e)])}))})),n},Ll=function(e){return{classes:c(e.classes)?[]:e.classes,attributes:c(e.attributes)?{}:e.attributes,styles:c(e.styles)?{}:e.styles}},Ol=function(e,t){return A(A({},e),{attributes:A(A({},e.attributes),t.attributes),styles:A(A({},e.styles),t.styles),classes:e.classes.concat(t.classes)})},Rl=function(e,t,n,r){var i=A({},t);W(n,(function(t){i[t.name()]=t.exhibit(e,r)}));var o=Al(i,(function(e,t){return{name:e,modification:t}})),a=function(e){return J(e,(function(e,t){return A(A({},t.modification),e)}),{})},s=J(o.classes,(function(e,t){return t.modification.concat(e)}),[]),l=a(o.attributes),u=a(o.styles);return Ll({classes:s,attributes:l,styles:u})},Il=function(e,t,n,r){try{var i=ue(n,(function(n,i){var o=n[t],a=i[t],s=r.indexOf(o),l=r.indexOf(a);if(-1===s)throw new Error("The ordering for "+e+" does not have an entry for "+o+".\nOrder specified: "+JSON.stringify(r,null,2));if(-1===l)throw new Error("The ordering for "+e+" does not have an entry for "+a+".\nOrder specified: "+JSON.stringify(r,null,2));return s<l?-1:l<s?1:0}));return ri.value(i)}catch(o){return ri.error([o])}},Pl=function(e,t){return{handler:e,purpose:t}},Ml=function(e,t){return{cHandler:e,purpose:t}},Nl=function(e,t){return Ml(C.apply(void 0,[e.handler].concat(t)),e.purpose)},Fl=function(e){return e.cHandler},Bl=function(e,t){return{name:e,handler:t}},$l=function(e,t){var n={};return W(e,(function(e){n[e.name()]=e.handlers(t)})),n},zl=function(e,t,n){var r=A(A({},n),$l(t,e));return Al(r,Bl)},Ul=function(e,t,n,r){var i=zl(e,n,r);return ql(i,t)},Vl=function(e){var t=ka(e);return function(e,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var o=[e,n].concat(r);t.abort.apply(void 0,o)?n.stop():t.can.apply(void 0,o)&&t.run.apply(void 0,o)}},Hl=function(e,t){return ri.error(["The event ("+e+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(G(t,(function(e){return e.name})),null,2)])},jl=function(e,t,n){var r=t[n];return r?Il("Event: "+n,"name",e,r).map((function(e){var t=G(e,(function(e){return e.handler}));return Ea(t)})):Hl(n,e)},ql=function(e,t){var n=Ce(e,(function(e,n){var r=1===e.length?ri.value(e[0].handler):jl(e,t,n);return r.map((function(r){var i=Vl(r),o=e.length>1?X(t[n],(function(t){return H(e,(function(e){return e.name===t}))})).join(" > "):e[0].name;return ha(n,Pl(i,o))}))}));return va(n,{})},Gl="alloy.base.behaviour",Wl=Zi([ko("dom","dom",Ci(),Zi([Ao("tag"),Ko("styles",{}),Ko("classes",[]),Ko("attributes",{}),zo("value"),zo("innerHtml")])),Ao("components"),Ao("uid"),Ko("events",{}),Ko("apis",{}),ko("eventOrder","eventOrder",_i((sa={},sa[ts()]=["disabling",Gl,"toggling","typeaheadevents"],sa[Ja()]=[Gl,"focusing","keying"],sa[ss()]=[Gl,"disabling","toggling","representing"],sa[Va()]=[Gl,"representing","streaming","invalidating"],sa[hs()]=[Gl,"representing","item-events","tooltipping"],sa[Ia()]=["focusing",Gl,"item-type-events"],sa[Aa()]=["focusing",Gl,"item-type-events"],sa[Fa()]=["item-type-events","tooltipping"],sa[es()]=["receiving","reflecting","tooltipping"],sa)),oo()),zo("domModification")]),Kl=function(e){return wo("custom.definition",Wl,e)},Yl=function(e){return A(A({},e.dom),{uid:e.uid,domChildren:G(e.components,(function(e){return e.element}))})},Xl=function(e){return e.domModification.fold((function(){return Ll({})}),Ll)},Jl=function(e){return e.events},Ql=function(e,t){var n=Vn(e,t);return void 0===n||""===n?[]:n.split(" ")},Zl=function(e,t,n){var r=Ql(e,t),i=r.concat([n]);return zn(e,t,i.join(" ")),!0},eu=function(e,t,n){var r=X(Ql(e,t),(function(e){return e!==n}));return r.length>0?zn(e,t,r.join(" ")):qn(e,t),!1},tu=function(e){return void 0!==e.dom.classList},nu=function(e){return Ql(e,"class")},ru=function(e,t){return Zl(e,"class",t)},iu=function(e,t){return eu(e,"class",t)},ou=function(e,t){tu(e)?e.dom.classList.add(t):ru(e,t)},au=function(e){var t=tu(e)?e.dom.classList:nu(e);0===t.length&&qn(e,"class")},su=function(e,t){if(tu(e)){var n=e.dom.classList;n.remove(t)}else iu(e,t);au(e)},lu=function(e,t){return tu(e)&&e.dom.classList.contains(t)},uu=function(e,t){W(t,(function(t){ou(e,t)}))},cu=function(e,t){W(t,(function(t){su(e,t)}))},du=function(e,t){return ie(t,(function(t){return lu(e,t)}))},fu=function(e){return e.dom.value},hu=function(e,t){if(void 0===t)throw new Error("Value.set was undefined");e.dom.value=t},mu=function(e){var t=tt.fromTag(e.tag);Un(t,e.attributes),uu(t,e.classes),Yn(t,e.styles),e.innerHtml.each((function(e){return Ks(t,e)}));var n=e.domChildren;return Ir(t,n),e.value.each((function(e){hu(t,e)})),e.uid,cl(t,e.uid),t},pu=function(e){var t=ke(e,"behaviours").getOr({});return re(pe(t),(function(e){var n=t[e];return f(n)?[n.me]:[]}))},gu=function(e,t){return kl(e,t)},vu=function(e){var t=pu(e);return gu(e,t)},bu=function(e,t,n){var r=Yl(e),i=Xl(e),o={"alloy.base.modification":i},a=t.length>0?Rl(n,o,t,r):i;return Ol(r,a)},yu=function(e,t,n){var r={"alloy.base.behaviour":Jl(e)};return Ul(n,e.eventOrder,t,r).getOrDie()},wu=function(e){var t=function(){return y},n=ia(pl),r=So(Kl(e)),i=vu(e),o=El(i),a=_l(i),s=bu(r,o,a),l=mu(s),u=yu(r,o,a),c=ia(r.components),d=function(e){n.set(e)},f=function(){n.set(ml(t))},m=function(){var e=Sn(l),t=re(e,(function(e){return n.get().getByDom(e).fold((function(){return[]}),le)}));c.set(t)},p=function(t){var n=a,r=h(n[t.name()])?n[t.name()]:function(){throw new Error("Could not find "+t.name()+" in "+JSON.stringify(e,null,2))};return r()},g=function(e){return h(a[e.name()])},v=function(){return r.apis},b=function(e){return a[e]().map((function(e){return e.state.readState()})).getOr("not enabled")},y={uid:e.uid,getSystem:n.get,config:p,hasConfigured:g,spec:e,readState:b,getApis:v,connect:d,disconnect:f,element:l,syncComponents:m,components:c.get,events:u};return y},Su=function(e){var t=ke(e,"components").getOr([]);return G(t,Eu)},xu=function(e){var t=hl(e),n=t.events,r=L(t,["events"]),i=Su(r),o=A(A({},r),{events:A(A({},nl),n),components:i});return ri.value(wu(o))},Cu=function(e){var t=tt.fromText(e);return Tu({element:t})},Tu=function(e){var t=xo("external.component",Qi([Ao("element"),zo("uid")]),e),n=ia(ml()),r=function(e){n.set(e)},i=function(){n.set(ml((function(){return a})))},o=t.uid.getOrThunk((function(){return fl("external")}));cl(t.element,o);var a={uid:o,getSystem:n.get,config:N.none,hasConfigured:k,connect:r,disconnect:i,getApis:function(){return{}},element:t.element,spec:e,readState:w("No state"),syncComponents:g,components:w([]),events:{}};return Sl(a)},Du=fl,ku=function(e){return Ee(e,"uid")},Eu=function(e){return xl(e).getOrThunk((function(){var t=ku(e)?e:A({uid:Du("")},e);return xu(t).getOrDie()}))},_u=Sl;function Au(e,t,n,r,i){return e(n,r)?N.some(n):h(i)&&i(n)?N.none():t(n,r,i)}var Lu,Ou=function(e,t,n){var r=e.dom,i=h(n)?n:k;while(r.parentNode){r=r.parentNode;var o=tt.fromDom(r);if(t(o))return N.some(o);if(i(o))break}return N.none()},Ru=function(e,t,n){var r=function(e,t){return t(e)};return Au(r,Ou,e,t,n)},Iu=function(e,t){var n=function(e){return t(tt.fromDom(e))},r=ee(e.dom.childNodes,n);return r.map(tt.fromDom)},Pu=function(e,t){var n=function(e){for(var r=0;r<e.childNodes.length;r++){var i=tt.fromDom(e.childNodes[r]);if(t(i))return N.some(i);var o=n(e.childNodes[r]);if(o.isSome())return o}return N.none()};return n(e.dom)},Mu=function(e,t,n){return Ru(e,t,n).isSome()},Nu=function(e,t,n){return Ou(e,(function(e){return on(e,t)}),n)},Fu=function(e,t){return Iu(e,(function(e){return on(e,t)}))},Bu=function(e,t){return ln(t,e)},$u=function(e,t,n){var r=function(e,t){return on(e,t)};return Au(r,Nu,e,t,n)},zu=function(e){var t=Ru(e,(function(e){if(!ct(e))return!1;var t=Vn(e,"id");return void 0!==t&&t.indexOf("aria-owns")>-1}));return t.bind((function(e){var t=Vn(e,"id"),n=An(e);return Bu(n,'[aria-owns="'+t+'"]')}))},Uu=function(){var e=il("aria-owns"),t=function(t){zn(t,"aria-owns",e)},n=function(e){qn(e,"aria-owns")};return{id:e,link:t,unlink:n}},Vu=function(e,t){return zu(t).exists((function(t){return Hu(e,t)}))},Hu=function(e,t){return Mu(t,(function(t){return un(t,e.element)}),k)||Vu(e,t)},ju="unknown";(function(e){e[e["STOP"]=0]="STOP",e[e["NORMAL"]=1]="NORMAL",e[e["LOGGING"]=2]="LOGGING"})(Lu||(Lu={}));var qu=ia({}),Gu=function(e,t){var n=[],r=(new Date).getTime();return{logEventCut:function(e,t,r){n.push({outcome:"cut",target:t,purpose:r})},logEventStopped:function(e,t,r){n.push({outcome:"stopped",target:t,purpose:r})},logNoParent:function(e,t,r){n.push({outcome:"no-parent",target:t,purpose:r})},logEventNoHandlers:function(e,t){n.push({outcome:"no-handlers-left",target:t})},logEventResponse:function(e,t,r){n.push({outcome:"response",purpose:r,target:t})},write:function(){var i=(new Date).getTime();V(["mousemove","mouseover","mouseout",ss()],e)||console.log(e,{event:e,time:i-r,target:t.dom,sequence:G(n,(function(e){return V(["cut","stopped","response"],e.outcome)?"{"+e.purpose+"} "+e.outcome+" at ("+Zs(e.target)+")":e.outcome}))})}}},Wu=function(e,t,n){var r=ke(qu.get(),e).orThunk((function(){var t=pe(qu.get());return me(t,(function(t){return e.indexOf(t)>-1?N.some(qu.get()[t]):N.none()}))})).getOr(Lu.NORMAL);switch(r){case Lu.NORMAL:return n(Qu());case Lu.LOGGING:var i=Gu(e,t),o=n(i);return i.write(),o;case Lu.STOP:return!0}},Ku=["alloy/data/Fields","alloy/debugging/Debugging"],Yu=function(){var e=new Error;if(void 0!==e.stack){var t=e.stack.split("\n");return ee(t,(function(e){return e.indexOf("alloy")>0&&!H(Ku,(function(t){return e.indexOf(t)>-1}))})).getOr(ju)}return ju},Xu={logEventCut:g,logEventStopped:g,logNoParent:g,logEventNoHandlers:g,logEventResponse:g,write:g},Ju=function(e,t,n){return Wu(e,t,n)},Qu=w(Xu),Zu=w([Ao("menu"),Ao("selectedMenu")]),ec=w([Ao("item"),Ao("selectedItem")]);w(Zi(ec().concat(Zu())));var tc=w(Zi(ec())),nc=Fo("initSize",[Ao("numColumns"),Ao("numRows")]),rc=function(){return Lo("markers",tc())},ic=function(){return Fo("markers",[Ao("backgroundMenu")].concat(Zu()).concat(ec()))},oc=function(e){return Fo("markers",G(e,Ao))},ac=function(e,t,n){return Yu(),ko(t,t,n,vo((function(e){return ri.value((function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.apply(void 0,t)}))})))},sc=function(e){return ac("onHandler",e,Di(g))},lc=function(e){return ac("onKeyboardHandler",e,Di(N.none))},uc=function(e){return ac("onHandler",e,Ci())},cc=function(e){return ac("onKeyboardHandler",e,Ci())},dc=function(e,t){return Eo(e,w(t))},fc=function(e){return Eo(e,S)},hc=w(nc),mc=function(e,t,n,r,i,o,a,s){return void 0===s&&(s=!1),{x:e,y:t,bubble:n,direction:r,placement:i,restriction:o,label:a+"-"+i,alwaysFit:s}},pc=aa.generate([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),gc=function(e,t,n,r,i,o,a,s,l){return e.fold(t,n,r,i,o,a,s,l)},vc=function(e,t,n,r){return e.fold(t,t,r,r,t,r,n,n)},bc=function(e,t,n,r){return e.fold(t,r,t,r,n,n,t,r)},yc=pc.southeast,wc=pc.southwest,Sc=pc.northeast,xc=pc.northwest,Cc=pc.south,Tc=pc.north,Dc=pc.east,kc=pc.west,Ec=function(e,t,n,r){var i=e+t;return i>r?n:i<n?r:i},_c=function(e,t,n){return Math.min(Math.max(e,t),n)},Ac=function(e,t){switch(t){case 1:return e.x;case 0:return e.x+e.width;case 2:return e.y;case 3:return e.y+e.height}},Lc=function(e,t){return se(["left","right","top","bottom"],(function(n){return ke(t,n).map((function(t){return Ac(e,t)}))}))},Oc=function(e,t,n){var r=function(r,i){return t[r].map((function(t){var o="top"===r||"bottom"===r,a=o?n.top:n.left,s="left"===r||"top"===r?Math.max:Math.min,l=s(t,i)+a;return o?_c(l,e.y,e.bottom):_c(l,e.x,e.right)})).getOr(i)},i=r("left",e.x),o=r("top",e.y),a=r("right",e.right),s=r("bottom",e.bottom);return Xr(i,o,a-i,s-o)},Rc="layout",Ic=function(e){return e.x},Pc=function(e,t){return e.x+e.width/2-t.width/2},Mc=function(e,t){return e.x+e.width-t.width},Nc=function(e,t){return e.y-t.height},Fc=function(e){return e.y+e.height},Bc=function(e,t){return e.y+e.height/2-t.height/2},$c=function(e){return e.x+e.width},zc=function(e,t){return e.x-t.width},Uc=function(e,t,n){return mc(Ic(e),Fc(e),n.southeast(),yc(),"southeast",Lc(e,{left:1,top:3}),Rc)},Vc=function(e,t,n){return mc(Mc(e,t),Fc(e),n.southwest(),wc(),"southwest",Lc(e,{right:0,top:3}),Rc)},Hc=function(e,t,n){return mc(Ic(e),Nc(e,t),n.northeast(),Sc(),"northeast",Lc(e,{left:1,bottom:2}),Rc)},jc=function(e,t,n){return mc(Mc(e,t),Nc(e,t),n.northwest(),xc(),"northwest",Lc(e,{right:0,bottom:2}),Rc)},qc=function(e,t,n){return mc(Pc(e,t),Nc(e,t),n.north(),Tc(),"north",Lc(e,{bottom:2}),Rc)},Gc=function(e,t,n){return mc(Pc(e,t),Fc(e),n.south(),Cc(),"south",Lc(e,{top:3}),Rc)},Wc=function(e,t,n){return mc($c(e),Bc(e,t),n.east(),Dc(),"east",Lc(e,{left:0}),Rc)},Kc=function(e,t,n){return mc(zc(e,t),Bc(e,t),n.west(),kc(),"west",Lc(e,{right:1}),Rc)},Yc=function(){return[Uc,Vc,Hc,jc,Gc,qc,Wc,Kc]},Xc=function(){return[Vc,Uc,jc,Hc,Gc,qc,Wc,Kc]},Jc=function(){return[Hc,jc,Uc,Vc,qc,Gc]},Qc=function(){return[jc,Hc,Vc,Uc,qc,Gc]},Zc=function(){return[Uc,Vc,Hc,jc,Gc,qc]},ed=function(){return[Vc,Uc,jc,Hc,Gc,qc]},td=function(e,t){return t.universal?e:X(e,(function(e){return V(t.channels,e)}))},nd=function(e){return _s([Rs(es(),(function(t,n){var r=e.channels,i=pe(r),o=n,a=td(i,o);W(a,(function(e){var n=r[e],i=n.schema,a=xo("channel["+e+"] data\nReceiver: "+Zs(t.element),i,o.data);n.onReceive(t,a)}))}))])},rd=Object.freeze({__proto__:null,events:nd}),id=[Lo("channels",bo(ri.value,Qi([uc("onReceive"),Ko("schema",oo())])))],od=function(e,t,n){return qs((function(r){n(r,e,t)}))},ad=function(e,t,n){return js((function(r,i){n(r,e,t)}))},sd=function(e,t,n,r,i,o){var a=Qi(e),s=Go(t,[Wo("config",e)]);return dd(a,s,t,n,r,i,o)},ld=function(e,t,n,r,i,o){var a=e,s=Go(t,[Uo("config",e)]);return dd(a,s,t,n,r,i,o)},ud=function(e,t,n){var r=function(r){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];var a=[r].concat(i);return r.config({name:w(e)}).fold((function(){throw new Error("We could not find any behaviour configuration for: "+e+". Using API: "+n)}),(function(e){var n=Array.prototype.slice.call(a,1);return t.apply(void 0,[r,e.config,e.state].concat(n))}))};return gl(r,n,t)},cd=function(e){return{key:e,value:void 0}},dd=function(e,t,n,r,i,o,a){var s=function(e){return _e(e,n)?e[n]():N.none()},l=be(i,(function(e,t){return ud(n,e,t)})),u=be(o,(function(e,t){return bl(e,t)})),c=A(A(A({},u),l),{revoke:C(cd,n),config:function(t){var r=xo(n+"-config",e,t);return{key:n,value:{config:r,me:c,configAsRaw:mt((function(){return xo(n+"-config",e,t)})),initialConfig:t,state:a}}},schema:w(t),exhibit:function(e,t){return Ie(s(e),ke(r,"exhibit"),(function(e,n){return n(t,e.config,e.state)})).getOrThunk((function(){return Ll({})}))},name:w(n),handlers:function(e){return s(e).map((function(e){var t=ke(r,"events").getOr((function(){return{}}));return t(e.config,e.state)})).getOr({})}});return c},fd=function(e){return ma(e)},hd=Qi([Ao("fields"),Ao("name"),Ko("active",{}),Ko("apis",{}),Ko("state",Tl),Ko("extra",{})]),md=function(e){var t=xo("Creating behaviour: "+e.name,hd,e);return sd(t.fields,t.name,t.active,t.apis,t.extra,t.state)},pd=Qi([Ao("branchKey"),Ao("branches"),Ao("name"),Ko("active",{}),Ko("apis",{}),Ko("state",Tl),Ko("extra",{})]),gd=function(e){var t=xo("Creating behaviour: "+e.name,pd,e);return ld(To(t.branchKey,t.branches),t.name,t.active,t.apis,t.extra,t.state)},vd=w(void 0),bd=md({fields:id,name:"receiving",active:rd}),yd=function(e,t){return Ll({classes:[],styles:t.useFixed()?{}:{position:"relative"}})},wd=Object.freeze({__proto__:null,exhibit:yd}),Sd=function(){return tt.fromDom(document)},xd=function(e){return e.dom.focus()},Cd=function(e){return e.dom.blur()},Td=function(e){var t=An(e).dom;return e.dom===t.activeElement},Dd=function(e){return void 0===e&&(e=Sd()),N.from(e.dom.activeElement).map(tt.fromDom)},kd=function(e){return Dd(An(e)).filter((function(t){return e.dom.contains(t.dom)}))},Ed=function(e,t){var n=An(t),r=Dd(n).bind((function(e){var n=function(t){return un(e,t)};return n(t)?N.some(t):Pu(t,n)})),i=e(t);return r.each((function(e){Dd(n).filter((function(t){return un(t,e)})).fold((function(){xd(e)}),g)})),i},_d=function(e,t,n,r,i){var o=function(e){return e+"px"};return{position:e,left:t.map(o),top:n.map(o),right:r.map(o),bottom:i.map(o)}},Ad=function(e){return A(A({},e),{position:N.some(e.position)})},Ld=function(e,t){Xn(e,Ad(t))},Od=aa.generate([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),Rd=function(e,t,n,r,i,o){var a=t.rect,s=a.x-n,l=a.y-r,u=a.width,c=a.height,d=i-(s+u),f=o-(l+c),h=N.some(s),m=N.some(l),p=N.some(d),g=N.some(f),v=N.none();return gc(t.direction,(function(){return _d(e,h,m,v,v)}),(function(){return _d(e,v,m,p,v)}),(function(){return _d(e,h,v,v,g)}),(function(){return _d(e,v,v,p,g)}),(function(){return _d(e,h,m,v,v)}),(function(){return _d(e,h,v,v,g)}),(function(){return _d(e,h,m,v,v)}),(function(){return _d(e,v,m,p,v)}))},Id=function(e,t){return e.fold((function(){var e=t.rect;return _d("absolute",N.some(e.x),N.some(e.y),N.none(),N.none())}),(function(e,n,r,i){return Rd("absolute",t,e,n,r,i)}),(function(e,n,r,i){return Rd("fixed",t,e,n,r,i)}))},Pd=function(e,t){var n=C(Wr,t),r=e.fold(n,n,(function(){var e=Fr();return Wr(t).translate(-e.left,-e.top)})),i=br(t),o=sr(t);return Xr(r.left,r.top,i,o)},Md=function(e,t){return t.fold((function(){return e.fold(Zr,Zr,Xr)}),(function(t){return e.fold(t,t,(function(){var n=t(),r=Nd(e,n.x,n.y);return Xr(r.left,r.top,n.width,n.height)}))}))},Nd=function(e,t,n){var r=cr(t,n),i=function(){var e=Fr();return r.translate(-e.left,-e.top)};return e.fold(w(r),w(r),i)},Fd=function(e,t,n,r){return e.fold(t,n,r)};Od.none;var Bd,$d=Od.relative,zd=Od.fixed,Ud=function(e,t){return{anchorBox:e,origin:t}},Vd=function(e,t){return Ud(e,t)},Hd="data-alloy-placement",jd=function(e,t){zn(e,Hd,t)},qd=function(e){return Hn(e,Hd)},Gd=function(e){return qn(e,Hd)},Wd=aa.generate([{fit:["reposition"]},{nofit:["reposition","visibleW","visibleH","isVisible"]}]),Kd=function(e,t){var n=t.x,r=t.y,i=t.right,o=t.bottom,a=e.x,s=e.y,l=e.right,u=e.bottom,c=e.width,d=e.height,f=a>=n&&a<=i,h=s>=r&&s<=o,m=f&&h,p=l<=i&&l>=n,g=u<=o&&u>=r,v=p&&g,b=Math.min(c,a>=n?i-a:l-n),y=Math.min(d,s>=r?o-s:u-r);return{originInBounds:m,sizeInBounds:v,visibleW:b,visibleH:y}},Yd=function(e,t){var n=t.x,r=t.y,i=t.right,o=t.bottom,a=e.x,s=e.y,l=e.width,u=e.height,c=Math.max(n,i-l),d=Math.max(r,o-u),f=_c(a,n,c),h=_c(s,r,d),m=Math.min(f+l,i)-f,p=Math.min(h+u,o)-h;return Xr(f,h,m,p)},Xd=function(e,t,n){var r=w(t.bottom-n.y),i=w(n.bottom-t.y),o=vc(e,i,i,r),a=w(t.right-n.x),s=w(n.right-t.x),l=bc(e,s,s,a);return{maxWidth:l,maxHeight:o}},Jd=function(e,t,n,r){var i=e.bubble,o=i.offset,a=Oc(r,e.restriction,o),s=e.x+o.left,l=e.y+o.top,u=Xr(s,l,t,n),c=Kd(u,a),d=c.originInBounds,f=c.sizeInBounds,h=c.visibleW,m=c.visibleH,p=d&&f,g=p?u:Yd(u,a),v=g.width>0&&g.height>0,b=Xd(e.direction,g,r),y=b.maxWidth,w=b.maxHeight,S={rect:g,maxHeight:w,maxWidth:y,direction:e.direction,placement:e.placement,classes:{on:i.classesOn,off:i.classesOff},layout:e.label,testY:l};return p||e.alwaysFit?Wd.fit(S):Wd.nofit(S,h,m,v)},Qd=function(e,t,n,r,i,o){var a=r.width,s=r.height,l=function(t,l,u,c,d){var f=t(n,r,i,e,o),h=Jd(f,a,s,o);return h.fold(w(h),(function(e,t,n,r){var i=d===r?n>c||t>u:!d&&r;return i?h:Wd.nofit(l,u,c,d)}))},u=Q(t,(function(e,t){var n=C(l,t);return e.fold(w(e),n)}),Wd.nofit({rect:n,maxHeight:r.height,maxWidth:r.width,direction:yc(),placement:"southeast",classes:{on:[],off:[]},layout:"none",testY:n.y},-1,-1,!1));return u.fold(S,S)},Zd=function(e){var t=ia(N.none()),n=function(){return t.get().each(e)},r=function(){n(),t.set(N.none())},i=function(){return t.get().isSome()},o=function(){return t.get()},a=function(e){n(),t.set(N.some(e))};return{clear:r,isSet:i,get:o,set:a}},ef=function(){return Zd((function(e){return e.destroy()}))},tf=function(){return Zd((function(e){return e.unbind()}))},nf=function(){var e=ef(),t=function(t){return e.get().each(t)};return A(A({},e),{run:t})},rf=function(){var e=Zd(g),t=function(t){return e.get().each(t)};return A(A({},e),{on:t})},of=E,af=function(e,t,n){return Tr(e,t,of,n)},sf=function(e,t,n){return Dr(e,t,of,n)},lf=Sr,uf=["top","bottom","right","left"],cf="data-alloy-transition-timer",df=function(e,t){return du(e,t.classes)},ff=function(e,t,n){return n.exists((function(n){var r=e.mode;return"all"===r||n[r]!==t[r]}))},hf=function(e,t){var n=function(e){return parseFloat(e).toFixed(3)};return Te(t,(function(t,r){var i=e[r].map(n),o=t.map(n);return!Le(i,o)})).isSome()},mf=function(e){var t=function(t){var n=Jn(e,t),r=o(n)?n.split(/\s*,\s*/):[];return X(r,We)},n=function(e){if(o(e)&&/^[\d.]+/.test(e)){var t=parseFloat(e);return je(e,"ms")?t:1e3*t}return 0},r=t("transition-delay"),i=t("transition-duration");return Q(i,(function(e,t,i){var o=n(r[i])+n(t);return Math.max(e,o)}),0)},pf=function(e,t){var n,r=tf(),i=tf(),o=function(t){var n,r=null!==(n=t.raw.pseudoElement)&&void 0!==n?n:"";return un(t.target,e)&&Ke(r)&&V(uf,t.raw.propertyName)},a=function(a){if(d(a)||o(a)){r.clear(),i.clear();var s=null===a||void 0===a?void 0:a.raw.type;(d(s)||s===Ga())&&(clearTimeout(n),qn(e,cf),cu(e,t.classes))}},s=function(){r.set(af(e,Ga(),a)),i.set(af(e,qa(),a))};if("ontransitionstart"in e.dom)var l=af(e,Wa(),(function(e){o(e)&&(l.unbind(),s())}));else s();var u=mf(e);requestAnimationFrame((function(){n=setTimeout(a,u+17),zn(e,cf,n)}))},gf=function(e,t){uu(e,t.classes),Hn(e,cf).each((function(t){clearTimeout(parseInt(t,10)),qn(e,cf)})),pf(e,t)},vf=function(e,t,n,r,i,o){var a=ff(r,i,o);if(a||df(e,r)){Kn(e,"position",n.position);var s=Pd(t,e),l=Id(t,A(A({},i),{rect:s})),u=se(uf,(function(e){return l[e]}));hf(n,u)&&(Xn(e,u),a&&gf(e,r),rr(e))}else cu(e,r.classes)},bf=function(e){return{width:br(e),height:sr(e)}},yf=function(e,t,n,r){nr(t,"max-height"),nr(t,"max-width");var i=bf(t);return Qd(t,r.preference,e,i,n,r.bounds)},wf=function(e,t){var n=t.classes;cu(e,n.off),uu(e,n.on)},Sf=function(e,t,n){var r=n.maxHeightFunction;r(e,t.maxHeight)},xf=function(e,t,n){var r=n.maxWidthFunction;r(e,t.maxWidth)},Cf=function(e,t,n){var r=Id(n.origin,t);n.transition.each((function(i){vf(e,n.origin,r,i,t,n.lastPlacement)})),Ld(e,r)},Tf=function(e,t){jd(e,t.placement)},Df=function(e,t){lr(e,Math.floor(t))},kf=w((function(e,t){Df(e,t),Yn(e,{"overflow-x":"hidden","overflow-y":"auto"})})),Ef=w((function(e,t){Df(e,t)})),_f=function(e,t,n){return void 0===e[t]?n:e[t]},Af=function(e,t,n,r,i,o,a,s){var l=_f(a,"maxHeightFunction",kf()),u=_f(a,"maxWidthFunction",g),c=e.anchorBox,d=e.origin,f={bounds:Md(d,o),origin:d,preference:r,maxHeightFunction:l,maxWidthFunction:u,lastPlacement:i,transition:s};return Lf(c,t,n,f)},Lf=function(e,t,n,r){var i=yf(e,t,n,r);return Cf(t,i,r),Tf(t,i),wf(t,i),Sf(t,i,r),xf(t,i,r),{layout:i.layout,placement:i.placement}},Of=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right","inset"],Rf=function(e,t,n,r){void 0===r&&(r=1);var i=e*r,o=t*r,a=function(e){return ke(n,e).getOr([])},s=function(e,t,n){var r=ae(Of,n);return{offset:cr(e,t),classesOn:re(n,a),classesOff:re(r,a)}};return{southeast:function(){return s(-e,t,["top","alignLeft"])},southwest:function(){return s(e,t,["top","alignRight"])},south:function(){return s(-e/2,t,["top","alignCentre"])},northeast:function(){return s(-e,-t,["bottom","alignLeft"])},northwest:function(){return s(e,-t,["bottom","alignRight"])},north:function(){return s(-e/2,-t,["bottom","alignCentre"])},east:function(){return s(e,-t/2,["valignCentre","left"])},west:function(){return s(-e,-t/2,["valignCentre","right"])},insetNortheast:function(){return s(i,o,["top","alignLeft","inset"])},insetNorthwest:function(){return s(-i,o,["top","alignRight","inset"])},insetNorth:function(){return s(-i/2,o,["top","alignCentre","inset"])},insetSoutheast:function(){return s(i,-o,["bottom","alignLeft","inset"])},insetSouthwest:function(){return s(-i,-o,["bottom","alignRight","inset"])},insetSouth:function(){return s(-i/2,-o,["bottom","alignCentre","inset"])},insetEast:function(){return s(-i,-o/2,["valignCentre","right","inset"])},insetWest:function(){return s(i,-o/2,["valignCentre","left","inset"])}}},If=function(){return Rf(0,0,{})},Pf=S,Mf=function(e,t){return function(n){return"rtl"===Nf(n)?t:e}},Nf=function(e){return"rtl"===Jn(e,"direction")?"rtl":"ltr"};(function(e){e["TopToBottom"]="toptobottom",e["BottomToTop"]="bottomtotop"})(Bd||(Bd={}));var Ff="data-alloy-vertical-dir",Bf=function(e){return Mu(e,(function(e){return ct(e)&&Vn(e,"data-alloy-vertical-dir")===Bd.BottomToTop}))},$f=function(){return Go("layouts",[Ao("onLtr"),Ao("onRtl"),zo("onBottomLtr"),zo("onBottomRtl")])},zf=function(e,t,n,r,i,o,a){var s=a.map(Bf).getOr(!1),l=t.layouts.map((function(t){return t.onLtr(e)})),u=t.layouts.map((function(t){return t.onRtl(e)})),c=s?t.layouts.bind((function(t){return t.onBottomLtr.map((function(t){return t(e)}))})).or(l).getOr(i):l.getOr(n),d=s?t.layouts.bind((function(t){return t.onBottomRtl.map((function(t){return t(e)}))})).or(u).getOr(o):u.getOr(r),f=Mf(c,d);return f(e)},Uf=function(e,t,n){var r=t.hotspot,i=Pd(n,r.element),o=zf(e.element,t,Zc(),ed(),Jc(),Qc(),N.some(t.hotspot.element));return N.some(Pf({anchorBox:i,bubble:t.bubble.getOr(If()),overrides:t.overrides,layouts:o,placer:N.none()}))},Vf=[Ao("hotspot"),zo("bubble"),Ko("overrides",{}),$f(),dc("placement",Uf)],Hf=function(e,t,n){var r=Nd(n,t.x,t.y),i=Xr(r.left,r.top,t.width,t.height),o=zf(e.element,t,Yc(),Xc(),Yc(),Xc(),N.none());return N.some(Pf({anchorBox:i,bubble:t.bubble,overrides:t.overrides,layouts:o,placer:N.none()}))},jf=[Ao("x"),Ao("y"),Ko("height",0),Ko("width",0),Ko("bubble",If()),Ko("overrides",{}),$f(),dc("placement",Hf)],qf=aa.generate([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),Gf=function(e){return e.fold(S,(function(e,t,n){return e.translate(-t,-n)}))},Wf=function(e){return e.fold(S,S)},Kf=function(e){return Q(e,(function(e,t){return e.translate(t.left,t.top)}),cr(0,0))},Yf=function(e){var t=G(e,Gf);return Kf(t)},Xf=function(e){var t=G(e,Wf);return Kf(t)},Jf=qf.screen,Qf=qf.absolute,Zf=function(e,t,n){var r=gn(n.root).dom,i=function(t){var n=hn(t),r=hn(e.element);return un(n,r)};return N.from(r.frameElement).map(tt.fromDom).filter(i).map(hr)},eh=function(e,t,n){var r=hn(e.element),i=Fr(r),o=Zf(e,t,n).getOr(i);return Qf(o,i.left,i.top)},th=function(e,t,n,r){var i=Jf(cr(e,t));return N.some(Kr(i,n,r))},nh=function(e,t,n,r,i){return e.map((function(e){var o=[t,e.point],a=Fd(r,(function(){return Xf(o)}),(function(){return Xf(o)}),(function(){return Yf(o)})),s=Yr(a.left,a.top,e.width,e.height),l=n.showAbove?Jc():Zc(),u=n.showAbove?Qc():ed(),c=zf(i,n,l,u,l,u,N.none());return Pf({anchorBox:s,bubble:n.bubble.getOr(If()),overrides:n.overrides,layouts:c,placer:N.none()})}))},rh=function(e,t,n){var r=eh(e,n,t);return t.node.filter(Nn).bind((function(i){var o=i.dom.getBoundingClientRect(),a=th(o.left,o.top,o.width,o.height),s=t.node.getOr(e.element);return nh(a,r,t,n,s)}))},ih=[Ao("node"),Ao("root"),zo("bubble"),$f(),Ko("overrides",{}),Ko("showAbove",!1),dc("placement",rh)],oh="\ufeff",ah=" ",sh=function(e,t,n,r){return{start:e,soffset:t,finish:n,foffset:r}},lh={create:sh},uh=aa.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),ch=function(e,t,n,r){return e.fold(t,n,r)},dh=function(e){return e.fold(S,S,S)},fh=uh.before,hh=uh.on,mh=uh.after,ph={before:fh,on:hh,after:mh,cata:ch,getStart:dh},gh=aa.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),vh=function(e){return gh.exact(e.start,e.soffset,e.finish,e.foffset)},bh=function(e){return e.match({domRange:function(e){return tt.fromDom(e.startContainer)},relative:function(e,t){return ph.getStart(e)},exact:function(e,t,n,r){return e}})},yh=gh.domRange,wh=gh.relative,Sh=gh.exact,xh=function(e){var t=bh(e);return gn(t)},Ch=lh.create,Th={domRange:yh,relative:wh,exact:Sh,exactFromRange:vh,getWin:xh,range:Ch},Dh=function(e,t){t.fold((function(t){e.setStartBefore(t.dom)}),(function(t,n){e.setStart(t.dom,n)}),(function(t){e.setStartAfter(t.dom)}))},kh=function(e,t){t.fold((function(t){e.setEndBefore(t.dom)}),(function(t,n){e.setEnd(t.dom,n)}),(function(t){e.setEndAfter(t.dom)}))},Eh=function(e,t,n){var r=e.document.createRange();return Dh(r,t),kh(r,n),r},_h=function(e,t,n,r,i){var o=e.document.createRange();return o.setStart(t.dom,n),o.setEnd(r.dom,i),o},Ah=function(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}},Lh=function(e){var t=e.getClientRects(),n=t.length>0?t[0]:e.getBoundingClientRect();return n.width>0||n.height>0?N.some(n).map(Ah):N.none()},Oh=function(e){var t=e.getBoundingClientRect();return t.width>0||t.height>0?N.some(t).map(Ah):N.none()},Rh=aa.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Ih=function(e,t,n){return t(tt.fromDom(n.startContainer),n.startOffset,tt.fromDom(n.endContainer),n.endOffset)},Ph=function(e,t){return t.match({domRange:function(e){return{ltr:w(e),rtl:N.none}},relative:function(t,n){return{ltr:mt((function(){return Eh(e,t,n)})),rtl:mt((function(){return N.some(Eh(e,n,t))}))}},exact:function(t,n,r,i){return{ltr:mt((function(){return _h(e,t,n,r,i)})),rtl:mt((function(){return N.some(_h(e,r,i,t,n))}))}}})},Mh=function(e,t){var n=t.ltr();if(n.collapsed){var r=t.rtl().filter((function(e){return!1===e.collapsed}));return r.map((function(e){return Rh.rtl(tt.fromDom(e.endContainer),e.endOffset,tt.fromDom(e.startContainer),e.startOffset)})).getOrThunk((function(){return Ih(e,Rh.ltr,n)}))}return Ih(e,Rh.ltr,n)},Nh=function(e,t){var n=Ph(e,t);return Mh(e,n)},Fh=function(e,t){var n=Nh(e,t);return n.match({ltr:function(t,n,r,i){var o=e.document.createRange();return o.setStart(t.dom,n),o.setEnd(r.dom,i),o},rtl:function(t,n,r,i){var o=e.document.createRange();return o.setStart(r.dom,i),o.setEnd(t.dom,n),o}})};Rh.ltr,Rh.rtl;var Bh,$h=function(e,t){var n=function(n){if(!e(n))throw new Error("Can only get "+t+" value of a "+t+" node");return r(n).getOr("")},r=function(t){return e(t)?N.from(t.dom.nodeValue):N.none()},i=function(n,r){if(!e(n))throw new Error("Can only set raw "+t+" value of a "+t+" node");n.dom.nodeValue=r};return{get:n,getOption:r,set:i}},zh=$h(dt,"text"),Uh=function(e){return zh.get(e)},Vh=function(e){return zh.getOption(e)},Hh=function(e){return"img"===st(e)?1:Vh(e).fold((function(){return Sn(e).length}),(function(e){return e.length}))},jh=function(e){return Vh(e).filter((function(e){return 0!==e.trim().length||e.indexOf(ah)>-1})).isSome()},qh=["img","br"],Gh=function(e){var t=jh(e);return t||V(qh,st(e))},Wh=function(e){return Kh(e,Gh)},Kh=function(e,t){var n=function(e){for(var r=Sn(e),i=r.length-1;i>=0;i--){var o=r[i];if(t(o))return N.some(o);var a=n(o);if(a.isSome())return a}return N.none()};return n(e)},Yh=function(e,t){return sn(t,e)},Xh=function(e,t,n,r){var i=hn(e),o=i.dom.createRange();return o.setStart(e.dom,t),o.setEnd(n.dom,r),o},Jh=function(e,t,n,r){var i=Xh(e,t,n,r),o=un(e,n)&&t===r;return i.collapsed&&!o},Qh=function(e){return N.from(e.getSelection())},Zh=function(e){if(e.rangeCount>0){var t=e.getRangeAt(0),n=e.getRangeAt(e.rangeCount-1);return N.some(lh.create(tt.fromDom(t.startContainer),t.startOffset,tt.fromDom(n.endContainer),n.endOffset))}return N.none()},em=function(e){if(null===e.anchorNode||null===e.focusNode)return Zh(e);var t=tt.fromDom(e.anchorNode),n=tt.fromDom(e.focusNode);return Jh(t,e.anchorOffset,n,e.focusOffset)?N.some(lh.create(t,e.anchorOffset,n,e.focusOffset)):Zh(e)},tm=function(e){return Qh(e).filter((function(e){return e.rangeCount>0})).bind(em)},nm=function(e,t){var n=Fh(e,t);return Lh(n)},rm=function(e,t){var n=Fh(e,t);return Oh(n)},im=function(e,t){return{element:e,offset:t}},om=function(e,t){var n=Sn(e);if(0===n.length)return im(e,t);if(t<n.length)return im(n[t],0);var r=n[n.length-1],i=dt(r)?Uh(r).length:Sn(r).length;return im(r,i)},am=function(e,t){return dt(e)?im(e,t):om(e,t)},sm=function(e,t){var n=t.getSelection.getOrThunk((function(){return function(){return tm(e)}}));return n().map((function(e){var t=am(e.start,e.soffset),n=am(e.finish,e.foffset);return Th.range(t.element,t.offset,n.element,n.offset)}))},lm=function(e,t,n){var r=gn(t.root).dom,i=eh(e,n,t),o=sm(r,t).bind((function(e){var t=rm(r,Th.exactFromRange(e)).orThunk((function(){var t=tt.fromText(oh);Er(e.start,t);var n=nm(r,Th.exact(t,0,t,1));return Mr(t),n}));return t.bind((function(e){return th(e.left,e.top,e.width,e.height)}))})),a=sm(r,t).bind((function(e){return ct(e.start)?N.some(e.start):bn(e.start)})),s=a.getOr(e.element);return nh(o,i,t,n,s)},um=[zo("getSelection"),Ao("root"),zo("bubble"),$f(),Ko("overrides",{}),Ko("showAbove",!1),dc("placement",lm)],cm="link-layout",dm=function(e){return e.x+e.width},fm=function(e,t){return e.x-t.width},hm=function(e,t){return e.y-t.height+e.height},mm=function(e){return e.y},pm=function(e,t,n){return mc(dm(e),mm(e),n.southeast(),yc(),"southeast",Lc(e,{left:0,top:2}),cm)},gm=function(e,t,n){return mc(fm(e,t),mm(e),n.southwest(),wc(),"southwest",Lc(e,{right:1,top:2}),cm)},vm=function(e,t,n){return mc(dm(e),hm(e,t),n.northeast(),Sc(),"northeast",Lc(e,{left:0,bottom:3}),cm)},bm=function(e,t,n){return mc(fm(e,t),hm(e,t),n.northwest(),xc(),"northwest",Lc(e,{right:1,bottom:3}),cm)},ym=function(){return[pm,gm,vm,bm]},wm=function(){return[gm,pm,bm,vm]},Sm=function(e,t,n){var r=Pd(n,t.item.element),i=zf(e.element,t,ym(),wm(),ym(),wm(),N.none());return N.some(Pf({anchorBox:r,bubble:If(),overrides:t.overrides,layouts:i,placer:N.none()}))},xm=[Ao("item"),$f(),Ko("overrides",{}),dc("placement",Sm)],Cm=To("type",{selection:um,node:ih,hotspot:Vf,submenu:xm,makeshift:jf}),Tm=[$o("classes",lo),Qo("mode","all",["all","layout","placement"])],Dm=[Ko("useFixed",k),zo("getBounds")],km=[Lo("anchor",Cm),Go("transition",Tm)],Em=function(){var e=document.documentElement;return zd(0,0,e.clientWidth,e.clientHeight)},_m=function(e){var t=hr(e.element),n=e.element.dom.getBoundingClientRect();return $d(t.left,t.top,n.width,n.height)},Am=function(e,t,n,r,i,o,a){var s=Vd(n.anchorBox,t);return Af(s,i.element,n.bubble,n.layouts,o,r,n.overrides,a)},Lm=function(e,t,n,r,i){Om(e,t,n,r,i,N.none())},Om=function(e,t,n,r,i,o){var a=o.map(Jr);return Rm(e,t,n,r,i,a)},Rm=function(e,t,n,r,i,o){var a=xo("placement.info",Zi(km),i),s=a.anchor,l=r.element,u=n.get(r.uid);Ed((function(){Kn(l,"position","fixed");var i=Zn(l,"visibility");Kn(l,"visibility","hidden");var c=t.useFixed()?Em():_m(e),d=s.placement,f=o.map(w).or(t.getBounds);d(e,s,c).each((function(t){var i=t.placer.getOr(Am),o=i(e,c,t,f,r,u,a.transition);n.set(r.uid,o)})),i.fold((function(){nr(l,"visibility")}),(function(e){Kn(l,"visibility",e)})),Zn(l,"left").isNone()&&Zn(l,"top").isNone()&&Zn(l,"right").isNone()&&Zn(l,"bottom").isNone()&&Ae(Zn(l,"position"),"fixed")&&nr(l,"position")}),l)},Im=function(e,t,n){return t.useFixed()?"fixed":"absolute"},Pm=function(e,t,n,r){var i=r.element;W(["position","left","right","top","bottom"],(function(e){return nr(i,e)})),Gd(i),n.clear(r.uid)},Mm=Object.freeze({__proto__:null,position:Lm,positionWithin:Om,positionWithinBounds:Rm,getMode:Im,reset:Pm}),Nm=function(){var e={},t=function(t,n){e[t]=n},n=function(t){return ke(e,t)},r=function(t){f(t)?delete e[t]:e={}};return Dl({readState:function(){return e},clear:r,set:t,get:n})},Fm=Object.freeze({__proto__:null,init:Nm}),Bm=md({fields:Dm,name:"positioning",active:wd,apis:Mm,state:Fm}),$m=function(e){xs(e,hs());var t=e.components();W(t,$m)},zm=function(e){var t=e.components();W(t,zm),xs(e,fs())},Um=function(e,t){Lr(e.element,t.element)},Vm=function(e){W(e.components(),(function(e){return Mr(e.element)})),Pr(e.element),e.syncComponents()},Hm=function(e,t){var n=e.components();Vm(e);var r=ae(n,t);W(r,(function(t){$m(t),e.getSystem().removeFromWorld(t)})),W(t,(function(t){t.getSystem().isConnected()?Um(e,t):(e.getSystem().addToWorld(t),Um(e,t),Nn(e.element)&&zm(t)),e.syncComponents()}))},jm=function(e,t){qm(e,t,Lr)},qm=function(e,t,n){e.getSystem().addToWorld(t),n(e.element,t.element),Nn(e.element)&&zm(t),e.syncComponents()},Gm=function(e){$m(e),Mr(e.element),e.getSystem().removeFromWorld(e)},Wm=function(e){var t=vn(e.element).bind((function(t){return e.getSystem().getByDom(t).toOptional()}));Gm(e),t.each((function(e){e.syncComponents()}))},Km=function(e){var t=e.components();W(t,Gm),Pr(e.element),e.syncComponents()},Ym=function(e,t){Jm(e,t,Lr)},Xm=function(e,t){Jm(e,t,_r)},Jm=function(e,t,n){n(e,t.element);var r=Sn(t.element);W(r,(function(e){t.getByDom(e).each(zm)}))},Qm=function(e){var t=Sn(e.element);W(t,(function(t){e.getByDom(t).each($m)})),Mr(e.element)},Zm=function(e,t,n,r){n.get().each((function(t){Km(e)}));var i=t.getAttachPoint(e);jm(i,e);var o=e.getSystem().build(r);return jm(e,o),n.set(o),o},ep=function(e,t,n,r){var i=Zm(e,t,n,r);return t.onOpen(e,i),i},tp=function(e,t,n,r){return n.get().map((function(){return Zm(e,t,n,r)}))},np=function(e,t,n,r,i){up(e,t),ep(e,t,n,r),i(),dp(e,t)},rp=function(e,t,n){n.get().each((function(r){Km(e),Wm(e),t.onClose(e,r),n.clear()}))},ip=function(e,t,n){return n.isOpen()},op=function(e,t,n,r){return ip(e,t,n)&&n.get().exists((function(n){return t.isPartOf(e,n,r)}))},ap=function(e,t,n){return n.get()},sp=function(e,t,n,r){Zn(e.element,t).fold((function(){qn(e.element,n)}),(function(t){zn(e.element,n,t)})),Kn(e.element,t,r)},lp=function(e,t,n){Hn(e.element,n).fold((function(){return nr(e.element,t)}),(function(n){return Kn(e.element,t,n)}))},up=function(e,t,n){var r=t.getAttachPoint(e);Kn(e.element,"position",Bm.getMode(r)),sp(e,"visibility",t.cloakVisibilityAttr,"hidden")},cp=function(e){return H(["top","left","right","bottom"],(function(t){return Zn(e,t).isSome()}))},dp=function(e,t,n){cp(e.element)||nr(e.element,"position"),lp(e,"visibility",t.cloakVisibilityAttr)},fp=Object.freeze({__proto__:null,cloak:up,decloak:dp,open:ep,openWhileCloaked:np,close:rp,isOpen:ip,isPartOf:op,getState:ap,setContent:tp}),hp=function(e,t){return _s([Rs(os(),(function(n,r){rp(n,e,t)}))])},mp=Object.freeze({__proto__:null,events:hp}),pp=[sc("onOpen"),sc("onClose"),Ao("isPartOf"),Ao("getAttachPoint"),Ko("cloakVisibilityAttr","data-precloak-visibility")],gp=function(){var e=rf(),t=w("not-implemented");return Dl({readState:t,isOpen:e.isSet,clear:e.clear,set:e.set,get:e.get})},vp=Object.freeze({__proto__:null,init:gp}),bp=md({fields:pp,name:"sandboxing",active:mp,apis:fp,state:vp}),yp=w("dismiss.popups"),wp=w("reposition.popups"),Sp=w("mouse.released"),xp=Qi([Ko("isExtraPart",k),Go("fireEventInstead",[Ko("event",ms())])]),Cp=function(e){var t,n=xo("Dismissal",xp,e);return t={},t[yp()]={schema:Qi([Ao("target")]),onReceive:function(e,t){if(bp.isOpen(e)){var r=bp.isPartOf(e,t.target)||n.isExtraPart(e,t.target);r||n.fireEventInstead.fold((function(){return bp.close(e)}),(function(t){return xs(e,t.event)}))}}},t},Tp=Qi([Go("fireEventInstead",[Ko("event",ps())]),Mo("doReposition")]),Dp=function(e){var t,n=xo("Reposition",Tp,e);return t={},t[wp()]={onReceive:function(e){bp.isOpen(e)&&n.fireEventInstead.fold((function(){return n.doReposition(e)}),(function(t){return xs(e,t.event)}))}},t},kp=function(e,t,n){t.store.manager.onLoad(e,t,n)},Ep=function(e,t,n){t.store.manager.onUnload(e,t,n)},_p=function(e,t,n,r){t.store.manager.setValue(e,t,n,r)},Ap=function(e,t,n){return t.store.manager.getValue(e,t,n)},Lp=function(e,t,n){return n},Op=Object.freeze({__proto__:null,onLoad:kp,onUnload:Ep,setValue:_p,getValue:Ap,getState:Lp}),Rp=function(e,t){var n=e.resetOnDom?[Vs((function(n,r){kp(n,e,t)})),Hs((function(n,r){Ep(n,e,t)}))]:[ad(e,t,kp)];return _s(n)},Ip=Object.freeze({__proto__:null,events:Rp}),Pp=function(){var e=ia(null),t=function(){return{mode:"memory",value:e.get()}},n=function(){return null===e.get()},r=function(){e.set(null)};return Dl({set:e.set,get:e.get,isNotSet:n,clear:r,readState:t})},Mp=function(){var e=g;return Dl({readState:e})},Np=function(){var e=ia({}),t=ia({}),n=function(){return{mode:"dataset",dataByValue:e.get(),dataByText:t.get()}},r=function(){e.set({}),t.set({})},i=function(n){return ke(e.get(),n).orThunk((function(){return ke(t.get(),n)}))},o=function(n){var r=e.get(),i=t.get(),o={},a={};W(n,(function(e){o[e.value]=e,ke(e,"meta").each((function(t){ke(t,"text").each((function(t){a[t]=e}))}))})),e.set(A(A({},r),o)),t.set(A(A({},i),a))};return Dl({readState:n,lookup:i,update:o,clear:r})},Fp=function(e){return e.store.manager.state(e)},Bp=Object.freeze({__proto__:null,memory:Pp,dataset:Np,manual:Mp,init:Fp}),$p=function(e,t,n,r){var i=t.store;n.update([r]),i.setValue(e,r),t.onSetValue(e,r)},zp=function(e,t,n){var r=t.store,i=r.getDataKey(e);return n.lookup(i).getOrThunk((function(){return r.getFallbackEntry(i)}))},Up=function(e,t,n){var r=t.store;r.initialValue.each((function(r){$p(e,t,n,r)}))},Vp=function(e,t,n){n.clear()},Hp=[zo("initialValue"),Ao("getFallbackEntry"),Ao("getDataKey"),Ao("setValue"),dc("manager",{setValue:$p,getValue:zp,onLoad:Up,onUnload:Vp,state:Np})],jp=function(e,t,n){return t.store.getValue(e)},qp=function(e,t,n,r){t.store.setValue(e,r),t.onSetValue(e,r)},Gp=function(e,t,n){t.store.initialValue.each((function(n){t.store.setValue(e,n)}))},Wp=[Ao("getValue"),Ko("setValue",g),zo("initialValue"),dc("manager",{setValue:qp,getValue:jp,onLoad:Gp,onUnload:g,state:Tl.init})],Kp=function(e,t,n,r){n.set(r),t.onSetValue(e,r)},Yp=function(e,t,n){return n.get()},Xp=function(e,t,n){t.store.initialValue.each((function(e){n.isNotSet()&&n.set(e)}))},Jp=function(e,t,n){n.clear()},Qp=[zo("initialValue"),dc("manager",{setValue:Kp,getValue:Yp,onLoad:Xp,onUnload:Jp,state:Pp})],Zp=[Yo("store",{mode:"memory"},To("mode",{memory:Qp,manual:Wp,dataset:Hp})),sc("onSetValue"),Ko("resetOnDom",!1)],eg=md({fields:Zp,name:"representing",active:Ip,apis:Op,extra:{setValueFrom:function(e,t){var n=eg.getValue(t);eg.setValue(e,n)}},state:Bp}),tg=function(e,t){return ra(e,{},G(t,(function(t){return No(t.name(),"Cannot configure "+t.name()+" for "+e)})).concat([Eo("dump",S)]))},ng=function(e){return e.dump},rg=function(e,t){return A(A({},fd(t)),e.dump)},ig={field:tg,augment:rg,get:ng},og="placeholder",ag=aa.generate([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),sg=function(e){return Ee(e,"uiType")},lg=function(e,t,n,r){return e.exists((function(e){return e!==n.owner}))?ag.single(!0,w(n)):ke(r,n.name).fold((function(){throw new Error("Unknown placeholder component: "+n.name+"\nKnown: ["+pe(r)+"]\nNamespace: "+e.getOr("none")+"\nSpec: "+JSON.stringify(n,null,2))}),(function(e){return e.replace()}))},ug=function(e,t,n,r){return sg(n)&&n.uiType===og?lg(e,t,n,r):ag.single(!1,w(n))},cg=function(e,t,n,r){var i=ug(e,t,n,r);return i.fold((function(i,o){var a=sg(n)?o(t,n.config,n.validated):o(t),s=ke(a,"components").getOr([]),l=re(s,(function(n){return cg(e,t,n,r)}));return[A(A({},a),{components:l})]}),(function(e,r){if(sg(n)){var i=r(t,n.config,n.validated),o=n.validated.preprocess.getOr(S);return o(i)}return r(t)}))},dg=function(e,t,n,r){return re(n,(function(n){return cg(e,t,n,r)}))},fg=function(e,t){var n=!1,r=function(){return n},i=function(){if(n)throw new Error("Trying to use the same placeholder more than once: "+e);return n=!0,t},o=function(){return t.fold((function(e,t){return e}),(function(e,t){return e}))};return{name:w(e),required:o,used:r,replace:i}},hg=function(e,t,n,r){var i=be(r,(function(e,t){return fg(t,e)})),o=dg(e,t,n,i);return ve(i,(function(n){if(!1===n.used()&&n.required())throw new Error("Placeholder: "+n.name()+" was not found in components list\nNamespace: "+e.getOr("none")+"\nComponents: "+JSON.stringify(t.components,null,2))})),o},mg=ag.single,pg=ag.multiple,gg=w(og),vg=aa.generate([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),bg=Ko("factory",{sketch:S}),yg=Ko("schema",[]),wg=Ao("name"),Sg=ko("pname","pname",Ti((function(e){return"<alloy."+il(e.name)+">"})),oo()),xg=Eo("schema",(function(){return[zo("preprocess")]})),Cg=Ko("defaults",w({})),Tg=Ko("overrides",w({})),Dg=Zi([bg,yg,wg,Sg,Cg,Tg]),kg=Zi([bg,yg,wg,Cg,Tg]),Eg=Zi([bg,yg,wg,Sg,Cg,Tg]),_g=Zi([bg,xg,wg,Ao("unit"),Sg,Cg,Tg]),Ag=function(e){return e.fold(N.some,N.none,N.some,N.some)},Lg=function(e){var t=function(e){return e.name};return e.fold(t,t,t,t)},Og=function(e){return e.fold(S,S,S,S)},Rg=function(e,t){return function(n){var r=xo("Converting part type",t,n);return e(r)}},Ig=Rg(vg.required,Dg),Pg=Rg(vg.external,kg),Mg=Rg(vg.optional,Eg),Ng=Rg(vg.group,_g),Fg=w("entirety"),Bg=Object.freeze({__proto__:null,required:Ig,external:Pg,optional:Mg,group:Ng,asNamedPart:Ag,name:Lg,asCommon:Og,original:Fg}),$g=function(e,t,n,r){return Si(t.defaults(e,n,r),n,{uid:e.partUids[t.name]},t.overrides(e,n,r))},zg=function(e,t,n){var r={},i={};return W(n,(function(e){e.fold((function(e){r[e.pname]=mg(!0,(function(t,n,r){return e.factory.sketch($g(t,e,n,r))}))}),(function(e){var n=t.parts[e.name];i[e.name]=w(e.factory.sketch($g(t,e,n[Fg()]),n))}),(function(e){r[e.pname]=mg(!1,(function(t,n,r){return e.factory.sketch($g(t,e,n,r))}))}),(function(e){r[e.pname]=pg(!0,(function(t,n,r){var i=t[e.name];return G(i,(function(n){return e.factory.sketch(Si(e.defaults(t,n,r),n,e.overrides(t,n)))}))}))}))})),{internals:w(r),externals:w(i)}},Ug=function(e,t){var n={};return W(t,(function(t){Ag(t).each((function(t){var r=Vg(e,t.pname);n[t.name]=function(n){var i=xo("Part: "+t.name+" in "+e,Zi(t.schema),n);return A(A({},r),{config:n,validated:i})}}))})),n},Vg=function(e,t){return{uiType:gg(),owner:e,name:t}},Hg=function(e,t,n){return{uiType:gg(),owner:e,name:t,config:n,validated:{}}},jg=function(e){return re(e,(function(e){return e.fold(N.none,N.some,N.none,N.none).map((function(e){return Fo(e.name,e.schema.concat([fc(Fg())]))})).toArray()}))},qg=function(e){return G(e,Lg)},Gg=function(e,t,n){return zg(e,t,n)},Wg=function(e,t,n){return hg(N.some(e),t,t.components,n)},Kg=function(e,t,n){var r=t.partUids[n];return e.getSystem().getByUid(r).toOptional()},Yg=function(e,t,n){return Kg(e,t,n).getOrDie("Could not find part: "+n)},Xg=function(e,t,n){var r={},i=t.partUids,o=e.getSystem();return W(n,(function(e){r[e]=w(o.getByUid(i[e]))})),r},Jg=function(e,t){var n=e.getSystem();return be(t.partUids,(function(e,t){return w(n.getByUid(e))}))},Qg=function(e){return pe(e.partUids)},Zg=function(e,t,n){var r={},i=t.partUids,o=e.getSystem();return W(n,(function(e){r[e]=w(o.getByUid(i[e]).getOrDie())})),r},ev=function(e,t){var n=qg(t);return ma(G(n,(function(t){return{key:t,value:e+"-"+t}})))},tv=function(e){return ko("partUids","partUids",Ei((function(t){return ev(t.uid,e)})),oo())},nv=Object.freeze({__proto__:null,generate:Ug,generateOne:Hg,schemas:jg,names:qg,substitutes:Gg,components:Wg,defaultUids:ev,defaultUidsSchema:tv,getAllParts:Jg,getAllPartNames:Qg,getPart:Kg,getPartOrDie:Yg,getParts:Xg,getPartsOrDie:Zg}),rv=function(e,t){var n=e.length>0?[Fo("parts",e)]:[];return n.concat([Ao("uid"),Ko("dom",{}),Ko("components",[]),fc("originalSpec"),Ko("debug.sketcher",{})]).concat(t)},iv=function(e,t,n,r,i){var o=rv(r,i);return xo(e+" [SpecSchema]",Qi(o.concat(t)),n)},ov=function(e,t,n,r){var i=lv(r),o=iv(e,t,i,[],[]);return n(o,i)},av=function(e,t,n,r,i){var o=lv(i),a=jg(n),s=tv(n),l=iv(e,t,o,a,[s]),u=Gg(e,l,n),c=Wg(e,l,u.internals());return r(l,c,o,u.externals())},sv=function(e){return Ee(e,"uid")},lv=function(e){return sv(e)?e:A(A({},e),{uid:fl("uid")})},uv=function(e){return void 0!==e.uid},cv=Qi([Ao("name"),Ao("factory"),Ao("configFields"),Ko("apis",{}),Ko("extraApis",{})]),dv=Qi([Ao("name"),Ao("factory"),Ao("configFields"),Ao("partFields"),Ko("apis",{}),Ko("extraApis",{})]),fv=function(e){var t=xo("Sketcher for "+e.name,cv,e),n=function(e){return ov(t.name,t.configFields,t.factory,e)},r=be(t.apis,Cl),i=be(t.extraApis,(function(e,t){return bl(e,t)}));return A(A({name:t.name,configFields:t.configFields,sketch:n},r),i)},hv=function(e){var t=xo("Sketcher for "+e.name,dv,e),n=function(e){return av(t.name,t.configFields,t.partFields,t.factory,e)},r=Ug(t.name,t.partFields),i=be(t.apis,Cl),o=be(t.extraApis,(function(e,t){return bl(e,t)}));return A(A({name:t.name,partFields:t.partFields,configFields:t.configFields,sketch:n,parts:r},i),o)},mv=function(e){return"input"===st(e)&&"radio"!==Vn(e,"type")||"textarea"===st(e)},pv=function(e,t,n){return t.find(e)},gv=Object.freeze({__proto__:null,getCurrent:pv}),vv=[Ao("find")],bv=md({fields:vv,name:"composing",apis:gv}),yv=["input","button","textarea","select"],wv=function(e,t,n){var r=t.disabled()?_v:Av;r(e,t)},Sv=function(e,t){return!0===t.useNative&&V(yv,st(e.element))},xv=function(e){return jn(e.element,"disabled")},Cv=function(e){zn(e.element,"disabled","disabled")},Tv=function(e){qn(e.element,"disabled")},Dv=function(e){return"true"===Vn(e.element,"aria-disabled")},kv=function(e){zn(e.element,"aria-disabled","true")},Ev=function(e){zn(e.element,"aria-disabled","false")},_v=function(e,t,n){t.disableClass.each((function(t){ou(e.element,t)}));var r=Sv(e,t)?Cv:kv;r(e),t.onDisabled(e)},Av=function(e,t,n){t.disableClass.each((function(t){su(e.element,t)}));var r=Sv(e,t)?Tv:Ev;r(e),t.onEnabled(e)},Lv=function(e,t){return Sv(e,t)?xv(e):Dv(e)},Ov=function(e,t,n,r){var i=r?_v:Av;i(e,t)},Rv=Object.freeze({__proto__:null,enable:Av,disable:_v,isDisabled:Lv,onLoad:wv,set:Ov}),Iv=function(e,t){return Ll({classes:t.disabled()?t.disableClass.toArray():[]})},Pv=function(e,t){return _s([As(ts(),(function(t,n){return Lv(t,e)})),ad(e,t,wv)])},Mv=Object.freeze({__proto__:null,exhibit:Iv,events:Pv}),Nv=[ea("disabled",k),Ko("useNative",!0),zo("disableClass"),sc("onDisabled"),sc("onEnabled")],Fv=md({fields:Nv,name:"disabling",active:Mv,apis:Rv}),Bv=function(e,t,n,r){var i=Yh(e.element,"."+t.highlightClass);W(i,(function(n){H(r,(function(e){return e.element===n}))||(su(n,t.highlightClass),e.getSystem().getByDom(n).each((function(n){t.onDehighlight(e,n),xs(n,Ss())})))}))},$v=function(e,t,n){return Bv(e,t,n,[])},zv=function(e,t,n,r){Gv(e,t,n,r)&&(su(r.element,t.highlightClass),t.onDehighlight(e,r),xs(r,Ss()))},Uv=function(e,t,n,r){Bv(e,t,n,[r]),Gv(e,t,n,r)||(ou(r.element,t.highlightClass),t.onHighlight(e,r),xs(r,ws()))},Vv=function(e,t,n){Yv(e,t).each((function(r){Uv(e,t,n,r)}))},Hv=function(e,t,n){Xv(e,t).each((function(r){Uv(e,t,n,r)}))},jv=function(e,t,n,r){Kv(e,t,n,r).fold((function(e){throw e}),(function(r){Uv(e,t,n,r)}))},qv=function(e,t,n,r){var i=eb(e,t),o=ee(i,r);o.each((function(r){Uv(e,t,n,r)}))},Gv=function(e,t,n,r){return lu(r.element,t.highlightClass)},Wv=function(e,t,n){return Bu(e.element,"."+t.highlightClass).bind((function(t){return e.getSystem().getByDom(t).toOptional()}))},Kv=function(e,t,n,r){var i=Yh(e.element,"."+t.itemClass);return N.from(i[r]).fold((function(){return ri.error(new Error("No element found with index "+r))}),e.getSystem().getByDom)},Yv=function(e,t,n){return Bu(e.element,"."+t.itemClass).bind((function(t){return e.getSystem().getByDom(t).toOptional()}))},Xv=function(e,t,n){var r=Yh(e.element,"."+t.itemClass),i=r.length>0?N.some(r[r.length-1]):N.none();return i.bind((function(t){return e.getSystem().getByDom(t).toOptional()}))},Jv=function(e,t,n,r){var i=Yh(e.element,"."+t.itemClass),o=te(i,(function(e){return lu(e,t.highlightClass)}));return o.bind((function(t){var n=Ec(t,r,0,i.length-1);return e.getSystem().getByDom(i[n]).toOptional()}))},Qv=function(e,t,n){return Jv(e,t,n,-1)},Zv=function(e,t,n){return Jv(e,t,n,1)},eb=function(e,t,n){var r=Yh(e.element,"."+t.itemClass);return Oe(G(r,(function(t){return e.getSystem().getByDom(t).toOptional()})))},tb=Object.freeze({__proto__:null,dehighlightAll:$v,dehighlight:zv,highlight:Uv,highlightFirst:Vv,highlightLast:Hv,highlightAt:jv,highlightBy:qv,isHighlighted:Gv,getHighlighted:Wv,getFirst:Yv,getLast:Xv,getPrevious:Qv,getNext:Zv,getCandidates:eb}),nb=[Ao("highlightClass"),Ao("itemClass"),sc("onHighlight"),sc("onDehighlight")],rb=md({fields:nb,name:"highlighting",apis:tb}),ib=[8],ob=[9],ab=[13],sb=[27],lb=[32],ub=[37],cb=[38],db=[39],fb=[40],hb=function(e,t,n){var r=oe(e.slice(0,t)),i=oe(e.slice(t+1));return ee(r.concat(i),n)},mb=function(e,t,n){var r=oe(e.slice(0,t));return ee(r,n)},pb=function(e,t,n){var r=e.slice(0,t),i=e.slice(t+1);return ee(i.concat(r),n)},gb=function(e,t,n){var r=e.slice(t+1);return ee(r,n)},vb=function(e){return function(t){var n=t.raw;return V(e,n.which)}},bb=function(e){return function(t){return ie(e,(function(e){return e(t)}))}},yb=function(e){var t=e.raw;return!0===t.shiftKey},wb=function(e){var t=e.raw;return!0===t.ctrlKey},Sb=T(yb),xb=function(e,t){return{matches:e,classification:t}},Cb=function(e,t){var n=ee(e,(function(e){return e.matches(t)}));return n.map((function(e){return e.classification}))},Tb=function(e,t,n){var r=t.exists((function(e){return n.exists((function(t){return un(t,e)}))}));r||Cs(e,gs(),{prevFocus:t,newFocus:n})},Db=function(){var e=function(e){return kd(e.element)},t=function(t,n){var r=e(t);t.getSystem().triggerFocus(n,t.element);var i=e(t);Tb(t,r,i)};return{get:e,set:t}},kb=function(){var e=function(e){return rb.getHighlighted(e).map((function(e){return e.element}))},t=function(t,n){var r=e(t);t.getSystem().getByDom(n).fold(g,(function(e){rb.highlight(t,e)}));var i=e(t);Tb(t,r,i)};return{get:e,set:t}};(function(e){e["OnFocusMode"]="onFocus",e["OnEnterOrSpaceMode"]="onEnterOrSpace",e["OnApiMode"]="onApi"})(Bh||(Bh={}));var Eb=function(e,t,n,r,i){var o=function(){return e.concat([Ko("focusManager",Db()),Yo("focusInside","onFocus",vo((function(e){return V(["onFocus","onEnterOrSpace","onApi"],e)?ri.value(e):ri.error("Invalid value for focusInside")}))),dc("handler",l),dc("state",t),dc("sendFocusIn",i)])},a=function(e,t,n,r,i){var o=n(e,t,r,i);return Cb(o,t.event).bind((function(n){return n(e,t,r,i)}))},s=function(e,t){var o=e.focusInside!==Bh.OnFocusMode?N.none():i(e).map((function(n){return Rs(Ja(),(function(r,i){n(r,e,t),i.stop()}))})),s=function(n,r){var o=vb(lb.concat(ab))(r.event);e.focusInside===Bh.OnEnterOrSpaceMode&&o&&Sa(n,r)&&i(e).each((function(i){i(n,e,t),r.stop()}))},l=[Rs(za(),(function(r,i){a(r,i,n,e,t).fold((function(){s(r,i)}),(function(e){i.stop()}))})),Rs(Ua(),(function(n,i){a(n,i,r,e,t).each((function(e){i.stop()}))}))];return _s(o.toArray().concat(l))},l={schema:o,processKey:a,toEvents:s};return l},_b=function(e){var t=[zo("onEscape"),zo("onEnter"),Ko("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),Ko("firstTabstop",0),Ko("useTabstopAt",E),zo("visibilitySelector")].concat([e]),n=function(e,t){var n=e.visibilitySelector.bind((function(e){return $u(t,e)})).getOr(t);return ar(n)>0},r=function(e,t){var r=Yh(e.element,t.selector),i=X(r,(function(e){return n(t,e)}));return N.from(i[t.firstTabstop])},i=function(e,t){return t.focusManager.get(e).bind((function(e){return $u(e,t.selector)}))},o=function(e,t){return n(e,t)&&e.useTabstopAt(t)},a=function(e,t,n){r(e,t).each((function(n){t.focusManager.set(e,n)}))},s=function(e,t,n,r,i){return i(t,n,(function(e){return o(r,e)})).fold((function(){return r.cyclic?N.some(!0):N.none()}),(function(t){return r.focusManager.set(e,t),N.some(!0)}))},l=function(e,t,n,r){var o=Yh(e.element,n.selector);return i(e,n).bind((function(t){var i=te(o,C(un,t));return i.bind((function(t){return s(e,o,t,n,r)}))}))},u=function(e,t,n){var r=n.cyclic?hb:mb;return l(e,t,n,r)},c=function(e,t,n){var r=n.cyclic?pb:gb;return l(e,t,n,r)},d=function(e,t,n){return n.onEnter.bind((function(n){return n(e,t)}))},f=function(e,t,n){return n.onEscape.bind((function(n){return n(e,t)}))},h=w([xb(bb([yb,vb(ob)]),u),xb(vb(ob),c),xb(vb(sb),f),xb(bb([Sb,vb(ab)]),d)]),m=w([]);return Eb(t,Tl.init,h,m,(function(){return N.some(a)}))},Ab=_b(Eo("cyclic",k)),Lb=_b(Eo("cyclic",E)),Ob=function(e,t,n){return Ds(e,n,ts()),N.some(!0)},Rb=function(e,t,n){var r=mv(n)&&vb(lb)(t.event);return r?N.none():Ob(e,t,n)},Ib=function(e,t){return N.some(!0)},Pb=[Ko("execute",Rb),Ko("useSpace",!1),Ko("useEnter",!0),Ko("useControlEnter",!1),Ko("useDown",!1)],Mb=function(e,t,n){return n.execute(e,t,e.element)},Nb=function(e,t,n,r){var i=n.useSpace&&!mv(e.element)?lb:[],o=n.useEnter?ab:[],a=n.useDown?fb:[],s=i.concat(o).concat(a);return[xb(vb(s),Mb)].concat(n.useControlEnter?[xb(bb([wb,vb(ab)]),Mb)]:[])},Fb=function(e,t,n,r){return n.useSpace&&!mv(e.element)?[xb(vb(lb),Ib)]:[]},Bb=Eb(Pb,Tl.init,Nb,Fb,(function(){return N.none()})),$b=function(){var e=rf(),t=function(t,n){e.set({numRows:t,numColumns:n})},n=function(){return e.get().map((function(e){return e.numRows}))},r=function(){return e.get().map((function(e){return e.numColumns}))};return Dl({readState:function(){return e.get().map((function(e){return{numRows:String(e.numRows),numColumns:String(e.numColumns)}})).getOr({numRows:"?",numColumns:"?"})},setGridSize:t,getNumRows:n,getNumColumns:r})},zb=function(e){return e.state(e)},Ub=Object.freeze({__proto__:null,flatgrid:$b,init:zb}),Vb=function(e){return function(t,n,r,i){var o=e(t.element);return Gb(o,t,n,r,i)}},Hb=function(e,t){var n=Mf(e,t);return Vb(n)},jb=function(e,t){var n=Mf(t,e);return Vb(n)},qb=function(e){return function(t,n,r,i){return Gb(e,t,n,r,i)}},Gb=function(e,t,n,r,i){var o=r.focusManager.get(t).bind((function(n){return e(t.element,n,r,i)}));return o.map((function(e){return r.focusManager.set(t,e),!0}))},Wb=qb,Kb=qb,Yb=qb,Xb=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},Jb=function(e){return!Xb(e.dom)},Qb=function(e,t){return te(e,t).map((function(t){return{index:t,candidates:e}}))},Zb=function(e,t,n){var r=function(e){return un(e,t)},i=Yh(e,n),o=X(i,Jb);return Qb(o,r)},ey=function(e,t){return te(e,(function(e){return un(t,e)}))},ty=function(e,t,n,r){var i=Math.floor(t/n),o=t%n;return r(i,o).bind((function(t){var r=t.row*n+t.column;return r>=0&&r<e.length?N.some(e[r]):N.none()}))},ny=function(e,t,n,r,i){return ty(e,t,r,(function(t,o){var a=t===n-1,s=a?e.length-t*r:r,l=Ec(o,i,0,s-1);return N.some({row:t,column:l})}))},ry=function(e,t,n,r,i){return ty(e,t,r,(function(t,o){var a=Ec(t,i,0,n-1),s=a===n-1,l=s?e.length-a*r:r,u=_c(o,0,l-1);return N.some({row:a,column:u})}))},iy=function(e,t,n,r){return ny(e,t,n,r,1)},oy=function(e,t,n,r){return ny(e,t,n,r,-1)},ay=function(e,t,n,r){return ry(e,t,n,r,-1)},sy=function(e,t,n,r){return ry(e,t,n,r,1)},ly=[Ao("selector"),Ko("execute",Rb),lc("onEscape"),Ko("captureTab",!1),hc()],uy=function(e,t,n){Bu(e.element,t.selector).each((function(n){t.focusManager.set(e,n)}))},cy=function(e,t){return t.focusManager.get(e).bind((function(e){return $u(e,t.selector)}))},dy=function(e,t,n,r){return cy(e,n).bind((function(r){return n.execute(e,t,r)}))},fy=function(e){return function(t,n,r,i){return Zb(t,n,r.selector).bind((function(t){return e(t.candidates,t.index,i.getNumRows().getOr(r.initSize.numRows),i.getNumColumns().getOr(r.initSize.numColumns))}))}},hy=function(e,t,n){return n.captureTab?N.some(!0):N.none()},my=function(e,t,n){return n.onEscape(e,t)},py=fy(oy),gy=fy(iy),vy=fy(ay),by=fy(sy),yy=w([xb(vb(ub),Hb(py,gy)),xb(vb(db),jb(py,gy)),xb(vb(cb),Wb(vy)),xb(vb(fb),Kb(by)),xb(bb([yb,vb(ob)]),hy),xb(bb([Sb,vb(ob)]),hy),xb(vb(sb),my),xb(vb(lb.concat(ab)),dy)]),wy=w([xb(vb(lb),Ib)]),Sy=Eb(ly,$b,yy,wy,(function(){return N.some(uy)})),xy=function(e,t,n,r){var i=function(e){return"button"===st(e)&&"disabled"===Vn(e,"disabled")},o=function(e,t,n){var a=Ec(t,r,0,n.length-1);return a===e?N.none():i(n[a])?o(e,a,n):N.from(n[a])};return Zb(e,n,t).bind((function(e){var t=e.index,n=e.candidates;return o(t,t,n)}))},Cy=[Ao("selector"),Ko("getInitial",N.none),Ko("execute",Rb),lc("onEscape"),Ko("executeOnMove",!1),Ko("allowVertical",!0)],Ty=function(e,t){return t.focusManager.get(e).bind((function(e){return $u(e,t.selector)}))},Dy=function(e,t,n){return Ty(e,n).bind((function(r){return n.execute(e,t,r)}))},ky=function(e,t,n){t.getInitial(e).orThunk((function(){return Bu(e.element,t.selector)})).each((function(n){t.focusManager.set(e,n)}))},Ey=function(e,t,n){return xy(e,n.selector,t,-1)},_y=function(e,t,n){return xy(e,n.selector,t,1)},Ay=function(e){return function(t,n,r,i){return e(t,n,r,i).bind((function(){return r.executeOnMove?Dy(t,n,r):N.some(!0)}))}},Ly=function(e,t,n){return n.onEscape(e,t)},Oy=function(e,t,n,r){var i=ub.concat(n.allowVertical?cb:[]),o=db.concat(n.allowVertical?fb:[]);return[xb(vb(i),Ay(Hb(Ey,_y))),xb(vb(o),Ay(jb(Ey,_y))),xb(vb(ab),Dy),xb(vb(lb),Dy),xb(vb(sb),Ly)]},Ry=w([xb(vb(lb),Ib)]),Iy=Eb(Cy,Tl.init,Oy,Ry,(function(){return N.some(ky)})),Py=function(e,t,n){return N.from(e[t]).bind((function(e){return N.from(e[n]).map((function(e){return{rowIndex:t,columnIndex:n,cell:e}}))}))},My=function(e,t,n,r){var i=e[t],o=i.length,a=Ec(n,r,0,o-1);return Py(e,t,a)},Ny=function(e,t,n,r){var i=Ec(n,r,0,e.length-1),o=e[i].length,a=_c(t,0,o-1);return Py(e,i,a)},Fy=function(e,t,n,r){var i=e[t],o=i.length,a=_c(n+r,0,o-1);return Py(e,t,a)},By=function(e,t,n,r){var i=_c(n+r,0,e.length-1),o=e[i].length,a=_c(t,0,o-1);return Py(e,i,a)},$y=function(e,t,n){return My(e,t,n,1)},zy=function(e,t,n){return My(e,t,n,-1)},Uy=function(e,t,n){return Ny(e,n,t,-1)},Vy=function(e,t,n){return Ny(e,n,t,1)},Hy=function(e,t,n){return Fy(e,t,n,-1)},jy=function(e,t,n){return Fy(e,t,n,1)},qy=function(e,t,n){return By(e,n,t,-1)},Gy=function(e,t,n){return By(e,n,t,1)},Wy=[Fo("selectors",[Ao("row"),Ao("cell")]),Ko("cycles",!0),Ko("previousSelector",N.none),Ko("execute",Rb)],Ky=function(e,t,n){var r=t.previousSelector(e).orThunk((function(){var n=t.selectors;return Bu(e.element,n.cell)}));r.each((function(n){t.focusManager.set(e,n)}))},Yy=function(e,t,n){return kd(e.element).bind((function(r){return n.execute(e,t,r)}))},Xy=function(e,t){return G(e,(function(e){return Yh(e,t.selectors.cell)}))},Jy=function(e,t){return function(n,r,i){var o=i.cycles?e:t;return $u(r,i.selectors.row).bind((function(e){var t=Yh(e,i.selectors.cell);return ey(t,r).bind((function(t){var r=Yh(n,i.selectors.row);return ey(r,e).bind((function(e){var n=Xy(r,i);return o(n,e,t).map((function(e){return e.cell}))}))}))}))}},Qy=Jy(zy,Hy),Zy=Jy($y,jy),ew=Jy(Uy,qy),tw=Jy(Vy,Gy),nw=w([xb(vb(ub),Hb(Qy,Zy)),xb(vb(db),jb(Qy,Zy)),xb(vb(cb),Wb(ew)),xb(vb(fb),Kb(tw)),xb(vb(lb.concat(ab)),Yy)]),rw=w([xb(vb(lb),Ib)]),iw=Eb(Wy,Tl.init,nw,rw,(function(){return N.some(Ky)})),ow=[Ao("selector"),Ko("execute",Rb),Ko("moveOnTab",!1)],aw=function(e,t,n){return n.focusManager.get(e).bind((function(r){return n.execute(e,t,r)}))},sw=function(e,t,n){Bu(e.element,t.selector).each((function(n){t.focusManager.set(e,n)}))},lw=function(e,t,n){return xy(e,n.selector,t,-1)},uw=function(e,t,n){return xy(e,n.selector,t,1)},cw=function(e,t,n,r){return n.moveOnTab?Yb(lw)(e,t,n,r):N.none()},dw=function(e,t,n,r){return n.moveOnTab?Yb(uw)(e,t,n,r):N.none()},fw=w([xb(vb(cb),Yb(lw)),xb(vb(fb),Yb(uw)),xb(bb([yb,vb(ob)]),cw),xb(bb([Sb,vb(ob)]),dw),xb(vb(ab),aw),xb(vb(lb),aw)]),hw=w([xb(vb(lb),Ib)]),mw=Eb(ow,Tl.init,fw,hw,(function(){return N.some(sw)})),pw=[lc("onSpace"),lc("onEnter"),lc("onShiftEnter"),lc("onLeft"),lc("onRight"),lc("onTab"),lc("onShiftTab"),lc("onUp"),lc("onDown"),lc("onEscape"),Ko("stopSpaceKeyup",!1),zo("focusIn")],gw=function(e,t,n){return[xb(vb(lb),n.onSpace),xb(bb([Sb,vb(ab)]),n.onEnter),xb(bb([yb,vb(ab)]),n.onShiftEnter),xb(bb([yb,vb(ob)]),n.onShiftTab),xb(bb([Sb,vb(ob)]),n.onTab),xb(vb(cb),n.onUp),xb(vb(fb),n.onDown),xb(vb(ub),n.onLeft),xb(vb(db),n.onRight),xb(vb(lb),n.onSpace),xb(vb(sb),n.onEscape)]},vw=function(e,t,n){return n.stopSpaceKeyup?[xb(vb(lb),Ib)]:[]},bw=Eb(pw,Tl.init,gw,vw,(function(e){return e.focusIn})),yw=Ab.schema(),ww=Lb.schema(),Sw=Iy.schema(),xw=Sy.schema(),Cw=iw.schema(),Tw=Bb.schema(),Dw=mw.schema(),kw=bw.schema(),Ew=Object.freeze({__proto__:null,acyclic:yw,cyclic:ww,flow:Sw,flatgrid:xw,matrix:Cw,execution:Tw,menu:Dw,special:kw}),_w=function(e){return _e(e,"setGridSize")},Aw=gd({branchKey:"mode",branches:Ew,name:"keying",active:{events:function(e,t){var n=e.handler;return n.toEvents(e,t)}},apis:{focusIn:function(e,t,n){t.sendFocusIn(t).fold((function(){e.getSystem().triggerFocus(e.element,e.element)}),(function(r){r(e,t,n)}))},setGridSize:function(e,t,n,r,i){_w(n)?n.setGridSize(r,i):console.error("Layout does not support setGridSize")}},state:Ub}),Lw=function(e,t,n,r){Ed((function(){var t=G(r,e.getSystem().build);Hm(e,t)}),e.element)},Ow=function(e,t,n,r){var i=e.getSystem().build(r);qm(e,i,n)},Rw=function(e,t,n,r){Ow(e,t,Lr,r)},Iw=function(e,t,n,r){Ow(e,t,Ar,r)},Pw=function(e,t,n,r){var i=Mw(e),o=ee(i,(function(e){return un(r.element,e.element)}));o.each(Wm)},Mw=function(e,t){return e.components()},Nw=function(e,t,n,r,i){var o=Mw(e);return N.from(o[r]).map((function(o){return Pw(e,t,n,o),i.each((function(n){Ow(e,t,(function(e,t){Or(e,t,r)}),n)})),o}))},Fw=function(e,t,n,r,i){var o=Mw(e);return te(o,r).bind((function(r){return Nw(e,t,n,r,i)}))},Bw=Object.freeze({__proto__:null,append:Rw,prepend:Iw,remove:Pw,replaceAt:Nw,replaceBy:Fw,set:Lw,contents:Mw}),$w=md({fields:[],name:"replacing",apis:Bw}),zw=function(e,t){var n=_s(t);return md({fields:[Ao("enabled")],name:e,active:{events:w(n)}})},Uw=function(e,t){var n=zw(e,t);return{key:e,value:{config:{},me:n,configAsRaw:w({}),initialConfig:{},state:Tl}}},Vw=function(e,t){t.ignore||(xd(e.element),t.onFocus(e))},Hw=function(e,t){t.ignore||Cd(e.element)},jw=function(e){return Td(e.element)},qw=Object.freeze({__proto__:null,focus:Vw,blur:Hw,isFocused:jw}),Gw=function(e,t){var n=t.ignore?{}:{attributes:{tabindex:"-1"}};return Ll(n)},Ww=function(e){return _s([Rs(Ja(),(function(t,n){Vw(t,e),n.stop()}))].concat(e.stopMousedown?[Rs(Ia(),(function(e,t){t.event.prevent()}))]:[]))},Kw=Object.freeze({__proto__:null,exhibit:Gw,events:Ww}),Yw=[sc("onFocus"),Ko("stopMousedown",!1),Ko("ignore",!1)],Xw=md({fields:Yw,name:"focusing",active:Kw,apis:qw}),Jw=function(e){var t=function(){var t=ia(e),n=function(){return t.get()},r=function(e){return t.set(e)},i=function(){return t.set(e)},o=function(){return t.get()};return{get:n,set:r,clear:i,readState:o}};return{init:t}},Qw=function(e,t,n){var r=t.aria;r.update(e,r,n.get())},Zw=function(e,t,n){t.toggleClass.each((function(t){n.get()?ou(e.element,t):su(e.element,t)}))},eS=function(e,t,n){rS(e,t,n,!n.get())},tS=function(e,t,n){n.set(!0),Zw(e,t,n),Qw(e,t,n)},nS=function(e,t,n){n.set(!1),Zw(e,t,n),Qw(e,t,n)},rS=function(e,t,n,r){var i=r?tS:nS;i(e,t,n)},iS=function(e,t,n){return n.get()},oS=function(e,t,n){rS(e,t,n,t.selected)},aS=Object.freeze({__proto__:null,onLoad:oS,toggle:eS,isOn:iS,on:tS,off:nS,set:rS}),sS=function(){return Ll({})},lS=function(e,t){var n=od(e,t,eS),r=ad(e,t,oS);return _s(ne([e.toggleOnExecute?[n]:[],[r]]))},uS=Object.freeze({__proto__:null,exhibit:sS,events:lS}),cS=function(e,t,n){zn(e.element,"aria-pressed",n),t.syncWithExpanded&&hS(e,t,n)},dS=function(e,t,n){zn(e.element,"aria-selected",n)},fS=function(e,t,n){zn(e.element,"aria-checked",n)},hS=function(e,t,n){zn(e.element,"aria-expanded",n)},mS=[Ko("selected",!1),zo("toggleClass"),Ko("toggleOnExecute",!0),Yo("aria",{mode:"none"},To("mode",{pressed:[Ko("syncWithExpanded",!1),dc("update",cS)],checked:[dc("update",fS)],expanded:[dc("update",hS)],selected:[dc("update",dS)],none:[dc("update",g)]}))],pS=md({fields:mS,name:"toggling",active:uS,apis:aS,state:Jw(!1)}),gS=function(){var e=function(e,t){t.stop(),Ts(e)};return[Rs(ja(),e),Rs(rs(),e),$s(Aa()),$s(Ia())]},vS=function(e){var t=function(e){return qs((function(t,n){e(t),n.stop()}))};return _s(ne([e.map(t).toArray(),gS()]))},bS="alloy.item-hover",yS="alloy.item-focus",wS=function(e){(kd(e.element).isNone()||Xw.isFocused(e))&&(Xw.isFocused(e)||Xw.focus(e),Cs(e,bS,{item:e}))},SS=function(e){Cs(e,yS,{item:e})},xS=w(bS),CS=w(yS),TS=function(e){return{dom:e.dom,domModification:A(A({},e.domModification),{attributes:A(A(A({role:e.toggling.isSome()?"menuitemcheckbox":"menuitem"},e.domModification.attributes),{"aria-haspopup":e.hasSubmenu}),e.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:ig.augment(e.itemBehaviours,[e.toggling.fold(pS.revoke,(function(e){return pS.config(A({aria:{mode:"checked"}},e))})),Xw.config({ignore:e.ignoreFocus,stopMousedown:e.ignoreFocus,onFocus:function(e){SS(e)}}),Aw.config({mode:"execution"}),eg.config({store:{mode:"memory",initialValue:e.data}}),Uw("item-type-events",O(O([],gS(),!0),[Rs(Fa(),wS),Rs(ns(),Xw.focus)],!1))]),components:e.components,eventOrder:e.eventOrder}},DS=[Ao("data"),Ao("components"),Ao("dom"),Ko("hasSubmenu",!1),zo("toggling"),ig.field("itemBehaviours",[pS,Xw,Aw,eg]),Ko("ignoreFocus",!1),Ko("domModification",{}),dc("builder",TS),Ko("eventOrder",{})],kS=function(e){return{dom:e.dom,components:e.components,events:_s([zs(ns())])}},ES=[Ao("dom"),Ao("components"),dc("builder",kS)],_S=w("item-widget"),AS=w([Ig({name:"widget",overrides:function(e){return{behaviours:fd([eg.config({store:{mode:"manual",getValue:function(t){return e.data},setValue:g}})])}}})]),LS=function(e){var t=Gg(_S(),e,AS()),n=Wg(_S(),e,t.internals()),r=function(t){return Kg(t,e,"widget").map((function(e){return Aw.focusIn(e),e}))},i=function(t,n){return mv(n.event.target)?N.none():function(){return e.autofocus?(n.setSource(t.element),N.none()):N.none()}()};return{dom:e.dom,components:n,domModification:e.domModification,events:_s([qs((function(e,t){r(e).each((function(e){t.stop()}))})),Rs(Fa(),wS),Rs(ns(),(function(t,n){e.autofocus?r(t):Xw.focus(t)}))]),behaviours:ig.augment(e.widgetBehaviours,[eg.config({store:{mode:"memory",initialValue:e.data}}),Xw.config({ignore:e.ignoreFocus,onFocus:function(e){SS(e)}}),Aw.config({mode:"special",focusIn:e.autofocus?function(e){r(e)}:vd(),onLeft:i,onRight:i,onEscape:function(t,n){return Xw.isFocused(t)||e.autofocus?e.autofocus?(n.setSource(t.element),N.none()):N.none():(Xw.focus(t),N.some(!0))}})])}},OS=[Ao("uid"),Ao("data"),Ao("components"),Ao("dom"),Ko("autofocus",!1),Ko("ignoreFocus",!1),ig.field("widgetBehaviours",[eg,Xw,Aw]),Ko("domModification",{}),tv(AS()),dc("builder",LS)],RS=To("type",{widget:OS,item:DS,separator:ES}),IS=function(e,t){return{mode:"flatgrid",selector:"."+e.markers.item,initSize:{numColumns:t.initSize.numColumns,numRows:t.initSize.numRows},focusManager:e.focusManager}},PS=function(e,t){return{mode:"matrix",selectors:{row:t.rowSelector,cell:"."+e.markers.item},focusManager:e.focusManager}},MS=function(e,t){return{mode:"menu",selector:"."+e.markers.item,moveOnTab:t.moveOnTab,focusManager:e.focusManager}},NS=w([Ng({factory:{sketch:function(e){var t=xo("menu.spec item",RS,e);return t.builder(t)}},name:"items",unit:"item",defaults:function(e,t){return Ee(t,"uid")?t:A(A({},t),{uid:fl("item")})},overrides:function(e,t){return{type:t.type,ignoreFocus:e.fakeFocus,domModification:{classes:[e.markers.item]}}}})]),FS=w([Ao("value"),Ao("items"),Ao("dom"),Ao("components"),Ko("eventOrder",{}),tg("menuBehaviours",[rb,eg,bv,Aw]),Yo("movement",{mode:"menu",moveOnTab:!0},To("mode",{grid:[hc(),dc("config",IS)],matrix:[dc("config",PS),Ao("rowSelector")],menu:[Ko("moveOnTab",!0),dc("config",MS)]})),rc(),Ko("fakeFocus",!1),Ko("focusManager",Db()),sc("onHighlight")]),BS=w("alloy.menu-focus"),$S=function(e,t,n,r){return{uid:e.uid,dom:e.dom,markers:e.markers,behaviours:rg(e.menuBehaviours,[rb.config({highlightClass:e.markers.selectedItem,itemClass:e.markers.item,onHighlight:e.onHighlight}),eg.config({store:{mode:"memory",initialValue:e.value}}),bv.config({find:N.some}),Aw.config(e.movement.config(e,e.movement))]),events:_s([Rs(CS(),(function(e,t){var n=t.event;e.getSystem().getByDom(n.target).each((function(n){rb.highlight(e,n),t.stop(),Cs(e,BS(),{menu:e,item:n})}))})),Rs(xS(),(function(e,t){var n=t.event.item;rb.highlight(e,n)}))]),components:t,eventOrder:e.eventOrder,domModification:{attributes:{role:"menu"}}}},zS=hv({name:"Menu",configFields:FS(),partFields:NS(),factory:$S}),US=function(e){return ye(e,(function(e,t){return{k:e,v:t}}))},VS=function(e,t,n,r){return ke(n,r).bind((function(r){return ke(e,r).bind((function(r){var i=VS(e,t,n,r);return N.some([r].concat(i))}))})).getOr([])},HS=function(e,t){var n={};ve(e,(function(e,t){W(e,(function(e){n[e]=t}))}));var r=t,i=US(t),o=be(i,(function(e,t){return[t].concat(VS(n,r,i,t))}));return be(n,(function(e){return ke(o,e).getOr([e])}))},jS=function(){var e=ia({}),t=ia({}),n=ia({}),r=rf(),i=ia({}),o=function(){e.set({}),t.set({}),n.set({}),r.clear()},a=function(){return r.get().isNone()},s=function(e,n){var r;t.set(A(A({},t.get()),(r={},r[e]={type:"prepared",menu:n},r)))},l=function(o,a,s,l){r.set(o),e.set(s),t.set(a),i.set(l);var u=HS(l,s);n.set(u)},u=function(t){return Te(e.get(),(function(e,n){return e===t}))},c=function(e,t,n){return p(e).bind((function(r){return u(e).bind((function(e){return t(e).map((function(e){return{triggeredMenu:r,triggeringItem:e,triggeringPath:n}}))}))}))},d=function(e,t){var i=X(v(e).toArray(),(function(e){return p(e).isSome()}));return ke(n.get(),e).bind((function(e){var n=oe(i.concat(e)),o=re(n,(function(e,i){return c(e,t,n.slice(0,i+1)).fold((function(){return Ae(r.get(),e)?[]:[N.none()]}),(function(e){return[N.some(e)]}))}));return Re(o)}))},f=function(t){return ke(e.get(),t).map((function(e){var r=ke(n.get(),t).getOr([]);return[e].concat(r)}))},h=function(e){return ke(n.get(),e).bind((function(e){return e.length>1?N.some(e.slice(1)):N.none()}))},m=function(e){return ke(n.get(),e)},p=function(e){return g(e).bind(qS)},g=function(e){return ke(t.get(),e)},v=function(t){return ke(e.get(),t)},b=function(e){var t=i.get();return ae(pe(t),e)},y=function(){return r.get().bind(p)},w=function(){return t.get()};return{setMenuBuilt:s,setContents:l,expand:f,refresh:m,collapse:h,lookupMenu:g,lookupItem:v,otherMenus:b,getPrimary:y,getMenus:w,clear:o,isClear:a,getTriggeringPath:d}},qS=function(e){return"prepared"===e.type?N.some(e.menu):N.none()},GS={init:jS,extractPreparedMenu:qS},WS=function(e,t){var n,r=rf(),i=function(t,n,r){return be(r,(function(r,i){var o=function(){return zS.sketch(A(A({},r),{value:i,markers:e.markers,fakeFocus:e.fakeFocus,onHighlight:e.onHighlight,focusManager:e.fakeFocus?kb():Db()}))};return i===n?{type:"prepared",menu:t.getSystem().build(o())}:{type:"notbuilt",nbMenu:o}}))},o=GS.init(),a=function(t){var n=i(t,e.data.primary,e.data.menus),r=u();return o.setContents(e.data.primary,n,e.data.expansions,r),o.getPrimary()},s=function(e){return eg.getValue(e).value},l=function(e,t,n){return me(t,(function(e){if(!e.getSystem().isConnected())return N.none();var t=rb.getCandidates(e);return ee(t,(function(e){return s(e)===n}))}))},u=function(t){return be(e.data.menus,(function(e,t){return re(e.items,(function(e){return"separator"===e.type?[]:[e.data.value]}))}))},c=function(e,t){rb.highlight(e,t),rb.getHighlighted(t).orThunk((function(){return rb.getFirst(t)})).each((function(t){Ds(e,t.element,ns())}))},d=function(e,t){return Oe(G(t,(function(t){return e.lookupMenu(t).bind((function(e){return"prepared"===e.type?N.some(e.menu):N.none()}))})))},f=function(t,n,r){var i=d(n,n.otherMenus(r));W(i,(function(n){cu(n.element,[e.markers.backgroundMenu]),e.stayInDom||$w.remove(t,n)}))},h=function(t){return r.get().getOrThunk((function(){var n={},i=Yh(t.element,"."+e.markers.item),o=X(i,(function(e){return"true"===Vn(e,"aria-haspopup")}));return W(o,(function(e){t.getSystem().getByDom(e).each((function(e){var t=s(e);n[t]=e}))})),r.set(n),n}))},m=function(e,t){var n=h(e);ve(n,(function(e,n){var r=V(t,n);zn(e.element,"aria-expanded",r)}))},p=function(t,n,r){return N.from(r[0]).bind((function(i){return n.lookupMenu(i).bind((function(i){if("notbuilt"===i.type)return N.none();var o=i.menu,a=d(n,r.slice(1));return W(a,(function(t){ou(t.element,e.markers.backgroundMenu)})),Nn(o.element)||$w.append(t,_u(o)),cu(o.element,[e.markers.backgroundMenu]),c(t,o),f(t,n,r),N.some(o)}))}))};(function(e){e[e["HighlightSubmenu"]=0]="HighlightSubmenu",e[e["HighlightParent"]=1]="HighlightParent"})(n||(n={}));var v=function(e,t,n){if("notbuilt"===n.type){var r=e.getSystem().build(n.nbMenu());return o.setMenuBuilt(t,r),r}return n.menu},b=function(t,r,i){if(void 0===i&&(i=n.HighlightSubmenu),r.hasConfigured(Fv)&&Fv.isDisabled(r))return N.some(r);var a=s(r);return o.expand(a).bind((function(a){return m(t,a),N.from(a[0]).bind((function(s){return o.lookupMenu(s).bind((function(l){var u=v(t,s,l);return Nn(u.element)||$w.append(t,_u(u)),e.onOpenSubmenu(t,r,u,oe(a)),i===n.HighlightSubmenu?(rb.highlightFirst(u),p(t,o,a)):(rb.dehighlightAll(u),N.some(r))}))}))}))},y=function(t,n){var r=s(n);return o.collapse(r).bind((function(r){return m(t,r),p(t,o,r).map((function(r){return e.onCollapseMenu(t,n,r),r}))}))},w=function(e,t){var n=s(t);return o.refresh(n).bind((function(t){return m(e,t),p(e,o,t)}))},S=function(e,t){return mv(t.element)?N.none():b(e,t,n.HighlightSubmenu)},x=function(e,t){return mv(t.element)?N.none():y(e,t)},C=function(t,n){return y(t,n).orThunk((function(){return e.onEscape(t,n).map((function(){return t}))}))},T=function(t){return function(n,r){return $u(r.getSource(),"."+e.markers.item).bind((function(e){return n.getSystem().getByDom(e).toOptional().bind((function(e){return t(n,e).map(E)}))}))}},D=_s([Rs(BS(),(function(e,t){var n=t.event.item;o.lookupItem(s(n)).each((function(){var n=t.event.menu;rb.highlight(e,n);var r=s(t.event.item);o.refresh(r).each((function(t){return f(e,o,t)}))}))})),qs((function(t,r){var i=r.event.target;t.getSystem().getByDom(i).each((function(r){var i=s(r);0===i.indexOf("collapse-item")&&y(t,r),b(t,r,n.HighlightSubmenu).fold((function(){e.onExecute(t,r)}),g)}))})),Vs((function(t,n){a(t).each((function(n){$w.append(t,_u(n)),e.onOpenMenu(t,n),e.highlightImmediately&&c(t,n)}))}))].concat(e.navigateOnHover?[Rs(xS(),(function(t,r){var i=r.event.item;w(t,i),b(t,i,n.HighlightParent),e.onHover(t,i)}))]:[])),k=function(e){return rb.getHighlighted(e).bind(rb.getHighlighted)},_=function(e){k(e).each((function(t){y(e,t)}))},L=function(e){o.getPrimary().each((function(t){c(e,t)}))},O=function(e){return N.from(e.components()[0]).filter((function(e){return"menu"===Vn(e.element,"role")}))},R=function(t){var n=o.getPrimary().bind((function(e){return k(t).bind((function(e){var n=s(e),r=De(o.getMenus()),i=Oe(G(r,GS.extractPreparedMenu));return o.getTriggeringPath(n,(function(e){return l(t,i,e)}))})).map((function(t){return{primary:e,triggeringPath:t}}))}));n.fold((function(){O(t).each((function(n){e.onRepositionMenu(t,n,[])}))}),(function(n){var r=n.primary,i=n.triggeringPath;e.onRepositionMenu(t,r,i)}))},I={collapseMenu:_,highlightPrimary:L,repositionMenus:R};return{uid:e.uid,dom:e.dom,markers:e.markers,behaviours:rg(e.tmenuBehaviours,[Aw.config({mode:"special",onRight:T(S),onLeft:T(x),onEscape:T(C),focusIn:function(e,t){o.getPrimary().each((function(t){Ds(e,t.element,ns())}))}}),rb.config({highlightClass:e.markers.selectedMenu,itemClass:e.markers.menu}),bv.config({find:function(e){return rb.getHighlighted(e)}}),$w.config({})]),eventOrder:e.eventOrder,apis:I,events:D}},KS=w("collapse-item"),YS=function(e,t,n){return{primary:e,menus:t,expansions:n}},XS=function(e,t){return{primary:e,menus:ha(e,t),expansions:{}}},JS=function(e){return{value:il(KS()),meta:{text:e}}},QS=fv({name:"TieredMenu",configFields:[cc("onExecute"),cc("onEscape"),uc("onOpenMenu"),uc("onOpenSubmenu"),sc("onRepositionMenu"),sc("onCollapseMenu"),Ko("highlightImmediately",!0),Fo("data",[Ao("primary"),Ao("menus"),Ao("expansions")]),Ko("fakeFocus",!1),sc("onHighlight"),sc("onHover"),ic(),Ao("dom"),Ko("navigateOnHover",!0),Ko("stayInDom",!1),tg("tmenuBehaviours",[Aw,rb,bv,$w]),Ko("eventOrder",{})],apis:{collapseMenu:function(e,t){e.collapseMenu(t)},highlightPrimary:function(e,t){e.highlightPrimary(t)},repositionMenus:function(e,t){e.repositionMenus(t)}},factory:WS,extraApis:{tieredData:YS,singleData:XS,collapseItem:JS}}),ZS=function(e,t,n,r,i){var o=function(){return e.lazySink(t)},a="horizontal"===r.type?{layouts:{onLtr:function(){return Zc()},onRtl:function(){return ed()}}}:{},s=function(e){return 2===e.length},l=function(e){return s(e)?a:{}};return QS.sketch({dom:{tag:"div"},data:r.data,markers:r.menu.markers,highlightImmediately:r.menu.highlightImmediately,onEscape:function(){return bp.close(t),e.onEscape.map((function(e){return e(t)})),N.some(!0)},onExecute:function(){return N.some(!0)},onOpenMenu:function(e,t){Bm.positionWithinBounds(o().getOrDie(),t,n,i())},onOpenSubmenu:function(e,t,n,r){var i=o().getOrDie();Bm.position(i,n,{anchor:A({type:"submenu",item:t},l(r))})},onRepositionMenu:function(e,t,r){var a=o().getOrDie();Bm.positionWithinBounds(a,t,n,i()),W(r,(function(e){var t=l(e.triggeringPath);Bm.position(a,e.triggeredMenu,{anchor:A({type:"submenu",item:e.triggeringItem},t)})}))}})},ex=function(e,t){var n=function(t,n){var r=e.getRelated(t);return r.exists((function(e){return Hu(e,n)}))},r=function(e,t){bp.setContent(e,t)},i=function(e,t,n){o(e,t,n,N.none())},o=function(e,t,n,r){a(e,t,n,(function(){return r.map((function(e){return Jr(e)}))}))},a=function(t,n,r,i){var o=e.lazySink(t).getOrDie();bp.openWhileCloaked(t,n,(function(){return Bm.positionWithinBounds(o,t,r,i())})),eg.setValue(t,N.some({mode:"position",config:r,getBounds:i}))},s=function(e,t,n){l(e,t,n,N.none)},l=function(t,n,r,i){var o=ZS(e,t,n,r,i);bp.open(t,o),eg.setValue(t,N.some({mode:"menu",menu:o}))},u=function(e){bp.isOpen(e)&&(eg.setValue(e,N.none()),bp.close(e))},c=function(e){return bp.getState(e)},d=function(t){bp.isOpen(t)&&eg.getValue(t).each((function(n){switch(n.mode){case"menu":bp.getState(t).each(QS.repositionMenus);break;case"position":var r=e.lazySink(t).getOrDie();Bm.positionWithinBounds(r,t,n.config,n.getBounds());break}}))},f={setContent:r,showAt:i,showWithin:o,showWithinBounds:a,showMenuAt:s,showMenuWithinBounds:l,hide:u,getContent:c,reposition:d,isOpen:bp.isOpen};return{uid:e.uid,dom:e.dom,behaviours:rg(e.inlineBehaviours,[bp.config({isPartOf:function(e,t,r){return Hu(t,r)||n(e,r)},getAttachPoint:function(t){return e.lazySink(t).getOrDie()},onOpen:function(t){e.onShow(t)},onClose:function(t){e.onHide(t)}}),eg.config({store:{mode:"memory",initialValue:N.none()}}),bd.config({channels:A(A({},Cp(A({isExtraPart:t.isExtraPart},e.fireDismissalEventInstead.map((function(e){return{fireEventInstead:{event:e.event}}})).getOr({})))),Dp(A(A({},e.fireRepositionEventInstead.map((function(e){return{fireEventInstead:{event:e.event}}})).getOr({})),{doReposition:d})))})]),eventOrder:e.eventOrder,apis:f}},tx=fv({name:"InlineView",configFields:[Ao("lazySink"),sc("onShow"),sc("onHide"),jo("onEscape"),tg("inlineBehaviours",[bp,eg,bd]),Go("fireDismissalEventInstead",[Ko("event",ms())]),Go("fireRepositionEventInstead",[Ko("event",ps())]),Ko("getRelated",N.none),Ko("isExtraPart",k),Ko("eventOrder",N.none)],factory:ex,apis:{showAt:function(e,t,n,r){e.showAt(t,n,r)},showWithin:function(e,t,n,r,i){e.showWithin(t,n,r,i)},showWithinBounds:function(e,t,n,r,i){e.showWithinBounds(t,n,r,i)},showMenuAt:function(e,t,n,r){e.showMenuAt(t,n,r)},showMenuWithinBounds:function(e,t,n,r,i){e.showMenuWithinBounds(t,n,r,i)},hide:function(e,t){e.hide(t)},isOpen:function(e,t){return e.isOpen(t)},getContent:function(e,t){return e.getContent(t)},setContent:function(e,t,n){e.setContent(t,n)},reposition:function(e,t){e.reposition(t)}}}),nx="layout-inset",rx=function(e){return e.x},ix=function(e,t){return e.x+e.width/2-t.width/2},ox=function(e,t){return e.x+e.width-t.width},ax=function(e){return e.y},sx=function(e,t){return e.y+e.height-t.height},lx=function(e,t){return e.y+e.height/2-t.height/2},ux=function(e,t,n){return mc(ox(e,t),sx(e,t),n.insetSouthwest(),xc(),"southwest",Lc(e,{right:0,bottom:3}),nx)},cx=function(e,t,n){return mc(rx(e),sx(e,t),n.insetSoutheast(),Sc(),"southeast",Lc(e,{left:1,bottom:3}),nx)},dx=function(e,t,n){return mc(ox(e,t),ax(e),n.insetNorthwest(),wc(),"northwest",Lc(e,{right:0,top:2}),nx)},fx=function(e,t,n){return mc(rx(e),ax(e),n.insetNortheast(),yc(),"northeast",Lc(e,{left:1,top:2}),nx)},hx=function(e,t,n){return mc(ix(e,t),ax(e),n.insetNorth(),Cc(),"north",Lc(e,{top:2}),nx)},mx=function(e,t,n){return mc(ix(e,t),sx(e,t),n.insetSouth(),Tc(),"south",Lc(e,{bottom:3}),nx)},px=function(e,t,n){return mc(ox(e,t),lx(e,t),n.insetEast(),kc(),"east",Lc(e,{right:0}),nx)},gx=function(e,t,n){return mc(rx(e),lx(e,t),n.insetWest(),Dc(),"west",Lc(e,{left:1}),nx)},vx=function(e){switch(e){case"north":return hx;case"northeast":return fx;case"northwest":return dx;case"south":return mx;case"southeast":return cx;case"southwest":return ux;case"east":return px;case"west":return gx}},bx=function(e,t,n,r,i){var o=qd(r).map(vx).getOr(hx);return o(e,t,n,r,i)},yx=function(e){switch(e){case"north":return mx;case"northeast":return cx;case"northwest":return ux;case"south":return hx;case"southeast":return fx;case"southwest":return dx;case"east":return gx;case"west":return px}},wx=function(e,t,n,r,i){var o=qd(r).map(yx).getOr(hx);return o(e,t,n,r,i)},Sx=tinymce.util.Tools.resolve("tinymce.util.Delay"),xx=function(e){var t=vS(e.action),n=e.dom.tag,r=function(t){return ke(e.dom,"attributes").bind((function(e){return ke(e,t)}))},i=function(){if("button"===n){var e=r("type").getOr("button"),t=r("role").map((function(e){return{role:e}})).getOr({});return A({type:e},t)}var i=r("role").getOr("button");return{role:i}};return{uid:e.uid,dom:e.dom,components:e.components,events:t,behaviours:ig.augment(e.buttonBehaviours,[Xw.config({}),Aw.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:i()},eventOrder:e.eventOrder}},Cx=fv({name:"Button",factory:xx,configFields:[Ko("uid",void 0),Ao("dom"),Ko("components",[]),ig.field("buttonBehaviours",[Xw,Aw]),zo("action"),zo("role"),Ko("eventOrder",{})]}),Tx=function(e){var t=void 0!==e.dom.attributes?e.dom.attributes:[];return Q(t,(function(e,t){var n;return"class"===t.name?e:A(A({},e),(n={},n[t.name]=t.value,n))}),{})},Dx=function(e){return Array.prototype.slice.call(e.dom.classList,0)},kx=function(e){var t=tt.fromHtml(e),n=Sn(t),r=Tx(t),i=Dx(t),o=0===n.length?{}:{innerHtml:Ws(t)};return A({tag:st(t),classes:i,attributes:r},o)},Ex=function(e){var t=uv(e)&&_e(e,"uid")?e.uid:fl("memento"),n=function(e){return e.getSystem().getByUid(t).getOrDie()},r=function(e){return e.getSystem().getByUid(t).toOptional()},i=function(){return A(A({},e),{uid:t})};return{get:n,getOpt:r,asSpec:i}};function _x(e){return _x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_x(e)}function Ax(e,t){return Ax=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ax(e,t)}function Lx(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Ox(e,t,n){return Ox=Lx()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=Function.bind.apply(e,r),o=new i;return n&&Ax(o,n.prototype),o},Ox.apply(null,arguments)}function Rx(e){return Ix(e)||Px(e)||Mx(e)||Fx()}function Ix(e){if(Array.isArray(e))return Nx(e)}function Px(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Mx(e,t){if(e){if("string"===typeof e)return Nx(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Nx(e,t):void 0}}function Nx(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Fx(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var Bx=Object.hasOwnProperty,$x=Object.setPrototypeOf,zx=Object.isFrozen,Ux=Object.getPrototypeOf,Vx=Object.getOwnPropertyDescriptor,Hx=Object.freeze,jx=Object.seal,qx=Object.create,Gx="undefined"!==typeof Reflect&&Reflect,Wx=Gx.apply,Kx=Gx.construct;Wx||(Wx=function(e,t,n){return e.apply(t,n)}),Hx||(Hx=function(e){return e}),jx||(jx=function(e){return e}),Kx||(Kx=function(e,t){return Ox(e,Rx(t))});var Yx=oC(Array.prototype.forEach),Xx=oC(Array.prototype.pop),Jx=oC(Array.prototype.push),Qx=oC(String.prototype.toLowerCase),Zx=oC(String.prototype.match),eC=oC(String.prototype.replace),tC=oC(String.prototype.indexOf),nC=oC(String.prototype.trim),rC=oC(RegExp.prototype.test),iC=aC(TypeError);function oC(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return Wx(e,t,r)}}function aC(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Kx(e,n)}}function sC(e,t){$x&&$x(e,null);var n=t.length;while(n--){var r=t[n];if("string"===typeof r){var i=Qx(r);i!==r&&(zx(t)||(t[n]=i),r=i)}e[r]=!0}return e}function lC(e){var t,n=qx(null);for(t in e)Wx(Bx,e,[t])&&(n[t]=e[t]);return n}function uC(e,t){while(null!==e){var n=Vx(e,t);if(n){if(n.get)return oC(n.get);if("function"===typeof n.value)return oC(n.value)}e=Ux(e)}function r(e){return console.warn("fallback value for",e),null}return r}var cC=Hx(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),dC=Hx(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),fC=Hx(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),hC=Hx(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),mC=Hx(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),pC=Hx(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),gC=Hx(["#text"]),vC=Hx(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),bC=Hx(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),yC=Hx(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),wC=Hx(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),SC=jx(/\{\{[\w\W]*|[\w\W]*\}\}/gm),xC=jx(/<%[\w\W]*|[\w\W]*%>/gm),CC=jx(/^data-[\-\w.\u00B7-\uFFFF]/),TC=jx(/^aria-[\-\w]+$/),DC=jx(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),kC=jx(/^(?:\w+script|data):/i),EC=jx(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),_C=jx(/^html$/i),AC=function(){return"undefined"===typeof window?null:window},LC=function(e,t){if("object"!==_x(e)||"function"!==typeof e.createPolicy)return null;var n=null,r="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(r)&&(n=t.currentScript.getAttribute(r));var i="dompurify"+(n?"#"+n:"");try{return e.createPolicy(i,{createHTML:function(e){return e}})}catch(o){return console.warn("TrustedTypes policy "+i+" could not be created."),null}};function OC(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:AC(),t=function(e){return OC(e)};if(t.version="2.3.8",t.removed=[],!e||!e.document||9!==e.document.nodeType)return t.isSupported=!1,t;var n=e.document,r=e.document,i=e.DocumentFragment,o=e.HTMLTemplateElement,a=e.Node,s=e.Element,l=e.NodeFilter,u=e.NamedNodeMap,c=void 0===u?e.NamedNodeMap||e.MozNamedAttrMap:u,d=e.HTMLFormElement,f=e.DOMParser,h=e.trustedTypes,m=s.prototype,p=uC(m,"cloneNode"),g=uC(m,"nextSibling"),v=uC(m,"childNodes"),b=uC(m,"parentNode");if("function"===typeof o){var y=r.createElement("template");y.content&&y.content.ownerDocument&&(r=y.content.ownerDocument)}var w=LC(h,n),S=w?w.createHTML(""):"",x=r,C=x.implementation,T=x.createNodeIterator,D=x.createDocumentFragment,k=x.getElementsByTagName,E=n.importNode,_={};try{_=lC(r).documentMode?r.documentMode:{}}catch(Ue){}var A={};t.isSupported="function"===typeof b&&C&&"undefined"!==typeof C.createHTMLDocument&&9!==_;var L,O,R=SC,I=xC,P=CC,M=TC,N=kC,F=EC,B=DC,$=null,z=sC({},[].concat(Rx(cC),Rx(dC),Rx(fC),Rx(mC),Rx(gC))),U=null,V=sC({},[].concat(Rx(vC),Rx(bC),Rx(yC),Rx(wC))),H=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),j=null,q=null,G=!0,W=!0,K=!1,Y=!1,X=!1,J=!1,Q=!1,Z=!1,ee=!1,te=!1,ne=!0,re=!0,ie=!1,oe={},ae=null,se=sC({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),le=null,ue=sC({},["audio","video","img","source","image","track"]),ce=null,de=sC({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),fe="http://www.w3.org/1998/Math/MathML",he="http://www.w3.org/2000/svg",me="http://www.w3.org/1999/xhtml",pe=me,ge=!1,ve=["application/xhtml+xml","text/html"],be="text/html",ye=null,we=r.createElement("form"),Se=function(e){return e instanceof RegExp||e instanceof Function},xe=function(e){ye&&ye===e||(e&&"object"===_x(e)||(e={}),e=lC(e),$="ALLOWED_TAGS"in e?sC({},e.ALLOWED_TAGS):z,U="ALLOWED_ATTR"in e?sC({},e.ALLOWED_ATTR):V,ce="ADD_URI_SAFE_ATTR"in e?sC(lC(de),e.ADD_URI_SAFE_ATTR):de,le="ADD_DATA_URI_TAGS"in e?sC(lC(ue),e.ADD_DATA_URI_TAGS):ue,ae="FORBID_CONTENTS"in e?sC({},e.FORBID_CONTENTS):se,j="FORBID_TAGS"in e?sC({},e.FORBID_TAGS):{},q="FORBID_ATTR"in e?sC({},e.FORBID_ATTR):{},oe="USE_PROFILES"in e&&e.USE_PROFILES,G=!1!==e.ALLOW_ARIA_ATTR,W=!1!==e.ALLOW_DATA_ATTR,K=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Y=e.SAFE_FOR_TEMPLATES||!1,X=e.WHOLE_DOCUMENT||!1,Z=e.RETURN_DOM||!1,ee=e.RETURN_DOM_FRAGMENT||!1,te=e.RETURN_TRUSTED_TYPE||!1,Q=e.FORCE_BODY||!1,ne=!1!==e.SANITIZE_DOM,re=!1!==e.KEEP_CONTENT,ie=e.IN_PLACE||!1,B=e.ALLOWED_URI_REGEXP||B,pe=e.NAMESPACE||me,e.CUSTOM_ELEMENT_HANDLING&&Se(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(H.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&Se(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(H.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"===typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(H.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),L=L=-1===ve.indexOf(e.PARSER_MEDIA_TYPE)?be:e.PARSER_MEDIA_TYPE,O="application/xhtml+xml"===L?function(e){return e}:Qx,Y&&(W=!1),ee&&(Z=!0),oe&&($=sC({},Rx(gC)),U=[],!0===oe.html&&(sC($,cC),sC(U,vC)),!0===oe.svg&&(sC($,dC),sC(U,bC),sC(U,wC)),!0===oe.svgFilters&&(sC($,fC),sC(U,bC),sC(U,wC)),!0===oe.mathMl&&(sC($,mC),sC(U,yC),sC(U,wC))),e.ADD_TAGS&&($===z&&($=lC($)),sC($,e.ADD_TAGS)),e.ADD_ATTR&&(U===V&&(U=lC(U)),sC(U,e.ADD_ATTR)),e.ADD_URI_SAFE_ATTR&&sC(ce,e.ADD_URI_SAFE_ATTR),e.FORBID_CONTENTS&&(ae===se&&(ae=lC(ae)),sC(ae,e.FORBID_CONTENTS)),re&&($["#text"]=!0),X&&sC($,["html","head","body"]),$.table&&(sC($,["tbody"]),delete j.tbody),Hx&&Hx(e),ye=e)},Ce=sC({},["mi","mo","mn","ms","mtext"]),Te=sC({},["foreignobject","desc","title","annotation-xml"]),De=sC({},["title","style","font","a","script"]),ke=sC({},dC);sC(ke,fC),sC(ke,hC);var Ee=sC({},mC);sC(Ee,pC);var _e=function(e){var t=b(e);t&&t.tagName||(t={namespaceURI:me,tagName:"template"});var n=Qx(e.tagName),r=Qx(t.tagName);return e.namespaceURI===he?t.namespaceURI===me?"svg"===n:t.namespaceURI===fe?"svg"===n&&("annotation-xml"===r||Ce[r]):Boolean(ke[n]):e.namespaceURI===fe?t.namespaceURI===me?"math"===n:t.namespaceURI===he?"math"===n&&Te[r]:Boolean(Ee[n]):e.namespaceURI===me&&(!(t.namespaceURI===he&&!Te[r])&&(!(t.namespaceURI===fe&&!Ce[r])&&(!Ee[n]&&(De[n]||!ke[n]))))},Ae=function(e){Jx(t.removed,{element:e});try{e.parentNode.removeChild(e)}catch(Ue){try{e.outerHTML=S}catch(Ue){e.remove()}}},Le=function(e,n){try{Jx(t.removed,{attribute:n.getAttributeNode(e),from:n})}catch(Ue){Jx(t.removed,{attribute:null,from:n})}if(n.removeAttribute(e),"is"===e&&!U[e])if(Z||ee)try{Ae(n)}catch(Ue){}else try{n.setAttribute(e,"")}catch(Ue){}},Oe=function(e){var t,n;if(Q)e="<remove></remove>"+e;else{var i=Zx(e,/^[\r\n\t ]+/);n=i&&i[0]}"application/xhtml+xml"===L&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var o=w?w.createHTML(e):e;if(pe===me)try{t=(new f).parseFromString(o,L)}catch(Ue){}if(!t||!t.documentElement){t=C.createDocument(pe,"template",null);try{t.documentElement.innerHTML=ge?"":o}catch(Ue){}}var a=t.body||t.documentElement;return e&&n&&a.insertBefore(r.createTextNode(n),a.childNodes[0]||null),pe===me?k.call(t,X?"html":"body")[0]:X?t.documentElement:a},Re=function(e){return T.call(e.ownerDocument||e,e,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},Ie=function(e){return e instanceof d&&("string"!==typeof e.nodeName||"string"!==typeof e.textContent||"function"!==typeof e.removeChild||!(e.attributes instanceof c)||"function"!==typeof e.removeAttribute||"function"!==typeof e.setAttribute||"string"!==typeof e.namespaceURI||"function"!==typeof e.insertBefore)},Pe=function(e){return"object"===_x(a)?e instanceof a:e&&"object"===_x(e)&&"number"===typeof e.nodeType&&"string"===typeof e.nodeName},Me=function(e,n,r){A[e]&&Yx(A[e],(function(e){e.call(t,n,r,ye)}))},Ne=function(e){var n;if(Me("beforeSanitizeElements",e,null),Ie(e))return Ae(e),!0;if(rC(/[\u0080-\uFFFF]/,e.nodeName))return Ae(e),!0;var r=O(e.nodeName);if(Me("uponSanitizeElement",e,{tagName:r,allowedTags:$}),e.hasChildNodes()&&!Pe(e.firstElementChild)&&(!Pe(e.content)||!Pe(e.content.firstElementChild))&&rC(/<[/\w]/g,e.innerHTML)&&rC(/<[/\w]/g,e.textContent))return Ae(e),!0;if("select"===r&&rC(/<template/i,e.innerHTML))return Ae(e),!0;if(!$[r]||j[r]){if(!j[r]&&Be(r)){if(H.tagNameCheck instanceof RegExp&&rC(H.tagNameCheck,r))return!1;if(H.tagNameCheck instanceof Function&&H.tagNameCheck(r))return!1}if(re&&!ae[r]){var i=b(e)||e.parentNode,o=v(e)||e.childNodes;if(o&&i)for(var a=o.length,l=a-1;l>=0;--l)i.insertBefore(p(o[l],!0),g(e))}return Ae(e),!0}return e instanceof s&&!_e(e)?(Ae(e),!0):"noscript"!==r&&"noembed"!==r||!rC(/<\/no(script|embed)/i,e.innerHTML)?(Y&&3===e.nodeType&&(n=e.textContent,n=eC(n,R," "),n=eC(n,I," "),e.textContent!==n&&(Jx(t.removed,{element:e.cloneNode()}),e.textContent=n)),Me("afterSanitizeElements",e,null),!1):(Ae(e),!0)},Fe=function(e,t,n){if(ne&&("id"===t||"name"===t)&&(n in r||n in we))return!1;if(W&&!q[t]&&rC(P,t));else if(G&&rC(M,t));else if(!U[t]||q[t]){if(!(Be(e)&&(H.tagNameCheck instanceof RegExp&&rC(H.tagNameCheck,e)||H.tagNameCheck instanceof Function&&H.tagNameCheck(e))&&(H.attributeNameCheck instanceof RegExp&&rC(H.attributeNameCheck,t)||H.attributeNameCheck instanceof Function&&H.attributeNameCheck(t))||"is"===t&&H.allowCustomizedBuiltInElements&&(H.tagNameCheck instanceof RegExp&&rC(H.tagNameCheck,n)||H.tagNameCheck instanceof Function&&H.tagNameCheck(n))))return!1}else if(ce[t]);else if(rC(B,eC(n,F,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==tC(n,"data:")||!le[e]){if(K&&!rC(N,eC(n,F,"")));else if(n)return!1}else;return!0},Be=function(e){return e.indexOf("-")>0},$e=function(e){var n,r,i,o;Me("beforeSanitizeAttributes",e,null);var a=e.attributes;if(a){var s={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:U};o=a.length;while(o--){n=a[o];var l=n,u=l.name,c=l.namespaceURI;if(r="value"===u?n.value:nC(n.value),i=O(u),s.attrName=i,s.attrValue=r,s.keepAttr=!0,s.forceKeepAttr=void 0,Me("uponSanitizeAttribute",e,s),r=s.attrValue,!s.forceKeepAttr&&(Le(u,e),s.keepAttr))if(rC(/\/>/i,r))Le(u,e);else{Y&&(r=eC(r,R," "),r=eC(r,I," "));var d=O(e.nodeName);if(Fe(d,i,r))try{c?e.setAttributeNS(c,u,r):e.setAttribute(u,r),Xx(t.removed)}catch(Ue){}}}Me("afterSanitizeAttributes",e,null)}},ze=function e(t){var n,r=Re(t);Me("beforeSanitizeShadowDOM",t,null);while(n=r.nextNode())Me("uponSanitizeShadowNode",n,null),Ne(n)||(n.content instanceof i&&e(n.content),$e(n));Me("afterSanitizeShadowDOM",t,null)};return t.sanitize=function(r,o){var s,l,u,c,d;if(ge=!r,ge&&(r="\x3c!--\x3e"),"string"!==typeof r&&!Pe(r)){if("function"!==typeof r.toString)throw iC("toString is not a function");if(r=r.toString(),"string"!==typeof r)throw iC("dirty is not a string, aborting")}if(!t.isSupported){if("object"===_x(e.toStaticHTML)||"function"===typeof e.toStaticHTML){if("string"===typeof r)return e.toStaticHTML(r);if(Pe(r))return e.toStaticHTML(r.outerHTML)}return r}if(J||xe(o),t.removed=[],"string"===typeof r&&(ie=!1),ie){if(r.nodeName){var f=O(r.nodeName);if(!$[f]||j[f])throw iC("root node is forbidden and cannot be sanitized in-place")}}else if(r instanceof a)s=Oe("\x3c!----\x3e"),l=s.ownerDocument.importNode(r,!0),1===l.nodeType&&"BODY"===l.nodeName||"HTML"===l.nodeName?s=l:s.appendChild(l);else{if(!Z&&!Y&&!X&&-1===r.indexOf("<"))return w&&te?w.createHTML(r):r;if(s=Oe(r),!s)return Z?null:te?S:""}s&&Q&&Ae(s.firstChild);var h=Re(ie?r:s);while(u=h.nextNode())3===u.nodeType&&u===c||Ne(u)||(u.content instanceof i&&ze(u.content),$e(u),c=u);if(c=null,ie)return r;if(Z){if(ee){d=D.call(s.ownerDocument);while(s.firstChild)d.appendChild(s.firstChild)}else d=s;return U.shadowroot&&(d=E.call(n,d,!0)),d}var m=X?s.outerHTML:s.innerHTML;return X&&$["!doctype"]&&s.ownerDocument&&s.ownerDocument.doctype&&s.ownerDocument.doctype.name&&rC(_C,s.ownerDocument.doctype.name)&&(m="<!DOCTYPE "+s.ownerDocument.doctype.name+">\n"+m),Y&&(m=eC(m,R," "),m=eC(m,I," ")),w&&te?w.createHTML(m):m},t.setConfig=function(e){xe(e),J=!0},t.clearConfig=function(){ye=null,J=!1},t.isValidAttribute=function(e,t,n){ye||xe({});var r=O(e),i=O(t);return Fe(r,i,n)},t.addHook=function(e,t){"function"===typeof t&&(A[e]=A[e]||[],Jx(A[e],t))},t.removeHook=function(e){if(A[e])return Xx(A[e])},t.removeHooks=function(e){A[e]&&(A[e]=[])},t.removeAllHooks=function(){A={}},t}var RC=OC(),IC=function(e){return RC().sanitize(e)},PC=tinymce.util.Tools.resolve("tinymce.util.I18n"),MC={indent:!0,outdent:!0,"table-insert-column-after":!0,"table-insert-column-before":!0,"paste-column-after":!0,"paste-column-before":!0,"unordered-list":!0,"list-bull-circle":!0,"list-bull-default":!0,"list-bull-square":!0},NC="temporary-placeholder",FC=function(e){return function(){return ke(e,NC).getOr("!not found!")}},BC=function(e,t){var n=e.toLowerCase();if(PC.isRtl()){var r=Ue(n,"-rtl");return Ee(t,r)?r:n}return n},$C=function(e,t){return ke(t,BC(e,t))},zC=function(e,t){var n=t();return $C(e,n).getOrThunk(FC(n))},UC=function(e,t,n){var r=t();return $C(e,r).or(n).getOrThunk(FC(r))},VC=function(e){return!!PC.isRtl()&&Ee(MC,e)},HC=function(){return Uw("add-focusable",[Vs((function(e){Fu(e.element,"svg").each((function(e){return zn(e,"focusable","false")}))}))])},jC=function(e,t,n,r){var i,o,a=VC(t)?["tox-icon--flip"]:[],s=ke(n,BC(t,n)).or(r).getOrThunk(FC(n));return{dom:{tag:e.tag,attributes:null!==(i=e.attributes)&&void 0!==i?i:{},classes:e.classes.concat(a),innerHtml:s},behaviours:fd(O(O([],null!==(o=e.behaviours)&&void 0!==o?o:[],!0),[HC()],!1))}},qC=function(e,t,n,r){return void 0===r&&(r=N.none()),jC(t,e,n(),r)},GC=function(e,t,n){var r=n(),i=ee(e,(function(e){return Ee(r,BC(e,r))}));return jC(t,i.getOr(NC),r,N.none())},WC={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},KC=function(e){var t=Ex({dom:kx("<p>"+IC(e.translationProvider(e.text))+"</p>"),behaviours:fd([$w.config({})])}),n=function(e){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+e+"%"}}}},r=function(e){return{dom:{tag:"div",classes:["tox-text"],innerHtml:e+"%"}}},i=Ex({dom:{tag:"div",classes:e.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[n(0)]},r(0)],behaviours:fd([$w.config({})])}),o=function(e,t){e.getSystem().isConnected()&&i.getOpt(e).each((function(e){$w.set(e,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[n(t)]},r(t)])}))},a=function(e,n){if(e.getSystem().isConnected()){var r=t.get(e);$w.set(r,[Cu(n)])}},s={updateProgress:o,updateText:a},l=ne([e.icon.toArray(),e.level.toArray(),e.level.bind((function(e){return N.from(WC[e])})).toArray()]),u=Ex(Cx.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[qC("close",{tag:"div",classes:["tox-icon"],attributes:{"aria-label":e.translationProvider("Close")}},e.iconProvider)],action:function(t){e.onAction(t)}})),c=GC(l,{tag:"div",classes:["tox-notification__icon"]},e.iconProvider),d={dom:{tag:"div",classes:["tox-notification__body"]},components:[t.asSpec()],behaviours:fd([$w.config({})])},f=[c,d];return{uid:e.uid,dom:{tag:"div",attributes:{role:"alert"},classes:e.level.map((function(e){return["tox-notification","tox-notification--in","tox-notification--"+e]})).getOr(["tox-notification","tox-notification--in"])},behaviours:fd([Xw.config({}),Uw("notification-events",[Rs(Ba(),(function(e){u.getOpt(e).each(Xw.focus)}))])]),components:f.concat(e.progress?[i.asSpec()]:[]).concat(e.closeButton?[u.asSpec()]:[]),apis:s}},YC=fv({name:"Notification",factory:KC,configFields:[zo("level"),Ao("progress"),Ao("icon"),Ao("onAction"),Ao("text"),Ao("iconProvider"),Ao("translationProvider"),Zo("closeButton",!0)],apis:{updateProgress:function(e,t,n){e.updateProgress(t,n)},updateText:function(e,t,n){e.updateText(t,n)}}});function XC(e,t,n){var r=t.backstage.shared,i=function(e){switch(e){case"bc-bc":return mx;case"tc-tc":return hx;case"tc-bc":return qc;case"bc-tc":default:return Gc}},o=function(e){e.length>0&&W(e,(function(t,n){0===n?t.moveRel(null,"banner"):t.moveRel(e[n-1].getEl(),"bc-tc")}))},a=function(t,o){var a=!t.closeButton&&t.timeout&&(t.timeout>0||t.timeout<0),s=function(){o(),tx.hide(u)},l=Eu(YC.sketch({text:t.text,level:V(["success","error","warning","warn","info"],t.type)?t.type:void 0,progress:!0===t.progressBar,icon:N.from(t.icon),closeButton:!a,onAction:s,iconProvider:r.providers.icons,translationProvider:r.providers.translate})),u=Eu(tx.sketch(A({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:r.getSink,fireDismissalEventInstead:{}},r.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})));n.add(u),t.timeout>0&&Sx.setTimeout((function(){s()}),t.timeout);var c=function(){var t=Jr(tt.fromDom(e.getContentAreaContainer())),n=Zr(),r=_c(n.x,t.x,t.right),i=_c(n.y,t.y,t.bottom),o=Math.max(t.right,n.right),a=Math.max(t.bottom,n.bottom);return N.some(Xr(r,i,o-r,a-i))};return{close:s,moveTo:function(e,t){tx.showAt(u,_u(l),{anchor:{type:"makeshift",x:e,y:t}})},moveRel:function(e,t){var n=_u(l),o={maxHeightFunction:Ef()};if("banner"!==t&&f(e)){var a=i(t),s={type:"node",root:Fn(),node:N.some(tt.fromDom(e)),overrides:o,layouts:{onRtl:function(){return[a]},onLtr:function(){return[a]}}};tx.showWithinBounds(u,n,{anchor:s},c)}else{var d=A(A({},r.anchors.banner()),{overrides:o});tx.showWithinBounds(u,n,{anchor:d},c)}},text:function(e){YC.updateText(l,e)},settings:t,getEl:function(){return l.element.dom},progressBar:{value:function(e){YC.updateProgress(l,e)}}}},s=function(e){e.close()},l=function(e){return e.settings};return{open:a,close:s,reposition:o,getArgs:l}}var JC,QC=function(e,t){var n=null,r=function(){l(n)||(clearTimeout(n),n=null)},i=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];l(n)&&(n=setTimeout((function(){n=null,e.apply(null,r)}),t))};return{cancel:r,throttle:i}},ZC=function(e,t){var n=null,r=function(){l(n)||(clearTimeout(n),n=null)},i=function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];r(),n=setTimeout((function(){n=null,e.apply(null,i)}),t)};return{cancel:r,throttle:i}},eT=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),tT=function(e,t){return e.isBlock(t)||V(["BR","IMG","HR","INPUT"],t.nodeName)||"false"===e.getContentEditable(t)},nT=function(e,t,n,r,i){var o=eT(e,(function(t){return tT(e,t)}));return N.from(o.backwards(t,n,r,i))},rT="[data-mce-autocompleter]",iT=function(e,t){return oT(tt.fromDom(e.selection.getNode())).getOrThunk((function(){var n=tt.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',e.getDoc());return Lr(n,tt.fromDom(t.extractContents())),t.insertNode(n.dom),vn(n).each((function(e){return e.dom.normalize()})),Wh(n).map((function(t){e.selection.setCursorLocation(t.dom,Hh(t))})),n}))},oT=function(e){return $u(e,rT)},aT=function(e){return e.collapsed&&3===e.startContainer.nodeType},sT=function(e){return e.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},lT=function(e){return""!==e&&-1!=="  \f\n\r\t\v".indexOf(e)},uT=function(e,t){return e.substring(t.length)},cT=function(e,t,n){var r;for(r=t-1;r>=0;r--){var i=e.charAt(r);if(lT(i))return N.none();if(i===n)break}return N.some(r)},dT=function(e,t,n,r){if(void 0===r&&(r=0),!aT(t))return N.none();var i=function(e,t,r){return cT(r,t,n).getOr(t)},o=e.getParent(t.startContainer,e.isBlock)||e.getRoot();return nT(e,t.startContainer,t.startOffset,i,o).bind((function(e){var i=t.cloneRange();if(i.setStart(e.container,e.offset),i.setEnd(t.endContainer,t.endOffset),i.collapsed)return N.none();var o=sT(i),a=o.lastIndexOf(n);return 0!==a||uT(o,n).length<r?N.none():N.some({text:uT(o,n),range:i,triggerChar:n})}))},fT=function(e,t,n,r){return void 0===r&&(r=0),oT(tt.fromDom(t.startContainer)).fold((function(){return dT(e,t,n,r)}),(function(t){var r=e.createRng();r.selectNode(t.dom);var i=sT(r);return N.some({range:r,text:uT(i,n),triggerChar:n})}))},hT=function(e,t){t.on("keypress compositionend",e.onKeypress.throttle),t.on("remove",e.onKeypress.cancel);var n=function(e,t){Cs(e,za(),{raw:t})};t.on("keydown",(function(t){var r=function(){return e.getView().bind(rb.getHighlighted)};8===t.which&&e.onKeypress.throttle(t),e.isActive()&&(27===t.which&&e.cancelIfNecessary(),e.isMenuOpen()?13===t.which?(r().each(Ts),t.preventDefault()):40===t.which?(r().fold((function(){e.getView().each(rb.highlightFirst)}),(function(e){n(e,t)})),t.preventDefault(),t.stopImmediatePropagation()):37!==t.which&&38!==t.which&&39!==t.which||r().each((function(e){n(e,t),t.preventDefault(),t.stopImmediatePropagation()})):13!==t.which&&38!==t.which&&40!==t.which||e.cancelIfNecessary())})),t.on("NodeChange",(function(t){e.isActive()&&!e.isProcessingAction()&&oT(tt.fromDom(t.element)).isNone()&&e.cancelIfNecessary()}))},mT={setup:hT},pT=tinymce.util.Tools.resolve("tinymce.util.Promise"),gT=function(e,t){return{container:e,offset:t}},vT=function(e){return e.nodeType===at},bT=function(e){return e.nodeType===ot},yT=function(e){if(vT(e))return gT(e,e.data.length);var t=e.childNodes;return t.length>0?yT(t[t.length-1]):gT(e,t.length)},wT=function(e,t){var n=e.childNodes;return n.length>0&&t<n.length?wT(n[t],0):n.length>0&&bT(e)&&n.length===t?yT(n[n.length-1]):gT(e,t)},ST=function(e,t){return nT(e,t.container,t.offset,(function(e,t){return 0===t?-1:t}),e.getRoot()).filter((function(e){var t=e.container.data.charAt(e.offset-1);return!lT(t)})).isSome()},xT=function(e){return function(t){var n=wT(t.startContainer,t.startOffset);return!ST(e,n)}},CT=function(e,t,n){return me(n.triggerChars,(function(n){return fT(e,t,n)}))},TT=function(e,t){var n=t(),r=e.selection.getRng();return CT(e.dom,r,n).bind((function(n){return DT(e,t,n)}))},DT=function(e,t,n,r){void 0===r&&(r={});var i=t(),o=e.selection.getRng(),a=o.startContainer.nodeValue,s=X(i.lookupByChar(n.triggerChar),(function(t){return n.text.length>=t.minChars&&t.matches.getOrThunk((function(){return xT(e.dom)}))(n.range,a,n.text)}));if(0===s.length)return N.none();var l=pT.all(G(s,(function(e){var t=e.fetch(n.text,e.maxResults,r);return t.then((function(t){return{matchText:n.text,items:t,columns:e.columns,onAction:e.onAction,highlightOn:e.highlightOn}}))})));return N.some({lookupData:l,context:n})},kT=Zi([Ro("type"),Ho("text")]),ET=function(e){return wo("separatormenuitem",kT,e)},_T=Zi([Ko("type","autocompleteitem"),Ko("active",!1),Ko("disabled",!1),Ko("meta",{}),Ro("value"),Ho("text"),Ho("icon")]),AT=Zi([Ro("type"),Ro("ch"),Xo("minChars",1),Ko("columns",1),Xo("maxResults",10),jo("matches"),Mo("fetch"),Mo("onAction"),na("highlightOn",[],lo)]),LT=function(e){return wo("Autocompleter.Separator",kT,e)},OT=function(e){return wo("Autocompleter.Item",_T,e)},RT=function(e){return wo("Autocompleter",AT,e)},IT=[Zo("disabled",!1),Ho("tooltip"),Ho("icon"),Ho("text"),ea("onSetup",(function(){return g}))],PT=Zi([Ro("type"),Mo("onAction")].concat(IT)),MT=function(e){return wo("toolbarbutton",PT,e)},NT=[Zo("active",!1)].concat(IT),FT=Zi(NT.concat([Ro("type"),Mo("onAction")])),BT=function(e){return wo("ToggleButton",FT,e)},$T=[ea("predicate",k),Qo("scope","node",["node","editor"]),Qo("position","selection",["node","selection","line"])],zT=IT.concat([Ko("type","contextformbutton"),Ko("primary",!1),Mo("onAction"),Eo("original",S)]),UT=NT.concat([Ko("type","contextformbutton"),Ko("primary",!1),Mo("onAction"),Eo("original",S)]),VT=IT.concat([Ko("type","contextformbutton")]),HT=NT.concat([Ko("type","contextformtogglebutton")]),jT=To("type",{contextformbutton:zT,contextformtogglebutton:UT}),qT=Zi([Ko("type","contextform"),ea("initValue",w("")),Ho("label"),$o("commands",jT),Uo("launch",To("type",{contextformbutton:VT,contextformtogglebutton:HT}))].concat($T)),GT=function(e){return wo("ContextForm",qT,e)},WT=Zi([Ko("type","contexttoolbar"),Ro("items")].concat($T)),KT=function(e){return wo("ContextToolbar",WT,e)},YT=function(e){var t={};return W(e,(function(e){t[e]={}})),pe(t)},XT=function(e){var t=e.ui.registry.getAll().popups,n=be(t,(function(e){return RT(e).fold((function(e){throw new Error(Co(e))}),S)})),r=YT(Ce(n,(function(e){return e.ch}))),i=De(n),o=function(e){return X(i,(function(t){return t.ch===e}))};return{dataset:n,triggerChars:r,lookupByChar:o}};(function(e){e[e["CLOSE_ON_EXECUTE"]=0]="CLOSE_ON_EXECUTE",e[e["BUBBLE_TO_SANDBOX"]=1]="BUBBLE_TO_SANDBOX"})(JC||(JC={}));var JT,QT=JC,ZT="tox-menu-nav__js",eD="tox-collection__item",tD="tox-swatch",nD={normal:ZT,color:tD},rD="tox-collection__item--enabled",iD="tox-collection__group-heading",oD="tox-collection__item-icon",aD="tox-collection__item-label",sD="tox-collection__item-accessory",lD="tox-collection__item-caret",uD="tox-collection__item-checkmark",cD="tox-collection__item--active",dD="tox-collection__item-container",fD="tox-collection__item-container--column",hD="tox-collection__item-container--row",mD="tox-collection__item-container--align-right",pD="tox-collection__item-container--align-left",gD="tox-collection__item-container--valign-top",vD="tox-collection__item-container--valign-middle",bD="tox-collection__item-container--valign-bottom",yD=function(e){return ke(nD,e).getOr(ZT)},wD=function(e){return"color"===e?"tox-swatches":"tox-menu"},SD=function(e){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:wD(e),tieredMenu:"tox-tiered-menu"}},xD=function(e){var t=SD(e);return{backgroundMenu:t.backgroundMenu,selectedMenu:t.selectedMenu,menu:t.menu,selectedItem:t.selectedItem,item:yD(e)}},CD=function(e,t,n){var r=SD(n);return{tag:"div",classes:ne([[r.menu,"tox-menu-"+t+"-column"],e?[r.hasIcons]:[]])}},TD=[zS.parts.items({})],DD=function(e,t,n){var r=SD(n),i={tag:"div",classes:ne([[r.tieredMenu]])};return{dom:i,markers:xD(n)}},kD=function(e,t){return function(n){var r=q(n,t);return G(r,(function(t){return{dom:e,components:t}}))}},ED=function(e){return{dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[zS.parts.items({preprocess:"auto"!==e?kD({tag:"div",classes:["tox-swatches__row"]},e):S})]}]}},_D=function(e){return{dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[zS.parts.items({preprocess:kD({tag:"div",classes:["tox-collection__group"]},e)})]}},AD=function(e,t){var n=[],r=[];return W(e,(function(e,i){t(e,i)?(r.length>0&&n.push(r),r=[],Ee(e.dom,"innerHtml")&&r.push(e)):r.push(e)})),r.length>0&&n.push(r),G(n,(function(e){return{dom:{tag:"div",classes:["tox-collection__group"]},components:e}}))},LD=function(e,t,n){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===e?["tox-collection--list"]:["tox-collection--grid"])},components:[zS.parts.items({preprocess:function(n){return"auto"!==e&&e>1?kD({tag:"div",classes:["tox-collection__group"]},e)(n):AD(n,(function(e,n){return"separator"===t[n].type}))}})]}},OD=function(e,t){return{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[zS.parts.items({preprocess:function(t){return AD(t,(function(t,n){return"separator"===e[n].type}))}})]}},RD=function(e){return H(e,(function(e){return"icon"in e&&void 0!==e.icon}))},ID=function(e){return console.error(Co(e)),console.log(e),N.none()},PD=function(e,t,n,r,i){var o=OD(n);return{value:e,dom:o.dom,components:o.components,items:n}},MD=function(e,t,n,r,i){if("color"===i){var o=ED(r);return{value:e,dom:o.dom,components:o.components,items:n}}if("normal"===i&&"auto"===r){o=LD(r,n);return{value:e,dom:o.dom,components:o.components,items:n}}if("normal"===i&&1===r){o=LD(1,n);return{value:e,dom:o.dom,components:o.components,items:n}}if("normal"===i){o=LD(r,n);return{value:e,dom:o.dom,components:o.components,items:n}}if("listpreview"===i&&"auto"!==r){o=_D(r);return{value:e,dom:o.dom,components:o.components,items:n}}return{value:e,dom:CD(t,r,i),components:TD,items:n}},ND=[Ro("type"),Ro("src"),Ho("alt"),na("classes",[],lo)],FD=Zi(ND),BD=[Ro("type"),Ro("text"),Ho("name"),na("classes",["tox-collection__item-label"],lo)],$D=Zi(BD),zD=Xi((function(){return po("type",{cardimage:FD,cardtext:$D,cardcontainer:UD})})),UD=Zi([Ro("type"),Jo("direction","horizontal"),Jo("align","left"),Jo("valign","middle"),$o("items",zD)]),VD=[Zo("disabled",!1),Ho("text"),Ho("shortcut"),ko("value","value",Ti((function(){return il("menuitem-value")})),oo()),Ko("meta",{})],HD=Zi([Ro("type"),Ho("label"),$o("items",zD),ea("onSetup",(function(){return g})),ea("onAction",g)].concat(VD)),jD=function(e){return wo("cardmenuitem",HD,e)},qD=Zi([Ro("type"),Zo("active",!1),Ho("icon")].concat(VD)),GD=function(e){return wo("choicemenuitem",qD,e)},WD=[Ro("type"),Ro("fancytype"),ea("onAction",g)],KD=[Ko("initData",{})].concat(WD),YD=[ra("initData",{},[Zo("allowCustomColors",!0),qo("colors",oo())])].concat(WD),XD=To("fancytype",{inserttable:KD,colorswatch:YD}),JD=function(e){return wo("fancymenuitem",XD,e)},QD=Zi([Ro("type"),ea("onSetup",(function(){return g})),ea("onAction",g),Ho("icon")].concat(VD)),ZD=function(e){return wo("menuitem",QD,e)},ek=Zi([Ro("type"),Mo("getSubmenuItems"),ea("onSetup",(function(){return g})),Ho("icon")].concat(VD)),tk=function(e){return wo("nestedmenuitem",ek,e)},nk=Zi([Ro("type"),Ho("icon"),Zo("active",!1),ea("onSetup",(function(){return g})),Mo("onAction")].concat(VD)),rk=function(e){return wo("togglemenuitem",nk,e)},ik=function(e,t,n){var r=Yh(e.element,"."+n);if(r.length>0){var i=te(r,(function(e){var n=e.dom.getBoundingClientRect().top,i=r[0].dom.getBoundingClientRect().top;return Math.abs(n-i)>t})).getOr(r.length);return N.some({numColumns:i,numRows:Math.ceil(r.length/i)})}return N.none()},ok=function(e,t){return fd([Uw(e,t)])},ak=function(e){return ok(il("unnamed-events"),e)},sk={namedEvents:ok,unnamedEvents:ak},lk=il("tooltip.exclusive"),uk=il("tooltip.show"),ck=il("tooltip.hide"),dk=function(e,t,n){e.getSystem().broadcastOn([lk],{})},fk=function(e,t,n,r){n.getTooltip().each((function(e){e.getSystem().isConnected()&&$w.set(e,r)}))},hk=Object.freeze({__proto__:null,hideAllExclusive:dk,setComponents:fk}),mk=function(e,t){var n=function(n){t.getTooltip().each((function(r){Wm(r),e.onHide(n,r),t.clearTooltip()})),t.clearTimer()},r=function(n){if(!t.isShowing()){dk(n);var r=e.lazySink(n).getOrDie(),i=n.getSystem().build({dom:e.tooltipDom,components:e.tooltipComponents,events:_s("normal"===e.mode?[Rs(Fa(),(function(e){xs(n,uk)})),Rs(Ma(),(function(e){xs(n,ck)}))]:[]),behaviours:fd([$w.config({})])});t.setTooltip(i),jm(r,i),e.onShow(n,i),Bm.position(r,i,{anchor:e.anchor(n)})}};return _s(ne([[Rs(uk,(function(n){t.resetTimer((function(){r(n)}),e.delay)})),Rs(ck,(function(r){t.resetTimer((function(){n(r)}),e.delay)})),Rs(es(),(function(e,t){var r=t;r.universal||V(r.channels,lk)&&n(e)})),Hs((function(e){n(e)}))],"normal"===e.mode?[Rs(Ba(),(function(e){xs(e,uk)})),Rs(Qa(),(function(e){xs(e,ck)})),Rs(Fa(),(function(e){xs(e,uk)})),Rs(Ma(),(function(e){xs(e,ck)}))]:[Rs(ws(),(function(e,t){xs(e,uk)})),Rs(Ss(),(function(e){xs(e,ck)}))]]))},pk=Object.freeze({__proto__:null,events:mk}),gk=[Ao("lazySink"),Ao("tooltipDom"),Ko("exclusive",!0),Ko("tooltipComponents",[]),Ko("delay",300),Qo("mode","normal",["normal","follow-highlight"]),Ko("anchor",(function(e){return{type:"hotspot",hotspot:e,layouts:{onLtr:w([Gc,qc,Uc,Hc,Vc,jc]),onRtl:w([Gc,qc,Uc,Hc,Vc,jc])}}})),sc("onHide"),sc("onShow")],vk=function(){var e=rf(),t=rf(),n=function(){e.on(clearTimeout)},r=function(t,r){n(),e.set(setTimeout(t,r))},i=w("not-implemented");return Dl({getTooltip:t.get,isShowing:t.isSet,setTooltip:t.set,clearTooltip:t.clear,clearTimer:n,resetTimer:r,readState:i})},bk=Object.freeze({__proto__:null,init:vk}),yk=md({fields:gk,name:"tooltipping",active:pk,state:bk,apis:hk}),wk=function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},Sk=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),xk=tinymce.util.Tools.resolve("tinymce.EditorManager"),Ck=function(e){var t=e.getParam("skin"),n=e.getParam("skin_url");if(!1!==t){var r=t||"oxide";n=n?e.documentBaseURI.toAbsolute(n):xk.baseURL+"/skins/ui/"+r}return n},Tk=function(e){return e.getParam("readonly",!1,"boolean")},Dk=function(e){return!1===e.getParam("skin")},kk=function(e){return e.getParam("height",Math.max(e.getElement().offsetHeight,200))},Ek=function(e){return e.getParam("width",Sk.DOM.getStyle(e.getElement(),"width"))},_k=function(e){return N.from(e.getParam("min_width")).filter(m)},Ak=function(e){return N.from(e.getParam("min_height")).filter(m)},Lk=function(e){return N.from(e.getParam("max_width")).filter(m)},Ok=function(e){return N.from(e.getParam("max_height")).filter(m)},Rk=function(e){return N.from(e.getParam("style_formats")).filter(s)},Ik=function(e){return e.getParam("style_formats_merge",!1,"boolean")},Pk=function(e){return e.getParam("lineheight_formats","1 1.1 1.2 1.3 1.4 1.5 2","string").split(" ")},Mk=function(e){return e.getParam("content_langs",void 0,"array")},Nk=function(e){return e.getParam("removed_menuitems","")},Fk=function(e){return!1!==e.getParam("menubar",!0,"boolean")},Bk=function(e){var t=e.getParam("toolbar",!0),n=!0===t,r=o(t),i=s(t)&&t.length>0;return!zk(e)&&(i||r||n)},$k=function(e){var t=j(9,(function(t){return e.getParam("toolbar"+(t+1),!1,"string")})),n=X(t,(function(e){return"string"===typeof e}));return n.length>0?N.some(n):N.none()},zk=function(e){return $k(e).fold((function(){var t=e.getParam("toolbar",[],"string[]");return t.length>0}),E)};(function(e){e["default"]="wrap",e["floating"]="floating",e["sliding"]="sliding",e["scrolling"]="scrolling"})(JT||(JT={}));var Uk,Vk=function(e){return e.getParam("toolbar_mode","","string")};(function(e){e["auto"]="auto",e["top"]="top",e["bottom"]="bottom"})(Uk||(Uk={}));var Hk,jk=function(e){return e.getParam("toolbar_groups",{},"object")},qk=function(e){return e.getParam("toolbar_location",Uk.auto,"string")},Gk=function(e){return qk(e)===Uk.bottom},Wk=function(e){return e.getParam("fixed_toolbar_container","","string")},Kk=function(e){return e.getParam("fixed_toolbar_container_target")},Yk=function(e){return e.getParam("toolbar_persist",!1,"boolean")},Xk=function(e){if(!e.inline)return N.none();var t=Wk(e);if(t.length>0)return Bu(Fn(),t);var n=Kk(e);return f(n)?N.some(tt.fromDom(n)):N.none()},Jk=function(e){return e.inline&&Xk(e).isSome()},Qk=function(e){var t=Xk(e);return t.getOrThunk((function(){return Ln(An(tt.fromDom(e.getElement())))}))},Zk=function(e){return e.inline&&!Fk(e)&&!Bk(e)&&!zk(e)},eE=function(e){var t=e.getParam("toolbar_sticky",!1,"boolean");return(t||e.inline)&&!Jk(e)&&!Zk(e)},tE=function(e){return e.getParam("toolbar_sticky_offset",0,"number")},nE=function(e){return e.getParam("draggable_modal",!1,"boolean")},rE=function(e){var t=e.getParam("menu");return t?be(t,(function(e){return A(A({},e),{items:e.items})})):{}},iE=function(e){return e.getParam("menubar")},oE=function(e){return e.getParam("toolbar",!0)},aE=function(e){return e.getParam("file_picker_callback")},sE=function(e){return e.getParam("file_picker_types")},lE=function(e){return e.getParam("file_browser_callback_types")},uE=function(e){return!1===e.getParam("typeahead_urls")},cE=function(e){return e.getParam("anchor_top","#top")},dE=function(e){return e.getParam("anchor_bottom","#bottom")},fE=function(e){var t=e.getParam("file_picker_validator_handler",void 0,"function");return void 0===t?e.getParam("filepicker_validator_handler",void 0,"function"):t},hE="silver.readonly",mE=Zi([Po("readonly")]),pE=function(e,t){var n=e.outerContainer,r=n.element;t&&(e.mothership.broadcastOn([yp()],{target:r}),e.uiMothership.broadcastOn([yp()],{target:r})),e.mothership.broadcastOn([hE],{readonly:t}),e.uiMothership.broadcastOn([hE],{readonly:t})},gE=function(e,t){e.on("init",(function(){e.mode.isReadOnly()&&pE(t,!0)})),e.on("SwitchMode",(function(){return pE(t,e.mode.isReadOnly())})),Tk(e)&&e.setMode("readonly")},vE=function(){var e;return bd.config({channels:(e={},e[hE]={schema:mE,onReceive:function(e,t){Fv.set(e,t.readonly)}},e)})},bE=function(e){return Fv.config({disabled:e,disableClass:"tox-collection__item--state-disabled"})},yE=function(e){return Fv.config({disabled:e})},wE=function(e){return Fv.config({disabled:e,disableClass:"tox-tbtn--disabled"})},SE=function(e){return Fv.config({disabled:e,disableClass:"tox-tbtn--disabled",useNative:!1})},xE={item:bE,button:yE,splitButton:wE,toolbarButton:SE},CE=function(e,t){var n=e.getApi(t);return function(e){e(n)}},TE=function(e,t){return Vs((function(n){var r=CE(e,n);r((function(n){var r=e.onSetup(n);h(r)&&t.set(r)}))}))},DE=function(e,t){return Hs((function(n){return CE(e,n)(t.get())}))},kE=function(e,t){return qs((function(n,r){CE(e,n)(e.onAction),e.triggersSubmenu||t!==QT.CLOSE_ON_EXECUTE||(xs(n,os()),r.stop())}))},EE=(Hk={},Hk[ts()]=["disabling","alloy.base.behaviour","toggling","item-events"],Hk),_E=Oe,AE=function(e,t,n,r){var i=ia(g);return{type:"item",dom:t.dom,components:_E(t.optComponents),data:e.data,eventOrder:EE,hasSubmenu:e.triggersSubmenu,itemBehaviours:fd([Uw("item-events",[kE(e,n),TE(e,i),DE(e,i)]),xE.item((function(){return e.disabled||r.isDisabled()})),vE(),$w.config({})].concat(e.itemBehaviours))}},LE=function(e){return{value:e.value,meta:A({text:e.text.getOr("")},e.meta)}},OE=tinymce.util.Tools.resolve("tinymce.Env"),RE=function(e){var t={alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"},n={meta:"Ctrl",access:"Shift+Alt"},r=OE.mac?t:n,i=e.split("+"),o=G(i,(function(e){var t=e.toLowerCase().trim();return Ee(r,t)?r[t]:e}));return OE.mac?o.join(""):o.join("+")},IE=function(e,t,n){return void 0===n&&(n=[oD]),qC(e,{tag:"div",classes:n},t)},PE=function(e){return{dom:{tag:"div",classes:[aD]},components:[Cu(PC.translate(e))]}},ME=function(e,t){return{dom:{tag:"div",classes:t,innerHtml:e}}},NE=function(e,t){return{dom:{tag:"div",classes:[aD]},components:[{dom:{tag:e.tag,styles:e.styles},components:[Cu(PC.translate(t))]}]}},FE=function(e){return{dom:{tag:"div",classes:[sD],innerHtml:RE(e)}}},BE=function(e){return IE("checkmark",e,[uD])},$E=function(e){return IE("chevron-right",e,[lD])},zE=function(e){return IE("chevron-down",e,[lD])},UE=function(e,t){var n="vertical"===e.direction?fD:hD,r="left"===e.align?pD:mD,i=function(){switch(e.valign){case"top":return gD;case"middle":return vD;case"bottom":return bD}};return{dom:{tag:"div",classes:[dD,n,r,i()]},components:t}},VE=function(e,t,n){return{dom:{tag:"img",classes:t,attributes:{src:e,alt:n.getOr("")}}}},HE=function(e,t,n){var r="custom",i="remove",o=e.ariaLabel,a=e.value,s=e.iconContent.map((function(e){return UC(e,t.icons,n)})),l=function(){var e=tD,n=s.getOr(""),l=o.map((function(e){return{title:t.translate(e)}})).getOr({}),u={tag:"div",attributes:l,classes:[e]};return A(A({},u),a===r?{tag:"button",classes:O(O([],u.classes,!0),["tox-swatches__picker-btn"],!1),innerHtml:n}:a===i?{classes:O(O([],u.classes,!0),["tox-swatch--remove"],!1),innerHtml:n}:{attributes:A(A({},u.attributes),{"data-mce-color":a}),styles:{"background-color":a}})};return{dom:l(),optComponents:[]}},jE=function(e){var t=e.map((function(e){return{attributes:{title:PC.translate(e)}}})).getOr({});return A({tag:"div",classes:[ZT,eD]},t)},qE=function(e,t,n,r){var i={tag:"div",classes:[oD]},o=function(e){return qC(e,i,t.icons,r)},a=function(){return N.some({dom:i})},s=n?e.iconContent.map(o).orThunk(a):N.none(),l=e.checkMark,u=N.from(e.meta).fold((function(){return PE}),(function(e){return Ee(e,"style")?C(NE,e.style):PE})),c=e.htmlContent.fold((function(){return e.textContent.map(u)}),(function(e){return N.some(ME(e,[aD]))})),d={dom:jE(e.ariaLabel),optComponents:[s,c,e.shortcutContent.map(FE),l,e.caret]};return d},GE=function(e,t,n,r){return void 0===r&&(r=N.none()),"color"===e.presets?HE(e,t,r):qE(e,t,n,r)},WE=function(e,t){return ke(e,"tooltipWorker").map((function(e){return[yk.config({lazySink:t.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(e){return{type:"submenu",item:e,overrides:{maxHeightFunction:Ef}}},mode:"follow-highlight",onShow:function(t,n){e((function(e){yk.setComponents(t,[Tu({element:tt.fromDom(e)})])}))}})]})).getOr([])},KE=function(e){return Sk.DOM.encode(e)},YE=function(e,t){var n=PC.translate(e),r=KE(n);if(t.length>0){var i=new RegExp(wk(t),"gi");return r.replace(i,(function(e){return'<span class="tox-autocompleter-highlight">'+e+"</span>"}))}return r},XE=function(e,t,n,r,i,o,a,s){void 0===s&&(s=!0);var l=GE({presets:r,textContent:N.none(),htmlContent:n?e.text.map((function(e){return YE(e,t)})):N.none(),ariaLabel:e.text,iconContent:e.icon,shortcutContent:N.none(),checkMark:N.none(),caret:N.none(),value:e.value},a.providers,s,e.icon);return AE({data:LE(e),disabled:e.disabled,getApi:w({}),onAction:function(t){return i(e.value,e.meta)},onSetup:w(g),triggersSubmenu:!1,itemBehaviours:WE(e.meta,a)},l,o,a.providers)},JE=function(e,t){return G(e,(function(e){switch(e.type){case"cardcontainer":return UE(e,JE(e.items,t));case"cardimage":return VE(e.src,e.classes,e.alt);case"cardtext":var n=e.name.exists((function(e){return V(t.cardText.highlightOn,e)})),r=n?N.from(t.cardText.matchText).getOr(""):"";return ME(YE(e.text,r),e.classes)}}))},QE=function(e,t,n,r){var i=function(e){return{isDisabled:function(){return Fv.isDisabled(e)},setDisabled:function(t){Fv.set(e,t),W(Yh(e.element,"*"),(function(n){e.getSystem().getByDom(n).each((function(e){e.hasConfigured(Fv)&&Fv.set(e,t)}))}))}}},o={dom:jE(e.label),optComponents:[N.some({dom:{tag:"div",classes:[dD,hD]},components:JE(e.items,r)})]};return AE({data:LE(A({text:N.none()},e)),disabled:e.disabled,getApi:i,onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:N.from(r.itemBehaviours).getOr([])},o,t,n.providers)},ZE=function(e,t,n,r,i,o,a,s){void 0===s&&(s=!0);var l=function(e){return{setActive:function(t){pS.set(e,t)},isActive:function(){return pS.isOn(e)},isDisabled:function(){return Fv.isDisabled(e)},setDisabled:function(t){return Fv.set(e,t)}}},u=GE({presets:n,textContent:t?e.text:N.none(),htmlContent:N.none(),ariaLabel:e.text,iconContent:e.icon,shortcutContent:t?e.shortcut:N.none(),checkMark:t?N.some(BE(a.icons)):N.none(),caret:N.none(),value:e.value},a,s);return Si(AE({data:LE(e),disabled:e.disabled,getApi:l,onAction:function(t){return r(e.value)},onSetup:function(e){return e.setActive(i),g},triggersSubmenu:!1,itemBehaviours:[]},u,o,a),{toggling:{toggleClass:rD,toggleOnExecute:!1,selected:e.active}})},e_=Ug(_S(),AS()),t_=function(e){return{value:e}},n_=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,r_=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,i_=function(e){return n_.test(e)||r_.test(e)},o_=function(e){return ze(e,"#").toUpperCase()},a_=function(e){return i_(e)?N.some({value:o_(e)}):N.none()},s_=function(e){var t=e.value.replace(n_,(function(e,t,n,r){return t+t+n+n+r+r}));return{value:t}},l_=function(e){var t=s_(e),n=r_.exec(t.value);return null===n?["FFFFFF","FF","FF","FF"]:n},u_=function(e){var t=e.toString(16);return(1===t.length?"0"+t:t).toUpperCase()},c_=function(e){var t=u_(e.red)+u_(e.green)+u_(e.blue);return t_(t)},d_=Math.min,f_=Math.max,h_=Math.round,m_=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,p_=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,g_=function(e,t,n,r){return{red:e,green:t,blue:n,alpha:r}},v_=function(e){var t=parseInt(e,10);return t.toString()===e&&t>=0&&t<=255},b_=function(e){var t,n,r,i=(e.hue||0)%360,o=e.saturation/100,a=e.value/100;if(o=f_(0,d_(o,1)),a=f_(0,d_(a,1)),0===o)return t=n=r=h_(255*a),g_(t,n,r,1);var s=i/60,l=a*o,u=l*(1-Math.abs(s%2-1)),c=a-l;switch(Math.floor(s)){case 0:t=l,n=u,r=0;break;case 1:t=u,n=l,r=0;break;case 2:t=0,n=l,r=u;break;case 3:t=0,n=u,r=l;break;case 4:t=u,n=0,r=l;break;case 5:t=l,n=0,r=u;break;default:t=n=r=0}return t=h_(255*(t+c)),n=h_(255*(n+c)),r=h_(255*(r+c)),g_(t,n,r,1)},y_=function(e){var t=l_(e),n=parseInt(t[1],16),r=parseInt(t[2],16),i=parseInt(t[3],16);return g_(n,r,i,1)},w_=function(e,t,n,r){var i=parseInt(e,10),o=parseInt(t,10),a=parseInt(n,10),s=parseFloat(r);return g_(i,o,a,s)},S_=function(e){if("transparent"===e)return N.some(g_(0,0,0,0));var t=m_.exec(e);if(null!==t)return N.some(w_(t[1],t[2],t[3],"1"));var n=p_.exec(e);return null!==n?N.some(w_(n[1],n[2],n[3],n[4])):N.none()},x_=function(e){return"rgba("+e.red+","+e.green+","+e.blue+","+e.alpha+")"},C_=g_(255,0,0,1),T_=function(e){return e.fire("SkinLoaded")},D_=function(e,t){return e.fire("SkinLoadError",t)},k_=function(e){return e.fire("ResizeEditor")},E_=function(e,t){return e.fire("ResizeContent",t)},__=function(e,t){return e.fire("ScrollContent",t)},A_=function(e,t){return e.fire("TextColorChange",t)},L_=function(e,t,n){return{hue:e,saturation:t,value:n}},O_=function(e){var t=0,n=0,r=0,i=e.red/255,o=e.green/255,a=e.blue/255,s=Math.min(i,Math.min(o,a)),l=Math.max(i,Math.max(o,a));if(s===l)return r=s,L_(0,0,100*r);var u=i===s?o-a:a===s?i-o:a-i;return t=i===s?3:a===s?1:5,t=60*(t-u/(l-s)),n=(l-s)/l,r=l,L_(Math.round(t),Math.round(100*n),Math.round(100*r))},R_=function(e){return O_(y_(e))},I_=function(e){return c_(b_(e))},P_=function(e){return a_(e).orThunk((function(){return S_(e).map(c_)})).getOrThunk((function(){var t=document.createElement("canvas");t.height=1,t.width=1;var n=t.getContext("2d");n.clearRect(0,0,t.width,t.height),n.fillStyle="#FFFFFF",n.fillStyle=e,n.fillRect(0,0,1,1);var r=n.getImageData(0,0,1,1).data,i=r[0],o=r[1],a=r[2],s=r[3];return c_(g_(i,o,a,s))}))},M_=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),N_="tinymce-custom-colors";function F_(e){void 0===e&&(e=10);var t=M_.getItem(N_),n=o(t)?JSON.parse(t):[],r=function(t){var n=e-t.length;return n<0?t.slice(0,e):t},i=r(n),a=function(t){U(i,t).each(s),i.unshift(t),i.length>e&&i.pop(),M_.setItem(N_,JSON.stringify(i))},s=function(e){i.splice(e,1)},l=function(){return i.slice(0)};return{add:a,state:l}}var B_,$_="choiceitem",z_=[{type:$_,text:"Light Green",value:"#BFEDD2"},{type:$_,text:"Light Yellow",value:"#FBEEB8"},{type:$_,text:"Light Red",value:"#F8CAC6"},{type:$_,text:"Light Purple",value:"#ECCAFA"},{type:$_,text:"Light Blue",value:"#C2E0F4"},{type:$_,text:"Green",value:"#2DC26B"},{type:$_,text:"Yellow",value:"#F1C40F"},{type:$_,text:"Red",value:"#E03E2D"},{type:$_,text:"Purple",value:"#B96AD9"},{type:$_,text:"Blue",value:"#3598DB"},{type:$_,text:"Dark Turquoise",value:"#169179"},{type:$_,text:"Orange",value:"#E67E23"},{type:$_,text:"Dark Red",value:"#BA372A"},{type:$_,text:"Dark Purple",value:"#843FA1"},{type:$_,text:"Dark Blue",value:"#236FA1"},{type:$_,text:"Light Gray",value:"#ECF0F1"},{type:$_,text:"Medium Gray",value:"#CED4D9"},{type:$_,text:"Gray",value:"#95A5A6"},{type:$_,text:"Dark Gray",value:"#7E8C8D"},{type:$_,text:"Navy Blue",value:"#34495E"},{type:$_,text:"Black",value:"#000000"},{type:$_,text:"White",value:"#ffffff"}],U_=F_(10),V_=function(e){for(var t=[],n=0;n<e.length;n+=2)t.push({text:e[n+1],value:"#"+P_(e[n]).value,type:"choiceitem"});return t},H_=function(e,t){return e.getParam("color_cols",t,"number")},j_=function(e){return!1!==e.getParam("custom_colors")},q_=function(e){return e.getParam("color_map")},G_=function(e){var t=q_(e);return void 0!==t?V_(t):z_},W_=function(){return G(U_.state(),(function(e){return{type:$_,text:e,value:e}}))},K_=function(e){U_.add(e)},Y_="#000000",X_=function(e,t){var n;return e.dom.getParents(e.selection.getStart(),(function(e){var r;(r=e.style["forecolor"===t?"color":"background-color"])&&(n=n||r)})),N.from(n)},J_=function(e,t,n){e.undoManager.transact((function(){e.focus(),e.formatter.apply(t,{value:n}),e.nodeChanged()}))},Q_=function(e,t){e.undoManager.transact((function(){e.focus(),e.formatter.remove(t,{value:null},null,!0),e.nodeChanged()}))},Z_=function(e){e.addCommand("mceApplyTextcolor",(function(t,n){J_(e,t,n)})),e.addCommand("mceRemoveTextcolor",(function(t){Q_(e,t)}))},eA=function(e){return Math.max(5,Math.ceil(Math.sqrt(e)))},tA=function(e){var t=G_(e),n=eA(t.length);return H_(e,n)},nA=function(e){var t="choiceitem",n={type:t,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"},r={type:t,text:"Custom color",icon:"color-picker",value:"custom"};return e?[n,r]:[n]},rA=function(e,t,n,r){if("custom"===n){var i=uA(e);i((function(n){n.each((function(n){K_(n),e.execCommand("mceApplyTextcolor",t,n),r(n)}))}),Y_)}else"remove"===n?(r(""),e.execCommand("mceRemoveTextcolor",t)):(r(n),e.execCommand("mceApplyTextcolor",t,n))},iA=function(e,t){return e.concat(W_().concat(nA(t)))},oA=function(e,t){return function(n){n(iA(e,t))}},aA=function(e,t,n){var r="forecolor"===t?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color";e.setIconFill(r,n)},sA=function(e,t,n,r,i){e.ui.registry.addSplitButton(t,{tooltip:r,presets:"color",icon:"forecolor"===t?"text-color":"highlight-bg-color",select:function(t){var r=X_(e,n);return r.bind((function(e){return S_(e).map((function(e){var n=c_(e).value;return Ve(t.toLowerCase(),n)}))})).getOr(!1)},columns:tA(e),fetch:oA(G_(e),j_(e)),onAction:function(t){rA(e,n,i.get(),g)},onItemAction:function(r,o){rA(e,n,o,(function(n){i.set(n),A_(e,{name:t,color:n})}))},onSetup:function(n){aA(n,t,i.get());var r=function(e){e.name===t&&aA(n,e.name,e.color)};return e.on("TextColorChange",r),function(){e.off("TextColorChange",r)}}})},lA=function(e,t,n,r){e.ui.registry.addNestedMenuItem(t,{text:r,icon:"forecolor"===t?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(t){rA(e,n,t.value,g)}}]}})},uA=function(e){return function(t,n){var r=!1,i=function(n){var i=n.getData(),o=i.colorpicker;r?(t(N.from(o)),n.close()):e.windowManager.alert(e.translate(["Invalid hex color code: {0}",o]))},o=function(e,t){"hex-valid"===t.name&&(r=t.value)},a={colorpicker:n};e.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:a,onAction:o,onSubmit:i,onClose:g,onCancel:function(){t(N.none())}})}},cA=function(e){Z_(e);var t=ia(Y_),n=ia(Y_);sA(e,"forecolor","forecolor","Text color",t),sA(e,"backcolor","hilitecolor","Background color",n),lA(e,"forecolor","forecolor","Text color"),lA(e,"backcolor","hilitecolor","Background color")},dA=function(e,t,n,r,i,o,a,s){var l=RD(t),u="color"!==i?"normal":"color",c=fA(t,n,r,u,o,a,s);return MD(e,l,c,r,i)},fA=function(e,t,n,r,i,o,a){return Oe(G(e,(function(s){return"choiceitem"===s.type?GD(s).fold(ID,(function(l){return N.some(ZE(l,1===n,r,t,o(s.value),i,a,RD(e)))})):N.none()})))},hA=function(e,t){var n=xD(t);if(1===e)return{mode:"menu",moveOnTab:!0};if("auto"===e)return{mode:"grid",selector:"."+n.item,initSize:{numColumns:1,numRows:1}};var r="color"===t?"tox-swatches__row":"tox-collection__group";return{mode:"matrix",rowSelector:"."+r}},mA=function(e,t){return 1===e?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===e?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===t?".tox-swatches__row":".tox-collection__group",cell:"color"===t?"."+tD:"."+eD}}},pA=function(e,t){var n=gA(e,t),r=t.colorinput.getColorCols(),i="color",o=dA(il("menu-value"),n,(function(t){e.onAction({value:t})}),r,i,QT.CLOSE_ON_EXECUTE,k,t.shared.providers),a=A(A({},o),{markers:xD(i),movement:hA(r,i)});return{type:"widget",data:{value:il("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[e_.widget(zS.sketch(a))]}},gA=function(e,t){var n=e.initData.allowCustomColors&&t.colorinput.hasCustomColors();return e.initData.colors.fold((function(){return iA(t.colorinput.getColors(),n)}),(function(e){return e.concat(nA(n))}))},vA=il("cell-over"),bA=il("cell-execute"),yA=function(e,t,n){var r,i=function(n){return Cs(n,vA,{row:e,col:t})},o=function(n){return Cs(n,bA,{row:e,col:t})},a=function(e,t){t.stop(),o(e)};return Eu({dom:{tag:"div",attributes:(r={role:"button"},r["aria-labelledby"]=n,r)},behaviours:fd([Uw("insert-table-picker-cell",[Rs(Fa(),Xw.focus),Rs(ts(),o),Rs(ja(),a),Rs(rs(),a)]),pS.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),Xw.config({onFocus:i})])})},wA=function(e,t,n){for(var r=[],i=0;i<t;i++){for(var o=[],a=0;a<n;a++)o.push(yA(i,a,e));r.push(o)}return r},SA=function(e,t,n,r,i){for(var o=0;o<r;o++)for(var a=0;a<i;a++)pS.set(e[o][a],o<=t&&a<=n)},xA=function(e){return re(e,(function(e){return G(e,_u)}))},CA=function(e,t){return Cu(t+"x"+e)},TA=function(e){var t=10,n=10,r=il("size-label"),i=wA(r,t,n),o=CA(0,0),a=Ex({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:r}},components:[o],behaviours:fd([$w.config({})])});return{type:"widget",data:{value:il("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[e_.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:xA(i).concat(a.asSpec()),behaviours:fd([Uw("insert-table-picker",[Vs((function(e){$w.set(a.get(e),[o])})),Bs(vA,(function(e,r,o){var s=o.event,l=s.row,u=s.col;SA(i,l,u,t,n),$w.set(a.get(e),[CA(l+1,u+1)])})),Bs(bA,(function(t,n,r){var i=r.event,o=i.row,a=i.col;e.onAction({numRows:o+1,numColumns:a+1}),xs(t,os())}))]),Aw.config({initSize:{numRows:t,numColumns:n},mode:"flatgrid",selector:'[role="button"]'})])})]}},DA={inserttable:TA,colorswatch:pA},kA=function(e,t){return ke(DA,e.fancytype).map((function(n){return n(e,t)}))},EA=function(e,t,n,r,i){void 0===r&&(r=!0),void 0===i&&(i=!1);var o=i?zE(n.icons):$E(n.icons),a=function(e){return{isDisabled:function(){return Fv.isDisabled(e)},setDisabled:function(t){return Fv.set(e,t)}}},s=GE({presets:"normal",iconContent:e.icon,textContent:e.text,htmlContent:N.none(),ariaLabel:e.text,caret:N.some(o),checkMark:N.none(),shortcutContent:e.shortcut},n,r);return AE({data:LE(e),getApi:a,disabled:e.disabled,onAction:g,onSetup:e.onSetup,triggersSubmenu:!0,itemBehaviours:[]},s,t,n)},_A=function(e,t,n,r){void 0===r&&(r=!0);var i=function(e){return{isDisabled:function(){return Fv.isDisabled(e)},setDisabled:function(t){return Fv.set(e,t)}}},o=GE({presets:"normal",iconContent:e.icon,textContent:e.text,htmlContent:N.none(),ariaLabel:e.text,caret:N.none(),checkMark:N.none(),shortcutContent:e.shortcut},n,r);return AE({data:LE(e),getApi:i,disabled:e.disabled,onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:[]},o,t,n)},AA=function(e){var t=e.text.fold((function(){return{}}),(function(e){return{innerHtml:e}}));return{type:"separator",dom:A({tag:"div",classes:[eD,iD]},t),components:[]}},LA=function(e,t,n,r){void 0===r&&(r=!0);var i=function(e){return{setActive:function(t){pS.set(e,t)},isActive:function(){return pS.isOn(e)},isDisabled:function(){return Fv.isDisabled(e)},setDisabled:function(t){return Fv.set(e,t)}}},o=GE({iconContent:e.icon,textContent:e.text,htmlContent:N.none(),ariaLabel:e.text,checkMark:N.some(BE(n.icons)),caret:N.none(),shortcutContent:e.shortcut,presets:"normal",meta:e.meta},n,r);return Si(AE({data:LE(e),disabled:e.disabled,getApi:i,onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:[]},o,t,n),{toggling:{toggleClass:rD,toggleOnExecute:!1,selected:e.active}})},OA=XE,RA=AA,IA=_A,PA=EA,MA=LA,NA=kA,FA=QE;(function(e){e[e["ContentFocus"]=0]="ContentFocus",e[e["UiFocus"]=1]="UiFocus"})(B_||(B_={}));var BA=function(e,t,n,r,i){var o=n.shared.providers,a=function(e){return i?A(A({},e),{shortcut:N.none(),icon:e.text.isSome()?N.none():e.icon}):e};switch(e.type){case"menuitem":return ZD(e).fold(ID,(function(e){return N.some(IA(a(e),t,o,r))}));case"nestedmenuitem":return tk(e).fold(ID,(function(e){return N.some(PA(a(e),t,o,r,i))}));case"togglemenuitem":return rk(e).fold(ID,(function(e){return N.some(MA(a(e),t,o,r))}));case"separator":return ET(e).fold(ID,(function(e){return N.some(RA(e))}));case"fancymenuitem":return JD(e).fold(ID,(function(e){return NA(a(e),n)}));default:return console.error("Unknown item in general menu",e),N.none()}},$A=function(e,t,n,r,i,o,a){var s=1===r,l=!s||RD(e);return Oe(G(e,(function(e){switch(e.type){case"separator":return LT(e).fold(ID,(function(e){return N.some(RA(e))}));case"cardmenuitem":return jD(e).fold(ID,(function(e){return N.some(FA(A(A({},e),{onAction:function(t){e.onAction(t),n(e.value,e.meta)}}),i,o,{itemBehaviours:WE(e.meta,o),cardText:{matchText:t,highlightOn:a}}))}));case"autocompleteitem":default:return OT(e).fold(ID,(function(e){return N.some(OA(e,t,s,"normal",n,i,o,l))}))}})))},zA=function(e,t,n,r,i){var o=RD(t),a=Oe(G(t,(function(e){var t=function(e){return i?!Ee(e,"text"):o},a=function(e){return BA(e,n,r,t(e),i)};return"nestedmenuitem"===e.type&&e.getSubmenuItems().length<=0?a(A(A({},e),{disabled:!0})):a(e)}))),s=i?PD:MD;return s(e,o,a,1,"normal")},UA=function(e){return QS.singleData(e.value,e)},VA=function(e,t,n,r){var i=n===B_.ContentFocus?kb():Db(),o=hA(t,r),a=xD(r);return{dom:e.dom,components:e.components,items:e.items,value:e.value,markers:{selectedItem:a.selectedItem,item:a.item},movement:o,fakeFocus:n===B_.ContentFocus,focusManager:i,menuBehaviours:sk.unnamedEvents("auto"!==t?[]:[Vs((function(e,t){ik(e,4,a.item).each((function(t){var n=t.numColumns,r=t.numRows;Aw.setGridSize(e,r,n)}))}))])}},HA=function(e,t){var n=rf(),r=ia(!1),i=Eu(tx.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:fd([Uw("dismissAutocompleter",[Rs(ms(),(function(){return l()}))])]),lazySink:t.getSink})),o=function(){return tx.isOpen(i)},a=function(){return n.get().isSome()},s=function(){a()&&tx.hide(i)},l=function(){if(a()){var t=n.get().map((function(e){return e.element}));oT(t.getOr(tt.fromDom(e.selection.getNode()))).each(Nr),s(),n.clear(),r.set(!1)}},u=mt((function(){return XT(e)})),c=function(n,i){var o=me(i,(function(e){return N.from(e.columns)})).getOr(1);return re(i,(function(i){var a=i.items;return $A(a,i.matchText,(function(t,o){var a=e.selection.getRng();fT(e.dom,a,n).fold((function(){return console.error("Lost context. Cursor probably moved")}),(function(e){var n=e.range,a={hide:function(){l()},reload:function(e){s(),m(e)}};r.set(!0),i.onAction(a,n,t,o),r.set(!1)}))}),o,QT.BUBBLE_TO_SANDBOX,t,i.highlightOn)}))},d=function(t){if(!a()){var i=iT(e,t.range);n.set({triggerChar:t.triggerChar,element:i,matchLength:t.text.length}),r.set(!1)}},f=function(t,n,r,o){t.matchLength=n.text.length;var a=me(r,(function(e){return N.from(e.columns)})).getOr(1);tx.showAt(i,zS.sketch(VA(MD("autocompleter-value",!0,o,a,"normal"),a,B_.ContentFocus,"normal")),{anchor:{type:"node",root:tt.fromDom(e.getBody()),node:N.from(t.element)}}),tx.getContent(i).each(rb.highlightFirst)},h=function(t){return n.get().map((function(n){return fT(e.dom,e.selection.getRng(),n.triggerChar).bind((function(n){return DT(e,u,n,t)}))})).getOrThunk((function(){return TT(e,u)}))},m=function(e){h(e).fold(l,(function(e){d(e.context),e.lookupData.then((function(t){n.get().map((function(n){var r=e.context;if(n.triggerChar===r.triggerChar){var i=c(r.triggerChar,t);i.length>0?f(n,r,t,i):r.text.length-n.matchLength>=10?l():s()}}))}))}))},p=ZC((function(e){27!==e.which&&m()}),50),g={onKeypress:p,cancelIfNecessary:l,isMenuOpen:o,isActive:a,isProcessingAction:r.get,getView:function(){return tx.getContent(i)}};!1===e.hasPlugin("rtc")&&mT.setup(g,e)},jA={register:HA},qA=function(e,t,n){return $u(e,t,n).isSome()},GA=function(e,t){var n=null,r=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];n=setTimeout((function(){e.apply(null,r),n=null}),t)},i=function(){null!==n&&(clearTimeout(n),n=null)};return{cancel:i,schedule:r}},WA=5,KA=400,YA=function(e){var t=e.raw;return void 0===t.touches||1!==t.touches.length?N.none():N.some(t.touches[0])},XA=function(e,t){var n=Math.abs(e.clientX-t.x),r=Math.abs(e.clientY-t.y);return n>WA||r>WA},JA=function(e){var t=rf(),n=ia(!1),r=GA((function(t){e.triggerEvent(is(),t),n.set(!0)}),KA),i=function(e){return YA(e).each((function(i){r.cancel();var o={x:i.clientX,y:i.clientY,target:e.target};r.schedule(e),n.set(!1),t.set(o)})),N.none()},o=function(e){return r.cancel(),YA(e).each((function(e){t.on((function(n){XA(e,n)&&t.clear()}))})),N.none()},a=function(i){r.cancel();var o=function(e){return un(e.target,i.target)};return t.get().filter(o).map((function(t){return n.get()?(i.prevent(),!1):e.triggerEvent(rs(),i)}))},s=ma([{key:Aa(),value:i},{key:La(),value:o},{key:Oa(),value:a}]),l=function(e,t){return ke(s,t).bind((function(t){return t(e)}))};return{fireIfReady:l}},QA=function(e){var t=e.raw;return t.which===ib[0]&&!V(["input","textarea"],st(e.target))&&!qA(e.target,'[contenteditable="true"]')},ZA=function(){return tn().browser.isFirefox()},eL=function(e,t){return ZA()?sf(e,"focus",t):af(e,"focusin",t)},tL=function(e,t){return ZA()?sf(e,"blur",t):af(e,"focusout",t)},nL=function(e,t){var n=A({stopBackspace:!0},t),r=["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"],i=JA(n),o=G(r.concat(["selectstart","input","contextmenu","change","transitionend","transitioncancel","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),(function(t){return af(e,t,(function(e){i.fireIfReady(e,t).each((function(t){t&&e.kill()}));var r=n.triggerEvent(t,e);r&&e.kill()}))})),a=rf(),s=af(e,"paste",(function(e){i.fireIfReady(e,"paste").each((function(t){t&&e.kill()}));var t=n.triggerEvent("paste",e);t&&e.kill(),a.set(setTimeout((function(){n.triggerEvent(Za(),e)}),0))})),l=af(e,"keydown",(function(e){var t=n.triggerEvent("keydown",e);t?e.kill():n.stopBackspace&&QA(e)&&e.prevent()})),u=eL(e,(function(e){var t=n.triggerEvent("focusin",e);t&&e.kill()})),c=rf(),d=tL(e,(function(e){var t=n.triggerEvent("focusout",e);t&&e.kill(),c.set(setTimeout((function(){n.triggerEvent(Qa(),e)}),0))})),f=function(){W(o,(function(e){e.unbind()})),l.unbind(),u.unbind(),d.unbind(),s.unbind(),a.on(clearTimeout),c.on(clearTimeout)};return{unbind:f}},rL=function(e,t){var n=ke(e,"target").getOr(t);return ia(n)},iL=function(e,t){var n=ia(!1),r=ia(!1),i=function(){n.set(!0)},o=function(){r.set(!0)};return{stop:i,cut:o,isStopped:n.get,isCut:r.get,event:e,setSource:t.set,getSource:t.get}},oL=function(e){var t=ia(!1),n=function(){t.set(!0)};return{stop:n,cut:g,isStopped:t.get,isCut:k,event:e,setSource:D("Cannot set source of a broadcasted event"),getSource:D("Cannot get source of a broadcasted event")}},aL=aa.generate([{stopped:[]},{resume:["element"]},{complete:[]}]),sL=function(e,t,n,r,i,o){var a=e(t,r),s=iL(n,i);return a.fold((function(){return o.logEventNoHandlers(t,r),aL.complete()}),(function(e){var n=e.descHandler,r=Fl(n);return r(s),s.isStopped()?(o.logEventStopped(t,e.element,n.purpose),aL.stopped()):s.isCut()?(o.logEventCut(t,e.element,n.purpose),aL.complete()):vn(e.element).fold((function(){return o.logNoParent(t,e.element,n.purpose),aL.complete()}),(function(r){return o.logEventResponse(t,e.element,n.purpose),aL.resume(r)}))}))},lL=function(e,t,n,r,i,o){return sL(e,t,n,r,i,o).fold(E,(function(r){return lL(e,t,n,r,i,o)}),k)},uL=function(e,t,n,r,i){var o=rL(n,r);return sL(e,t,n,r,o,i)},cL=function(e,t,n){var r=oL(t);return W(e,(function(e){var t=e.descHandler,n=Fl(t);n(r)})),r.isStopped()},dL=function(e,t,n,r){return fL(e,t,n,n.target,r)},fL=function(e,t,n,r,i){var o=rL(n,r);return lL(e,t,n,r,o,i)},hL=function(e,t){return{element:e,descHandler:t}},mL=function(e,t){return{id:e,descHandler:t}},pL=function(){var e={},t=function(t,n,r){ve(r,(function(r,i){var o=void 0!==e[i]?e[i]:{};o[n]=Nl(r,t),e[i]=o}))},n=function(e,t){return dl(t).bind((function(t){return ke(e,t)})).map((function(e){return hL(t,e)}))},r=function(t){return ke(e,t).map((function(e){return Ce(e,(function(e,t){return mL(t,e)}))})).getOr([])},i=function(t,r,i){return ke(e,r).bind((function(e){return wa(i,(function(t){return n(e,t)}),t)}))},o=function(t){ve(e,(function(e,n){Ee(e,t)&&delete e[t]}))};return{registerId:t,unregisterId:o,filterByType:r,find:i}},gL=function(){var e=pL(),t={},n=function(e){var t=e.element;return dl(t).getOrThunk((function(){return ul("uid-",e.element)}))},r=function(e,n){var r=t[n];if(r!==e)throw new Error('The tagId "'+n+'" is already used by: '+Zs(r.element)+"\nCannot use it for: "+Zs(e.element)+"\nThe conflicting element is"+(Nn(r.element)?" ":" not ")+"already in the DOM");o(e)},i=function(i){var o=n(i);_e(t,o)&&r(i,o);var a=[i];e.registerId(a,o,i.events),t[o]=i},o=function(n){dl(n.element).each((function(n){delete t[n],e.unregisterId(n)}))},a=function(t){return e.filterByType(t)},s=function(t,n,r){return e.find(t,n,r)},l=function(e){return ke(t,e)};return{find:s,filter:a,register:i,unregister:o,getById:l}},vL=function(e){var t=e.dom,n=t.attributes,r=L(t,["attributes"]);return{uid:e.uid,dom:A({tag:"div",attributes:A({role:"presentation"},n)},r),components:e.components,behaviours:ng(e.containerBehaviours),events:e.events,domModification:e.domModification,eventOrder:e.eventOrder}},bL=fv({name:"Container",factory:vL,configFields:[Ko("components",[]),tg("containerBehaviours",[]),Ko("events",{}),Ko("domModification",{}),Ko("eventOrder",{})]}),yL=function(e){var t=function(t){return vn(e.element).fold(E,(function(e){return un(t,e)}))},n=gL(),r=function(e,r){return n.find(t,e,r)},i=nL(e.element,{triggerEvent:function(e,t){return Ju(e,t.target,(function(n){return dL(r,e,t,n)}))}}),o={debugInfo:w("real"),triggerEvent:function(e,t,n){Ju(e,t,(function(i){return fL(r,e,n,t,i)}))},triggerFocus:function(e,t){dl(e).fold((function(){xd(e)}),(function(n){Ju(Ja(),e,(function(n){return uL(r,Ja(),{originator:t,kill:g,prevent:g,target:e},e,n),!1}))}))},triggerEscape:function(e,t){o.triggerEvent("keydown",e.element,t.event)},getByUid:function(e){return p(e)},getByDom:function(e){return v(e)},build:Eu,addToGui:function(e){l(e)},removeFromGui:function(e){u(e)},addToWorld:function(e){a(e)},removeFromWorld:function(e){s(e)},broadcast:function(e){f(e)},broadcastOn:function(e,t){h(e,t)},broadcastEvent:function(e,t){m(e,t)},isConnected:E},a=function(e){e.connect(o),dt(e.element)||(n.register(e),W(e.components(),a),o.triggerEvent(ss(),e.element,{target:e.element}))},s=function(e){dt(e.element)||(W(e.components(),s),n.unregister(e)),e.disconnect()},l=function(t){jm(e,t)},u=function(e){Wm(e)},c=function(){i.unbind(),Mr(e.element)},d=function(e){var t=n.filter(es());W(t,(function(t){var n=t.descHandler,r=Fl(n);r(e)}))},f=function(e){d({universal:!0,data:e})},h=function(e,t){d({universal:!1,channels:e,data:t})},m=function(e,t){var r=n.filter(e);return cL(r,t)},p=function(e){return n.getById(e).fold((function(){return ri.error(new Error('Could not find component with uid: "'+e+'" in system.'))}),ri.value)},v=function(e){var t=dl(e).getOr("not found");return p(t)};return a(e),{root:e,element:e.element,destroy:c,add:l,remove:u,getByUid:p,getByDom:v,addToWorld:a,removeFromWorld:s,broadcast:f,broadcastOn:h,broadcastEvent:m}},wL=function(e,t){return{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:G(e.items,t.interpreter)}},SL=w([Ko("prefix","form-field"),tg("fieldBehaviours",[bv,eg])]),xL=w([Mg({schema:[Ao("dom")],name:"label"}),Mg({factory:{sketch:function(e){return{uid:e.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:e.text}}}},schema:[Ao("text")],name:"aria-descriptor"}),Ig({factory:{sketch:function(e){var t=fa(e,["factory"]);return e.factory.sketch(t)}},schema:[Ao("factory")],name:"field"})]),CL=function(e,t,n,r){var i=rg(e.fieldBehaviours,[bv.config({find:function(t){return Kg(t,e,"field")}}),eg.config({store:{mode:"manual",getValue:function(e){return bv.getCurrent(e).bind(eg.getValue)},setValue:function(e,t){bv.getCurrent(e).each((function(e){eg.setValue(e,t)}))}}})]),o=_s([Vs((function(t,n){var r=Xg(t,e,["label","field","aria-descriptor"]);r.field().each((function(t){var n=il(e.prefix);r.label().each((function(e){zn(e.element,"for",n),zn(t.element,"id",n)})),r["aria-descriptor"]().each((function(n){var r=il(e.prefix);zn(n.element,"id",r),zn(t.element,"aria-describedby",r)}))}))}))]),a={getField:function(t){return Kg(t,e,"field")},getLabel:function(t){return Kg(t,e,"label")}};return{uid:e.uid,dom:e.dom,components:t,behaviours:i,events:o,apis:a}},TL=hv({name:"FormField",configFields:SL(),partFields:xL(),factory:CL,apis:{getField:function(e,t){return e.getField(t)},getLabel:function(e,t){return e.getLabel(t)}}}),DL=function(e,t){return Ll({attributes:ma([{key:t.tabAttr,value:"true"}])})},kL=Object.freeze({__proto__:null,exhibit:DL}),EL=[Ko("tabAttr","data-alloy-tabstop")],_L=md({fields:EL,name:"tabstopping",active:kL}),AL=tinymce.util.Tools.resolve("tinymce.html.Entities"),LL=function(e,t,n,r){var i=RL(e,t,n,r);return TL.sketch(i)},OL=function(e,t){return LL(e,t,[],[])},RL=function(e,t,n,r){return{dom:PL(n),components:e.toArray().concat([t]),fieldBehaviours:fd(r)}},IL=function(){return PL([])},PL=function(e){return{tag:"div",classes:["tox-form__group"].concat(e)}},ML=function(e,t){return TL.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:t.translate(e)}})},NL=il("form-component-change"),FL=il("form-close"),BL=il("form-cancel"),$L=il("form-action"),zL=il("form-submit"),UL=il("form-block"),VL=il("form-unblock"),HL=il("form-tabchange"),jL=il("form-resize"),qL=function(e,t){var n,r=e.label.map((function(e){return ML(e,t)})),i=function(e){return function(t,n){$u(n.event.target,"[data-collection-item-value]").each((function(r){e(t,n,r,Vn(r,"data-collection-item-value"))}))}},o=function(n,r){var i=G(r,(function(n){var r=PC.translate(n.text),i=1===e.columns?'<div class="tox-collection__item-label">'+r+"</div>":"",o='<div class="tox-collection__item-icon">'+n.icon+"</div>",a={_:" "," - ":" ","-":" "},s=r.replace(/\_| \- |\-/g,(function(e){return a[e]})),l=t.isDisabled()?" tox-collection__item--state-disabled":"";return'<div class="tox-collection__item'+l+'" tabindex="-1" data-collection-item-value="'+AL.encodeAllRaw(n.value)+'" title="'+s+'" aria-label="'+s+'">'+o+i+"</div>"})),o="auto"!==e.columns&&e.columns>1?q(i,e.columns):[i],a=G(o,(function(e){return'<div class="tox-collection__group">'+e.join("")+"</div>"}));Ks(n.element,a.join(""))},a=i((function(n,r,i,o){r.stop(),t.isDisabled()||Cs(n,$L,{name:e.name,value:o})})),s=[Rs(Fa(),i((function(e,t,n){xd(n)}))),Rs(ja(),a),Rs(rs(),a),Rs(Ba(),i((function(e,t,n){Bu(e.element,"."+cD).each((function(e){su(e,cD)})),ou(n,cD)}))),Rs($a(),i((function(e){Bu(e.element,"."+cD).each((function(e){su(e,cD)}))}))),qs(i((function(t,n,r,i){Cs(t,$L,{name:e.name,value:i})})))],l=function(e,t){return G(Yh(e.element,".tox-collection__item"),t)},u=TL.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==e.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:S},behaviours:fd([Fv.config({disabled:t.isDisabled,onDisabled:function(e){l(e,(function(e){ou(e,"tox-collection__item--state-disabled"),zn(e,"aria-disabled",!0)}))},onEnabled:function(e){l(e,(function(e){su(e,"tox-collection__item--state-disabled"),qn(e,"aria-disabled")}))}}),vE(),$w.config({}),eg.config({store:{mode:"memory",initialValue:[]},onSetValue:function(t,n){o(t,n),"auto"===e.columns&&ik(t,5,"tox-collection__item").each((function(e){var n=e.numRows,r=e.numColumns;Aw.setGridSize(t,n,r)})),xs(t,jL)}}),_L.config({}),Aw.config(mA(e.columns,"normal")),Uw("collection-events",s)]),eventOrder:(n={},n[ts()]=["disabling","alloy.base.behaviour","collection-events"],n)}),c=["tox-form__group--collection"];return LL(r,u,c,[])},GL=w([zo("data"),Ko("inputAttributes",{}),Ko("inputStyles",{}),Ko("tag","input"),Ko("inputClasses",[]),sc("onSetValue"),Ko("styles",{}),Ko("eventOrder",{}),tg("inputBehaviours",[eg,Xw]),Ko("selectOnFocus",!0)]),WL=function(e){return fd([Xw.config({onFocus:e.selectOnFocus?function(e){var t=e.element,n=fu(t);t.dom.setSelectionRange(0,n.length)}:g})])},KL=function(e){return A(A({},WL(e)),rg(e.inputBehaviours,[eg.config({store:A(A({mode:"manual"},e.data.map((function(e){return{initialValue:e}})).getOr({})),{getValue:function(e){return fu(e.element)},setValue:function(e,t){var n=fu(e.element);n!==t&&hu(e.element,t)}}),onSetValue:e.onSetValue})]))},YL=function(e){return{tag:e.tag,attributes:A({type:"text"},e.inputAttributes),styles:e.inputStyles,classes:e.inputClasses}},XL=function(e,t){return{uid:e.uid,dom:YL(e),components:[],behaviours:KL(e),eventOrder:e.eventOrder}},JL=fv({name:"Input",configFields:GL(),factory:XL}),QL={},ZL={exports:QL};(function(t,n,r,i){(function(e,i){"object"===typeof n&&"undefined"!==typeof r?r.exports=i():"function"===typeof t&&t.amd?t(i):(e="undefined"!==typeof globalThis?globalThis:e||self,e.EphoxContactWrapper=i())})(this,(function(){var t="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof e?e:"undefined"!==typeof self?self:{},n={exports:{}};(function(e){(function(t){var n=setTimeout;function r(){}function i(e,t){return function(){e.apply(t,arguments)}}function o(e){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],d(e,this)}function a(e,t){while(3===e._state)e=e._value;0!==e._state?(e._handled=!0,o._immediateFn((function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var r;try{r=n(e._value)}catch(i){return void l(t.promise,i)}s(t.promise,r)}else(1===e._state?s:l)(t.promise,e._value)}))):e._deferreds.push(t)}function s(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"===typeof t||"function"===typeof t)){var n=t.then;if(t instanceof o)return e._state=3,e._value=t,void u(e);if("function"===typeof n)return void d(i(n,t),e)}e._state=1,e._value=t,u(e)}catch(r){l(e,r)}}function l(e,t){e._state=2,e._value=t,u(e)}function u(e){2===e._state&&0===e._deferreds.length&&o._immediateFn((function(){e._handled||o._unhandledRejectionFn(e._value)}));for(var t=0,n=e._deferreds.length;t<n;t++)a(e,e._deferreds[t]);e._deferreds=null}function c(e,t,n){this.onFulfilled="function"===typeof e?e:null,this.onRejected="function"===typeof t?t:null,this.promise=n}function d(e,t){var n=!1;try{e((function(e){n||(n=!0,s(t,e))}),(function(e){n||(n=!0,l(t,e))}))}catch(r){if(n)return;n=!0,l(t,r)}}o.prototype["catch"]=function(e){return this.then(null,e)},o.prototype.then=function(e,t){var n=new this.constructor(r);return a(this,new c(e,t,n)),n},o.all=function(e){var t=Array.prototype.slice.call(e);return new o((function(e,n){if(0===t.length)return e([]);var r=t.length;function i(o,a){try{if(a&&("object"===typeof a||"function"===typeof a)){var s=a.then;if("function"===typeof s)return void s.call(a,(function(e){i(o,e)}),n)}t[o]=a,0===--r&&e(t)}catch(l){n(l)}}for(var o=0;o<t.length;o++)i(o,t[o])}))},o.resolve=function(e){return e&&"object"===typeof e&&e.constructor===o?e:new o((function(t){t(e)}))},o.reject=function(e){return new o((function(t,n){n(e)}))},o.race=function(e){return new o((function(t,n){for(var r=0,i=e.length;r<i;r++)e[r].then(t,n)}))},o._immediateFn="function"===typeof setImmediate?function(e){setImmediate(e)}:function(e){n(e,0)},o._unhandledRejectionFn=function(e){"undefined"!==typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},o._setImmediateFn=function(e){o._immediateFn=e},o._setUnhandledRejectionFn=function(e){o._unhandledRejectionFn=e},e.exports?e.exports=o:t.Promise||(t.Promise=o)})(t)})(n);var r=n.exports,i=function(){return"undefined"!==typeof window?window:Function("return this;")()}(),o={boltExport:i.Promise||r};return o}))})(void 0,QL,ZL);var eO,tO=ZL.exports.boltExport,nO=function(e){var t=N.none(),n=[],r=function(e){return nO((function(t){i((function(n){t(e(n))}))}))},i=function(e){a()?l(e):n.push(e)},o=function(e){a()||(t=N.some(e),s(n),n=[])},a=function(){return t.isSome()},s=function(e){W(e,l)},l=function(e){t.each((function(t){setTimeout((function(){e(t)}),0)}))};return e(o),{get:i,map:r,isReady:a}},rO=function(e){return nO((function(t){t(e)}))},iO={nu:nO,pure:rO},oO=function(e){setTimeout((function(){throw e}),0)},aO=function(e){var t=function(t){e().then(t,oO)},n=function(t){return aO((function(){return e().then(t)}))},r=function(t){return aO((function(){return e().then((function(e){return t(e).toPromise()}))}))},i=function(t){return aO((function(){return e().then((function(){return t.toPromise()}))}))},o=function(){return iO.nu(t)},a=function(){var t=null;return aO((function(){return null===t&&(t=e()),t}))},s=e;return{map:n,bind:r,anonBind:i,toLazy:o,toCached:a,toPromise:s,get:t}},sO=function(e){return aO((function(){return new tO(e)}))},lO=function(e){return aO((function(){return tO.resolve(e)}))},uO={nu:sO,pure:lO},cO=["input","textarea"],dO=function(e){var t=st(e);return V(cO,t)},fO=function(e,t){var n=t.getRoot(e).getOr(e.element);su(n,t.invalidClass),t.notify.each((function(t){dO(e.element)&&zn(e.element,"aria-invalid",!1),t.getContainer(e).each((function(e){Ks(e,t.validHtml)})),t.onValid(e)}))},hO=function(e,t,n,r){var i=t.getRoot(e).getOr(e.element);ou(i,t.invalidClass),t.notify.each((function(t){dO(e.element)&&zn(e.element,"aria-invalid",!0),t.getContainer(e).each((function(e){Ks(e,r)})),t.onInvalid(e,r)}))},mO=function(e,t,n){return t.validator.fold((function(){return uO.pure(ri.value(!0))}),(function(t){return t.validate(e)}))},pO=function(e,t,n){return t.notify.each((function(t){t.onValidate(e)})),mO(e,t).map((function(r){return e.getSystem().isConnected()?r.fold((function(r){return hO(e,t,n,r),ri.error(r)}),(function(n){return fO(e,t),ri.value(n)})):ri.error("No longer in system")}))},gO=function(e,t){var n=t.getRoot(e).getOr(e.element);return lu(n,t.invalidClass)},vO=Object.freeze({__proto__:null,markValid:fO,markInvalid:hO,query:mO,run:pO,isInvalid:gO}),bO=function(e,t){return e.validator.map((function(n){return _s([Rs(n.onEvent,(function(n){pO(n,e,t).get(S)}))].concat(n.validateOnLoad?[Vs((function(n){pO(n,e,t).get(g)}))]:[]))})).getOr({})},yO=Object.freeze({__proto__:null,events:bO}),wO=[Ao("invalidClass"),Ko("getRoot",N.none),Go("notify",[Ko("aria","alert"),Ko("getContainer",N.none),Ko("validHtml",""),sc("onValid"),sc("onInvalid"),sc("onValidate")]),Go("validator",[Ao("validate"),Ko("onEvent","input"),Ko("validateOnLoad",!0)])],SO=md({fields:wO,name:"invalidating",active:yO,apis:vO,extra:{validation:function(e){return function(t){var n=eg.getValue(t);return uO.pure(e(n))}}}}),xO=function(e,t,n,r){return n.getOrCreate(e,t,r)},CO=Object.freeze({__proto__:null,getCoupled:xO}),TO=[Lo("others",bo(ri.value,oo()))],DO=function(){var e={},t=function(t,n,r){var i=pe(n.others);if(i)return ke(e,r).getOrThunk((function(){var i=ke(n.others,r).getOrDie("No information found for coupled component: "+r),o=i(t),a=t.getSystem().build(o);return e[r]=a,a}));throw new Error("Cannot find coupled component: "+r+". Known coupled components: "+JSON.stringify(i,null,2))},n=w({});return Dl({readState:n,getOrCreate:t})},kO=Object.freeze({__proto__:null,init:DO}),EO=md({fields:TO,name:"coupling",apis:CO,state:kO}),_O=w("sink"),AO=w(Mg({name:_O(),overrides:w({dom:{tag:"div"},behaviours:fd([Bm.config({useFixed:E})]),events:_s([$s(za()),$s(Ia()),$s(ja())])})}));(function(e){e[e["HighlightFirst"]=0]="HighlightFirst",e[e["HighlightNone"]=1]="HighlightNone"})(eO||(eO={}));var LO,OO=function(e,t){var n=e.getHotspot(t).getOr(t),r="hotspot",i=e.getAnchorOverrides();return e.layouts.fold((function(){return{type:r,hotspot:n,overrides:i}}),(function(e){return{type:r,hotspot:n,overrides:i,layouts:e}}))},RO=function(e,t,n){var r=e.fetch;return r(n).map(t)},IO=function(e,t,n,r,i,o,a){var s=RO(e,t,r),l=BO(r,e);return s.map((function(e){return e.bind((function(e){return N.from(QS.sketch(A(A({},o.menu()),{uid:fl(""),data:e,highlightImmediately:a===eO.HighlightFirst,onOpenMenu:function(e,t){var r=l().getOrDie();Bm.position(r,t,{anchor:n}),bp.decloak(i)},onOpenSubmenu:function(e,t,n){var r=l().getOrDie();Bm.position(r,n,{anchor:{type:"submenu",item:t}}),bp.decloak(i)},onRepositionMenu:function(e,t,r){var i=l().getOrDie();Bm.position(i,t,{anchor:n}),W(r,(function(e){Bm.position(i,e.triggeredMenu,{anchor:{type:"submenu",item:e.triggeringItem}})}))},onEscape:function(){return Xw.focus(r),bp.close(i),N.some(!0)}})))}))}))},PO=function(e,t,n,r,i,o,a){var s=OO(e,n),l=IO(e,t,s,n,r,i,a);return l.map((function(e){return e.fold((function(){bp.isOpen(r)&&bp.close(r)}),(function(e){bp.cloak(r),bp.open(r,e),o(r)})),r}))},MO=function(e,t,n,r,i,o,a){return bp.close(r),uO.pure(r)},NO=function(e,t,n,r,i,o){var a=EO.getCoupled(n,"sandbox"),s=bp.isOpen(a),l=s?MO:PO;return l(e,t,n,a,r,i,o)},FO=function(e,t,n){var r=bv.getCurrent(t).getOr(t),i=vr(e.element);n?Kn(r.element,"min-width",i+"px"):gr(r.element,i)},BO=function(e,t){return e.getSystem().getByUid(t.uid+"-"+_O()).map((function(e){return function(){return ri.value(e)}})).getOrThunk((function(){return t.lazySink.fold((function(){return function(){return ri.error(new Error("No internal sink is specified, nor could an external sink be found"))}}),(function(t){return function(){return t(e)}}))}))},$O=function(e){bp.getState(e).each((function(e){QS.repositionMenus(e)}))},zO=function(e,t,n){var r=Uu(),i=function(i,o){var a=OO(e,t);r.link(t.element),e.matchWidth&&FO(a.hotspot,o,e.useMinWidth),e.onOpen(a,i,o),void 0!==n&&void 0!==n.onOpen&&n.onOpen(i,o)},o=function(e,i){r.unlink(t.element),void 0!==n&&void 0!==n.onClose&&n.onClose(e,i)},a=BO(t,e);return{dom:{tag:"div",classes:e.sandboxClasses,attributes:{id:r.id,role:"listbox"}},behaviours:ig.augment(e.sandboxBehaviours,[eg.config({store:{mode:"memory",initialValue:t}}),bp.config({onOpen:i,onClose:o,isPartOf:function(e,n,r){return Hu(n,r)||Hu(t,r)},getAttachPoint:function(){return a().getOrDie()}}),bv.config({find:function(e){return bp.getState(e).bind((function(e){return bv.getCurrent(e)}))}}),bd.config({channels:A(A({},Cp({isExtraPart:k})),Dp({doReposition:$O}))})])}},UO=function(e){var t=EO.getCoupled(e,"sandbox");$O(t)},VO=function(){return[Ko("sandboxClasses",[]),ig.field("sandboxBehaviours",[bv,bd,bp,eg])]},HO=w([Ao("dom"),Ao("fetch"),sc("onOpen"),lc("onExecute"),Ko("getHotspot",N.some),Ko("getAnchorOverrides",w({})),$f(),tg("dropdownBehaviours",[pS,EO,Aw,Xw]),Ao("toggleClass"),Ko("eventOrder",{}),zo("lazySink"),Ko("matchWidth",!1),Ko("useMinWidth",!1),zo("role")].concat(VO())),jO=w([Pg({schema:[ic()],name:"menu",defaults:function(e){return{onExecute:e.onExecute}}}),AO()]),qO=function(e,t,n,r){var i,o=function(t){return ke(e.dom,"attributes").bind((function(e){return ke(e,t)}))},a=function(e){bp.getState(e).each((function(e){QS.highlightPrimary(e)}))},s=function(t){var n=a;NO(e,S,t,r,n,eO.HighlightFirst).get(g)},l={expand:function(t){pS.isOn(t)||NO(e,S,t,r,g,eO.HighlightNone).get(g)},open:function(t){pS.isOn(t)||NO(e,S,t,r,g,eO.HighlightFirst).get(g)},isOpen:pS.isOn,close:function(t){pS.isOn(t)&&NO(e,S,t,r,g,eO.HighlightFirst).get(g)},repositionMenus:function(e){pS.isOn(e)&&UO(e)}},u=function(e,t){return Ts(e),N.some(!0)};return{uid:e.uid,dom:e.dom,components:t,behaviours:rg(e.dropdownBehaviours,[pS.config({toggleClass:e.toggleClass,aria:{mode:"expanded"}}),EO.config({others:{sandbox:function(t){return zO(e,t,{onOpen:function(){return pS.on(t)},onClose:function(){return pS.off(t)}})}}}),Aw.config({mode:"special",onSpace:u,onEnter:u,onDown:function(e,t){if(GO.isOpen(e)){var n=EO.getCoupled(e,"sandbox");a(n)}else GO.open(e);return N.some(!0)},onEscape:function(e,t){return GO.isOpen(e)?(GO.close(e),N.some(!0)):N.none()}}),Xw.config({})]),events:vS(N.some(s)),eventOrder:A(A({},e.eventOrder),(i={},i[ts()]=["disabling","toggling","alloy.base.behaviour"],i)),apis:l,domModification:{attributes:A(A({"aria-haspopup":"true"},e.role.fold((function(){return{}}),(function(e){return{role:e}}))),"button"===e.dom.tag?{type:o("type").getOr("button")}:{})}}},GO=hv({name:"Dropdown",configFields:HO(),partFields:jO(),factory:qO,apis:{open:function(e,t){return e.open(t)},expand:function(e,t){return e.expand(t)},close:function(e,t){return e.close(t)},isOpen:function(e,t){return e.isOpen(t)},repositionMenus:function(e,t){return e.repositionMenus(t)}}}),WO=function(){return Ll({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})},KO=function(){return _s([As(Ka(),E)])},YO=Object.freeze({__proto__:null,events:KO,exhibit:WO}),XO=md({fields:[],name:"unselecting",active:YO}),JO=function(e,t){return GO.sketch({dom:e.dom,components:e.components,toggleClass:"mce-active",dropdownBehaviours:fd([xE.button(t.providers.isDisabled),vE(),XO.config({}),_L.config({})]),layouts:e.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:t.getSink,fetch:function(n){return uO.nu((function(t){return e.fetch(t)})).map((function(r){return N.from(UA(Si(dA(il("menu-value"),r,(function(t){e.onItemAction(n,t)}),e.columns,e.presets,QT.CLOSE_ON_EXECUTE,k,t.providers),{movement:hA(e.columns,e.presets)})))}))},parts:{menu:DD(!1,1,e.presets)}})},QO=il("color-input-change"),ZO=il("color-swatch-change"),eR=il("color-picker-cancel"),tR=function(e,t,n){var r=TL.parts.field({factory:JL,inputClasses:["tox-textfield"],onSetValue:function(e){return SO.run(e).get(g)},inputBehaviours:fd([Fv.config({disabled:t.providers.isDisabled}),vE(),_L.config({}),SO.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(e){return vn(e.element)},notify:{onValid:function(e){var t=eg.getValue(e);Cs(e,QO,{color:t})}},validator:{validateOnLoad:!1,validate:function(e){var t=eg.getValue(e);if(0===t.length)return uO.pure(ri.value(!0));var n=tt.fromTag("span");Kn(n,"background-color",t);var r=Zn(n,"background-color").fold((function(){return ri.error("blah")}),(function(e){return ri.value(t)}));return uO.pure(r)}}})]),selectOnFocus:!1}),i=e.label.map((function(e){return ML(e,t.providers)})),o=function(e,t){Cs(e,ZO,{value:t})},a=function(e,t){s.getOpt(e).each((function(e){"custom"===t?n.colorPicker((function(t){t.fold((function(){return xs(e,eR)}),(function(t){o(e,t),K_(t)}))}),"#ffffff"):o(e,"remove"===t?"":t)}))},s=Ex(JO({dom:{tag:"span",attributes:{"aria-label":t.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[Vc,Uc,Gc]},onLtr:function(){return[Uc,Vc,Gc]}},components:[],fetch:oA(n.getColors(),n.hasCustomColors()),columns:n.getColorCols(),presets:"color",onItemAction:a},t));return TL.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:i.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[r,s.asSpec()]}]),fieldBehaviours:fd([Uw("form-field-events",[Rs(QO,(function(t,n){s.getOpt(t).each((function(e){Kn(e.element,"background-color",n.event.color)})),Cs(t,NL,{name:e.name})})),Rs(ZO,(function(e,t){TL.getField(e).each((function(n){eg.setValue(n,t.event.value),bv.getCurrent(e).each(Xw.focus)}))})),Rs(eR,(function(e,t){TL.getField(e).each((function(t){bv.getCurrent(e).each(Xw.focus)}))}))])])})},nR=Mg({schema:[Ao("dom")],name:"label"}),rR=function(e){return Mg({name:e+"-edge",overrides:function(t){var n=t.model.manager.edgeActions[e];return n.fold((function(){return{}}),(function(e){return{events:_s([Is(Aa(),(function(t,n,r){return e(t,r)}),[t]),Is(Ia(),(function(t,n,r){return e(t,r)}),[t]),Is(Pa(),(function(t,n,r){r.mouseIsDown.get()&&e(t,r)}),[t])])}}))}})},iR=rR("top-left"),oR=rR("top"),aR=rR("top-right"),sR=rR("right"),lR=rR("bottom-right"),uR=rR("bottom"),cR=rR("bottom-left"),dR=rR("left"),fR=Ig({name:"thumb",defaults:w({dom:{styles:{position:"absolute"}}}),overrides:function(e){return{events:_s([Fs(Aa(),e,"spectrum"),Fs(La(),e,"spectrum"),Fs(Oa(),e,"spectrum"),Fs(Ia(),e,"spectrum"),Fs(Pa(),e,"spectrum"),Fs(Na(),e,"spectrum")])}}}),hR=Ig({schema:[Eo("mouseIsDown",(function(){return ia(!1)}))],name:"spectrum",overrides:function(e){var t=e.model,n=t.manager,r=function(t,r){return n.getValueFromEvent(r).map((function(r){return n.setValueFrom(t,e,r)}))};return{behaviours:fd([Aw.config({mode:"special",onLeft:function(t){return n.onLeft(t,e)},onRight:function(t){return n.onRight(t,e)},onUp:function(t){return n.onUp(t,e)},onDown:function(t){return n.onDown(t,e)}}),Xw.config({})]),events:_s([Rs(Aa(),r),Rs(La(),r),Rs(Ia(),r),Rs(Pa(),(function(t,n){e.mouseIsDown.get()&&r(t,n)}))])}}}),mR=[nR,dR,sR,oR,uR,iR,aR,cR,lR,fR,hR],pR="slider.change.value",gR=w(pR),vR=function(e){return-1!==e.type.indexOf("touch")},bR=function(e){var t=e.event.raw;if(vR(t)){var n=t;return void 0!==n.touches&&1===n.touches.length?N.some(n.touches[0]).map((function(e){return cr(e.clientX,e.clientY)})):N.none()}var r=t;return void 0!==r.clientX?N.some(r).map((function(e){return cr(e.clientX,e.clientY)})):N.none()},yR="top",wR="right",SR="bottom",xR="left",CR=function(e){return e.model.minX},TR=function(e){return e.model.minY},DR=function(e){return e.model.minX-1},kR=function(e){return e.model.minY-1},ER=function(e){return e.model.maxX},_R=function(e){return e.model.maxY},AR=function(e){return e.model.maxX+1},LR=function(e){return e.model.maxY+1},OR=function(e,t,n){return t(e)-n(e)},RR=function(e){return OR(e,ER,CR)},IR=function(e){return OR(e,_R,TR)},PR=function(e){return RR(e)/2},MR=function(e){return IR(e)/2},NR=function(e){return e.stepSize},FR=function(e){return e.snapToGrid},BR=function(e){return e.snapStart},$R=function(e){return e.rounded},zR=function(e,t){return void 0!==e[t+"-edge"]},UR=function(e){return zR(e,xR)},VR=function(e){return zR(e,wR)},HR=function(e){return zR(e,yR)},jR=function(e){return zR(e,SR)},qR=function(e){return e.model.value.get()},GR=function(e){return{x:e}},WR=function(e){return{y:e}},KR=function(e,t){return{x:e,y:t}},YR=function(e,t){Cs(e,gR(),{value:t})},XR=function(e,t){YR(e,KR(DR(t),kR(t)))},JR=function(e,t){YR(e,WR(kR(t)))},QR=function(e,t){YR(e,KR(PR(t),kR(t)))},ZR=function(e,t){YR(e,KR(AR(t),kR(t)))},eI=function(e,t){YR(e,GR(AR(t)))},tI=function(e,t){YR(e,KR(AR(t),MR(t)))},nI=function(e,t){YR(e,KR(AR(t),LR(t)))},rI=function(e,t){YR(e,WR(LR(t)))},iI=function(e,t){YR(e,KR(PR(t),LR(t)))},oI=function(e,t){YR(e,KR(DR(t),LR(t)))},aI=function(e,t){YR(e,GR(DR(t)))},sI=function(e,t){YR(e,KR(DR(t),MR(t)))},lI=function(e,t,n,r){return e<t?e:e>n?n:e===t?t-1:Math.max(t,e-r)},uI=function(e,t,n,r){return e>n?e:e<t?t:e===n?n+1:Math.min(n,e+r)},cI=function(e,t,n){return Math.max(t,Math.min(n,e))},dI=function(e,t,n,r,i){return i.fold((function(){var i=e-t,o=Math.round(i/r)*r;return cI(t+o,t-1,n+1)}),(function(t){var i=(e-t)%r,o=Math.round(i/r),a=Math.floor((e-t)/r),s=Math.floor((n-t)/r),l=Math.min(s,a+o),u=t+l*r;return Math.max(t,u)}))},fI=function(e,t,n){return Math.min(n,Math.max(e,t))-t},hI=function(e){var t=e.min,n=e.max,r=e.range,i=e.value,o=e.step,a=e.snap,s=e.snapStart,l=e.rounded,u=e.hasMinEdge,c=e.hasMaxEdge,d=e.minBound,f=e.maxBound,h=e.screenRange,m=u?t-1:t,p=c?n+1:n;if(i<d)return m;if(i>f)return p;var g=fI(i,d,f),v=cI(g/h*r+t,m,p);return a&&v>=t&&v<=n?dI(v,t,n,o,s):l?Math.round(v):v},mI=function(e){var t=e.min,n=e.max,r=e.range,i=e.value,o=e.hasMinEdge,a=e.hasMaxEdge,s=e.maxBound,l=e.maxOffset,u=e.centerMinEdge,c=e.centerMaxEdge;return i<t?o?0:u:i>n?a?s:c:(i-t)/r*l},pI="top",gI="right",vI="bottom",bI="left",yI="width",wI="height",SI=function(e){return e.element.dom.getBoundingClientRect()},xI=function(e,t){return e[t]},CI=function(e){var t=SI(e);return xI(t,bI)},TI=function(e){var t=SI(e);return xI(t,gI)},DI=function(e){var t=SI(e);return xI(t,pI)},kI=function(e){var t=SI(e);return xI(t,vI)},EI=function(e){var t=SI(e);return xI(t,yI)},_I=function(e){var t=SI(e);return xI(t,wI)},AI=function(e,t,n){return(e+t)/2-n},LI=function(e,t){var n=SI(e),r=SI(t),i=xI(n,bI),o=xI(n,gI),a=xI(r,bI);return AI(i,o,a)},OI=function(e,t){var n=SI(e),r=SI(t),i=xI(n,pI),o=xI(n,vI),a=xI(r,pI);return AI(i,o,a)},RI=function(e,t){Cs(e,gR(),{value:t})},II=function(e){return{x:e}},PI=function(e,t,n){var r={min:CR(t),max:ER(t),range:RR(t),value:n,step:NR(t),snap:FR(t),snapStart:BR(t),rounded:$R(t),hasMinEdge:UR(t),hasMaxEdge:VR(t),minBound:CI(e),maxBound:TI(e),screenRange:EI(e)};return hI(r)},MI=function(e,t,n){var r=PI(e,t,n),i=II(r);return RI(e,i),r},NI=function(e,t){var n=CR(t);RI(e,II(n))},FI=function(e,t){var n=ER(t);RI(e,II(n))},BI=function(e,t,n){var r=e>0?uI:lI,i=r(qR(n).x,CR(n),ER(n),NR(n));return RI(t,II(i)),N.some(i)},$I=function(e){return function(t,n){return BI(e,t,n).map(E)}},zI=function(e){var t=bR(e);return t.map((function(e){return e.left}))},UI=function(e,t,n,r,i){var o=0,a=EI(e),s=r.bind((function(t){return N.some(LI(t,e))})).getOr(o),l=i.bind((function(t){return N.some(LI(t,e))})).getOr(a),u={min:CR(t),max:ER(t),range:RR(t),value:n,hasMinEdge:UR(t),hasMaxEdge:VR(t),minBound:CI(e),minOffset:o,maxBound:TI(e),maxOffset:a,centerMinEdge:s,centerMaxEdge:l};return mI(u)},VI=function(e,t,n,r,i,o){var a=UI(t,o,n,r,i);return CI(t)-CI(e)+a},HI=function(e,t,n,r){var i=qR(n),o=VI(e,r.getSpectrum(e),i.x,r.getLeftEdge(e),r.getRightEdge(e),n),a=vr(t.element)/2;Kn(t.element,"left",o-a+"px")},jI=$I(-1),qI=$I(1),GI=N.none,WI=N.none,KI={"top-left":N.none(),top:N.none(),"top-right":N.none(),right:N.some(eI),"bottom-right":N.none(),bottom:N.none(),"bottom-left":N.none(),left:N.some(aI)},YI=Object.freeze({__proto__:null,setValueFrom:MI,setToMin:NI,setToMax:FI,findValueOfOffset:PI,getValueFromEvent:zI,findPositionOfValue:VI,setPositionFromValue:HI,onLeft:jI,onRight:qI,onUp:GI,onDown:WI,edgeActions:KI}),XI=function(e,t){Cs(e,gR(),{value:t})},JI=function(e){return{y:e}},QI=function(e,t,n){var r={min:TR(t),max:_R(t),range:IR(t),value:n,step:NR(t),snap:FR(t),snapStart:BR(t),rounded:$R(t),hasMinEdge:HR(t),hasMaxEdge:jR(t),minBound:DI(e),maxBound:kI(e),screenRange:_I(e)};return hI(r)},ZI=function(e,t,n){var r=QI(e,t,n),i=JI(r);return XI(e,i),r},eP=function(e,t){var n=TR(t);XI(e,JI(n))},tP=function(e,t){var n=_R(t);XI(e,JI(n))},nP=function(e,t,n){var r=e>0?uI:lI,i=r(qR(n).y,TR(n),_R(n),NR(n));return XI(t,JI(i)),N.some(i)},rP=function(e){return function(t,n){return nP(e,t,n).map(E)}},iP=function(e){var t=bR(e);return t.map((function(e){return e.top}))},oP=function(e,t,n,r,i){var o=0,a=_I(e),s=r.bind((function(t){return N.some(OI(t,e))})).getOr(o),l=i.bind((function(t){return N.some(OI(t,e))})).getOr(a),u={min:TR(t),max:_R(t),range:IR(t),value:n,hasMinEdge:HR(t),hasMaxEdge:jR(t),minBound:DI(e),minOffset:o,maxBound:kI(e),maxOffset:a,centerMinEdge:s,centerMaxEdge:l};return mI(u)},aP=function(e,t,n,r,i,o){var a=oP(t,o,n,r,i);return DI(t)-DI(e)+a},sP=function(e,t,n,r){var i=qR(n),o=aP(e,r.getSpectrum(e),i.y,r.getTopEdge(e),r.getBottomEdge(e),n),a=ar(t.element)/2;Kn(t.element,"top",o-a+"px")},lP=N.none,uP=N.none,cP=rP(-1),dP=rP(1),fP={"top-left":N.none(),top:N.some(JR),"top-right":N.none(),right:N.none(),"bottom-right":N.none(),bottom:N.some(rI),"bottom-left":N.none(),left:N.none()},hP=Object.freeze({__proto__:null,setValueFrom:ZI,setToMin:eP,setToMax:tP,findValueOfOffset:QI,getValueFromEvent:iP,findPositionOfValue:aP,setPositionFromValue:sP,onLeft:lP,onRight:uP,onUp:cP,onDown:dP,edgeActions:fP}),mP=function(e,t){Cs(e,gR(),{value:t})},pP=function(e,t){return{x:e,y:t}},gP=function(e,t,n){var r=PI(e,t,n.left),i=QI(e,t,n.top),o=pP(r,i);return mP(e,o),o},vP=function(e,t,n,r){var i=e>0?uI:lI,o=t?qR(r).x:i(qR(r).x,CR(r),ER(r),NR(r)),a=t?i(qR(r).y,TR(r),_R(r),NR(r)):qR(r).y;return mP(n,pP(o,a)),N.some(o)},bP=function(e,t){return function(n,r){return vP(e,t,n,r).map(E)}},yP=function(e,t){var n=CR(t),r=TR(t);mP(e,pP(n,r))},wP=function(e,t){var n=ER(t),r=_R(t);mP(e,pP(n,r))},SP=function(e){return bR(e)},xP=function(e,t,n,r){var i=qR(n),o=VI(e,r.getSpectrum(e),i.x,r.getLeftEdge(e),r.getRightEdge(e),n),a=aP(e,r.getSpectrum(e),i.y,r.getTopEdge(e),r.getBottomEdge(e),n),s=vr(t.element)/2,l=ar(t.element)/2;Kn(t.element,"left",o-s+"px"),Kn(t.element,"top",a-l+"px")},CP=bP(-1,!1),TP=bP(1,!1),DP=bP(-1,!0),kP=bP(1,!0),EP={"top-left":N.some(XR),top:N.some(QR),"top-right":N.some(ZR),right:N.some(tI),"bottom-right":N.some(nI),bottom:N.some(iI),"bottom-left":N.some(oI),left:N.some(sI)},_P=Object.freeze({__proto__:null,setValueFrom:gP,setToMin:yP,setToMax:wP,getValueFromEvent:SP,setPositionFromValue:xP,onLeft:CP,onRight:TP,onUp:DP,onDown:kP,edgeActions:EP}),AP=[Ko("stepSize",1),Ko("onChange",g),Ko("onChoose",g),Ko("onInit",g),Ko("onDragStart",g),Ko("onDragEnd",g),Ko("snapToGrid",!1),Ko("rounded",!0),zo("snapStart"),Lo("model",To("mode",{x:[Ko("minX",0),Ko("maxX",100),Eo("value",(function(e){return ia(e.mode.minX)})),Ao("getInitialValue"),dc("manager",YI)],y:[Ko("minY",0),Ko("maxY",100),Eo("value",(function(e){return ia(e.mode.minY)})),Ao("getInitialValue"),dc("manager",hP)],xy:[Ko("minX",0),Ko("maxX",100),Ko("minY",0),Ko("maxY",100),Eo("value",(function(e){return ia({x:e.mode.minX,y:e.mode.minY})})),Ao("getInitialValue"),dc("manager",_P)]})),tg("sliderBehaviours",[Aw,eg]),Eo("mouseIsDown",(function(){return ia(!1)}))],LP=function(e,t,n,r){var i,o=function(t){return Yg(t,e,"thumb")},a=function(t){return Yg(t,e,"spectrum")},s=function(t){return Kg(t,e,"left-edge")},l=function(t){return Kg(t,e,"right-edge")},u=function(t){return Kg(t,e,"top-edge")},c=function(t){return Kg(t,e,"bottom-edge")},d=e.model,f=d.manager,h=function(t,n){f.setPositionFromValue(t,n,e,{getLeftEdge:s,getRightEdge:l,getTopEdge:u,getBottomEdge:c,getSpectrum:a})},m=function(e,t){d.value.set(t);var n=o(e);h(e,n)},p=function(t,n){m(t,n);var r=o(t);return e.onChange(t,r,n),N.some(!0)},g=function(t){f.setToMin(t,e)},v=function(t){f.setToMax(t,e)},b=function(t){var n=function(){Kg(t,e,"thumb").each((function(n){var r=d.value.get();e.onChoose(t,n,r)}))},r=e.mouseIsDown.get();e.mouseIsDown.set(!1),r&&n()},y=function(t,n){n.stop(),e.mouseIsDown.set(!0),e.onDragStart(t,o(t))},w=function(t,n){n.stop(),e.onDragEnd(t,o(t)),b(t)};return{uid:e.uid,dom:e.dom,components:t,behaviours:rg(e.sliderBehaviours,[Aw.config({mode:"special",focusIn:function(t){return Kg(t,e,"spectrum").map(Aw.focusIn).map(E)}}),eg.config({store:{mode:"manual",getValue:function(e){return d.value.get()}}}),bd.config({channels:(i={},i[Sp()]={onReceive:b},i)})]),events:_s([Rs(gR(),(function(e,t){p(e,t.event.value)})),Vs((function(t,n){var r=d.getInitialValue();d.value.set(r);var i=o(t);h(t,i);var s=a(t);e.onInit(t,i,s,d.value.get())})),Rs(Aa(),y),Rs(Oa(),w),Rs(Ia(),y),Rs(Na(),w)]),apis:{resetToMin:g,resetToMax:v,setValue:m,refresh:h},domModification:{styles:{position:"relative"}}}},OP=hv({name:"Slider",configFields:AP,partFields:mR,factory:LP,apis:{setValue:function(e,t,n){e.setValue(t,n)},resetToMin:function(e,t){e.resetToMin(t)},resetToMax:function(e,t){e.resetToMax(t)},refresh:function(e,t){e.refresh(t)}}}),RP=il("rgb-hex-update"),IP=il("slider-update"),PP=il("palette-update"),MP=function(e,t){var n=OP.parts.spectrum({dom:{tag:"div",classes:[t("hue-slider-spectrum")],attributes:{role:"presentation"}}}),r=OP.parts.thumb({dom:{tag:"div",classes:[t("hue-slider-thumb")],attributes:{role:"presentation"}}});return OP.sketch({dom:{tag:"div",classes:[t("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:w({y:0})},components:[n,r],sliderBehaviours:fd([Xw.config({})]),onChange:function(e,t,n){Cs(e,IP,{value:n})}})},NP="form",FP=[tg("formBehaviours",[eg])],BP=function(e){return"<alloy.field."+e+">"},$P=function(e){var t=function(){var e=[],t=function(t,n){return e.push(t),Hg(NP,BP(t),n)};return{field:t,record:w(e)}}(),n=e(t),r=t.record(),i=G(r,(function(e){return Ig({name:e,pname:BP(e)})}));return av(NP,FP,i,UP,n)},zP=function(e,t){return e.fold((function(){return ri.error(t)}),ri.value)},UP=function(e,t){return{uid:e.uid,dom:e.dom,components:t,behaviours:rg(e.formBehaviours,[eg.config({store:{mode:"manual",getValue:function(t){var n=Jg(t,e);return be(n,(function(e,t){return e().bind((function(e){var n=bv.getCurrent(e);return zP(n,new Error("Cannot find a current component to extract the value from for form part '"+t+"': "+Zs(e.element)))})).map(eg.getValue)}))},setValue:function(t,n){ve(n,(function(n,r){Kg(t,e,r).each((function(e){bv.getCurrent(e).each((function(e){eg.setValue(e,n)}))}))}))}}})]),apis:{getField:function(t,n){return Kg(t,e,n).bind(bv.getCurrent)}}}},VP={getField:Cl((function(e,t,n){return e.getField(t,n)})),sketch:$P},HP=il("valid-input"),jP=il("invalid-input"),qP=il("validating-input"),GP="colorcustom.rgb.",WP=function(e,t,n,r){var i=function(n,r){return SO.config({invalidClass:t("invalid"),notify:{onValidate:function(e){Cs(e,qP,{type:n})},onValid:function(e){Cs(e,HP,{type:n,value:eg.getValue(e)})},onInvalid:function(e){Cs(e,jP,{type:n,value:eg.getValue(e)})}},validator:{validate:function(t){var n=eg.getValue(t),i=r(n)?ri.value(!0):ri.error(e("aria.input.invalid"));return uO.pure(i)},validateOnLoad:!1}})},o=function(n,r,o,a,s){var l=e(GP+"range"),u=TL.parts.label({dom:{tag:"label",innerHtml:o,attributes:{"aria-label":a}}}),c=TL.parts.field({data:s,factory:JL,inputAttributes:A({type:"text"},"hex"===r?{"aria-live":"polite"}:{}),inputClasses:[t("textfield")],inputBehaviours:fd([i(r,n),_L.config({})]),onSetValue:function(e){if(SO.isInvalid(e)){var t=SO.run(e);t.get(g)}}}),d=[u,c],f="hex"!==r?[TL.parts["aria-descriptor"]({text:l})]:[],h=d.concat(f);return{dom:{tag:"div",attributes:{role:"presentation"}},components:h}},a=function(e,t){var n=c_(t);return VP.getField(e,"hex").each((function(t){Xw.isFocused(t)||eg.setValue(e,{hex:n.value})})),n},s=function(e,t){var n=t.red,r=t.green,i=t.blue;eg.setValue(e,{red:n,green:r,blue:i})},l=Ex({dom:{tag:"div",classes:[t("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),u=function(e,t){l.getOpt(e).each((function(e){Kn(e.element,"background-color","#"+t.value)}))},c=function(){var i={red:ia(N.some(255)),green:ia(N.some(255)),blue:ia(N.some(255)),hex:ia(N.some("ffffff"))},c=function(e,t){var n=y_(t);s(e,n),m(n)},d=function(e){return i[e].get()},f=function(e,t){i[e].set(t)},h=function(){return d("red").bind((function(e){return d("green").bind((function(t){return d("blue").map((function(n){return g_(e,t,n,1)}))}))}))},m=function(e){var t=e.red,n=e.green,r=e.blue;f("red",N.some(t)),f("green",N.some(n)),f("blue",N.some(r))},p=function(e,t){var n=t.event;"hex"!==n.type?f(n.type,N.none()):r(e)},g=function(e,t){n(e);var r=t_(t);f("hex",N.some(t));var i=y_(r);s(e,i),m(i),Cs(e,RP,{hex:r}),u(e,r)},v=function(e,t,n){var r=parseInt(n,10);f(t,N.some(r)),h().each((function(t){var n=a(e,t);Cs(e,RP,{hex:n}),u(e,n)}))},b=function(e){return"hex"===e.type},y=function(e,t){var n=t.event;b(n)?g(e,n.value):v(e,n.type,n.value)},w=function(t){return{label:e(GP+t+".label"),description:e(GP+t+".description")}},S=w("red"),x=w("green"),C=w("blue"),T=w("hex");return Si(VP.sketch((function(n){return{dom:{tag:"form",classes:[t("rgb-form")],attributes:{"aria-label":e("aria.color.picker")}},components:[n.field("red",TL.sketch(o(v_,"red",S.label,S.description,255))),n.field("green",TL.sketch(o(v_,"green",x.label,x.description,255))),n.field("blue",TL.sketch(o(v_,"blue",C.label,C.description,255))),n.field("hex",TL.sketch(o(i_,"hex",T.label,T.description,"ffffff"))),l.asSpec()],formBehaviours:fd([SO.config({invalidClass:t("form-invalid")}),Uw("rgb-form-events",[Rs(HP,y),Rs(jP,p),Rs(qP,p)])])}})),{apis:{updateHex:function(e,t){eg.setValue(e,{hex:t.value}),c(e,t),u(e,t)}}})},d=fv({factory:c,name:"RgbForm",configFields:[],apis:{updateHex:function(e,t,n){e.updateHex(t,n)}},extraApis:{}});return d},KP=function(e,t){var n=OP.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[t("sv-palette-spectrum")]}}),r=OP.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[t("sv-palette-thumb")],innerHtml:"<div class="+t("sv-palette-inner-thumb")+' role="presentation"></div>'}}),i=function(e,t){var n=e.width,r=e.height,i=e.getContext("2d");if(null!==i){i.fillStyle=t,i.fillRect(0,0,n,r);var o=i.createLinearGradient(0,0,n,0);o.addColorStop(0,"rgba(255,255,255,1)"),o.addColorStop(1,"rgba(255,255,255,0)"),i.fillStyle=o,i.fillRect(0,0,n,r);var a=i.createLinearGradient(0,0,0,r);a.addColorStop(0,"rgba(0,0,0,0)"),a.addColorStop(1,"rgba(0,0,0,1)"),i.fillStyle=a,i.fillRect(0,0,n,r)}},o=function(e,t){var n=e.components()[0].element.dom,r=L_(t,100,100),o=b_(r);i(n,x_(o))},a=function(e,t){var n=O_(y_(t));OP.setValue(e,{x:n.saturation,y:100-n.value})},s=function(e){var o=w({x:0,y:0}),a=function(e,t,n){Cs(e,PP,{value:n})},s=function(e,t,n,r){i(n.element.dom,x_(C_))},l=fd([bv.config({find:N.some}),Xw.config({})]);return OP.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[t("sv-palette")]},model:{mode:"xy",getInitialValue:o},rounded:!1,components:[n,r],onChange:a,onInit:s,sliderBehaviours:l})},l=fv({factory:s,name:"SaturationBrightnessPalette",configFields:[],apis:{setHue:function(e,t,n){o(t,n)},setThumb:function(e,t,n){a(t,n)}},extraApis:{}});return l},YP=function(e,t){var n=function(n){var r=WP(e,t,n.onValidHex,n.onInvalidHex),i=KP(e,t),o=function(e){return(100-e)/100*360},a=function(e){return 100-e/360*100},s={paletteRgba:ia(C_),paletteHue:ia(0)},l=Ex(MP(e,t)),u=Ex(i.sketch({})),c=Ex(r.sketch({})),d=function(e,t,n){u.getOpt(e).each((function(e){i.setHue(e,n)}))},f=function(e,t){c.getOpt(e).each((function(e){r.updateHex(e,t)}))},h=function(e,t,n){l.getOpt(e).each((function(e){OP.setValue(e,{y:a(n)})}))},m=function(e,t){u.getOpt(e).each((function(e){i.setThumb(e,t)}))},p=function(e,t){var n=y_(e);s.paletteRgba.set(n),s.paletteHue.set(t)},g=function(e,t,n,r){p(t,n),W(r,(function(r){r(e,t,n)}))},v=function(){var e=[f];return function(t,n){var r=n.event.value,i=s.paletteHue.get(),o=L_(i,r.x,100-r.y),a=I_(o);g(t,a,i,e)}},b=function(){var e=[d,f];return function(t,n){var r=o(n.event.value.y),i=s.paletteRgba.get(),a=O_(i),l=L_(r,a.saturation,a.value),u=I_(l);g(t,u,r,e)}},y=function(){var e=[d,h,m];return function(t,n){var r=n.event.hex,i=R_(r);g(t,r,i.hue,e)}};return{uid:n.uid,dom:n.dom,components:[u.asSpec(),l.asSpec(),c.asSpec()],behaviours:fd([Uw("colour-picker-events",[Rs(RP,y()),Rs(PP,v()),Rs(IP,b())]),bv.config({find:function(e){return c.getOpt(e)}}),Aw.config({mode:"acyclic"})])}},r=fv({name:"ColourPicker",configFields:[Ao("dom"),Ko("onValidHex",g),Ko("onInvalidHex",g)],factory:n});return r},XP=function(){return bv.config({find:N.some})},JP=function(e){return bv.config({find:e.getOpt})},QP=function(e){return bv.config({find:function(t){return xn(t.element,e).bind((function(e){return t.getSystem().getByDom(e).toOptional()}))}})},ZP={self:XP,memento:JP,childAt:QP},eM={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},tM=function(e){return eM[e]},nM=function(e){return tM(e)},rM=function(e){var t=function(e){return"tox-"+e},n=YP(nM,t),r=function(e){Cs(e,$L,{name:"hex-valid",value:!0})},i=function(e){Cs(e,$L,{name:"hex-valid",value:!1})},o=Ex(n.sketch({dom:{tag:"div",classes:[t("color-picker-container")],attributes:{role:"presentation"}},onValidHex:r,onInvalidHex:i}));return{dom:{tag:"div"},components:[o.asSpec()],behaviours:fd([eg.config({store:{mode:"manual",getValue:function(e){var t=o.get(e),n=bv.getCurrent(t),r=n.bind((function(e){var t=eg.getValue(e);return t.hex}));return r.map((function(e){return"#"+e})).getOr("")},setValue:function(e,t){var n=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/,r=n.exec(t),i=o.get(e),a=bv.getCurrent(i);a.fold((function(){console.log("Can not find form")}),(function(e){eg.setValue(e,{hex:N.from(r[1]).getOr("")}),VP.getField(e,"hex").each((function(e){xs(e,Va())}))}))}}}),ZP.self()])}},iM=tinymce.util.Tools.resolve("tinymce.Resource"),oM=function(e){return Ee(e,"init")},aM=function(e){var t=rf(),n=Ex({dom:{tag:e.tag}}),r=rf();return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:fd([Uw("custom-editor-events",[Vs((function(i){n.getOpt(i).each((function(n){(oM(e)?e.init(n.element.dom):iM.load(e.scriptId,e.scriptUrl).then((function(t){return t(n.element.dom,e.settings)}))).then((function(e){r.on((function(t){e.setValue(t)})),r.clear(),t.set(e)}))}))}))]),eg.config({store:{mode:"manual",getValue:function(){return t.get().fold((function(){return r.get().getOr("")}),(function(e){return e.getValue()}))},setValue:function(e,n){t.get().fold((function(){r.set(n)}),(function(e){return e.setValue(n)}))}}}),ZP.self()]),components:[n.asSpec()]}},sM=tinymce.util.Tools.resolve("tinymce.util.Tools"),lM=Zi([Ko("preprocess",S),Ko("postprocess",S)]),uM=function(e,t){var n=xo("RepresentingConfigs.memento processors",lM,t);return eg.config({store:{mode:"manual",getValue:function(t){var r=e.get(t),i=eg.getValue(r);return n.postprocess(i)},setValue:function(t,r){var i=n.preprocess(r),o=e.get(t);eg.setValue(o,i)}}})},cM=function(e,t,n){return eg.config(Si({store:{mode:"manual",getValue:t,setValue:n}},e.map((function(e){return{store:{initialValue:e}}})).getOr({})))},dM=function(e,t,n){return cM(e,(function(e){return t(e.element)}),(function(e,t){return n(e.element,t)}))},fM=function(e){return dM(e,fu,hu)},hM=function(e){return dM(e,Ws,Ks)},mM=function(e){return eg.config({store:{mode:"memory",initialValue:e}})},pM={memento:uM,withElement:dM,withComp:cM,domValue:fM,domHtml:hM,memory:mM},gM="jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp",vM=function(e,t){var n=sM.explode(t.getSetting("images_file_types",gM,"string")),r=function(e){return H(n,(function(t){return je(e.name.toLowerCase(),"."+t.toLowerCase())}))};return X(he(e),r)},bM=function(e,t){var n=function(e,t){t.stop()},r=function(e){return function(t,n){W(e,(function(e){e(t,n)}))}},i=function(e,t){if(!Fv.isDisabled(e)){var n=t.event.raw;a(e,n.dataTransfer.files)}},o=function(e,t){var n=t.event.raw.target;a(e,n.files)},a=function(n,r){eg.setValue(n,vM(r,t)),Cs(n,NL,{name:e.name})},s=Ex({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:fd([Uw("input-file-events",[$s(ja()),$s(rs())])])}),l=function(e){return{uid:e.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:fd([pM.memory([]),ZP.self(),Fv.config({}),pS.config({toggleClass:"dragenter",toggleOnExecute:!1}),Uw("dropzone-events",[Rs("dragenter",r([n,pS.toggle])),Rs("dragleave",r([n,pS.toggle])),Rs("dragover",n),Rs("drop",r([n,i])),Rs(Ha(),o)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:t.translate("Drop an image here")}},Cx.sketch({dom:{tag:"button",innerHtml:t.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[s.asSpec()],action:function(e){var t=s.get(e);t.element.dom.click()},buttonBehaviours:fd([_L.config({}),xE.button(t.isDisabled),vE()])})]}]}},u=e.label.map((function(e){return ML(e,t)})),c=TL.parts.field({factory:{sketch:l}});return LL(u,c,["tox-form__group--stretched"],[])},yM=function(e,t){return{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+e.columns+"col"]},components:G(e.items,t.interpreter)}},wM=il("alloy-fake-before-tabstop"),SM=il("alloy-fake-after-tabstop"),xM=function(e){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:e},behaviours:fd([Xw.config({ignore:!0}),_L.config({})])}},CM=function(e){return{dom:{tag:"div",classes:["tox-navobj"]},components:[xM([wM]),e,xM([SM])],behaviours:fd([ZP.childAt(1)])}},TM=function(e,t){Cs(e,za(),{raw:{which:9,shiftKey:t}})},DM=function(e,t){var n=t.element;lu(n,wM)?TM(e,!0):lu(n,SM)&&TM(e,!1)},kM=function(e){return qA(e,["."+wM,"."+SM].join(","),k)},EM=!(tn().browser.isIE()||tn().browser.isEdge()),_M=function(e){var t=ia("");return{getValue:function(e){return t.get()},setValue:function(n,r){if(e)zn(n.element,"srcdoc",r);else{zn(n.element,"src","javascript:''");var i=n.element.dom.contentWindow.document;i.open(),i.write(r),i.close()}t.set(r)}}},AM=function(e,t){var n=EM&&e.sandboxed,r=A(A({},e.label.map((function(e){return{title:e}})).getOr({})),n?{sandbox:"allow-scripts allow-same-origin"}:{}),i=_M(n),o=e.label.map((function(e){return ML(e,t)})),a=function(e){return CM({uid:e.uid,dom:{tag:"iframe",attributes:r},behaviours:fd([_L.config({}),Xw.config({}),pM.withComp(N.none(),i.getValue,i.setValue)])})},s=TL.parts.field({factory:{sketch:a}});return LL(o,s,["tox-form__group--stretched"],[])},LM=function(e,t){return IM(document.createElement("canvas"),e,t)},OM=function(e){var t=LM(e.width,e.height),n=RM(t);return n.drawImage(e,0,0),t},RM=function(e){return e.getContext("2d")},IM=function(e,t,n){return e.width=t,e.height=n,e},PM=function(e){return e.naturalWidth||e.width},MM=function(e){return e.naturalHeight||e.height},NM=function(e){return new tO((function(t,n){var r=URL.createObjectURL(e),i=new Image,o=function(){i.removeEventListener("load",a),i.removeEventListener("error",s)},a=function(){o(),t(i)},s=function(){o(),n("Unable to load data of type "+e.type+": "+r)};i.addEventListener("load",a),i.addEventListener("error",s),i.src=r,i.complete&&setTimeout(a,0)}))},FM=function(e){var t=e.split(","),n=/data:([^;]+)/.exec(t[0]);if(!n)return N.none();for(var r=n[1],i=t[1],o=1024,a=atob(i),s=a.length,l=Math.ceil(s/o),u=new Array(l),c=0;c<l;++c){for(var d=c*o,f=Math.min(d+o,s),h=new Array(f-d),m=d,p=0;m<f;++p,++m)h[p]=a[m].charCodeAt(0);u[c]=new Uint8Array(h)}return N.some(new Blob(u,{type:r}))},BM=function(e){return new tO((function(t,n){FM(e).fold((function(){n("uri is not base64: "+e)}),t)}))},$M=function(e,t,n){return t=t||"image/png",h(HTMLCanvasElement.prototype.toBlob)?new tO((function(r,i){e.toBlob((function(e){e?r(e):i()}),t,n)})):BM(e.toDataURL(t,n))},zM=function(e,t,n){return t=t||"image/png",e.toDataURL(t,n)},UM=function(e){return NM(e).then((function(e){HM(e);var t=LM(PM(e),MM(e)),n=RM(t);return n.drawImage(e,0,0),t}))},VM=function(e){return new tO((function(t){var n=new FileReader;n.onloadend=function(){t(n.result)},n.readAsDataURL(e)}))},HM=function(e){URL.revokeObjectURL(e.src)},jM=function(e,t,n){var r=t.type,i=w(r),o=function(){return tO.resolve(t)},a=w(n),s=function(){return n.split(",")[1]},l=function(t,n){return e.then((function(e){return $M(e,t,n)}))},u=function(t,n){return e.then((function(e){return zM(e,t,n)}))},c=function(e,t){return u(e,t).then((function(e){return e.split(",")[1]}))},d=function(){return e.then(OM)};return{getType:i,toBlob:o,toDataURL:a,toBase64:s,toAdjustedBlob:l,toAdjustedDataURL:u,toAdjustedBase64:c,toCanvas:d}},qM=function(e){return VM(e).then((function(t){return jM(UM(e),e,t)}))},GM=function(e,t){return $M(e,t).then((function(t){return jM(tO.resolve(e),t,e.toDataURL())}))},WM=function(e){return qM(e)},KM=function(e,t,n){var r="string"===typeof e?parseFloat(e):e;return r>n?r=n:r<t&&(r=t),r},YM=function(){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]},XM=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],JM=function(e,t){for(var n,r=[],i=new Array(25),o=0;o<5;o++){for(var a=0;a<5;a++)r[a]=t[a+5*o];for(a=0;a<5;a++){n=0;for(var s=0;s<5;s++)n+=e[a+5*s]*r[s];i[a+5*o]=n}}return i},QM=function(e,t){var n;return t=KM(t,-1,1),t*=100,t<0?n=127+t/100*127:(n=t%1,n=0===n?XM[t]:XM[Math.floor(t)]*(1-n)+XM[Math.floor(t)+1]*n,n=127*n+127),JM(e,[n/127,0,0,0,.5*(127-n),0,n/127,0,0,.5*(127-n),0,0,n/127,0,.5*(127-n),0,0,0,1,0,0,0,0,0,1])},ZM=function(e,t){return t=KM(255*t,-255,255),JM(e,[1,0,0,0,t,0,1,0,0,t,0,0,1,0,t,0,0,0,1,0,0,0,0,0,1])},eN=function(e,t,n,r){return t=KM(t,0,2),n=KM(n,0,2),r=KM(r,0,2),JM(e,[t,0,0,0,0,0,n,0,0,0,0,0,r,0,0,0,0,0,1,0,0,0,0,0,1])},tN=function(e,t){return e.toCanvas().then((function(n){return nN(n,e.getType(),t)}))},nN=function(e,t,n){var r=RM(e),i=function(e,t){for(var n,r,i,o,a=e.data,s=t[0],l=t[1],u=t[2],c=t[3],d=t[4],f=t[5],h=t[6],m=t[7],p=t[8],g=t[9],v=t[10],b=t[11],y=t[12],w=t[13],S=t[14],x=t[15],C=t[16],T=t[17],D=t[18],k=t[19],E=0;E<a.length;E+=4)n=a[E],r=a[E+1],i=a[E+2],o=a[E+3],a[E]=n*s+r*l+i*u+o*c+d,a[E+1]=n*f+r*h+i*m+o*p+g,a[E+2]=n*v+r*b+i*y+o*w+S,a[E+3]=n*x+r*C+i*T+o*D+k;return e},o=i(r.getImageData(0,0,e.width,e.height),n);return r.putImageData(o,0,0),GM(e,t)},rN=function(e,t){return e.toCanvas().then((function(n){return iN(n,e.getType(),t)}))},iN=function(e,t,n){var r=RM(e),i=function(e,t,n){for(var r=function(e,t,n){return e>n?e=n:e<t&&(e=t),e},i=Math.round(Math.sqrt(n.length)),o=Math.floor(i/2),a=e.data,s=t.data,l=e.width,u=e.height,c=0;c<u;c++)for(var d=0;d<l;d++){for(var f=0,h=0,m=0,p=0;p<i;p++)for(var g=0;g<i;g++){var v=r(d+g-o,0,l-1),b=r(c+p-o,0,u-1),y=4*(b*l+v),w=n[p*i+g];f+=a[y]*w,h+=a[y+1]*w,m+=a[y+2]*w}var S=4*(c*l+d);s[S]=r(f,0,255),s[S+1]=r(h,0,255),s[S+2]=r(m,0,255)}return t},o=r.getImageData(0,0,e.width,e.height),a=r.getImageData(0,0,e.width,e.height);return a=i(o,a,n),r.putImageData(a,0,0),GM(e,t)},oN=function(e){var t=function(t,n,r){for(var i=RM(t),o=new Array(256),a=function(e,t){for(var n=e.data,r=0;r<n.length;r+=4)n[r]=t[n[r]],n[r+1]=t[n[r+1]],n[r+2]=t[n[r+2]];return e},s=0;s<o.length;s++)o[s]=e(s,r);var l=a(i.getImageData(0,0,t.width,t.height),o);return i.putImageData(l,0,0),GM(t,n)};return function(e,n){return e.toCanvas().then((function(r){return t(r,e.getType(),n)}))}},aN=function(e){return function(t,n){return tN(t,e(YM(),n))}},sN=function(e){return function(t){return tN(t,e)}},lN=function(e){return function(t){return rN(t,e)}},uN=sN([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1]),cN=aN(ZM),dN=aN(QM),fN=function(e,t,n,r){return tN(e,eN(YM(),t,n,r))},hN=lN([0,-1,0,-1,5,-1,0,-1,0]),mN=oN((function(e,t){return 255*Math.pow(e/255,1-t)})),pN=function(e,t,n){var r=PM(e),i=MM(e),o=t/r,a=n/i,s=!1;(o<.5||o>2)&&(o=o<.5?.5:2,s=!0),(a<.5||a>2)&&(a=a<.5?.5:2,s=!0);var l=gN(e,o,a);return s?l.then((function(e){return pN(e,t,n)})):l},gN=function(e,t,n){return new tO((function(r){var i=PM(e),o=MM(e),a=Math.floor(i*t),s=Math.floor(o*n),l=LM(a,s),u=RM(l);u.drawImage(e,0,0,i,o,0,0,a,s),r(l)}))},vN=function(e,t){void 0===t&&(t=2);var n=Math.pow(10,t),r=Math.round(e*n);return Math.ceil(r/n)},bN=function(e,t){return e.toCanvas().then((function(n){return yN(n,e.getType(),t)}))},yN=function(e,t,n){var r=n<0?360+n:n,i=r*Math.PI/180,o=e.width,a=e.height,s=Math.sin(i),l=Math.cos(i),u=vN(Math.abs(o*l)+Math.abs(a*s)),c=vN(Math.abs(o*s)+Math.abs(a*l)),d=LM(u,c),f=RM(d);return f.translate(u/2,c/2),f.rotate(i),f.drawImage(e,-o/2,-a/2),GM(d,t)},wN=function(e,t){return e.toCanvas().then((function(n){return SN(n,e.getType(),t)}))},SN=function(e,t,n){var r=LM(e.width,e.height),i=RM(r);return"v"===n?(i.scale(1,-1),i.drawImage(e,0,-r.height)):(i.scale(-1,1),i.drawImage(e,-r.width,0)),GM(r,t)},xN=function(e,t,n,r,i){return e.toCanvas().then((function(o){return CN(o,e.getType(),t,n,r,i)}))},CN=function(e,t,n,r,i,o){var a=LM(i,o),s=RM(a);return s.drawImage(e,-n,-r),GM(a,t)},TN=function(e,t,n){return e.toCanvas().then((function(r){return pN(r,t,n).then((function(t){return GM(t,e.getType())}))}))},DN=function(e){return uN(e)},kN=function(e){return hN(e)},EN=function(e,t){return mN(e,t)},_N=function(e,t,n,r){return fN(e,t,n,r)},AN=function(e,t){return cN(e,t)},LN=function(e,t){return dN(e,t)},ON=function(e,t){return wN(e,t)},RN=function(e,t,n,r,i){return xN(e,t,n,r,i)},IN=function(e,t,n){return TN(e,t,n)},PN=function(e,t){return bN(e,t)},MN=function(e,t,n){return qC(e,{tag:"span",classes:["tox-icon","tox-tbtn__icon-wrap"],behaviours:n},t)},NN=function(e,t){return MN(e,t,[])},FN=function(e,t){return MN(e,t,[$w.config({})])},BN=function(e,t,n){return{dom:{tag:"span",innerHtml:n.translate(e),classes:[t+"__select-label"]},behaviours:fd([$w.config({})])}},$N=il("toolbar.button.execute"),zN=function(e){return qs((function(t,n){CE(e,t)((function(n){Cs(t,$N,{buttonApi:n}),e.onAction(n)}))}))},UN=(LO={},LO[ts()]=["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],LO),VN=il("update-menu-text"),HN=il("update-menu-icon"),jN=function(e,t,n){var r=ia(g),i=e.text.map((function(e){return Ex(BN(e,t,n.providers))})),o=e.icon.map((function(e){return Ex(FN(e,n.providers.icons))})),a=function(e,t){var n=eg.getValue(e);return Xw.focus(n),Cs(n,"keydown",{raw:t.event.raw}),GO.close(n),N.some(!0)},s=e.role.fold((function(){return{}}),(function(e){return{role:e}})),l=e.tooltip.fold((function(){return{}}),(function(e){var t=n.providers.translate(e);return{title:t,"aria-label":t}})),u=qC("chevron-down",{tag:"div",classes:[t+"__select-chevron"]},n.providers.icons),c=Ex(GO.sketch(A(A(A({},e.uid?{uid:e.uid}:{}),s),{dom:{tag:"button",classes:[t,t+"--select"].concat(G(e.classes,(function(e){return t+"--"+e}))),attributes:A({},l)},components:_E([o.map((function(e){return e.asSpec()})),i.map((function(e){return e.asSpec()})),N.some(u)]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:fd(O(O([],e.dropdownBehaviours,!0),[xE.button((function(){return e.disabled||n.providers.isDisabled()})),vE(),XO.config({}),$w.config({}),Uw("dropdown-events",[TE(e,r),DE(e,r)]),Uw("menubutton-update-display-text",[Rs(VN,(function(e,t){i.bind((function(t){return t.getOpt(e)})).each((function(e){$w.set(e,[Cu(n.providers.translate(t.event.text))])}))})),Rs(HN,(function(e,t){o.bind((function(t){return t.getOpt(e)})).each((function(e){$w.set(e,[FN(t.event.icon,n.providers.icons)])}))}))])],!1)),eventOrder:Si(UN,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:fd([Aw.config({mode:"special",onLeft:a,onRight:a})]),lazySink:n.getSink,toggleClass:t+"--active",parts:{menu:DD(!1,e.columns,e.presets)},fetch:function(t){return uO.nu(C(e.fetch,t))}})));return c.asSpec()},qN=function(e){return o(e)},GN=function(e){return"separator"===e.type},WN=function(e){return Ee(e,"getSubmenuItems")},KN={type:"separator"},YN=function(e,t){var n=Q(e,(function(e,n){return qN(n)?""===n?e:"|"===n?e.length>0&&!GN(e[e.length-1])?e.concat([KN]):e:Ee(t,n.toLowerCase())?e.concat([t[n.toLowerCase()]]):e:e.concat([n])}),[]);return n.length>0&&GN(n[n.length-1])&&n.pop(),n},XN=function(e,t){var n=e.getSubmenuItems(),r=ZN(n,t),i=Si(r.menus,ha(e.value,r.items)),o=Si(r.expansions,ha(e.value,e.value));return{item:e,menus:i,expansions:o}},JN=function(e,t){return WN(e)?XN(e,t):{item:e,menus:{},expansions:{}}},QN=function(e){if(GN(e))return e;var t=ke(e,"value").getOrThunk((function(){return il("generated-menu-item")}));return Si({value:t},e)},ZN=function(e,t){var n=YN(o(e)?e.split(" "):e,t);return J(n,(function(e,n){var r=QN(n),i=JN(r,t);return{menus:Si(e.menus,i.menus),items:[i.item].concat(e.items),expansions:Si(e.expansions,i.expansions)}}),{menus:{},expansions:{},items:[]})},eF=function(e,t,n,r){var i=il("primary-menu"),o=ZN(e,n.shared.providers.menuItems());if(0===o.items.length)return N.none();var a=zA(i,o.items,t,n,r),s=be(o.menus,(function(e,r){return zA(r,e,t,n,!1)})),l=Si(s,ha(i,a));return N.from(QS.tieredData(i,l,o.expansions))},tF=function(e){return{isDisabled:function(){return Fv.isDisabled(e)},setDisabled:function(t){return Fv.set(e,t)},setActive:function(t){var n=e.element;t?(ou(n,"tox-tbtn--enabled"),zn(n,"aria-pressed",!0)):(su(n,"tox-tbtn--enabled"),qn(n,"aria-pressed"))},isActive:function(){return lu(e.element,"tox-tbtn--enabled")}}},nF=function(e,t,n,r){return jN({text:e.text,icon:e.icon,tooltip:e.tooltip,role:r,fetch:function(t,r){e.fetch((function(e){r(eF(e,QT.CLOSE_ON_EXECUTE,n,!1))}))},onSetup:e.onSetup,getApi:tF,columns:1,presets:"normal",classes:[],dropdownBehaviours:[_L.config({})]},t,n.shared)},rF=function(e,t,n){var r=function(e){return function(r){var i=!r.isActive();r.setActive(i),e.storage.set(i),n.shared.getSink().each((function(n){t().getOpt(n).each((function(t){xd(t.element),Cs(t,$L,{name:e.name,value:e.storage.get()})}))}))}},i=function(e){return function(t){t.setActive(e.storage.get())}};return function(t){t(G(e,(function(e){var t=e.text.fold((function(){return{}}),(function(e){return{text:e}}));return A(A({type:e.type,active:!1},t),{onAction:r(e),onSetup:i(e)})})))}},iF=function(e,t,n,r,i,o){void 0===n&&(n=[]);var a=t.fold((function(){return{}}),(function(e){return{action:e}})),s=A({buttonBehaviours:fd([xE.button((function(){return e.disabled||o.isDisabled()})),vE(),_L.config({}),Uw("button press",[Os("click"),Os("mousedown")])].concat(n)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},a),l=Si(s,{dom:r});return Si(l,{components:i})},oF=function(e,t,n,r){void 0===r&&(r=[]);var i=e.tooltip.map((function(e){return{"aria-label":n.translate(e),title:n.translate(e)}})).getOr({}),o={tag:"button",classes:["tox-tbtn"],attributes:i},a=e.icon.map((function(e){return NN(e,n.icons)})),s=_E([a]);return iF(e,t,r,o,s,n)},aF=function(e,t,n,r){void 0===r&&(r=[]);var i=oF(e,N.some(t),n,r);return Cx.sketch(i)},sF=function(e,t,n,r,i){void 0===r&&(r=[]),void 0===i&&(i=[]);var o=n.translate(e.text),a=e.icon?e.icon.map((function(e){return NN(e,n.icons)})):N.none(),s=a.isSome()?_E([a]):[],l=a.isSome()?{}:{innerHtml:o},u=O(O(O(O([],e.primary||e.borderless?["tox-button"]:["tox-button","tox-button--secondary"],!0),a.isSome()?["tox-button--icon"]:[],!0),e.borderless?["tox-button--naked"]:[],!0),i,!0),c=A(A({tag:"button",classes:u},l),{attributes:{title:o}});return iF(e,t,r,c,s,n)},lF=function(e,t,n,r,i){void 0===r&&(r=[]),void 0===i&&(i=[]);var o=sF(e,N.some(t),n,r,i);return Cx.sketch(o)},uF=function(e,t){return function(n){"custom"===t?Cs(n,$L,{name:e,value:{}}):"submit"===t?xs(n,zL):"cancel"===t?xs(n,BL):console.error("Unknown button type: ",t)}},cF=function(e,t){return"menu"===t},dF=function(e,t){return"custom"===t||"cancel"===t||"submit"===t},fF=function(e,t,n){if(cF(e,t)){var r=function(){return a},i=e,o=A(A({},e),{onSetup:function(t){return t.setDisabled(e.disabled),g},fetch:rF(i.items,r,n)}),a=Ex(nF(o,"tox-tbtn",n,N.none()));return a.asSpec()}if(dF(e,t)){var s=uF(e.name,t),l=A(A({},e),{borderless:!1});return lF(l,s,n.shared.providers,[])}console.error("Unknown footer button type: ",t)},hF=function(e,t){var n=uF(e.name,"custom");return OL(N.none(),TL.parts.field(A({factory:Cx},sF(e,N.some(n),t,[pM.memory(""),ZP.self()]))))},mF=w([Ko("field1Name","field1"),Ko("field2Name","field2"),uc("onLockedChange"),oc(["lockClass"]),Ko("locked",!1),ig.field("coupledFieldBehaviours",[bv,eg])]),pF=function(e,t,n){return Kg(e,t,n).bind(bv.getCurrent)},gF=function(e,t){return Ig({factory:TL,name:e,overrides:function(e){return{fieldBehaviours:fd([Uw("coupled-input-behaviour",[Rs(Va(),(function(n){pF(n,e,t).each((function(t){Kg(n,e,"lock").each((function(r){pS.isOn(r)&&e.onLockedChange(n,t,r)}))}))}))])])}}})},vF=w([gF("field1","field2"),gF("field2","field1"),Ig({factory:Cx,schema:[Ao("dom")],name:"lock",overrides:function(e){return{buttonBehaviours:fd([pS.config({selected:e.locked,toggleClass:e.markers.lockClass,aria:{mode:"pressed"}})])}}})]),bF=function(e,t,n,r){return{uid:e.uid,dom:e.dom,components:t,behaviours:ig.augment(e.coupledFieldBehaviours,[bv.config({find:N.some}),eg.config({store:{mode:"manual",getValue:function(t){var n,r=Zg(t,e,["field1","field2"]);return n={},n[e.field1Name]=eg.getValue(r.field1()),n[e.field2Name]=eg.getValue(r.field2()),n},setValue:function(t,n){var r=Zg(t,e,["field1","field2"]);_e(n,e.field1Name)&&eg.setValue(r.field1(),n[e.field1Name]),_e(n,e.field2Name)&&eg.setValue(r.field2(),n[e.field2Name])}}})]),apis:{getField1:function(t){return Kg(t,e,"field1")},getField2:function(t){return Kg(t,e,"field2")},getLock:function(t){return Kg(t,e,"lock")}}}},yF=hv({name:"FormCoupledInputs",configFields:mF(),partFields:vF(),factory:bF,apis:{getField1:function(e,t){return e.getField1(t)},getField2:function(e,t){return e.getField2(t)},getLock:function(e,t){return e.getLock(t)}}}),wF=function(e){var t={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},n=function(e){return e in t?t[e]:1},r=e.value.toFixed(n(e.unit));return-1!==r.indexOf(".")&&(r=r.replace(/\.?0*$/,"")),r+e.unit},SF=function(e){var t=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/,n=t.exec(e);if(null!==n){var r=parseFloat(n[1]),i=n[2];return ri.value({value:r,unit:i})}return ri.error(e)},xF=function(e,t){var n={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},r=function(e){return Ee(n,e)};return e.unit===t?N.some(e.value):r(e.unit)&&r(t)?n[e.unit]===n[t]?N.some(e.value):N.some(e.value/n[e.unit]*n[t]):N.none()},CF=function(e){return N.none()},TF=function(e,t){return function(n){return xF(n,t).map((function(n){return{value:n*e,unit:t}}))}},DF=function(e,t){var n=SF(e).toOptional(),r=SF(t).toOptional();return Ie(n,r,(function(e,t){return xF(e,t.unit).map((function(e){return t.value/e})).map((function(e){return TF(e,t.unit)})).getOr(CF)})).getOr(CF)},kF=function(e,t){var n=CF,r=il("ratio-event"),i=function(e){return qC(e,{tag:"span",classes:["tox-icon","tox-lock-icon__"+e]},t.icons)},o=yF.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:t.translate(e.label.getOr("Constrain proportions"))}},components:[i("lock"),i("unlock")],buttonBehaviours:fd([Fv.config({disabled:function(){return e.disabled||t.isDisabled()}}),vE(),_L.config({})])}),a=function(e){return{dom:{tag:"div",classes:["tox-form__group"]},components:e}},s=function(n){return TL.parts.field({factory:JL,inputClasses:["tox-textfield"],inputBehaviours:fd([Fv.config({disabled:function(){return e.disabled||t.isDisabled()}}),vE(),_L.config({}),Uw("size-input-events",[Rs(Ba(),(function(e,t){Cs(e,r,{isField1:n})})),Rs(Ha(),(function(t,n){Cs(t,NL,{name:e.name})}))])]),selectOnFocus:!1})},l=function(e){return{dom:{tag:"label",classes:["tox-label"],innerHtml:t.translate(e)}}},u=yF.parts.field1(a([TL.parts.label(l("Width")),s(!0)])),c=yF.parts.field2(a([TL.parts.label(l("Height")),s(!1)]));return yF.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[u,c,a([l("&nbsp;"),o])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(e,t,r){SF(eg.getValue(e)).each((function(e){n(e).each((function(e){eg.setValue(t,wF(e))}))}))},coupledFieldBehaviours:fd([Fv.config({disabled:function(){return e.disabled||t.isDisabled()},onDisabled:function(e){yF.getField1(e).bind(TL.getField).each(Fv.disable),yF.getField2(e).bind(TL.getField).each(Fv.disable),yF.getLock(e).each(Fv.disable)},onEnabled:function(e){yF.getField1(e).bind(TL.getField).each(Fv.enable),yF.getField2(e).bind(TL.getField).each(Fv.enable),yF.getLock(e).each(Fv.enable)}}),vE(),Uw("size-input-events2",[Rs(r,(function(e,t){var r=t.event.isField1,i=r?yF.getField1(e):yF.getField2(e),o=r?yF.getField2(e):yF.getField1(e),a=i.map(eg.getValue).getOr(""),s=o.map(eg.getValue).getOr("");n=DF(a,s)}))])])})},EF=w(il("undo")),_F=w(il("redo")),AF=w(il("zoom")),LF=w(il("back")),OF=w(il("apply")),RF=w(il("swap")),IF=w(il("transform")),PF=w(il("temp-transform")),MF=w(il("transform-apply")),NF={undo:EF,redo:_F,zoom:AF,back:LF,apply:OF,swap:RF,transform:IF,tempTransform:PF,transformApply:MF},FF=w("save-state"),BF=w("disable"),$F=w("enable"),zF={formActionEvent:$L,saveState:FF,disable:BF,enable:$F},UF=function(e,t){var n=function(e,n,r,i){return Ex(lF({name:e,text:e,disabled:r,primary:i,icon:N.none(),borderless:!1},n,t))},r=function(e,n,r,i){return Ex(aF({name:e,icon:N.some(e),tooltip:N.some(n),disabled:i,primary:!1,borderless:!1},r,t))},i=function(e,t){e.map((function(e){var n=e.get(t);n.hasConfigured(Fv)&&Fv.disable(n)}))},o=function(e,t){e.map((function(e){var n=e.get(t);n.hasConfigured(Fv)&&Fv.enable(n)}))},a={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},s=g,l=function(e,t,n){Cs(e,t,n)},u=function(e){return xs(e,zF.disable())},c=function(e){return xs(e,zF.enable())},d=function(e,t){u(e),l(e,NF.transform(),{transform:t}),c(e)},f=function(e,t){u(e),l(e,NF.tempTransform(),{transform:t}),c(e)},h=function(e){return function(){ae.getOpt(e).each((function(e){$w.set(e,[ie])}))}},m=function(e,t){u(e),l(e,NF.transformApply(),{transform:t,swap:h(e)}),c(e)},p=function(){return n("Back",(function(e){return l(e,NF.back(),{swap:h(e)})}),!1,!1)},v=function(){return Ex({dom:{tag:"div",classes:["tox-spacer"]},behaviours:fd([Fv.config({})])})},b=function(){return n("Apply",(function(e){return l(e,NF.apply(),{swap:h(e)})}),!0,!0)},y=function(){return function(t){var n=e.getRect();return RN(t,n.x,n.y,n.w,n.h)}},S=[p(),v(),n("Apply",(function(t){var n=y();m(t,n),e.hideCrop()}),!1,!0)],x=bL.sketch({dom:a,components:S.map((function(e){return e.asSpec()})),containerBehaviours:fd([Uw("image-tools-crop-buttons-events",[Rs(zF.disable(),(function(e,t){i(S,e)})),Rs(zF.enable(),(function(e,t){o(S,e)}))])])}),C=Ex(kF({name:"size",label:N.none(),constrain:!0,disabled:!1},t)),T=function(e,t){return function(n){return IN(n,e,t)}},D=[p(),v(),C,v(),n("Apply",(function(e){C.getOpt(e).each((function(t){var n=eg.getValue(t),r=parseInt(n.width,10),i=parseInt(n.height,10),o=T(r,i);m(e,o)}))}),!1,!0)],k=bL.sketch({dom:a,components:D.map((function(e){return e.asSpec()})),containerBehaviours:fd([Uw("image-tools-resize-buttons-events",[Rs(zF.disable(),(function(e,t){i(D,e)})),Rs(zF.enable(),(function(e,t){o(D,e)}))])])}),E=function(e,t){return function(n){return e(n,t)}},_=E(ON,"h"),A=E(ON,"v"),L=E(PN,-90),O=E(PN,90),R=function(e,t){f(e,t)},I=[p(),v(),r("flip-horizontally","Flip horizontally",(function(e){R(e,_)}),!1),r("flip-vertically","Flip vertically",(function(e){R(e,A)}),!1),r("rotate-left","Rotate counterclockwise",(function(e){R(e,L)}),!1),r("rotate-right","Rotate clockwise",(function(e){R(e,O)}),!1),v(),b()],P=bL.sketch({dom:a,components:I.map((function(e){return e.asSpec()})),containerBehaviours:fd([Uw("image-tools-fliprotate-buttons-events",[Rs(zF.disable(),(function(e,t){i(I,e)})),Rs(zF.enable(),(function(e,t){o(I,e)}))])])}),M=function(e,n,r,i,o){var a=OP.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:t.translate(e)}}),s=OP.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),l=OP.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return Ex(OP.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:r,maxX:o,getInitialValue:w({x:i})},components:[a,s,l],sliderBehaviours:fd([Xw.config({})]),onChoose:n}))},F=function(e,t,n,r,i){var o=function(e,n,r){var i=E(t,r.x/100);d(e,i)};return M(e,o,n,r,i)},B=function(e,t,n,r,i){return[p(),F(e,t,n,r,i),b()]},$=function(e,t,n,r,s){var l=B(e,t,n,r,s);return bL.sketch({dom:a,components:l.map((function(e){return e.asSpec()})),containerBehaviours:fd([Uw("image-tools-filter-panel-buttons-events",[Rs(zF.disable(),(function(e,t){i(l,e)})),Rs(zF.enable(),(function(e,t){o(l,e)}))])])})},z=[p(),v(),b()],U=bL.sketch({dom:a,components:z.map((function(e){return e.asSpec()}))}),V=$("Brightness",AN,-100,0,100),H=$("Contrast",LN,-100,0,100),j=$("Gamma",EN,-100,0,100),q=function(e,t,n){return function(r){return _N(r,e,t,n)}},G=function(e){var t=function(e,t,n){var r=W.getOpt(e),i=Y.getOpt(e),o=K.getOpt(e);r.each((function(t){i.each((function(n){o.each((function(r){var i=eg.getValue(t).x/100,o=eg.getValue(r).x/100,a=eg.getValue(n).x/100,s=q(i,o,a);d(e,s)}))}))}))};return M(e,t,0,100,200)},W=G("R"),K=G("G"),Y=G("B"),X=[p(),W,K,Y,b()],J=bL.sketch({dom:a,components:X.map((function(e){return e.asSpec()}))}),Q=function(e,t,n){return function(r){var i=function(){ae.getOpt(r).each((function(t){$w.set(t,[e]),n(t)}))};l(r,NF.swap(),{transform:t,swap:i})}},Z=function(t){e.showCrop()},ee=function(t){C.getOpt(t).each((function(t){var n=e.getMeasurements(),r=n.width,i=n.height;eg.setValue(t,{width:r,height:i})}))},te=N.some(kN),ne=N.some(DN),re=[r("crop","Crop",Q(x,N.none(),Z),!1),r("resize","Resize",Q(k,N.none(),ee),!1),r("orientation","Orientation",Q(P,N.none(),s),!1),r("brightness","Brightness",Q(V,N.none(),s),!1),r("sharpen","Sharpen",Q(U,te,s),!1),r("contrast","Contrast",Q(H,N.none(),s),!1),r("color-levels","Color levels",Q(J,N.none(),s),!1),r("gamma","Gamma",Q(j,N.none(),s),!1),r("invert","Invert",Q(U,ne,s),!1)],ie=bL.sketch({dom:a,components:re.map((function(e){return e.asSpec()}))}),oe=bL.sketch({dom:{tag:"div"},components:[ie],containerBehaviours:fd([$w.config({})])}),ae=Ex(oe),se=function(e){return ae.getOpt(e).map((function(e){var t=e.components()[0];return t.components()[t.components().length-1]}))};return{memContainer:ae,getApplyButton:se}},VF=tinymce.util.Tools.resolve("tinymce.geom.Rect"),HF=tinymce.util.Tools.resolve("tinymce.util.Observable"),jF=tinymce.util.Tools.resolve("tinymce.util.VK"),qF=function(e){var t=Math.max,n=e.documentElement,r=e.body,i=t(n.scrollWidth,r.scrollWidth),o=t(n.clientWidth,r.clientWidth),a=t(n.offsetWidth,r.offsetWidth),s=t(n.scrollHeight,r.scrollHeight),l=t(n.clientHeight,r.clientHeight),u=t(n.offsetHeight,r.offsetHeight);return{width:i<a?o:i,height:s<u?l:s}},GF=function(e){return f(e.changedTouches)},WF=function(e){if(GF(e))for(var t="screenX screenY pageX pageY clientX clientY".split(" "),n=0;n<t.length;n++)e[t[n]]=e.changedTouches[0][t[n]]};function KF(e,t){var n,r,i,o,a,s,l,u=[],c=[],d=null!==(n=t.document)&&void 0!==n?n:document,h=null!==(r=t.root)&&void 0!==r?r:d,m=tt.fromDom(d),p=tt.fromDom(h.getElementById(null!==(i=t.handle)&&void 0!==i?i:e)),g=function(e){var n=e.raw,r=qF(d);WF(n),e.prevent(),a=n.button,s=n.screenX,l=n.screenY;var i=Jn(p,"cursor");o=tt.fromTag("div",d),Yn(o,{position:"absolute",top:"0",left:"0",width:r.width+"px",height:r.height+"px","z-index":"2147483647",opacity:"0.0001",cursor:i}),Lr(Bn(m),o),c.push(af(m,"mousemove",v),af(m,"touchmove",v),af(m,"mouseup",b),af(m,"touchend",b)),t.start(n)},v=function(e){var n=e.raw;if(WF(n),n.button!==a)return b(e);n.deltaX=n.screenX-s,n.deltaY=n.screenY-l,e.prevent(),t.drag(n)},b=function(e){WF(e.raw),W(c,(function(e){return e.unbind()})),c=[],Mr(o),t.stop&&t.stop(e.raw)},y=function(){W(c.concat(u),(function(e){return e.unbind()})),c=[],u=[],f(o)&&Mr(o)};return u.push(af(p,"mousedown",g),af(p,"touchstart",g)),{destroy:y}}var YF=0,XF=function(e,t,n,r,i){var o,a=[],s="tox-",l=s+"crid-"+YF++,u=tt.fromDom(r),c=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],d=["top","right","bottom","left"],f=function(e,t){return{x:t.x+e.x,y:t.y+e.y,w:t.w,h:t.h}},h=function(e,t){return{x:t.x-e.x,y:t.y-e.y,w:t.w,h:t.h}},m=function(){return h(n,e)},p=function(t,r,i,o){var a=r.x+i*t.deltaX,s=r.y+o*t.deltaY,l=Math.max(20,r.w+i*t.deltaW),u=Math.max(20,r.h+o*t.deltaH),c=e=VF.clamp({x:a,y:s,w:l,h:u},n,"move"===t.name);c=h(n,c),T.fire("updateRect",{rect:c}),S(c)},g=function(){var t=function(t){var n;return KF(l,{document:r.ownerDocument,root:An(u).dom,handle:l+"-"+t.name,start:function(){n=e},drag:function(e){p(t,n,e.deltaX,e.deltaY)}})},n=tt.fromTag("div");Un(n,{id:l,class:s+"croprect-container",role:"grid","aria-dropeffect":"execute"}),Lr(u,n),W(d,(function(e){Bu(u,"#"+l).each((function(t){var n=tt.fromTag("div");Un(n,{id:l+"-"+e,class:s+"croprect-block","data-mce-bogus":"all"}),Kn(n,"display","none"),Lr(t,n)}))})),W(c,(function(e){Bu(u,"#"+l).each((function(t){var n=tt.fromTag("div");Un(n,{id:l+"-"+e.name,"aria-label":e.label,"aria-grabbed":"false","data-mce-bogus":"all",role:"gridcell",tabindex:"-1",title:e.label}),uu(n,[s+"croprect-handle",s+"croprect-handle-"+e.name]),Kn(n,"display","none"),Lr(t,n)}))})),o=G(c,t),b(e);var f=function(e){zn(e.target,"aria-grabbed","focus"===e.raw.type?"true":"false")},h=function(t){var n;W(c,(function(e){if(Vn(t.target,"id")===l+"-"+e.name)return n=e,!1}));var r=function(e,t,r,i,o){e.stopPropagation(),e.preventDefault(),p(n,r,i,o)};switch(t.raw.keyCode){case jF.LEFT:r(t,n,e,-10,0);break;case jF.RIGHT:r(t,n,e,10,0);break;case jF.UP:r(t,n,e,0,-10);break;case jF.DOWN:r(t,n,e,0,10);break;case jF.ENTER:case jF.SPACEBAR:t.prevent(),i();break}};a.push(af(u,"focusin",f),af(u,"focusout",f),af(u,"keydown",h))},v=function(e){var t=O(O([],G(c,(function(e){return"#"+l+"-"+e.name})),!0),G(d,(function(e){return"#"+l+"-"+e})),!0).join(","),n=Yh(u,t);W(n,e?function(e){return nr(e,"display")}:function(e){return Kn(e,"display","none")})},b=function(e){var n=function(e,t){Bu(u,"#"+l+"-"+e).each((function(e){Yn(e,{left:t.x+"px",top:t.y+"px",width:Math.max(0,t.w)+"px",height:Math.max(0,t.h)+"px"})}))};W(c,(function(t){Bu(u,"#"+l+"-"+t.name).each((function(n){Yn(n,{left:e.w*t.xMul+e.x+"px",top:e.h*t.yMul+e.y+"px"})}))})),n("top",{x:t.x,y:t.y,w:t.w,h:e.y-t.y}),n("right",{x:e.x+e.w,y:e.y,w:t.w-e.x-e.w+t.x,h:e.h}),n("bottom",{x:t.x,y:e.y+e.h,w:t.w,h:t.h-e.y-e.h+t.y}),n("left",{x:t.x,y:e.y,w:e.x-t.x,h:e.h}),n("move",e)},y=function(t){e=t,b(e)},w=function(n){t=n,b(e)},S=function(e){y(f(n,e))},x=function(t){n=t,b(e)},C=function(){W(o,(function(e){return e.destroy()})),o=[],W(a,(function(e){return e.unbind()})),a=[]};g();var T=A(A({},HF),{toggleVisibility:v,setClampRect:x,setRect:y,getInnerRect:m,setInnerRect:S,setViewPortRect:w,destroy:C});return T},JF={create:XF},QF=function(e){return new pT((function(t){var n=function(){e.removeEventListener("load",n),t(e)};e.complete?t(e):e.addEventListener("load",n)}))},ZF=function(e){var t=Ex({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),n=ia(1),r=nf(),i=ia({x:0,y:0,w:1,h:1}),o=ia({x:0,y:0,w:1,h:1}),a=function(e,o){m.getOpt(e).each((function(e){var a=n.get(),s=vr(e.element),l=ar(e.element),u=o.dom.naturalWidth*a,c=o.dom.naturalHeight*a,d=Math.max(0,s/2-u/2),f=Math.max(0,l/2-c/2),h={left:d.toString()+"px",top:f.toString()+"px",width:u.toString()+"px",height:c.toString()+"px",position:"absolute"};Yn(o,h),t.getOpt(e).each((function(e){Yn(e.element,h)})),r.run((function(e){var t=i.get();e.setRect({x:t.x*a+d,y:t.y*a+f,w:t.w*a,h:t.h*a}),e.setClampRect({x:d,y:f,w:u,h:c}),e.setViewPortRect({x:0,y:0,w:s,h:l})}))}))},s=function(e,t){m.getOpt(e).each((function(e){var r=vr(e.element),i=ar(e.element),o=t.dom.naturalWidth,a=t.dom.naturalHeight,s=Math.min(r/o,i/a);s>=1?n.set(1):n.set(s)}))},l=function(e,t){var n=tt.fromTag("img");return zn(n,"src",t),QF(n.dom).then((function(){e.getSystem().isConnected()&&m.getOpt(e).map((function(e){var t=Tu({element:n});$w.replaceAt(e,1,N.some(t));var r=o.get(),l={x:0,y:0,w:n.dom.naturalWidth,h:n.dom.naturalHeight};o.set(l);var u=VF.inflate(l,-20,-20);i.set(u),r.w===l.w&&r.h===l.h||s(e,n),a(e,n)}))}))},u=function(e,t){var r=n.get(),i=t>0?Math.min(2,r+.1):Math.max(.1,r-.1);n.set(i),m.getOpt(e).each((function(e){var t=e.components()[1].element;a(e,t)}))},c=function(){r.run((function(e){e.toggleVisibility(!0)}))},d=function(){r.run((function(e){e.toggleVisibility(!1)}))},f=function(){return i.get()},h=bL.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[t.asSpec(),{dom:{tag:"img",attributes:{src:e}}},{dom:{tag:"div"},behaviours:fd([Uw("image-panel-crop-events",[Vs((function(e){m.getOpt(e).each((function(e){var t=e.element.dom,o=JF.create({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},t,g);o.toggleVisibility(!1),o.on("updateRect",(function(e){var t=e.rect,r=n.get(),o={x:Math.round(t.x/r),y:Math.round(t.y/r),w:Math.round(t.w/r),h:Math.round(t.h/r)};i.set(o)})),r.set(o)}))})),Hs((function(){r.clear()}))])])}],containerBehaviours:fd([$w.config({}),Uw("image-panel-events",[Vs((function(t){l(t,e)}))])])}),m=Ex(h),p=function(){var e=o.get();return{width:e.w,height:e.h}};return{memContainer:m,updateSrc:l,zoom:u,showCrop:c,hideCrop:d,getRect:f,getMeasurements:p}},eB=function(e,t,n,r,i){return aF({name:e,icon:N.some(t),disabled:n,tooltip:N.some(e),primary:!1,borderless:!1},r,i)},tB=function(e,t){t?Fv.enable(e):Fv.disable(e)},nB=function(e){var t=function(e,t,i){n.getOpt(e).each((function(e){tB(e,t)})),r.getOpt(e).each((function(e){tB(e,i)}))},n=Ex(eB("Undo","undo",!0,(function(e){Cs(e,NF.undo(),{direction:1})}),e)),r=Ex(eB("Redo","redo",!0,(function(e){Cs(e,NF.redo(),{direction:1})}),e)),i=bL.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[n.asSpec(),r.asSpec(),eB("Zoom in","zoom-in",!1,(function(e){Cs(e,NF.zoom(),{direction:1})}),e),eB("Zoom out","zoom-out",!1,(function(e){Cs(e,NF.zoom(),{direction:-1})}),e)]});return{container:i,updateButtonUndoStates:t}};function rB(){var e=[],t=-1,n=function(n){var r=e.splice(++t);return e.push(n),{state:n,removed:r}},r=function(){if(o())return e[--t]},i=function(){if(a())return e[++t]},o=function(){return t>0},a=function(){return-1!==t&&t<e.length-1};return{data:e,add:n,undo:r,redo:i,canUndo:o,canRedo:a}}var iB,oB=function(e){var t=ia(e),n=rf(),r=rB();r.add(e);var i=function(){return t.get()},o=function(e){t.set(e)},a=function(){return n.get().getOrThunk(t.get)},s=function(e){var t=l(e);return d(),n.set(t),t.url},l=function(e){return{blob:e,url:URL.createObjectURL(e)}},u=function(e){URL.revokeObjectURL(e.url)},c=function(e){sM.each(e,u)},d=function(){n.on(u),n.clear()},f=function(e){var t=l(e);o(t);var n=r.add(t).removed;return c(n),t.url},h=function(e){var t=l(e);return n.set(t),t.url},m=function(e){return n.get().fold(g,(function(t){f(t.blob),e()}))},p=function(){var e=r.undo();return o(e),e.url},v=function(){var e=r.redo();return o(e),e.url},b=function(){var e=r.canUndo(),t=r.canRedo();return{undoEnabled:e,redoEnabled:t}};return{getBlobState:i,setBlobState:o,addBlobState:f,getTempState:a,updateTempState:s,addTempState:h,applyTempState:m,destroyTempState:d,undo:p,redo:v,getHistoryStates:b}},aB=function(e,t){var n=oB(e.currentState),r=function(e,t){var n=t.event.direction;T.zoom(e,n)},i=function(e){var t=n.getHistoryStates();D.updateButtonUndoStates(e,t.undoEnabled,t.redoEnabled),Cs(e,zF.formActionEvent,{name:zF.saveState(),value:t.undoEnabled})},o=function(e){D.updateButtonUndoStates(e,!1,!1)},a=function(e,t){var r=n.undo();d(e,r).then((function(t){c(e),i(e)}))},s=function(e,t){var r=n.redo();d(e,r).then((function(t){c(e),i(e)}))},l=function(e){return e.toBlob()},u=function(e){Cs(e,zF.formActionEvent,{name:zF.disable(),value:{}})},c=function(e){k.getApplyButton(e).each((function(e){Fv.enable(e)})),Cs(e,zF.formActionEvent,{name:zF.enable(),value:{}})},d=function(e,t){return u(e),T.updateSrc(e,t)},f=function(e,t,n,r,o){u(e),WM(t).then(n).then(l).then(r).then((function(t){return d(e,t)})).then((function(){i(e),o(),c(e)})).catch((function(t){console.log(t),e.getSystem().isConnected()&&c(e)}))},h=function(e,t,r){var i=n.getBlobState().blob,o=function(e){return n.updateTempState(e)};f(e,i,t,o,r)},m=function(e,t){var r=n.getTempState().blob,i=function(e){return n.addTempState(e)};f(e,r,t,i,g)},p=function(e,t,r){var i=n.getBlobState().blob,o=function(t){var r=n.addBlobState(t);return b(e),r};f(e,i,t,o,r)},v=function(e,t){var r=function(){b(e);var n=t.event.swap;n()};n.applyTempState(r)},b=function(e){var t=n.getBlobState().url;return n.destroyTempState(),i(e),t},y=function(e){var t=b(e);d(e,t).then((function(t){c(e)}))},w=function(e,t){y(e);var n=t.event.swap;n(),T.hideCrop()},S=function(e,t){return h(e,t.event.transform,g)},x=function(e,t){return m(e,t.event.transform)},C=function(e,t){return p(e,t.event.transform,t.event.swap)},T=ZF(e.currentState.url),D=nB(t),k=UF(T,t),E=function(e,t){o(e);var n=t.event.transform,r=t.event.swap;n.fold((function(){r()}),(function(t){h(e,t,r)}))};return{dom:{tag:"div",attributes:{role:"presentation"}},components:[k.memContainer.asSpec(),T.memContainer.asSpec(),D.container],behaviours:fd([eg.config({store:{mode:"manual",getValue:function(){return n.getBlobState()}}}),Uw("image-tools-events",[Rs(NF.undo(),a),Rs(NF.redo(),s),Rs(NF.zoom(),r),Rs(NF.back(),w),Rs(NF.apply(),v),Rs(NF.transform(),S),Rs(NF.tempTransform(),x),Rs(NF.transformApply(),C),Rs(NF.swap(),E)]),ZP.self()])}},sB=function(e,t){var n={dom:{tag:"label",innerHtml:t.providers.translate(e.label),classes:["tox-label"]}},r=G(e.items,t.interpreter);return{dom:{tag:"div",classes:["tox-form__group"]},components:[n].concat(r),behaviours:fd([ZP.self(),$w.config({}),pM.domHtml(N.none()),Aw.config({mode:"acyclic"})])}},lB=function(e){return!Ee(e,"items")},uB="data-value",cB=function(e,t,n,r){return G(n,(function(n){return lB(n)?{type:"togglemenuitem",text:n.text,value:n.value,active:n.value===r,onAction:function(){eg.setValue(e,n.value),Cs(e,NL,{name:t}),Xw.focus(e)}}:{type:"nestedmenuitem",text:n.text,getSubmenuItems:function(){return cB(e,t,n.items,r)}}}))},dB=function(e,t){return me(e,(function(e){return lB(e)?Ne(e.value===t,e):dB(e.items,t)}))},fB=function(e,t){var n=t.shared.providers,r=de(e.items).filter(lB),i=e.label.map((function(e){return ML(e,n)})),o=TL.parts.field({dom:{},factory:{sketch:function(n){return jN({uid:n.uid,text:r.map((function(e){return e.text})),icon:N.none(),tooltip:e.label,role:N.none(),fetch:function(n,r){var i=cB(n,e.name,e.items,eg.getValue(n));r(eF(i,QT.CLOSE_ON_EXECUTE,t,!1))},onSetup:w(g),getApi:w({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[_L.config({}),eg.config({store:{mode:"manual",initialValue:r.map((function(e){return e.value})).getOr(""),getValue:function(e){return Vn(e.element,uB)},setValue:function(t,n){dB(e.items,n).each((function(e){zn(t.element,uB,e.value),Cs(t,VN,{text:e.text})}))}}})]},"tox-listbox",t.shared)}}}),a={dom:{tag:"div",classes:["tox-listboxfield"]},components:[o]};return TL.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:ne([i.toArray(),[a]]),fieldBehaviours:fd([Fv.config({disabled:w(e.disabled),onDisabled:function(e){TL.getField(e).each(Fv.disable)},onEnabled:function(e){TL.getField(e).each(Fv.enable)}})])})},hB=function(e,t){return{dom:{tag:"div",classes:e.classes},components:G(e.items,t.shared.interpreter)}},mB=function(e,t){var n=G(e.options,(function(e){return{dom:{tag:"option",value:e.value,innerHtml:e.text}}})),r=e.data.map((function(e){return ha("initialValue",e)})).getOr({});return{uid:e.uid,dom:{tag:"select",classes:e.selectClasses,attributes:e.selectAttributes},components:n,behaviours:rg(e.selectBehaviours,[Xw.config({}),eg.config({store:A({mode:"manual",getValue:function(e){return fu(e.element)},setValue:function(t,n){var r=ee(e.options,(function(e){return e.value===n}));r.isSome()&&hu(t.element,n)}},r)})])}},pB=fv({name:"HtmlSelect",configFields:[Ao("options"),tg("selectBehaviours",[Xw,eg]),Ko("selectClasses",[]),Ko("selectAttributes",{}),zo("data")],factory:mB}),gB=function(e,t){var n=G(e.items,(function(e){return{text:t.translate(e.text),value:e.value}})),r=e.label.map((function(e){return ML(e,t)})),i=TL.parts.field({dom:{},selectAttributes:{size:e.size},options:n,factory:pB,selectBehaviours:fd([Fv.config({disabled:function(){return e.disabled||t.isDisabled()}}),_L.config({}),Uw("selectbox-change",[Rs(Ha(),(function(t,n){Cs(t,NL,{name:e.name})}))])])}),o=e.size>1?N.none():N.some(qC("chevron-down",{tag:"div",classes:["tox-selectfield__icon-js"]},t.icons)),a={dom:{tag:"div",classes:["tox-selectfield"]},components:ne([[i],o.toArray()])};return TL.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:ne([r.toArray(),[a]]),fieldBehaviours:fd([Fv.config({disabled:function(){return e.disabled||t.isDisabled()},onDisabled:function(e){TL.getField(e).each(Fv.disable)},onEnabled:function(e){TL.getField(e).each(Fv.enable)}}),vE()])})},vB=function(e,t){var n=function(e){return{dom:{tag:"th",innerHtml:t.translate(e)}}},r=function(e){return{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:G(e,n)}]}},i=function(e){return{dom:{tag:"td",innerHtml:t.translate(e)}}},o=function(e){return{dom:{tag:"tr"},components:G(e,i)}},a=function(e){return{dom:{tag:"tbody"},components:G(e,o)}};return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[r(e.header),a(e.cells)],behaviours:fd([_L.config({}),Xw.config({})])}},bB=function(e,t){var n=e.label.map((function(e){return ML(e,t)})),r=[Fv.config({disabled:function(){return e.disabled||t.isDisabled()}}),vE(),Aw.config({mode:"execution",useEnter:!0!==e.multiline,useControlEnter:!0===e.multiline,execute:function(e){return xs(e,zL),N.some(!0)}}),Uw("textfield-change",[Rs(Va(),(function(t,n){Cs(t,NL,{name:e.name})})),Rs(Za(),(function(t,n){Cs(t,NL,{name:e.name})}))]),_L.config({})],i=e.validation.map((function(e){return SO.config({getRoot:function(e){return vn(e.element)},invalidClass:"tox-invalid",validator:{validate:function(t){var n=eg.getValue(t),r=e.validator(n);return uO.pure(!0===r?ri.value(n):ri.error(r))},validateOnLoad:e.validateOnLoad}})})).toArray(),o=e.placeholder.fold(w({}),(function(e){return{placeholder:t.translate(e)}})),a=e.inputMode.fold(w({}),(function(e){return{inputmode:e}})),s=A(A({},o),a),l=TL.parts.field({tag:!0===e.multiline?"textarea":"input",inputAttributes:s,inputClasses:[e.classname],inputBehaviours:fd(ne([r,i])),selectOnFocus:!1,factory:JL}),u=e.flex?["tox-form__group--stretched"]:[],c=u.concat(e.maximized?["tox-form-group--maximize"]:[]),d=[Fv.config({disabled:function(){return e.disabled||t.isDisabled()},onDisabled:function(e){TL.getField(e).each(Fv.disable)},onEnabled:function(e){TL.getField(e).each(Fv.enable)}}),vE()];return LL(n,l,c,d)},yB=function(e,t){return bB({name:e.name,multiline:!1,label:e.label,inputMode:e.inputMode,placeholder:e.placeholder,flex:!1,disabled:e.disabled,classname:"tox-textfield",validation:N.none(),maximized:e.maximized},t)},wB=function(e,t){return bB({name:e.name,multiline:!0,label:e.label,inputMode:N.none(),placeholder:e.placeholder,flex:!0,disabled:e.disabled,classname:"tox-textarea",validation:N.none(),maximized:e.maximized},t)},SB=function(e,t){var n=e.stream.streams,r=n.setup(e,t);return _s([Rs(e.event,r),Hs((function(){return t.cancel()}))].concat(e.cancelEvent.map((function(e){return[Rs(e,(function(){return t.cancel()}))]})).getOr([])))},xB=Object.freeze({__proto__:null,events:SB}),CB=function(e){var t=ia(null),n=function(){return{timer:null!==t.get()?"set":"unset"}},r=function(e){t.set(e)},i=function(){var e=t.get();null!==e&&e.cancel()};return Dl({readState:n,setTimer:r,cancel:i})},TB=function(e){return e.stream.streams.state(e)},DB=Object.freeze({__proto__:null,throttle:CB,init:TB}),kB=function(e,t){var n=e.stream,r=ZC(e.onStream,n.delay);return t.setTimer(r),function(e,t){r.throttle(e,t),n.stopEvent&&t.stop()}},EB=[Lo("stream",To("mode",{throttle:[Ao("delay"),Ko("stopEvent",!0),dc("streams",{setup:kB,state:CB})]})),Ko("event","input"),zo("cancelEvent"),uc("onStream")],_B=md({fields:EB,name:"streaming",active:xB,state:DB}),AB=function(e,t,n){var r=eg.getValue(n);eg.setValue(t,r),OB(t)},LB=function(e,t){var n=e.element,r=fu(n),i=n.dom;"number"!==Vn(n,"type")&&t(i,r)},OB=function(e){LB(e,(function(e,t){return e.setSelectionRange(t.length,t.length)}))},RB=function(e,t){LB(e,(function(e,n){return e.setSelectionRange(t,n.length)}))},IB=function(e,t,n){if(e.selectsOver){var r=eg.getValue(t),i=e.getDisplayText(r),o=eg.getValue(n),a=e.getDisplayText(o);return 0===a.indexOf(i)?N.some((function(){AB(e,t,n),RB(t,i.length)})):N.none()}return N.none()},PB=w("alloy.typeahead.itemexecute"),MB=function(e,t,n,r){var i=function(t,n,i){e.previewing.set(!1);var o=EO.getCoupled(t,"sandbox");if(bp.isOpen(o))bv.getCurrent(o).each((function(e){rb.getHighlighted(e).fold((function(){i(e)}),(function(){Es(o,e.element,"keydown",n)}))}));else{var s=function(e){bv.getCurrent(e).each(i)};PO(e,a(t),t,o,r,s,eO.HighlightFirst).get(g)}},o=WL(e),a=function(e){return function(t){return t.map((function(t){var n=De(t.menus),r=re(n,(function(e){return X(e.items,(function(e){return"item"===e.type}))})),i=eg.getState(e);return i.update(G(r,(function(e){return e.data}))),t}))}},s=[Xw.config({}),eg.config({onSetValue:e.onSetValue,store:A({mode:"dataset",getDataKey:function(e){return fu(e.element)},getFallbackEntry:function(e){return{value:e,meta:{}}},setValue:function(t,n){hu(t.element,e.model.getDisplayText(n))}},e.initialData.map((function(e){return ha("initialValue",e)})).getOr({}))}),_B.config({stream:{mode:"throttle",delay:e.responseTime,stopEvent:!1},onStream:function(t,n){var i=EO.getCoupled(t,"sandbox"),o=Xw.isFocused(t);if(o&&fu(t.element).length>=e.minChars){var s=bv.getCurrent(i).bind((function(e){return rb.getHighlighted(e).map(eg.getValue)}));e.previewing.set(!0);var l=function(t){bv.getCurrent(i).each((function(t){s.fold((function(){e.model.selectsOver&&rb.highlightFirst(t)}),(function(e){rb.highlightBy(t,(function(t){var n=eg.getValue(t);return n.value===e.value})),rb.getHighlighted(t).orThunk((function(){return rb.highlightFirst(t),N.none()}))}))}))};PO(e,a(t),t,i,r,l,eO.HighlightFirst).get(g)}},cancelEvent:as()}),Aw.config({mode:"special",onDown:function(e,t){return i(e,t,rb.highlightFirst),N.some(!0)},onEscape:function(e){var t=EO.getCoupled(e,"sandbox");return bp.isOpen(t)?(bp.close(t),N.some(!0)):N.none()},onUp:function(e,t){return i(e,t,rb.highlightLast),N.some(!0)},onEnter:function(t){var n=EO.getCoupled(t,"sandbox"),r=bp.isOpen(n);if(r&&!e.previewing.get())return bv.getCurrent(n).bind((function(e){return rb.getHighlighted(e)})).map((function(e){return Cs(t,PB(),{item:e}),!0}));var i=eg.getValue(t);return xs(t,as()),e.onExecute(n,t,i),r&&bp.close(n),N.some(!0)}}),pS.config({toggleClass:e.markers.openClass,aria:{mode:"expanded"}}),EO.config({others:{sandbox:function(t){return zO(e,t,{onOpen:function(){return pS.on(t)},onClose:function(){return pS.off(t)}})}}}),Uw("typeaheadevents",[qs((function(t){var n=g;NO(e,a(t),t,r,n,eO.HighlightFirst).get(g)})),Rs(PB(),(function(t,n){var r=EO.getCoupled(t,"sandbox");AB(e.model,t,n.event.item),xs(t,as()),e.onItemExecute(t,r,n.event.item,eg.getValue(t)),bp.close(r),OB(t)}))].concat(e.dismissOnBlur?[Rs(Qa(),(function(e){var t=EO.getCoupled(e,"sandbox");kd(t.element).isNone()&&bp.close(t)}))]:[]))];return{uid:e.uid,dom:YL(Si(e,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:A(A({},o),rg(e.typeaheadBehaviours,s)),eventOrder:e.eventOrder}},NB=w([zo("lazySink"),Ao("fetch"),Ko("minChars",5),Ko("responseTime",1e3),sc("onOpen"),Ko("getHotspot",N.some),Ko("getAnchorOverrides",w({})),Ko("layouts",N.none()),Ko("eventOrder",{}),ra("model",{},[Ko("getDisplayText",(function(e){return void 0!==e.meta&&void 0!==e.meta.text?e.meta.text:e.value})),Ko("selectsOver",!0),Ko("populateFromBrowse",!0)]),sc("onSetValue"),lc("onExecute"),sc("onItemExecute"),Ko("inputClasses",[]),Ko("inputAttributes",{}),Ko("inputStyles",{}),Ko("matchWidth",!0),Ko("useMinWidth",!1),Ko("dismissOnBlur",!0),oc(["openClass"]),zo("initialData"),tg("typeaheadBehaviours",[Xw,eg,_B,Aw,pS,EO]),Eo("previewing",(function(){return ia(!0)}))].concat(GL()).concat(VO())),FB=w([Pg({schema:[ic()],name:"menu",overrides:function(e){return{fakeFocus:!0,onHighlight:function(t,n){e.previewing.get()?t.getSystem().getByUid(e.uid).each((function(r){IB(e.model,r,n).fold((function(){return rb.dehighlight(t,n)}),(function(e){return e()}))})):t.getSystem().getByUid(e.uid).each((function(t){e.model.populateFromBrowse&&AB(e.model,t,n)})),e.previewing.set(!1)},onExecute:function(t,n){return t.getSystem().getByUid(e.uid).toOptional().map((function(e){return Cs(e,PB(),{item:n}),!0}))},onHover:function(t,n){e.previewing.set(!1),t.getSystem().getByUid(e.uid).each((function(t){e.model.populateFromBrowse&&AB(e.model,t,n)}))}}}})]),BB=hv({name:"Typeahead",configFields:NB(),partFields:FB(),factory:MB}),$B=function(e){var t=function(){return $B(e.toCached())},n=function(t){return $B(e.bind((function(e){return e.fold((function(e){return uO.pure(ri.error(e))}),(function(e){return t(e)}))})))},r=function(t){return $B(e.map((function(e){return e.bind(t)})))},i=function(t){return $B(e.map((function(e){return e.map(t)})))},o=function(t){return $B(e.map((function(e){return e.mapError(t)})))},a=function(t,n){return e.map((function(e){return e.fold(t,n)}))},s=function(t,n){return $B(uO.nu((function(r){var i=!1,o=setTimeout((function(){i=!0,r(ri.error(n()))}),t);e.get((function(e){i||(clearTimeout(o),r(e))}))})))};return A(A({},e),{toCached:t,bindFuture:n,bindResult:r,mapResult:i,mapError:o,foldResult:a,withTimeout:s})},zB=function(e){return $B(uO.nu(e))},UB=function(e){return $B(uO.pure(ri.value(e)))},VB=function(e){return $B(uO.pure(ri.error(e)))},HB=function(e){return $B(uO.pure(e))},jB=function(e){return $B(e.map(ri.value))},qB=function(e){return zB((function(t){e.then((function(e){t(ri.value(e))}),(function(e){t(ri.error(e))}))}))},GB={nu:zB,wrap:$B,pure:UB,value:UB,error:VB,fromResult:HB,fromFuture:jB,fromPromise:qB},WB={type:"separator"},KB=function(e){return{type:"menuitem",value:e.url,text:e.title,meta:{attach:e.attach},onAction:g}},YB=function(e,t){return{type:"menuitem",value:t,text:e,meta:{attach:void 0},onAction:g}},XB=function(e){return G(e,KB)},JB=function(e,t){return X(t,(function(t){return t.type===e}))},QB=function(e,t){return XB(JB(e,t))},ZB=function(e){return QB("header",e.targets)},e$=function(e){return QB("anchor",e.targets)},t$=function(e){return N.from(e.anchorTop).map((function(e){return YB("<top>",e)})).toArray()},n$=function(e){return N.from(e.anchorBottom).map((function(e){return YB("<bottom>",e)})).toArray()},r$=function(e){return G(e,(function(e){return YB(e,e)}))},i$=function(e){return Q(e,(function(e,t){var n=0===e.length||0===t.length;return n?e.concat(t):e.concat(WB,t)}),[])},o$=function(e,t){var n=e.toLowerCase();return X(t,(function(e){var t=void 0!==e.meta&&void 0!==e.meta.text?e.meta.text:e.text;return Ve(t.toLowerCase(),n)||Ve(e.value.toLowerCase(),n)}))},a$=function(e,t,n){var r=eg.getValue(t),i=void 0!==r.meta.text?r.meta.text:r.value,o=n.getLinkInformation();return o.fold((function(){return[]}),(function(t){var r=o$(i,r$(n.getHistory(e)));return"file"===e?i$([r,o$(i,ZB(t)),o$(i,ne([t$(t),e$(t),n$(t)]))]):r}))},s$=il("aria-invalid"),l$=function(e,t,n){var r,i=t.shared.providers,o=function(t){var r=eg.getValue(t);n.addToHistory(r.value,e.filetype)},a=TL.parts.field({factory:BB,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":s$,type:"url"},minChars:0,responseTime:0,fetch:function(r){var i=a$(e.filetype,r,n),o=eF(i,QT.BUBBLE_TO_SANDBOX,t,!1);return uO.pure(o)},getHotspot:function(e){return h.getOpt(e)},onSetValue:function(e,t){e.hasConfigured(SO)&&SO.run(e).get(g)},typeaheadBehaviours:fd(ne([n.getValidationHandler().map((function(t){return SO.config({getRoot:function(e){return vn(e.element)},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(e,t){u.getOpt(e).each((function(e){zn(e.element,"title",i.translate(t))}))}},validator:{validate:function(n){var r=eg.getValue(n);return GB.nu((function(n){t({type:e.filetype,url:r.value},(function(e){if("invalid"===e.status){var t=ri.error(e.message);n(t)}else{var r=ri.value(e.message);n(r)}}))}))},validateOnLoad:!1}})})).toArray(),[Fv.config({disabled:function(){return e.disabled||i.isDisabled()}}),_L.config({}),Uw("urlinput-events",ne(["file"===e.filetype?[Rs(Va(),(function(t){Cs(t,NL,{name:e.name})}))]:[],[Rs(Ha(),(function(t){Cs(t,NL,{name:e.name}),o(t)})),Rs(Za(),(function(t){Cs(t,NL,{name:e.name}),o(t)}))]]))]])),eventOrder:(r={},r[Va()]=["streaming","urlinput-events","invalidating"],r),model:{getDisplayText:function(e){return e.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:t.shared.getSink,parts:{menu:DD(!1,1,"normal")},onExecute:function(e,t,n){Cs(t,zL,{})},onItemExecute:function(t,n,r,i){o(t),Cs(t,NL,{name:e.name})}}),s=e.label.map((function(e){return ML(e,i)})),l=function(e,t,n,r){return void 0===n&&(n=e),void 0===r&&(r=e),qC(n,{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+e],attributes:A({title:i.translate(r),"aria-live":"polite"},t.fold((function(){return{}}),(function(e){return{id:e}})))},i.icons)},u=Ex(l("invalid",N.some(s$),"warning")),c=Ex({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[u.asSpec()]}),d=n.getUrlPicker(e.filetype),f=il("browser.url.event"),h=Ex({dom:{tag:"div",classes:["tox-control-wrap"]},components:[a,c.asSpec()],behaviours:fd([Fv.config({disabled:function(){return e.disabled||i.isDisabled()}})])}),m=Ex(lF({name:e.name,icon:N.some("browse"),text:e.label.getOr(""),disabled:e.disabled,primary:!1,borderless:!0},(function(e){return xs(e,f)}),i,[],["tox-browse-url"])),p=function(){return{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:ne([[h.asSpec()],d.map((function(){return m.asSpec()})).toArray()])}},v=function(t){bv.getCurrent(t).each((function(n){var r=eg.getValue(n),i=A({fieldname:e.name},r);d.each((function(r){r(i).get((function(r){eg.setValue(n,r),Cs(t,NL,{name:e.name})}))}))}))};return TL.sketch({dom:IL(),components:s.toArray().concat([p()]),fieldBehaviours:fd([Fv.config({disabled:function(){return e.disabled||i.isDisabled()},onDisabled:function(e){TL.getField(e).each(Fv.disable),m.getOpt(e).each(Fv.disable)},onEnabled:function(e){TL.getField(e).each(Fv.enable),m.getOpt(e).each(Fv.enable)}}),vE(),Uw("url-input-events",[Rs(f,v)])])})},u$=function(e,t){return bL.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+e.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[Cx.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:zC(e.icon,t.icons),attributes:{title:t.translate(e.iconTooltip)}},action:function(t){Cs(t,$L,{name:"alert-banner",value:e.url})},buttonBehaviours:fd([HC()])})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:t.translate(e.text)}}]})},c$=function(e,t){var n=eg.config({store:{mode:"manual",getValue:function(e){var t=e.element.dom;return t.checked},setValue:function(e,t){var n=e.element.dom;n.checked=t}}}),r=function(e){return e.element.dom.click(),N.some(!0)},i=TL.parts.field({factory:{sketch:S},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:fd([ZP.self(),Fv.config({disabled:function(){return e.disabled||t.isDisabled()}}),_L.config({}),Xw.config({}),n,Aw.config({mode:"special",onEnter:r,onSpace:r,stopSpaceKeyup:!0}),Uw("checkbox-events",[Rs(Ha(),(function(t,n){Cs(t,NL,{name:e.name})}))])])}),o=TL.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:t.translate(e.label)},behaviours:fd([XO.config({})])}),a=function(e){var n="checked"===e?"selected":"unselected";return qC(n,{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+e]},t.icons)},s=Ex({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[a("checked"),a("unchecked")]});return TL.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[i,s.asSpec(),o],fieldBehaviours:fd([Fv.config({disabled:function(){return e.disabled||t.isDisabled()},disableClass:"tox-checkbox--disabled",onDisabled:function(e){TL.getField(e).each(Fv.disable)},onEnabled:function(e){TL.getField(e).each(Fv.enable)}}),vE()])})},d$=function(e){return"presentation"===e.presets?bL.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:e.html}}):bL.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:e.html,attributes:{role:"document"}},containerBehaviours:fd([_L.config({}),Xw.config({})])})},f$=function(e){return function(t,n,r){return ke(n,"name").fold((function(){return e(n,r)}),(function(i){return t.field(i,e(n,r))}))}},h$=function(e){return function(t,n,r){var i=Si(n,{source:"dynamic"});return f$(e)(t,i,r)}},m$={bar:f$((function(e,t){return wL(e,t.shared)})),collection:f$((function(e,t){return qL(e,t.shared.providers)})),alertbanner:f$((function(e,t){return u$(e,t.shared.providers)})),input:f$((function(e,t){return yB(e,t.shared.providers)})),textarea:f$((function(e,t){return wB(e,t.shared.providers)})),label:f$((function(e,t){return sB(e,t.shared)})),iframe:h$((function(e,t){return AM(e,t.shared.providers)})),button:f$((function(e,t){return hF(e,t.shared.providers)})),checkbox:f$((function(e,t){return c$(e,t.shared.providers)})),colorinput:f$((function(e,t){return tR(e,t.shared,t.colorinput)})),colorpicker:f$(rM),dropzone:f$((function(e,t){return bM(e,t.shared.providers)})),grid:f$((function(e,t){return yM(e,t.shared)})),listbox:f$((function(e,t){return fB(e,t)})),selectbox:f$((function(e,t){return gB(e,t.shared.providers)})),sizeinput:f$((function(e,t){return kF(e,t.shared.providers)})),urlinput:f$((function(e,t){return l$(e,t,t.urlinput)})),customeditor:f$(aM),htmlpanel:f$(d$),imagetools:f$((function(e,t){return aB(e,t.shared.providers)})),table:f$((function(e,t){return vB(e,t.shared.providers)})),panel:f$((function(e,t){return hB(e,t)}))},p$={field:function(e,t){return t}},g$=function(e,t,n){var r=Si(n,{shared:{interpreter:function(t){return v$(e,t,r)}}});return v$(e,t,r)},v$=function(e,t,n){return ke(m$,t.type).fold((function(){return console.error('Unknown factory type "'+t.type+'", defaulting to container: ',t),t}),(function(r){return r(e,t,n)}))},b$=function(e,t){var n=p$;return v$(n,e,t)},y$={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},w$=function(e,t,n){var r=12,i={maxHeightFunction:Ef()},o=function(){return{type:"node",root:Ln(e()),node:N.from(e()),bubble:Rf(r,r,y$),layouts:{onRtl:function(){return[fx]},onLtr:function(){return[dx]}},overrides:i}},a=function(){return{type:"hotspot",hotspot:t(),bubble:Rf(-r,r,y$),layouts:{onRtl:function(){return[Uc]},onLtr:function(){return[Vc]}},overrides:i}};return function(){return n()?o():a()}},S$=function(e,t,n){var r=function(){return{type:"node",root:Ln(e()),node:N.from(e()),layouts:{onRtl:function(){return[hx]},onLtr:function(){return[hx]}}}},i=function(){return{type:"hotspot",hotspot:t(),layouts:{onRtl:function(){return[Gc]},onLtr:function(){return[Gc]}}}};return function(){return n()?r():i()}},x$=function(e,t){return function(){return{type:"selection",root:t(),getSelection:function(){var t=e.selection.getRng();return N.some(Th.range(tt.fromDom(t.startContainer),t.startOffset,tt.fromDom(t.endContainer),t.endOffset))}}}},C$=function(e){return function(t){return{type:"node",root:e(),node:t}}},T$=function(e,t,n){var r=Jk(e),i=function(){return tt.fromDom(e.getBody())},o=function(){return tt.fromDom(e.getContentAreaContainer())},a=function(){return r||!n()};return{inlineDialog:w$(o,t,a),banner:S$(o,t,a),cursor:x$(e,i),node:C$(i)}},D$=function(e){return function(t,n){var r=uA(e);r(t,n)}},k$=function(e){return function(){return j_(e)}},E$=function(e){return function(){return G_(e)}},_$=function(e){return function(){return tA(e)}},A$=function(e){return{colorPicker:D$(e),hasCustomColors:k$(e),getColors:E$(e),getColorCols:_$(e)}},L$=function(e){return function(){return nE(e)}},O$=function(e){return{isDraggableModal:L$(e)}},R$=function(e){var t=ia(Gk(e)?"bottom":"top");return{isPositionedAtTop:function(){return"top"===t.get()},getDockingMode:t.get,setDockingMode:t.set}},I$=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],P$=function(e){return Ee(e,"items")},M$=function(e){return Ee(e,"block")},N$=function(e){return Ee(e,"inline")},F$=function(e){return Ee(e,"selector")},B$=function(e){return Q(e,(function(e,t){if(P$(t)){var n=B$(t.items);return{customFormats:e.customFormats.concat(n.customFormats),formats:e.formats.concat([{title:t.title,items:n.formats}])}}if(N$(t)||M$(t)||F$(t)){var r=o(t.name)?t.name:t.title.toLowerCase(),i="custom-"+r;return{customFormats:e.customFormats.concat([{name:i,format:t}]),formats:e.formats.concat([{title:t.title,format:i,icon:t.icon}])}}return A(A({},e),{formats:e.formats.concat(t)})}),{customFormats:[],formats:[]})},$$=function(e,t){var n=B$(t),r=function(t){W(t,(function(t){e.formatter.has(t.name)||e.formatter.register(t.name,t.format)}))};return e.formatter?r(n.customFormats):e.on("init",(function(){r(n.customFormats)})),n.formats},z$=function(e){return Rk(e).map((function(t){var n=$$(e,t);return Ik(e)?I$.concat(n):n})).getOr(I$)},U$=function(e,t,n){var r={type:"formatter",isSelected:t(e.format),getStylePreview:n(e.format)};return Si(e,r)},V$=function(e,t,n,r){var i=function(e){return U$(e,n,r)},a=function(e){var t={type:"submenu"};return Si(e,t)},s=function(t){var i=o(t.name)?t.name:il(t.title),a="custom-"+i,s={type:"formatter",format:a,isSelected:n(a),getStylePreview:r(a)},l=Si(t,s);return e.formatter.register(i,l),l},l=function(e){return G(e,(function(e){var t=pe(e);if(_e(e,"items")){var n=l(e.items);return Si(a(e),{getStyleItems:w(n)})}return _e(e,"format")?i(e):1===t.length&&V(t,"title")?Si(e,{type:"separator"}):s(e)}))};return l(t)},H$=function(e){var t=function(t){return function(){return e.formatter.match(t)}},n=function(t){return function(){var n=e.formatter.get(t);return void 0!==n?N.some({tag:n.length>0&&(n[0].inline||n[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(t))}):N.none()}},r=function(e){var t=e.items;return void 0!==t&&t.length>0?re(t,r):[e.format]},i=ia([]),o=ia([]),a=ia([]),s=ia([]),l=ia(!1);e.on("PreInit",(function(a){var s=z$(e),l=V$(e,s,t,n);i.set(l),o.set(re(l,r))})),e.on("addStyleModifications",(function(i){var o=V$(e,i.items,t,n);a.set(o),l.set(i.replace),s.set(re(o,r))}));var u=function(){var e=l.get()?[]:i.get(),t=a.get();return e.concat(t)},c=function(){var e=l.get()?[]:o.get(),t=s.get();return e.concat(t)};return{getData:u,getFlattenedKeys:c}},j$=function(e){return f(e)&&1===e.nodeType},q$=sM.trim,G$=function(e){return function(t){if(j$(t)){if(t.contentEditable===e)return!0;if(t.getAttribute("data-mce-contenteditable")===e)return!0}return!1}},W$=G$("true"),K$=G$("false"),Y$=function(e,t,n,r,i){return{type:e,title:t,url:n,level:r,attach:i}},X$=function(e){while(e=e.parentNode){var t=e.contentEditable;if(t&&"inherit"!==t)return W$(e)}return!1},J$=function(e,t){return G(Yh(tt.fromDom(t),e),(function(e){return e.dom}))},Q$=function(e){return e.innerText||e.textContent},Z$=function(e){return e.id?e.id:il("h")},ez=function(e){return e&&"A"===e.nodeName&&void 0!==(e.id||e.name)},tz=function(e){return ez(e)&&rz(e)},nz=function(e){return e&&/^(H[1-6])$/.test(e.nodeName)},rz=function(e){return X$(e)&&!K$(e)},iz=function(e){return nz(e)&&rz(e)},oz=function(e){return nz(e)?parseInt(e.nodeName.substr(1),10):0},az=function(e){var t=Z$(e),n=function(){e.id=t};return Y$("header",Q$(e),"#"+t,oz(e),n)},sz=function(e){var t=e.id||e.name,n=Q$(e);return Y$("anchor",n||"#"+t,"#"+t,0,g)},lz=function(e){return G(X(e,iz),az)},uz=function(e){return G(X(e,tz),sz)},cz=function(e){var t=J$("h1,h2,h3,h4,h5,h6,a:not([href])",e);return t},dz=function(e){return q$(e.title).length>0},fz=function(e){var t=cz(e);return X(lz(t).concat(uz(t)),dz)},hz={find:fz},mz="tinymce-url-history",pz=5,gz=function(e){return o(e)&&/^https?/.test(e)},vz=function(e){return s(e)&&e.length<=pz&&ie(e,gz)},bz=function(e){return a(e)&&Te(e,(function(e){return!vz(e)})).isNone()},yz=function(){var e,t=M_.getItem(mz);if(null===t)return{};try{e=JSON.parse(t)}catch(n){if(n instanceof SyntaxError)return console.log("Local storage "+mz+" was not valid JSON",n),{};throw n}return bz(e)?e:(console.log("Local storage "+mz+" was not valid format",e),{})},wz=function(e){if(!bz(e))throw new Error("Bad format for history:\n"+JSON.stringify(e));M_.setItem(mz,JSON.stringify(e))},Sz=function(e){var t=yz();return ke(t,e).getOr([])},xz=function(e,t){if(gz(e)){var n=yz(),r=ke(n,t).getOr([]),i=X(r,(function(t){return t!==e}));n[t]=[e].concat(i).slice(0,pz),wz(n)}},Cz=function(e){return!!e},Tz=function(e){return be(sM.makeMap(e,/[, ]/),Cz)},Dz=function(e){return N.from(aE(e)).filter(h)},kz=function(e){var t=N.some(sE(e)).filter(Cz),n=N.some(lE(e)).filter(Cz),r=t.or(n).map(Tz);return Dz(e).fold(k,(function(e){return r.fold(E,(function(e){return pe(e).length>0&&e}))}))},Ez=function(e,t){var n=kz(e);return u(n)?n?Dz(e):N.none():n[t]?Dz(e):N.none()},_z=function(e,t){return Ez(e,t).map((function(n){return function(r){return uO.nu((function(i){var s=function(e,t){if(!o(e))throw new Error("Expected value to be string");if(void 0!==t&&!a(t))throw new Error("Expected meta to be a object");var n={value:e,meta:t};i(n)},l=A({filetype:t,fieldname:r.fieldname},N.from(r.meta).getOr({}));n.call(e,s,r.value,l)}))}}))},Az=function(e){return N.from(e).filter(o).getOrUndefined()},Lz=function(e){return uE(e)?N.none():N.some({targets:hz.find(e.getBody()),anchorTop:Az(cE(e)),anchorBottom:Az(dE(e))})},Oz=function(e){return N.from(fE(e))},Rz=function(e){return{getHistory:Sz,addToHistory:xz,getLinkInformation:function(){return Lz(e)},getValidationHandler:function(){return Oz(e)},getUrlPicker:function(t){return _z(e,t)}}},Iz=function(e,t,n){var r=ia(!1),i=R$(t),o={shared:{providers:{icons:function(){return t.ui.registry.getAll().icons},menuItems:function(){return t.ui.registry.getAll().menuItems},translate:PC.translate,isDisabled:function(){return t.mode.isReadOnly()||t.ui.isDisabled()},getSetting:t.getParam.bind(t)},interpreter:function(e){return b$(e,o)},anchors:T$(t,n,i.isPositionedAtTop),header:i,getSink:function(){return ri.value(e)}},urlinput:Rz(t),styleselect:H$(t),colorinput:A$(t),dialog:O$(t),isContextMenuOpen:function(){return r.get()},setContextMenuState:function(e){return r.set(e)}};return o},Pz=function(e,t,n){var r=function(e,r){W([t,n],(function(t){t.broadcastEvent(e,r)}))},i=function(e,r){W([t,n],(function(t){t.broadcastOn([e],r)}))},o=function(e){return i(yp(),{target:e.target})},a=Sd(),s=af(a,"touchstart",o),l=af(a,"touchmove",(function(e){return r(ls(),e)})),u=af(a,"touchend",(function(e){return r(us(),e)})),c=af(a,"mousedown",o),d=af(a,"mouseup",(function(e){0===e.raw.button&&i(Sp(),{target:e.target})})),f=function(e){return i(yp(),{target:tt.fromDom(e.target)})},h=function(e){0===e.button&&i(Sp(),{target:tt.fromDom(e.target)})},m=function(){W(e.editorManager.get(),(function(t){e!==t&&t.fire("DismissPopups",{relatedTarget:e})}))},p=function(e){return r(cs(),lf(e))},g=function(e){i(wp(),{}),r(ds(),lf(e))},v=function(){return i(wp(),{})},b=function(t){t.state&&i(yp(),{target:tt.fromDom(e.getContainer())})},y=function(e){i(yp(),{target:tt.fromDom(e.relatedTarget.getContainer())})};e.on("PostRender",(function(){e.on("click",f),e.on("tap",f),e.on("mouseup",h),e.on("mousedown",m),e.on("ScrollWindow",p),e.on("ResizeWindow",g),e.on("ResizeEditor",v),e.on("AfterProgressState",b),e.on("DismissPopups",y)})),e.on("remove",(function(){e.off("click",f),e.off("tap",f),e.off("mouseup",h),e.off("mousedown",m),e.off("ScrollWindow",p),e.off("ResizeWindow",g),e.off("ResizeEditor",v),e.off("AfterProgressState",b),e.off("DismissPopups",y),c.unbind(),s.unbind(),l.unbind(),u.unbind(),d.unbind()})),e.on("detach",(function(){Qm(t),Qm(n),t.destroy(),n.destroy()}))},Mz=nv,Nz=Bg,Fz=w([Ko("shell",!1),Ao("makeItem"),Ko("setupItem",g),ig.field("listBehaviours",[$w])]),Bz=function(){return{behaviours:fd([$w.config({})])}},$z=Mg({name:"items",overrides:Bz}),zz=w([$z]),Uz=w("CustomList"),Vz=function(e,t,n,r){var i=function(t,n){a(t).fold((function(){throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")}),(function(r){var i=$w.contents(r),o=n.length,a=o-i.length,s=a>0?j(a,(function(){return e.makeItem()})):[],l=i.slice(o);W(l,(function(e){return $w.remove(r,e)})),W(s,(function(e){return $w.append(r,e)}));var u=$w.contents(r);W(u,(function(r,i){e.setupItem(t,r,n[i],i)}))}))},o=e.shell?{behaviours:[$w.config({})],components:[]}:{behaviours:[],components:t},a=function(t){return e.shell?N.some(t):Kg(t,e,"items")};return{uid:e.uid,dom:e.dom,components:o.components,behaviours:rg(e.listBehaviours,o.behaviours),apis:{setItems:i}}},Hz=hv({name:Uz(),configFields:Fz(),partFields:zz(),factory:Vz,apis:{setItems:function(e,t,n){e.setItems(t,n)}}}),jz=w([Ao("dom"),Ko("shell",!0),tg("toolbarBehaviours",[$w])]),qz=function(){return{behaviours:fd([$w.config({})])}},Gz=w([Mg({name:"groups",overrides:qz})]),Wz=function(e,t,n,r){var i=function(e,t){o(e).fold((function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")}),(function(e){$w.set(e,t)}))},o=function(t){return e.shell?N.some(t):Kg(t,e,"groups")},a=e.shell?{behaviours:[$w.config({})],components:[]}:{behaviours:[],components:t};return{uid:e.uid,dom:e.dom,components:a.components,behaviours:rg(e.toolbarBehaviours,a.behaviours),apis:{setGroups:i},domModification:{attributes:{role:"group"}}}},Kz=hv({name:"Toolbar",configFields:jz(),partFields:Gz(),factory:Wz,apis:{setGroups:function(e,t,n){e.setGroups(t,n)}}}),Yz=g,Xz=k,Jz=w([]),Qz=Object.freeze({__proto__:null,setup:Yz,isDocked:Xz,getBehaviours:Jz}),Zz=function(e){var t=Ae(Zn(e,"position"),"fixed"),n=t?N.none():yn(e);return n.orThunk((function(){var t=tt.fromTag("span");return vn(e).bind((function(e){Lr(e,t);var n=yn(t);return Mr(t),n}))}))},eU=function(e){return Zz(e).map(hr).getOrThunk((function(){return cr(0,0)}))},tU=aa.generate([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),nU=function(e,t){var n=e.element;ou(n,t.transitionClass),su(n,t.fadeOutClass),ou(n,t.fadeInClass),t.onShow(e)},rU=function(e,t){var n=e.element;ou(n,t.transitionClass),su(n,t.fadeInClass),ou(n,t.fadeOutClass),t.onHide(e)},iU=function(e,t){return e.y<t.bottom&&e.bottom>t.y},oU=function(e,t){return e.y>=t.y},aU=function(e,t){return e.bottom<=t.bottom},sU=function(e,t,n){return ie(e,(function(e){switch(e){case"bottom":return aU(t,n);case"top":return oU(t,n)}}))},lU=function(e,t){return t.getInitialPos().map((function(t){return Xr(t.bounds.x,t.bounds.y,vr(e),ar(e))}))},uU=function(e,t,n){n.setInitialPos({style:er(e),position:Jn(e,"position")||"static",bounds:t})},cU=function(e,t,n){return n.getInitialPos().bind((function(r){switch(n.clearInitialPos(),r.position){case"static":return N.some(tU.static());case"absolute":var i=Zz(e).map(Jr).getOrThunk((function(){return Jr(Fn())}));return N.some(tU.absolute(_d("absolute",ke(r.style,"left").map((function(e){return t.x-i.x})),ke(r.style,"top").map((function(e){return t.y-i.y})),ke(r.style,"right").map((function(e){return i.right-t.right})),ke(r.style,"bottom").map((function(e){return i.bottom-t.bottom})))));default:return N.none()}}))},dU=function(e,t,n){return lU(e,n).filter((function(e){return sU(n.getModes(),e,t)})).bind((function(t){return cU(e,t,n)}))},fU=function(e,t,n){var r=Jr(e);if(sU(n.getModes(),r,t))return N.none();uU(e,r,n);var i=Zr(),o=r.x-i.x,a=t.y-i.y,s=i.bottom-t.bottom,l=r.y<=t.y;return N.some(tU.fixed(_d("fixed",N.some(o),l?N.some(a):N.none(),N.none(),l?N.none():N.some(s))))},hU=function(e,t,n){var r=e.element,i=Ae(Zn(r,"position"),"fixed");return i?dU(r,t,n):fU(r,t,n)},mU=function(e,t){var n=e.element;return lU(n,t).bind((function(e){return cU(n,e,t)}))},pU=function(e,t,n){n.setDocked(!1),W(["left","right","top","bottom","position"],(function(t){return nr(e.element,t)})),t.onUndocked(e)},gU=function(e,t,n,r){var i="fixed"===r.position;n.setDocked(i),Ld(e.element,r);var o=i?t.onDocked:t.onUndocked;o(e)},vU=function(e,t,n,r,i){void 0===i&&(i=!1),t.contextual.each((function(t){t.lazyContext(e).each((function(o){var a=iU(o,r);if(a!==n.isVisible())if(n.setVisible(a),i&&!a)uu(e.element,[t.fadeOutClass]),t.onHide(e);else{var s=a?nU:rU;s(e,t)}}))}))},bU=function(e,t,n){var r=t.lazyViewport(e),i=n.isDocked();i&&vU(e,t,n,r),hU(e,r,n).each((function(i){i.fold((function(){return pU(e,t,n)}),(function(r){return gU(e,t,n,r)}),(function(i){vU(e,t,n,r,!0),gU(e,t,n,i)}))}))},yU=function(e,t,n){var r=e.element;n.setDocked(!1),mU(e,n).each((function(r){r.fold((function(){return pU(e,t,n)}),(function(r){return gU(e,t,n,r)}),g)})),n.setVisible(!0),t.contextual.each((function(t){cu(r,[t.fadeInClass,t.fadeOutClass,t.transitionClass]),t.onShow(e)})),wU(e,t,n)},wU=function(e,t,n){e.getSystem().isConnected()&&bU(e,t,n)},SU=function(e,t,n){n.isDocked()&&yU(e,t,n)},xU=function(e,t,n){return n.isDocked()},CU=function(e,t,n,r){return n.setModes(r)},TU=function(e,t,n){return n.getModes()},DU=Object.freeze({__proto__:null,refresh:wU,reset:SU,isDocked:xU,getModes:TU,setModes:CU}),kU=function(e,t){return _s([Us(Ga(),(function(n,r){e.contextual.each((function(e){if(lu(n.element,e.transitionClass)){cu(n.element,[e.transitionClass,e.fadeInClass]);var i=t.isVisible()?e.onShown:e.onHidden;i(n)}r.stop()}))})),Rs(cs(),(function(n,r){wU(n,e,t)})),Rs(ds(),(function(n,r){SU(n,e,t)}))])},EU=Object.freeze({__proto__:null,events:kU}),_U=[Go("contextual",[Ro("fadeInClass"),Ro("fadeOutClass"),Ro("transitionClass"),Mo("lazyContext"),sc("onShow"),sc("onShown"),sc("onHide"),sc("onHidden")]),ea("lazyViewport",Zr),na("modes",["top","bottom"],lo),sc("onDocked"),sc("onUndocked")],AU=function(e){var t=ia(!1),n=ia(!0),r=rf(),i=ia(e.modes),o=function(){return"docked:  "+t.get()+", visible: "+n.get()+", modes: "+i.get().join(",")};return Dl({isDocked:t.get,setDocked:t.set,getInitialPos:r.get,setInitialPos:r.set,clearInitialPos:r.clear,isVisible:n.get,setVisible:n.set,getModes:i.get,setModes:i.set,readState:o})},LU=Object.freeze({__proto__:null,init:AU}),OU=md({fields:_U,name:"docking",active:EU,apis:DU,state:LU}),RU=w(il("toolbar-height-change")),IU={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},PU="tox-tinymce--toolbar-sticky-on",MU="tox-tinymce--toolbar-sticky-off",NU=function(e,t){var n=hn(t),r=n.dom.defaultView.innerHeight,i=Fr(n),o=tt.fromDom(e.elm),a=Qr(o),s=ar(o),l=a.y,u=l+s,c=hr(t),d=ar(t),f=c.top,h=f+d,m=Math.abs(f-i.top)<2,p=Math.abs(h-(i.top+r))<2;if(m&&l<h)Br(i.left,l-d,n);else if(p&&u>f){var g=l-r+s+d;Br(i.left,g,n)}},FU=function(e,t){return V(OU.getModes(e),t)},BU=function(e){var t=function(e){return sr(e)+(parseInt(Jn(e,"margin-top"),10)||0)+(parseInt(Jn(e,"margin-bottom"),10)||0)},n=e.element;vn(n).each((function(r){var i="padding-"+OU.getModes(e)[0];if(OU.isDocked(e)){var o=vr(r);Kn(n,"width",o+"px"),Kn(r,i,t(n)+"px")}else nr(n,"width"),nr(r,i)}))},$U=function(e,t){t?(su(e,IU.fadeOutClass),uu(e,[IU.transitionClass,IU.fadeInClass])):(su(e,IU.fadeInClass),uu(e,[IU.fadeOutClass,IU.transitionClass]))},zU=function(e,t){var n=tt.fromDom(e.getContainer());t?(ou(n,PU),su(n,MU)):(ou(n,MU),su(n,PU))},UU=function(e,t){var n=hn(t);Dd(n).filter((function(e){return!un(t,e)})).filter((function(t){return un(t,tt.fromDom(n.dom.body))||fn(e,t)})).each((function(){return xd(t)}))},VU=function(e,t){return kd(e).orThunk((function(){return t().toOptional().bind((function(e){return kd(e.element)}))}))},HU=function(e,t,n){e.inline||(t.header.isPositionedAtTop()||e.on("ResizeEditor",(function(){n().each(OU.reset)})),e.on("ResizeWindow ResizeEditor",(function(){n().each(BU)})),e.on("SkinLoaded",(function(){n().each((function(e){OU.isDocked(e)?OU.reset(e):OU.refresh(e)}))})),e.on("FullscreenStateChanged",(function(){n().each(OU.reset)}))),e.on("AfterScrollIntoView",(function(e){n().each((function(t){OU.refresh(t);var n=t.element;Jb(n)&&NU(e,n)}))})),e.on("PostRender",(function(){zU(e,!1)}))},jU=function(e){return e().map(OU.isDocked).getOr(!1)},qU=function(){var e;return[bd.config({channels:(e={},e[RU()]={onReceive:BU},e)})]},GU=function(e,t){var n=rf(),r=t.getSink,i=function(e){r().each((function(t){return e(t.element)}))},o=function(t){e.inline||BU(t),zU(e,OU.isDocked(t)),t.getSystem().broadcastOn([wp()],{}),r().each((function(e){return e.getSystem().broadcastOn([wp()],{})}))},a=e.inline?[]:qU();return O([Xw.config({}),OU.config({contextual:A({lazyContext:function(t){var n=sr(t.element),r=e.inline?e.getContentAreaContainer():e.getContainer(),i=Jr(tt.fromDom(r)),o=i.height-n,a=i.y+(FU(t,"top")?0:n);return N.some(Xr(i.x,a,i.width,o))},onShow:function(){i((function(e){return $U(e,!0)}))},onShown:function(e){i((function(e){return cu(e,[IU.transitionClass,IU.fadeInClass])})),n.get().each((function(t){UU(e.element,t),n.clear()}))},onHide:function(e){VU(e.element,r).fold(n.clear,n.set),i((function(e){return $U(e,!1)}))},onHidden:function(){i((function(e){return cu(e,[IU.transitionClass])}))}},IU),lazyViewport:function(t){var n=Zr(),r=tE(e),i=n.y+(FU(t,"top")?r:0),o=n.height-(FU(t,"bottom")?r:0);return Xr(n.x,i,n.width,o)},modes:[t.header.getDockingMode()],onDocked:o,onUndocked:o})],a,!0)},WU=Object.freeze({__proto__:null,setup:HU,isDocked:jU,getBehaviours:GU}),KU=function(e){var t=e.editor,n=e.sticky?GU:Jz;return{uid:e.uid,dom:e.dom,components:e.components,behaviours:fd(n(t,e.sharedBackstage))}},YU=Zi([Ro("type"),Lo("items",to([io([Ro("name"),$o("items",lo)]),lo]))].concat(IT)),XU=function(e){return wo("GroupToolbarButton",YU,e)},JU=[Ho("text"),Ho("tooltip"),Ho("icon"),Mo("fetch"),ea("onSetup",(function(){return g}))],QU=Zi(O([Ro("type")],JU,!0)),ZU=function(e){return wo("menubutton",QU,e)},eV=Zi([Ro("type"),Ho("tooltip"),Ho("icon"),Ho("text"),jo("select"),Mo("fetch"),ea("onSetup",(function(){return g})),Qo("presets","normal",["normal","color","listpreview"]),Ko("columns",1),Mo("onAction"),Mo("onItemAction")]),tV=function(e){return wo("SplitButton",eV,e)},nV=function(e,t){var n=function(e,n){var r=G(n,(function(e){var n={type:"menubutton",text:e.text,fetch:function(t){t(e.getItems())}},r=ZU(n).mapError((function(e){return Co(e)})).getOrDie();return nF(r,"tox-mbtn",t.backstage,N.some("menuitem"))}));$w.set(e,r)},r={focus:Aw.focusIn,setMenus:n};return{uid:e.uid,dom:e.dom,components:[],behaviours:fd([$w.config({}),Uw("menubar-events",[Vs((function(t){e.onSetup(t)})),Rs(Fa(),(function(e,t){Bu(e.element,".tox-mbtn--active").each((function(n){$u(t.event.target,".tox-mbtn").each((function(t){un(n,t)||e.getSystem().getByDom(n).each((function(n){e.getSystem().getByDom(t).each((function(e){GO.expand(e),GO.close(n),Xw.focus(e)}))}))}))}))})),Rs(gs(),(function(e,t){t.event.prevFocus.bind((function(t){return e.getSystem().getByDom(t).toOptional()})).each((function(n){t.event.newFocus.bind((function(t){return e.getSystem().getByDom(t).toOptional()})).each((function(e){GO.isOpen(n)&&(GO.expand(e),GO.close(n))}))}))}))]),Aw.config({mode:"flow",selector:".tox-mbtn",onEscape:function(t){return e.onEscape(t),N.some(!0)}}),_L.config({})]),apis:r,domModification:{attributes:{role:"menubar"}}}},rV=fv({factory:nV,name:"silver.Menubar",configFields:[Ao("dom"),Ao("uid"),Ao("onEscape"),Ao("backstage"),Ko("onSetup",g)],apis:{focus:function(e,t){e.focus(t)},setMenus:function(e,t,n){e.setMenus(t,n)}}}),iV=function(e,t){return t.getAnimationRoot.fold((function(){return e.element}),(function(t){return t(e)}))},oV=function(e){return e.dimension.property},aV=function(e,t){return e.dimension.getDimension(t)},sV=function(e,t){var n=iV(e,t);cu(n,[t.shrinkingClass,t.growingClass])},lV=function(e,t){su(e.element,t.openClass),ou(e.element,t.closedClass),Kn(e.element,oV(t),"0px"),rr(e.element)},uV=function(e,t){su(e.element,t.closedClass),ou(e.element,t.openClass),nr(e.element,oV(t))},cV=function(e,t,n,r){n.setCollapsed(),Kn(e.element,oV(t),aV(t,e.element)),rr(e.element),sV(e,t),lV(e,t),t.onStartShrink(e),t.onShrunk(e)},dV=function(e,t,n,r){var i=r.getOrThunk((function(){return aV(t,e.element)}));n.setCollapsed(),Kn(e.element,oV(t),i),rr(e.element);var o=iV(e,t);su(o,t.growingClass),ou(o,t.shrinkingClass),lV(e,t),t.onStartShrink(e)},fV=function(e,t,n){var r=aV(t,e.element),i="0px"===r?cV:dV;i(e,t,n,N.some(r))},hV=function(e,t,n){var r=iV(e,t),i=lu(r,t.shrinkingClass),o=aV(t,e.element);uV(e,t);var a=aV(t,e.element),s=function(){Kn(e.element,oV(t),o),rr(e.element)},l=function(){lV(e,t)},u=i?s:l;u(),su(r,t.shrinkingClass),ou(r,t.growingClass),uV(e,t),Kn(e.element,oV(t),a),n.setExpanded(),t.onStartGrow(e)},mV=function(e,t,n){if(n.isExpanded()){nr(e.element,oV(t));var r=aV(t,e.element);Kn(e.element,oV(t),r)}},pV=function(e,t,n){n.isExpanded()||hV(e,t,n)},gV=function(e,t,n){n.isExpanded()&&fV(e,t,n)},vV=function(e,t,n){n.isExpanded()&&cV(e,t,n)},bV=function(e,t,n){return n.isExpanded()},yV=function(e,t,n){return n.isCollapsed()},wV=function(e,t,n){var r=iV(e,t);return!0===lu(r,t.growingClass)},SV=function(e,t,n){var r=iV(e,t);return!0===lu(r,t.shrinkingClass)},xV=function(e,t,n){return wV(e,t)||SV(e,t)},CV=function(e,t,n){var r=n.isExpanded()?fV:hV;r(e,t,n)},TV=Object.freeze({__proto__:null,refresh:mV,grow:pV,shrink:gV,immediateShrink:vV,hasGrown:bV,hasShrunk:yV,isGrowing:wV,isShrinking:SV,isTransitioning:xV,toggleGrow:CV,disableTransitions:sV}),DV=function(e,t,n){var r=t.expanded;return Ll(r?{classes:[t.openClass],styles:{}}:{classes:[t.closedClass],styles:ha(t.dimension.property,"0px")})},kV=function(e,t){return _s([Us(Ga(),(function(n,r){var i=r.event.raw;if(i.propertyName===e.dimension.property){sV(n,e),t.isExpanded()&&nr(n.element,e.dimension.property);var o=t.isExpanded()?e.onGrown:e.onShrunk;o(n)}}))])},EV=Object.freeze({__proto__:null,exhibit:DV,events:kV}),_V=[Ao("closedClass"),Ao("openClass"),Ao("shrinkingClass"),Ao("growingClass"),zo("getAnimationRoot"),sc("onShrunk"),sc("onStartShrink"),sc("onGrown"),sc("onStartGrow"),Ko("expanded",!1),Lo("dimension",To("property",{width:[dc("property","width"),dc("getDimension",(function(e){return vr(e)+"px"}))],height:[dc("property","height"),dc("getDimension",(function(e){return ar(e)+"px"}))]}))],AV=function(e){var t=ia(e.expanded),n=function(){return"expanded: "+t.get()};return Dl({isExpanded:function(){return!0===t.get()},isCollapsed:function(){return!1===t.get()},setCollapsed:C(t.set,!1),setExpanded:C(t.set,!0),readState:n})},LV=Object.freeze({__proto__:null,init:AV}),OV=md({fields:_V,name:"sliding",active:EV,apis:TV,state:LV}),RV="container",IV=[tg("slotBehaviours",[])],PV=function(e){return"<alloy.field."+e+">"},MV=function(e){var t=function(){var e=[],t=function(t,n){return e.push(t),Hg(RV,PV(t),n)};return{slot:t,record:w(e)}}(),n=e(t),r=t.record(),i=G(r,(function(e){return Ig({name:e,pname:PV(e)})}));return av(RV,IV,i,NV,n)},NV=function(e,t){var n=function(t){return Qg(e)},r=function(t,n){return Kg(t,e,n)},i=function(t,n){return function(r,i){return Kg(r,e,i).map((function(e){return t(e,i)})).getOr(n)}},o=function(e){return function(t,n){W(n,(function(n){return e(t,n)}))}},a=function(e,t){return"true"!==Vn(e.element,"aria-hidden")},s=function(e,t){if(!a(e)){var n=e.element;nr(n,"display"),qn(n,"aria-hidden"),Cs(e,vs(),{name:t,visible:!0})}},l=function(e,t){if(a(e)){var n=e.element;Kn(n,"display","none"),zn(n,"aria-hidden","true"),Cs(e,vs(),{name:t,visible:!1})}},u=i(a,!1),c=i(l),d=o(c),f=function(e){return d(e,n())},h=i(s),m={getSlotNames:n,getSlot:r,isShowing:u,hideSlot:c,hideAllSlots:f,showSlot:h};return{uid:e.uid,dom:e.dom,components:t,behaviours:ng(e.slotBehaviours),apis:m}},FV=be({getSlotNames:function(e,t){return e.getSlotNames(t)},getSlot:function(e,t,n){return e.getSlot(t,n)},isShowing:function(e,t,n){return e.isShowing(t,n)},hideSlot:function(e,t,n){return e.hideSlot(t,n)},hideAllSlots:function(e,t){return e.hideAllSlots(t)},showSlot:function(e,t,n){return e.showSlot(t,n)}},(function(e){return Cl(e)})),BV=A(A({},FV),{sketch:MV}),$V=Zi([Ho("icon"),Ho("tooltip"),ea("onShow",g),ea("onHide",g),ea("onSetup",(function(){return g}))]),zV=function(e){return wo("sidebar",$V,e)},UV=function(e){var t=e.ui.registry.getAll().sidebars;W(pe(t),(function(n){var r=t[n],i=function(){return Ae(N.from(e.queryCommandValue("ToggleSidebar")),n)};e.ui.registry.addToggleButton(n,{icon:r.icon,tooltip:r.tooltip,onAction:function(t){e.execCommand("ToggleSidebar",!1,n),t.setActive(i())},onSetup:function(t){var n=function(){return t.setActive(i())};return e.on("ToggleSidebar",n),function(){e.off("ToggleSidebar",n)}}})}))},VV=function(e){return{element:function(){return e.element.dom}}},HV=function(e,t){var n=G(pe(t),(function(e){var n=t[e],r=So(zV(n));return{name:e,getApi:VV,onSetup:r.onSetup,onShow:r.onShow,onHide:r.onHide}}));return G(n,(function(t){var r=ia(g);return e.slot(t.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:sk.unnamedEvents([TE(t,r),DE(t,r),Rs(vs(),(function(e,t){var r=t.event,i=ee(n,(function(e){return e.name===r.name}));i.each((function(t){var n=r.visible?t.onShow:t.onHide;n(t.getApi(e))}))}))])})}))},jV=function(e){return BV.sketch((function(t){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:HV(t,e),slotBehaviours:sk.unnamedEvents([Vs((function(e){return BV.hideAllSlots(e)}))])}}))},qV=function(e,t){var n=bv.getCurrent(e);n.each((function(e){return $w.set(e,[jV(t)])}))},GV=function(e,t){var n=bv.getCurrent(e);n.each((function(e){var n=bv.getCurrent(e);n.each((function(n){OV.hasGrown(e)?BV.isShowing(n,t)?OV.shrink(e):(BV.hideAllSlots(n),BV.showSlot(n,t)):(BV.hideAllSlots(n),BV.showSlot(n,t),OV.grow(e))}))}))},WV=function(e){var t=bv.getCurrent(e);return t.bind((function(e){var t=OV.isGrowing(e)||OV.hasGrown(e);if(t){var n=bv.getCurrent(e);return n.bind((function(e){return ee(BV.getSlotNames(e),(function(t){return BV.isShowing(e,t)}))}))}return N.none()}))},KV=il("FixSizeEvent"),YV=il("AutoSizeEvent"),XV=function(e){return{uid:e.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:fd([_L.config({}),Xw.config({}),OV.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(e){var t=bv.getCurrent(e);t.each(BV.hideAllSlots),xs(e,YV)},onGrown:function(e){xs(e,YV)},onStartGrow:function(e){Cs(e,KV,{width:Zn(e.element,"width").getOr("")})},onStartShrink:function(e){Cs(e,KV,{width:vr(e.element)+"px"})}}),$w.config({}),bv.config({find:function(e){var t=$w.contents(e);return de(t)}})])}],behaviours:fd([ZP.childAt(0),Uw("sidebar-sliding-events",[Rs(KV,(function(e,t){Kn(e.element,"width",t.event.width)})),Rs(YV,(function(e,t){nr(e.element,"width")}))])])}},JV=function(e,t,n,r){zn(e.element,"aria-busy",!0);var i=t.getRoot(e).getOr(e),o=fd([Aw.config({mode:"special",onTab:function(){return N.some(!0)},onShiftTab:function(){return N.some(!0)}}),Xw.config({})]),a=r(i,o),s=i.getSystem().build(a);$w.append(i,_u(s)),s.hasConfigured(Aw)&&t.focus&&Aw.focusIn(s),n.isBlocked()||t.onBlock(e),n.blockWith((function(){return $w.remove(i,s)}))},QV=function(e,t,n){qn(e.element,"aria-busy"),n.isBlocked()&&t.onUnblock(e),n.clear()},ZV=Object.freeze({__proto__:null,block:JV,unblock:QV}),eH=[ea("getRoot",N.none),Zo("focus",!0),sc("onBlock"),sc("onUnblock")],tH=function(){var e=ef(),t=function(t){e.set({destroy:t})};return Dl({readState:e.isSet,blockWith:t,clear:e.clear,isBlocked:e.isSet})},nH=Object.freeze({__proto__:null,init:tH}),rH=md({fields:eH,name:"blocking",apis:ZV,state:nH}),iH=function(e){return function(t,n){return{dom:{tag:"div",attributes:{"aria-label":e.translate("Loading..."),tabindex:"0"},classes:["tox-throbber__busy-spinner"]},components:[{dom:kx('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}}},oH=function(e){return bv.getCurrent(e).each((function(e){return xd(e.element)}))},aH=function(e,t){var n="tabindex",r="data-mce-"+n;N.from(e.iframeElement).map(tt.fromDom).each((function(e){t?(Hn(e,n).each((function(t){return zn(e,r,t)})),zn(e,n,-1)):(qn(e,n),Hn(e,r).each((function(t){zn(e,n,t),qn(e,r)})))}))},sH=function(e,t,n,r){var i=t.element;if(aH(e,n),n)rH.block(t,iH(r)),nr(i,"display"),qn(i,"aria-hidden"),e.hasFocus()&&oH(t);else{var o=bv.getCurrent(t).exists((function(e){return Td(e.element)}));rH.unblock(t),Kn(i,"display","none"),zn(i,"aria-hidden","true"),o&&e.focus()}},lH=function(e){return{uid:e.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:fd([$w.config({}),rH.config({focus:!1}),bv.config({find:function(e){return de(e.components())}})]),components:[]}},uH=function(e){return"focusin"===e.type},cH=function(e){if(uH(e)){var t=e.composed?de(e.composedPath()):N.from(e.target);return t.map(tt.fromDom).filter(ct).exists((function(e){return lu(e,"mce-pastebin")}))}return!1},dH=function(e,t,n){var r=ia(!1),i=rf(),o=function(n){r.get()&&!cH(n)&&(n.preventDefault(),oH(t()),e.editorManager.setActive(e))};e.inline||e.on("PreInit",(function(){e.dom.bind(e.getWin(),"focusin",o),e.on("BeforeExecCommand",(function(e){"mcefocus"===e.command.toLowerCase()&&!0!==e.value&&o(e)}))}));var a=function(i){i!==r.get()&&(r.set(i),sH(e,t(),i,n.providers),e.fire("AfterProgressState",{state:i}))};e.on("ProgressState",(function(t){if(i.on(Sx.clearTimeout),m(t.time)){var n=Sx.setEditorTimeout(e,(function(){return a(t.state)}),t.time);i.set(n)}else a(t.state),i.clear()}))},fH=function(e,t){var n={len:0,list:[]},r=Q(e,(function(e,n){var r=t(n,e.len);return r.fold(w(e),(function(t){return{len:t.finish,list:e.list.concat([t])}}))}),n);return r.list},hH=function(e,t,n){return{within:e,extra:t,withinWidth:n}},mH=function(e,t,n){var r=fH(e,(function(e,t){var r=n(e);return N.some({element:e,start:t,finish:t+r,width:r})})),i=X(r,(function(e){return e.finish<=t})),o=J(i,(function(e,t){return e+t.width}),0),a=r.slice(i.length);return{within:i,extra:a,withinWidth:o}},pH=function(e){return G(e,(function(e){return e.element}))},gH=function(e,t,n){var r=pH(e.concat(t));return hH(r,[],n)},vH=function(e,t,n,r){var i=pH(e).concat([n]);return hH(i,pH(t),r)},bH=function(e,t,n){return hH(pH(e),[],n)},yH=function(e,t,n){var r=mH(t,e,n);return 0===r.extra.length?N.some(r):N.none()},wH=function(e,t,n,r){var i=yH(e,t,n).getOrThunk((function(){return mH(t,e-n(r),n)})),o=i.within,a=i.extra,s=i.withinWidth;return 1===a.length&&a[0].width<=n(r)?gH(o,a,s):a.length>=1?vH(o,a,r,s):bH(o,a,s)},SH=function(e,t){var n=G(t,(function(e){return _u(e)}));Kz.setGroups(e,n)},xH=function(e){return me(e,(function(e){return kd(e.element).bind((function(t){return e.getSystem().getByDom(t).toOptional()}))}))},CH=function(e,t,n){var r=t.builtGroups.get();if(0!==r.length){var i=Yg(e,t,"primary"),o=EO.getCoupled(e,"overflowGroup");Kn(i.element,"visibility","hidden");var a=r.concat([o]),s=xH(a);n([]),SH(i,a);var l=vr(i.element),u=wH(l,t.builtGroups.get(),(function(e){return vr(e.element)}),o);0===u.extra.length?($w.remove(i,o),n([])):(SH(i,u.within),n(u.extra)),nr(i.element,"visibility"),rr(i.element),s.each(Xw.focus)}},TH=w([tg("splitToolbarBehaviours",[EO]),Eo("builtGroups",(function(){return ia([])}))]),DH=w([oc(["overflowToggledClass"]),jo("getOverflowBounds"),Ao("lazySink"),Eo("overflowGroups",(function(){return ia([])}))].concat(TH())),kH=w([Ig({factory:Kz,schema:jz(),name:"primary"}),Pg({schema:jz(),name:"overflow"}),Pg({name:"overflow-button"}),Pg({name:"overflow-group"})]),EH=w((function(e,t){yr(e,Math.floor(t))})),_H=w([oc(["toggledClass"]),Ao("lazySink"),Mo("fetch"),jo("getBounds"),Go("fireDismissalEventInstead",[Ko("event",ms())]),$f()]),AH=w([Pg({name:"button",overrides:function(e){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:fd([pS.config({toggleClass:e.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),Pg({factory:Kz,schema:jz(),name:"toolbar",overrides:function(e){return{toolbarBehaviours:fd([Aw.config({mode:"cyclic",onEscape:function(t){return Kg(t,e,"button").each(Xw.focus),N.none()}})])}}})]),LH=function(e,t){var n=EO.getCoupled(e,"toolbarSandbox");bp.isOpen(n)?bp.close(n):bp.open(n,t.toolbar())},OH=function(e,t,n,r){var i=n.getBounds.map((function(e){return e()})),o=n.lazySink(e).getOrDie();Bm.positionWithinBounds(o,t,{anchor:{type:"hotspot",hotspot:e,layouts:r,overrides:{maxWidthFunction:EH()}}},i)},RH=function(e,t,n,r,i){Kz.setGroups(t,i),OH(e,t,n,r),pS.on(e)},IH=function(e,t,n){var r=Uu(),i=function(i,o){n.fetch().get((function(i){RH(e,o,n,t.layouts,i),r.link(e.element),Aw.focusIn(o)}))},o=function(){pS.off(e),Xw.focus(e),r.unlink(e.element)};return{dom:{tag:"div",attributes:{id:r.id}},behaviours:fd([Aw.config({mode:"special",onEscape:function(e){return bp.close(e),N.some(!0)}}),bp.config({onOpen:i,onClose:o,isPartOf:function(t,n,r){return Hu(n,r)||Hu(e,r)},getAttachPoint:function(){return n.lazySink(e).getOrDie()}}),bd.config({channels:A(A({},Cp(A({isExtraPart:k},n.fireDismissalEventInstead.map((function(e){return{fireEventInstead:{event:e.event}}})).getOr({})))),Dp({doReposition:function(){bp.getState(EO.getCoupled(e,"toolbarSandbox")).each((function(r){OH(e,r,n,t.layouts)}))}}))})])}},PH=function(e,t,n,r){return A(A({},Cx.sketch(A(A({},r.button()),{action:function(e){LH(e,r)},buttonBehaviours:ig.augment({dump:r.button().buttonBehaviours},[EO.config({others:{toolbarSandbox:function(t){return IH(t,n,e)}}})])}))),{apis:{setGroups:function(t,r){bp.getState(EO.getCoupled(t,"toolbarSandbox")).each((function(i){RH(t,i,e,n.layouts,r)}))},reposition:function(t){bp.getState(EO.getCoupled(t,"toolbarSandbox")).each((function(r){OH(t,r,e,n.layouts)}))},toggle:function(e){LH(e,r)},getToolbar:function(e){return bp.getState(EO.getCoupled(e,"toolbarSandbox"))},isOpen:function(e){return bp.isOpen(EO.getCoupled(e,"toolbarSandbox"))}}})},MH=hv({name:"FloatingToolbarButton",factory:PH,configFields:_H(),partFields:AH(),apis:{setGroups:function(e,t,n){e.setGroups(t,n)},reposition:function(e,t){e.reposition(t)},toggle:function(e,t){e.toggle(t)},getToolbar:function(e,t){return e.getToolbar(t)},isOpen:function(e,t){return e.isOpen(t)}}}),NH=w([Ao("items"),oc(["itemSelector"]),tg("tgroupBehaviours",[Aw])]),FH=w([Ng({name:"items",unit:"item"})]),BH=function(e,t,n,r){return{uid:e.uid,dom:e.dom,components:t,behaviours:rg(e.tgroupBehaviours,[Aw.config({mode:"flow",selector:e.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}},$H=hv({name:"ToolbarGroup",configFields:NH(),partFields:FH(),factory:BH}),zH=function(e){return G(e,(function(e){return _u(e)}))},UH=function(e,t,n){CH(e,n,(function(r){n.overflowGroups.set(r),t.getOpt(e).each((function(e){MH.setGroups(e,zH(r))}))}))},VH=function(e,t,n,r){var i=Ex(MH.sketch({fetch:function(){return uO.nu((function(t){t(zH(e.overflowGroups.get()))}))},layouts:{onLtr:function(){return[Vc,Uc]},onRtl:function(){return[Uc,Vc]},onBottomLtr:function(){return[jc,Hc]},onBottomRtl:function(){return[Hc,jc]}},getBounds:n.getOverflowBounds,lazySink:e.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:e.markers.overflowToggledClass},parts:{button:r["overflow-button"](),toolbar:r.overflow()}}));return{uid:e.uid,dom:e.dom,components:t,behaviours:rg(e.splitToolbarBehaviours,[EO.config({others:{overflowGroup:function(){return $H.sketch(A(A({},r["overflow-group"]()),{items:[i.asSpec()]}))}}})]),apis:{setGroups:function(t,n){e.builtGroups.set(G(n,t.getSystem().build)),UH(t,i,e)},refresh:function(t){return UH(t,i,e)},toggle:function(e){i.getOpt(e).each((function(e){MH.toggle(e)}))},isOpen:function(e){return i.getOpt(e).map(MH.isOpen).getOr(!1)},reposition:function(e){i.getOpt(e).each((function(e){MH.reposition(e)}))},getOverflow:function(e){return i.getOpt(e).bind(MH.getToolbar)}},domModification:{attributes:{role:"group"}}}},HH=hv({name:"SplitFloatingToolbar",configFields:DH(),partFields:kH(),factory:VH,apis:{setGroups:function(e,t,n){e.setGroups(t,n)},refresh:function(e,t){e.refresh(t)},reposition:function(e,t){e.reposition(t)},toggle:function(e,t){e.toggle(t)},isOpen:function(e,t){return e.isOpen(t)},getOverflow:function(e,t){return e.getOverflow(t)}}}),jH=w([oc(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),sc("onOpened"),sc("onClosed")].concat(TH())),qH=w([Ig({factory:Kz,schema:jz(),name:"primary"}),Ig({factory:Kz,schema:jz(),name:"overflow",overrides:function(e){return{toolbarBehaviours:fd([OV.config({dimension:{property:"height"},closedClass:e.markers.closedClass,openClass:e.markers.openClass,shrinkingClass:e.markers.shrinkingClass,growingClass:e.markers.growingClass,onShrunk:function(t){Kg(t,e,"overflow-button").each((function(e){pS.off(e),Xw.focus(e)})),e.onClosed(t)},onGrown:function(t){Aw.focusIn(t),e.onOpened(t)},onStartGrow:function(t){Kg(t,e,"overflow-button").each(pS.on)}}),Aw.config({mode:"acyclic",onEscape:function(t){return Kg(t,e,"overflow-button").each(Xw.focus),N.some(!0)}})])}}}),Pg({name:"overflow-button",overrides:function(e){return{buttonBehaviours:fd([pS.config({toggleClass:e.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),Pg({name:"overflow-group"})]),GH=function(e,t){return Kg(e,t,"overflow").map(OV.hasGrown).getOr(!1)},WH=function(e,t){Kg(e,t,"overflow-button").bind((function(){return Kg(e,t,"overflow")})).each((function(n){KH(e,t),OV.toggleGrow(n)}))},KH=function(e,t){Kg(e,t,"overflow").each((function(n){CH(e,t,(function(e){var t=G(e,(function(e){return _u(e)}));Kz.setGroups(n,t)})),Kg(e,t,"overflow-button").each((function(e){OV.hasGrown(n)&&pS.on(e)})),OV.refresh(n)}))},YH=function(e,t,n,r){var i="alloy.toolbar.toggle",o=function(t,n){var r=G(n,t.getSystem().build);e.builtGroups.set(r)};return{uid:e.uid,dom:e.dom,components:t,behaviours:rg(e.splitToolbarBehaviours,[EO.config({others:{overflowGroup:function(e){return $H.sketch(A(A({},r["overflow-group"]()),{items:[Cx.sketch(A(A({},r["overflow-button"]()),{action:function(t){xs(e,i)}}))]}))}}}),Uw("toolbar-toggle-events",[Rs(i,(function(t){WH(t,e)}))])]),apis:{setGroups:function(t,n){o(t,n),KH(t,e)},refresh:function(t){return KH(t,e)},toggle:function(t){return WH(t,e)},isOpen:function(t){return GH(t,e)}},domModification:{attributes:{role:"group"}}}},XH=hv({name:"SplitSlidingToolbar",configFields:jH(),partFields:qH(),factory:YH,apis:{setGroups:function(e,t,n){e.setGroups(t,n)},refresh:function(e,t){e.refresh(t)},toggle:function(e,t){e.toggle(t)},isOpen:function(e,t){return e.isOpen(t)}}}),JH=function(e){var t=e.title.fold((function(){return{}}),(function(e){return{attributes:{title:e}}}));return{dom:A({tag:"div",classes:["tox-toolbar__group"]},t),components:[$H.parts.items({})],items:e.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:fd([_L.config({}),Xw.config({})])}},QH=function(e){return $H.sketch(JH(e))},ZH=function(e,t){var n=Vs((function(t){var n=G(e.initGroups,QH);Kz.setGroups(t,n)}));return fd([xE.toolbarButton(e.providers.isDisabled),vE(),Aw.config({mode:t,onEscape:e.onEscape,selector:".tox-toolbar__group"}),Uw("toolbar-events",[n])])},ej=function(e){var t=e.cyclicKeying?"cyclic":"acyclic";return{uid:e.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":JH({title:N.none(),items:[]}),"overflow-button":oF({name:"more",icon:N.some("more-drawer"),disabled:!1,tooltip:N.some("More..."),primary:!1,borderless:!1},N.none(),e.providers)},splitToolbarBehaviours:ZH(e,t)}},tj=function(e){var t=ej(e),n=4,r=HH.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return HH.sketch(A(A({},t),{lazySink:e.getSink,getOverflowBounds:function(){var t=e.moreDrawerData.lazyHeader().element,r=Qr(t),i=pn(t),o=Qr(i),a=Math.max(i.dom.scrollHeight,o.height);return Xr(r.x+n,o.y,r.width-2*n,a)},parts:A(A({},t.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:e.attributes}}}),components:[r],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))},nj=function(e){var t=XH.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),n=XH.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),r=ej(e);return XH.sketch(A(A({},r),{components:[t,n],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(e){e.getSystem().broadcastOn([RU()],{type:"opened"})},onClosed:function(e){e.getSystem().broadcastOn([RU()],{type:"closed"})}}))},rj=function(e){var t=e.cyclicKeying?"cyclic":"acyclic";return Kz.sketch({uid:e.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(e.type===JT.scrolling?["tox-toolbar--scrolling"]:[])},components:[Kz.parts.groups({})],toolbarBehaviours:ZH(e,t)})},ij=function(e,t,n){var r={getSocket:function(t){return Mz.getPart(t,e,"socket")},setSidebar:function(t,n){Mz.getPart(t,e,"sidebar").each((function(e){return qV(e,n)}))},toggleSidebar:function(t,n){Mz.getPart(t,e,"sidebar").each((function(e){return GV(e,n)}))},whichSidebar:function(t){return Mz.getPart(t,e,"sidebar").bind(WV).getOrNull()},getHeader:function(t){return Mz.getPart(t,e,"header")},getToolbar:function(t){return Mz.getPart(t,e,"toolbar")},setToolbar:function(t,n){Mz.getPart(t,e,"toolbar").each((function(e){e.getApis().setGroups(e,n)}))},setToolbars:function(t,n){Mz.getPart(t,e,"multiple-toolbar").each((function(e){Hz.setItems(e,n)}))},refreshToolbar:function(t){var n=Mz.getPart(t,e,"toolbar");n.each((function(e){return e.getApis().refresh(e)}))},toggleToolbarDrawer:function(t){Mz.getPart(t,e,"toolbar").each((function(e){Me(e.getApis().toggle,(function(t){return t(e)}))}))},isToolbarDrawerToggled:function(t){return Mz.getPart(t,e,"toolbar").bind((function(e){return N.from(e.getApis().isOpen).map((function(t){return t(e)}))})).getOr(!1)},getThrobber:function(t){return Mz.getPart(t,e,"throbber")},focusToolbar:function(t){var n=Mz.getPart(t,e,"toolbar").orThunk((function(){return Mz.getPart(t,e,"multiple-toolbar")}));n.each((function(e){Aw.focusIn(e)}))},setMenubar:function(t,n){Mz.getPart(t,e,"menubar").each((function(e){rV.setMenus(e,n)}))},focusMenubar:function(t){Mz.getPart(t,e,"menubar").each((function(e){rV.focus(e)}))}};return{uid:e.uid,dom:e.dom,components:t,apis:r,behaviours:e.behaviours}},oj=Nz.optional({factory:rV,name:"menubar",schema:[Ao("backstage")]}),aj=function(e){return e.type===JT.sliding?nj:e.type===JT.floating?tj:rj},sj=Nz.optional({factory:{sketch:function(e){return Hz.sketch({uid:e.uid,dom:e.dom,listBehaviours:fd([Aw.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return rj({type:e.type,uid:il("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:e.providers,onEscape:function(){return e.onEscape(),N.some(!0)}})},setupItem:function(e,t,n,r){Kz.setGroups(t,n)},shell:!0})}},name:"multiple-toolbar",schema:[Ao("dom"),Ao("onEscape")]}),lj=Nz.optional({factory:{sketch:function(e){var t=aj(e),n={type:e.type,uid:e.uid,onEscape:function(){return e.onEscape(),N.some(!0)},cyclicKeying:!1,initGroups:[],getSink:e.getSink,providers:e.providers,moreDrawerData:{lazyToolbar:e.lazyToolbar,lazyMoreButton:e.lazyMoreButton,lazyHeader:e.lazyHeader},attributes:e.attributes};return t(n)}},name:"toolbar",schema:[Ao("dom"),Ao("onEscape"),Ao("getSink")]}),uj=Nz.optional({factory:{sketch:KU},name:"header",schema:[Ao("dom")]}),cj=Nz.optional({name:"socket",schema:[Ao("dom")]}),dj=Nz.optional({factory:{sketch:XV},name:"sidebar",schema:[Ao("dom")]}),fj=Nz.optional({factory:{sketch:lH},name:"throbber",schema:[Ao("dom")]}),hj=hv({name:"OuterContainer",factory:ij,configFields:[Ao("dom"),Ao("behaviours")],partFields:[uj,oj,lj,sj,cj,dj,fj],apis:{getSocket:function(e,t){return e.getSocket(t)},setSidebar:function(e,t,n){e.setSidebar(t,n)},toggleSidebar:function(e,t,n){e.toggleSidebar(t,n)},whichSidebar:function(e,t){return e.whichSidebar(t)},getHeader:function(e,t){return e.getHeader(t)},getToolbar:function(e,t){return e.getToolbar(t)},setToolbar:function(e,t,n){var r=G(n,(function(e){return QH(e)}));e.setToolbar(t,r)},setToolbars:function(e,t,n){var r=G(n,(function(e){return G(e,QH)}));e.setToolbars(t,r)},refreshToolbar:function(e,t){return e.refreshToolbar(t)},toggleToolbarDrawer:function(e,t){e.toggleToolbarDrawer(t)},isToolbarDrawerToggled:function(e,t){return e.isToolbarDrawerToggled(t)},getThrobber:function(e,t){return e.getThrobber(t)},setMenubar:function(e,t,n){e.setMenubar(t,n)},focusMenubar:function(e,t){e.focusMenubar(t)},focusToolbar:function(e,t){e.focusToolbar(t)}}}),mj="file edit view insert format tools table help",pj={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | language | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},gj=function(e,t,n){var r=Nk(n).split(/[ ,]/);return{text:e.title,getItems:function(){return re(e.items,(function(e){var n=e.toLowerCase();return 0===n.trim().length||H(r,(function(e){return e===n}))?[]:"separator"===n||"|"===n?[{type:"separator"}]:t.menuItems[n]?[t.menuItems[n]]:[]}))}}},vj=function(e){return"string"===typeof e?e.split(" "):e},bj=function(e,t){var n=A(A({},pj),t.menus),r=pe(t.menus).length>0,i=void 0===t.menubar||!0===t.menubar?vj(mj):vj(!1===t.menubar?"":t.menubar),o=X(i,(function(e){var n=Ee(pj,e);return r?n||ke(t.menus,e).exists((function(e){return Ee(e,"items")})):n})),a=G(o,(function(r){var i=n[r];return gj({title:i.title,items:vj(i.items)},t,e)}));return X(a,(function(e){var t=function(e){return"separator"!==e.type};return e.getItems().length>0&&H(e.getItems(),t)}))},yj=function(e){var t=function(){e._skinLoaded=!0,T_(e)};return function(){e.initialized?t():e.on("init",t)}},wj=function(e,t){return function(){return D_(e,{message:t})}},Sj=function(e,t,n){return new pT((function(r,i){n.load(t,r,i),e.on("remove",(function(){return n.unload(t)}))}))},xj=function(e,t){var n=t+"/skin.min.css";return Sj(e,n,e.ui.styleSheetLoader)},Cj=function(e,t){var n=On(tt.fromDom(e.getElement()));if(n){var r=t+"/skin.shadowdom.min.css";return Sj(e,r,Sk.DOM.styleSheetLoader)}return pT.resolve()},Tj=function(e,t){var n=Ck(t);n&&t.contentCSS.push(n+(e?"/content.inline":"/content")+".min.css"),!1===Dk(t)&&o(n)?pT.all([xj(t,n),Cj(t,n)]).then(yj(t),wj(t,"Skin could not be loaded")):yj(t)()},Dj=C(Tj,!1),kj=C(Tj,!0),Ej=function(e,t){return function(n){var r=tf(),i=function(){n.setActive(e.formatter.match(t));var i=e.formatter.formatChanged(t,n.setActive);r.set(i)};return e.initialized?i():e.once("init",i),function(){e.off("init",i),r.clear()}}},_j=function(e,t,n){return function(r){var i=function(){return n(r)},o=function(){n(r),e.on(t,i)};return e.initialized?o():e.once("init",o),function(){e.off("init",o),e.off(t,i)}}},Aj=function(e){return function(t){return function(){e.undoManager.transact((function(){e.focus(),e.execCommand("mceToggleFormat",!1,t.format)}))}}},Lj=function(e,t){return function(){return e.execCommand(t)}},Oj=function(e,t,n){var r=function(e,r,o,a){var s=t.shared.providers.translate(e.title);if("separator"===e.type)return N.some({type:"separator",text:s});if("submenu"===e.type){var l=re(e.getStyleItems(),(function(e){return i(e,r,a)}));return 0===r&&l.length<=0?N.none():N.some({type:"nestedmenuitem",text:s,disabled:l.length<=0,getSubmenuItems:function(){return re(e.getStyleItems(),(function(e){return i(e,r,a)}))}})}return N.some(A({type:"togglemenuitem",text:s,icon:e.icon,active:e.isSelected(a),disabled:o,onAction:n.onAction(e)},e.getStylePreview().fold((function(){return{}}),(function(e){return{meta:{style:e}}}))))},i=function(e,t,i){var o="formatter"===e.type&&n.isInvalid(e);return 0===t?o?[]:r(e,t,!1,i).toArray():r(e,t,o,i).toArray()},o=function(e){var t=n.getCurrentValue(),r=n.shouldHide?0:1;return re(e,(function(e){return i(e,r,t)}))},a=function(e,t){return function(n,r){var i=t(),a=o(i),s=eF(a,QT.CLOSE_ON_EXECUTE,e,!1);r(s)}};return{validateItems:o,getFetch:a}},Rj=function(e,t,n){var r=n.dataset,i="basic"===r.type?function(){return G(r.data,(function(e){return U$(e,n.isSelectedFor,n.getPreviewFor)}))}:r.getData;return{items:Oj(e,t,n),getStyleItems:i}},Ij=function(e,t,n){var r=Rj(e,t,n),i=r.items,o=r.getStyleItems,a=function(e){return{getComponent:w(e)}},s=_j(e,"NodeChange",(function(e){var t=e.getComponent();n.updateText(t)}));return jN({text:n.icon.isSome()?N.none():n.text,icon:n.icon,tooltip:N.from(n.tooltip),role:N.none(),fetch:i.getFetch(t,o),onSetup:s,getApi:a,columns:1,presets:"normal",classes:n.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",t.shared)},Pj=function(e){return G(e,(function(e){var t=e,n=e,r=e.split("=");return r.length>1&&(t=r[0],n=r[1]),{title:t,format:n}}))},Mj=function(e){return{type:"basic",data:e}};(function(e){e[e["SemiColon"]=0]="SemiColon",e[e["Space"]=1]="Space"})(iB||(iB={}));var Nj,Fj=function(e,t){return t===iB.SemiColon?e.replace(/;$/,"").split(";"):e.split(" ")},Bj=function(e,t,n,r){var i=e.getParam(t,n,"string"),o=Pj(Fj(i,r));return{type:"basic",data:o}},$j=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],zj=function(e){var t=function(){return ee($j,(function(t){return e.formatter.match(t.format)}))},n=function(t){return function(){return e.formatter.match(t)}},r=function(e){return N.none},i=function(e){var n=t(),r=n.fold(w("left"),(function(e){return e.title.toLowerCase()}));Cs(e,HN,{icon:"align-"+r})},o=Mj($j),a=function(t){return function(){return ee($j,(function(e){return e.format===t.format})).each((function(t){return e.execCommand(t.command)}))}};return{tooltip:"Align",text:N.none(),icon:N.some("align-left"),isSelectedFor:n,getCurrentValue:N.none,getPreviewFor:r,onAction:a,updateText:i,dataset:o,shouldHide:!1,isInvalid:function(t){return!e.formatter.canApply(t.format)}}},Uj=function(e,t){return Ij(e,t,zj(e))},Vj=function(e,t){var n=Rj(e,t,zj(e));e.ui.registry.addNestedMenuItem("align",{text:t.shared.providers.translate("Align"),getSubmenuItems:function(){return n.items.validateItems(n.getStyleItems())}})},Hj="Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",jj=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],qj=function(e){var t=e.split(/\s*,\s*/);return G(t,(function(e){return e.replace(/^['"]+|['"]+$/g,"")}))},Gj=function(e){var t=function(){var t=qj(e.toLowerCase());return ie(jj,(function(e){return t.indexOf(e.toLowerCase())>-1}))};return 0===e.indexOf("-apple-system")&&t()},Wj=function(e){var t="System Font",n=function(){var n=function(e){return e?qj(e)[0]:""},r=e.queryCommandValue("FontName"),i=l.data,o=r?r.toLowerCase():"",a=ee(i,(function(e){var t=e.format;return t.toLowerCase()===o||n(t).toLowerCase()===n(o).toLowerCase()})).orThunk((function(){return Ne(Gj(o),{title:t,format:o})}));return{matchOpt:a,font:r}},r=function(e){return function(t){return t.exists((function(t){return t.format===e}))}},i=function(){var e=n().matchOpt;return e},o=function(e){return function(){return N.some({tag:"div",styles:-1===e.indexOf("dings")?{"font-family":e}:{}})}},a=function(t){return function(){e.undoManager.transact((function(){e.focus(),e.execCommand("FontName",!1,t.format)}))}},s=function(e){var t=n(),r=t.matchOpt,i=t.font,o=r.fold(w(i),(function(e){return e.title}));Cs(e,VN,{text:o})},l=Bj(e,"font_formats",Hj,iB.SemiColon);return{tooltip:"Fonts",text:N.some(t),icon:N.none(),isSelectedFor:r,getCurrentValue:i,getPreviewFor:o,onAction:a,updateText:s,dataset:l,shouldHide:!1,isInvalid:k}},Kj=function(e,t){return Ij(e,t,Wj(e))},Yj=function(e,t){var n=Rj(e,t,Wj(e));e.ui.registry.addNestedMenuItem("fontformats",{text:t.shared.providers.translate("Fonts"),getSubmenuItems:function(){return n.items.validateItems(n.getStyleItems())}})},Xj="8pt 10pt 12pt 14pt 18pt 24pt 36pt",Jj={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},Qj={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},Zj=function(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n},eq=function(e,t){return/[0-9.]+px$/.test(e)?Zj(72*parseInt(e,10)/96,t||0)+"pt":ke(Qj,e).getOr(e)},tq=function(e){return ke(Jj,e).getOr("")},nq=function(e){var t=function(){var t=N.none(),n=s.data,r=e.queryCommandValue("FontSize");if(r)for(var i=function(e){var i=eq(r,e),o=tq(i);t=ee(n,(function(e){return e.format===r||e.format===i||e.format===o}))},o=3;t.isNone()&&o>=0;o--)i(o);return{matchOpt:t,size:r}},n=function(e){return function(t){return t.exists((function(t){return t.format===e}))}},r=function(){var e=t().matchOpt;return e},i=w(N.none),o=function(t){return function(){e.undoManager.transact((function(){e.focus(),e.execCommand("FontSize",!1,t.format)}))}},a=function(e){var n=t(),r=n.matchOpt,i=n.size,o=r.fold(w(i),(function(e){return e.title}));Cs(e,VN,{text:o})},s=Bj(e,"fontsize_formats",Xj,iB.Space);return{tooltip:"Font sizes",text:N.some("12pt"),icon:N.none(),isSelectedFor:n,getPreviewFor:i,getCurrentValue:r,onAction:o,updateText:a,dataset:s,shouldHide:!1,isInvalid:k}},rq=function(e,t){return Ij(e,t,nq(e))},iq=function(e,t){var n=Rj(e,t,nq(e));e.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return n.items.validateItems(n.getStyleItems())}})},oq=function(e,t){var n=t(),r=G(n,(function(e){return e.format}));return N.from(e.formatter.closest(r)).bind((function(e){return ee(n,(function(t){return t.format===e}))})).orThunk((function(){return Ne(e.formatter.match("p"),{title:"Paragraph",format:"p"})}))},aq="Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",sq=function(e){var t="Paragraph",n=function(t){return function(){return e.formatter.match(t)}},r=function(t){return function(){var n=e.formatter.get(t);return N.some({tag:n.length>0&&(n[0].inline||n[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(t))})}},i=function(n){var r=oq(e,(function(){return o.data})),i=r.fold(w(t),(function(e){return e.title}));Cs(n,VN,{text:i})},o=Bj(e,"block_formats",aq,iB.SemiColon);return{tooltip:"Blocks",text:N.some(t),icon:N.none(),isSelectedFor:n,getCurrentValue:N.none,getPreviewFor:r,onAction:Aj(e),updateText:i,dataset:o,shouldHide:!1,isInvalid:function(t){return!e.formatter.canApply(t.format)}}},lq=function(e,t){return Ij(e,t,sq(e))},uq=function(e,t){var n=Rj(e,t,sq(e));e.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return n.items.validateItems(n.getStyleItems())}})},cq=function(e,t){var n="Paragraph",r=function(t){return function(){return e.formatter.match(t)}},i=function(t){return function(){var n=e.formatter.get(t);return void 0!==n?N.some({tag:n.length>0&&(n[0].inline||n[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(t))}):N.none()}},o=function(t){var r=function(e){var t=e.items;return void 0!==t&&t.length>0?re(t,r):[{title:e.title,format:e.format}]},i=re(z$(e),r),o=oq(e,w(i)),a=o.fold(w(n),(function(e){return e.title}));Cs(t,VN,{text:a})};return{tooltip:"Formats",text:N.some(n),icon:N.none(),isSelectedFor:r,getCurrentValue:N.none,getPreviewFor:i,onAction:Aj(e),updateText:o,shouldHide:e.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(t){return!e.formatter.canApply(t.format)},dataset:t}},dq=function(e,t){var n=A({type:"advanced"},t.styleselect);return Ij(e,t,cq(e,n))},fq=function(e,t){var n=A({type:"advanced"},t.styleselect),r=Rj(e,t,cq(e,n));e.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return r.items.validateItems(r.getStyleItems())}})},hq=function(e,t){var n=function(n,r){e.updateState.each((function(e){var i=e(n,r);t.set(i)})),e.renderComponents.each((function(e){var i=e(r,t.get()),o=G(i,n.getSystem().build);Hm(n,o)}))};return _s([Rs(es(),(function(t,r){var i=r;if(!i.universal){var o=e.channel;V(i.channels,o)&&n(t,i.data)}})),Vs((function(t,r){e.initialData.each((function(e){n(t,e)}))}))])},mq=Object.freeze({__proto__:null,events:hq}),pq=function(e,t,n){return n},gq=Object.freeze({__proto__:null,getState:pq}),vq=[Ao("channel"),zo("renderComponents"),zo("updateState"),zo("initialData")],bq=function(){var e=ia(N.none()),t=function(){return e.set(N.none())},n=function(){return e.get().getOr("none")};return{readState:n,get:e.get,set:e.set,clear:t}},yq=Object.freeze({__proto__:null,init:bq}),wq=md({fields:vq,name:"reflecting",active:mq,apis:gq,state:yq}),Sq=w([Ao("toggleClass"),Ao("fetch"),uc("onExecute"),Ko("getHotspot",N.some),Ko("getAnchorOverrides",w({})),$f(),uc("onItemExecute"),zo("lazySink"),Ao("dom"),sc("onOpen"),tg("splitDropdownBehaviours",[EO,Aw,Xw]),Ko("matchWidth",!1),Ko("useMinWidth",!1),Ko("eventOrder",{}),zo("role")].concat(VO())),xq=Ig({factory:Cx,schema:[Ao("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:fd([Xw.revoke()])}},overrides:function(e){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(t){t.getSystem().getByUid(e.uid).each(Ts)},buttonBehaviours:fd([pS.config({toggleOnExecute:!1,toggleClass:e.toggleClass})])}}}),Cq=Ig({factory:Cx,schema:[Ao("dom")],name:"button",defaults:function(){return{buttonBehaviours:fd([Xw.revoke()])}},overrides:function(e){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(t){t.getSystem().getByUid(e.uid).each((function(n){e.onExecute(n,t)}))}}}}),Tq=w([xq,Cq,Mg({factory:{sketch:function(e){return{uid:e.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:e.text}}}},schema:[Ao("text")],name:"aria-descriptor"}),Pg({schema:[ic()],name:"menu",defaults:function(e){return{onExecute:function(t,n){t.getSystem().getByUid(e.uid).each((function(r){e.onItemExecute(r,t,n)}))}}}}),AO()]),Dq=function(e,t,n,r){var i,o=function(e){bv.getCurrent(e).each((function(e){rb.highlightFirst(e),Aw.focusIn(e)}))},a=function(t){var n=o;NO(e,S,t,r,n,eO.HighlightFirst).get(g)},s=function(e){return a(e),N.some(!0)},l=function(t){var n=Yg(t,e,"button");return Ts(n),N.some(!0)},u=A(A({},_s([Vs((function(t,n){var r=Kg(t,e,"aria-descriptor");r.each((function(e){var n=il("aria");zn(e.element,"id",n),zn(t.element,"aria-describedby",n)}))}))])),vS(N.some(a))),c={repositionMenus:function(e){pS.isOn(e)&&UO(e)}};return{uid:e.uid,dom:e.dom,components:t,apis:c,eventOrder:A(A({},e.eventOrder),(i={},i[ts()]=["disabling","toggling","alloy.base.behaviour"],i)),events:u,behaviours:rg(e.splitDropdownBehaviours,[EO.config({others:{sandbox:function(t){var n=Yg(t,e,"arrow"),r={onOpen:function(){pS.on(n),pS.on(t)},onClose:function(){pS.off(n),pS.off(t)}};return zO(e,t,r)}}}),Aw.config({mode:"special",onSpace:l,onEnter:l,onDown:s}),Xw.config({}),pS.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:e.role.getOr("button"),"aria-haspopup":!0}}}},kq=hv({name:"SplitDropdown",configFields:Sq(),partFields:Tq(),factory:Dq,apis:{repositionMenus:function(e,t){return e.repositionMenus(t)}}}),Eq=function(e){return{isDisabled:function(){return Fv.isDisabled(e)},setDisabled:function(t){return Fv.set(e,t)}}},_q=function(e){return{setActive:function(t){pS.set(e,t)},isActive:function(){return pS.isOn(e)},isDisabled:function(){return Fv.isDisabled(e)},setDisabled:function(t){return Fv.set(e,t)}}},Aq=function(e,t){return e.map((function(e){return{"aria-label":t.translate(e),title:t.translate(e)}})).getOr({})},Lq=il("focus-button"),Oq=function(e,t,n,r,i,o){var a;return{dom:{tag:"button",classes:["tox-tbtn"].concat(t.isSome()?["tox-tbtn--select"]:[]),attributes:Aq(n,o)},components:_E([e.map((function(e){return NN(e,o.icons)})),t.map((function(e){return BN(e,"tox-tbtn",o)}))]),eventOrder:(a={},a[Ia()]=["focusing","alloy.base.behaviour","common-button-display-events"],a),buttonBehaviours:fd([xE.toolbarButton(o.isDisabled),vE(),Uw("common-button-display-events",[Rs(Ia(),(function(e,t){t.event.prevent(),xs(e,Lq)}))])].concat(r.map((function(n){return wq.config({channel:n,initialData:{icon:e,text:t},renderComponents:function(e,t){return _E([e.icon.map((function(e){return NN(e,o.icons)})),e.text.map((function(e){return BN(e,"tox-tbtn",o)}))])}})})).toArray()).concat(i.getOr([])))}},Rq=function(e,t,n,r){var i=t.shared;return MH.sketch({lazySink:i.getSink,fetch:function(){return uO.nu((function(t){t(G(n(e.items),QH))}))},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:Oq(e.icon,e.text,e.tooltip,N.none(),N.none(),i.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:r}}}})},Iq=function(e,t,n){var r=ia(g),i=Oq(e.icon,e.text,e.tooltip,N.none(),N.none(),n);return Cx.sketch({dom:i.dom,components:i.components,eventOrder:UN,buttonBehaviours:fd([Uw("toolbar-button-events",[zN({onAction:e.onAction,getApi:t.getApi}),TE(t,r),DE(t,r)]),xE.toolbarButton((function(){return e.disabled||n.isDisabled()})),vE()].concat(t.toolbarButtonBehaviours))})},Pq=function(e,t){return Mq(e,t,[])},Mq=function(e,t,n){return Iq(e,{toolbarButtonBehaviours:[].concat(n.length>0?[Uw("toolbarButtonWith",n)]:[]),getApi:Eq,onSetup:e.onSetup},t)},Nq=function(e,t){return Fq(e,t,[])},Fq=function(e,t,n){return Si(Iq(e,{toolbarButtonBehaviours:[$w.config({}),pS.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(n.length>0?[Uw("toolbarToggleButtonWith",n)]:[]),getApi:_q,onSetup:e.onSetup},t))},Bq=function(e,t,n){return function(r){return uO.nu((function(e){return t.fetch(e)})).map((function(i){return N.from(UA(Si(dA(il("menu-value"),i,(function(n){t.onItemAction(e(r),n)}),t.columns,t.presets,QT.CLOSE_ON_EXECUTE,t.select.getOr(k),n),{movement:hA(t.columns,t.presets),menuBehaviours:sk.unnamedEvents("auto"!==t.columns?[]:[Vs((function(e,n){ik(e,4,yD(t.presets)).each((function(t){var n=t.numRows,r=t.numColumns;Aw.setGridSize(e,n,r)}))}))])})))}))}},$q=function(e,t){var n,r=il("channel-update-split-dropdown-display"),i=function(e){return{isDisabled:function(){return Fv.isDisabled(e)},setDisabled:function(t){return Fv.set(e,t)},setIconFill:function(t,n){Bu(e.element,'svg path[id="'+t+'"], rect[id="'+t+'"]').each((function(e){zn(e,"fill",n)}))},setIconStroke:function(t,n){Bu(e.element,'svg path[id="'+t+'"], rect[id="'+t+'"]').each((function(e){zn(e,"stroke",n)}))},setActive:function(t){zn(e.element,"aria-pressed",t),Bu(e.element,"span").each((function(n){e.getSystem().getByDom(n).each((function(e){return pS.set(e,t)}))}))},isActive:function(){return Bu(e.element,"span").exists((function(t){return e.getSystem().getByDom(t).exists(pS.isOn)}))}}},o=ia(g),a={getApi:i,onSetup:e.onSetup};return kq.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:A({"aria-pressed":!1},Aq(e.tooltip,t.providers))},onExecute:function(t){e.onAction(i(t))},onItemExecute:function(e,t,n){},splitDropdownBehaviours:fd([xE.splitButton(t.providers.isDisabled),vE(),Uw("split-dropdown-events",[Rs(Lq,Xw.focus),TE(a,o),DE(a,o)]),XO.config({})]),eventOrder:(n={},n[fs()]=["alloy.base.behaviour","split-dropdown-events"],n),toggleClass:"tox-tbtn--enabled",lazySink:t.getSink,fetch:Bq(i,e,t.providers),parts:{menu:DD(!1,e.columns,e.presets)},components:[kq.parts.button(Oq(e.icon,e.text,N.none(),N.some(r),N.some([pS.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),t.providers)),kq.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:zC("chevron-down",t.providers.icons)},buttonBehaviours:fd([xE.splitButton(t.providers.isDisabled),vE(),HC()])}),kq.parts["aria-descriptor"]({text:t.providers.translate("To open the popup, press Shift+Enter")})]})},zq=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],Uq=function(e,t){return function(n,r,i){var o=e(n).mapError((function(e){return Co(e)})).getOrDie();return t(o,r,i)}},Vq={button:Uq(MT,(function(e,t){return Pq(e,t.backstage.shared.providers)})),togglebutton:Uq(BT,(function(e,t){return Nq(e,t.backstage.shared.providers)})),menubutton:Uq(ZU,(function(e,t){return nF(e,"tox-tbtn",t.backstage,N.none())})),splitbutton:Uq(tV,(function(e,t){return $q(e,t.backstage.shared)})),grouptoolbarbutton:Uq(XU,(function(e,t,n){var r,i=n.ui.registry.getAll().buttons,o=function(e){return Xq(n,{buttons:i,toolbar:e,allowToolbarGroups:!1},t,N.none())},a=(r={},r[Ff]=t.backstage.shared.header.isPositionedAtTop()?Bd.TopToBottom:Bd.BottomToTop,r);switch(Vk(n)){case JT.floating:return Rq(e,t.backstage,o,a);default:throw new Error("Toolbar groups are only supported when using floating toolbar mode")}})),styleSelectButton:function(e,t){return dq(e,t.backstage)},fontsizeSelectButton:function(e,t){return rq(e,t.backstage)},fontSelectButton:function(e,t){return Kj(e,t.backstage)},formatButton:function(e,t){return lq(e,t.backstage)},alignMenuButton:function(e,t){return Uj(e,t.backstage)}},Hq=function(e,t,n){return ke(Vq,e.type).fold((function(){return console.error("skipping button defined by",e),N.none()}),(function(r){return N.some(r(e,t,n))}))},jq={styleselect:Vq.styleSelectButton,fontsizeselect:Vq.fontsizeSelectButton,fontselect:Vq.fontSelectButton,formatselect:Vq.formatButton,align:Vq.alignMenuButton},qq=function(e){var t=G(zq,(function(t){var n=X(t.items,(function(t){return Ee(e,t)||Ee(jq,t)}));return{name:t.name,items:n}}));return X(t,(function(e){return e.items.length>0}))},Gq=function(e){var t=e.split("|");return G(t,(function(e){return{items:e.trim().split(" ")}}))},Wq=function(e){return p(e,(function(e){return Ee(e,"name")&&Ee(e,"items")}))},Kq=function(e){var t=e.toolbar,n=e.buttons;return!1===t?[]:void 0===t||!0===t?qq(n):o(t)?Gq(t):Wq(t)?t:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])},Yq=function(e,t,n,r,i,o){return ke(t,n.toLowerCase()).orThunk((function(){return o.bind((function(e){return me(e,(function(e){return ke(t,e+n.toLowerCase())}))}))})).fold((function(){return ke(jq,n.toLowerCase()).map((function(t){return t(e,i)})).orThunk((function(){return N.none()}))}),(function(t){return"grouptoolbarbutton"!==t.type||r?Hq(t,i,e):(console.warn("Ignoring the '"+n+"' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested."),N.none())}))},Xq=function(e,t,n,r){var i=Kq(t),o=G(i,(function(i){var o=re(i.items,(function(i){return 0===i.trim().length?[]:Yq(e,t.buttons,i,t.allowToolbarGroups,n,r).toArray()}));return{title:N.from(e.translate(i.name)),items:o}}));return X(o,(function(e){return e.items.length>0}))},Jq=function(e,t,n,r){var i=t.outerContainer,a=n.toolbar,s=n.buttons;if(p(a,o)){var l=a.map((function(t){var i={toolbar:t,buttons:s,allowToolbarGroups:n.allowToolbarGroups};return Xq(e,i,{backstage:r},N.none())}));hj.setToolbars(i,l)}else hj.setToolbar(i,Xq(e,n,{backstage:r},N.none()))},Qq=tn(),Zq=Qq.os.isiOS()&&Qq.os.version.major<=12,eG=function(e,t){var n=e.dom,r=e.getWin(),i=e.getDoc().documentElement,o=ia(cr(r.innerWidth,r.innerHeight)),a=ia(cr(i.offsetWidth,i.offsetHeight)),s=function(){var t=o.get();t.left===r.innerWidth&&t.top===r.innerHeight||(o.set(cr(r.innerWidth,r.innerHeight)),E_(e))},l=function(){var t=e.getDoc().documentElement,n=a.get();n.left===t.offsetWidth&&n.top===t.offsetHeight||(a.set(cr(t.offsetWidth,t.offsetHeight)),E_(e))},u=function(t){return __(e,t)};n.bind(r,"resize",s),n.bind(r,"scroll",u);var c=sf(tt.fromDom(e.getBody()),"load",l),d=t.uiMothership.element;e.on("hide",(function(){Kn(d,"display","none")})),e.on("show",(function(){nr(d,"display")})),e.on("NodeChange",l),e.on("remove",(function(){c.unbind(),n.unbind(r,"resize",s),n.unbind(r,"scroll",u),r=null}))},tG=function(e,t,n,r,i){var o=ia(0),a=t.outerContainer;Dj(e);var s=tt.fromDom(i.targetNode),l=Ln(An(s));Xm(s,t.mothership),Ym(l,t.uiMothership),e.on("PostRender",(function(){Jq(e,t,n,r),o.set(e.getWin().innerWidth),hj.setMenubar(a,bj(e,n)),hj.setSidebar(a,n.sidebar),eG(e,t)}));var u=hj.getSocket(a).getOrDie("Could not find expected socket element");if(Zq){Yn(u.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"});var c=QC((function(){e.fire("ScrollContent")}),20),d=af(u.element,"scroll",c.throttle);e.on("remove",d.unbind)}gE(e,t),e.addCommand("ToggleSidebar",(function(t,n){hj.toggleSidebar(a,n),e.fire("ToggleSidebar")})),e.addQueryValueHandler("ToggleSidebar",(function(){return hj.whichSidebar(a)}));var f=Vk(e),h=function(){hj.refreshToolbar(t.outerContainer)};f!==JT.sliding&&f!==JT.floating||e.on("ResizeWindow ResizeEditor ResizeContent",(function(){var t=e.getWin().innerWidth;t!==o.get()&&(h(),o.set(t))}));var m={enable:function(){pE(t,!1)},disable:function(){pE(t,!0)},isDisabled:function(){return Fv.isDisabled(a)}};return{iframeContainer:u.element.dom,editorContainer:a.element.dom,api:m}},nG=Object.freeze({__proto__:null,render:tG}),rG=function(e){var t=/^[0-9\.]+(|px)$/i;return t.test(""+e)?N.some(parseInt(""+e,10)):N.none()},iG=function(e){return m(e)?e+"px":e},oG=function(e,t,n){var r=t.filter((function(t){return e<t})),i=n.filter((function(t){return e>t}));return r.or(i).getOr(e)},aG=function(e){var t=kk(e),n=Ak(e),r=Ok(e);return rG(t).map((function(e){return oG(e,n,r)}))},sG=function(e){var t=aG(e);return t.getOr(kk(e))},lG=function(e){var t=Ek(e),n=_k(e),r=Lk(e);return rG(t).map((function(e){return oG(e,n,r)}))},uG=function(e){var t=lG(e);return t.getOr(Ek(e))},cG=function(e,t,n,r,i){var o=n.uiMothership,a=n.outerContainer,s=Sk.DOM,l=Jk(e),u=eE(e),c=Lk(e).or(lG(e)),d=r.shared.header,f=d.isPositionedAtTop,h=Vk(e),m=h===JT.sliding||h===JT.floating,p=ia(!1),g=function(){return p.get()&&!e.removed},v=function(e){return m?e.fold(w(0),(function(e){return e.components().length>1?ar(e.components()[1].element):0})):0},b=function(n){switch(qk(e)){case Uk.auto:var r=hj.getToolbar(a),i=v(r),o=ar(n.element)-i,s=Jr(t),l=s.y>o;if(l)return"top";var u=pn(t),c=Math.max(u.dom.scrollHeight,ar(u)),d=s.bottom<c-o;if(d)return"bottom";var f=Zr(),h=f.bottom<s.bottom-o;return h?"bottom":"top";case Uk.bottom:return"bottom";case Uk.top:default:return"top"}},y=function(e){var t=i.get();OU.setModes(t,[e]),d.setDockingMode(e);var n=f()?Bd.TopToBottom:Bd.BottomToTop;zn(t.element,Ff,n)},S=function(){var e=c.getOrThunk((function(){var e=rG(Jn(Fn(),"margin-left")).getOr(0);return vr(Fn())-hr(t).left+e}));Kn(i.get().element,"max-width",e+"px")},x=function(){var e=hj.getToolbar(a),n=v(e),r=Jr(t),o=f()?Math.max(r.y-ar(i.get().element)+n,0):r.bottom;Yn(a.element,{position:"absolute",top:Math.round(o)+"px",left:Math.round(r.x)+"px"})},C=function(){o.broadcastOn([wp()],{})},T=function(e){if(void 0===e&&(e=!1),g()){if(l||S(),m&&hj.refreshToolbar(a),l||x(),u){var t=i.get();e?OU.reset(t):OU.refresh(t)}C()}},D=function(e){if(void 0===e&&(e=!0),!l&&u&&g()){var t=d.getDockingMode(),n=b(i.get());n!==t&&(y(n),e&&T(!0))}},k=function(){p.set(!0),Kn(a.element,"display","flex"),s.addClass(e.getBody(),"mce-edit-focus"),nr(o.element,"display"),D(!1),T()},E=function(){p.set(!1),n.outerContainer&&(Kn(a.element,"display","none"),s.removeClass(e.getBody(),"mce-edit-focus")),Kn(o.element,"display","none")};return{isVisible:g,isPositionedAtTop:f,show:k,hide:E,update:T,updateMode:D,repositionPopups:C}},dG=function(e,t){var n=Jr(e);return{pos:t?n.y:n.bottom,bounds:n}},fG=function(e,t,n,r){var i=ia(dG(t,n.isPositionedAtTop())),o=function(r){var o=dG(t,n.isPositionedAtTop()),a=o.pos,s=o.bounds,l=i.get(),u=l.pos,c=l.bounds,d=s.height!==c.height||s.width!==c.width;i.set({pos:a,bounds:s}),d&&E_(e,r),n.isVisible()&&(u!==a?n.update(!0):d&&(n.updateMode(),n.repositionPopups()))};r||(e.on("activate",n.show),e.on("deactivate",n.hide)),e.on("SkinLoaded ResizeWindow",(function(){return n.update(!0)})),e.on("NodeChange keydown",(function(e){Sx.requestAnimationFrame((function(){return o(e)}))})),e.on("ScrollWindow",(function(){return n.updateMode()}));var a=tf();a.set(sf(tt.fromDom(e.getBody()),"load",o)),e.on("remove",(function(){a.clear()}))},hG=function(e,t,n,r,i){var o=t.mothership,a=t.uiMothership,s=t.outerContainer,l=ia(null),u=tt.fromDom(i.targetNode),c=cG(e,u,t,r,l),d=Yk(e);kj(e);var f=function(){if(l.get())c.show();else{l.set(hj.getHeader(s).getOrDie());var i=Qk(e);Ym(i,o),Ym(i,a),Jq(e,t,n,r),hj.setMenubar(s,bj(e,n)),c.show(),fG(e,u,c,d),e.nodeChanged()}};e.on("show",f),e.on("hide",c.hide),d||(e.on("focus",f),e.on("blur",c.hide)),e.on("init",(function(){(e.hasFocus()||d)&&f()})),gE(e,t);var h={show:function(){c.show()},hide:function(){c.hide()},enable:function(){pE(t,!1)},disable:function(){pE(t,!0)},isDisabled:function(){return Fv.isDisabled(s)}};return{editorContainer:s.element.dom,api:h}},mG=Object.freeze({__proto__:null,render:hG}),pG="contexttoolbar-show",gG="contexttoolbar-hide",vG=function(e){return{hide:function(){return xs(e,os())},getValue:function(){return eg.getValue(e)}}},bG=function(e,t){return Rs($N,(function(n,r){var i=e.get(n),o=vG(i);t.onAction(o,r.event.buttonApi)}))},yG=function(e,t,n){var r=t.original;r.primary;var i=L(r,["primary"]),o=So(MT(A(A({},i),{type:"button",onAction:g})));return Mq(o,n.backstage.shared.providers,[bG(e,t)])},wG=function(e,t,n){var r=t.original;r.primary;var i=L(r,["primary"]),o=So(BT(A(A({},i),{type:"togglebutton",onAction:g})));return Fq(o,n.backstage.shared.providers,[bG(e,t)])},SG=function(e,t,n){var r={backstage:{shared:{providers:n}}};return"contextformtogglebutton"===t.type?wG(e,t,r):yG(e,t,r)},xG=function(e,t,n){var r=G(t,(function(t){return Ex(SG(e,t,n))})),i=function(){return G(r,(function(e){return e.asSpec()}))},o=function(e){return me(t,(function(t,n){return t.primary?N.from(r[n]).bind((function(t){return t.getOpt(e)})).filter(T(Fv.isDisabled)):N.none()}))};return{asSpecs:i,findPrimary:o}},CG=function(e,t){var n=e.label.fold((function(){return{}}),(function(e){return{"aria-label":e}})),r=Ex(JL.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:e.initValue(),inputAttributes:n,selectOnFocus:!0,inputBehaviours:fd([Aw.config({mode:"special",onEnter:function(e){return i.findPrimary(e).map((function(e){return Ts(e),!0}))},onLeft:function(e,t){return t.cut(),N.none()},onRight:function(e,t){return t.cut(),N.none()}})])})),i=xG(r,e.commands,t);return[{title:N.none(),items:[r.asSpec()]},{title:N.none(),items:i.asSpecs()}]},TG=function(e,t,n){return rj({type:e,uid:il("context-toolbar"),initGroups:CG(t,n),onEscape:N.none,cyclicKeying:!0,providers:n})},DG={renderContextForm:TG,buildInitGroups:CG},kG=function(e,t,n){return void 0===n&&(n=.01),t.bottom-e.y>=n&&e.bottom-t.y>=n},EG=function(e){var t=e.getBoundingClientRect();if(t.height<=0&&t.width<=0){var n=Dn(tt.fromDom(e.startContainer),e.startOffset).element,r=dt(n)?vn(n):N.some(n);return r.filter(ct).map((function(e){return e.dom.getBoundingClientRect()})).getOr(t)}return t},_G=function(e){var t=e.selection.getRng(),n=EG(t);if(e.inline){var r=Fr();return Xr(r.left+n.left,r.top+n.top,n.width,n.height)}var i=Qr(tt.fromDom(e.getBody()));return Xr(i.x+n.left,i.y+n.top,n.width,n.height)},AG=function(e,t){return t.filter(Nn).map(Qr).getOrThunk((function(){return _G(e)}))},LG=function(e,t,n){var r=Math.max(e.x+n,t.x),i=Math.min(e.right-n,t.right);return{x:r,width:i-r}},OG=function(e,t,n,r,i,o){var a=tt.fromDom(e.getContainer()),s=Bu(a,".tox-editor-header").getOr(a),l=Jr(s),u=l.y>=t.bottom,c=r&&!u;if(e.inline&&c)return{y:Math.max(l.bottom+o,n.y),bottom:n.bottom};if(e.inline&&!c)return{y:n.y,bottom:Math.min(l.y-o,n.bottom)};var d="line"===i?Jr(a):t;return c?{y:Math.max(l.bottom+o,n.y),bottom:Math.min(d.bottom-o,n.bottom)}:{y:Math.max(d.y+o,n.y),bottom:Math.min(l.y-o,n.bottom)}},RG=function(e,t,n,r){void 0===r&&(r=0);var i=Ur(window),o=Jr(tt.fromDom(e.getContentAreaContainer())),a=Fk(e)||Bk(e)||zk(e),s=LG(o,i,r),l=s.x,u=s.width;if(e.inline&&!a)return Xr(l,i.y,u,i.height);var c=t.header.isPositionedAtTop(),d=OG(e,o,i,c,n,r),f=d.y,h=d.bottom;return Xr(l,f,u,h-f)},IG=12,PG={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"],inset:["tox-pop--inset"]},MG={maxHeightFunction:Ef(),maxWidthFunction:EH()},NG=function(e,t){var n=e.selection.getRng(),r=Dn(tt.fromDom(n.startContainer),n.startOffset);return n.startContainer===n.endContainer&&n.startOffset===n.endOffset-1&&un(r.element,t)},FG=function(e,t,n){var r=Zn(e,"position");Kn(e,"position",t);var i=n(e);return r.each((function(t){return Kn(e,"position",t)})),i},BG=function(e){return"node"===e},$G=function(e,t,n,r,i){var o=_G(e),a=r.lastElement().exists((function(e){return un(n,e)}));if(NG(e,n))return a?bx:hx;if(a)return FG(t,r.getMode(),(function(){var e=kG(o,Jr(t));return e&&!r.isReposition()?wx:bx}));var s="fixed"===r.getMode()?i.y+Fr().top:i.y,l=ar(t)+IG;return s+l<=o.y?hx:mx},zG=function(e,t,n,r){var i=function(t){return function(r,i,o,a,s){var l=$G(e,a,t,n,s),u=A(A({},r),{y:s.y,height:s.height});return A(A({},l(u,i,o,a,s)),{alwaysFit:!0})}},o=function(e){return BG(r)?[i(e)]:[]},a={onLtr:function(e){return[qc,Gc,Hc,Uc,jc,Vc].concat(o(e))},onRtl:function(e){return[qc,Gc,jc,Vc,Hc,Uc].concat(o(e))}},s={onLtr:function(e){return[Gc,Uc,Vc,Hc,jc,qc].concat(o(e))},onRtl:function(e){return[Gc,Vc,Uc,jc,Hc,qc].concat(o(e))}};return t?s:a},UG=function(e,t,n,r){return"line"===t?{bubble:Rf(IG,0,PG),layouts:{onLtr:function(){return[Wc]},onRtl:function(){return[Kc]}},overrides:MG}:{bubble:Rf(0,IG,PG,1/IG),layouts:zG(e,n,r,t),overrides:MG}},VG=function(e,t){var n=X(t,(function(t){return t.predicate(e.dom)})),r=Y(n,(function(e){return"contexttoolbar"===e.type})),i=r.pass,o=r.fail;return{contextToolbars:i,contextForms:o}},HG=function(e){if(e.length<=1)return e;var t=function(t){return H(e,(function(e){return e.position===t}))},n=function(t){return X(e,(function(e){return e.position===t}))},r=t("selection"),i=t("node");if(r||i){if(i&&r){var o=n("node"),a=G(n("selection"),(function(e){return A(A({},e),{position:"node"})}));return o.concat(a)}return n(r?"selection":"node")}return n("line")},jG=function(e){if(e.length<=1)return e;var t=function(t){return ee(e,(function(e){return e.position===t}))},n=t("selection").orThunk((function(){return t("node")})).orThunk((function(){return t("line")})).map((function(e){return e.position}));return n.fold((function(){return[]}),(function(t){return X(e,(function(e){return e.position===t}))}))},qG=function(e,t,n){var r=VG(e,t);if(r.contextForms.length>0)return N.some({elem:e,toolbars:[r.contextForms[0]]});var i=VG(e,n);if(i.contextForms.length>0)return N.some({elem:e,toolbars:[i.contextForms[0]]});if(r.contextToolbars.length>0||i.contextToolbars.length>0){var o=HG(r.contextToolbars.concat(i.contextToolbars));return N.some({elem:e,toolbars:o})}return N.none()},GG=function(e,t,n){return e(t)?N.none():ya(t,(function(e){if(ct(e)){var t=VG(e,n.inNodeScope),r=t.contextToolbars,i=t.contextForms,o=i.length>0?i:jG(r);return o.length>0?N.some({elem:e,toolbars:o}):N.none()}return N.none()}),e)},WG=function(e,t){var n=tt.fromDom(t.getBody()),r=function(e){return un(e,n)},i=function(e){return!r(e)&&!fn(n,e)},o=tt.fromDom(t.selection.getNode());return i(o)?N.none():qG(o,e.inNodeScope,e.inEditorScope).orThunk((function(){return GG(r,o,e)}))},KG=function(e,t){var n={},r=[],i=[],o={},a={},s=function(e,s){var l=So(GT(s));n[e]=l,l.launch.map((function(n){o["form:"+e]=A(A({},s.launch),{type:"contextformtogglebutton"===n.type?"togglebutton":"button",onAction:function(){t(l)}})})),"editor"===l.scope?i.push(l):r.push(l),a[e]=l},l=function(e,t){KT(t).each((function(n){"editor"===t.scope?i.push(n):r.push(n),a[e]=n}))},u=pe(e);return W(u,(function(t){var n=e[t];"contextform"===n.type?s(t,n):"contexttoolbar"===n.type&&l(t,n)})),{forms:n,inNodeScope:r,inEditorScope:i,lookupTable:a,formNavigators:o}},YG=il("forward-slide"),XG=il("backward-slide"),JG=il("change-slide-event"),QG="tox-pop--resizing",ZG=function(e){var t=ia([]);return tx.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(e){t.set([]),tx.getContent(e).each((function(e){nr(e.element,"visibility")})),su(e.element,QG),nr(e.element,"width")},inlineBehaviours:fd([Uw("context-toolbar-events",[Us(Ga(),(function(e,t){"width"===t.event.raw.propertyName&&(su(e.element,QG),nr(e.element,"width"))})),Rs(JG,(function(e,t){var n=e.element;nr(n,"width");var r=vr(n);tx.setContent(e,t.event.contents),ou(n,QG);var i=vr(n);Kn(n,"width",r+"px"),tx.getContent(e).each((function(e){t.event.focus.bind((function(e){return xd(e),kd(n)})).orThunk((function(){return Aw.focusIn(e),Dd(An(n))}))})),Sx.setTimeout((function(){Kn(e.element,"width",i+"px")}),0)})),Rs(YG,(function(e,n){tx.getContent(e).each((function(n){t.set(t.get().concat([{bar:n,focus:Dd(An(e.element))}]))})),Cs(e,JG,{contents:n.event.forwardContents,focus:N.none()})})),Rs(XG,(function(e,n){fe(t.get()).each((function(n){t.set(t.get().slice(0,t.get().length-1)),Cs(e,JG,{contents:_u(n.bar),focus:n.focus})}))}))]),Aw.config({mode:"special",onEscape:function(n){return fe(t.get()).fold((function(){return e.onEscape()}),(function(e){return xs(n,XG),N.some(!0)}))}})]),lazySink:function(){return ri.value(e.sink)}})},eW="tox-pop--transition",tW=function(e,t,n,r){var i=r.backstage,o=i.shared,a=tn().deviceType.isTouch,s=rf(),l=rf(),u=rf(),c=Eu(ZG({sink:n,onEscape:function(){return e.focus(),N.some(!0)}})),d=function(){var t=u.get().getOr("node"),n=BG(t)?1:0;return RG(e,o,t,n)},f=function(){return!e.removed&&!(a()&&i.isContextMenuOpen())},h=function(e){return Ae(Ie(e,s.get(),un),!0)},m=function(){if(f()){var t=d(),n=Ae(u.get(),"node")?AG(e,s.get()):_G(e);return t.height<=0||!kG(n,t)}return!0},p=function(){s.clear(),l.clear(),u.clear(),tx.hide(c)},v=function(){if(tx.isOpen(c)){var e=c.element;nr(e,"display"),m()?Kn(e,"display","none"):(l.set(0),tx.reposition(c))}},b=function(t){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[t],behaviours:fd([Aw.config({mode:"acyclic"}),Uw("pop-dialog-wrap-events",[Vs((function(t){e.shortcuts.add("ctrl+F9","focus statusbar",(function(){return Aw.focusIn(t)}))})),Hs((function(t){e.shortcuts.remove("ctrl+F9")}))])])}},y=mt((function(){return KG(t,(function(e){var t=x([e]);Cs(c,YG,{forwardContents:b(t)})}))})),w=function(t,n){return Xq(e,{buttons:t,toolbar:n.items,allowToolbarGroups:!1},r,N.some(["form:"]))},S=function(e,t){return DG.buildInitGroups(e,t)},x=function(t){var n=e.ui.registry.getAll().buttons,r=y(),i=A(A({},n),r.formNavigators),a=Vk(e)===JT.scrolling?JT.scrolling:JT.default,s=ne(G(t,(function(e){return"contexttoolbar"===e.type?w(i,e):S(e,o.providers)})));return rj({type:a,uid:il("context-toolbar"),initGroups:s,onEscape:N.none,cyclicKeying:!0,providers:o.providers})},C=function(t,r){var i="node"===t?o.anchors.node(r):o.anchors.cursor(),u=UG(e,t,a(),{lastElement:s.get,isReposition:function(){return Ae(l.get(),0)},getMode:function(){return Bm.getMode(n)}});return Si(i,u)},T=function(e,t){if(D.cancel(),f()){var r=x(e),i=e[0].position,o=C(i,t);u.set(i),l.set(1);var a=c.element;nr(a,"display"),h(t)||(su(a,eW),Bm.reset(n,c)),tx.showWithinBounds(c,b(r),{anchor:o,transition:{classes:[eW],mode:"placement"}},(function(){return N.some(d())})),t.fold(s.clear,s.set),m()&&Kn(a,"display","none")}},D=ZC((function(){if(e.hasFocus()&&!e.removed)if(lu(c.element,eW))D.throttle();else{var t=y();WG(t,e).fold(p,(function(e){T(e.toolbars,N.some(e.elem))}))}}),17);e.on("init",(function(){e.on("remove",p),e.on("ScrollContent ScrollWindow ObjectResized ResizeEditor longpress",v),e.on("click keyup focus SetContent",D.throttle),e.on(gG,p),e.on(pG,(function(t){var n=y();ke(n.lookupTable,t.toolbarKey).each((function(n){T([n],Ne(t.target!==e,t.target)),tx.getContent(c).each(Aw.focusIn)}))})),e.on("focusout",(function(t){Sx.setEditorTimeout(e,(function(){kd(n.element).isNone()&&kd(c.element).isNone()&&p()}),0)})),e.on("SwitchMode",(function(){e.mode.isReadOnly()&&p()})),e.on("AfterProgressState",(function(t){t.state?p():e.hasFocus()&&D.throttle()})),e.on("NodeChange",(function(e){kd(c.element).fold(D.throttle,g)}))}))},nW=function(e){var t=[{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}];W(t,(function(t){e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:Lj(e,t.cmd),onSetup:Ej(e,t.name)})})),e.ui.registry.addButton("alignnone",{tooltip:"No alignment",icon:"align-none",onAction:Lj(e,"JustifyNone")})},rW={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},iW=function(){var e="[0-9]+",t="[+-]?"+e,n="[eE]"+t,r="\\.",i=function(e){return"(?:"+e+")?"},o=["Infinity",e+r+i(e)+i(n),r+e+i(n),e+i(n)].join("|"),a="[+-]?(?:"+o+")";return new RegExp("^("+a+")(.*)$")}(),oW=function(e,t){return H(t,(function(t){return H(rW[t],(function(t){return e===t}))}))},aW=function(e,t){var n=N.from(iW.exec(e));return n.bind((function(e){var n=Number(e[1]),r=e[2];return oW(r,t)?N.some({value:n,unit:r}):N.none()}))},sW=function(e,t){return aW(e,t).map((function(e){var t=e.value,n=e.unit;return t+n}))},lW=function(e,t){var n=function(){var n=t.getOptions(e),r=t.getCurrent(e).map(t.hash),i=rf();return G(n,(function(n){return{type:"togglemenuitem",text:t.display(n),onSetup:function(o){var a=function(e){e&&(i.on((function(e){return e.setActive(!1)})),i.set(o)),o.setActive(e)};a(Ae(r,t.hash(n)));var s=t.watcher(e,n,a);return function(){i.clear(),s()}},onAction:function(){return t.setCurrent(e,n)}}}))};e.ui.registry.addMenuButton(t.name,{tooltip:t.text,icon:t.icon,fetch:function(e){return e(n())},onSetup:t.onToolbarSetup}),e.ui.registry.addNestedMenuItem(t.name,{type:"nestedmenuitem",text:t.text,getSubmenuItems:n,onSetup:t.onMenuSetup})},uW={name:"lineheight",text:"Line height",icon:"line-height",getOptions:Pk,hash:function(e){return sW(e,["fixed","relative","empty"]).getOr(e)},display:S,watcher:function(e,t,n){return e.formatter.formatChanged("lineheight",n,!1,{value:t}).unbind},getCurrent:function(e){return N.from(e.queryCommandValue("LineHeight"))},setCurrent:function(e,t){return e.execCommand("LineHeight",!1,t)}},cW=function(e){var t=N.from(Mk(e));return t.map((function(t){return{name:"language",text:"Language",icon:"language",getOptions:w(t),hash:function(e){return c(e.customCode)?e.code:e.code+"/"+e.customCode},display:function(e){return e.title},watcher:function(e,t,n){return e.formatter.formatChanged("lang",n,!1,{value:t.code,customValue:t.customCode}).unbind},getCurrent:function(e){var t=tt.fromDom(e.selection.getNode());return wa(t,(function(e){return N.some(e).filter(ct).bind((function(e){var t=Hn(e,"lang");return t.map((function(t){var n=Hn(e,"data-mce-lang").getOrUndefined();return{code:t,customCode:n,title:""}}))}))}))},setCurrent:function(e,t){return e.execCommand("Lang",!1,t)},onToolbarSetup:function(t){var n=tf();return t.setActive(e.formatter.match("lang",{},void 0,!0)),n.set(e.formatter.formatChanged("lang",t.setActive,!0)),n.clear}}}))},dW=function(e){lW(e,uW),cW(e).each((function(t){return lW(e,t)}))},fW=function(e,t){Vj(e,t),Yj(e,t),fq(e,t),uq(e,t),iq(e,t)},hW=function(e){return _j(e,"NodeChange",(function(t){t.setDisabled(!e.queryCommandState("outdent"))}))},mW=function(e){e.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:hW(e),onAction:Lj(e,"outdent")}),e.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:Lj(e,"indent")})},pW=function(e){mW(e)},gW=function(e,t){return function(){e.execCommand("mceToggleFormat",!1,t)}},vW=function(e){sM.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(function(t,n){e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onSetup:Ej(e,t.name),onAction:gW(e,t.name)})}));for(var t=1;t<=6;t++){var n="h"+t;e.ui.registry.addToggleButton(n,{text:n.toUpperCase(),tooltip:"Heading "+t,onSetup:Ej(e,n),onAction:gW(e,n)})}},bW=function(e){sM.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],(function(t){e.ui.registry.addButton(t.name,{tooltip:t.text,icon:t.icon,onAction:Lj(e,t.action)})}))},yW=function(e){sM.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],(function(t){e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:Lj(e,t.action),onSetup:Ej(e,t.name)})}))},wW=function(e){vW(e),bW(e),yW(e)},SW=function(e){sM.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],(function(t){e.ui.registry.addMenuItem(t.name,{text:t.text,icon:t.icon,shortcut:t.shortcut,onAction:Lj(e,t.action)})})),e.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:gW(e,"code")})},xW=function(e){wW(e),SW(e)},CW=function(e,t){return _j(e,"Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",(function(n){n.setDisabled(e.mode.isReadOnly()||!e.undoManager[t]())}))},TW=function(e){e.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:CW(e,"hasUndo"),onAction:Lj(e,"undo")}),e.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:CW(e,"hasRedo"),onAction:Lj(e,"redo")})},DW=function(e){e.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",disabled:!0,onSetup:CW(e,"hasUndo"),onAction:Lj(e,"undo")}),e.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",disabled:!0,onSetup:CW(e,"hasRedo"),onAction:Lj(e,"redo")})},kW=function(e){TW(e),DW(e)},EW=function(e){return _j(e,"VisualAid",(function(t){t.setActive(e.hasVisual)}))},_W=function(e){e.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:EW(e),onAction:Lj(e,"mceToggleVisualAid")})},AW=function(e){e.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:Lj(e,"mceToggleVisualAid")})},LW=function(e){AW(e),_W(e)},OW=function(e,t){nW(e),xW(e),fW(e,t),kW(e),cA(e),LW(e),pW(e),dW(e)},RW=function(e,t){return{type:"makeshift",x:e,y:t}},IW=function(e,t,n){return RW(e.x+t,e.y+n)},PW=function(e){return"longpress"===e.type||0===e.type.indexOf("touch")},MW=function(e){if(PW(e)){var t=e.touches[0];return RW(t.pageX,t.pageY)}return RW(e.pageX,e.pageY)},NW=function(e){if(PW(e)){var t=e.touches[0];return RW(t.clientX,t.clientY)}return RW(e.clientX,e.clientY)},FW=function(e,t){var n=Sk.DOM.getPos(e);return IW(t,n.x,n.y)},BW=function(e,t){return"contextmenu"===t.type||"longpress"===t.type?e.inline?MW(t):FW(e.getContentAreaContainer(),NW(t)):$W(e)},$W=function(e){return{type:"selection",root:tt.fromDom(e.selection.getNode())}},zW=function(e){return{type:"node",node:N.some(tt.fromDom(e.selection.getNode())),root:tt.fromDom(e.getBody())}},UW=function(e,t,n){switch(n){case"node":return zW(e);case"point":return BW(e,t);case"selection":return $W(e)}},VW=function(e,t,n,r,i,o){var a=n(),s=UW(e,t,o);eF(a,QT.CLOSE_ON_EXECUTE,r,!1).map((function(e){t.preventDefault(),tx.showMenuAt(i,{anchor:s},{menu:{markers:xD("normal")},data:e})}))},HW={onLtr:function(){return[Gc,Uc,Vc,Hc,jc,qc,hx,mx,fx,cx,dx,ux]},onRtl:function(){return[Gc,Vc,Uc,jc,Hc,qc,hx,mx,dx,ux,fx,cx]}},jW=12,qW={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},GW=function(e,t){var n=e.selection;if(n.isCollapsed()||t.touches.length<1)return!1;var r=t.touches[0],i=n.getRng(),o=nm(e.getWin(),Th.domRange(i));return o.exists((function(e){return e.left<=r.clientX&&e.right>=r.clientX&&e.top<=r.clientY&&e.bottom>=r.clientY}))},WW=function(e){var t=e.selection.getRng(),n=function(){Sx.setEditorTimeout(e,(function(){e.selection.setRng(t)}),10),o()};e.once("touchend",n);var r=function(e){e.preventDefault(),e.stopImmediatePropagation()};e.on("mousedown",r,!0);var i=function(){return o()};e.once("longpresscancel",i);var o=function(){e.off("touchend",n),e.off("longpresscancel",i),e.off("mousedown",r)}},KW=function(e,t,n){var r=UW(e,t,n),i="point"===n?jW:0;return A({bubble:Rf(0,i,qW),layouts:HW,overrides:{maxWidthFunction:EH(),maxHeightFunction:Ef()}},r)},YW=function(e,t,n,r,i,o,a){var s=KW(e,t,o);eF(n,QT.CLOSE_ON_EXECUTE,r,!0).map((function(n){t.preventDefault(),tx.showMenuWithinBounds(i,{anchor:s},{menu:{markers:xD("normal"),highlightImmediately:a},data:n,type:"horizontal"},(function(){return N.some(RG(e,r.shared,"node"===o?"node":"selection"))})),e.fire(gG)}))},XW=function(e,t,n,r,i,o){var a=tn(),s=a.os.isiOS(),l=a.os.isOSX(),u=a.os.isAndroid(),c=a.deviceType.isTouch(),d=function(){return!(u||s||l&&c)},f=function(){var a=n();YW(e,t,a,r,i,o,d())};if((l||s)&&"node"!==o){var h=function(){WW(e),f()};GW(e,t)?h():(e.once("selectionchange",h),e.once("touchend",(function(){return e.off("selectionchange",h)})))}else f()},JW=function(e){return"string"===typeof e?e.split(/[ ,]/):e},QW=function(e){return e.getParam("contextmenu_never_use_native",!1,"boolean")},ZW=function(e,t,n){var r=e.ui.registry.getAll().contextMenus;return N.from(e.getParam(t)).map(JW).getOrThunk((function(){return X(JW(n),(function(e){return Ee(r,e)}))}))},eK=function(e){return!1===e.getParam("contextmenu")},tK=function(e){return ZW(e,"contextmenu","link linkchecker image imagetools table spellchecker configurepermanentpen")},nK=function(e){return e.getParam("contextmenu_avoid_overlap","","string")},rK=function(e){return o(e)?"|"===e:"separator"===e.type},iK={type:"separator"},oK=function(e){var t=function(e){return{text:e.text,icon:e.icon,disabled:e.disabled,shortcut:e.shortcut}};if(o(e))return e;switch(e.type){case"separator":return iK;case"submenu":return A(A({type:"nestedmenuitem"},t(e)),{getSubmenuItems:function(){var t=e.getSubmenuItems();return o(t)?t:G(t,oK)}});default:return A(A({type:"menuitem"},t(e)),{onAction:v(e.onAction)})}},aK=function(e,t){if(0===t.length)return e;var n=fe(e).filter((function(e){return!rK(e)})),r=n.fold((function(){return[]}),(function(e){return[iK]}));return e.concat(r).concat(t).concat([iK])},sK=function(e,t,n){var r=Q(t,(function(t,r){return ke(e,r.toLowerCase()).map((function(e){var r=e.update(n);if(o(r))return aK(t,r.split(" "));if(r.length>0){var i=G(r,oK);return aK(t,i)}return t})).getOrThunk((function(){return t.concat([r])}))}),[]);return r.length>0&&rK(r[r.length-1])&&r.pop(),r},lK=function(e,t){return t.ctrlKey&&!QW(e)},uK=function(e,t){return"longpress"!==t.type&&(2!==t.button||t.target===e.getBody()&&""===t.pointerType)},cK=function(e,t){return uK(e,t)?e.selection.getStart(!0):t.target},dK=function(e,t){var n=nK(e),r=uK(e,t)?"selection":"point";if(We(n)){var i=cK(e,t),o=qA(tt.fromDom(i),n);return o?"node":r}return r},fK=function(e,t,n){var r=tn(),i=r.deviceType.isTouch,o=Eu(tx.sketch({dom:{tag:"div"},lazySink:t,onEscape:function(){return e.focus()},onShow:function(){return n.setContextMenuState(!0)},onHide:function(){return n.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:fd([Uw("dismissContextMenu",[Rs(ms(),(function(t,n){bp.close(t),e.focus()}))])])})),a=function(e){return tx.hide(o)},s=function(t){if(QW(e)&&t.preventDefault(),!lK(e,t)&&!eK(e)){var r=dK(e,t),a=function(){var n=cK(e,t),r=e.ui.registry.getAll(),i=tK(e);return sK(r.contextMenus,i,n)},s=i()?XW:VW;s(e,t,a,n,o,r)}};e.on("init",(function(){var t="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(i()?"":" ResizeWindow");e.on(t,a),e.on("longpress contextmenu",s)}))},hK=aa.generate([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),mK=function(e){return function(t){return t.translate(-e.left,-e.top)}},pK=function(e){return function(t){return t.translate(e.left,e.top)}},gK=function(e){return function(t,n){return Q(e,(function(e,t){return t(e)}),cr(t,n))}},vK=function(e,t,n){return e.fold(gK([pK(n),mK(t)]),gK([mK(t)]),gK([]))},bK=function(e,t,n){return e.fold(gK([pK(n)]),gK([]),gK([pK(t)]))},yK=function(e,t,n){return e.fold(gK([]),gK([mK(n)]),gK([pK(t),mK(n)]))},wK=function(e,t,n,r,i,o){var a=bK(e,i,o),s=bK(t,i,o);return Math.abs(a.left-s.left)<=n&&Math.abs(a.top-s.top)<=r},SK=function(e,t,n,r,i,o){var a=bK(e,i,o),s=bK(t,i,o),l=Math.abs(a.left-s.left),u=Math.abs(a.top-s.top);return cr(l,u)},xK=function(e,t,n){var r=e.fold((function(e,t){return{position:N.some("absolute"),left:N.some(e+"px"),top:N.some(t+"px")}}),(function(e,t){return{position:N.some("absolute"),left:N.some(e-n.left+"px"),top:N.some(t-n.top+"px")}}),(function(e,t){return{position:N.some("fixed"),left:N.some(e+"px"),top:N.some(t+"px")}}));return A({right:N.none(),bottom:N.none()},r)},CK=function(e,t,n){return e.fold((function(e,r){return DK(e+t,r+n)}),(function(e,r){return kK(e+t,r+n)}),(function(e,r){return EK(e+t,r+n)}))},TK=function(e,t,n,r){var i=function(e,i){return function(o,a){var s=e(t,n,r);return i(o.getOr(s.left),a.getOr(s.top))}};return e.fold(i(yK,DK),i(bK,kK),i(vK,EK))},DK=hK.offset,kK=hK.absolute,EK=hK.fixed,_K=function(e,t){var n=Vn(e,t);return c(n)?NaN:parseInt(n,10)},AK=function(e,t){var n=e.element,r=_K(n,t.leftAttr),i=_K(n,t.topAttr);return isNaN(r)||isNaN(i)?N.none():N.some(cr(r,i))},LK=function(e,t,n){var r=e.element;zn(r,t.leftAttr,n.left+"px"),zn(r,t.topAttr,n.top+"px")},OK=function(e,t){var n=e.element;qn(n,t.leftAttr),qn(n,t.topAttr)},RK=function(e,t,n,r){return AK(e,t).fold((function(){return n}),(function(e){return EK(e.left+r.left,e.top+r.top)}))},IK=function(e,t,n,r,i,o){var a=RK(e,t,n,r),s=t.mustSnap?NK(e,t,a,i,o):FK(e,t,a,i,o),l=vK(a,i,o);return LK(e,t,l),s.fold((function(){return{coord:EK(l.left,l.top),extra:N.none()}}),(function(e){return{coord:e.output,extra:e.extra}}))},PK=function(e,t){OK(e,t)},MK=function(e,t,n,r){return me(e,(function(e){var i=e.sensor,o=wK(t,i,e.range.left,e.range.top,n,r);return o?N.some({output:TK(e.output,t,n,r),extra:e.extra}):N.none()}))},NK=function(e,t,n,r,i){var o=t.getSnapPoints(e),a=MK(o,n,r,i);return a.orThunk((function(){var e=Q(o,(function(e,t){var o=t.sensor,a=SK(n,o,t.range.left,t.range.top,r,i);return e.deltas.fold((function(){return{deltas:N.some(a),snap:N.some(t)}}),(function(n){var r=(a.left+a.top)/2,i=(n.left+n.top)/2;return r<=i?{deltas:N.some(a),snap:N.some(t)}:e}))}),{deltas:N.none(),snap:N.none()});return e.snap.map((function(e){return{output:TK(e.output,n,r,i),extra:e.extra}}))}))},FK=function(e,t,n,r,i){var o=t.getSnapPoints(e);return MK(o,n,r,i)},BK=function(e,t,n){return{coord:TK(e.output,e.output,t,n),extra:e.extra}},$K=function(e,t,n,r){var i=t.getTarget(e.element);if(t.repositionTarget){var o=hn(e.element),a=Fr(o),s=eU(i),l=BK(r,a,s),u=xK(l.coord,a,s);Xn(i,u)}},zK=Object.freeze({__proto__:null,snapTo:$K}),UK="data-initial-z-index",VK=function(e){vn(e.element).filter(ct).each((function(e){Hn(e,UK).fold((function(){return nr(e,"z-index")}),(function(t){return Kn(e,"z-index",t)})),qn(e,UK)}))},HK=function(e){vn(e.element).filter(ct).each((function(t){Zn(t,"z-index").each((function(e){zn(t,UK,e)})),Kn(t,"z-index",Jn(e.element,"z-index"))}))},jK=function(e,t){e.getSystem().addToGui(t),HK(t)},qK=function(e){VK(e),e.getSystem().removeFromGui(e)},GK=function(e,t,n){return e.getSystem().build(bL.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[t]},events:n}))},WK=Go("snaps",[Ao("getSnapPoints"),sc("onSensor"),Ao("leftAttr"),Ao("topAttr"),Ko("lazyViewport",Zr),Ko("mustSnap",!1)]),KK=[Ko("useFixed",k),Ao("blockerClass"),Ko("getTarget",S),Ko("onDrag",g),Ko("repositionTarget",!0),Ko("onDrop",g),ea("getBounds",Zr),WK],YK=function(e){return Pe(Zn(e,"left"),Zn(e,"top"),Zn(e,"position"),(function(e,t,n){var r="fixed"===n?EK:DK;return r(parseInt(e,10),parseInt(t,10))})).getOrThunk((function(){var t=hr(e);return kK(t.left,t.top)}))},XK=function(e,t,n,r,i){var o=i.bounds,a=bK(t,n,r),s=_c(a.left,o.x,o.x+o.width-i.width),l=_c(a.top,o.y,o.y+o.height-i.height),u=kK(s,l);return t.fold((function(){var e=yK(u,n,r);return DK(e.left,e.top)}),w(u),(function(){var e=vK(u,n,r);return EK(e.left,e.top)}))},JK=function(e,t,n,r,i,o,a){var s=t.fold((function(){var e=CK(n,o.left,o.top),t=vK(e,r,i);return EK(t.left,t.top)}),(function(t){var a=IK(e,t,n,o,r,i);return a.extra.each((function(n){t.onSensor(e,n)})),a.coord}));return XK(e,s,r,i,a)},QK=function(e,t,n,r){var i=t.getTarget(e.element);if(t.repositionTarget){var o=hn(e.element),a=Fr(o),s=eU(i),l=YK(i),u=JK(e,t.snaps,l,a,s,r,n),c=xK(u,a,s);Xn(i,c)}t.onDrag(e,i,r)},ZK=function(e,t){return{bounds:e.getBounds(),height:sr(t.element),width:br(t.element)}},eY=function(e,t,n,r,i){var o=n.update(r,i),a=n.getStartData().getOrThunk((function(){return ZK(t,e)}));o.each((function(n){QK(e,t,a,n)}))},tY=function(e,t,n,r){t.each(qK),n.snaps.each((function(t){PK(e,t)}));var i=n.getTarget(e.element);r.reset(),n.onDrop(e,i)},nY=function(e){return function(t,n){var r=function(e){n.setStartData(ZK(t,e))};return _s(O([Rs(cs(),(function(e){n.getStartData().each((function(){return r(e)}))}))],e(t,n,r),!0))}},rY=function(e){return _s([Rs(Ia(),e.forceDrop),Rs(Na(),e.drop),Rs(Pa(),(function(t,n){e.move(n.event)})),Rs(Ma(),e.delayDrop)])},iY=function(e){return N.from(cr(e.x,e.y))},oY=function(e,t){return cr(t.left-e.left,t.top-e.top)},aY=Object.freeze({__proto__:null,getData:iY,getDelta:oY}),sY=function(e,t,n){return[Rs(Ia(),(function(r,i){var o=i.event.raw;if(0===o.button){i.stop();var a=function(){return tY(r,N.some(u),e,t)},s=GA(a,200),l={drop:a,delayDrop:s.schedule,forceDrop:a,move:function(n){s.cancel(),eY(r,e,t,aY,n)}},u=GK(r,e.blockerClass,rY(l)),c=function(){n(r),jK(r,u)};c()}}))]},lY=O(O([],KK,!0),[dc("dragger",{handlers:nY(sY)})],!1),uY=function(e){return _s([Rs(Aa(),e.forceDrop),Rs(Oa(),e.drop),Rs(Ra(),e.drop),Rs(La(),(function(t,n){e.move(n.event)}))])},cY=function(e){var t=e[0];return N.some(cr(t.clientX,t.clientY))},dY=function(e){var t=e.raw,n=t.touches;return 1===n.length?cY(n):N.none()},fY=function(e,t){return cr(t.left-e.left,t.top-e.top)},hY=Object.freeze({__proto__:null,getData:dY,getDelta:fY}),mY=function(e,t,n){var r=rf(),i=function(n){tY(n,r.get(),e,t),r.clear()};return[Rs(Aa(),(function(o,a){a.stop();var s=function(){return i(o)},l={drop:s,delayDrop:g,forceDrop:s,move:function(n){eY(o,e,t,hY,n)}},u=GK(o,e.blockerClass,uY(l));r.set(u);var c=function(){n(o),jK(o,u)};c()})),Rs(La(),(function(n,r){r.stop(),eY(n,e,t,hY,r.event)})),Rs(Oa(),(function(e,t){t.stop(),i(e)})),Rs(Ra(),i)]},pY=O(O([],KK,!0),[dc("dragger",{handlers:nY(mY)})],!1),gY=function(e,t,n){return O(O([],sY(e,t,n),!0),mY(e,t,n),!0)},vY=O(O([],KK,!0),[dc("dragger",{handlers:nY(gY)})],!1),bY=lY,yY=pY,wY=vY,SY=Object.freeze({__proto__:null,mouse:bY,touch:yY,mouseOrTouch:wY}),xY=function(){var e=N.none(),t=N.none(),n=function(){e=N.none(),t=N.none()},r=function(t,n){var r=e.map((function(e){return t.getDelta(e,n)}));return e=N.some(n),r},i=function(e,t){return e.getData(t).bind((function(t){return r(e,t)}))},o=function(e){t=N.some(e)},a=function(){return t},s=w({});return Dl({readState:s,reset:n,update:i,getStartData:a,setStartData:o})},CY=Object.freeze({__proto__:null,init:xY}),TY=gd({branchKey:"mode",branches:SY,name:"dragging",active:{events:function(e,t){var n=e.dragger;return n.handlers(e,t)}},extra:{snap:function(e){return{sensor:e.sensor,range:e.range,output:e.output,extra:N.from(e.extra)}}},state:CY,apis:zK}),DY=40,kY=DY/2,EY=function(e,t,n,r,i,o){return e.fold((function(){return TY.snap({sensor:kK(n-kY,r-kY),range:cr(i,o),output:kK(N.some(n),N.some(r)),extra:{td:t}})}),(function(e){var i=n-kY,o=r-kY,a=DY,s=DY,l=e.element.dom.getBoundingClientRect();return TY.snap({sensor:kK(i,o),range:cr(a,s),output:kK(N.some(n-l.width/2),N.some(r-l.height/2)),extra:{td:t}})}))},_Y=function(e,t,n){var r=function(e,t){return e.exists((function(e){return un(e,t)}))};return{getSnapPoints:e,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(e,i){var o=i.td;r(t.get(),o)||(t.set(o),n(o))},mustSnap:!0}},AY=function(e){return Ex(Cx.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:fd([TY.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:e}),XO.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))},LY=function(e,t){var n=ia([]),r=ia([]),i=ia(!1),o=rf(),a=rf(),s=function(e){var n=Qr(e);return EY(h.getOpt(t),e,n.x,n.y,n.width,n.height)},l=function(){return G(n.get(),(function(e){return s(e)}))},u=function(e){var n=Qr(e);return EY(m.getOpt(t),e,n.right,n.bottom,n.width,n.height)},c=function(){return G(r.get(),(function(e){return u(e)}))},d=_Y(l,o,(function(t){a.get().each((function(n){e.fire("TableSelectorChange",{start:t,finish:n})}))})),f=_Y(c,a,(function(t){o.get().each((function(n){e.fire("TableSelectorChange",{start:n,finish:t})}))})),h=AY(d),m=AY(f),p=Eu(h.asSpec()),g=Eu(m.asSpec()),v=function(t,n,r,i){var o=n.dom.getBoundingClientRect();nr(t.element,"display");var a=gn(tt.fromDom(e.getBody())).dom.innerHeight,s=r(o),l=i(o,a);(s||l)&&Kn(t.element,"display","none")},b=function(e,t,n,r){var i=n(t);TY.snapTo(e,i);var o=function(e){return e[r]<0},a=function(e,t){return e[r]>t};v(e,t,o,a)},y=function(e){return b(p,e,s,"top")},w=function(){return o.get().each(y)},S=function(e){return b(g,e,u,"bottom")},x=function(){return a.get().each(S)};tn().deviceType.isTouch()&&(e.on("TableSelectionChange",(function(e){i.get()||(jm(t,p),jm(t,g),i.set(!0)),o.set(e.start),a.set(e.finish),e.otherCells.each((function(t){n.set(t.upOrLeftCells),r.set(t.downOrRightCells),y(e.start),S(e.finish)}))})),e.on("ResizeEditor ResizeWindow ScrollContent",(function(){w(),x()})),e.on("TableSelectionClear",(function(){i.get()&&(Wm(p),Wm(g),i.set(!1)),o.clear(),a.clear()})))},OY=function(e){if(1===e.nodeType){if("BR"===e.nodeName||e.getAttribute("data-mce-bogus"))return!0;if("bookmark"===e.getAttribute("data-mce-type"))return!0}return!1},RY=function(e,t,n){t.delimiter||(t.delimiter="»");var r=function(r){var i=r||[],o=G(i,(function(t,r){return Cx.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":r,"tab-index":-1,"aria-level":r+1},innerHtml:t.name},action:function(n){e.focus(),e.selection.select(t.element),e.nodeChanged()},buttonBehaviours:fd([xE.button(n.isDisabled),vE()])})})),a={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+t.delimiter+" "}};return Q(o.slice(1),(function(e,t){var n=e;return n.push(a),n.push(t),n}),[o[0]])},i=function(t){var n=[],r=t.length;while(r-- >0){var i=t[r];if(1===i.nodeType&&!OY(i)){var o=e.fire("ResolveName",{name:i.nodeName.toLowerCase(),target:i});if(o.isDefaultPrevented()||n.push({name:o.name,element:i}),o.isPropagationStopped())break}}return n};return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:fd([Aw.config({mode:"flow",selector:"div[role=button]"}),Fv.config({disabled:n.isDisabled}),vE(),_L.config({}),$w.config({}),Uw("elementPathEvents",[Vs((function(t,n){e.shortcuts.add("alt+F11","focus statusbar elementpath",(function(){return Aw.focusIn(t)})),e.on("NodeChange",(function(e){var n=i(e.parents);n.length>0?$w.set(t,r(n)):$w.set(t,[])}))}))])]),components:[]}};(function(e){e[e["None"]=0]="None",e[e["Both"]=1]="Both",e[e["Vertical"]=2]="Vertical"})(Nj||(Nj={}));var IY=function(e,t,n,r,i){var o={};return o.height=oG(r+t.top,Ak(e),Ok(e)),n===Nj.Both&&(o.width=oG(i+t.left,_k(e),Lk(e))),o},PY=function(e,t,n){var r=tt.fromDom(e.getContainer()),i=IY(e,t,n,ar(r),vr(r));ve(i,(function(e,t){return Kn(r,t,iG(e))})),k_(e)},MY=function(e){var t=!e.hasPlugin("autoresize"),n=e.getParam("resize",t);return!1===n?Nj.None:"both"===n?Nj.Both:Nj.Vertical},NY=function(e,t,n,r){var i=20,o=cr(n*i,r*i);return PY(e,o,t),N.some(!0)},FY=function(e,t){var n=MY(e);return n===Nj.None?N.none():N.some(qC("resize-handle",{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:t.translate("Resize")},behaviours:[TY.config({mode:"mouse",repositionTarget:!1,onDrag:function(t,r,i){return PY(e,i,n)},blockerClass:"tox-blocker"}),Aw.config({mode:"special",onLeft:function(){return NY(e,n,-1,0)},onRight:function(){return NY(e,n,1,0)},onUp:function(){return NY(e,n,0,-1)},onDown:function(){return NY(e,n,0,1)}}),_L.config({}),Xw.config({})]},t.icons))},BY=function(e,t){var n,r=function(e,n,r){return $w.set(e,[Cu(t.translate(["{0} "+r,n[r]]))])};return Cx.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:fd([xE.button(t.isDisabled),vE(),_L.config({}),$w.config({}),eg.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),Uw("wordcount-events",[qs((function(e){var t=eg.getValue(e),n="words"===t.mode?"characters":"words";eg.setValue(e,{mode:n,count:t.count}),r(e,t.count,n)})),Vs((function(t){e.on("wordCountUpdate",(function(e){var n=eg.getValue(t).mode;eg.setValue(t,{mode:n,count:e.wordCount}),r(t,e.wordCount,n)}))}))])]),eventOrder:(n={},n[ts()]=["disabling","alloy.base.behaviour","wordcount-events"],n)})},$Y=function(e,t){var n=function(){var e=PC.translate(["Powered by {0}","Tiny"]),t='<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+e+'">'+e+"</a>";return{dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:t}}},r=function(){var r=[];return e.getParam("elementpath",!0,"boolean")&&r.push(RY(e,{},t)),e.hasPlugin("wordcount")&&r.push(BY(e,t)),e.getParam("branding",!0,"boolean")&&r.push(n()),r.length>0?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:r}]:[]},i=function(){var n=r(),i=FY(e,t);return n.concat(i.toArray())};return{dom:{tag:"div",classes:["tox-statusbar"]},components:i()}},zY=function(e){var t,n=e.inline,r=n?mG:nG,i=eE(e)?WU:Qz,o=N.none(),a=tn(),s=a.browser.isIE(),l=s?["tox-platform-ie"]:[],u=a.deviceType.isTouch(),c="tox-platform-touch",d=u?[c]:[],f=Gk(e),h=Qk(e),m=PC.isRtl()?{attributes:{dir:"rtl"}}:{},p={attributes:(t={},t[Ff]=f?Bd.BottomToTop:Bd.TopToBottom,t)},v=function(){return o.bind(hj.getHeader)},b=function(){return i.isDocked(v)},y=function(){Kn(Q.element,"width",document.body.clientWidth+"px")},w=function(){var e=un(Fn(),h)&&"grid"===Jn(h,"display"),t={dom:A({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(l).concat(d)},m),behaviours:fd([Bm.config({useFixed:function(){return b()}})])},n={dom:{styles:{width:document.body.clientWidth+"px"}},events:_s([Rs(ds(),y)])};return Si(t,e?n:{})},S=Eu(w()),x=function(){return ri.value(S)},C=Ex({dom:{tag:"div",classes:["tox-anchorbar"]}}),T=function(){return o.bind((function(e){return C.getOpt(e)})).getOrDie("Could not find a anchor bar element")},D=function(){return o.bind((function(e){return hj.getToolbar(e)})).getOrDie("Could not find more toolbar element")},k=function(){return o.bind((function(e){return hj.getThrobber(e)})).getOrDie("Could not find throbber element")},E=Iz(S,e,T),_=hj.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:E,onEscape:function(){e.focus()}}),L=Vk(e),O=hj.parts.toolbar(A({dom:{tag:"div",classes:["tox-toolbar"]},getSink:x,providers:E.shared.providers,onEscape:function(){e.focus()},type:L,lazyToolbar:D,lazyHeader:function(){return v().getOrDie("Could not find header element")}},p)),R=hj.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:E.shared.providers,onEscape:function(){e.focus()},type:L}),I=hj.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),P=hj.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),M=hj.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:E}),F=e.getParam("statusbar",!0,"boolean"),B=F&&!n?N.some($Y(e,E.shared.providers)):N.none(),$={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[I,P]},z=zk(e),U=Bk(e),V=Fk(e),H=function(){return z?[R]:U?[O]:[]},j=hj.parts.header({dom:A({tag:"div",classes:["tox-editor-header"]},p),components:ne([V?[_]:[],H(),Jk(e)?[]:[C.asSpec()]]),sticky:eE(e),editor:e,sharedBackstage:E.shared}),q=ne([f?[]:[j],n?[]:[$],f?[j]:[]]),G={dom:{tag:"div",classes:["tox-editor-container"]},components:q},W=ne([[G],n?[]:B.toArray(),[M]]),K=Zk(e),Y=A(A({role:"application"},PC.isRtl()?{dir:"rtl"}:{}),K?{"aria-hidden":"true"}:{}),X=Eu(hj.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(n?["tox-tinymce-inline"]:[]).concat(f?["tox-tinymce--toolbar-bottom"]:[]).concat(d).concat(l),styles:A({visibility:"hidden"},K?{opacity:"0",border:"0"}:{}),attributes:Y},components:W,behaviours:fd([vE(),Fv.config({disableClass:"tox-tinymce--disabled"}),Aw.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle"})])}));o=N.some(X),e.shortcuts.add("alt+F9","focus menubar",(function(){hj.focusMenubar(X)})),e.shortcuts.add("alt+F10","focus toolbar",(function(){hj.focusToolbar(X)})),e.addCommand("ToggleToolbarDrawer",(function(){hj.toggleToolbarDrawer(X)})),e.addQueryStateHandler("ToggleToolbarDrawer",(function(){return hj.isToolbarDrawerToggled(X)}));var J=yL(X),Q=yL(S);Pz(e,J,Q);var Z=function(){var e={broadcastAll:Q.broadcast,broadcastOn:Q.broadcastOn,register:g};return{channels:e}},ee=function(){var t=iG(sG(e)),n=iG(uG(e));return e.inline||(tr("div","width",n)&&Kn(X.element,"width",n),tr("div","height",t)?Kn(X.element,"height",t):Kn(X.element,"height","200px")),t},te=function(){i.setup(e,E.shared,v),OW(e,E),fK(e,x,E),UV(e),dH(e,k,E.shared),be(jk(e),(function(t,n){e.ui.registry.addGroupToolbarButton(n,t)}));var t=e.ui.registry.getAll(),n=t.buttons,o=t.menuItems,a=t.contextToolbars,s=t.sidebars,l=$k(e),u={menuItems:o,menus:rE(e),menubar:iE(e),toolbar:l.getOrThunk((function(){return oE(e)})),allowToolbarGroups:L===JT.floating,buttons:n,sidebar:s};tW(e,a,S,{backstage:E}),LY(e,S);var c=e.getElement(),d=ee(),f={mothership:J,uiMothership:Q,outerContainer:X},h={targetNode:c,height:d};return r.render(e,f,u,E,h)};return{mothership:J,uiMothership:Q,backstage:E,renderUI:te,getUi:Z}},UY=function(e,t){var n=N.from(Vn(e,"id")).fold((function(){var e=il("dialog-describe");return zn(t,"id",e),e}),S);zn(e,"aria-describedby",n)},VY=function(e,t){var n=Hn(e,"id").fold((function(){var e=il("dialog-label");return zn(t,"id",e),e}),S);zn(e,"aria-labelledby",n)},HY=w([Ao("lazySink"),zo("dragBlockClass"),ea("getBounds",Zr),Ko("useTabstopAt",E),Ko("eventOrder",{}),tg("modalBehaviours",[Aw]),lc("onExecute"),cc("onEscape")]),jY={sketch:S},qY=w([Mg({name:"draghandle",overrides:function(e,t){return{behaviours:fd([TY.config({mode:"mouse",getTarget:function(e){return Nu(e,'[role="dialog"]').getOr(e)},blockerClass:e.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(t,null,2)).message),getBounds:e.getDragBounds})])}}}),Ig({schema:[Ao("dom")],name:"title"}),Ig({factory:jY,schema:[Ao("dom")],name:"close"}),Ig({factory:jY,schema:[Ao("dom")],name:"body"}),Mg({factory:jY,schema:[Ao("dom")],name:"footer"}),Pg({factory:{sketch:function(e,t){return A(A({},e),{dom:t.dom,components:t.components})}},schema:[Ko("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),Ko("components",[])],name:"blocker"})]),GY=function(e,t,n,r){var i,o=rf(),a=function(t){o.set(t);var n=e.lazySink(t).getOrDie(),i=r.blocker(),a=n.getSystem().build(A(A({},i),{components:i.components.concat([_u(t)]),behaviours:fd([Xw.config({}),Uw("dialog-blocker-events",[Us(Ba(),(function(){Aw.focusIn(t)}))])])}));jm(n,a),Aw.focusIn(t)},s=function(e){o.clear(),vn(e.element).each((function(t){e.getSystem().getByDom(t).each((function(e){Wm(e)}))}))},l=function(t){return Yg(t,e,"body")},u=function(t){return Yg(t,e,"footer")},c=function(e,t){rH.block(e,t)},d=function(e){rH.unblock(e)},f=il("modal-events"),h=A(A({},e.eventOrder),(i={},i[fs()]=[f].concat(e.eventOrder["alloy.system.attached"]||[]),i));return{uid:e.uid,dom:e.dom,components:t,apis:{show:a,hide:s,getBody:l,getFooter:u,setIdle:d,setBusy:c},eventOrder:h,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:rg(e.modalBehaviours,[$w.config({}),Aw.config({mode:"cyclic",onEnter:e.onExecute,onEscape:e.onEscape,useTabstopAt:e.useTabstopAt}),rH.config({getRoot:o.get}),Uw(f,[Vs((function(t){VY(t.element,Yg(t,e,"title").element),UY(t.element,Yg(t,e,"body").element)}))])])}},WY=hv({name:"ModalDialog",configFields:HY(),partFields:qY(),factory:GY,apis:{show:function(e,t){e.show(t)},hide:function(e,t){e.hide(t)},getBody:function(e,t){return e.getBody(t)},getFooter:function(e,t){return e.getFooter(t)},setBusy:function(e,t,n){e.setBusy(t,n)},setIdle:function(e,t){e.setIdle(t)}}}),KY=Zi([Ro("type"),Ro("name")].concat(VD)),YY=uo,XY=[ko("name","name",Ti((function(){return il("button-name")})),lo),Ho("icon"),Qo("align","end",["start","end"]),Zo("primary",!1),Zo("disabled",!1)],JY=O(O([],XY,!0),[Ro("text")],!1),QY=O([Io("type",["submit","cancel","custom"])],JY,!0),ZY=O([Io("type",["menu"]),Ho("text"),Ho("tooltip"),Ho("icon"),$o("items",KY)],XY,!0),eX=To("type",{submit:QY,cancel:QY,custom:QY,menu:ZY}),tX=[Ro("type"),Ro("text"),Io("level",["info","warn","error","success"]),Ro("icon"),Ko("url","")],nX=Zi(tX),rX=function(e){return[Ro("type"),e]},iX=[Ro("type"),Ro("text"),Zo("disabled",!1),Zo("primary",!1),ko("name","name",Ti((function(){return il("button-name")})),lo),Ho("icon"),Zo("borderless",!1)],oX=Zi(iX),aX=[Ro("type"),Ro("name"),Ro("label"),Zo("disabled",!1)],sX=Zi(aX),lX=uo,uX=[Ro("type"),Ro("name")],cX=uX.concat([Ho("label")]),dX=cX.concat([Ko("columns","auto")]),fX=Zi(dX),hX=io([Ro("value"),Ro("text"),Ro("icon")]),mX=cX,pX=Zi(mX),gX=lo,vX=cX,bX=Zi(vX),yX=lo,wX=uX.concat([Jo("tag","textarea"),Ro("scriptId"),Ro("scriptUrl"),ta("settings",void 0)]),SX=uX.concat([Jo("tag","textarea"),Mo("init")]),xX=vo((function(e){return wo("customeditor.old",Qi(SX),e).orThunk((function(){return wo("customeditor.new",Qi(wX),e)}))})),CX=lo,TX=cX,DX=Zi(TX),kX=go(),EX=function(e){return[Ro("type"),Oo("columns"),e]},_X=[Ro("type"),Ro("html"),Qo("presets","presentation",["presentation","document"])],AX=Zi(_X),LX=cX.concat([Zo("sandboxed",!0)]),OX=Zi(LX),RX=lo,IX=cX.concat([Lo("currentState",Zi([Ao("blob"),Ro("url")]))]),PX=Zi(IX),MX=cX.concat([Ho("inputMode"),Ho("placeholder"),Zo("maximized",!1),Zo("disabled",!1)]),NX=Zi(MX),FX=lo,BX=function(e){return[Ro("type"),Ro("label"),e]},$X=[Ro("text"),Ro("value")],zX=[Ro("text"),$o("items",Do("items",(function(){return UX})))],UX=to([Zi($X),Zi(zX)]),VX=cX.concat([$o("items",UX),Zo("disabled",!1)]),HX=Zi(VX),jX=lo,qX=cX.concat([Bo("items",[Ro("text"),Ro("value")]),Xo("size",1),Zo("disabled",!1)]),GX=Zi(qX),WX=lo,KX=cX.concat([Zo("constrain",!0),Zo("disabled",!1)]),YX=Zi(KX),XX=Zi([Ro("width"),Ro("height")]),JX=[Ro("type"),$o("header",lo),$o("cells",eo(lo))],QX=Zi(JX),ZX=cX.concat([Ho("placeholder"),Zo("maximized",!1),Zo("disabled",!1)]),eJ=Zi(ZX),tJ=lo,nJ=cX.concat([Qo("filetype","file",["image","media","file"]),Ko("disabled",!1)]),rJ=Zi(nJ),iJ=Zi([Ro("value"),Ko("meta",{})]),oJ=function(e){return ko("items","items",Ci(),eo(vo((function(t){return wo("Checking item of "+e,aJ,t).fold((function(e){return ri.error(Co(e))}),(function(e){return ri.value(e)}))}))))},aJ=Xi((function(){return po("type",{alertbanner:nX,bar:Zi(rX(oJ("bar"))),button:oX,checkbox:sX,colorinput:pX,colorpicker:bX,dropzone:DX,grid:Zi(EX(oJ("grid"))),iframe:OX,input:NX,listbox:HX,selectbox:GX,sizeinput:YX,textarea:eJ,urlinput:rJ,customeditor:xX,htmlpanel:AX,imagetools:PX,collection:fX,label:Zi(BX(oJ("label"))),table:QX,panel:lJ})})),sJ=[Ro("type"),Ko("classes",[]),$o("items",aJ)],lJ=Zi(sJ),uJ=[ko("name","name",Ti((function(){return il("tab-name")})),lo),Ro("title"),$o("items",aJ)],cJ=[Ro("type"),Bo("tabs",uJ)],dJ=Zi(cJ),fJ=JY,hJ=eX,mJ=Zi([Ro("title"),Lo("body",po("type",{panel:lJ,tabpanel:dJ})),Jo("size","normal"),$o("buttons",hJ),Ko("initialData",{}),ea("onAction",g),ea("onChange",g),ea("onSubmit",g),ea("onClose",g),ea("onCancel",g),Ko("onTabChange",g)]),pJ=function(e){return wo("dialog",mJ,e)},gJ=Zi(O([Io("type",["cancel","custom"])],fJ,!0)),vJ=Zi([Ro("title"),Ro("url"),Vo("height"),Vo("width"),qo("buttons",gJ),ea("onAction",g),ea("onCancel",g),ea("onClose",g),ea("onMessage",g)]),bJ=function(e){return wo("dialog",vJ,e)},yJ=function(e){return a(e)?[e].concat(re(De(e),yJ)):s(e)?re(e,yJ):[]},wJ=function(e){return o(e.type)&&o(e.name)},SJ={checkbox:lX,colorinput:gX,colorpicker:yX,dropzone:kX,input:FX,iframe:RX,sizeinput:XX,selectbox:WX,listbox:jX,size:XX,textarea:tJ,urlinput:iJ,customeditor:CX,collection:hX,togglemenuitem:YY},xJ=function(e){return N.from(SJ[e.type])},CJ=function(e){return X(yJ(e),wJ)},TJ=function(e){var t=CJ(e),n=re(t,(function(e){return xJ(e).fold((function(){return[]}),(function(t){return[Lo(e.name,t)]}))}));return Zi(n)},DJ=function(e){var t=So(pJ(e)),n=TJ(e),r=e.initialData;return{internalDialog:t,dataValidator:n,initialData:r}},kJ={open:function(e,t){var n=DJ(t);return e(n.internalDialog,n.initialData,n.dataValidator)},openUrl:function(e,t){var n=So(bJ(t));return e(n)},redial:function(e){return DJ(e)}},EJ=function(e){var t=[],n={};return ve(e,(function(e,r){e.fold((function(){t.push(r)}),(function(e){n[r]=e}))})),t.length>0?ri.error(t):ri.value(n)},_J=function(e,t){var n=Ex(VP.sketch((function(n){return{dom:{tag:"div",classes:["tox-form"].concat(e.classes)},components:G(e.items,(function(e){return g$(n,e,t)}))}})));return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[n.asSpec()]}],behaviours:fd([Aw.config({mode:"acyclic",useTabstopAt:T(kM)}),ZP.memento(n),pM.memento(n,{postprocess:function(e){return EJ(e).fold((function(e){return console.error(e),{}}),S)}})])}},AJ=function(e,t){return{uid:e.uid,dom:e.dom,components:e.components,events:vS(e.action),behaviours:rg(e.tabButtonBehaviours,[Xw.config({}),Aw.config({mode:"execution",useSpace:!0,useEnter:!0}),eg.config({store:{mode:"memory",initialValue:e.value}})]),domModification:e.domModification}},LJ=fv({name:"TabButton",configFields:[Ko("uid",void 0),Ao("value"),ko("dom","dom",Ei((function(){return{attributes:{role:"tab",id:il("aria"),"aria-selected":"false"}}})),oo()),zo("action"),Ko("domModification",{}),tg("tabButtonBehaviours",[Xw,Aw,eg]),Ao("view")],factory:AJ}),OJ=w([Ao("tabs"),Ao("dom"),Ko("clickToDismiss",!1),tg("tabbarBehaviours",[rb,Aw]),oc(["tabClass","selectedClass"])]),RJ=Ng({factory:LJ,name:"tabs",unit:"tab",overrides:function(e){var t=function(e,t){rb.dehighlight(e,t),Cs(e,ys(),{tabbar:e,button:t})},n=function(e,t){rb.highlight(e,t),Cs(e,bs(),{tabbar:e,button:t})};return{action:function(r){var i=r.getSystem().getByUid(e.uid).getOrDie(),o=rb.isHighlighted(i,r),a=function(){return o&&e.clickToDismiss?t:o?g:n}();a(i,r)},domModification:{classes:[e.markers.tabClass]}}}}),IJ=w([RJ]),PJ=function(e,t,n,r){return{uid:e.uid,dom:e.dom,components:t,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:rg(e.tabbarBehaviours,[rb.config({highlightClass:e.markers.selectedClass,itemClass:e.markers.tabClass,onHighlight:function(e,t){zn(t.element,"aria-selected","true")},onDehighlight:function(e,t){zn(t.element,"aria-selected","false")}}),Aw.config({mode:"flow",getInitial:function(e){return rb.getHighlighted(e).map((function(e){return e.element}))},selector:"."+e.markers.tabClass,executeOnMove:!0})])}},MJ=hv({name:"Tabbar",configFields:OJ(),partFields:IJ(),factory:PJ}),NJ=function(e,t){return{uid:e.uid,dom:e.dom,behaviours:rg(e.tabviewBehaviours,[$w.config({})]),domModification:{attributes:{role:"tabpanel"}}}},FJ=fv({name:"Tabview",configFields:[tg("tabviewBehaviours",[$w])],factory:NJ}),BJ=w([Ko("selectFirst",!0),sc("onChangeTab"),sc("onDismissTab"),Ko("tabs",[]),tg("tabSectionBehaviours",[])]),$J=Ig({factory:MJ,schema:[Ao("dom"),Fo("markers",[Ao("tabClass"),Ao("selectedClass")])],name:"tabbar",defaults:function(e){return{tabs:e.tabs}}}),zJ=Ig({factory:FJ,name:"tabview"}),UJ=w([$J,zJ]),VJ=function(e,t,n,r){var i=function(t){var n=eg.getValue(t);Kg(t,e,"tabview").each((function(r){var i=ee(e.tabs,(function(e){return e.value===n}));i.each((function(n){var i=n.view();Hn(t.element,"id").each((function(e){zn(r.element,"aria-labelledby",e)})),$w.set(r,i),e.onChangeTab(r,t,i)}))}))},o=function(t,n){Kg(t,e,"tabbar").each((function(e){n(e).each(Ts)}))};return{uid:e.uid,dom:e.dom,components:t,behaviours:ng(e.tabSectionBehaviours),events:_s(ne([e.selectFirst?[Vs((function(e,t){o(e,rb.getFirst)}))]:[],[Rs(bs(),(function(e,t){var n=t.event.button;i(n)})),Rs(ys(),(function(t,n){var r=n.event.button;e.onDismissTab(t,r)}))]])),apis:{getViewItems:function(t){return Kg(t,e,"tabview").map((function(e){return $w.contents(e)})).getOr([])},showTab:function(e,t){var n=function(e){var n=rb.getCandidates(e),r=ee(n,(function(e){return eg.getValue(e)===t}));return r.filter((function(t){return!rb.isHighlighted(e,t)}))};o(e,n)}}}},HJ=hv({name:"TabSection",configFields:BJ(),partFields:UJ(),factory:VJ,apis:{getViewItems:function(e,t){return e.getViewItems(t)},showTab:function(e,t,n){e.showTab(t,n)}}}),jJ=function(e,t,n){return G(e,(function(r,i){$w.set(n,e[i].view());var o=t.dom.getBoundingClientRect();return $w.set(n,[]),o.height}))},qJ=function(e){return de(ue(e,(function(e,t){return e>t?-1:e<t?1:0})))},GJ=function(e,t,n){var r,i=pn(e).dom,o=Nu(e,".tox-dialog-wrap").getOr(e),a="fixed"===Jn(o,"position");r=a?Math.max(i.clientHeight,window.innerHeight):Math.max(i.offsetHeight,i.scrollHeight);var s=ar(t),l=t.dom.offsetLeft>=n.dom.offsetLeft+vr(n),u=l?Math.max(ar(n),s):s,c=parseInt(Jn(e,"margin-top"),10)||0,d=parseInt(Jn(e,"margin-bottom"),10)||0,f=ar(e)+c+d,h=f-u;return r-h},WJ=function(e,t){de(e).each((function(e){return HJ.showTab(t,e.value)}))},KJ=function(e,t){Kn(e,"height",t+"px"),tn().browser.isIE()?nr(e,"flex-basis"):Kn(e,"flex-basis",t+"px")},YJ=function(e,t,n){Nu(e,'[role="dialog"]').each((function(e){Bu(e,'[role="tablist"]').each((function(r){n.get().map((function(n){return Kn(t,"height","0"),Kn(t,"flex-basis","0"),Math.min(n,GJ(e,t,r))})).each((function(e){KJ(t,e)}))}))}))},XJ=function(e){return Bu(e,'[role="tabpanel"]')},JJ=function(e){var t=function(){var t=rf(),n=[Vs((function(n){var r=n.element;XJ(r).each((function(i){Kn(i,"visibility","hidden"),n.getSystem().getByDom(i).toOptional().each((function(n){var r=jJ(e,i,n),o=qJ(r);o.fold(t.clear,t.set)})),YJ(r,i,t),nr(i,"visibility"),WJ(e,n),Sx.requestAnimationFrame((function(){YJ(r,i,t)}))}))})),Rs(ds(),(function(e){var n=e.element;XJ(n).each((function(e){YJ(n,e,t)}))})),Rs(jL,(function(e,n){var r=e.element;XJ(r).each((function(e){var n=Dd(An(e));Kn(e,"visibility","hidden");var i=Zn(e,"height").map((function(e){return parseInt(e,10)}));nr(e,"height"),nr(e,"flex-basis");var o=e.dom.getBoundingClientRect().height,a=i.forall((function(e){return o>e}));a?(t.set(o),YJ(r,e,t)):i.each((function(t){KJ(e,t)})),nr(e,"visibility"),n.each(xd)}))}))],r=!1;return{extraEvents:n,selectFirst:r}}(),n=function(){var e=[],t=!0;return{extraEvents:e,selectFirst:t}}();return{smartTabHeight:t,naiveTabHeight:n}},QJ="send-data-to-section",ZJ="send-data-to-view",eQ=function(e,t){var n=ia({}),r=function(e){var t=eg.getValue(e),r=EJ(t).getOr({}),i=n.get(),o=Si(i,r);n.set(o)},i=function(e){var t=n.get();eg.setValue(e,t)},o=ia(null),a=G(e.tabs,(function(e){return{value:e.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:t.shared.providers.translate(e.title)},view:function(){return[VP.sketch((function(n){return{dom:{tag:"div",classes:["tox-form"]},components:G(e.items,(function(e){return g$(n,e,t)})),formBehaviours:fd([Aw.config({mode:"acyclic",useTabstopAt:T(kM)}),Uw("TabView.form.events",[Vs(i),Hs(r)]),bd.config({channels:ma([{key:QJ,value:{onReceive:r}},{key:ZJ,value:{onReceive:i}}])})])}}))]}}})),s=JJ(a).smartTabHeight;return HJ.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(e,t,n){var r=eg.getValue(t);Cs(e,HL,{name:r,oldName:o.get()}),o.set(r)},tabs:a,components:[HJ.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[MJ.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:fd([_L.config({})])}),HJ.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:s.selectFirst,tabSectionBehaviours:fd([Uw("tabpanel",s.extraEvents),Aw.config({mode:"acyclic"}),bv.config({find:function(e){return de(HJ.getViewItems(e))}}),eg.config({store:{mode:"manual",getValue:function(e){return e.getSystem().broadcastOn([QJ],{}),n.get()},setValue:function(e,t){n.set(t),e.getSystem().broadcastOn([ZJ],{})}}})])})},tQ=il("update-dialog"),nQ=il("update-title"),rQ=il("update-body"),iQ=il("update-footer"),oQ=il("body-send-message"),aQ=function(e,t,n,r){var i=function(e){switch(e.body.type){case"tabpanel":return[eQ(e.body,n)];default:return[_J(e.body,n)]}},o=function(e,t){return N.some({isTabPanel:function(){return"tabpanel"===t.body.type}})},a={"aria-live":"polite"};return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:A(A({},t.map((function(e){return{id:e}})).getOr({})),r?a:{})},components:[],behaviours:fd([ZP.childAt(0),wq.config({channel:rQ,updateState:o,renderComponents:i,initialData:e})])}},sQ=function(e,t,n,r){return aQ(e,N.some(t),n,r)},lQ=function(e,t){var n=aQ(e,N.none(),t,!1);return WY.parts.body(n)},uQ=function(e){var t={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[CM({dom:{tag:"iframe",attributes:{src:e.url}},behaviours:fd([_L.config({}),Xw.config({})])})]}],behaviours:fd([Aw.config({mode:"acyclic",useTabstopAt:T(kM)})])};return WY.parts.body(t)},cQ=OE.deviceType.isTouch(),dQ=function(e,t){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[e,t]}},fQ=function(e,t){return WY.parts.close(Cx.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close")}},action:e,buttonBehaviours:fd([_L.config({})])}))},hQ=function(){return WY.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},mQ=function(e,t){return WY.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:kx("<p>"+IC(t.translate(e))+"</p>")}]}]})},pQ=function(e){return WY.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:e})},gQ=function(e,t){return[bL.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:e}),bL.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:t})]},vQ=function(e){var t,n="tox-dialog",r=n+"-wrap",i=r+"__backdrop",o=n+"__disable-scroll";return WY.sketch({lazySink:e.lazySink,onEscape:function(t){return e.onEscape(t),N.some(!0)},useTabstopAt:function(e){return!kM(e)},dom:{tag:"div",classes:[n].concat(e.extraClasses),styles:A({position:"relative"},e.extraStyles)},components:O([e.header,e.body],e.footer.toArray(),!0),parts:{blocker:{dom:kx('<div class="'+r+'"></div>'),components:[{dom:{tag:"div",classes:cQ?[i,i+"--opaque"]:[i]}}]}},dragBlockClass:r,modalBehaviours:fd(O([Xw.config({}),Uw("dialog-events",e.dialogEvents.concat([Us(Ba(),(function(e,t){Aw.focusIn(e)}))])),Uw("scroll-lock",[Vs((function(){ou(Fn(),o)})),Hs((function(){su(Fn(),o)}))])],e.extraBehaviours,!0)),eventOrder:A((t={},t[ts()]=["dialog-events"],t[fs()]=["scroll-lock","dialog-events","alloy.base.behaviour"],t[hs()]=["alloy.base.behaviour","dialog-events","scroll-lock"],t),e.eventOrder)})},bQ=function(e){return Cx.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":e.translate("Close"),title:e.translate("Close")}},components:[qC("close",{tag:"div",classes:["tox-icon"]},e.icons)],action:function(e){xs(e,BL)}})},yQ=function(e,t,n){var r=function(e){return[Cu(n.translate(e.title))]};return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:A({},t.map((function(e){return{id:e}})).getOr({}))},components:r(e),behaviours:fd([wq.config({channel:nQ,renderComponents:r})])}},wQ=function(){return{dom:kx('<div class="tox-dialog__draghandle"></div>')}},SQ=function(e,t,n){return bL.sketch({dom:kx('<div class="tox-dialog__header"></div>'),components:[yQ(e,N.some(t),n),wQ(),bQ(n)],containerBehaviours:fd([TY.config({mode:"mouse",blockerClass:"blocker",getTarget:function(e){return $u(e,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])})},xQ=function(e,t){var n=WY.parts.title(yQ(e,N.none(),t)),r=WY.parts.draghandle(wQ()),i=WY.parts.close(bQ(t)),o=[n].concat(e.draggable?[r]:[]).concat([i]);return bL.sketch({dom:kx('<div class="tox-dialog__header"></div>'),components:o})},CQ=function(e,t){return xQ({title:t.shared.providers.translate(e),draggable:t.dialog.isDraggableModal()},t.shared.providers)},TQ=function(e,t,n){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":n.translate(e)},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:t,components:[{dom:kx('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}},DQ=function(e,t,n){return{onClose:function(){return n.closeWindow()},onBlock:function(n){WY.setBusy(e(),(function(e,r){return TQ(n.message,r,t)}))},onUnblock:function(){WY.setIdle(e())}}},kQ=function(e,t,n,r){var i,o=function(e,t){return N.some(t)};return Eu(vQ(A(A({},e),{lazySink:r.shared.getSink,extraBehaviours:O([wq.config({channel:tQ,updateState:o,initialData:t}),pM.memory({})],e.extraBehaviours,!0),onEscape:function(e){xs(e,BL)},dialogEvents:n,eventOrder:(i={},i[es()]=[wq.name(),bd.name()],i[fs()]=["scroll-lock",wq.name(),"messages","dialog-events","alloy.base.behaviour"],i[hs()]=["alloy.base.behaviour","dialog-events","messages",wq.name(),"scroll-lock"],i)})))},EQ=function(e){var t=function(e){var t=G(e.items,(function(e){var t=ia(!1);return A(A({},e),{storage:t})}));return A(A({},e),{items:t})};return G(e,(function(e){return"menu"===e.type?t(e):e}))},_Q=function(e){return Q(e,(function(e,t){if("menu"===t.type){var n=t;return Q(n.items,(function(e,t){return e[t.name]=t.storage,e}),e)}return e}),{})},AQ=function(e,t){return[Bs(Ba(),DM),e(FL,(function(e,n){t.onClose(),n.onClose()})),e(BL,(function(e,t,n,r){t.onCancel(e),xs(r,FL)})),Rs(VL,(function(e,n){return t.onUnblock()})),Rs(UL,(function(e,n){return t.onBlock(n.event)}))]},LQ=function(e,t){var n=function(t,n){return Rs(t,(function(t,i){r(t,(function(r,o){n(e(),r,i.event,t)}))}))},r=function(e,t){wq.getState(e).get().each((function(n){t(n,e)}))};return O(O([],AQ(n,t),!0),[n($L,(function(e,t,n){t.onAction(e,{name:n.name})}))],!1)},OQ=function(e,t,n){var r=function(t,n){return Rs(t,(function(t,r){i(t,(function(i,o){n(e(),i,r.event,t)}))}))},i=function(e,t){wq.getState(e).get().each((function(n){t(n.internalDialog,e)}))};return O(O([],AQ(r,t),!0),[r(zL,(function(e,t){return t.onSubmit(e)})),r(NL,(function(e,t,n){t.onChange(e,{name:n.name})})),r($L,(function(e,t,r,i){var o=function(){return Aw.focusIn(i)},a=function(e){return jn(e,"disabled")||Hn(e,"aria-disabled").exists((function(e){return"true"===e}))},s=An(i.element),l=Dd(s);t.onAction(e,{name:r.name,value:r.value}),Dd(s).fold(o,(function(e){a(e)||l.exists((function(t){return fn(e,t)&&a(t)}))?o():n().toOptional().filter((function(t){return!fn(t.element,e)})).each(o)}))})),r(HL,(function(e,t,n){t.onTabChange(e,{newTabName:n.name,oldTabName:n.oldName})})),Hs((function(t){var n=e();eg.setValue(t,n.getData())}))],!1)},RQ={initUrlDialog:LQ,initDialog:OQ},IQ=function(e,t){return fF(e,e.type,t)},PQ=function(e,t,n){return ee(t,(function(e){return e.name===n})).bind((function(t){return t.memento.getOpt(e)}))},MQ=function(e,t){var n=t.map((function(e){return e.footerButtons})).getOr([]),r=Y(n,(function(e){return"start"===e.align})),i=function(e,t){return bL.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+e]},components:G(t,(function(e){return e.memento.asSpec()}))})},o=i("start",r.pass),a=i("end",r.fail);return[o,a]},NQ=function(e,t){var n=function(e,n){var r=G(n.buttons,(function(e){var n=Ex(IQ(e,t));return{name:e.name,align:e.align,memento:n}})),i=function(e,t){return PQ(e,r,t)};return N.some({lookupByName:i,footerButtons:r})};return{dom:kx('<div class="tox-dialog__footer"></div>'),components:[],behaviours:fd([wq.config({channel:iQ,initialData:e,updateState:n,renderComponents:MQ})])}},FQ=function(e,t){return NQ(e,t)},BQ=function(e,t){return WY.parts.footer(NQ(e,t))},$Q=function(e,t){var n=e.getRoot();if(n.getSystem().isConnected()){var r=bv.getCurrent(e.getFormWrapper()).getOr(e.getFormWrapper());return VP.getField(r,t).fold((function(){var n=e.getFooter(),i=wq.getState(n);return i.get().bind((function(e){return e.lookupByName(r,t)}))}),(function(e){return N.some(e)}))}return N.none()},zQ=function(e,t){var n=e.getRoot();return wq.getState(n).get().map((function(e){return So(wo("data",e.dataValidator,t))})).getOr(t)},UQ=function(e,t,n){var r=function(t){var n=e.getRoot();n.getSystem().isConnected()&&t(n)},i=function(){var t=e.getRoot(),r=t.getSystem().isConnected()?e.getFormWrapper():t,i=eg.getValue(r),o=be(n,(function(e){return e.get()}));return A(A({},i),o)},a=function(t){r((function(r){var i=p.getData(),o=A(A({},i),t),a=zQ(e,o),s=e.getFormWrapper();eg.setValue(s,a),ve(n,(function(e,t){Ee(o,t)&&e.set(o[t])}))}))},s=function(t){$Q(e,t).each(Fv.disable)},l=function(t){$Q(e,t).each(Fv.enable)},u=function(t){$Q(e,t).each(Xw.focus)},c=function(e){if(!o(e))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");r((function(t){Cs(t,UL,{message:e})}))},d=function(){r((function(e){xs(e,VL)}))},f=function(t){r((function(n){var r=e.getBody(),i=wq.getState(r);i.get().exists((function(e){return e.isTabPanel()}))&&bv.getCurrent(r).each((function(e){HJ.showTab(e,t)}))}))},h=function(e){r((function(n){var r=t(e);n.getSystem().broadcastOn([tQ],r),n.getSystem().broadcastOn([nQ],r.internalDialog),n.getSystem().broadcastOn([rQ],r.internalDialog),n.getSystem().broadcastOn([iQ],r.internalDialog),p.setData(r.initialData)}))},m=function(){r((function(e){xs(e,FL)}))},p={getData:i,setData:a,disable:s,enable:l,focus:u,block:c,unblock:d,showTab:f,redial:h,close:m};return p},VQ=function(e){switch(e){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}},HQ=function(e,t,n){var r=CQ(e.internalDialog.title,n),i=lQ({body:e.internalDialog.body},n),o=EQ(e.internalDialog.buttons),a=_Q(o),s=BQ({buttons:o},n),l=RQ.initDialog((function(){return h}),DQ((function(){return d}),n.shared.providers,t),n.shared.getSink),u=VQ(e.internalDialog.size),c={header:r,body:i,footer:N.some(s),extraClasses:u,extraBehaviours:[],extraStyles:{}},d=kQ(c,e,l,n),f=function(){var e=function(){var e=WY.getBody(d);return bv.getCurrent(e).getOr(e)};return{getRoot:w(d),getBody:function(){return WY.getBody(d)},getFooter:function(){return WY.getFooter(d)},getFormWrapper:e}}(),h=UQ(f,t.redial,a);return{dialog:d,instanceApi:h}},jQ=function(e,t,n,r){var i,o,a=il("dialog-label"),s=il("dialog-content"),l=function(e,t){return N.some(t)},u=Ex(SQ({title:e.internalDialog.title,draggable:!0},a,n.shared.providers)),c=Ex(sQ({body:e.internalDialog.body},s,n,r)),d=EQ(e.internalDialog.buttons),f=_Q(d),h=Ex(FQ({buttons:d},n)),m=RQ.initDialog((function(){return g}),{onBlock:function(e){rH.block(p,(function(t,r){return TQ(e.message,r,n.shared.providers)}))},onUnblock:function(){rH.unblock(p)},onClose:function(){return t.closeWindow()}},n.shared.getSink),p=Eu({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:(i={role:"dialog"},i["aria-labelledby"]=a,i["aria-describedby"]=s,i)},eventOrder:(o={},o[es()]=[wq.name(),bd.name()],o[ts()]=["execute-on-form"],o[fs()]=["reflecting","execute-on-form"],o),behaviours:fd([Aw.config({mode:"cyclic",onEscape:function(e){return xs(e,FL),N.some(!0)},useTabstopAt:function(e){return!kM(e)&&("button"!==st(e)||"disabled"!==Vn(e,"disabled"))}}),wq.config({channel:tQ,updateState:l,initialData:e}),Xw.config({}),Uw("execute-on-form",m.concat([Us(Ba(),(function(e,t){Aw.focusIn(e)}))])),rH.config({getRoot:function(){return N.some(p)}}),$w.config({}),pM.memory({})]),components:[u.asSpec(),c.asSpec(),h.asSpec()]}),g=UQ({getRoot:w(p),getFooter:function(){return h.get(p)},getBody:function(){return c.get(p)},getFormWrapper:function(){var e=c.get(p);return bv.getCurrent(e).getOr(e)}},t.redial,f);return{dialog:p,instanceApi:g}},qQ=tinymce.util.Tools.resolve("tinymce.util.URI"),GQ=function(e){var t=function(t){e.getSystem().isConnected()&&t(e)},n=function(e){if(!o(e))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");t((function(t){Cs(t,UL,{message:e})}))},r=function(){t((function(e){xs(e,VL)}))},i=function(){t((function(e){xs(e,FL)}))},a=function(e){t((function(t){t.getSystem().broadcastOn([oQ],e)}))};return{block:n,unblock:r,close:i,sendMessage:a}},WQ=["insertContent","setContent","execCommand","close","block","unblock"],KQ=function(e){return a(e)&&-1!==WQ.indexOf(e.mceAction)},YQ=function(e){return!KQ(e)&&a(e)&&Ee(e,"mceAction")},XQ=function(e,t,n){switch(n.mceAction){case"insertContent":e.insertContent(n.content);break;case"setContent":e.setContent(n.content);break;case"execCommand":var r=!!u(n.ui)&&n.ui;e.execCommand(n.cmd,r,n.value);break;case"close":t.close();break;case"block":t.block(n.message);break;case"unblock":t.unblock();break}},JQ=function(e,t,n,r){var i,o=CQ(e.title,r),a=uQ(e),s=e.buttons.bind((function(e){return 0===e.length?N.none():N.some(BQ({buttons:e},r))})),l=RQ.initUrlDialog((function(){return v}),DQ((function(){return g}),r.shared.providers,t)),u=A(A({},e.height.fold((function(){return{}}),(function(e){return{height:e+"px","max-height":e+"px"}}))),e.width.fold((function(){return{}}),(function(e){return{width:e+"px","max-width":e+"px"}}))),c=e.width.isNone()&&e.height.isNone()?["tox-dialog--width-lg"]:[],d=new qQ(e.url,{base_uri:new qQ(window.location.href)}),f=d.protocol+"://"+d.host+(d.port?":"+d.port:""),h=tf(),m=[Uw("messages",[Vs((function(){var t=af(tt.fromDom(window),"message",(function(t){if(d.isSameOrigin(new qQ(t.raw.origin))){var r=t.raw.data;KQ(r)?XQ(n,v,r):YQ(r)&&e.onMessage(v,r)}}));h.set(t)})),Hs(h.clear)]),bd.config({channels:(i={},i[oQ]={onReceive:function(e,t){Bu(e.element,"iframe").each((function(e){var n=e.dom.contentWindow;n.postMessage(t,f)}))}},i)})],p={header:o,body:a,footer:s,extraClasses:c,extraBehaviours:m,extraStyles:u},g=kQ(p,e,l,r),v=GQ(g);return{dialog:g,instanceApi:v}},QQ=function(e){var t=e.backstage.shared,n=function(n,r){var i=function(){WY.hide(l),r()},o=Ex(fF({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:N.none()},"cancel",e.backstage)),a=hQ(),s=fQ(i,t.providers),l=Eu(vQ({lazySink:function(){return t.getSink()},header:dQ(a,s),body:mQ(n,t.providers),footer:N.some(pQ(gQ([],[o.asSpec()]))),onEscape:i,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Rs(BL,i)],eventOrder:{}}));WY.show(l);var u=o.get(l);Xw.focus(u)};return{open:n}},ZQ=function(e){var t=e.backstage.shared,n=function(n,r){var i=function(e){WY.hide(u),r(e)},o=Ex(fF({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:N.none()},"submit",e.backstage)),a=fF({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:N.none()},"cancel",e.backstage),s=hQ(),l=fQ((function(){return i(!1)}),t.providers),u=Eu(vQ({lazySink:function(){return t.getSink()},header:dQ(s,l),body:mQ(n,t.providers),footer:N.some(pQ(gQ([],[a,o.asSpec()]))),onEscape:function(){return i(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Rs(BL,(function(){return i(!1)})),Rs(zL,(function(){return i(!0)}))],eventOrder:{}}));WY.show(u);var c=o.get(u);Xw.focus(c)};return{open:n}},eZ=function(e,t){return So(wo("data",t,e))},tZ=function(e){return qA(e,".tox-alert-dialog")||qA(e,".tox-confirm-dialog")},nZ=function(e,t,n){return t&&n?[]:[OU.config({contextual:{lazyContext:function(){return N.some(Jr(tt.fromDom(e.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]},rZ=function(e){var t=e.backstage,n=e.editor,r=eE(n),i=QQ(e),o=ZQ(e),a=function(e,n,r){return void 0!==n&&"toolbar"===n.inline?c(e,t.shared.anchors.inlineDialog(),r,n.ariaAttrs):void 0!==n&&"cursor"===n.inline?c(e,t.shared.anchors.cursor(),r,n.ariaAttrs):u(e,r)},s=function(e,t){return l(e,t)},l=function(e,r){var i=function(e){var i=JQ(e,{closeWindow:function(){WY.hide(i.dialog),r(i.instanceApi)}},n,t);return WY.show(i.dialog),i.instanceApi};return kJ.openUrl(i,e)},u=function(e,n){var r=function(e,r,i){var o=r,a={dataValidator:i,initialData:o,internalDialog:e},s=HQ(a,{redial:kJ.redial,closeWindow:function(){WY.hide(s.dialog),n(s.instanceApi)}},t);return WY.show(s.dialog),s.instanceApi.setData(o),s.instanceApi};return kJ.open(r,e)},c=function(e,i,o,a){var s=function(e,s,l){var u=eZ(s,l),c=rf(),d=t.shared.header.isPositionedAtTop(),f={dataValidator:l,initialData:u,internalDialog:e},h=function(){return c.on((function(e){tx.reposition(e),OU.refresh(e)}))},m=jQ(f,{redial:kJ.redial,closeWindow:function(){c.on(tx.hide),n.off("ResizeEditor",h),c.clear(),o(m.instanceApi)}},t,a),p=Eu(tx.sketch(A(A({lazySink:t.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},d?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:fd(O([Uw("window-manager-inline-events",[Rs(ms(),(function(e,t){xs(m.dialog,BL)}))])],nZ(n,r,d),!0)),isExtraPart:function(e,t){return tZ(t)}})));return c.set(p),tx.showWithin(p,_u(m.dialog),{anchor:i},N.some(Fn())),r&&d||(OU.refresh(p),n.on("ResizeEditor",h)),m.instanceApi.setData(u),Aw.focusIn(m.dialog),m.instanceApi};return kJ.open(s,e)},d=function(e,t){o.open(e,(function(e){t(e)}))},f=function(e,t){i.open(e,(function(){t()}))},h=function(e){e.close()};return{open:a,openUrl:s,alert:f,close:h,confirm:d}};function iZ(){_.add("silver",(function(e){var t=zY(e),n=t.uiMothership,r=t.backstage,i=t.renderUI,o=t.getUi;jA.register(e,r.shared);var a=rZ({editor:e,backstage:r});return{renderUI:i,getWindowManagerImpl:w(a),getNotificationManagerImpl:function(){return XC(e,{backstage:r},n)},ui:o()}}))}iZ()})()}).call(this,n("a282"))},a7ac:function(e,t,n){},a7c6:function(e,t,n){},a85f:function(e,t,n){},aa1c:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}),t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,operates:e.operates,operateWidth:"280px",data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange},scopedSlots:e._u([{key:"image",fn:function(e){return t("div",{},[e.row.image?t("el-image",{staticStyle:{width:"50px"},attrs:{src:e.row.image,"preview-src-list":[e.row.image]}}):t("span")],1)}}])}),t("add-dialog",{ref:"addDialog",on:{success:e.handleSuccess}}),t("ling-kuan",{ref:"collectionRef",on:{success:e.handleSuccess}}),t("detail-drawer",{ref:"drawerRef"}),t("refund",{ref:"refundRef",on:{success:e.handleSuccess}})],1)},i=[],o=(n("5948"),n("7591")),a=n("b775"),s=n("779e"),l=n("b893"),u=n("2a9b"),c=n("29ed"),d=n("f6c9"),f=n("a0f2"),h=n("d03e2"),m={name:"receivablesPage",components:{BasicTable:o["a"],addDialog:s["default"],createCollectionDialog:c["default"],DetailDrawer:f["default"],refund:h["default"],lingKuan:d["default"]},data(){return{loading:!1,categoryOptions:[],orderStatus:u["b"],filterOptions:{column:[{type:"input",label:"订单号",value:"orderNum"},{type:"input",label:"课程名称",value:"courseName"},{type:"user",userType:0,label:"销售员",value:"profitAdId"},{type:"user",userType:1,label:"下单人",value:"placeOrderId"}]},filterData:{orderNum:"",courseName:"",createAdId:"",profitAdId:"",placeOrderId:""},table:{columns:[{id:1,prop:"orderNum",label:"订单号",width:"200px"},{id:2,prop:"status",label:"订单状态",render:e=>{const t=this.orderStatus.find(t=>t.value==e.status);return t?t.label:""},width:"80px"},{id:3,prop:"courseName",label:"课程名称",minWidth:"150px"},{id:4,prop:"time",label:"开始/结束日期",minWidth:"200px",render:e=>e.startTime?`${Object(l["b"])(e.startTime,"yyyy-MM-dd")} 至 ${Object(l["b"])(e.endTime,"yyyy-MM-dd")}`:"",width:"200px"},{id:5,prop:"collectionUnit",label:"收款单位",width:"80px"},{id:6,prop:"count",label:"数量",width:"80px"},{id:7,prop:"receivablePrice",label:"应收金额",width:"80px"},{id:13,prop:"pendingTrialPrice",label:"待审金额",width:"80px"},{id:8,prop:"receivedPrice",label:"已收金额",width:"80px"},{id:9,prop:"unReceivedPrice",label:"未收金额",width:"80px"},{id:10,prop:"pendingTrialPrice",label:"待审金额",width:"80px"},{id:11,prop:"invoicedPrice",label:"已开票金额",width:"80px"},{id:12,prop:"vipName",label:"下单人",minWidth:"120px"},{id:14,prop:"profitAdName",label:"销售人",minWidth:"180px"}],pageSize:20,currentPage:1,data:[],total:0},operates:[{key:"deatil",title:"详情",permission:"system/sysAdvertise/remove",btnStyle:"green",action:(e,t)=>{this.$refs.drawerRef.open(t)}},{key:"payoutDetail",title:"收款明细",btnStyle:"yellow",action:(e,t)=>{this.$router.push({path:this.$router.path,query:{type:2,orderNum:t.orderNum}})}},{key:"payment",title:"领款",permission:"system/sysCourseOrderBills/claimMoneyAdd",btnStyle:"green",action:(e,t)=>{this.$refs.collectionRef.open(t.orderNum,"领款",t.collectionName)}},{key:"refund",title:"退款",permission:"system/sysCourseOrderBills/refundAdd",btnStyle:"red",action:(e,t)=>{this.$refs.refundRef.open(t)}}],headerOperates:[{key:"export",name:"导出",permission:"system/sysCourseOrderBills/receivablesListExport",action:()=>{this.handleExport()}}]}},created(){this.getList()},methods:{handleExport(){this.$confirm("确定导出应收款列表吗？导出的时候请等待页面下载自动开始，如果数据量大，可能会等待稍长时间，请不要关闭或者刷新页面","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$message.warning("请耐心等待，表格正在导出中......"),a["a"].post({url:"/system/sysCourseOrderBills/receivablesListExport",params:{...this.filterData},success:e=>{let t=document.createElement("a");t.href="https://"+e,document.body.appendChild(t),t.click(),document.body.removeChild(t),this.$message.success("导出成功"),this.searchFilter()}})}).catch(()=>{this.$message.info("已取消导出")})},searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0,a["a"].post({url:"/system/sysCourseOrderBills/receivablesList",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,...this.filterData},success:e=>{this.table.data=e.list,this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1}})},handleSuccess(){this.getList()},handleDelete(e){this.$confirm("此操作将会删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/system/sysAdvertise/remove",params:{id:e.id},success:e=>{this.$message.success(e),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},clearFilter(){this.filterData={orderNum:"",courseName:"",createAdId:"",profitAdId:"",placeOrderId:""},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()}}},p=m,g=(n("0e19"),n("1805")),v=Object(g["a"])(p,r,i,!1,null,"3454f534",null);t["default"]=v.exports},aa7a:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("div",{staticClass:"header-box"},[e.headerTab.length>0?t("div",{staticClass:"BasicInfo_title"},e._l(e.headerTab,(function(n){return t("div",{directives:[{name:"permission",rawName:"v-permission",value:n.permission,expression:"tab.permission"}],key:n.id,staticClass:"item",class:{is_active:n.isChecked},on:{click:function(t){return e.handleTabSelect(n)}}},[t("span",{class:"tab_"+n.id},[e._v(e._s(n.name))])])})),0):e._e()]),1===e.tagCheck?t("jat-fillter",{attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}):e._e(),2===e.tagCheck?t("jat-fillter",{attrs:{option:e.filterOptions1},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}):e._e(),3===e.tagCheck?t("jat-fillter",{attrs:{option:e.filterOptions2},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}):e._e(),1===e.tagCheck?t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange}}):e._e(),2===e.tagCheck?t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates1,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange}}):e._e(),3===e.tagCheck?t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates2,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total,"table-remark":"注：由于一个订单套餐会包含多个课程，所以该统计只统计包含了该课程的订单数量，不统计相关订单金额"},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange}}):e._e()],1)},i=[],o=n("7591"),a=n("b775"),s=n("b893"),l={name:"personPerformance",components:{BasicTable:o["a"]},data(){return{tagCheck:1,loading:!1,categoryOptions:[],filterOptions:{column:[{type:"user",userType:1,label:"下单客户",value:"vipId"},{type:"timeAll",label:["开始日期","结束日期"],value:"time",clearable:!1}]},filterOptions1:{column:[{type:"user",userType:0,label:"销售员",value:"profitAdId"},{type:"timeAll",label:["开始日期","结束日期"],value:"time",clearable:!1}]},filterOptions2:{column:[{type:"timeAll",label:["开始日期","结束日期"],value:"time",clearable:!1}]},filterData:{profitAdId:"",departmentId:"",time:[]},table:{columns:[{id:1,prop:"name",label:"名称"},{id:2,prop:"count",label:"订单数量"},{id:4,prop:"receivable",label:"应收金额"},{id:5,prop:"received",label:"已收金额"},{id:6,prop:"unReceived",label:"未收金额"}],pageSize:20,currentPage:1,data:[],total:0},operates:[],headerOperates:[{key:"export",name:"导出",permission:"system/sysCourseOrderBills/pressSinglePersonStatisticsExport",action:()=>{this.handleExport(0)}}],headerOperates1:[{key:"export",name:"导出",permission:"system/sysCourseOrderBills/statisticsSalespersonExport",action:()=>{this.handleExport(1)}}],headerOperates2:[{key:"export",name:"导出",permission:"system/sysCourseOrderBills/statisticsCourseExport",action:()=>{this.handleExport(2)}}],currentTab:1,headerTab:[{id:1,name:"下单客户统计",isChecked:!0,permission:"",api:"system/sysCourseOrderBills/pressSinglePersonStatistics"},{id:2,name:"销售员统计",isChecked:!1,api:"/system/sysCourseOrderBills/statisticsSalesperson",permission:""},{id:3,name:"按课程统计",isChecked:!1,api:"system/sysCourseOrderBills/statisticsCourse",permission:""}]}},created(){this.getList()},mounted(){this.init()},methods:{handleExport(e){var t="",n="";0===e&&(t="system/sysCourseOrderBills/pressSinglePersonStatisticsExport",n="下单客户统计列表"),1===e&&(t="system/sysCourseOrderBills/statisticsSalespersonExport",n="销售员统计列表"),2===e&&(t="system/sysCourseOrderBills/statisticsCourseExport",n="课程统计列表"),this.$confirm("确定导出"+n+"吗？导出的时候请等待页面下载自动开始，如果数据量大，可能会等待稍长时间，请不要关闭或者刷新页面","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$message.warning("请耐心等待，表格正在导出中......");const{time:e,...n}=this.filterData;a["a"].post({url:t,params:{startTime:e&&e.length>1?e[0]:"",endTime:e&&e.length>1?e[1]:"",...n},success:e=>{let t=document.createElement("a");t.href="https://"+e,document.body.appendChild(t),t.click(),document.body.removeChild(t),this.$message.success("导出成功"),this.searchFilter()}})}).catch(()=>{this.$message.info("已取消导出")})},searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0;const{time:e,...t}=this.filterData;a["a"].post({url:this.headerTab.find(e=>e.isChecked).api,params:{startTime:e&&e.length>1?e[0]:"",endTime:e&&e.length>1?e[1]:"",...t},success:e=>{this.table.data=e.slice((this.table.currentPage-1)*this.table.pageSize,(this.table.currentPage-1)*this.table.pageSize+this.table.pageSize),this.table.total=e.length,this.loading=!1},catch:()=>{this.loading=!1},finally:()=>{this.loading=!1}})},getDepartmentList(){a["a"].post({url:"/admin/adInfo/canChooseCanSeeDepartmentList",params:{id:sessionStorage.getItem("id")},params:{},success:e=>{this.filterOptions.column[1].options=Object(s["c"])(e)}})},clearFilter(){this.filterData={profitAdId:"",departmentId:"",number:"",time:[]},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()},handleTabSelect(e,t){this.tagCheck=e.id,e.id==this.$route.query.type&&e.isChecked||(this.headerTab.forEach(t=>{t.isChecked=t.id==e.id}),t||this.$router.replace({path:this.$router.path,query:{type:e.id}}),this.currentTab=e.id,this.table.data=[],this.table.total=0,this.clearFilter())},init(){const e=this.$route.query.type;if(e){const t=document.querySelector(".tab_"+e);if(!t){const e=this.headerTab.find(e=>e.isChecked);return void this.$router.replace({path:this.$router.path,query:{type:e.id}})}const n=this.headerTab.find(t=>t.id==e);n&&this.handleTabSelect(n,!0)}else this.$router.replace({path:this.$router.path,query:{type:1}})}}},u=l,c=(n("fed9"),n("1805")),d=Object(c["a"])(u,r,i,!1,null,"d511d6c8",null);t["default"]=d.exports},ab41:function(e,t,n){"use strict";n("6f7e")},adf1:function(e,t,n){"use strict";n("5331")},ae6b:function(e,t,n){"use strict";n("e6c3")},b180:function(e,t,n){"use strict";n("b7d4")},b1c0:function(e,t,n){"use strict";var r=n("cbab"),i=n("4434"),o=n("887f"),a=n("ef0e"),s=n("e015"),l=n("cf8b"),u=n("2101"),c=n("24a3"),d=n("0462"),f=n("fc89"),h=n("48ae"),m=n("aa1e"),p=n("6ab0");e.exports=function(e,t,n,g){var v="stackTraceLimit",b=g?2:1,y=e.split("."),w=y[y.length-1],S=r.apply(null,y);if(S){var x=S.prototype;if(!p&&i(x,"cause")&&delete x.cause,!n)return S;var C=r("Error"),T=t((function(e,t){var n=d(g?t:e,void 0),r=g?new S(e):new S;return void 0!==n&&o(r,"message",n),h(r,T,r.stack,2),this&&a(x,this)&&c(r,this,T),arguments.length>b&&f(r,arguments[b]),r}));if(T.prototype=x,"Error"!==w?s?s(T,C):l(T,C,{name:!0}):m&&v in S&&(u(T,S,v),u(T,S,"prepareStackTrace")),l(T,S),!p)try{x.name!==w&&o(x,"name",w),x.constructor=T}catch(D){}return T}}},b23c:function(e,t,n){(function(t){e.exports=t()})((function(e){"use strict";var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function n(e,t){var n=e[0],r=e[1],i=e[2],o=e[3];n+=(r&i|~r&o)+t[0]-680876936|0,n=(n<<7|n>>>25)+r|0,o+=(n&r|~n&i)+t[1]-389564586|0,o=(o<<12|o>>>20)+n|0,i+=(o&n|~o&r)+t[2]+606105819|0,i=(i<<17|i>>>15)+o|0,r+=(i&o|~i&n)+t[3]-1044525330|0,r=(r<<22|r>>>10)+i|0,n+=(r&i|~r&o)+t[4]-176418897|0,n=(n<<7|n>>>25)+r|0,o+=(n&r|~n&i)+t[5]+1200080426|0,o=(o<<12|o>>>20)+n|0,i+=(o&n|~o&r)+t[6]-1473231341|0,i=(i<<17|i>>>15)+o|0,r+=(i&o|~i&n)+t[7]-45705983|0,r=(r<<22|r>>>10)+i|0,n+=(r&i|~r&o)+t[8]+1770035416|0,n=(n<<7|n>>>25)+r|0,o+=(n&r|~n&i)+t[9]-1958414417|0,o=(o<<12|o>>>20)+n|0,i+=(o&n|~o&r)+t[10]-42063|0,i=(i<<17|i>>>15)+o|0,r+=(i&o|~i&n)+t[11]-1990404162|0,r=(r<<22|r>>>10)+i|0,n+=(r&i|~r&o)+t[12]+1804603682|0,n=(n<<7|n>>>25)+r|0,o+=(n&r|~n&i)+t[13]-40341101|0,o=(o<<12|o>>>20)+n|0,i+=(o&n|~o&r)+t[14]-1502002290|0,i=(i<<17|i>>>15)+o|0,r+=(i&o|~i&n)+t[15]+1236535329|0,r=(r<<22|r>>>10)+i|0,n+=(r&o|i&~o)+t[1]-165796510|0,n=(n<<5|n>>>27)+r|0,o+=(n&i|r&~i)+t[6]-1069501632|0,o=(o<<9|o>>>23)+n|0,i+=(o&r|n&~r)+t[11]+643717713|0,i=(i<<14|i>>>18)+o|0,r+=(i&n|o&~n)+t[0]-373897302|0,r=(r<<20|r>>>12)+i|0,n+=(r&o|i&~o)+t[5]-701558691|0,n=(n<<5|n>>>27)+r|0,o+=(n&i|r&~i)+t[10]+38016083|0,o=(o<<9|o>>>23)+n|0,i+=(o&r|n&~r)+t[15]-660478335|0,i=(i<<14|i>>>18)+o|0,r+=(i&n|o&~n)+t[4]-405537848|0,r=(r<<20|r>>>12)+i|0,n+=(r&o|i&~o)+t[9]+568446438|0,n=(n<<5|n>>>27)+r|0,o+=(n&i|r&~i)+t[14]-1019803690|0,o=(o<<9|o>>>23)+n|0,i+=(o&r|n&~r)+t[3]-187363961|0,i=(i<<14|i>>>18)+o|0,r+=(i&n|o&~n)+t[8]+1163531501|0,r=(r<<20|r>>>12)+i|0,n+=(r&o|i&~o)+t[13]-1444681467|0,n=(n<<5|n>>>27)+r|0,o+=(n&i|r&~i)+t[2]-51403784|0,o=(o<<9|o>>>23)+n|0,i+=(o&r|n&~r)+t[7]+1735328473|0,i=(i<<14|i>>>18)+o|0,r+=(i&n|o&~n)+t[12]-1926607734|0,r=(r<<20|r>>>12)+i|0,n+=(r^i^o)+t[5]-378558|0,n=(n<<4|n>>>28)+r|0,o+=(n^r^i)+t[8]-2022574463|0,o=(o<<11|o>>>21)+n|0,i+=(o^n^r)+t[11]+1839030562|0,i=(i<<16|i>>>16)+o|0,r+=(i^o^n)+t[14]-35309556|0,r=(r<<23|r>>>9)+i|0,n+=(r^i^o)+t[1]-1530992060|0,n=(n<<4|n>>>28)+r|0,o+=(n^r^i)+t[4]+1272893353|0,o=(o<<11|o>>>21)+n|0,i+=(o^n^r)+t[7]-155497632|0,i=(i<<16|i>>>16)+o|0,r+=(i^o^n)+t[10]-1094730640|0,r=(r<<23|r>>>9)+i|0,n+=(r^i^o)+t[13]+681279174|0,n=(n<<4|n>>>28)+r|0,o+=(n^r^i)+t[0]-358537222|0,o=(o<<11|o>>>21)+n|0,i+=(o^n^r)+t[3]-722521979|0,i=(i<<16|i>>>16)+o|0,r+=(i^o^n)+t[6]+76029189|0,r=(r<<23|r>>>9)+i|0,n+=(r^i^o)+t[9]-640364487|0,n=(n<<4|n>>>28)+r|0,o+=(n^r^i)+t[12]-421815835|0,o=(o<<11|o>>>21)+n|0,i+=(o^n^r)+t[15]+530742520|0,i=(i<<16|i>>>16)+o|0,r+=(i^o^n)+t[2]-995338651|0,r=(r<<23|r>>>9)+i|0,n+=(i^(r|~o))+t[0]-198630844|0,n=(n<<6|n>>>26)+r|0,o+=(r^(n|~i))+t[7]+1126891415|0,o=(o<<10|o>>>22)+n|0,i+=(n^(o|~r))+t[14]-1416354905|0,i=(i<<15|i>>>17)+o|0,r+=(o^(i|~n))+t[5]-57434055|0,r=(r<<21|r>>>11)+i|0,n+=(i^(r|~o))+t[12]+1700485571|0,n=(n<<6|n>>>26)+r|0,o+=(r^(n|~i))+t[3]-1894986606|0,o=(o<<10|o>>>22)+n|0,i+=(n^(o|~r))+t[10]-1051523|0,i=(i<<15|i>>>17)+o|0,r+=(o^(i|~n))+t[1]-2054922799|0,r=(r<<21|r>>>11)+i|0,n+=(i^(r|~o))+t[8]+1873313359|0,n=(n<<6|n>>>26)+r|0,o+=(r^(n|~i))+t[15]-30611744|0,o=(o<<10|o>>>22)+n|0,i+=(n^(o|~r))+t[6]-1560198380|0,i=(i<<15|i>>>17)+o|0,r+=(o^(i|~n))+t[13]+1309151649|0,r=(r<<21|r>>>11)+i|0,n+=(i^(r|~o))+t[4]-145523070|0,n=(n<<6|n>>>26)+r|0,o+=(r^(n|~i))+t[11]-1120210379|0,o=(o<<10|o>>>22)+n|0,i+=(n^(o|~r))+t[2]+718787259|0,i=(i<<15|i>>>17)+o|0,r+=(o^(i|~n))+t[9]-343485551|0,r=(r<<21|r>>>11)+i|0,e[0]=n+e[0]|0,e[1]=r+e[1]|0,e[2]=i+e[2]|0,e[3]=o+e[3]|0}function r(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}function i(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24);return n}function o(e){var t,i,o,a,s,l,u=e.length,c=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=u;t+=64)n(c,r(e.substring(t-64,t)));for(e=e.substring(t-64),i=e.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<i;t+=1)o[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(o[t>>2]|=128<<(t%4<<3),t>55)for(n(c,o),t=0;t<16;t+=1)o[t]=0;return a=8*u,a=a.toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(a[2],16),l=parseInt(a[1],16)||0,o[14]=s,o[15]=l,n(c,o),c}function a(e){var t,r,o,a,s,l,u=e.length,c=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=u;t+=64)n(c,i(e.subarray(t-64,t)));for(e=t-64<u?e.subarray(t-64):new Uint8Array(0),r=e.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<r;t+=1)o[t>>2]|=e[t]<<(t%4<<3);if(o[t>>2]|=128<<(t%4<<3),t>55)for(n(c,o),t=0;t<16;t+=1)o[t]=0;return a=8*u,a=a.toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(a[2],16),l=parseInt(a[1],16)||0,o[14]=s,o[15]=l,n(c,o),c}function s(e){var n,r="";for(n=0;n<4;n+=1)r+=t[e>>8*n+4&15]+t[e>>8*n&15];return r}function l(e){var t;for(t=0;t<e.length;t+=1)e[t]=s(e[t]);return e.join("")}function u(e){return/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e))),e}function c(e,t){var n,r=e.length,i=new ArrayBuffer(r),o=new Uint8Array(i);for(n=0;n<r;n+=1)o[n]=e.charCodeAt(n);return t?o:i}function d(e){return String.fromCharCode.apply(null,new Uint8Array(e))}function f(e,t,n){var r=new Uint8Array(e.byteLength+t.byteLength);return r.set(new Uint8Array(e)),r.set(new Uint8Array(t),e.byteLength),n?r:r.buffer}function h(e){var t,n=[],r=e.length;for(t=0;t<r-1;t+=2)n.push(parseInt(e.substr(t,2),16));return String.fromCharCode.apply(String,n)}function m(){this.reset()}return"5d41402abc4b2a76b9719d911017c592"!==l(o("hello"))&&function(e,t){var n=(65535&e)+(65535&t),r=(e>>16)+(t>>16)+(n>>16);return r<<16|65535&n},"undefined"===typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function t(e,t){return e=0|e||0,e<0?Math.max(e+t,0):Math.min(e,t)}ArrayBuffer.prototype.slice=function(n,r){var i,o,a,s,l=this.byteLength,u=t(n,l),c=l;return r!==e&&(c=t(r,l)),u>c?new ArrayBuffer(0):(i=c-u,o=new ArrayBuffer(i),a=new Uint8Array(o),s=new Uint8Array(this,u,i),a.set(s),o)}}(),m.prototype.append=function(e){return this.appendBinary(u(e)),this},m.prototype.appendBinary=function(e){this._buff+=e,this._length+=e.length;var t,i=this._buff.length;for(t=64;t<=i;t+=64)n(this._hash,r(this._buff.substring(t-64,t)));return this._buff=this._buff.substring(t-64),this},m.prototype.end=function(e){var t,n,r=this._buff,i=r.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<i;t+=1)o[t>>2]|=r.charCodeAt(t)<<(t%4<<3);return this._finish(o,i),n=l(this._hash),e&&(n=h(n)),this.reset(),n},m.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},m.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},m.prototype.setState=function(e){return this._buff=e.buff,this._length=e.length,this._hash=e.hash,this},m.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},m.prototype._finish=function(e,t){var r,i,o,a=t;if(e[a>>2]|=128<<(a%4<<3),a>55)for(n(this._hash,e),a=0;a<16;a+=1)e[a]=0;r=8*this._length,r=r.toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(r[2],16),o=parseInt(r[1],16)||0,e[14]=i,e[15]=o,n(this._hash,e)},m.hash=function(e,t){return m.hashBinary(u(e),t)},m.hashBinary=function(e,t){var n=o(e),r=l(n);return t?h(r):r},m.ArrayBuffer=function(){this.reset()},m.ArrayBuffer.prototype.append=function(e){var t,r=f(this._buff.buffer,e,!0),o=r.length;for(this._length+=e.byteLength,t=64;t<=o;t+=64)n(this._hash,i(r.subarray(t-64,t)));return this._buff=t-64<o?new Uint8Array(r.buffer.slice(t-64)):new Uint8Array(0),this},m.ArrayBuffer.prototype.end=function(e){var t,n,r=this._buff,i=r.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<i;t+=1)o[t>>2]|=r[t]<<(t%4<<3);return this._finish(o,i),n=l(this._hash),e&&(n=h(n)),this.reset(),n},m.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},m.ArrayBuffer.prototype.getState=function(){var e=m.prototype.getState.call(this);return e.buff=d(e.buff),e},m.ArrayBuffer.prototype.setState=function(e){return e.buff=c(e.buff,!0),m.prototype.setState.call(this,e)},m.ArrayBuffer.prototype.destroy=m.prototype.destroy,m.ArrayBuffer.prototype._finish=m.prototype._finish,m.ArrayBuffer.hash=function(e,t){var n=a(new Uint8Array(e)),r=l(n);return t?h(r):r},m}))},b3dd:function(e,t,n){},b488:function(e,t,n){},b4e4:function(e,t,n){},b611:function(e,t,n){},b74e:function(e,t,n){},b7d4:function(e,t,n){},b942:function(e,t,n){n("5a1c")},b9d7:function(e,t,n){},b9fd:function(e,t,n){},baf7:function(e,t,n){"use strict";n("0b9a")},bb1c:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}),t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,operates:e.operates,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange}})],1)},i=[],o=n("7591"),a=n("b775"),s={name:"myStudentPage",components:{BasicTable:o["a"]},data(){return{loading:!1,categoryOptions:[],filterOptions:{column:[{type:"input",label:"名称",value:"name"}]},filterData:{categoryId:"",name:""},table:{columns:[{id:1,prop:"name",label:"姓名"},{id:2,prop:"gender",label:"性别"},{id:3,prop:"account",label:"账号"},{id:4,prop:"phone",label:"手机号"}],pageSize:20,currentPage:1,data:[],total:0},operates:[{key:"edit",title:"编辑",permission:"system/sysAdvertise/edit",btnStyle:"yellow",action:(e,t)=>{this.$refs.addDialog.edit(t)}},{key:"delete",title:"删除",permission:"system/sysAdvertise/remove",btnStyle:"red",action:(e,t)=>{this.handleDelete(t)}}],headerOperates:[]}},created(){},methods:{searchFilter(){this.table.currentPage=1},getList(){this.loading=!0,a["a"].post({url:"/system/sysAdvertise/list",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,...this.filterData},success:e=>{this.table.data=e.list,this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1}})},getCategoryList(){a["a"].post({url:"/system/sysAdvertise/getAllAdvertisingSpace",params:{},success:e=>{this.filterOptions.column[0].options=e}})},handleSuccess(){this.getList()},handleDelete(e){this.$confirm("此操作将会删除该广告, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/system/sysAdvertise/remove",params:{id:e.id},success:e=>{this.$message.success(e),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},clearFilter(){this.filterData={name:""},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()}}},l=s,u=(n("05de"),n("1805")),c=Object(u["a"])(l,r,i,!1,null,"31d2b482",null);t["default"]=c.exports},bbad:function(e,t,n){"use strict";n("783f")},bc35:function(e,t,n){"use strict";n("c6b7")},bc43:function(e,t,n){},bcd0:function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,o){t=t||"&",n=n||"=";var a={};if("string"!==typeof e||0===e.length)return a;var s=/\+/g;e=e.split(t);var l=1e3;o&&"number"===typeof o.maxKeys&&(l=o.maxKeys);var u=e.length;l>0&&u>l&&(u=l);for(var c=0;c<u;++c){var d,f,h,m,p=e[c].replace(s,"%20"),g=p.indexOf(n);g>=0?(d=p.substr(0,g),f=p.substr(g+1)):(d=p,f=""),h=decodeURIComponent(d),m=decodeURIComponent(f),r(a,h)?i(a[h])?a[h].push(m):a[h]=[a[h],m]:a[h]=m}return a};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},bd28:function(e,t,n){},be47:function(e,t,n){},bf16:function(e,t,n){},bfde:function(e,t,n){"use strict";n("18f5")},c145:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.addModifyVisible,width:"50%"},on:{"update:visible":function(t){e.addModifyVisible=t},close:e.close}},[t("el-form",{ref:"newsRef",attrs:{model:e.addData,rules:e.newsRule,"label-position":"left","label-width":"90px"}},[t("el-form-item",{attrs:{label:"新闻分类",prop:"categoryId"}},[t("el-cascader",{staticStyle:{width:"100%"},attrs:{size:"small",clearable:"",options:e.categoryOptions,props:{label:"name",value:"id",emitPath:!1}},model:{value:e.addData.categoryId,callback:function(t){e.$set(e.addData,"categoryId",t)},expression:"addData.categoryId"}})],1),t("el-form-item",{attrs:{label:"新闻名称:",prop:"name"}},[t("jat-input",{attrs:{placeholder:"新闻名称"},model:{value:e.addData.name,callback:function(t){e.$set(e.addData,"name",t)},expression:"addData.name"}})],1),t("el-form-item",{attrs:{label:"新闻图片:",prop:"image"}},[t("upload-image",{model:{value:e.addData.image,callback:function(t){e.$set(e.addData,"image",t)},expression:"addData.image"}})],1),t("el-form-item",{attrs:{label:"链接:",prop:"href"}},[t("jat-input",{attrs:{placeholder:"请输入链接"},model:{value:e.addData.href,callback:function(t){e.$set(e.addData,"href",t)},expression:"addData.href"}})],1),t("el-form-item",{attrs:{label:"新闻内容:",prop:"content"}},[t("tinymce-edit",{model:{value:e.addData.content,callback:function(t){e.$set(e.addData,"content",t)},expression:"addData.content"}})],1),t("el-form-item",{attrs:{label:"排序:",prop:"sort"}},[t("jat-input",{attrs:{placeholder:"请输入排序"},model:{value:e.addData.sort,callback:function(t){e.$set(e.addData,"sort",e._n(t))},expression:"addData.sort"}})],1),t("el-form-item",{attrs:{label:"SEO标题:",prop:"seoTitle"}},[t("jat-input",{attrs:{type:"textarea",row:4,placeholder:"请输入SEO标题"},model:{value:e.addData.seoTitle,callback:function(t){e.$set(e.addData,"seoTitle",t)},expression:"addData.seoTitle"}})],1),t("el-form-item",{attrs:{label:"SEO关键字:",prop:"seoKey"}},[t("jat-input",{attrs:{type:"textarea",row:4,placeholder:"请输入SEO关键字"},model:{value:e.addData.seoKey,callback:function(t){e.$set(e.addData,"seoKey",t)},expression:"addData.seoKey"}})],1),t("el-form-item",{attrs:{label:"SEO描述:",prop:"seoContent"}},[t("jat-input",{attrs:{type:"textarea",row:4,placeholder:"请输入SEO描述"},model:{value:e.addData.seoContent,callback:function(t){e.$set(e.addData,"seoContent",t)},expression:"addData.seoContent"}})],1),t("el-form-item",{attrs:{label:"S描述:",prop:"remark"}},[t("jat-input",{attrs:{type:"textarea",row:6,placeholder:"描述"},model:{value:e.addData.remark,callback:function(t){e.$set(e.addData,"remark",t)},expression:"addData.remark"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)],1)},i=[],o=n("cbc3"),a=n("b775"),s=n("9adf"),l=n("b893"),u={components:{uploadImage:o["a"],tinymceEdit:s["a"]},data(){return{addModifyVisible:!1,dialogTitle:"",addData:{categoryId:"",name:"",image:"",href:"",content:"",sort:void 0,seoTitle:"",seoKey:"",seoContent:"",remark:"",id:""},categoryOptions:[],newsRule:{categoryId:[{required:!0,message:"请选择新闻分类",trigger:"blur"}],name:[{required:!0,message:"请输入新闻名称",trigger:"blur"}],sort:[{required:!0,message:"请输入排序",trigger:"blur"},{type:"number",message:"请输入整数"}]}}},mounted(){this.getCategoryList()},methods:{open(){this.dialogTitle="添加新闻",this.addData.name="",this.addModifyVisible=!0},edit({id:e,name:t,categoryId:n,href:r,image:i,sort:o,content:a,seoTitle:s,seoKey:l,seoContent:u,remark:c}){this.dialogTitle="编辑新闻",this.addModifyVisible=!0,this.addData={id:e,name:t,categoryId:n,href:r,image:i,sort:o,content:a,seoTitle:s,seoKey:l,seoContent:u,remark:c}},close(){this.$refs.newsRef&&this.$refs.newsRef.clearValidate(),this.addData={categoryId:"",name:"",image:"",href:"",content:"",sort:void 0,seoTitle:"",seoKey:"",seoContent:"",remark:"",id:""},this.addModifyVisible=!1},getCategoryList(){a["a"].post({url:"/system/sysNewsCategory/listNoPage",params:{...this.addData},success:e=>{this.categoryOptions=Object(l["c"])(e)}})},handleSubmit(){this.$refs.newsRef.validate(e=>{const{categoryId:t,...n}=this.addData;e&&(this.addData.id?a["a"].post({url:"/system/sysNews/edit",params:{...n,categoryId:t},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}):a["a"].post({url:"/system/sysNews/add",params:{...n,categoryId:t},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}))})}}},c=u,d=n("1805"),f=Object(d["a"])(c,r,i,!1,null,"d50b66d8",null);t["default"]=f.exports},c46c:function(e,t,n){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",[t("el-upload",{staticClass:"upload-file",attrs:{action:"customUrl","before-remove":e.beforeRemove,"before-upload":e.beforeUpload,multiple:"",accept:e.accept,limit:e.limit,"file-list":e.fileList}},[t("el-button",{attrs:{disabled:e.fileList.length==e.limit,size:"small",type:"primary"}},[e._v("点击上传")]),e.tip?t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" "+e._s(e.tip)+" ")]):e._e()],1),0!==e.percentage&&100!==e.percentage?t("el-progress",{staticStyle:{width:"100%"},attrs:{percentage:e.percentage}}):e._e()],1)},i=[],o=(n("5948"),n("4008")),a=n("b775"),s={name:"uploadFile",model:{prop:"fileValue",event:"update:fileValue"},props:{fileValue:[Array,String,File],limit:{type:Number,default:1},tip:String,accept:String,valueType:String},mounted(){this.initFileValue()},data(){return{percentage:0,fileList:[]}},methods:{beforeRemove(e,t){this.fileList=t,"string"===this.valueType&&1===this.limit?this.$emit("update:fileValue",""):this.$emit("update:fileValue",this.fileList)},beforeUpload(e){return this.handleUpload(e),!1},handleUpload(e){try{a["a"].post({url:"/comm/getUpToken",params:{},success:t=>{const n=o["a"](e,null,t);n.subscribe({error:()=>{this.$message.error("上传出错，请重新上传！")},next:({total:e})=>{this.percentage=parseInt(e.percent)},complete:({key:e})=>{this.$message.success("上传成功！"),this.fileList.push({name:e,url:this.$envConfig.qiniuDomain+e}),"string"===this.valueType&&1===this.limit?this.$emit("update:fileValue",this.fileList[0].url):this.$emit("update:fileValue",this.fileList)}})}})}catch(t){console.log(t),this.$message.error("上传出错，请重新上传！")}},initFileValue(){if(Array.isArray(this.fileValue))this.fileList=this.fileValue;else if(this.fileValue&&"string"===typeof this.fileValue){const e=this.fileValue.split("/");this.fileList=[{url:this.fileValue,name:e[e.length-1]}]}else this.fileList=[]}},watch:{fileValue(){this.initFileValue()}}},l=s,u=(n("1f1d"),n("1805")),c=Object(u["a"])(l,r,i,!1,null,"3dd3c46f",null);t["a"]=c.exports},c6b7:function(e,t,n){},cb0d:function(e,t,n){},cbc3:function(e,t,n){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"uploadImage"},[t("el-upload",{class:e.fileList.length<e.limit?"":"hiddenImage",attrs:{action:"#","list-type":"picture-card",limit:e.limit,"auto-upload":!0,"before-upload":e.beforeUpload,accept:".jpg,.jpeg,.png,.gif","file-list":e.fileList},scopedSlots:e._u([{key:"file",fn:function({file:n}){return t("div",{},[t("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:n.url,alt:""}}),t("span",{staticClass:"el-upload-list__item-actions"},[t("span",{staticClass:"el-upload-list__item-preview",on:{click:function(t){return e.handlePictureCardPreview(n)}}},[t("i",{staticClass:"el-icon-zoom-in"})]),t("span",{staticClass:"el-upload-list__item-delete",on:{click:function(t){return e.handleRemove(n)}}},[t("i",{staticClass:"el-icon-delete"})])])])}}])},[t("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"}),e.fileList.length<e.limit?t("div",{staticClass:"el-upload__tip",style:{left:148*e.fileList.length+"px"},attrs:{slot:"tip"},slot:"tip"},[e._v(" 只能上传jpg/png文件，且不超过1M ")]):e._e()]),e.dialogVisible?t("el-image-viewer",{attrs:{"z-index":5e3,"on-close":()=>e.dialogVisible=!1,"url-list":[e.dialogImageUrl]}}):e._e()],1)},i=[],o=(n("5948"),n("e0bc"));function a(){return Object(o["a"])({url:"/comm/getUpToken",method:"post"})}var s=n("4008"),l={name:"uploadImage",model:{prop:"fileValue",event:"update:fileValue"},props:{fileValue:[Array,String,File],limit:{type:Number,default:1}},data(){return{fileList:[],dialogImageUrl:"",dialogVisible:!1,disabled:!1,removeList:[],prev:""}},components:{"el-image-viewer":()=>n.e("chunk-2d0c9756").then(n.bind(null,"58da"))},created(){this.initImagePrev()},mounted(){},methods:{handleChange(e,t){const n=this.beforeUpload(t[t.length-1].raw);if(this.handleUpload(e),n)if(this.fileList=t,this.limit>1){const e=this.fileList.filter(e=>e.raw).map(e=>e.raw);this.$emit("update:fileValue",e)}else this.$emit("update:fileValue",this.fileList[0].raw);else this.fileList=[]},onRemove(){this.fileList=[],this.$emit("update:fileValue","")},handleRemove(e){e.id&&this.removeList.push(e.id);const t=this.fileList.findIndex(t=>t.uid===e.uid);-1!==t?this.fileList.splice(t,1):this.fileList=[],0!==this.fileList.length?this.limit>1?this.$emit("update:fileValue",this.fileList.map(e=>e.filePath)):this.$emit("update:fileValue",this.fileList[0].raw):this.$emit("update:fileValue","")},handlePictureCardPreview(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},beforeUpload(e){const t=["image/png","image/jpg","image/jpeg","image/gif"].includes(e.type),n=e.size/1024/1024<5;return t?n?(this.handleUpload(e),!1):(this.$message.warning("大小不能超过5M"),!1):(this.$message.warning("只能上传jpg/png文件"),!1)},async handleUpload(e){try{const t=await a(),n=s["a"](e,null,t.data.result);n.subscribe({next:void 0,error:()=>{this.$message.error("上传出错，请重新上传！")},complete:({key:e})=>{this.$message.success("上传成功！"),this.fileList.push({name:this.fileList.length+"",url:this.$envConfig.qiniuDomain+e}),this.$emit("update:fileValue",this.$envConfig.qiniuDomain+e)}})}catch(t){console.log(t)}},initImagePrev(){Array.isArray(this.fileValue)?this.fileList=this.fileValue:this.fileValue&&"string"===typeof this.fileValue?this.fileList=[{url:this.fileValue,name:"image01"}]:this.fileList=[]}},watch:{fileValue(){this.initImagePrev()}}},u=l,c=(n("26ab"),n("1805")),d=Object(c["a"])(u,r,i,!1,null,"5d9a21c5",null);t["a"]=d.exports},cc5b:function(e,t,n){"use strict";n("0838")},cf21:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}),t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,operates:e.operates,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange},scopedSlots:e._u([{key:"image",fn:function(e){return t("div",{},[e.row.image?t("el-image",{staticStyle:{width:"50px"},attrs:{src:e.row.image,"preview-src-list":[e.row.image]}}):t("span")],1)}}])}),t("add-dialog",{ref:"addDialog",on:{success:e.handleSuccess}}),t("detail-drawer",{ref:"drawerRef"}),t("refund",{ref:"refundRef",on:{success:e.handleSuccess}})],1)},i=[],o=(n("5948"),n("7591")),a=n("b775"),s=n("779e"),l=n("b893"),u=n("2a9b"),c={name:"canceledPage",components:{BasicTable:o["a"],addDialog:s["default"]},data(){return{loading:!1,categoryOptions:[],orderStatus:u["b"],filterOptions:{column:[{type:"select",label:"收款方式",value:"categoryId",labelKey:"name",valueKey:"id",options:[]},{type:"input",label:"订单号/交易号",value:"orderNum"},{type:"select",label:"收款状态",value:"collectionStatus",options:u["a"]},{type:"user",userType:0,label:"收款人",value:"profitAdId"},{type:"user",userType:1,label:"下单人",value:"vipAdId"},{type:"timeAll",label:["开始日期-开始","开始日期-结束"],value:"openTime"},{type:"timeAll",label:["结束日期-开始","结束日期-结束"],value:"endTime"},{type:"timeAll",label:["创建日期-开始","创建日期-结束"],value:"createTime"}]},filterData:{categoryId:"",orderNum:"",collectionStatus:"",profitAdId:"",openTime:[],endTime:[],createTime:[],vipAdId:""},table:{columns:[{id:1,prop:"orderNum",label:"订单号",minWidth:"200px"},{id:2,prop:"status",label:"订单状态",render:e=>{const t=this.orderStatus.find(t=>t.value==e.status);return t?t.label:""}},{id:3,prop:"courseName",label:"课程名称",minWidth:"150px"},{id:4,prop:"time",label:"开始/结束日期",minWidth:"200px",render:e=>e.startTime?`${Object(l["b"])(e.startTime,"yyyy-MM-dd")} 至 ${Object(l["b"])(e.endTime,"yyyy-MM-dd")}`:""},{id:5,prop:"collectionUnit",label:"收款单位"},{id:6,prop:"count",label:"数量"},{id:7,prop:"receivablePrice",label:"应收金额",minWidth:"100px"},{id:8,prop:"receivedPrice",label:"已收金额",minWidth:"100px"},{id:9,prop:"unReceivedPrice",label:"未收金额",minWidth:"100px"},{id:10,prop:"pendingTrialPrice",label:"待审金额",minWidth:"100px"},{id:11,prop:"invoicedPrice",label:"已开票金额",minWidth:"100px"},{id:12,prop:"vipName",label:"下单人",minWidth:"120px"},{id:13,prop:"collectionName",label:"收款人",minWidth:"100px"},{id:14,prop:"profitAdName",label:"销售人",minWidth:"100px"}],pageSize:20,currentPage:1,data:[],total:0},operates:[{key:"deatil",title:"详情",permission:"system/sysAdvertise/remove",btnStyle:"green",action:(e,t)=>{console.log(t),this.$refs.drawerRef.open(t)}},{key:"payoutDetail",title:"收款明细",btnStyle:"yellow",action:(e,t)=>{this.$router.push({path:this.$router.path,query:{type:2,orderNum:t.orderNum}})}},{key:"refund",title:"退款",permission:"system/sysCourseOrderBills/refundAdd",btnStyle:"red",action:(e,t)=>{console.log(t),this.$refs.refundRef.open(t)}}],headerOperates:[{key:"export",name:"导出",permission:"system/sysCourseOrderBills/cancelBillsListExport",action:()=>{this.handleExport()}}]}},created(){this.$route.query.orderNum&&(this.filterData.orderNum=this.$route.query.orderNum),this.getList(),this.getCategoryList()},methods:{handleExport(){this.$confirm("确定导出销售订单吗？导出的时候请等待页面下载自动开始，如果数据量大，可能会等待稍长时间，请不要关闭或者刷新页面","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$message.warning("请耐心等待，表格正在导出中......");const{openTime:e,endTime:t,createTime:n,...r}=this.filterData;a["a"].post({url:"/system/sysCourseOrderBills/cancelBillsListExport",params:{...r,openStartTime:e&&e.length>0?e[0]:"",openEndTime:e&&e.length>0?e[1]:"",createStartTime:n&&n.length>0?n[0]:"",createEndTime:n&&n.length>0?n[1]:"",endStartTime:t&&t.length>0?t[0]:"",endEndTime:t&&t.length>0?t[1]:""},success:e=>{let t=document.createElement("a");t.href="https://"+e,document.body.appendChild(t),t.click(),document.body.removeChild(t),this.$message.success("导出成功"),this.searchFilter()}})}).catch(()=>{this.$message.info("已取消导出")})},searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0;const{openTime:e,endTime:t,createTime:n,...r}=this.filterData;a["a"].post({url:"/system/sysCourseOrderBills/cancelBillsList",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,...r,openStartTime:e&&e.length>0?e[0]:"",openEndTime:e&&e.length>0?e[1]:"",createStartTime:n&&n.length>0?n[0]:"",createEndTime:n&&n.length>0?n[1]:"",endStartTime:t&&t.length>0?t[0]:"",endEndTime:t&&t.length>0?t[1]:""},success:e=>{this.table.data=e.list,this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1}})},getCategoryList(){a["a"].post({url:"/system/sysCategory/listNoPage",params:{type:3},success:e=>{this.filterOptions.column[0].options=e}})},handleSuccess(){this.getList()},handleDelete(e){this.$confirm("此操作将会删除该广告, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/system/sysAdvertise/remove",params:{id:e.id},success:e=>{this.$message.success(e),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},clearFilter(){this.filterData={categoryId:"",orderNum:"",courseName:"",collectionStatus:"",colectionName:"",time:[],vipName:""},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()}}},d=c,f=n("1805"),h=Object(f["a"])(d,r,i,!1,null,"3296c1e5",null);t["default"]=h.exports},d03e2:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:"退款","close-on-click-modal":!1,visible:e.addModifyVisible,width:"40%"},on:{"update:visible":function(t){e.addModifyVisible=t},close:e.close}},[t("el-form",{ref:"refundRef",attrs:{model:e.addData,rules:e.refundRule,"label-position":"right","label-width":"90px"}},[t("el-form-item",{attrs:{label:"退款方式:",prop:"categoryId"}},[t("jat-select",{attrs:{placeholder:"退款方式",clearable:""},model:{value:e.addData.categoryId,callback:function(t){e.$set(e.addData,"categoryId",t)},expression:"addData.categoryId"}},e._l(e.categoryOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"退款金额:",prop:"collectionMoney"}},[t("jat-input",{directives:[{name:"input",rawName:"v-input.float",value:2,expression:"2",modifiers:{float:!0}}],attrs:{placeholder:"请输入收款金额"},model:{value:e.addData.collectionMoney,callback:function(t){e.$set(e.addData,"collectionMoney",t)},expression:"addData.collectionMoney"}})],1),t("el-form-item",{attrs:{label:"收款备注:",prop:"remark"}},[t("jat-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入退款备注"},model:{value:e.addData.remark,callback:function(t){e.$set(e.addData,"remark",t)},expression:"addData.remark"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)],1)},i=[],o=n("b775"),a={components:{},data(){return{addModifyVisible:!1,dialogTitle:"",vipName:"",addData:{categoryId:"",collectionMoney:"",orderNum:"",remark:""},categoryOptions:[],refundRule:{categoryId:[{required:!0,message:"请选择退款方式",trigger:"blur"}],collectionMoney:[{required:!0,message:"请输入退款金额",trigger:"blur"}]}}},mounted(){this.getCategoryList()},methods:{open(e){const{orderNum:t}=e;this.addData.orderNum=t,this.addModifyVisible=!0},close(){this.$refs.refundRef&&this.$refs.refundRef.clearValidate(),this.addData={categoryId:"",collectionMoney:"",orderNum:"",remark:""},this.addModifyVisible=!1},getCategoryList(){o["a"].post({url:"/system/sysCategory/listNoPage",params:{type:3},success:e=>{this.categoryOptions=e}})},handleSubmit(){this.$refs.refundRef.validate(e=>{e&&o["a"].post({url:"/system/sysCourseOrderBills/refundAdd",params:this.addData,success:e=>{this.$message.success(e),this.close(),this.$emit("success")}})})}}},s=a,l=n("1805"),u=Object(l["a"])(s,r,i,!1,null,"72e47ed8",null);t["default"]=u.exports},d059:function(e,t,n){"use strict";n("bd28")},d167:function(e,t,n){"use strict";n("48ef")},d17b:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return s}));const r=[{value:0,label:"首页公开课推荐"},{value:1,label:"首页vip课推荐"},{value:2,label:"首页直播课推荐"}],i=[{value:0,label:"套餐课程"},{value:1,label:"单品课程"},{value:2,label:"单品课程"}],o=[{value:0,label:"直播"},{value:1,label:"录播"}],a=[{value:0,label:"免费"},{value:1,label:"收费"}],s=[{value:0,label:"不展示"},{value:1,label:"展示"}]},d2f8:function(e,t,n){n("734a")},d3e4:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{ref:"filter",attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}),t("div",[t("div",{staticStyle:{"background-color":"#ffffff",height:"40px",color:"red",display:"flex","align-items":"center"}},[t("div",{staticStyle:{"margin-left":"20px"}},[e._v("总增加: "+e._s(e.calculate.totalDay)+" —— 当天增加："+e._s(e.calculate.toDay))])]),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:e.tableData,"span-method":e.objectSpanMethod,border:"","cell-style":e.cellStyle,"header-cell-style":e.headerCellClassName,size:"mini"}},[t("el-table-column",{attrs:{prop:"profitName",label:"销售员",width:"180"}}),t("el-table-column",{attrs:{prop:"adName",width:"150",label:"推广员"}}),t("el-table-column",{attrs:{prop:"todayCount",label:"当天增加"}}),t("el-table-column",{attrs:{prop:"todayTotalCount",label:"当天增加总和"}}),t("el-table-column",{attrs:{prop:"count",label:"总数量"}}),t("el-table-column",{attrs:{label:"操作"}})],1),t("jat-pagination",e._g(e._b({staticStyle:{margin:"20px 0",padding:"0"},attrs:{layout:e.getWidth<=479?"total, prev, next, jumper":"total, sizes, ->, prev, pager, next, jumper",total:e.totalRecords,"page-size":e.filterData.pageSize},on:{"current-change":e.handlePageChange}},"jat-pagination",e.$attrs,!1),e.$listeners))],1)],1)},i=[],o=(n("5948"),n("b775")),a={name:"eatEua",data(){return{params:{},totalData:"",loading:!1,tableData:[],pagedData:[],totalRecords:100,filterOptions:{column:[{type:"timeAll",label:["开始时间","结束时间"],value:"time"}]},calculate:{totalDay:"",toDay:""},filterData:{time:[],totalPage:10,pageNo:1,pageSize:10}}},computed:{getWidth(){return window.innerWidth}},created(){this.getList()},methods:{getList(){this.loading=!0,o["a"].post({url:"/admin/adPromotionData/salesCapacityList",params:{pageNo:this.filterData.pageNo,pageSize:this.filterData.pageSize,startTime:null!=this.filterData.time?this.filterData.time[0]:"",endTime:null!=this.filterData.time?this.filterData.time[1]:""},success:e=>{this.tableData=[];let t=0,n=0;e.list.forEach(e=>{e.dataList.forEach(r=>{this.tableData.push({profitName:e.profitName,adName:r.dataName,todayCount:r.todayCount,todayTotalCount:e.todaySum,count:r.totalCount}),t+=r.totalCount,n+=parseInt(r.todayCount)})}),this.calculate.totalDay=t,this.calculate.toDay=n,this.totalRecords=e.total,this.loading=!1},catch:()=>{this.loading=!1}})},handlePageChange(e){this.filterData.pageNo=e,this.getList()},cellStyle(){return"border: 1px solid #167CF3; font-size: 15px"},headerCellClassName({column:e}){return"color: #fff; border: 1px solid #167CF3"},objectSpanMethod({row:e,column:t,rowIndex:n,columnIndex:r}){if(0===r||"todayTotalCount"===t.property){const t=this.getRowspan(e,n);return{rowspan:t,colspan:t>0?1:0}}},getRowspan(e,t){if(0===t||e.profitName!==this.tableData[t-1].profitName){let n=1;for(let r=t+1;r<this.tableData.length;r++){if(e.profitName!==this.tableData[r].profitName)break;n++}return n}return 0},clearFilter(){this.filterData.time=[],this.searchFilter()},searchFilter(){this.getList()}}},s=a,l=(n("b180"),n("1805")),u=Object(l["a"])(s,r,i,!1,null,"63670a14",null);t["default"]=u.exports},d51d:function(e,t,n){"use strict";n("b9d7")},d527:function(e,t,n){"use strict";n("873c")},d719:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.addModifyVisible,width:"40%"},on:{"update:visible":function(t){e.addModifyVisible=t},close:e.close}},[t("el-form",{ref:"categoryRef",attrs:{model:e.addData,rules:e.categoryRule,"label-position":"left","label-width":"90px"}},[t("el-form-item",{attrs:{label:"分类名称:",prop:"name"}},[t("jat-input",{attrs:{placeholder:"请输入分类名称"},model:{value:e.addData.name,callback:function(t){e.$set(e.addData,"name",t)},expression:"addData.name"}})],1),t("el-form-item",{attrs:{label:"父级名称:",prop:"parentId"}},[t("jat-select",{attrs:{placeholder:"请选择父级名称",clearable:""},model:{value:e.addData.parentId,callback:function(t){e.$set(e.addData,"parentId",t)},expression:"addData.parentId"}},[t("el-option",{attrs:{label:"顶级",value:-1}}),e._l(e.categoryOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],2)],1),t("el-form-item",{attrs:{label:"封面:",prop:"image"}},[t("uploadImage",{model:{value:e.addData.image,callback:function(t){e.$set(e.addData,"image",t)},expression:"addData.image"}})],1),t("el-form-item",{attrs:{label:"排序:",prop:"sort"}},[t("jat-input",{attrs:{placeholder:"请输入排序"},model:{value:e.addData.sort,callback:function(t){e.$set(e.addData,"sort",e._n(t))},expression:"addData.sort"}})],1),t("el-form-item",{attrs:{label:"SEO标题:",prop:"seoTitle"}},[t("jat-input",{attrs:{type:"textarea",row:4,placeholder:"请输入SEO标题"},model:{value:e.addData.seoTitle,callback:function(t){e.$set(e.addData,"seoTitle",t)},expression:"addData.seoTitle"}})],1),t("el-form-item",{attrs:{label:"SEO关键字:",prop:"seoKey"}},[t("jat-input",{attrs:{type:"textarea",row:4,placeholder:"请输入SEO关键字"},model:{value:e.addData.seoKey,callback:function(t){e.$set(e.addData,"seoKey",t)},expression:"addData.seoKey"}})],1),t("el-form-item",{attrs:{label:"SEO描述:",prop:"seoContent"}},[t("jat-input",{attrs:{type:"textarea",row:4,placeholder:"请输入SEO描述"},model:{value:e.addData.seoContent,callback:function(t){e.$set(e.addData,"seoContent",t)},expression:"addData.seoContent"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)],1)},i=[],o=n("cbc3"),a=n("b775"),s={components:{uploadImage:o["a"]},data(){return{addModifyVisible:!1,addInterfaceVisible:!1,dialogTitle:"",categoryOptions:[],addData:{name:"",parentId:"",image:"",sort:void 0,seoTitle:"",seoKey:"",seoContent:"",id:""},categoryRule:{name:[{required:!0,message:"请输入分类名称",trigger:"blur"}],parentId:[{required:!0,message:"请选择父级名称",trigger:"blur"}]}}},mounted(){},methods:{open(e){this.dialogTitle="添加分类",this.addData.name="",this.addModifyVisible=!0,e&&(this.addData.parentId=e.id),this.getNewCategoryList()},edit({id:e,name:t,parentId:n,sort:r,image:i,seoContent:o,seoKey:a,seoTitle:s}){this.dialogTitle="编辑分类",this.addModifyVisible=!0,this.addData={id:e,name:t,parentId:n,sort:r,image:i,seoContent:o,seoKey:a,seoTitle:s},this.getNewCategoryList()},close(){this.$refs.categoryRef&&this.$refs.categoryRef.clearValidate(),this.addModifyVisible=!1,this.addData={name:"",parentId:"",image:"",sort:void 0,seoTitle:"",seoKey:"",seoContent:"",id:""}},handleSubmit(){this.$refs.categoryRef.validate(e=>{e&&(this.addData.id?a["a"].post({url:"/system/sysNewsCategory/edit",params:{...this.addData},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}):a["a"].post({url:"/system/sysNewsCategory/add",params:this.addData,success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}))})},getNewCategoryList(){a["a"].post({url:"/system/sysNewsCategory/listNoPage",params:{...this.addData},success:e=>{this.categoryOptions=e.filter(e=>-1==e.parentId)}})}}},l=s,u=n("1805"),c=Object(u["a"])(l,r,i,!1,null,"fdbd7ae0",null);t["default"]=c.exports},d73b:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{ref:"filter",attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}),t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange}})],1)},i=[],o=n("7591"),a=n("b775"),s=n("b893"),l={name:"personPerformance",components:{BasicTable:o["a"]},data(){return{loading:!1,categoryOptions:[],filterOptions:{column:[{type:"cascader",label:"部门",value:"departmentId",ref:"departmentRef",options:[],props:{value:"id",label:"name",multiple:!0}},{type:"timeAll",label:["开始日期","结束日期"],value:"time",clearable:!1}]},categoryOptions:[],filterData:{departmentId:"",time:[this.$moment().startOf("month").format("YYYY-MM-DD"),this.$moment().endOf("month").format("YYYY-MM-DD")]},table:{columns:[{id:1,prop:"departmentName",label:"部门名称"},{id:2,prop:"receivable",label:"应收"},{id:4,prop:"received",label:"已收"},{id:5,prop:"unReceived",label:"未收"},{id:6,prop:"orderCount",label:"订单数"},{id:7,prop:"unreportedOrder",label:"未入账订单"}],pageSize:20,currentPage:1,data:[],total:0},operates:[],headerOperates:[{key:"export",name:"导出",permission:"system/sysCourseOrderBills/departmentalPerformanceStatisticsListExport",action:()=>{this.handleExport()}}]}},created(){this.getDepartmentList(),this.getList(),console.log(this.startTime)},methods:{handleExport(){this.$confirm("确定导出部门业绩统计列表吗？导出的时候请等待页面下载自动开始，如果数据量大，可能会等待稍长时间，请不要关闭或者刷新页面","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$message.warning("请耐心等待，表格正在导出中......");const{time:e,...t}=this.filterData;a["a"].post({url:"/system/sysCourseOrderBills/departmentalPerformanceStatisticsListExport",params:{createTimeSt:e[0],createTimeEt:e[1],...t},success:e=>{let t=document.createElement("a");t.href="https://"+e,document.body.appendChild(t),t.click(),document.body.removeChild(t),this.$message.success("导出成功"),this.searchFilter()}})}).catch(()=>{this.$message.info("已取消导出")})},searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0;const{time:e,...t}=this.filterData;this.$nextTick(()=>{const n=this.$refs.filter.$refs.departmentRef[0].getCheckedNodes().map(e=>e.data.id);a["a"].post({url:"/system/sysCourseOrderBills/departmentalPerformanceStatisticsList",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,createTimeSt:e[0],createTimeEt:e[1],...t,departmentId:n&&n.length>0?JSON.stringify(n):""},success:e=>{this.table.data=e.list,this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1}})})},handleDelete(e){this.$confirm("此操作将会删除该新闻, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/system/sysNews/remove",params:{id:e.id},success:e=>{this.$message.success(e),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},getDepartmentList(){a["a"].post({url:"/admin/adInfo/canChooseCanSeeDepartmentList",params:{id:sessionStorage.getItem("id")},success:e=>{this.departmentList=e,this.filterOptions.column[0].options=Object(s["c"])(e)}})},clearFilter(){this.filterData={profitAdId:"",departmentId:"",time:[this.$moment().startOf("month").format("YYYY-MM-DD"),this.$moment().endOf("month").format("YYYY-MM-DD")]},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()}}},u=l,c=n("1805"),d=Object(c["a"])(u,r,i,!1,null,"ed7b8b68",null);t["default"]=d.exports},d73c:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{ref:"filter",attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}),t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange}})],1)},i=[],o=n("7591"),a=n("b775"),s=n("b893"),l={name:"personPerformance",components:{BasicTable:o["a"]},data(){return{loading:!1,categoryOptions:[],filterOptions:{column:[{type:"input",label:"课程编号",value:"number"},{type:"user",userType:0,label:"销售员",value:"profitAdId"},{type:"cascader",label:"部门",value:"departmentId",ref:"departmentRef",options:[],props:{value:"id",label:"name",multiple:!0}},{type:"timeAll",label:["开始日期","结束日期"],value:"time",clearable:!1}]},filterData:{profitAdId:"",departmentId:"",time:[]},table:{columns:[{id:1,prop:"courseName",label:"课程名称"},{id:2,prop:"courseNum",label:"课程编号"},{id:4,prop:"totalCount",label:"总数量"},{id:5,prop:"totalProfit",label:"总收入"}],pageSize:20,currentPage:1,data:[],total:0},operates:[],headerOperates:[{key:"export",name:"导出",permission:"system/sysCourseOrderBills/coursePerformanceStatisticsExport",action:()=>{this.handleExport()}}]}},created(){this.getDepartmentList(),this.getList()},methods:{handleExport(){this.$confirm("确定导出课程业绩统计列表吗？导出的时候请等待页面下载自动开始，如果数据量大，可能会等待稍长时间，请不要关闭或者刷新页面","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$message.warning("请耐心等待，表格正在导出中......");const{time:e,...t}=this.filterData;a["a"].post({url:"/system/sysCourseOrderBills/coursePerformanceStatisticsExport",params:{startTime:e&&e.length>1?e[0]:"",endTime:e&&e.length>1?e[1]:"",...t},success:e=>{let t=document.createElement("a");t.href="https://"+e,document.body.appendChild(t),t.click(),document.body.removeChild(t),this.$message.success("导出成功"),this.searchFilter()}})}).catch(()=>{this.$message.info("已取消导出")})},searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0;const{time:e,...t}=this.filterData;this.$nextTick(()=>{const n=this.$refs.filter.$refs.departmentRef[0].getCheckedNodes().map(e=>e.data.id);a["a"].post({url:"/system/sysCourseOrderBills/coursePerformanceStatistics",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,startTime:e&&e.length>1?e[0]:"",endTime:e&&e.length>1?e[1]:"",...t,departmentId:n&&n.length>0?JSON.stringify(n):""},success:e=>{this.table.data=e,this.table.total=e.length,this.loading=!1},catch:()=>{this.loading=!1}})})},handleDelete(e){this.$confirm("此操作将会删除该新闻, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/system/sysNews/remove",params:{id:e.id},success:e=>{this.$message.success(e),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},getDepartmentList(){a["a"].post({url:"/admin/adInfo/canChooseCanSeeDepartmentList",params:{id:sessionStorage.getItem("id")},success:e=>{this.filterOptions.column[2].options=Object(s["c"])(e)}})},clearFilter(){this.filterData={profitAdId:"",departmentId:"",number:"",time:[]},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()}}},u=l,c=n("1805"),d=Object(c["a"])(u,r,i,!1,null,"5617a08c",null);t["default"]=d.exports},d782:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.addModifyVisible,width:"50%"},on:{"update:visible":function(t){e.addModifyVisible=t},close:e.close}},[t("el-form",{ref:"channelRef",attrs:{model:e.addData,rules:e.channelRules,"label-position":"left","label-width":"90px"}},[t("el-form-item",{attrs:{label:"渠道名称:",prop:"name"}},[t("jat-input",{attrs:{placeholder:"请输入名称"},model:{value:e.addData.name,callback:function(t){e.$set(e.addData,"name",t)},expression:"addData.name"}})],1),t("el-form-item",{attrs:{label:"渠道管理员:",prop:"adId","label-width":"100px"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",clearable:"",filterable:"",remote:"",placeholder:"渠道管理员可以在渠道统计列表看到该渠道和该渠道的数据,其他人都无法看到","remote-method":t=>e.remoteMethod(t,0),loading:e.remoteLoading},model:{value:e.addData.adId,callback:function(t){e.$set(e.addData,"adId",t)},expression:"addData.adId"}},e._l(e.userAdminOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"头像:",prop:"image"}},[t("upload-image",{model:{value:e.addData.image,callback:function(t){e.$set(e.addData,"image",t)},expression:"addData.image"}})],1),t("el-form-item",{attrs:{label:"渠道公告:",prop:"content"}},[t("jat-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入渠道公告"},model:{value:e.addData.content,callback:function(t){e.$set(e.addData,"content",t)},expression:"addData.content"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)],1)},i=[],o=n("cbc3"),a=n("b775"),s={components:{uploadImage:o["a"]},data(){return{addModifyVisible:!1,dialogTitle:"",userAdminOptions:[],remoteLoading:!1,addData:{id:"",name:"",adId:"",content:"",image:""},categoryOptions:[],channelRules:{name:[{required:!0,message:"请输入渠道名称",trigger:"blur"}],adId:[{required:!0,message:"请选择渠道管理员",trigger:"blur"}]}}},mounted(){},methods:{open(){this.dialogTitle="增加推广渠道",this.addModifyVisible=!0},edit({id:e,name:t,adId:n,adName:r,image:i,content:o}){this.dialogTitle="编辑推广渠道",this.addModifyVisible=!0,this.addData={id:e,adId:n,name:t,adName:r,image:i,content:o},this.userAdminOptions=[{id:n,name:r}]},close(){this.$refs.channelRef&&this.$refs.channelRef.clearValidate(),this.addData={id:"",name:"",adId:"",content:"",image:""},this.addModifyVisible=!1},remoteMethod(e,t){e&&(this.remoteLoading=!0,a["a"].post({url:"/admin/adInfo/queryAdminByNameOrPhone",params:{search:e,type:t},success:e=>{this.remoteLoading=!1,0===t?this.userAdminOptions=e:this.userAllOptions=e},catch:()=>{this.remoteLoading=!1}}))},handleSubmit(){this.$refs.channelRef.validate(e=>{if(e){const{id:e,...t}=this.addData;e?a["a"].post({url:"/admin/adPromotionChannel/edit",params:{id:e,...t},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}):a["a"].post({url:"/admin/adPromotionChannel/add",params:{...t},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}})}})}}},l=s,u=n("1805"),c=Object(u["a"])(l,r,i,!1,null,"a85c1a8e",null);t["default"]=c.exports},d8a7:function(e,t,n){},d946:function(e,t,n){},db9d:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}),t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,operates:e.operates,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange}}),t("add-dialog",{ref:"addDialog",on:{success:e.handleSuccess}})],1)},i=[],o=n("7591"),a=n("b775"),s=n("1d0e"),l={name:"courseWorkPage",components:{BasicTable:o["a"],addDialog:s["default"]},data(){return{loading:!1,categoryOptions:[],filterOptions:{column:[{type:"input",label:"课程名称",value:"courseName"}]},filterData:{courseName:""},table:{columns:[{id:1,prop:"workName",label:"作业名称",width:"180px"},{id:2,prop:"courseName",label:"课程名称",width:"180px"},{id:3,prop:"chapterName",label:"章节名称",width:"180px"},{id:5,type:"image",prop:"caseUrl",label:"作业案例展示图",width:"180px"},{id:6,prop:"count",label:"作业提交人数"},{id:7,prop:"teacherName",label:"老师名称",width:"180px"},{id:8,prop:"createTime",label:"创建时间",type:"date",width:"180px"},{id:9,prop:"cutOffTime",label:"提交截止时间",type:"date",width:"180px"}],pageSize:20,currentPage:1,data:[],total:0},operates:[{key:"edit",title:"编辑",permission:"admin/adCourseWork/edit",btnStyle:"yellow",action:(e,t)=>{this.$refs.addDialog.edit(t)}},{key:"delete",title:"删除",permission:"admin/adCourseWork/remove",btnStyle:"red",action:(e,t)=>{this.handleDelete(t)}}],headerOperates:[]}},created(){this.getList()},methods:{searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0,a["a"].post({url:"/admin/adCourseWork/list",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize},success:e=>{this.table.data=e.list,this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1}})},handleSuccess(){this.getList()},handleDelete(e){console.log("row:",e),this.$confirm("此操作将会删除该作业, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/admin/adCourseWork/remove",params:{id:e.workId},success:e=>{this.$message.success(e),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},clearFilter(){this.filterData={courseName:""},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()}}},u=l,c=n("1805"),d=Object(c["a"])(u,r,i,!1,null,"7f653af0",null);t["default"]=d.exports},dd75:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}),t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,operates:e.operates,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange},scopedSlots:e._u([{key:"image",fn:function(e){return t("div",{},[e.row.image?t("el-image",{staticStyle:{width:"50px"},attrs:{src:e.row.image,"preview-src-list":[e.row.image]}}):t("span")],1)}}])}),t("create-collection-dialog",{ref:"collectionRef",on:{success:e.handleSuccess}}),t("add-dialog",{ref:"addDialog",on:{success:e.handleSuccess}}),t("detail-drawer",{ref:"drawerRef"}),t("refund",{ref:"refundRef",on:{success:e.handleSuccess}})],1)},i=[],o=(n("5948"),n("7591")),a=n("b775"),s=n("779e"),l=n("b893"),u=n("2a9b"),c=n("a0f2"),d=n("d03e2"),f=n("29ed"),h={name:"outstandingChargesPage",components:{BasicTable:o["a"],addDialog:s["default"],DetailDrawer:c["default"],refund:d["default"],createCollectionDialog:f["default"]},data(){return{loading:!1,categoryOptions:[],orderStatus:u["b"],filterOptions:{column:[{type:"select",label:"收款方式",value:"categoryId",labelKey:"name",valueKey:"id",options:[]},{type:"input",label:"订单号/交易号",value:"orderNum"},{type:"select",label:"收款状态",value:"collectionStatus",options:u["a"]},{type:"user",userType:0,label:"收款人",value:"profitAdId"},{type:"user",userType:1,label:"下单人",value:"vipAdId"},{type:"timeAll",label:["开始日期-开始","开始日期-结束"],value:"openTime"},{type:"timeAll",label:["结束日期-开始","结束日期-结束"],value:"endTime"},{type:"timeAll",label:["创建日期-开始","创建日期-结束"],value:"createTime"}]},filterData:{categoryId:"",orderNum:"",collectionStatus:"",profitAdId:"",openTime:[],endTime:[],createTime:[],vipAdId:""},table:{columns:[{id:1,prop:"orderNum",label:"订单号",width:"200px"},{id:2,prop:"status",label:"订单状态",render:e=>{const t=this.orderStatus.find(t=>t.value==e.status);return t?t.label:""},width:"80px"},{id:3,prop:"courseName",label:"课程名称",minWidth:"150px"},{id:4,prop:"time",label:"开始/结束日期",render:e=>e.startTime?`${Object(l["b"])(e.startTime,"yyyy-MM-dd")} 至 ${Object(l["b"])(e.endTime,"yyyy-MM-dd")}`:"",width:"200px"},{id:5,prop:"collectionUnit",label:"收款单位",width:"80px"},{id:6,prop:"count",label:"数量",width:"80px"},{id:7,prop:"receivablePrice",label:"应收金额",width:"80px"},{id:8,prop:"receivedPrice",label:"已收金额",width:"80px"},{id:9,prop:"unReceivedPrice",label:"未收金额",width:"80px"},{id:10,prop:"pendingTrialPrice",label:"待审金额",width:"80px"},{id:11,prop:"invoicedPrice",label:"已开票金额",width:"100px"},{id:12,prop:"vipName",label:"下单人",width:"120px"},{id:13,prop:"collectionName",label:"收款人",width:"80px"},{id:14,prop:"profitAdName",label:"销售人",width:"80px"}],pageSize:20,currentPage:1,data:[],total:0},operates:[{key:"deatil",title:"详情",permission:"system/sysAdvertise/remove",btnStyle:"green",action:(e,t)=>{console.log(t),this.$refs.drawerRef.open(t)}},{key:"payoutDetail",title:"收款明细",btnStyle:"yellow",action:(e,t)=>{this.$router.push({path:this.$router.path,query:{type:2,orderNum:t.orderNum}})}},{key:"payment",title:"领款",permission:"system/sysAdvertise/remove",btnStyle:"green",action:(e,t)=>{this.$refs.collectionRef.open(t.orderNum,"领款",t.collectionName)}},{key:"refund",title:"退款",permission:"system/sysCourseOrderBills/refundAdd",btnStyle:"red",action:(e,t)=>{this.$refs.refundRef.open(t)}}],headerOperates:[{key:"export",name:"导出",permission:"system/sysCourseOrderBills/outstandingAccountsListExport",action:()=>{this.handleExport()}}]}},created(){this.$route.query.orderNum&&(this.filterData.orderNum=this.$route.query.orderNum),this.getList(),this.getCategoryList()},methods:{handleExport(){this.$confirm("确定导出未结清订单列表吗？导出的时候请等待页面下载自动开始，如果数据量大，可能会等待稍长时间，请不要关闭或者刷新页面","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$message.warning("请耐心等待，表格正在导出中......");const{openTime:e,endTime:t,createTime:n,...r}=this.filterData;a["a"].post({url:"/system/sysCourseOrderBills/outstandingAccountsListExport",params:{...r,openStartTime:e&&e.length>0?e[0]:"",openEndTime:e&&e.length>0?e[1]:"",createStartTime:n&&n.length>0?n[0]:"",createEndTime:n&&n.length>0?n[1]:"",endStartTime:t&&t.length>0?t[0]:"",endEndTime:t&&t.length>0?t[1]:""},success:e=>{let t=document.createElement("a");t.href="https://"+e,document.body.appendChild(t),t.click(),document.body.removeChild(t),this.$message.success("导出成功"),this.searchFilter()}})}).catch(()=>{this.$message.info("已取消导出")})},searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0;const{openTime:e,endTime:t,createTime:n,...r}=this.filterData;a["a"].post({url:"/system/sysCourseOrderBills/outstandingAccountsList",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,...r,openStartTime:e&&e.length>0?e[0]:"",openEndTime:e&&e.length>0?e[1]:"",createStartTime:n&&n.length>0?n[0]:"",createEndTime:n&&n.length>0?n[1]:"",endStartTime:t&&t.length>0?t[0]:"",endEndTime:t&&t.length>0?t[1]:""},success:e=>{this.table.data=e.list,this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1}})},getCategoryList(){a["a"].post({url:"/system/sysCategory/listNoPage",params:{type:3},success:e=>{this.filterOptions.column[0].options=e}})},handleSuccess(){this.getList()},handleDelete(e){this.$confirm("此操作将会删除该广告, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/system/sysAdvertise/remove",params:{id:e.id},success:e=>{this.$message.success(e),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},clearFilter(){this.filterData={categoryId:"",orderNum:"",courseName:"",collectionStatus:"",colectionName:"",time:[],vipName:""},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()}}},m=h,p=n("1805"),g=Object(p["a"])(m,r,i,!1,null,"748370b1",null);t["default"]=g.exports},de3d:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return s}));const r=[{value:0,label:"首页公开课推荐"},{value:1,label:"首页vip课推荐"},{value:2,label:"首页直播课推荐"}],i=[{value:0,label:"套餐课程"}],o=[{value:0,label:"直播"},{value:1,label:"录播"}],a=[{value:0,label:"免费"},{value:1,label:"收费"}],s=[{value:0,label:"不展示"},{value:1,label:"展示"}]},dffa:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.addModifyVisible,"append-to-body":!0,width:"50%"},on:{"update:visible":function(t){e.addModifyVisible=t},close:e.close}},[t("el-form",{ref:"workRef",attrs:{model:e.addData,rules:e.workRule,"label-position":"left","label-width":"120px"}},[t("el-form-item",{attrs:{label:"作业标题:",prop:"workName"}},[t("jat-input",{attrs:{placeholder:"请输入作业标题"},model:{value:e.addData.workName,callback:function(t){e.$set(e.addData,"workName",t)},expression:"addData.workName"}})],1),t("el-form-item",{attrs:{label:"案例展示图:",prop:"caseUrl"}},[t("upload-image",{model:{value:e.addData.caseUrl,callback:function(t){e.$set(e.addData,"caseUrl",t)},expression:"addData.caseUrl"}})],1),t("el-form-item",{attrs:{label:"提交截止时间:",prop:"cutOffTime"}},[t("jat-date-picker",{attrs:{clearable:"",type:"date",width:"100%",placeholder:"请选择提交截止时间"},model:{value:e.addData.cutOffTime,callback:function(t){e.$set(e.addData,"cutOffTime",t)},expression:"addData.cutOffTime"}})],1),t("el-form-item",{attrs:{label:"附件:",prop:"material"}},[t("uploadFile",{attrs:{limit:1},model:{value:e.addData.material,callback:function(t){e.$set(e.addData,"material",t)},expression:"addData.material"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)],1)},i=[],o=n("cbc3"),a=n("b775"),s=n("9adf"),l=n("c46c"),u={name:"addCourseWork",components:{uploadImage:o["a"],tinymceEdit:s["a"],uploadFile:l["a"]},data(){return{addModifyVisible:!1,dialogTitle:"",addData:{chapterId:"",cutOffTime:"",workName:"",caseUrl:"",material:[]},workRule:{cutOffTime:[{required:!0,message:"请选择提交截止时间",trigger:"blur"}],workName:[{required:!0,message:"请输入作者名称",trigger:"blur"}]}}},mounted(){},methods:{open(e){this.dialogTitle="布置作业-"+e.name,this.addData.chapterId=e.id,this.addModifyVisible=!0},close(){this.$refs.workRef&&this.$refs.workRef.clearValidate(),this.addData={chapterId:"",cutOffTime:"",workName:"",caseUrl:"",material:[]},this.addModifyVisible=!1},handleSubmit(){this.$refs.workRef.validate(e=>{if(e){const{material:e,...t}=this.addData;a["a"].post({url:"admin/adCourseWork/add",params:{...t,material:e&&e.length>0?e[0].url:""},success:e=>{this.$message.success("布置成功！可在课程作业中查看"),this.close(),this.$emit("success")}})}})}}},c=u,d=n("1805"),f=Object(d["a"])(c,r,i,!1,null,"2e65f1b5",null);t["default"]=f.exports},e2e3:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"middle-container"},[t("div",{staticClass:"header-box"},[e.headerTab.length>0?t("div",{staticClass:"BasicInfo_title"},e._l(e.headerTab,(function(n){return t("div",{directives:[{name:"permission",rawName:"v-permission",value:n.permission,expression:"tab.permission"}],key:n.id,staticClass:"item",class:{is_active:n.isChecked},on:{click:function(t){return e.handleTabSelect(n)}}},[t("span",{class:"tab_"+n.id},[e._v(e._s(n.name))])])})),0):e._e()]),t(e.currentComponet,{tag:"component"})],1)},i=[],o=n("db9d"),a=n("e931"),s={name:"courseWork",components:{courseWorkList:o["default"],submittedWork:a["default"]},data(){return{currentComponet:o["default"],headerTab:[{id:1,name:"课程作业",component:o["default"],isChecked:!0,permission:"admin/adCourseWork/list"},{id:2,name:"作业提交列表",component:a["default"],isChecked:!1,permission:"admin/adCourseWorkSubmit/list"}]}},mounted(){this.init()},methods:{handleTabSelect(e,t){e.id==this.$route.query.type&&e.isChecked||(this.headerTab.forEach(t=>{t.isChecked=t.id==e.id}),t||this.$router.replace({path:this.$router.path,query:{type:e.id}}),this.currentComponet=e.component)},init(){const e=this.$route.query.type;if(e){const t=document.querySelector(".tab_"+e);if(!t){const e=this.headerTab.find(e=>e.isChecked);return void this.$router.replace({path:this.$router.path,query:{type:e.id}})}const n=this.headerTab.find(t=>t.id==e);n&&this.handleTabSelect(n,!0)}else this.$router.replace({path:this.$router.path,query:{type:1}})}},watch:{"$route.query.orderNum":function(e){e&&this.init()},"$route.query.type":function(e){e&&this.init()}}},l=s,u=(n("cc5b"),n("1805")),c=Object(u["a"])(l,r,i,!1,null,"4ef74708",null);t["default"]=c.exports},e4b8:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,operates:e.operates,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange},scopedSlots:e._u([{key:"image",fn:function(e){return t("div",{},[e.row.image?t("el-image",{staticStyle:{width:"50px"},attrs:{src:e.row.image,"preview-src-list":[e.row.image]}}):t("span")],1)}}])}),t("add-dialog",{ref:"addDialog",on:{success:e.handleSuccess}})],1)},i=[],o=n("7591"),a=n("b775"),s=n("d782"),l={name:"channelPage",components:{BasicTable:o["a"],addDialog:s["default"]},data(){return{loading:!1,categoryOptions:[],table:{columns:[{id:2,prop:"name",label:"渠道名称"},{id:3,prop:"adName",label:"渠道管理员"},{id:4,prop:"content",label:"渠道公告"},{id:5,prop:"createName",label:"创建人"},{id:6,prop:"createTime",label:"创建时间",type:"date",width:"200px"}],pageSize:20,currentPage:1,data:[],total:0},operates:[{key:"edit",title:"编辑",permission:"admin/adPromotionChannel/edit",btnStyle:"yellow",action:(e,t)=>{this.$refs.addDialog.edit(t)}},{key:"delete",title:"删除",permission:"admin/adPromotionChannel/remove",btnStyle:"red",action:(e,t)=>{this.handleDelete(t)}}],headerOperates:[{key:"el-icon-plus",permission:"admin/adPromotionChannel/add",name:"增加推广渠道",action:()=>{this.$refs.addDialog.open()}}]}},created(){this.getList()},methods:{searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0,a["a"].post({url:"/admin/adPromotionChannel/list",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,...this.filterData},success:e=>{this.table.data=e.list,this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1}})},handleSuccess(){this.getList()},handleDelete(e){this.$confirm("此操作将会删除该渠道, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/admin/adPromotionChannel/remove",params:{id:e.id},success:e=>{this.$message.success(e),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},clearFilter(){this.filterData={name:""},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()}}},u=l,c=(n("d51d"),n("1805")),d=Object(c["a"])(u,r,i,!1,null,"7b2a702a",null);t["default"]=d.exports},e621:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"webPage"},[t("el-form",{ref:"webSet",attrs:{"label-position":"right",rules:e.webRules,"label-width":"130px",disabled:!0,inline:!1,size:"small"}},e._l(e.formData,(function(n,r){return t("el-form-item",{key:n.name,class:{"w-full":[13,14].includes(r)},attrs:{label:n.name,prop:n.name}},[[13,14].includes(r)?t("tinymceEdit",{model:{value:n.value,callback:function(t){e.$set(n,"value",t)},expression:"item.value"}}):[3,5,11].includes(r)?t("upload-image",{model:{value:n.value,callback:function(t){e.$set(n,"value",t)},expression:"item.value"}}):t("jat-input",10===r?{attrs:{type:"textarea",rows:10},model:{value:n.value,callback:function(t){e.$set(n,"value",t)},expression:"item.value"}}:{model:{value:n.value,callback:function(t){e.$set(n,"value",t)},expression:"item.value"}})],1)})),1),t("div",{directives:[{name:"permission",rawName:"v-permission",value:"system/sysParam/editPlatformParams",expression:"'system/sysParam/editPlatformParams'"}],staticClass:"bottom_submit",on:{click:e.submitForm}},[t("jat-button",[e._v("保存")])],1)],1)},i=[],o=n("9adf"),a=n("cbc3"),s=(n("e0bc"),n("b775"));var l={components:{uploadImage:a["a"],tinymceEdit:o["a"]},data(){return{loading:!1,webData:{},webRules:{},formData:[]}},created(){this.getInfo()},methods:{getInfo(){this.loading=!0,s["a"].post({url:"/system/sysParam/platformParams",params:{},success:e=>{this.formData=e,this.loading=!1},catch:()=>{this.loading=!1}})},submitForm(){s["a"].post({url:"system/sysParam/editPlatformParams",params:{paramObjs:JSON.stringify(this.formData)},success:e=>{this.$message.success(e),this.getInfo()}})}}},u=l,c=(n("03ad"),n("1805")),d=Object(c["a"])(u,r,i,!1,null,"0cd58d82",null);t["default"]=d.exports},e6c3:function(e,t,n){},e723:function(e,t,n){e.exports=n.p+"static/img/yskt.40c285c0.png"},e790:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.addModifyVisible,width:"50%"},on:{"update:visible":function(t){e.addModifyVisible=t},close:e.close}},[t("el-form",{ref:"vipRef",attrs:{model:e.addData,rules:e.vipRule,"label-position":"right","label-width":"90px"}},[t("el-form-item",{attrs:{label:"昵称:",prop:"nick"}},[t("jat-input",{attrs:{placeholder:"请输入昵称"},model:{value:e.addData.nick,callback:function(t){e.$set(e.addData,"nick",t)},expression:"addData.nick"}})],1),t("el-form-item",{attrs:{label:"真实姓名:",prop:"name"}},[t("jat-input",{attrs:{placeholder:"请输入真实姓名"},model:{value:e.addData.name,callback:function(t){e.$set(e.addData,"name",t)},expression:"addData.name"}})],1),t("el-form-item",{attrs:{label:"联系电话:",prop:"phone"}},[t("jat-input",{attrs:{placeholder:"请输入联系电话"},model:{value:e.addData.phone,callback:function(t){e.$set(e.addData,"phone",t)},expression:"addData.phone"}})],1),t("el-form-item",{attrs:{label:"QQ:",prop:"qq"}},[t("jat-input",{attrs:{placeholder:"请输入QQ"},model:{value:e.addData.qq,callback:function(t){e.$set(e.addData,"qq",t)},expression:"addData.qq"}})],1),t("el-form-item",{attrs:{label:"微信:",prop:"wechatNum"}},[t("jat-input",{attrs:{placeholder:"请输入微信"},model:{value:e.addData.wechatNum,callback:function(t){e.$set(e.addData,"wechatNum",t)},expression:"addData.wechatNum"}})],1),t("el-form-item",{attrs:{label:"用户密码:",prop:"password"}},[t("jat-input",{attrs:{placeholder:"请输入用户密码，不填系统将会生成随机密码"},model:{value:e.addData.password,callback:function(t){e.$set(e.addData,"password",t)},expression:"addData.password"}})],1),t("el-form-item",{attrs:{label:"性别:",prop:"gender"}},[t("jat-select",{attrs:{placeholder:"请输入性别"},model:{value:e.addData.gender,callback:function(t){e.$set(e.addData,"gender",t)},expression:"addData.gender"}},[t("el-option",{attrs:{label:"男",value:1}}),t("el-option",{attrs:{label:"女",value:2}})],1)],1),t("el-form-item",{attrs:{label:"用户状态:",prop:"status"}},[t("jat-select",{attrs:{placeholder:"请选择用户状态，添加新会员请选择正常状态"},model:{value:e.addData.status,callback:function(t){e.$set(e.addData,"status",t)},expression:"addData.status"}},[t("el-option",{attrs:{label:"正常",value:0}}),t("el-option",{attrs:{label:"冻结",value:-1}}),t("el-option",{attrs:{label:"禁用",value:-2}}),t("el-option",{attrs:{label:"未审核",value:-3}})],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"账号信息","close-on-click-modal":!1,visible:e.accountVisible,width:"30%"},on:{"update:visible":function(t){e.accountVisible=t},close:e.handleClose}},[t("div",{staticClass:"tipInfo"},[e._v(" 同学这个是您的学习账号，你先收藏一下，方便后面听课 ")]),t("div",{staticClass:"account-box"},[t("span",{attrs:{id:"account"}},[e._v("账号："+e._s(e.accountInfo.account))]),t("span",{attrs:{id:"password"}},[e._v("密码："+e._s(e.accountInfo.password))])]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"})])],1)},i=[],o=(n("7cfc"),n("cbc3")),a=n("b775"),s=n("9adf"),l=(n("b893"),n("5258")),u=n("61f7"),c={components:{uploadImage:o["a"],tinymceEdit:s["a"]},data(){return{addModifyVisible:!1,dialogTitle:"",addData:{name:"",nick:"",phone:"",qq:"",wechatNum:"",password:"",gender:"",status:"",id:""},accountVisible:!1,accountInfo:{account:"",password:""},defaultProps:{label:"name",value:"id"},vipRule:{gender:[{required:!0,message:"请选择性别",trigger:"blur"}],name:[{required:!0,message:"请输入真实姓名",trigger:"blur"}],phone:[{required:!0,message:"请输入联系电话",trigger:"blur"},{validator:(e,t,n)=>{Object(u["b"])(t)?n():n(new Error("联系电话格式不正确"))},trigger:"blur"}],status:[{required:!0,message:"请选择用户状态",trigger:"blur"}]}}},mounted(){},methods:{open(){this.dialogTitle="添加会员",this.addModifyVisible=!0},edit({name:e,phone:t,qq:n,wechat:r,gender:i,nick:o,status:a,account:s,id:l}){this.dialogTitle="编辑会员",this.addData={name:e,phone:t,qq:n,wechatNum:r,password:"",gender:i,status:a,nick:o,account:s,id:l},this.addModifyVisible=!0},close(){this.$refs.vipRef&&this.$refs.vipRef.clearValidate(),this.addData={name:"",phone:"",qq:"",wechatNum:"",password:"",nick:"",gender:"",status:"",id:""},this.addModifyVisible=!1},handleSubmit(){this.$refs.vipRef.validate(e=>{const{password:t,...n}=this.addData;e&&(this.addData.id?a["a"].post({url:"/admin/adInfo/editVip",params:{...n,password:t?l["a"].encryptByPublicKey(t):""},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}):a["a"].post({url:"/admin/adInfo/addVip",params:{...n,password:t?l["a"].encryptByPublicKey(t):""},success:e=>{this.accountInfo=e,this.accountVisible=!0,this.$message.success("操作成功"),this.close(),this.$emit("success")}}))})},handleClose(){this.accountInfo={account:"",password:""}},onCopy(){this.$message.success("复制成功")}}},d=c,f=(n("bfde"),n("1805")),h=Object(f["a"])(d,r,i,!1,null,"9af7f4ec",null);t["default"]=h.exports},e7fd:function(e,t,n){},e931:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}),t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,operates:e.operates,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange}}),t("add-dialog",{ref:"addDialog",on:{success:e.handleSuccess}}),t("auditWork",{ref:"audit"}),t("submittedWorkDetail",{ref:"submittedDetail",on:{success:e.handleSuccess}})],1)},i=[],o=n("7591"),a=n("b775"),s=n("1d0e"),l=n("a2f0"),u=n("6a2e"),c={name:"courseWorkPage",components:{BasicTable:o["a"],addDialog:s["default"],auditWork:l["default"],submittedWorkDetail:u["default"]},data(){return{loading:!1,categoryOptions:[],filterOptions:{column:[{type:"input",label:"课程名称",value:"courseName"},{type:"user",userType:1,label:"下单人",value:"vipId"}]},filterData:{courseName:""},table:{columns:[{id:1,prop:"workName",label:"作业名称",width:"180px"},{id:2,prop:"courseName",label:"课程名称",width:"180px"},{id:3,prop:"chapterName",label:"章节名称",width:"180px"},{id:5,type:"image",prop:"caseUrl",label:"作业案例展示图",width:"180px"},{id:6,prop:"vipName",label:"学员名称"},{id:7,prop:"teacherName",label:"老师名称"},{id:8,prop:"subWorkName",label:"作业标题",width:"180px"},{id:10,prop:"status",label:"状态",render:e=>0==e.status?"正常":-1==e.status?"待审核":""},{id:11,prop:"createTime",label:"创建时间",type:"date",width:"180px"},{id:12,prop:"cutOffTime",label:"提交截止时间",type:"date",width:"180px"}],pageSize:20,currentPage:1,data:[],total:0},operates:[{key:"audit",title:"审核",permission:"admin/adCourseWorkSubmit/auditWorkEdit",btnStyle:"yellow",action:(e,t)=>{this.$refs.audit.open(t)}},{key:"detail",title:"详情",permission:"",btnStyle:"green",action:(e,t)=>{this.$refs.submittedDetail.open(t)}}],headerOperates:[]}},created(){this.getList()},methods:{searchFilter(){this.table.currentPage=1,this.getList()},getList(){const{...e}=this.filterData;this.loading=!0,a["a"].post({url:"/admin/adCourseWorkSubmit/list",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,...e},success:e=>{this.table.data=e.list,this.table.data.forEach(e=>{if(e.workUrl){let t=e.workUrl.replace(/\\(.)/gm,"$1");e.workUrl=JSON.parse(t)}}),console.log("data:",this.table.data),this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1}})},handleSuccess(){this.getList()},handleDelete(e){this.$confirm("此操作将会删除该作业, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/admin/adCourseWork/remove",params:{id:e.id},success:e=>{this.$message.success(e),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},clearFilter(){this.filterData={courseName:""},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()}}},d=c,f=n("1805"),h=Object(f["a"])(d,r,i,!1,null,"4a41ab68",null);t["default"]=h.exports},e9c0:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}),t("BasicTable",{attrs:{columns:e.table.columns,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange}})],1)},i=[],o=n("7591"),a=n("b775"),s={name:"logPage",components:{BasicTable:o["a"]},data(){return{categoryOptions:[],loading:!1,filterOptions:{column:[{type:"input",label:"日志内容",value:"interfaceName"}]},filterData:{interfaceName:""},table:{columns:[{id:1,prop:"interfaceName",label:"日志内容"},{id:2,prop:"adName",label:"操作人"},{id:3,prop:"createTime",label:"操作时间",type:"date"}],pageSize:20,currentPage:1,data:[],total:0}}},created(){this.getList()},methods:{searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0,a["a"].post({url:"/system/sysLog/list",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,...this.filterData},success:e=>{this.table.data=e.list,this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1}})},clearFilter(){this.filterData={name:""},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()}}},l=s,u=(n("fc92"),n("1805")),c=Object(u["a"])(l,r,i,!1,null,"79e28df6",null);t["default"]=c.exports},e9eb:function(e,t,n){n("3e22")},ecc2:function(e,t,n){"use strict";n("bf16")},ed2b:function(e,t,n){"use strict";n("a140")},ee0e:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.addModifyVisible,width:"70%"},on:{"update:visible":function(t){e.addModifyVisible=t},close:e.close}},[t("el-form",{ref:"clientRef",staticClass:"course-form-box",attrs:{model:e.addData,rules:e.clientRule,"label-position":"top","label-width":"150px"}},[t("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"套餐分类",prop:"course"}},[t("jat-select",{attrs:{placeholder:"请选择产品编号/产品名称","value-key":"id",clearable:""},on:{change:e.handleCategoryChange},model:{value:e.addData.courseName,callback:function(t){e.$set(e.addData,"courseName",t)},expression:"addData.courseName"}},e._l(e.categoryOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})})),1)],1),t("el-form-item",{staticClass:"filter-form-item",staticStyle:{width:"100%",overflow:"hidden"},attrs:{label:"课程套餐:",prop:"ids"}},[t("div",{staticClass:"filter-table"},[t("jat-select",{staticStyle:{width:"100%"},attrs:{"value-key":"id",multiple:"",placeholder:"根据课程名称进行搜索",clearable:"",filterable:""},on:{change:e.handleFilterChange},model:{value:e.filterSelectData,callback:function(t){e.filterSelectData=t},expression:"filterSelectData"}},e._l(e.selectDataList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e}})})),1)],1)]),t("el-form-item",{staticStyle:{width:"100%",overflow:"hidden"}},[t("BasicTable",{ref:"courseTableRef",attrs:{height:"300px",selectType:"multi",hasCard:!1,hasPage:!1,hasSort:!1,columns:e.columns,isShowTableHead:!1,reserveSelection:!0,"row-key":"id",data:e.tableData},on:{"selection-change":e.handleSelectionChange},model:{value:e.addData.ids,callback:function(t){e.$set(e.addData,"ids",t)},expression:"addData.ids"}})],1),t("el-form-item",{attrs:{label:"订单时间:",prop:"time"}},[t("jat-date-picker",{attrs:{width:"100%",clearable:"",type:"daterange",placeholder:"请选择订单时间",size:"small"},model:{value:e.addData.time,callback:function(t){e.$set(e.addData,"time",t)},expression:"addData.time"}})],1),t("el-form-item",{attrs:{label:"数量:",prop:"count"}},[t("jat-input",{directives:[{name:"input",rawName:"v-input.int",modifiers:{int:!0}}],attrs:{disabled:"",placeholder:"请输入数量"},model:{value:e.addData.count,callback:function(t){e.$set(e.addData,"count",t)},expression:"addData.count"}})],1),t("el-form-item",{attrs:{label:"市场价:",prop:"marketPrice"}},[t("jat-input",{directives:[{name:"input",rawName:"v-input.float",value:2,expression:"2",modifiers:{float:!0}}],attrs:{placeholder:"请输入市场价"},model:{value:e.addData.marketPrice,callback:function(t){e.$set(e.addData,"marketPrice",t)},expression:"addData.marketPrice"}})],1),t("el-form-item",{attrs:{label:"成本价:",prop:"costPrice"}},[t("jat-input",{directives:[{name:"input",rawName:"v-input.float",value:2,expression:"2",modifiers:{float:!0}}],attrs:{placeholder:"请输入成本价"},model:{value:e.addData.costPrice,callback:function(t){e.$set(e.addData,"costPrice",t)},expression:"addData.costPrice"}})],1),t("el-form-item",{attrs:{label:"下单者:",prop:"adId"}},[t("el-select",{ref:"select1",staticStyle:{width:"100%"},attrs:{size:"small",clearable:"",filterable:"",remote:"",placeholder:"代客下单选择会员账号，自己下单选择管理员账号","remote-method":t=>e.remoteMethod(t,""),loading:e.remoteLoading},on:{"hook:mounted":e.cancalReadOnly,"visible-change":e.cancalReadOnly},model:{value:e.addData.adId,callback:function(t){e.$set(e.addData,"adId",t)},expression:"addData.adId"}},e._l(e.userAllOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name?e.name:e.account+"(学籍未注册)",value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"利润归属:",prop:"profitAdId"}},[t("el-select",{ref:"select2",staticStyle:{width:"100%"},attrs:{size:"small",clearable:"",filterable:"",remote:"",placeholder:"为空为当前登录账户","remote-method":t=>e.remoteMethod(t,0),loading:e.remoteLoading},on:{"hook:mounted":e.cancalReadOnly,"visible-change":e.cancalReadOnly},model:{value:e.addData.profitAdId,callback:function(t){e.$set(e.addData,"profitAdId",t)},expression:"addData.profitAdId"}},e._l(e.userAdminOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{prop:"teacherIds"},scopedSlots:e._u([{key:"label",fn:function(){return[e._v(" 可直播讲师 "),t("span",{staticStyle:{color:"red"}},[e._v("（可不填，不选择讲师，会默认使用课程讲师）")]),e._v(": ")]},proxy:!0}])},[t("el-select",{ref:"selectTeacher",staticStyle:{width:"100%"},attrs:{size:"small",clearable:"",multiple:"",filterable:"",remote:"",placeholder:"选择可直播讲师","remote-method":t=>e.remoteMethod(t,""),loading:e.remoteLoading},on:{"hook:mounted":e.cancalReadOnly,"visible-change":e.cancalReadOnly,change:e.updateSelectedTeachers},model:{value:e.addData.teacherIds,callback:function(t){e.$set(e.addData,"teacherIds",t)},expression:"addData.teacherIds"}},e._l(e.userAllOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"已选择讲师:"}},[t("div",{staticStyle:{display:"flex"}},e._l(e.selectedTeachers,(function(n){return t("div",{key:n.id},[e._v(" "+e._s(n.name)+"， ")])})),0)]),t("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"优惠信息/订单备注:",prop:"remark"}},[t("jat-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入优惠信息/订单备注"},model:{value:e.addData.remark,callback:function(t){e.$set(e.addData,"remark",t)},expression:"addData.remark"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{attrs:{disabled:e.btnFlag},on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)],1)},i=[],o=(n("97ba"),n("7591")),a=n("b775"),s=n("b893"),l={components:{BasicTable:o["a"]},data(){return{btnFlag:!1,addModifyVisible:!1,remoteLoading:!1,dialogTitle:"",tableData:[],userAdminOptions:[],filterSelectData:[],selectDataList:[],userAllOptions:[],selectedTeachers:[],categoryOptions:[],isAutoCompute:!0,columns:[{id:1,prop:"name",label:"课程名称"},{id:2,prop:"price",label:"市场价"},{id:3,prop:"costPrice",label:"成本价"}],addData:{id:"",courseName:"",adId:"",teacherIds:[],costPrice:"",count:1,ids:[],marketPrice:"",profitAdId:"",remark:"",time:[this.$moment().format("YYYY-MM-DD"),this.$moment().add(1,"y").format("YYYY-MM-DD")]},clientRule:{name:[{required:!0,message:"请输入客户名称",trigger:"blur"}],costPrice:[{required:!0,message:"请输入成本价",trigger:"blur"}],adId:[{required:!0,message:"请输入下单者",trigger:"blur"}],count:[{required:!0,message:"请输入数量",trigger:"blur"}],time:[{required:!0,message:"请选择订单时间",trigger:"blur"}],ids:[{required:!0,message:"请选择套餐课程",trigger:"blur"}],marketPrice:[{required:!0,message:"请输入市场价",trigger:"blur"}],profitAdId:[{required:!0,message:"请选择利润归属",trigger:"blur"}]}}},mounted(){this.getCurrentUser(),this.getCategoryList()},methods:{open(){this.dialogTitle="增加订单",this.addModifyVisible=!0,this.btnFlag=!1,this.cancalReadOnly()},edit({orderNum:e,vipName:t,vipAdId:n,profitAdName:r,profitAdId:i,courseIds:o,courseName:a,costPrice:l,count:u,marketPrice:c,remark:d,startTime:f,endTime:h,teacherIds:m}){this.dialogTitle="修改订单",this.isAutoCompute=!1,this.addModifyVisible=!0,this.addData={orderNum:e,courseName:a,adId:n,costPrice:l,count:u||1,ids:o?JSON.parse(o):[],marketPrice:c,profitAdId:i,remark:d,teacherIds:m||[],time:f&&h?[Object(s["b"])(f,"yyyy-MM-dd"),Object(s["b"])(h,"yyyy-MM-dd")]:[]},this.userAllOptions=[{id:n,name:t}],this.userAdminOptions=[{id:i,name:r}],this.$nextTick(()=>{this.getCourseList(this.categoryOptions.find(e=>e.name===a).id,this.addData.ids)}),this.updateSelectedTeachers(),this.cancalReadOnly()},close(){this.$refs.clientRef&&this.$refs.clientRef.clearValidate(),this.addData={id:"",course:{},adId:"",costPrice:"",count:1,ids:[],marketPrice:"",profitAdId:"",remark:"",teacherIds:[],time:[this.$moment().format("YYYY-MM-DD"),this.$moment().add(1,"y").format("YYYY-MM-DD")]},this.addModifyVisible=!1},updateSelectedTeachers(){this.selectedTeachers=this.userAllOptions.filter(e=>this.addData.teacherIds.includes(e.id))},cancalReadOnly(e){this.$nextTick(()=>{if(!e){const{select1:e,selectTeacher:t}=this.$refs,n=e.$el.querySelector(".el-input__inner"),r=t.$el.querySelector(".el-input__inner");n.removeAttribute("readonly"),r.removeAttribute("readonly")}})},getCurrentUser(){const e=sessionStorage.getItem("id")?parseInt(sessionStorage.getItem("id")):"";console.log("getCurrentUser id",e),this.userAdminOptions=[{id:e,name:sessionStorage.getItem("userName")}],this.addData.profitAdId=e},getCourseList(e,t){console.log("id",e),a["a"].post({url:"/admin/adCourse/queryCourseListByCategoryId",params:{categoryId:e},success:e=>{this.tableData=e,this.selectDataList=e,this.$nextTick(()=>{this.$refs.courseTableRef.$refs.basicTable.$refs.multipleTable.clearSelection(),t?t.forEach(e=>{this.tableData.forEach(t=>{t.id===e&&(this.isAutoCompute=!1,this.$refs.courseTableRef.$refs.basicTable.$refs.multipleTable.toggleRowSelection(t))})}):this.tableData.forEach(e=>{this.$refs.courseTableRef.$refs.basicTable.$refs.multipleTable.toggleRowSelection(e)})})}})},handleCategoryChange(e){e&&this.getCourseList(this.categoryOptions.find(t=>t.name===e).id)},getCategoryList(){a["a"].post({url:"system/sysCategory/listNoPage",params:{type:4},success:e=>{this.categoryOptions=e}})},handleFilterChange(e){e&&e.length>0?this.tableData=e:this.tableData=this.selectDataList},handleSubmit(){this.$refs.clientRef.validate(e=>{const{ids:t,teacherIds:n,time:r,id:i,courseName:o,orderNum:s,...l}=this.addData;e&&(this.btnFlag=!0,s?a["a"].post({url:"/system/sysCourseOrder/orderEdit",params:{orderNum:s,ids:JSON.stringify(t),teacherIds:JSON.stringify(n),name:o,startTime:r&&r.length>0?r[0]:"",endTime:r&&r.length>0?r[1]:"",...l},success:e=>{this.$message.success(e),this.close(),this.$emit("success"),this.btnFlag=!1},catch:()=>{this.btnFlag=!1},finally:()=>{this.btnFlag=!1}}):a["a"].post({url:"system/sysCourseOrder/quicklyPlaceOrderAdd",params:{ids:JSON.stringify(t),teacherIds:JSON.stringify(n),name:o,startTime:r&&r.length>0?r[0]:"",endTime:r&&r.length>0?r[1]:"",...l},success:e=>{this.$message.success(e),this.close(),this.$emit("success"),this.btnFlag=!1},catch:()=>{this.btnFlag=!1},finally:()=>{this.btnFlag=!1}}))})},handleSelectionChange(e){this.addData.ids=e.map(e=>e.id),this.isAutoCompute?(this.addData.costPrice=e.reduce((e,t)=>e+t.costPrice,0),this.addData.marketPrice=e.reduce((e,t)=>e+t.price,0)):this.isAutoCompute=!0},remoteMethod(e,t){e&&(this.remoteLoading=!0,a["a"].post({url:"/admin/adInfo/queryAdminByNameOrPhone",params:{search:e,type:t},success:e=>{this.remoteLoading=!1,0===t?this.userAdminOptions=e:this.userAllOptions=e},catch:()=>{this.remoteLoading=!1}}))}}},u=l,c=(n("16f2"),n("1805")),d=Object(c["a"])(u,r,i,!1,null,"43e33783",null);t["default"]=d.exports},ef3c:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div")},i=[],o={name:"redirectPage",data(){return{}},created(){const{params:e,query:t}=this.$route,{path:n}=e;this.$router.replace({path:"/"+n,query:t})},render:function(e){return e()},methods:{}},a=o,s=n("1805"),l=Object(s["a"])(a,r,i,!1,null,"2704f4ee",null);t["default"]=l.exports},f10b:function(e,t,n){"use strict";n("8f13")},f14f:function(e,t,n){},f264:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:"订单详情","close-on-click-modal":!1,visible:e.detailVisible,width:"70%"},on:{"update:visible":function(t){e.detailVisible=t},close:e.handleClose}},[t("el-descriptions",{staticClass:"margin-top",attrs:{title:"订单信息",colon:!0,labelStyle:{width:"140px"},column:2,size:"medium",border:""}},[t("template",{slot:"extra"},[t("jat-button",{on:{click:e.handleUpdateTime}},[e._v("修改订单时间")]),t("jat-button",{attrs:{type:"success"},on:{click:e.stopCourse}},[e._v("停课")]),t("jat-button",{attrs:{type:"warning"},on:{click:e.restoreCourse}},[e._v("恢复课程")])],1),e._l(e.orderList,(function(n,r){return t("el-descriptions-item",{key:n.id,attrs:{span:0===r?2:1}},[t("template",{slot:"label"},[e._v(" "+e._s(n.name)+" ")]),t("div",{domProps:{innerHTML:e._s("date"===n.type?e.getDate(e.info[n.id]):e.info[n.id])}})],2)}))],2),t("div",{staticClass:"tilte-box"},[e._v("订单收款")]),t("BasicTable",{attrs:{height:"300px",hasCard:!1,hasPage:!1,hasSort:!1,columns:e.columns,isShowTableHead:!1,data:e.tableData}})],1),t("el-dialog",{attrs:{title:"修改订单时间","close-on-click-modal":!1,visible:e.timelVisible,width:"40%"},on:{"update:visible":function(t){e.timelVisible=t},close:e.handleTimeClose}},[t("el-form",{ref:"timeForm",attrs:{model:e.diaData,rules:e.rules,"label-width":"100px",inline:!1,size:"normal"}},[t("el-form-item",{attrs:{label:"订单时间:",prop:"time"}},[t("jat-date-picker",{attrs:{width:"100%",clearable:"",type:"daterange",placeholder:"请选择订单时间",size:"small"},model:{value:e.diaData.time,callback:function(t){e.$set(e.diaData,"time",t)},expression:"diaData.time"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.handleTimeClose}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)],1)},i=[],o=n("b775"),a=n("7591"),s=n("b893"),l={components:{BasicTable:a["a"]},data(){return{getDate:s["b"],detailVisible:!1,timelVisible:!1,info:{},diaData:{time:[]},tableData:[],orderList:[{id:"orderNum",name:"订单编号"},{id:"courseNameS",name:"课程名称"},{id:"courseName",name:"套餐名称"},{id:"startTime",name:"开始时间",type:"date"},{id:"endTime",name:"结束时间",type:"date"},{id:"vipName",name:"客户名称"},{id:"count",name:"数量"},{id:"vipName",name:"预订人"},{id:"orderTeacherList",name:"直播讲师"},{id:"phone",name:"客户电话"},{id:"totalMarketPrice",name:"订单总销售价"},{id:"statusName",name:"订单状态"},{id:"createTime",name:"下单时间",type:"date"},{id:"profitAdName",name:"销售员"},{id:"createAdName",name:"操作员"},{id:"remark",name:"优惠信息/订单备注"},{id:"",name:""}],columns:[{id:1,prop:"categoryName",label:"付款方式"},{id:2,prop:"orderMoney",label:"应收金额"},{id:3,prop:"collectionMoney",label:"已收金额",colorRener:e=>-1==e.status?"#C00063":""},{id:4,type:"image",prop:"receiptUrl",label:"水单"},{id:5,prop:"collectionMoney",label:"备注"},{id:6,prop:"createAdName",label:"创建人"}],rules:{time:[{required:!0,message:"请选择订单时间",trigger:"blur"}]}}},methods:{stopCourse(){this.$confirm("确定将订单:"+this.info.orderNum+"停课吗，这会导致该用户无法观看该订单内的所有课程","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{o["a"].post({url:"/system/sysVipOrderCourse/stopCourse",params:{orderNum:this.info.orderNum},success:e=>{this.$message.success("操作成功")}})}).catch(e=>{console.log(e)})},restoreCourse(){this.$confirm("确定恢复该订单:"+this.info.orderNum+"内的所有课程吗","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{o["a"].post({url:"/system/sysVipOrderCourse/restoreCourse",params:{orderNum:this.info.orderNum},success:e=>{this.$message.success("操作成功")}})}).catch(e=>{console.log(e)})},open(e){this.detailVisible=!0,this.getDetailInfo(e)},handleClose(){this.detailVisible=!1},handleTimeClose(){this.timelVisible=!1,this.diaData.time=[]},handleUpdateTime(){this.timelVisible=!0,this.diaData.time=[this.getDate(this.info.startTime),this.getDate(this.info.endTime)]},handleSubmit(){this.$refs.timeForm.validate(e=>{const{time:t}=this.diaData;e&&o["a"].post({url:"/system/sysCourseOrder/orderTimeEdit",params:{orderNum:this.info.orderNum,startTime:t&&t.length>0?t[0]:"",endTime:t&&t.length>0?t[1]:""},success:e=>{this.$message.success(e),this.handleTimeClose(),this.getDetailInfo(this.info.orderNum)}})})},getDetailInfo(e){o["a"].post({url:"/system/sysCourseOrder/detail",params:{orderNum:e},success:e=>{if(this.info=e.orderDetail,e.orderTeacherList&&e.orderTeacherList.length>0&&(this.info.orderTeacherList=e.orderTeacherList.map(e=>e.teacherName).join("，")),this.tableData=e.billsList,this.info.remark||(this.info.remark="暂无备注"),this.info.courseNameS){let e="";this.info.courseNameS.split(",").forEach(t=>{e+=`<div>${t}</div>`}),this.info.courseNameS=e}}})}}},u=l,c=(n("d167"),n("1805")),d=Object(c["a"])(u,r,i,!1,null,"604d8f0d",null);t["default"]=d.exports},f393:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"department_page"},[t("div",{staticClass:"header_box"},[t("span",{on:{click:e.handleAdddepartment}},[t("HeaderBtn",{directives:[{name:"permission",rawName:"v-permission",value:"admin/adDepartment/add",expression:"'admin/adDepartment/add'"}],attrs:{name:"el-icon-plus"}},[e._v("添加部门")])],1)]),t("div",{staticClass:"tree_box"},[t("el-tree",{ref:"departmentRef",attrs:{data:e.departmentData,"node-key":"id","default-expand-all":"","highlight-current":"",props:e.defaultProps},scopedSlots:e._u([{key:"default",fn:function({node:n,data:r}){return t("div",{staticClass:"custom-tree-node"},[t("span",[e._v(e._s(n.label))]),t("div",[t("span",{directives:[{name:"permission",rawName:"v-permission",value:"admin/adDepartment/add",expression:"'admin/adDepartment/add'"}],staticClass:"edit_box",on:{click:function(t){return t.stopPropagation(),e.handleAdd(r)}}},[t("i",{staticClass:"el-icon-plus"})]),t("span",{directives:[{name:"permission",rawName:"v-permission",value:"admin/adDepartment/edit",expression:"'admin/adDepartment/edit'"}],staticClass:"edit_box",on:{click:function(t){return t.stopPropagation(),e.handleEdit(r)}}},[t("i",{staticClass:"el-icon-edit"})]),t("span",{directives:[{name:"permission",rawName:"v-permission",value:"admin/adDepartment/remove",expression:"'admin/adDepartment/remove'"}],staticClass:"edit_box del_box",on:{click:function(t){return t.stopPropagation(),e.handleDelete(r)}}},[t("i",{staticClass:"el-icon-delete"})])])])}}])})],1),t("add-dialog",{ref:"addDialog",on:{success:e.handleSuccess}})],1)},i=[],o=n("4736"),a=n("b775"),s=n("7e4a"),l=n("b893"),u={components:{HeaderBtn:o["a"],AddDialog:s["default"]},data(){return{departmentData:[],defaultProps:{children:"children",label:"name"}}},created(){this.getTreeList()},methods:{getTreeList(){a["a"].post({url:"/admin/adInfo/canChooseCanSeeDepartmentList",params:{id:sessionStorage.getItem("id")},success:e=>{this.departmentData=Object(l["c"])(e)}})},handleSuccess(){this.getTreeList()},handleAdd(e){console.log(e),this.$refs.addDialog.open(this.departmentData,e)},handleEdit(e){this.$refs.addDialog.edit(e,this.departmentData)},handleAdddepartment(){this.$refs.addDialog.open(this.departmentData)},handleDelete(e){this.$confirm("此操作将会删除该部门, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/admin/adDepartment/remove",params:{id:e.id},success:e=>{this.$message.success(e),this.getTreeList()}})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})}}},c=u,d=(n("0ec1"),n("1805")),f=Object(d["a"])(c,r,i,!1,null,null,null);t["default"]=f.exports},f4f6:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}}),t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,operates:e.operates,operateWidth:"110px",data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange}}),t("add-dialog",{ref:"addDialog",on:{success:e.handleSuccess}})],1)},i=[],o=n("7591"),a=n("b775"),s=n("4504"),l={name:"articlePage",components:{BasicTable:o["a"],addDialog:s["default"]},data(){return{loading:!1,remoteLoading:!1,supervisorAdOptions:[],categoryOptions:[],filterOptions:{column:[{type:"input",label:"文章名称",value:"title"},{type:"select",label:"文章类别",value:"categoryId",labelKey:"name",valueKey:"id",options:[]},{type:"select",label:"文章状态",value:"status",options:[{value:0,label:"正常"},{value:1,label:"下架"}]}]},remoteLoading:!1,teacherOptions:[],filterData:{title:"",categoryId:"",status:""},table:{columns:[{id:1,prop:"title",label:"文章名称"},{id:2,prop:"categoryId",label:"文章类别",render:e=>{const t=this.$refs.addDialog.categoryOptions.find(t=>t.id==e.categoryId);return t?t.name:""}},{id:3,prop:"createAdName",label:"增加人"},{id:4,prop:"createTime",label:"增加时间",type:"date"},{id:5,prop:"status",label:"文章状态",render:e=>0==e.status?"正常":"下架",statusType:e=>0==e.status?"success":"error"},{id:6,prop:"sort",label:"排序"}],pageSize:20,currentPage:1,data:[],total:0},operates:[{key:"edit",title:"编辑",btnStyle:"yellow",permission:"admin/adCourse/edit",action:(e,t)=>{this.$refs.addDialog.edit(t)}},{key:"delete",title:"删除",permission:"system/sysArticle/remove",btnStyle:"red",action:(e,t)=>{this.handleDelete(t)}}],headerOperates:[{key:"el-icon-plus",name:"添加文章",permission:"system/sysArticle/add",action:()=>{this.$refs.addDialog.open()}}]}},computed:{hasLiveOptions(){return this.$refs.addDialog?this.$refs.addDialog.hasLiveOptions:[]}},mounted(){this.$watch(()=>this.$refs.addDialog.categoryOptions,e=>{this.filterOptions.column[1].options=e})},created(){this.getList()},methods:{searchFilter(){this.table.currentPage=1,this.getList()},getList(){this.loading=!0,a["a"].post({url:"/system/sysArticle/list",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,...this.filterData},success:e=>{this.table.data=e.list,this.table.total=e.total,this.loading=!1},catch:()=>{this.loading=!1}})},teacherRemoteMethod(e){e&&(this.remoteLoading=!0,a["a"].post({url:"/admin/adCourse/queryTeacherByNameOrTeacher",params:{keyword:e},success:e=>{this.remoteLoading=!1,this.teacherOptions=e},catch:()=>{this.remoteLoading=!1}}))},handleSuccess(){this.getList()},handleDelete(e){this.$confirm("此操作将会删除该文章, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/system/sysArticle/remove",params:{id:e.id},success:e=>{this.$message.success(e),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},clearFilter(){this.filterData={name:"",number:"",hasLive:"",teacherAdId:"",categoryId:"",hasFree:"",setMealCategoryId:""},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()},remoteMethod(e){e&&(this.remoteLoading=!0,a["a"].post({url:"/admin/adInfo/queryAdminByNameOrPhone",params:{search:e},success:e=>{this.remoteLoading=!1,this.supervisorAdOptions=e},catch:()=>{this.remoteLoading=!1}}))}}},u=l,c=(n("456c"),n("1805")),d=Object(c["a"])(u,r,i,!1,null,"4eb2d450",null);t["default"]=d.exports},f6c9:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.addModifyVisible,width:"50%"},on:{"update:visible":function(t){e.addModifyVisible=t},close:e.close}},[t("el-form",{ref:"collectionRef",attrs:{model:e.addData,rules:e.collectionRule,"label-position":"right","label-width":"90px"}},[e.vipName?t("el-form-item",{attrs:{label:"收款单位:"}},[e._v(" "+e._s(e.vipName)+" ")]):e._e(),t("el-form-item",{attrs:{label:"收款方式:",prop:"categoryId"}},[t("jat-select",{attrs:{placeholder:"请选择收款方式",clearable:""},model:{value:e.addData.categoryId,callback:function(t){e.$set(e.addData,"categoryId",t)},expression:"addData.categoryId"}},e._l(e.categoryOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"水单:",prop:"receiptUrl"}},[t("upload-image",{model:{value:e.addData.receiptUrl,callback:function(t){e.$set(e.addData,"receiptUrl",t)},expression:"addData.receiptUrl"}})],1),t("el-form-item",{attrs:{label:"收款金额:",prop:"collectionMoney"}},[t("jat-input",{directives:[{name:"input",rawName:"v-input.float",value:2,expression:"2",modifiers:{float:!0}}],attrs:{placeholder:"请输入收款金额"},model:{value:e.addData.collectionMoney,callback:function(t){e.$set(e.addData,"collectionMoney",t)},expression:"addData.collectionMoney"}})],1),t("el-form-item",{attrs:{label:"收款时间:",prop:"collectionTime"}},[t("jat-date-picker",{attrs:{width:"100%",clearable:"",type:"datetime",placeholder:"请选择收款时间",valueFormat:"yyyy-MM-dd HH:mm:ss",size:"small"},model:{value:e.addData.collectionTime,callback:function(t){e.$set(e.addData,"collectionTime",t)},expression:"addData.collectionTime"}})],1),t("el-form-item",{attrs:{label:"收款备注:",prop:"remark"}},[t("jat-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入收款备注"},model:{value:e.addData.remark,callback:function(t){e.$set(e.addData,"remark",t)},expression:"addData.remark"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)],1)},i=[],o=n("cbc3"),a=n("b775"),s={components:{uploadImage:o["a"]},data(){return{addModifyVisible:!1,dialogTitle:"",vipName:"",addData:{categoryId:"",collectionMoney:"",collectionTime:"",orderNum:"",receiptUrl:"",remark:""},categoryOptions:[],collectionRule:{categoryId:[{required:!0,message:"请选择收款方式",trigger:"blur"}],collectionMoney:[{required:!0,message:"请输入收款金额",trigger:"blur"}],collectionTime:[{required:!0,message:"请选择收款时间",trigger:"blur"}]}}},mounted(){this.getCategoryList()},methods:{open(e,t,n){this.dialogTitle="创建收款",this.addData.orderNum=e,t&&(this.dialogTitle=t,this.vipName=n),this.addModifyVisible=!0},close(){this.$refs.collectionRef&&this.$refs.collectionRef.clearValidate(),this.vipName="",this.addData={categoryId:"",collectionMoney:"",collectionTime:"",orderNum:"",receiptUrl:"",remark:""},this.addModifyVisible=!1},getCategoryList(){a["a"].post({url:"/system/sysCategory/listNoPage",params:{type:3},success:e=>{this.categoryOptions=e}})},handleSubmit(){this.$refs.collectionRef.validate(e=>{e&&a["a"].post({url:"/system/sysCourseOrderBills/claimMoneyAdd",params:this.addData,success:e=>{this.$message.success(e),this.close(),this.$emit("success")}})})}}},l=s,u=n("1805"),c=Object(u["a"])(l,r,i,!1,null,"58ce93f8",null);t["default"]=c.exports},f8c2:function(e,t,n){},f9a0:function(e,t,n){"use strict";n("e7fd")},fa5f:function(e,t,n){},fa8e:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"newCategory_page"},[t("div",{staticClass:"header_box"},[t("span",{on:{click:e.handleAddNewCategory}},[t("HeaderBtn",{directives:[{name:"permission",rawName:"v-permission",value:"system/sysNewsCategory/add",expression:"'system/sysNewsCategory/add'"}],attrs:{name:"el-icon-plus"}},[e._v("添加新闻分类")])],1)]),t("div",{staticClass:"tree_box"},[t("el-tree",{ref:"newCategoryRef",attrs:{data:e.newCategoryData,"node-key":"id","default-expand-all":"","highlight-current":"",props:e.defaultProps},scopedSlots:e._u([{key:"default",fn:function({node:n,data:r}){return t("div",{staticClass:"custom-tree-node"},[t("span",[e._v(e._s(n.label))]),t("div",[1===n.level?t("span",{directives:[{name:"permission",rawName:"v-permission",value:"system/sysNewsCategory/add",expression:"'system/sysNewsCategory/add'"}],staticClass:"edit_box",on:{click:function(t){return t.stopPropagation(),e.handleAdd(r)}}},[t("i",{staticClass:"el-icon-plus"})]):e._e(),t("span",{directives:[{name:"permission",rawName:"v-permission",value:"system/sysNewsCategory/edit",expression:"'system/sysNewsCategory/edit'"}],staticClass:"edit_box",on:{click:function(t){return t.stopPropagation(),e.handleEdit(r)}}},[t("i",{staticClass:"el-icon-edit"})])])])}}])})],1),t("add-dialog",{ref:"addDialog",on:{success:e.handleSuccess}})],1)},i=[],o=(n("5948"),n("97ba"),n("4736")),a=n("b775"),s=n("d719"),l={components:{HeaderBtn:o["a"],AddDialog:s["default"]},data(){return{newCategoryData:[],defaultProps:{children:"children",label:"name"}}},created(){this.getTreeList()},methods:{getTreeList(){a["a"].post({url:"/system/sysNewsCategory/listNoPage",params:{},success:e=>{this.newCategoryData=this.listToTree(e)}})},listToTree(e){let t=e.reduce((e,t)=>(e[t.id]=t,t.children=[],e),{});return e.filter(e=>(t[e.parentId]&&t[e.parentId].children.push(e),-1==e.parentId))},handleSuccess(){this.getTreeList()},handleAdd(e){this.$refs.addDialog.open(e)},handleEdit(e){this.$refs.addDialog.edit(e)},handleAddNewCategory(){this.$refs.addDialog.open()}}},u=l,c=(n("8908"),n("1805")),d=Object(c["a"])(u,r,i,!1,null,null,null);t["default"]=d.exports},fb79:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));n("5948");var r=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{attrs:{id:"notFind"}},[t("div",{staticClass:"container"},[t("img",{staticClass:"bg",attrs:{src:n("8f20")}}),t("div",{staticClass:"btn"},[t("a",{staticClass:"goindex",on:{click:function(t){return e.$router.push("/")}}},[e._v("回到首页")]),t("a",{staticClass:"lx",attrs:{target:"_blank"},on:{click:function(t){return e.$router.go(-1)}}},[e._v("返回上一页")]),t("div",{staticStyle:{clear:"both"}})])])])},i=[]},fc89:function(e,t,n){"use strict";var r=n("5986"),i=n("887f");e.exports=function(e,t){r(t)&&"cause"in t&&i(e,"cause",t.cause)}},fc92:function(e,t,n){"use strict";n("648b")},fcff:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"middle-container"},[t("jat-fillter",{attrs:{option:e.filterOptions},on:{searchFilter:e.searchFilter,clearFilter:e.clearFilter},model:{value:e.filterData,callback:function(t){e.filterData=t},expression:"filterData"}},[t("span",{attrs:{slot:"parentId"},slot:"parentId"},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",remote:"",size:"small",clearable:"",placeholder:"添加人(可根据名称或手机号进行搜索)","remote-method":e.remoteMethod,loading:e.remoteLoading},model:{value:e.filterData.parentId,callback:function(t){e.$set(e.filterData,"parentId",t)},expression:"filterData.parentId"}},e._l(e.supervisorAdOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)]),t("BasicTable",{attrs:{columns:e.table.columns,headerOperates:e.headerOperates,data:e.table.data,pageSize:e.table.pageSize,currentPage:e.table.currentPage,total:e.table.total,operates:e.operates},on:{"current-page-change":e.currentPageChange,"size-page-change":e.sizePageChange},scopedSlots:e._u([{key:"image",fn:function(e){return t("div",{},[e.row.image?t("el-image",{staticStyle:{width:"50px"},attrs:{src:e.row.image,"preview-src-list":[e.row.image]}}):t("span")],1)}}])}),t("add-dialog",{ref:"addDialog",on:{success:e.handleSuccess}}),t("el-dialog",{attrs:{title:"账号信息","close-on-click-modal":!1,visible:e.accountVisible,width:"30%"},on:{"update:visible":function(t){e.accountVisible=t},close:e.handleClose}},[t("div",{staticClass:"tipInfo"},[e._v(" 同学这个是您的学习账号，你先收藏一下，方便后面听课 ")]),t("div",{staticClass:"account-box"},[t("span",{attrs:{id:"account"}},[e._v("账号："+e._s(e.accountInfo.account))]),t("span",{attrs:{id:"password"}},[e._v("密码："+e._s(e.accountInfo.password))])]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"})])],1)},i=[],o=n("7591"),a=n("b775"),s=n("4460"),l=n("b893"),u={name:"unAuditPage",components:{BasicTable:o["a"],addDialog:s["default"]},data(){return{supervisorAdOptions:[],departmentList:[],remoteLoading:!1,accountVisible:!1,accountInfo:{account:"",password:""},loading:!1,filterOptions:{column:[{type:"input",label:"用户名/真实姓名/电话号码",value:"username"},{type:"input",label:"QQ/微信",value:"qq"},{type:"select",label:"性别",value:"gender",options:[{label:"男",value:"1"},{label:"女",value:"2"}]},{type:"slot",slotName:"parentId"},{type:"timeAll",label:["注册开始日期","注册结束日期"],value:"registerTime"}]},filterData:{username:"",qq:"",gender:"",departmentId:"",parentId:"",status:-3,registerTime:[]},table:{columns:[{id:1,prop:"account",label:"用户名"},{id:3,prop:"name",label:"真实姓名"},{id:4,prop:"qq",label:"QQ"},{id:5,prop:"wechat",label:"微信"},{id:6,prop:"phone",label:"联系电话"},{id:8,prop:"createTime",label:"注册时间",type:"date"}],pageSize:20,currentPage:1,data:[],total:0},operates:[{key:"edit",title:"审核",btnStyle:"yellow",permission:"admin/adInfo/auditVip",action:(e,t)=>{this.handleAudit(t)}}],headerOperates:[]}},created(){this.getList(),this.getDepartmentList()},methods:{handleClose(){this.accountInfo={account:"",password:""}},handleAudit(e){this.$confirm("确定审核通过吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a["a"].post({url:"/admin/adInfo/auditVip",params:{id:e.id},success:e=>{this.accountInfo=e,this.accountVisible=!0,this.$message.success("审核通过，请将账号和密码发给学员"),this.getList()}})}).catch(()=>{this.$message({type:"info",message:"已取消操作"})})},searchFilter(){this.table.currentPage=1,this.getList()},getList(){const{registerTime:e,...t}=this.filterData;this.loading=!0,a["a"].post({url:"/admin/adInfo/unRegisterStNumberList",params:{pageNo:this.table.currentPage,pageSize:this.table.pageSize,...t,startTime:e&&e.length>0?e[0]:"",endTime:e&&e.length>0?this.$moment(e[1]).add(1,"days").format("YYYY-MM-DD"):""},success:e=>{this.table.data=e.list,this.table.total=e.total,this.table.data.forEach(e=>{this.$common.checkNull(e.name)||(e.name="未填写"),this.$common.checkNull(e.qq)||(e.qq="未填写"),this.$common.checkNull(e.wechat)||(e.wechat="未填写")}),this.loading=!1},catch:()=>{this.loading=!1}})},getDepartmentList(){a["a"].post({url:"/admin/adInfo/canChooseCanSeeDepartmentList",params:{...this.addData,id:sessionStorage.getItem("id")},success:e=>{this.departmentList=e,this.filterOptions.column[3].options=Object(l["c"])(e)}})},handleSuccess(){this.getList()},remoteMethod(e){e&&(this.remoteLoading=!0,a["a"].post({url:"/admin/adInfo/queryAdminByNameOrPhone",params:{search:e},success:e=>{this.remoteLoading=!1,this.supervisorAdOptions=e},catch:()=>{this.remoteLoading=!1}}))},clearFilter(){this.filterData={username:"",qq:"",gender:"",departmentId:"",parentId:"",status:-3,registerTime:[]},this.searchFilter()},currentPageChange(e){this.table.currentPage=e,this.getList()},sizePageChange(e){this.table.currentPage=1,this.table.pageSize=e,this.getList()}}},c=u,d=(n("bc35"),n("1805")),f=Object(d["a"])(c,r,i,!1,null,"58387b5a",null);t["default"]=f.exports},feca:function(e,t,n){var r={"./Login.vue":"a55b3","./Manage.vue":"f74b","./component/autoScrollTable.vue":"0915","./error/404.vue":"2754","./manage/Manage/index.vue":"8763","./manage/administrative/department/addDialog.vue":"7e4a","./manage/administrative/department/index.vue":"f393","./manage/clientManage/index/addDialog.vue":"ff04","./manage/clientManage/index/index.vue":"8f18","./manage/clientManage/message/index.vue":"0418","./manage/courseWork/index/addDialog.vue":"1d0e","./manage/courseWork/index/auditWork.vue":"a2f0","./manage/courseWork/index/chapters.vue":"9303","./manage/courseWork/index/courseWorkList.vue":"db9d","./manage/courseWork/index/index.vue":"e2e3","./manage/courseWork/index/submittedWork.vue":"e931","./manage/courseWork/index/submittedWorkDetail.vue":"6a2e","./manage/extend/channel/addDialog.vue":"d782","./manage/extend/channel/index.vue":"e4b8","./manage/extend/channelStatistics/index.vue":"502c","./manage/extend/data/addDialog.vue":"5789","./manage/extend/data/index.vue":"801b","./manage/extend/eatEuantity/index.vue":"d3e4","./manage/extend/person/index.vue":"43d4","./manage/extend/profitPerson/index.vue":"34dd","./manage/extend/removeData/addDialog.vue":"81b9f","./manage/extend/removeData/index.vue":"364e","./manage/financeCenter/receivables/addDialog.vue":"779e","./manage/financeCenter/receivables/canceled.vue":"cf21","./manage/financeCenter/receivables/detailDrawer.vue":"a0f2","./manage/financeCenter/receivables/index.vue":"262c","./manage/financeCenter/receivables/lingKuan.vue":"f6c9","./manage/financeCenter/receivables/outstandingCharges.vue":"dd75","./manage/financeCenter/receivables/payoutDetail.vue":"34aa","./manage/financeCenter/receivables/receivable.vue":"aa1c","./manage/financeCenter/receivables/refund.vue":"d03e2","./manage/home/gdwsytjContent.vue":"b58a","./manage/home/gyhcksTopTen.vue":"7737","./manage/home/index.vue":"67d7","./manage/orderManage/index/addDialog.vue":"ee0e","./manage/orderManage/index/createCollectionDialog.vue":"29ed","./manage/orderManage/index/index.vue":"40a5","./manage/orderManage/index/openCourse.vue":"88e2","./manage/orderManage/index/orderDetail.vue":"f264","./manage/product/reserve/bookNow.vue":"324f","./manage/product/reserve/index.vue":"1af3","./manage/productAssetsManage/artcleManage/addDialog.vue":"4504","./manage/productAssetsManage/artcleManage/index.vue":"f4f6","./manage/productAssetsManage/courseManage/addDialog.vue":"574d","./manage/productAssetsManage/courseManage/index.vue":"651a","./manage/productSetting/vipStudent/index.vue":"8467","./manage/statistics/departPerformance/index.vue":"d73b","./manage/statistics/personPerformance/index.vue":"9011","./manage/statistics/productPerformance/index.vue":"d73c","./manage/statistics/receivablesPerformance/index.vue":"aa7a","./manage/systemSetting/advertising/addDialog.vue":"1356","./manage/systemSetting/advertising/index.vue":"1b83","./manage/systemSetting/advertisingCategory/addDialog.vue":"0889","./manage/systemSetting/advertisingCategory/index.vue":"4e01","./manage/systemSetting/category/addDialog.vue":"9570","./manage/systemSetting/category/index.vue":"91ef","./manage/systemSetting/defaultWeb/index.vue":"e621","./manage/systemSetting/news/addDialog.vue":"c145","./manage/systemSetting/news/index.vue":"7205","./manage/systemSetting/newsCategory/addDialog.vue":"d719","./manage/systemSetting/newsCategory/index.vue":"fa8e","./manage/systemSetting/notice/addDialog.vue":"9f30","./manage/systemSetting/notice/index.vue":"0845","./manage/teacherManage/course/addChapters.vue":"101b","./manage/teacherManage/course/addCourseWork.vue":"dffa","./manage/teacherManage/course/addDialog.vue":"6a32","./manage/teacherManage/course/addParentChapter.vue":"920b","./manage/teacherManage/course/chapters.vue":"2694","./manage/teacherManage/course/courseChapters.vue":"6fdf","./manage/teacherManage/course/index.vue":"946d","./manage/teacherManage/course/uploadVideo.vue":"7d95","./manage/teacherManage/course/workChapters.vue":"88e9","./manage/teacherManage/student/index.vue":"bb1c","./manage/userCenter/adminManage/addDialog.vue":"1f28","./manage/userCenter/adminManage/detailDrawer.vue":"46bb","./manage/userCenter/adminManage/index.vue":"61cb","./manage/userCenter/evaManage/index.vue":"31da","./manage/userCenter/formalVip/addDialog.vue":"e790","./manage/userCenter/formalVip/index.vue":"87bd","./manage/userCenter/logManage/index.vue":"e9c0","./manage/userCenter/roleManage/addDialog.vue":"08a4","./manage/userCenter/roleManage/index.vue":"0841","./manage/userCenter/unAuditVip/addDialog.vue":"4460","./manage/userCenter/unAuditVip/index.vue":"fcff","./redirect/index.vue":"ef3c"};function i(e){var t=o(e);return n(t)}function o(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}i.keys=function(){return Object.keys(r)},i.resolve=o,e.exports=i,i.id="feca"},fed7:function(e,t,n){"use strict";n("d8a7")},fed9:function(e,t,n){"use strict";n("b74e")},ff04:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.addModifyVisible,width:"70%"},on:{"update:visible":function(t){e.addModifyVisible=t},close:e.close}},[t("el-form",{ref:"clientRef",attrs:{model:e.addData,rules:e.clientRule,"label-position":"right","label-width":"140px"}},[t("el-form-item",{attrs:{label:"客户名称:",prop:"name"}},[t("jat-input",{attrs:{placeholder:"请输入客户名称"},model:{value:e.addData.name,callback:function(t){e.$set(e.addData,"name",t)},expression:"addData.name"}})],1),t("el-form-item",{attrs:{label:"联系电话:",prop:"phone"}},[t("jat-input",{attrs:{placeholder:"请输入联系电话"},model:{value:e.addData.phone,callback:function(t){e.$set(e.addData,"phone",t)},expression:"addData.phone"}})],1),t("el-form-item",{attrs:{label:"证件类型:",prop:"idCardType"}},[t("jat-select",{attrs:{placeholder:"请选择证件类型",clearable:"",filterable:""},on:{change:e.handleIdCardTypeChange},model:{value:e.addData.idCardType,callback:function(t){e.$set(e.addData,"idCardType",t)},expression:"addData.idCardType"}},e._l(e.idCardTypeOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"证件号码:",prop:"idCard"}},[t("jat-input",{attrs:{placeholder:"请输入证件号码"},model:{value:e.addData.idCard,callback:function(t){e.$set(e.addData,"idCard",t)},expression:"addData.idCard"}})],1),t("el-form-item",{attrs:{label:"生日:",prop:"birthdayParam"}},[t("jat-input",{attrs:{placeholder:"请输入生日"},model:{value:e.addData.birthdayParam,callback:function(t){e.$set(e.addData,"birthdayParam",t)},expression:"addData.birthdayParam"}})],1),t("el-form-item",{attrs:{label:"性别:",prop:"gender"}},[t("jat-select",{attrs:{placeholder:"请选择性别",clearable:"",filterable:""},model:{value:e.addData.gender,callback:function(t){e.$set(e.addData,"gender",t)},expression:"addData.gender"}},[t("el-option",{attrs:{label:"男",value:1}}),t("el-option",{attrs:{label:"女",value:2}})],1)],1),t("el-form-item",{attrs:{label:"所属区域:",prop:"region"}},[t("jat-input",{attrs:{placeholder:"请输入所属区域"},model:{value:e.addData.region,callback:function(t){e.$set(e.addData,"region",t)},expression:"addData.region"}})],1),t("el-form-item",{attrs:{label:"家庭住址:",prop:"homeAddress"}},[t("jat-input",{attrs:{placeholder:"请输入家庭住址"},model:{value:e.addData.homeAddress,callback:function(t){e.$set(e.addData,"homeAddress",t)},expression:"addData.homeAddress"}})],1),t("el-form-item",{attrs:{label:"工资水平:",prop:"wageLevel"}},[t("jat-select",{attrs:{placeholder:"请选择工资水平",clearable:"",filterable:""},model:{value:e.addData.wageLevel,callback:function(t){e.$set(e.addData,"wageLevel",t)},expression:"addData.wageLevel"}},e._l(e.wageLevelOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"单位:",prop:"company"}},[t("jat-input",{attrs:{placeholder:"请输入单位"},model:{value:e.addData.company,callback:function(t){e.$set(e.addData,"company",t)},expression:"addData.company"}})],1),t("el-form-item",{attrs:{label:"客户备注/客户意向:",prop:"remark"}},[t("jat-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入客户备注/客户意向"},model:{value:e.addData.remark,callback:function(t){e.$set(e.addData,"remark",t)},expression:"addData.remark"}})],1),t("el-form-item",{attrs:{label:"紧急联系人信息:",prop:"urgentPerson"}},[t("jat-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入紧急联系人信息"},model:{value:e.addData.urgentPerson,callback:function(t){e.$set(e.addData,"urgentPerson",t)},expression:"addData.urgentPerson"}})],1),t("el-form-item",{attrs:{label:"所有者:",prop:"parentAdId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",clearable:"",filterable:"",remote:"",placeholder:"默认为登录账户，为空的话为公共账户","remote-method":e.remoteMethod,loading:e.remoteLoading},model:{value:e.addData.parentAdId,callback:function(t){e.$set(e.addData,"parentAdId",t)},expression:"addData.parentAdId"}},e._l(e.parentAdIdOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"附件:",prop:"attachment"}},[t("uploadFile",{attrs:{limit:1},model:{value:e.addData.attachment,callback:function(t){e.$set(e.addData,"attachment",t)},expression:"addData.attachment"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("jat-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取 消")]),t("jat-button",{on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)],1)},i=[],o=(n("7cfc"),n("c46c")),a=n("b775");const s=(e="",t="birthDate")=>{const n=["birthDate","sex","age"];if(""===e)throw new Error("传入身份证不能为空！");if("string"!==typeof e)throw new Error("传入身份证字段类型应为字符型！");if(!n.includes(t))throw new Error("请传入正确的解析类型！");if(!l(e))throw new Error("传入身份证格式有误!");const r={birthDate:e=>{const t=`${e.substring(6,10)}-${e.substring(10,12)}-${e.substring(12,14)}`;return t},sex:e=>{const t=parseInt(e.substr(16,1))%2===1?1:2;return t},age:e=>{const t=new Date,n=t.getMonth()+1,r=t.getDate();let i=t.getFullYear()-e.substring(6,10)-1;return(e.substring(10,12)<n||e.substring(10,12)==n&&e.substring(12,14)<=r)&&i++,i}};return r[t](e)};function l(e){const t=["11","12","13","14","15","21","22","23","31","32","33","34","35","36","37","41","42","43","44","45","46","50","51","52","53","54","61","62","63","64","65","71","81","82","91"];return""!==e&&(!1===u(e)?(console.log("校验长度，类型失败"),!1):!1===c(e,t)?(console.log("检查省份失败"),!1):!1===d(e)?(console.log("校验生日失败"),!1):!1!==h(e)||(console.log("验位的检测失败"),!1))}function u(e){const t=/^\d{17}(\d|X|x)$/;return t.test(e)}function c(e,t){const n=e.substr(0,2);return t.includes(n)}function d(e){const t=/^(\d{6})(\d{4})(\d{2})(\d{2})(\d{3})([0-9]|X|x)$/,n=e.match(t),r=n[2],i=n[3],o=n[4],a=new Date(r+"/"+i+"/"+o);return f(r,i,o,a)}function f(e,t,n,r){const i=new Date,o=i.getFullYear();if(r.getFullYear()==e&&r.getMonth()+1==t&&r.getDate()==n){const t=o-e;return t>=0&&t<=100}return!1}function h(e){const t=new Array(7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2),n=new Array("1","0","X","9","8","7","6","5","4","3","2");let r=0;for(let o=0;o<17;o++)r+=e.substr(o,1)*t[o];const i=n[r%11];return i===e.substr(17,1).toLocaleUpperCase()}var m=n("61f7"),p=n("b893"),g={components:{uploadFile:o["a"]},data(){return{addModifyVisible:!1,remoteLoading:!1,dialogTitle:"",addData:{id:"",name:"",phone:"",idCardType:"",idCard:"",birthdayParam:"",gender:"",region:"",homeAddress:"",wageLevel:"",company:"",remark:"",parentAdId:"",urgentPerson:"",attachment:[]},parentAdIdOptions:[],idCardTypeOptions:[{label:"身份证",value:1},{label:"军人证",value:2},{label:"护照",value:3},{label:"学生证",value:4},{label:"港澳通行证",value:5},{label:"其他",value:6}],wageLevelOptions:[{label:"三千以下",value:1},{label:"三千到五千",value:2},{label:"五千到一万",value:3},{label:"一万到三万",value:4},{label:"三万以上",value:5}],clientRule:{name:[{required:!0,message:"请输入客户名称",trigger:"blur"}],idCard:[{validator:(e,t,n)=>{1==this.addData.idCardType&&t&&(l(t)?(this.addData.birthdayParam=s(t,"birthDate"),this.addData.gender=s(t,"sex"),n()):n(new Error("身份证号格式不正确")))},trigger:"blur"}],phone:[{required:!0,message:"请输入联系电话",trigger:"blur"},{validator:(e,t,n)=>Object(m["b"])(t)?n():n(new Error("联系电话格式不正确")),trigger:"blur"}]}}},mounted(){this.getCurrentUser()},methods:{open(){this.dialogTitle="添加客户",this.addData.name="",this.addModifyVisible=!0},edit({id:e,name:t,phone:n,idCardType:r,idCard:i,birthday:o,gender:a,region:s,homeAddress:l,wageLevel:u,company:c,remark:d,parentAdId:f,urgentPerson:h,attachment:m}){this.dialogTitle="编辑客户",this.addModifyVisible=!0;let g="";if(m){const e=m.split("/");g=e[e.length-1]}this.addData={id:e,name:t,phone:n,idCardType:r,idCard:i,birthdayParam:Object(p["b"])(o,"yyyy-MM-dd"),gender:a,region:s,homeAddress:l,wageLevel:u,company:c,remark:d,parentAdId:f,urgentPerson:h,attachment:[{id:1,name:g,url:m}]}},close(){this.$refs.clientRef&&this.$refs.clientRef.clearValidate(),this.addData={name:"",phone:"",idCardType:"",idCard:"",birthdayParam:"",gender:"",region:"",homeAddress:"",wageLevel:"",company:"",remark:"",parentAdId:"",urgentPerson:"",attachment:[]},this.addModifyVisible=!1},getCurrentUser(){this.parentAdIdOptions=[{id:sessionStorage.getItem("id")?parseInt(sessionStorage.getItem("id")):"",name:sessionStorage.getItem("userName")}],this.addData.parentAdId=sessionStorage.getItem("id")?parseInt(sessionStorage.getItem("id")):""},handleSubmit(){this.$refs.clientRef.validate(e=>{const{attachment:t,...n}=this.addData;e&&(this.addData.id?a["a"].post({url:"/admin/adCustomer/edit",params:{...n,categoryId:1,attachment:t&&t.length>0?t[0].url:""},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}):a["a"].post({url:"/admin/adCustomer/add",params:{...n,categoryId:1,attachment:t&&t.length>0?t[0].url:""},success:e=>{this.$message.success(e),this.close(),this.$emit("success")}}))})},remoteMethod(e){e&&(this.remoteLoading=!0,a["a"].post({url:"/admin/adInfo/queryAdminByNameOrPhone",params:{search:e},success:e=>{this.remoteLoading=!1,this.parentAdIdOptions=e},catch:()=>{this.remoteLoading=!1}}))},handleIdCardTypeChange(e){e&&this.addData.idCard&&this.$refs.clientRef.validateField("idCard")}}},v=g,b=(n("355f"),n("1805")),y=Object(b["a"])(v,r,i,!1,null,"1c40ead8",null);t["default"]=y.exports}}]);